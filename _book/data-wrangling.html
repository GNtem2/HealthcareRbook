<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Data Wrangling | Applications of R in Healthcare</title>
  <meta name="description" content="This is a book describing the use of R in Healthcare. It is aimed at beginners of R language. The majority of the examples are taken from works in Neurology. The ideas and principles can be applied to other aspects of Healthcare. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Data Wrangling | Applications of R in Healthcare" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a book describing the use of R in Healthcare. It is aimed at beginners of R language. The majority of the examples are taken from works in Neurology. The ideas and principles can be applied to other aspects of Healthcare. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="GNtem2/HealthcareRbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Data Wrangling | Applications of R in Healthcare" />
  
  <meta name="twitter:description" content="This is a book describing the use of R in Healthcare. It is aimed at beginners of R language. The majority of the examples are taken from works in Neurology. The ideas and principles can be applied to other aspects of Healthcare. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Thanh Phan" />


<meta name="date" content="2020-05-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro.html"/>
<link rel="next" href="Statistics.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applications-of-R-in-Healthcare</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preamble</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction to plotting in R</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#ggplot2"><i class="fa fa-check"></i><b>2.1</b> ggplot2</a><ul>
<li class="chapter" data-level="2.1.1" data-path="intro.html"><a href="intro.html#histogram"><i class="fa fa-check"></i><b>2.1.1</b> Histogram</a></li>
<li class="chapter" data-level="2.1.2" data-path="intro.html"><a href="intro.html#bar-plot"><i class="fa fa-check"></i><b>2.1.2</b> Bar plot</a></li>
<li class="chapter" data-level="2.1.3" data-path="intro.html"><a href="intro.html#pie-chart"><i class="fa fa-check"></i><b>2.1.3</b> Pie chart</a></li>
<li class="chapter" data-level="2.1.4" data-path="intro.html"><a href="intro.html#scatter-plot"><i class="fa fa-check"></i><b>2.1.4</b> Scatter plot</a></li>
<li class="chapter" data-level="2.1.5" data-path="intro.html"><a href="intro.html#arrange-plot-in-grids"><i class="fa fa-check"></i><b>2.1.5</b> arrange plot in grids</a></li>
<li class="chapter" data-level="2.1.6" data-path="intro.html"><a href="intro.html#line-plot"><i class="fa fa-check"></i><b>2.1.6</b> Line plot</a></li>
<li class="chapter" data-level="2.1.7" data-path="intro.html"><a href="intro.html#facet-wrap"><i class="fa fa-check"></i><b>2.1.7</b> Facet wrap</a></li>
<li class="chapter" data-level="2.1.8" data-path="intro.html"><a href="intro.html#polygons"><i class="fa fa-check"></i><b>2.1.8</b> Polygons</a></li>
<li class="chapter" data-level="2.1.9" data-path="intro.html"><a href="intro.html#gantt-chart"><i class="fa fa-check"></i><b>2.1.9</b> Gantt chart</a></li>
<li class="chapter" data-level="2.1.10" data-path="intro.html"><a href="intro.html#flow-chart"><i class="fa fa-check"></i><b>2.1.10</b> Flow chart</a></li>
<li class="chapter" data-level="2.1.11" data-path="intro.html"><a href="intro.html#heatmap"><i class="fa fa-check"></i><b>2.1.11</b> Heatmap</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#ggplot2-extra"><i class="fa fa-check"></i><b>2.2</b> ggplot2 extra</a><ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#alluvial-and-sankey-diagram"><i class="fa fa-check"></i><b>2.2.1</b> Alluvial and Sankey diagram</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#survival-plot"><i class="fa fa-check"></i><b>2.2.2</b> Survival plot</a></li>
<li class="chapter" data-level="2.2.3" data-path="intro.html"><a href="intro.html#ggraph-and-tidygraph"><i class="fa fa-check"></i><b>2.2.3</b> ggraph and tidygraph</a></li>
<li class="chapter" data-level="2.2.4" data-path="intro.html"><a href="intro.html#ggparty-decision-tree"><i class="fa fa-check"></i><b>2.2.4</b> ggparty-decision tree</a></li>
<li class="chapter" data-level="2.2.5" data-path="intro.html"><a href="intro.html#ggroc--roc-curve"><i class="fa fa-check"></i><b>2.2.5</b> ggROC- ROC curve</a></li>
<li class="chapter" data-level="2.2.6" data-path="intro.html"><a href="intro.html#ggtree-and-phyloseq"><i class="fa fa-check"></i><b>2.2.6</b> ggtree and phyloseq</a></li>
<li class="chapter" data-level="2.2.7" data-path="intro.html"><a href="intro.html#map"><i class="fa fa-check"></i><b>2.2.7</b> Map</a></li>
<li class="chapter" data-level="2.2.8" data-path="intro.html"><a href="intro.html#ggwordcloud"><i class="fa fa-check"></i><b>2.2.8</b> ggwordcloud</a></li>
<li class="chapter" data-level="2.2.9" data-path="intro.html"><a href="intro.html#gganimate"><i class="fa fa-check"></i><b>2.2.9</b> gganimate</a></li>
<li class="chapter" data-level="2.2.10" data-path="intro.html"><a href="intro.html#ggneuro"><i class="fa fa-check"></i><b>2.2.10</b> ggneuro</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#plotly"><i class="fa fa-check"></i><b>2.3</b> plotly</a><ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#scatter-plot-1"><i class="fa fa-check"></i><b>2.3.1</b> scatter plot</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro.html"><a href="intro.html#bar-plot-1"><i class="fa fa-check"></i><b>2.3.2</b> bar plot</a></li>
<li class="chapter" data-level="2.3.3" data-path="intro.html"><a href="intro.html#heatmap-1"><i class="fa fa-check"></i><b>2.3.3</b> heatmap</a></li>
<li class="chapter" data-level="2.3.4" data-path="intro.html"><a href="intro.html#map-1"><i class="fa fa-check"></i><b>2.3.4</b> map</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>3</b> Data Wrangling</a><ul>
<li class="chapter" data-level="3.1" data-path="data-wrangling.html"><a href="data-wrangling.html#data"><i class="fa fa-check"></i><b>3.1</b> Data</a><ul>
<li class="chapter" data-level="3.1.1" data-path="data-wrangling.html"><a href="data-wrangling.html#vector-arrays-matrix"><i class="fa fa-check"></i><b>3.1.1</b> Vector, Arrays, Matrix</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-wrangling.html"><a href="data-wrangling.html#data-storage"><i class="fa fa-check"></i><b>3.2</b> Data storage</a><ul>
<li class="chapter" data-level="3.2.1" data-path="data-wrangling.html"><a href="data-wrangling.html#excel-data"><i class="fa fa-check"></i><b>3.2.1</b> Excel data</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-wrangling.html"><a href="data-wrangling.html#foreign-data"><i class="fa fa-check"></i><b>3.2.2</b> Foreign data</a></li>
<li class="chapter" data-level="3.2.3" data-path="data-wrangling.html"><a href="data-wrangling.html#json-format"><i class="fa fa-check"></i><b>3.2.3</b> json format</a></li>
<li class="chapter" data-level="3.2.4" data-path="data-wrangling.html"><a href="data-wrangling.html#xml"><i class="fa fa-check"></i><b>3.2.4</b> XML</a></li>
<li class="chapter" data-level="3.2.5" data-path="data-wrangling.html"><a href="data-wrangling.html#dicom-nifti-and-minc-format"><i class="fa fa-check"></i><b>3.2.5</b> DICOM, nifti and minc format</a></li>
<li class="chapter" data-level="3.2.6" data-path="data-wrangling.html"><a href="data-wrangling.html#mesh-generation"><i class="fa fa-check"></i><b>3.2.6</b> Mesh generation</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-wrangling.html"><a href="data-wrangling.html#tidy-data"><i class="fa fa-check"></i><b>3.3</b> Tidy data</a><ul>
<li class="chapter" data-level="3.3.1" data-path="data-wrangling.html"><a href="data-wrangling.html#factors"><i class="fa fa-check"></i><b>3.3.1</b> Factors</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-wrangling.html"><a href="data-wrangling.html#multiple-files"><i class="fa fa-check"></i><b>3.3.2</b> Multiple files</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-wrangling.html"><a href="data-wrangling.html#pivot"><i class="fa fa-check"></i><b>3.3.3</b> Pivot</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-wrangling.html"><a href="data-wrangling.html#regular-expressions"><i class="fa fa-check"></i><b>3.4</b> Regular Expressions</a><ul>
<li class="chapter" data-level="3.4.1" data-path="data-wrangling.html"><a href="data-wrangling.html#base-r"><i class="fa fa-check"></i><b>3.4.1</b> base R</a></li>
<li class="chapter" data-level="3.4.2" data-path="data-wrangling.html"><a href="data-wrangling.html#stringr"><i class="fa fa-check"></i><b>3.4.2</b> stringr</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="data-wrangling.html"><a href="data-wrangling.html#pdf-to-xcel"><i class="fa fa-check"></i><b>3.5</b> PDF to xcel</a><ul>
<li class="chapter" data-level="3.5.1" data-path="data-wrangling.html"><a href="data-wrangling.html#scanned-text-or-picture"><i class="fa fa-check"></i><b>3.5.1</b> Scanned text or picture</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="data-wrangling.html"><a href="data-wrangling.html#web-scraping"><i class="fa fa-check"></i><b>3.6</b> Web scraping</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="Statistics.html"><a href="Statistics.html"><i class="fa fa-check"></i><b>4</b> Statistics</a><ul>
<li class="chapter" data-level="4.1" data-path="Statistics.html"><a href="Statistics.html#univariable-analyses"><i class="fa fa-check"></i><b>4.1</b> Univariable analyses</a><ul>
<li class="chapter" data-level="4.1.1" data-path="Statistics.html"><a href="Statistics.html#parametric-tests"><i class="fa fa-check"></i><b>4.1.1</b> Parametric tests</a></li>
<li class="chapter" data-level="4.1.2" data-path="Statistics.html"><a href="Statistics.html#non-parametric-tests"><i class="fa fa-check"></i><b>4.1.2</b> Non-parametric tests</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="Statistics.html"><a href="Statistics.html#regression"><i class="fa fa-check"></i><b>4.2</b> Regression</a><ul>
<li class="chapter" data-level="4.2.1" data-path="Statistics.html"><a href="Statistics.html#linear-least-square-regression"><i class="fa fa-check"></i><b>4.2.1</b> Linear (least square) regression</a></li>
<li class="chapter" data-level="4.2.2" data-path="Statistics.html"><a href="Statistics.html#logistic-regression"><i class="fa fa-check"></i><b>4.2.2</b> Logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="Statistics.html"><a href="Statistics.html#special-types-of-regression"><i class="fa fa-check"></i><b>4.3</b> Special types of regression</a><ul>
<li class="chapter" data-level="4.3.1" data-path="Statistics.html"><a href="Statistics.html#multinomial-modelling"><i class="fa fa-check"></i><b>4.3.1</b> Multinomial modelling</a></li>
<li class="chapter" data-level="4.3.2" data-path="Statistics.html"><a href="Statistics.html#ordinal-regression"><i class="fa fa-check"></i><b>4.3.2</b> Ordinal regression</a></li>
<li class="chapter" data-level="4.3.3" data-path="Statistics.html"><a href="Statistics.html#survival"><i class="fa fa-check"></i><b>4.3.3</b> Survival analysis</a></li>
<li class="chapter" data-level="4.3.4" data-path="Statistics.html"><a href="Statistics.html#quantile"><i class="fa fa-check"></i><b>4.3.4</b> Quantile regression</a></li>
<li class="chapter" data-level="4.3.5" data-path="Statistics.html"><a href="Statistics.html#penalised"><i class="fa fa-check"></i><b>4.3.5</b> Penalised regression</a></li>
<li class="chapter" data-level="4.3.6" data-path="Statistics.html"><a href="Statistics.html#poisson"><i class="fa fa-check"></i><b>4.3.6</b> Poisson regression</a></li>
<li class="chapter" data-level="4.3.7" data-path="Statistics.html"><a href="Statistics.html#conditional-logistic-regression"><i class="fa fa-check"></i><b>4.3.7</b> Conditional logistic regression</a></li>
<li class="chapter" data-level="4.3.8" data-path="Statistics.html"><a href="Statistics.html#multinomial-modelling-1"><i class="fa fa-check"></i><b>4.3.8</b> Multinomial modelling</a></li>
<li class="chapter" data-level="4.3.9" data-path="Statistics.html"><a href="Statistics.html#mixed"><i class="fa fa-check"></i><b>4.3.9</b> Mixed modelling</a></li>
<li class="chapter" data-level="4.3.10" data-path="Statistics.html"><a href="Statistics.html#trajectory-modelling"><i class="fa fa-check"></i><b>4.3.10</b> Trajectory modelling</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="Statistics.html"><a href="Statistics.html#nonlinear"><i class="fa fa-check"></i><b>4.4</b> Non-linear regression</a></li>
<li class="chapter" data-level="4.5" data-path="Statistics.html"><a href="Statistics.html#sample-size-estimation"><i class="fa fa-check"></i><b>4.5</b> Sample size estimation</a><ul>
<li class="chapter" data-level="4.5.1" data-path="Statistics.html"><a href="Statistics.html#proportion"><i class="fa fa-check"></i><b>4.5.1</b> Proportion</a></li>
<li class="chapter" data-level="4.5.2" data-path="Statistics.html"><a href="Statistics.html#logistic-regression-1"><i class="fa fa-check"></i><b>4.5.2</b> Logistic regression</a></li>
<li class="chapter" data-level="4.5.3" data-path="Statistics.html"><a href="Statistics.html#survival-studies"><i class="fa fa-check"></i><b>4.5.3</b> Survival studies</a></li>
<li class="chapter" data-level="4.5.4" data-path="Statistics.html"><a href="Statistics.html#multiple-regression"><i class="fa fa-check"></i><b>4.5.4</b> Multiple regression</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="Statistics.html"><a href="Statistics.html#metaanalysis"><i class="fa fa-check"></i><b>4.6</b> Metaanalysis</a><ul>
<li class="chapter" data-level="4.6.1" data-path="Statistics.html"><a href="Statistics.html#prisma"><i class="fa fa-check"></i><b>4.6.1</b> PRISMA</a></li>
<li class="chapter" data-level="4.6.2" data-path="Statistics.html"><a href="Statistics.html#metaanalysis-of-proportion"><i class="fa fa-check"></i><b>4.6.2</b> Metaanalysis of proportion</a></li>
<li class="chapter" data-level="4.6.3" data-path="Statistics.html"><a href="Statistics.html#bivariate-metaanalysis"><i class="fa fa-check"></i><b>4.6.3</b> Bivariate Metaanalysis</a></li>
<li class="chapter" data-level="4.6.4" data-path="Statistics.html"><a href="Statistics.html#metaregression"><i class="fa fa-check"></i><b>4.6.4</b> Metaregression</a></li>
<li class="chapter" data-level="4.6.5" data-path="Statistics.html"><a href="Statistics.html#network-metaanalysis"><i class="fa fa-check"></i><b>4.6.5</b> Network metaanalysis</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="Statistics.html"><a href="Statistics.html#data-simulation"><i class="fa fa-check"></i><b>4.7</b> Data simulation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html"><i class="fa fa-check"></i><b>5</b> Multivariate Analysis</a><ul>
<li class="chapter" data-level="5.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#linear-methods"><i class="fa fa-check"></i><b>5.1</b> Linear methods</a><ul>
<li class="chapter" data-level="5.1.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#principal-component-analysis"><i class="fa fa-check"></i><b>5.1.1</b> Principal component analysis</a></li>
<li class="chapter" data-level="5.1.2" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#partial-least-squares"><i class="fa fa-check"></i><b>5.1.2</b> Partial least squares</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#non-linear-methods"><i class="fa fa-check"></i><b>5.2</b> Non-linear methods</a><ul>
<li class="chapter" data-level="5.2.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#manifold"><i class="fa fa-check"></i><b>5.2.1</b> Manifold</a></li>
<li class="chapter" data-level="5.2.2" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#non-negative-matrix-factorisation"><i class="fa fa-check"></i><b>5.2.2</b> Non-negative matrix factorisation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="machine-learning.html"><a href="machine-learning.html"><i class="fa fa-check"></i><b>6</b> Machine learning</a><ul>
<li class="chapter" data-level="6.1" data-path="machine-learning.html"><a href="machine-learning.html#decision-tree-analysis"><i class="fa fa-check"></i><b>6.1</b> Decision tree analysis</a><ul>
<li class="chapter" data-level="6.1.1" data-path="machine-learning.html"><a href="machine-learning.html#information-theory-driven"><i class="fa fa-check"></i><b>6.1.1</b> Information theory driven</a></li>
<li class="chapter" data-level="6.1.2" data-path="machine-learning.html"><a href="machine-learning.html#conditional-decision-tree"><i class="fa fa-check"></i><b>6.1.2</b> Conditional decision tree</a></li>
<li class="chapter" data-level="6.1.3" data-path="machine-learning.html"><a href="machine-learning.html#criticisms-of-decision-tree"><i class="fa fa-check"></i><b>6.1.3</b> criticisms of decision tree</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="machine-learning.html"><a href="machine-learning.html#mars"><i class="fa fa-check"></i><b>6.2</b> MARS</a></li>
<li class="chapter" data-level="6.3" data-path="machine-learning.html"><a href="machine-learning.html#random-forest"><i class="fa fa-check"></i><b>6.3</b> Random Forest</a></li>
<li class="chapter" data-level="6.4" data-path="machine-learning.html"><a href="machine-learning.html#gradient-boost-machine"><i class="fa fa-check"></i><b>6.4</b> Gradient Boost Machine</a></li>
<li class="chapter" data-level="6.5" data-path="machine-learning.html"><a href="machine-learning.html#svm"><i class="fa fa-check"></i><b>6.5</b> Support vector machine</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html"><i class="fa fa-check"></i><b>7</b> Machine Learning Part 2</a><ul>
<li class="chapter" data-level="7.1" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#non-negative-matrix-factorisation-1"><i class="fa fa-check"></i><b>7.1</b> Non-negative matrix factorisation</a></li>
<li class="chapter" data-level="7.2" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#formal-concept-analysis"><i class="fa fa-check"></i><b>7.2</b> Formal concept analysis</a><ul>
<li class="chapter" data-level="7.2.1" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#simulated-annealing"><i class="fa fa-check"></i><b>7.2.1</b> Simulated Annealing</a></li>
<li class="chapter" data-level="7.2.2" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#genetic-algorithm"><i class="fa fa-check"></i><b>7.2.2</b> Genetic Algorithm</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#reinforcement-learning"><i class="fa fa-check"></i><b>7.3</b> Reinforcement learning</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html"><i class="fa fa-check"></i><b>8</b> Bayesian Analysis</a><ul>
<li class="chapter" data-level="8.1" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#baysian-belief"><i class="fa fa-check"></i><b>8.1</b> Baysian belief</a><ul>
<li class="chapter" data-level="8.1.1" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#conditional-probability"><i class="fa fa-check"></i><b>8.1.1</b> Conditional probability</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#markov-model"><i class="fa fa-check"></i><b>8.2</b> Markov model</a></li>
<li class="chapter" data-level="8.3" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#inla-stan-and-bugs"><i class="fa fa-check"></i><b>8.3</b> INLA, Stan and BUGS</a><ul>
<li class="chapter" data-level="8.3.1" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#bayesianmeta"><i class="fa fa-check"></i><b>8.3.1</b> Bayesian Metaanalysis</a></li>
<li class="chapter" data-level="8.3.2" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#cost"><i class="fa fa-check"></i><b>8.3.2</b> Cost</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="operational-research.html"><a href="operational-research.html"><i class="fa fa-check"></i><b>9</b> Operational Research</a><ul>
<li class="chapter" data-level="9.1" data-path="operational-research.html"><a href="operational-research.html#discrete-event-simulations"><i class="fa fa-check"></i><b>9.1</b> Discrete Event Simulations</a></li>
<li class="chapter" data-level="9.2" data-path="operational-research.html"><a href="operational-research.html#linear-programming"><i class="fa fa-check"></i><b>9.2</b> Linear Programming</a></li>
<li class="chapter" data-level="9.3" data-path="operational-research.html"><a href="operational-research.html#forecasting"><i class="fa fa-check"></i><b>9.3</b> Forecasting</a><ul>
<li class="chapter" data-level="9.3.1" data-path="operational-research.html"><a href="operational-research.html#bed-requirement"><i class="fa fa-check"></i><b>9.3.1</b> Bed requirement</a></li>
<li class="chapter" data-level="9.3.2" data-path="operational-research.html"><a href="operational-research.html#length-of-stay"><i class="fa fa-check"></i><b>9.3.2</b> Length of stay</a></li>
<li class="chapter" data-level="9.3.3" data-path="operational-research.html"><a href="operational-research.html#customer-churns"><i class="fa fa-check"></i><b>9.3.3</b> Customer churns</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="operational-research.html"><a href="operational-research.html#process-mapping"><i class="fa fa-check"></i><b>9.4</b> Process mapping</a></li>
<li class="chapter" data-level="9.5" data-path="operational-research.html"><a href="operational-research.html#supply-chains"><i class="fa fa-check"></i><b>9.5</b> Supply chains</a></li>
<li class="chapter" data-level="9.6" data-path="operational-research.html"><a href="operational-research.html#health-economics"><i class="fa fa-check"></i><b>9.6</b> Health economics</a><ul>
<li class="chapter" data-level="9.6.1" data-path="operational-research.html"><a href="operational-research.html#cost-1"><i class="fa fa-check"></i><b>9.6.1</b> Cost</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="graph-theory.html"><a href="graph-theory.html"><i class="fa fa-check"></i><b>10</b> Graph Theory</a><ul>
<li class="chapter" data-level="10.1" data-path="graph-theory.html"><a href="graph-theory.html#special-graphs"><i class="fa fa-check"></i><b>10.1</b> Special graphs</a><ul>
<li class="chapter" data-level="10.1.1" data-path="graph-theory.html"><a href="graph-theory.html#laplacian-matrix"><i class="fa fa-check"></i><b>10.1.1</b> Laplacian matrix</a></li>
<li class="chapter" data-level="10.1.2" data-path="graph-theory.html"><a href="graph-theory.html#bimodal-bipartite-graph"><i class="fa fa-check"></i><b>10.1.2</b> Bimodal (bipartite) graph</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="graph-theory.html"><a href="graph-theory.html#centrality-measures"><i class="fa fa-check"></i><b>10.2</b> Centrality Measures</a><ul>
<li class="chapter" data-level="10.2.1" data-path="graph-theory.html"><a href="graph-theory.html#local-centrality-measures"><i class="fa fa-check"></i><b>10.2.1</b> Local centrality measures</a></li>
<li class="chapter" data-level="10.2.2" data-path="graph-theory.html"><a href="graph-theory.html#global-centrality-measures"><i class="fa fa-check"></i><b>10.2.2</b> Global centrality measures</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="graph-theory.html"><a href="graph-theory.html#community"><i class="fa fa-check"></i><b>10.3</b> Community</a></li>
<li class="chapter" data-level="10.4" data-path="graph-theory.html"><a href="graph-theory.html#visualising-graph"><i class="fa fa-check"></i><b>10.4</b> Visualising graph</a><ul>
<li class="chapter" data-level="10.4.1" data-path="graph-theory.html"><a href="graph-theory.html#visnetwork"><i class="fa fa-check"></i><b>10.4.1</b> Visnetwork</a></li>
<li class="chapter" data-level="10.4.2" data-path="graph-theory.html"><a href="graph-theory.html#large-graph"><i class="fa fa-check"></i><b>10.4.2</b> Large graph</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="graph-theory.html"><a href="graph-theory.html#social-media-and-network-analysis"><i class="fa fa-check"></i><b>10.5</b> Social Media and Network Analysis</a><ul>
<li class="chapter" data-level="10.5.1" data-path="graph-theory.html"><a href="graph-theory.html#twitter"><i class="fa fa-check"></i><b>10.5.1</b> Twitter</a></li>
<li class="chapter" data-level="10.5.2" data-path="graph-theory.html"><a href="graph-theory.html#youtube"><i class="fa fa-check"></i><b>10.5.2</b> Youtube</a></li>
<li class="chapter" data-level="10.5.3" data-path="graph-theory.html"><a href="graph-theory.html#imaging"><i class="fa fa-check"></i><b>10.5.3</b> Imaging</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html"><i class="fa fa-check"></i><b>11</b> Geospatial analysis</a><ul>
<li class="chapter" data-level="11.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#geocoding"><i class="fa fa-check"></i><b>11.1</b> Geocoding</a></li>
<li class="chapter" data-level="11.2" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#thematic-map-1"><i class="fa fa-check"></i><b>11.2</b> Thematic map</a></li>
<li class="chapter" data-level="11.3" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#spatial-regression"><i class="fa fa-check"></i><b>11.3</b> Spatial regression</a></li>
<li class="chapter" data-level="11.4" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#spatio-temporal-regression"><i class="fa fa-check"></i><b>11.4</b> Spatio-temporal regression</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="app.html"><a href="app.html"><i class="fa fa-check"></i><b>12</b> App</a><ul>
<li class="chapter" data-level="12.1" data-path="app.html"><a href="app.html#brief-introduction-to-shiny-app"><i class="fa fa-check"></i><b>12.1</b> Brief introduction to Shiny app</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>13</b> Appendix</a><ul>
<li class="chapter" data-level="13.1" data-path="appendix.html"><a href="appendix.html#brief-introduction-to-matrix"><i class="fa fa-check"></i><b>13.1</b> Brief introduction to Matrix</a></li>
<li class="chapter" data-level="13.2" data-path="appendix.html"><a href="appendix.html#regression-1"><i class="fa fa-check"></i><b>13.2</b> Regression</a><ul>
<li class="chapter" data-level="13.2.1" data-path="appendix.html"><a href="appendix.html#linear-regression"><i class="fa fa-check"></i><b>13.2.1</b> Linear regression</a></li>
<li class="chapter" data-level="13.2.2" data-path="appendix.html"><a href="appendix.html#logistic-regression-2"><i class="fa fa-check"></i><b>13.2.2</b> Logistic regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applications of R in Healthcare</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-wrangling" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Data Wrangling</h1>
<p>This section deals with the nitty gritty of data analysis. There’s no nice plots like the previous chapter. In fact, this data wrangling is the major aspect of data science. Sometimes, it’s worth spending time on <em>stack overflow</em> to look at similar problems that others have and the approaches to solving them. Useful blogs are available at <a href="https://www.r-bloggers.com/" class="uri">https://www.r-bloggers.com/</a>.</p>
<div id="data" class="section level2">
<h2><span class="header-section-number">3.1</span> Data</h2>
<p>This section on atomic vector, arrays, matrix and list is often considered boring and ignored.</p>
<div id="vector-arrays-matrix" class="section level3">
<h3><span class="header-section-number">3.1.1</span> Vector, Arrays, Matrix</h3>
<div id="vector-and-list" class="section level4">
<h4><span class="header-section-number">3.1.1.1</span> Vector and list</h4>
<p>All elements of an atomic vector and arrays are the same. Vector can be numbers, words etc. However, vectors should not be a mixture of words and numbers. List can contain different types of data. A complex example of a structured list is the <em>json</em> format shown below. In base R, <em>c</em> is a function for creating a vector or list. The function <em>list</em> can also be used to create list. It is best to avoid using <em>c</em> when assigning a name to a dataframe or vector <span class="citation">(Wickham <a href="#ref-Wickham2019">2019</a>)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">a&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">is.vector</span>(a)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">class</span>(a) <span class="co">#numeric vector</span></a></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">b&lt;-<span class="kw">c</span>(<span class="st">&quot;apple&quot;</span>,<span class="st">&quot;orange&quot;</span>,<span class="st">&quot;banana&quot;</span>)</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw">is.vector</span>(b) <span class="co">#character vector</span></a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">class</span>(b)</a></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">d&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="st">&quot;banana&quot;</span>)</a>
<a class="sourceLine" id="cb9-2" title="2"><span class="kw">is.list</span>(d) <span class="co">#character vector</span></a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">class</span>(d) <span class="co">#FALSE</span></a></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">e&lt;-<span class="kw">list</span>(a,b,<span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">FALSE</span>,<span class="ot">FALSE</span>))</a>
<a class="sourceLine" id="cb13-2" title="2"><span class="kw">is.list</span>(e) <span class="co">#TRUE</span></a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="matrix-and-arrays" class="section level4">
<h4><span class="header-section-number">3.1.1.2</span> Matrix and Arrays</h4>
<p>Arrays are arranged in matrix of rows and columns of a single data type. Later in this chapter, we will illustrate the importance of arrays for manipulating MRI scans. A volumetric mri scan, there are 3 dimenions <em>[,,]</em>. The first column is the sagittal sequence, second column is the coronal sequence and the third column is the axial sequence. In the example below, this knowledge of arrays can be used to reverse the ordering of information on MRI scan (flip on it axis between left and right)</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="co">#vector</span></a>
<a class="sourceLine" id="cb15-2" title="2">vector1&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb15-3" title="3">vector2&lt;-<span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>)</a>
<a class="sourceLine" id="cb15-4" title="4">array1&lt;-<span class="kw">array</span>(<span class="kw">c</span>(vector1,vector2),<span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb15-5" title="5">array1</a></code></pre></div>
<pre><code>## , , 1
## 
##      [,1] [,2] [,3]
## [1,]    1    4    7
## [2,]    2    5    8
## [3,]    3    6    9
## 
## , , 2
## 
##      [,1] [,2] [,3]
## [1,]    1    4    7
## [2,]    2    5    8
## [3,]    3    6    9</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">array2&lt;-<span class="kw">array</span>(<span class="kw">c</span>(vector1,vector2),<span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb17-2" title="2">array2</a></code></pre></div>
<pre><code>## , , 1
## 
##      [,1] [,2]
## [1,]    1    3
## [2,]    2    4
## 
## , , 2
## 
##      [,1] [,2]
## [1,]    5    7
## [2,]    6    8
## 
## , , 3
## 
##      [,1] [,2]
## [1,]    9    2
## [2,]    1    3</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="co">#check if array or matrix</span></a>
<a class="sourceLine" id="cb19-2" title="2"><span class="kw">is.matrix</span>(array1)</a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">is.array</span>(array1)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Arrays can be accessed by indexing its structure.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="co">#first row of array1</span></a>
<a class="sourceLine" id="cb23-2" title="2">array1[,,<span class="dv">1</span>]</a></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    4    7
## [2,]    2    5    8
## [3,]    3    6    9</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="co">#second row of array1</span></a>
<a class="sourceLine" id="cb25-2" title="2">array1[,,<span class="dv">2</span>]</a></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    4    7
## [2,]    2    5    8
## [3,]    3    6    9</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="co">#second row of array2</span></a>
<a class="sourceLine" id="cb27-2" title="2">array2[,,<span class="dv">2</span>]</a></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    5    7
## [2,]    6    8</code></pre>
<p>The <em>apply</em> function works on data in array format.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="co">#sum data across rows ie c(1)</span></a>
<a class="sourceLine" id="cb29-2" title="2"><span class="kw">apply</span>(array1,<span class="kw">c</span>(<span class="dv">1</span>),sum)</a></code></pre></div>
<pre><code>## [1] 24 30 36</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="co">#sum data across columns(2)</span></a>
<a class="sourceLine" id="cb31-2" title="2"><span class="kw">apply</span>(array1,<span class="kw">c</span>(<span class="dv">2</span>),sum)</a></code></pre></div>
<pre><code>## [1] 12 30 48</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="co">#sum data across rows and columns c(1,2)</span></a>
<a class="sourceLine" id="cb33-2" title="2"><span class="kw">apply</span>(array1,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),sum)</a></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    2    8   14
## [2,]    4   10   16
## [3,]    6   12   18</code></pre>
</div>
<div id="data-frame" class="section level4">
<h4><span class="header-section-number">3.1.1.3</span> Data frame</h4>
<p>Data frame is a convenient way of formatting data in table format. It is worth checking the structure of data. Some libraries preder to work with data in data frame while others prefer matrix or array structure.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1">a&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb35-2" title="2">b&lt;-<span class="kw">c</span>(<span class="st">&quot;apple&quot;</span>,<span class="st">&quot;orange&quot;</span>,<span class="st">&quot;banana&quot;</span>)</a>
<a class="sourceLine" id="cb35-3" title="3">e&lt;-<span class="kw">data.frame</span>(a,b)</a>
<a class="sourceLine" id="cb35-4" title="4"><span class="kw">rownames</span>(e)</a></code></pre></div>
<pre><code>## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot;</code></pre>
</div>
<div id="simple-function" class="section level4">
<h4><span class="header-section-number">3.1.1.4</span> Simple function</h4>
<p>a function is written by creating name of function, calling on <em>function</em> (x) and brackets to define function.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="co"># function sun</span></a>
<a class="sourceLine" id="cb37-2" title="2">ArithSum&lt;-<span class="cf">function</span> (x) {</a>
<a class="sourceLine" id="cb37-3" title="3">  <span class="kw">sum</span>(x)</a>
<a class="sourceLine" id="cb37-4" title="4">}</a>
<a class="sourceLine" id="cb37-5" title="5">vector1&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb37-6" title="6"><span class="kw">ArithSum</span>(vector1)</a></code></pre></div>
<pre><code>## [1] 6</code></pre>
<p>This is an example of using loop to remove na. There is an elegant function <em>replace_na</em> within <em>tidyr</em> to perform this task.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="co"># data</span></a>
<a class="sourceLine" id="cb39-2" title="2">x=<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="ot">NA</span>,<span class="dv">6</span>,<span class="dv">9</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="dv">5</span>,<span class="ot">NA</span>,<span class="ot">NA</span>,<span class="dv">11</span>)</a>
<a class="sourceLine" id="cb39-3" title="3"><span class="co"># vector of missing values</span></a>
<a class="sourceLine" id="cb39-4" title="4">y &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb39-5" title="5"><span class="co"># find missing value indices</span></a>
<a class="sourceLine" id="cb39-6" title="6"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(x)){</a>
<a class="sourceLine" id="cb39-7" title="7">  <span class="cf">if</span>(<span class="kw">is.na</span>(x[i])<span class="op">==</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb39-8" title="8">    y &lt;-<span class="st"> </span><span class="kw">append</span>(y, i)</a>
<a class="sourceLine" id="cb39-9" title="9">}</a>
<a class="sourceLine" id="cb39-10" title="10"><span class="co"># replace missing values with a random integer between 1 and 5</span></a>
<a class="sourceLine" id="cb39-11" title="11">x.no.na &lt;-<span class="st"> </span><span class="kw">replace</span>(x, y, <span class="kw">sample</span>(<span class="dv">5</span>, <span class="kw">length</span>(y), <span class="dt">replace =</span> <span class="ot">FALSE</span>))</a>
<a class="sourceLine" id="cb39-12" title="12">x.no.na</a></code></pre></div>
<pre><code>##  [1]  3  2  1  6  9  2  4  5  3  5 11</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="co">#tidyr version</span></a>
<a class="sourceLine" id="cb41-2" title="2">x.no.na2&lt;-tidyr<span class="op">::</span><span class="kw">replace_na</span>(x,<span class="kw">round</span>(<span class="kw">runif</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">5</span>),<span class="dv">0</span>))</a>
<a class="sourceLine" id="cb41-3" title="3">x.no.na2</a></code></pre></div>
<pre><code>##  [1]  3  2  3  6  9  3  3  5  3  3 11</code></pre>
</div>
<div id="sapply" class="section level4">
<h4><span class="header-section-number">3.1.1.5</span> sapply</h4>
<p>The call <em>sapply</em> applies a function to a vector, matrix or list. It returns the results in the form of a matrix.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1">a&lt;-<span class="kw">list.files</span>(<span class="dt">pattern=</span><span class="st">&quot;100*&quot;</span>)</a>
<a class="sourceLine" id="cb43-2" title="2"><span class="co">#SopenNii&lt;-sapply(a, readNIfTI )[1] 902629      4</span></a>
<a class="sourceLine" id="cb43-3" title="3"><span class="co">#class(SopenNii) #matrix</span></a></code></pre></div>
</div>
<div id="lapply" class="section level4">
<h4><span class="header-section-number">3.1.1.6</span> lapply</h4>
<p>The call <em>lapply</em> applies a function to a list. The example below creates a list of nifti files which are opened painlessly using <em>lapply</em> call to <em>readNIfTI</em>.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="kw">library</span>(oro.nifti)</a>
<a class="sourceLine" id="cb44-2" title="2">a&lt;-<span class="kw">list.files</span>(<span class="dt">pattern=</span><span class="st">&quot;100*&quot;</span>)</a>
<a class="sourceLine" id="cb44-3" title="3"><span class="co">#LopenNii&lt;-lapply(a, readNIfTI)</span></a>
<a class="sourceLine" id="cb44-4" title="4"><span class="co">#class(LopenNii) #list</span></a></code></pre></div>
</div>
</div>
</div>
<div id="data-storage" class="section level2">
<h2><span class="header-section-number">3.2</span> Data storage</h2>
<p>Often one assumes that opening Rstudio is sufficient to locate the file and run the analysis. One way of doing this at the console is to click on <em>Session</em> tab, then <em>Set Working Directory</em> to location of file. Another way of doing this seemlessly is to use the library <em>here</em>. It is easy to find the files in your directory using the <em>list.files()</em> call.One way of storing data in R format is to save the file as .Rda. This format will ensure that no one can accidentally rewrite or delete a number. For very large data, it’s quicker to save as .Rda file than as csv file.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1"><span class="co">#list all files in a directory</span></a>
<a class="sourceLine" id="cb45-2" title="2"><span class="co">#list.files()</span></a>
<a class="sourceLine" id="cb45-3" title="3"><span class="co">#list files matching pattern</span></a>
<a class="sourceLine" id="cb45-4" title="4"><span class="kw">list.files</span>(<span class="dt">pattern=</span><span class="st">&quot;.Rmd&quot;</span>)</a></code></pre></div>
<pre><code>##  [1] &quot;01-intro.Rmd&quot;                       
##  [2] &quot;02-Data-Wrangling.Rmd&quot;              
##  [3] &quot;03-Statistics.Rmd&quot;                  
##  [4] &quot;04-multivariate-analysis.Rmd&quot;       
##  [5] &quot;05-machinelearning.Rmd&quot;             
##  [6] &quot;06-machinelearningpt2.Rmd&quot;          
##  [7] &quot;07-Bayesian-analysis.Rmd&quot;           
##  [8] &quot;08-operational-research.Rmd&quot;        
##  [9] &quot;09-graph-theory.Rmd&quot;                
## [10] &quot;10-geospatial-analysis.Rmd&quot;         
## [11] &quot;11-App.Rmd&quot;                         
## [12] &quot;12-Appendix.Rmd&quot;                    
## [13] &quot;13-references.Rmd&quot;                  
## [14] &quot;Applications-of-R-in-Healthcare.Rmd&quot;
## [15] &quot;index.Rmd&quot;</code></pre>
<div id="excel-data" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Excel data</h3>
<p>Excel data are stored as csv, xls and xlsx. Csv files can be open in base R using <em>read.csv</em> function or <em>read_csv</em> using <em>readr</em> library, or <em>fread</em> using <em>data.table</em>. One issue with <em>read.csv</em> is that it converts string to factors and it is advisable to follow up with a statement (stringsAsFactors = FALSE) to avoid this issue. Both <em>read_csv</em> and <em>fread</em> are deemed to be faster for large files. <em>fread</em> convert date to character and requires further conversion using base R or <em>fasttime</em>.</p>
<p>I would urge you to get used to manipulating data in R as the codes serve as a way to keep track with the change in data. The original xcel data should not be touched outside of R.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1">File&lt;-<span class="kw">read.csv</span>(<span class="st">&quot;File.csv&quot;</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb47-2" title="2"></a>
<a class="sourceLine" id="cb47-3" title="3">File&lt;-readr<span class="op">::</span><span class="kw">read_csv</span> (<span class="st">&quot;File.csv&quot;</span>)</a>
<a class="sourceLine" id="cb47-4" title="4"></a>
<a class="sourceLine" id="cb47-5" title="5">File&lt;-data.table<span class="op">::</span><span class="kw">fread</span>(<span class="st">&quot;File.csv&quot;</span>)</a>
<a class="sourceLine" id="cb47-6" title="6"></a>
<a class="sourceLine" id="cb47-7" title="7">File&lt;-readxl<span class="op">::</span><span class="kw">read_xlsx</span>(<span class="st">&quot;File.xlsx&quot;</span>,<span class="dt">skip=</span><span class="dv">1</span>) <span class="co">#skip first row </span></a>
<a class="sourceLine" id="cb47-8" title="8"></a>
<a class="sourceLine" id="cb47-9" title="9">File&lt;-readxl<span class="op">::</span><span class="kw">read_xlsx</span>(<span class="st">&quot;File.xlsx&quot;</span>,<span class="dt">sheet=</span><span class="dv">2</span>) <span class="co">#read data from sheet 2</span></a></code></pre></div>
<div id="date-and-time" class="section level4">
<h4><span class="header-section-number">3.2.1.1</span> Date and time</h4>
<p>Date and time can be handle in base R. The library <em>lubridate</em> is useful for parsing date data. One warning, errors with parsing can occur if there are characters in the column containing date data. It is possible to get an overview of the functions of the library by typing <em>help(package=lubridate)</em>.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="kw">library</span>(dplyr)</a></code></pre></div>
<pre><code>## Warning: package &#39;dplyr&#39; was built under R version 3.6.1</code></pre>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1">dfdate&lt;-<span class="kw">data.frame</span>(<span class="st">&quot;DateofEvent&quot;</span>=<span class="kw">c</span>(<span class="st">&quot;12/03/2005&quot;</span>,<span class="st">&quot;12/04/2006&quot;</span>,<span class="ot">NA</span>),<span class="st">&quot;Result&quot;</span>=<span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>))</a>
<a class="sourceLine" id="cb53-2" title="2"><span class="kw">class</span>(dfdate<span class="op">$</span>DateofEvent)</a></code></pre></div>
<pre><code>## [1] &quot;factor&quot;</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1">dfdate<span class="op">$</span>DateofEvent</a></code></pre></div>
<pre><code>## [1] 12/03/2005 12/04/2006 &lt;NA&gt;      
## Levels: 12/03/2005 12/04/2006</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="co">#remove NA</span></a>
<a class="sourceLine" id="cb57-2" title="2">dfdate <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(DateofEvent))</a></code></pre></div>
<pre><code>##   DateofEvent Result
## 1  12/03/2005      4
## 2  12/04/2006      5</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1"><span class="co">#convert to Date using base R</span></a>
<a class="sourceLine" id="cb59-2" title="2">dfdate<span class="op">$</span>DateofEvent2&lt;-<span class="kw">as.POSIXct</span>(dfdate<span class="op">$</span>DateofEvent)</a>
<a class="sourceLine" id="cb59-3" title="3"><span class="kw">class</span>(dfdate<span class="op">$</span>DateofEvent2)</a></code></pre></div>
<pre><code>## [1] &quot;POSIXct&quot; &quot;POSIXt&quot;</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1">dfdate<span class="op">$</span>DateofEvent2</a></code></pre></div>
<pre><code>## [1] &quot;0012-03-20 LMT&quot; &quot;0012-04-20 LMT&quot; NA</code></pre>
<p>Partitioning date time data to weekend or week day is simple. Below, a simple data frame is created containing Date and Time. A simple check using <em>class</em> call show that the data are factors. The data can be converted to date using <em>as.POSIXct</em> call with base R or <em>ymd</em> or <em>ymd_hms</em> with <em>lubridate</em>. The day of the week can be parsed with <em>wday</em> call. This call <em>wday</em> return a numerical vector of days. Sunday is day 1 and Saturday is day 7.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1"><span class="kw">library</span>(lubridate)</a></code></pre></div>
<pre><code>## 
## Attaching package: &#39;lubridate&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     date</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb66-2" title="2"><span class="co">#help(package=&quot;lubridate&quot;)</span></a>
<a class="sourceLine" id="cb66-3" title="3"><span class="co">#create an example for practice</span></a>
<a class="sourceLine" id="cb66-4" title="4">dfw&lt;-<span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb66-5" title="5"><span class="dt">Location=</span><span class="kw">c</span>(<span class="st">&quot;MMC&quot;</span>,<span class="st">&quot;Casey&quot;</span>,<span class="st">&quot;DDH&quot;</span>,<span class="st">&quot;DDH&quot;</span>,<span class="st">&quot;MMC&quot;</span>),</a>
<a class="sourceLine" id="cb66-6" title="6"><span class="dt">Date=</span><span class="kw">c</span>(<span class="st">&quot;2020-04-22&quot;</span>,<span class="st">&quot;2020-04-23&quot;</span>,<span class="st">&quot;2020-04-24&quot;</span>,<span class="st">&quot;2020-04-25&quot;</span>,<span class="st">&quot;2020-04-26&quot;</span>),<span class="dt">Time=</span><span class="kw">c</span>(<span class="st">&quot;15:33:21&quot;</span>,<span class="st">&quot;20:32:34&quot;</span>,<span class="st">&quot;12:12:43&quot;</span>,<span class="st">&quot;09:40:32&quot;</span>,<span class="st">&quot;18:23:50&quot;</span>))</a>
<a class="sourceLine" id="cb66-7" title="7">dfw1&lt;-dfw <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb66-8" title="8"><span class="st">        </span><span class="co">#merge Date Time columns</span></a>
<a class="sourceLine" id="cb66-9" title="9"><span class="st">        </span><span class="kw">mutate</span>(<span class="dt">DateTime=</span><span class="kw">paste0</span>(Date,Time),</a>
<a class="sourceLine" id="cb66-10" title="10">        <span class="co">#Date and Time data are factors</span></a>
<a class="sourceLine" id="cb66-11" title="11">        <span class="dt">DateTime=</span><span class="kw">ymd_hms</span>(DateTime),</a>
<a class="sourceLine" id="cb66-12" title="12">        <span class="co">#parse day of week</span></a>
<a class="sourceLine" id="cb66-13" title="13">        <span class="dt">Wday=</span><span class="kw">wday</span>(DateTime),</a>
<a class="sourceLine" id="cb66-14" title="14">        <span class="co">#return logical value for days 1 and 7</span></a>
<a class="sourceLine" id="cb66-15" title="15">        <span class="dt">Wkend=</span>(Wday<span class="op">==</span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Wday<span class="op">==</span><span class="dv">7</span>),</a>
<a class="sourceLine" id="cb66-16" title="16">        <span class="co">#hour returns a value between 0-24</span></a>
<a class="sourceLine" id="cb66-17" title="17">        <span class="dt">Ohour=</span><span class="kw">hour</span>(DateTime),</a>
<a class="sourceLine" id="cb66-18" title="18">        <span class="co">#return logical value for time between 8-17</span></a>
<a class="sourceLine" id="cb66-19" title="19">        <span class="dt">Officehour=</span>(Ohour<span class="op">&gt;=</span><span class="dv">8</span> <span class="op">&amp;</span><span class="st"> </span>Ohour<span class="op">&lt;=</span><span class="dv">17</span>))</a></code></pre></div>
</div>
</div>
<div id="foreign-data" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Foreign data</h3>
<p>The foreign library is traditionally use to handle data from <em>SPSS</em> (.sav), <em>Stata</em> (.dta) and <em>SAS</em> (.sas). One should look at the ending in the file to determine the necessary library.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1"><span class="kw">library</span>(foreign)</a>
<a class="sourceLine" id="cb67-2" title="2"><span class="co">#write and read Stata</span></a>
<a class="sourceLine" id="cb67-3" title="3"><span class="kw">write.dta</span>(dfdate,<span class="dt">file=</span><span class="st">&quot;./Data-Use/dfdate_temp.dta&quot;</span>)</a>
<a class="sourceLine" id="cb67-4" title="4">a&lt;-<span class="kw">read.dta</span>(<span class="st">&quot;./Data-Use/dfdate_temp.dta&quot;</span>)</a>
<a class="sourceLine" id="cb67-5" title="5">a</a></code></pre></div>
<p>This dataset is available for download from <a href="https://www1.nyc.gov/site/doh/data/data-sets/data-sets-and-tables.page" class="uri">https://www1.nyc.gov/site/doh/data/data-sets/data-sets-and-tables.page</a>. It contains data on a survey of health status on New Yorkers in 2018. The data is available for download is <em>SAS</em> format. The <em>.sas7bdat</em> is the latest version of <em>SAS</em> and requires this <em>sas7bdat</em> library.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1"><span class="kw">library</span>(sas7bdat)</a>
<a class="sourceLine" id="cb68-2" title="2">chc2018&lt;-<span class="kw">read.sas7bdat</span>(<span class="st">&quot;./Ext-Data/chs2018_public.sas7bdat&quot;</span>)</a></code></pre></div>
<p>The <em>foreign</em> library can handle older <em>SAS</em> files but not the current version. The current version of <em>SAS</em> file requires <em>sas7bdat</em>. The clue is the file ends in .sas7bdat.</p>
</div>
<div id="json-format" class="section level3">
<h3><span class="header-section-number">3.2.3</span> json format</h3>
<p>Json is short for JavaScript object Notification. These files have a hierarchical (nested) structured format. The json file is in text format and can also be examined using <em>Notepad</em>. These files can be read using the <em>RJSONIO</em>, <em>rjson</em> or <em>tidyjson</em> libraries in R.</p>
<p>There are 2 sample json files. One is the address book for kommune 0411 in Denmark. The other json data is the hospital bed per 1000 people data is obtained from World Bank at
<a href="https://data.worldbank.org/indicator/SH.MED.BEDS.ZS" class="uri">https://data.worldbank.org/indicator/SH.MED.BEDS.ZS</a>.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1"><span class="kw">library</span>(RJSONIO)</a>
<a class="sourceLine" id="cb69-2" title="2">j&lt;-<span class="kw">fromJSON</span>(<span class="st">&quot;./Data-Use/0411.geojson&quot;</span>)</a>
<a class="sourceLine" id="cb69-3" title="3">j&lt;-<span class="kw">lapply</span>(j, <span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb69-4" title="4">  x[<span class="kw">sapply</span>(x,is.null)]&lt;-<span class="ot">NA</span></a>
<a class="sourceLine" id="cb69-5" title="5">  <span class="kw">unlist</span>(x)</a>
<a class="sourceLine" id="cb69-6" title="6">})</a>
<a class="sourceLine" id="cb69-7" title="7">k&lt;-<span class="kw">as.data.frame</span>(<span class="kw">do.call</span>(<span class="st">&quot;cbind&quot;</span>,j)) <span class="co">#list to data frame</span></a>
<a class="sourceLine" id="cb69-8" title="8"></a>
<a class="sourceLine" id="cb69-9" title="9">j1&lt;-<span class="kw">fromJSON</span>(<span class="st">&quot;./Data-Use/WB-Beds/SH.MED.BEDS.json&quot;</span>)</a>
<a class="sourceLine" id="cb69-10" title="10">j1&lt;-<span class="kw">lapply</span>(j1, <span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb69-11" title="11">  x[<span class="kw">sapply</span>(x,is.null)]&lt;-<span class="ot">NA</span></a>
<a class="sourceLine" id="cb69-12" title="12">  <span class="kw">unlist</span>(x)</a>
<a class="sourceLine" id="cb69-13" title="13">})</a>
<a class="sourceLine" id="cb69-14" title="14">k1&lt;-<span class="kw">as.data.frame</span>(<span class="kw">do.call</span>(<span class="st">&quot;cbind&quot;</span>,j)) <span class="co">#list to data frame</span></a></code></pre></div>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1"><span class="kw">library</span>(rjson)</a></code></pre></div>
<pre><code>## 
## Attaching package: &#39;rjson&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:RJSONIO&#39;:
## 
##     fromJSON, toJSON</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1"><span class="kw">setwd</span>(<span class="st">&quot;./Data-Use/WB-Beds/&quot;</span>)</a>
<a class="sourceLine" id="cb73-2" title="2">j2&lt;-rjson<span class="op">::</span><span class="kw">fromJSON</span>(<span class="dt">file=</span><span class="st">&quot;SH.MED.BEDS.json&quot;</span>)</a></code></pre></div>
<p>The <em>tidyjson</em> library contains the world bank data in <em>json</em> format.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1"><span class="kw">library</span>(tidyjson)</a></code></pre></div>
<pre><code>## Warning: package &#39;tidyjson&#39; was built under R version 3.6.3</code></pre>
<pre><code>## 
## Attaching package: &#39;tidyjson&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     bind_rows</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     filter</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb79-2" title="2">SH.MED.BEDS&lt;-<span class="kw">read_json</span>(<span class="st">&quot;./Data-Use/WB-Beds/SH.MED.BEDS.json&quot;</span>)</a></code></pre></div>
</div>
<div id="xml" class="section level3">
<h3><span class="header-section-number">3.2.4</span> XML</h3>
<p>XML refers to extensible markup language. Extracting XML object to data frame requires conversion to a list and then unlist the document.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1"><span class="kw">library</span>(XML)</a>
<a class="sourceLine" id="cb80-2" title="2"><span class="kw">library</span>(methods)</a>
<a class="sourceLine" id="cb80-3" title="3"><span class="co">#parse data into XML document</span></a>
<a class="sourceLine" id="cb80-4" title="4">result&lt;-<span class="kw">xmlParse</span>(<span class="st">&quot;./Data-Use/WB-Beds/API_SH.MED.BEDS.ZS_DS2_en_xml_v2_994608.xml&quot;</span>)</a>
<a class="sourceLine" id="cb80-5" title="5"><span class="co">#explore data structure of xml document</span></a>
<a class="sourceLine" id="cb80-6" title="6"><span class="co">#find number of root node</span></a>
<a class="sourceLine" id="cb80-7" title="7">rootnode &lt;-<span class="st"> </span><span class="kw">xmlRoot</span>(result)</a>
<a class="sourceLine" id="cb80-8" title="8">rootsize &lt;-<span class="st"> </span><span class="kw">xmlSize</span>(rootnode)</a>
<a class="sourceLine" id="cb80-9" title="9"><span class="co">#print(rootsize)</span></a>
<a class="sourceLine" id="cb80-10" title="10"><span class="co">#print(rootnode[1])</span></a>
<a class="sourceLine" id="cb80-11" title="11"><span class="co">#create data frame directly-not recommended</span></a>
<a class="sourceLine" id="cb80-12" title="12">Bedsdf&lt;-<span class="kw">xmlToDataFrame</span>(result) <span class="co"># 1 15840</span></a>
<a class="sourceLine" id="cb80-13" title="13"><span class="co">#a different way to convert to data frame</span></a>
<a class="sourceLine" id="cb80-14" title="14">Bedsdfdoc &lt;-<span class="st"> </span><span class="kw">xmlToDataFrame</span>(<span class="dt">nodes =</span> <span class="kw">getNodeSet</span>(result, <span class="st">&quot;//record&quot;</span>))</a>
<a class="sourceLine" id="cb80-15" title="15"><span class="co">#View(Bedsdfdoc)</span></a></code></pre></div>
<p>The XML library is no longer supported.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1"><span class="kw">library</span>(xml2)</a>
<a class="sourceLine" id="cb81-2" title="2"><span class="kw">library</span>(tidyverse)</a></code></pre></div>
<pre><code>## Registered S3 method overwritten by &#39;rvest&#39;:
##   method            from
##   read_xml.response xml2</code></pre>
<pre><code>## -- Attaching packages ------------------------------------- tidyverse 1.2.1 --</code></pre>
<pre><code>## v ggplot2 3.2.1     v readr   1.3.1
## v tibble  3.0.1     v purrr   0.3.2
## v tidyr   1.0.0     v stringr 1.4.0
## v ggplot2 3.2.1     v forcats 0.4.0</code></pre>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 3.6.1</code></pre>
<pre><code>## Warning: package &#39;tibble&#39; was built under R version 3.6.3</code></pre>
<pre><code>## Warning: package &#39;tidyr&#39; was built under R version 3.6.1</code></pre>
<pre><code>## -- Conflicts ---------------------------------------- tidyverse_conflicts() --
## x lubridate::as.difftime() masks base::as.difftime()
## x tidyjson::bind_rows()    masks dplyr::bind_rows()
## x lubridate::date()        masks base::date()
## x tidyjson::filter()       masks dplyr::filter(), stats::filter()
## x lubridate::intersect()   masks base::intersect()
## x dplyr::lag()             masks stats::lag()
## x lubridate::setdiff()     masks base::setdiff()
## x lubridate::union()       masks base::union()</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1">t&lt;-<span class="kw">read_xml</span>(<span class="st">&quot;./Data-Use/WB-Beds/API_SH.MED.BEDS.ZS_DS2_en_xml_v2_994608.xml&quot;</span>)</a>
<a class="sourceLine" id="cb89-2" title="2">recs &lt;-<span class="st"> </span><span class="kw">xml_find_all</span>(t, <span class="st">&quot;//record&quot;</span>)</a>
<a class="sourceLine" id="cb89-3" title="3"><span class="co"># extract and clean all the columns</span></a>
<a class="sourceLine" id="cb89-4" title="4">vals &lt;-<span class="st"> </span><span class="kw">trimws</span>(<span class="kw">xml_text</span>(recs))</a></code></pre></div>
</div>
<div id="dicom-nifti-and-minc-format" class="section level3">
<h3><span class="header-section-number">3.2.5</span> DICOM, nifti and minc format</h3>
<p>R can handle a variety of different data format. Medical images are stored as Digital Imaging and Communications in Medicine or <em>DICOM</em> files for handling and converted to Neuroimaging Informatics Technology Initiative or <em>nifti</em> files for analysis. DICOM files have x-axis arranged right to left, y-axis arranged anterior to posterior and z-axis arranged inferior to superior. NIFTI files are adapted from ANALYZE 7.5 format and integrate the seaprate header and image files from ANALYZE format. The workhorses are the <em>oro.dicom</em> and <em>oro.nifti</em> libraries. The package <em>oro.nifti</em> treat <em>nifti</em> as an S4 class object with multiple slots for data type. These slots can be accessed by typing the @ after the handle of the file. The MINC 1.0 refers to Medical Imaging (Network Common Data Format (NetCDF) <span class="citation">(Vincent et al. <a href="#ref-10.3389/fninf.2016.00035">2016</a>)</span>. This file format was developed so that the metadata of the images including processing history can be stored; this was not possible with the ANALYZE format. The current version of MINC 2.0 uses HDF5 (The HDF Group, 1997–2015). This format has a hierarchical structure.</p>
<p>The standard brain template is MNI152. The MNI template was created usinng 152 male right handed 23 year old medical students at MNI <span class="citation">(Collins et al. <a href="#ref-pmid8126267">1994</a>)</span>. A high resolution brain known as Big Brain was created on 3T at 20 micrometers <span class="citation">(Amunts et al. <a href="#ref-Amunts1472">2013</a>)</span></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1"><span class="kw">library</span>(oro.nifti)</a></code></pre></div>
<pre><code>## Warning: package &#39;oro.nifti&#39; was built under R version 3.6.1</code></pre>
<pre><code>## oro.nifti 0.9.1</code></pre>
<pre><code>## 
## Attaching package: &#39;oro.nifti&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     slice</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb95-2" title="2">dims =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">5</span>, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb95-3" title="3">SimArr =<span class="st"> </span><span class="kw">array</span>(<span class="kw">rnorm</span>(<span class="dv">5</span><span class="op">*</span><span class="dv">5</span><span class="op">*</span><span class="dv">5</span>), <span class="dt">dim =</span> dims)</a>
<a class="sourceLine" id="cb95-4" title="4">SimIm =<span class="st"> </span>oro.nifti<span class="op">::</span><span class="kw">nifti</span>(SimArr)</a>
<a class="sourceLine" id="cb95-5" title="5"><span class="kw">print</span>(SimIm)</a></code></pre></div>
<pre><code>## NIfTI-1 format
##   Type            : nifti
##   Data Type       : 2 (UINT8)
##   Bits per Pixel  : 8
##   Slice Code      : 0 (Unknown)
##   Intent Code     : 0 (None)
##   Qform Code      : 0 (Unknown)
##   Sform Code      : 0 (Unknown)
##   Dimension       : 5 x 5 x 5
##   Pixel Dimension : 1 x 1 x 1
##   Voxel Units     : Unknown
##   Time Units      : Unknown</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1">neurobase<span class="op">::</span><span class="kw">ortho2</span>(SimIm)</a></code></pre></div>
<pre><code>## Registered S3 method overwritten by &#39;R.oo&#39;:
##   method        from       
##   throw.default R.methodsS3</code></pre>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/create%20nifti-1.png" width="672" /></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1"><span class="kw">library</span>(oro.nifti)</a>
<a class="sourceLine" id="cb99-2" title="2">mca&lt;-<span class="kw">readNIfTI</span>(<span class="st">&quot;./Data-Use/mca_notpa.nii.gz&quot;</span>, <span class="dt">reorient =</span> <span class="ot">FALSE</span>) </a>
<a class="sourceLine" id="cb99-3" title="3"><span class="kw">print</span>(mca)</a></code></pre></div>
<pre><code>## NIfTI-1 format
##   Type            : nifti
##   Data Type       : 16 (FLOAT32)
##   Bits per Pixel  : 32
##   Slice Code      : 0 (Unknown)
##   Intent Code     : 0 (None)
##   Qform Code      : 0 (Unknown)
##   Sform Code      : 1 (Scanner_Anat)
##   Dimension       : 91 x 109 x 91
##   Pixel Dimension : 2 x 2 x 2
##   Voxel Units     : mm
##   Time Units      : sec</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1"><span class="co">#plot mca </span></a>
<a class="sourceLine" id="cb101-2" title="2"><span class="kw">image</span>(mca[<span class="dv">50</span>,,]) <span class="co">#sagittal</span></a></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/nifti-1.png" width="672" /></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1"><span class="kw">image</span>(mca[,<span class="dv">70</span>,]) <span class="co">#coronal</span></a></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/nifti-2.png" width="672" /></p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1"><span class="kw">image</span>(mca[,,<span class="dv">35</span>]) <span class="co">#axial</span></a></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/nifti-3.png" width="672" /></p>
<div id="manipulating-array" class="section level4">
<h4><span class="header-section-number">3.2.5.1</span> Manipulating array</h4>
<p>The imaging data are stored as arrays within the <em>.Data</em> slot in nifti.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" title="1"><span class="kw">library</span>(oro.nifti)</a>
<a class="sourceLine" id="cb104-2" title="2"><span class="co">#extract data as array using @ function</span></a>
<a class="sourceLine" id="cb104-3" title="3">img&lt;-<span class="kw">readNIfTI</span>(<span class="st">&quot;./Data-Use/mca_notpa.nii.gz&quot;</span>, <span class="dt">reorient =</span> <span class="ot">FALSE</span>) </a>
<a class="sourceLine" id="cb104-4" title="4">k&lt;-img<span class="op">@</span>.Data</a>
<a class="sourceLine" id="cb104-5" title="5"><span class="co">#channge x orientation to right to left 91*109*91</span></a>
<a class="sourceLine" id="cb104-6" title="6">k1&lt;-k[<span class="dv">91</span><span class="op">:</span><span class="dv">1</span>,,] </a>
<a class="sourceLine" id="cb104-7" title="7"><span class="kw">image</span>(k1[,,<span class="dv">35</span>])</a></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/image%20array-1.png" width="672" /></p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" title="1">img2&lt;-img</a>
<a class="sourceLine" id="cb105-2" title="2"><span class="co">#find available of slots</span></a>
<a class="sourceLine" id="cb105-3" title="3"><span class="kw">slotNames</span>(img)</a></code></pre></div>
<pre><code>##  [1] &quot;.Data&quot;          &quot;sizeof_hdr&quot;     &quot;data_type&quot;      &quot;db_name&quot;       
##  [5] &quot;extents&quot;        &quot;session_error&quot;  &quot;regular&quot;        &quot;dim_info&quot;      
##  [9] &quot;dim_&quot;           &quot;intent_p1&quot;      &quot;intent_p2&quot;      &quot;intent_p3&quot;     
## [13] &quot;intent_code&quot;    &quot;datatype&quot;       &quot;bitpix&quot;         &quot;slice_start&quot;   
## [17] &quot;pixdim&quot;         &quot;vox_offset&quot;     &quot;scl_slope&quot;      &quot;scl_inter&quot;     
## [21] &quot;slice_end&quot;      &quot;slice_code&quot;     &quot;xyzt_units&quot;     &quot;cal_max&quot;       
## [25] &quot;cal_min&quot;        &quot;slice_duration&quot; &quot;toffset&quot;        &quot;glmax&quot;         
## [29] &quot;glmin&quot;          &quot;descrip&quot;        &quot;aux_file&quot;       &quot;qform_code&quot;    
## [33] &quot;sform_code&quot;     &quot;quatern_b&quot;      &quot;quatern_c&quot;      &quot;quatern_d&quot;     
## [37] &quot;qoffset_x&quot;      &quot;qoffset_y&quot;      &quot;qoffset_z&quot;      &quot;srow_x&quot;        
## [41] &quot;srow_y&quot;         &quot;srow_z&quot;         &quot;intent_name&quot;    &quot;magic&quot;         
## [45] &quot;extender&quot;       &quot;reoriented&quot;</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" title="1">img2<span class="op">@</span>.Data &lt;-<span class="st"> </span>k1</a>
<a class="sourceLine" id="cb107-2" title="2"><span class="co">#write image to file</span></a>
<a class="sourceLine" id="cb107-3" title="3"><span class="co">#writeNIfTI(img2, &quot;tt&quot;)</span></a>
<a class="sourceLine" id="cb107-4" title="4"><span class="co">#unsigned angle between 2 vectors k and k1</span></a>
<a class="sourceLine" id="cb107-5" title="5">Morpho<span class="op">::</span><span class="kw">angle.calc</span>(k,k1)</a></code></pre></div>
<pre><code>## [1] 1.570771</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" title="1"><span class="co">#centre of gravity</span></a>
<a class="sourceLine" id="cb109-2" title="2">neurobase<span class="op">::</span><span class="kw">cog</span>(img)</a></code></pre></div>
<pre><code>##     dim1     dim2     dim3 
## 65.74983 53.09204 46.67048</code></pre>
</div>
<div id="math-operations" class="section level4">
<h4><span class="header-section-number">3.2.5.2</span> Math operations</h4>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" title="1"><span class="co">#stack arrays</span></a>
<a class="sourceLine" id="cb111-2" title="2">k2&lt;-<span class="kw">cbind</span>(k,k1) <span class="co">#cbind combines columns</span></a>
<a class="sourceLine" id="cb111-3" title="3"><span class="kw">dim</span>(k2) <span class="co">#902629 2</span></a></code></pre></div>
<pre><code>## [1] 902629      2</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1">ak2&lt;-<span class="kw">t</span>(<span class="kw">rbind</span>(k,k1)) <span class="co">#rbind combines rows, t transpose the rows</span></a>
<a class="sourceLine" id="cb113-2" title="2"><span class="kw">dim</span>(ak2) <span class="co"># 902629      2</span></a></code></pre></div>
<pre><code>## [1] 902629      2</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" title="1"><span class="co">#abind arrays</span></a>
<a class="sourceLine" id="cb115-2" title="2">ab&lt;-abind<span class="op">::</span><span class="kw">abind</span>(k,k1)</a>
<a class="sourceLine" id="cb115-3" title="3"><span class="kw">dim</span>(ab) <span class="co">#91 109 182</span></a></code></pre></div>
<pre><code>## [1]  91 109 182</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1">neurobase<span class="op">::</span><span class="kw">ortho2</span>(ab)</a></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/math%20nifti-1.png" width="672" /></p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" title="1"><span class="kw">dim</span>(ab)</a></code></pre></div>
<pre><code>## [1]  91 109 182</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" title="1"><span class="co">#sum array</span></a>
<a class="sourceLine" id="cb120-2" title="2">k3&lt;-k<span class="op">+</span>k1</a>
<a class="sourceLine" id="cb120-3" title="3"><span class="kw">dim</span>(k3) <span class="co">#91 109 91</span></a></code></pre></div>
<pre><code>## [1]  91 109  91</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" title="1">neurobase<span class="op">::</span><span class="kw">ortho2</span>(k3)</a></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/math%20nifti-2.png" width="672" /></p>
<p>The MNI brain template is the standard image for registration. It is obtained from 152 mainly right-handed male medical students.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" title="1"><span class="kw">library</span>(rgl)</a>
<a class="sourceLine" id="cb123-2" title="2"><span class="kw">library</span>(misc3d)</a>
<a class="sourceLine" id="cb123-3" title="3"><span class="kw">library</span>(neurobase)</a></code></pre></div>
<pre><code>## Warning: package &#39;neurobase&#39; was built under R version 3.6.1</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" title="1"><span class="kw">library</span>(aal)<span class="co">#devtools::install_github(&quot;muschellij2/aal&quot;)</span></a>
<a class="sourceLine" id="cb125-2" title="2"><span class="kw">library</span>(MNITemplate) <span class="co">#devtools::install_github(&quot;jfortin1/MNITemplate&quot;)</span></a>
<a class="sourceLine" id="cb125-3" title="3">img =<span class="st"> </span><span class="kw">aal_image</span>()</a>
<a class="sourceLine" id="cb125-4" title="4">template =<span class="st"> </span><span class="kw">readMNI</span>(<span class="dt">res =</span> <span class="st">&quot;2mm&quot;</span>)</a>
<a class="sourceLine" id="cb125-5" title="5">cut &lt;-<span class="st"> </span><span class="dv">4500</span></a>
<a class="sourceLine" id="cb125-6" title="6">dtemp &lt;-<span class="st"> </span><span class="kw">dim</span>(template)</a>
<a class="sourceLine" id="cb125-7" title="7"><span class="co"># All of the sections you can label</span></a>
<a class="sourceLine" id="cb125-8" title="8">labs =<span class="st"> </span><span class="kw">aal_get_labels</span>()</a>
<a class="sourceLine" id="cb125-9" title="9"><span class="co"># Pick the region of the brain you would like to highlight - in this case the hippocamus_L</span></a>
<a class="sourceLine" id="cb125-10" title="10"><span class="co">#hippocampus = labs$index[grep(&quot;Hippocampus_L&quot;, labs$name)]</span></a>
<a class="sourceLine" id="cb125-11" title="11"><span class="co">#load mca</span></a>
<a class="sourceLine" id="cb125-12" title="12">mca&lt;-<span class="kw">readNIfTI</span>(<span class="st">&quot;./Data-Use/mca_notpa.nii.gz&quot;</span>, <span class="dt">reorient =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb125-13" title="13">mca2&lt;-(mca<span class="op">&gt;</span><span class="fl">0.05</span>)<span class="op">*</span>mca</a>
<a class="sourceLine" id="cb125-14" title="14">mask =<span class="st"> </span><span class="kw">remake_img</span>(<span class="dt">vec =</span> img <span class="op">%in%</span><span class="st"> </span>mca2, <span class="dt">img =</span> img)</a>
<a class="sourceLine" id="cb125-15" title="15"><span class="co">### this would be the ``activation&#39;&#39; or surface you want to render </span></a>
<a class="sourceLine" id="cb125-16" title="16"><span class="kw">contour3d</span>(template, <span class="dt">x=</span><span class="dv">1</span><span class="op">:</span>dtemp[<span class="dv">1</span>], <span class="dt">y=</span><span class="dv">1</span><span class="op">:</span>dtemp[<span class="dv">2</span>], <span class="dt">z=</span><span class="dv">1</span><span class="op">:</span>dtemp[<span class="dv">3</span>], <span class="dt">level =</span> cut, <span class="dt">alpha =</span> <span class="fl">0.1</span>, <span class="dt">draw =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb125-17" title="17"><span class="kw">contour3d</span>(mask, <span class="dt">level =</span> <span class="kw">c</span>(<span class="fl">0.5</span>), <span class="dt">alpha =</span> <span class="kw">c</span>(<span class="fl">0.5</span>), <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">color=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>) )</a>
<a class="sourceLine" id="cb125-18" title="18"><span class="co">### add text</span></a>
<a class="sourceLine" id="cb125-19" title="19"><span class="kw">text3d</span>(<span class="dt">x=</span>dtemp[<span class="dv">1</span>]<span class="op">/</span><span class="dv">2</span>, <span class="dt">y=</span>dtemp[<span class="dv">2</span>]<span class="op">/</span><span class="dv">2</span>, <span class="dt">z =</span> dtemp[<span class="dv">3</span>]<span class="op">*</span><span class="fl">0.98</span>, <span class="dt">text=</span><span class="st">&quot;Top&quot;</span>)</a>
<a class="sourceLine" id="cb125-20" title="20"><span class="kw">text3d</span>(<span class="dt">x=</span><span class="op">-</span><span class="fl">0.98</span>, <span class="dt">y=</span>dtemp[<span class="dv">2</span>]<span class="op">/</span><span class="dv">2</span>, <span class="dt">z =</span> dtemp[<span class="dv">3</span>]<span class="op">/</span><span class="dv">2</span>, <span class="dt">text=</span><span class="st">&quot;Right&quot;</span>)</a>
<a class="sourceLine" id="cb125-21" title="21"><span class="co">#rglwidget()</span></a></code></pre></div>
<p>Up to now we have discussed handling of MRI scans. The library for segmenting hemorrhage on CT scan is <em>ichseg</em> <span class="citation">(Muschelli et al. <a href="#ref-muschelli2017pitchperfect">2017</a>)</span>. Its use require installation of <em>fsl</em>.</p>
</div>
<div id="tar-file" class="section level4">
<h4><span class="header-section-number">3.2.5.3</span> tar file</h4>
<p>Image files can be large and are often stored as tar files. The <em>tar</em> (tgz file), <em>untar</em>, <em>zip</em> (gz file) and <em>unzip</em> function are from the <em>utils</em> library. The <em>readNIfTI</em> call can open gz file without the need to call <em>unzip</em> function.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" title="1">colin_1mm&lt;-<span class="kw">untar</span>(<span class="st">&quot;./Data-Use/colin_1mm.tgz&quot;</span>)</a>
<a class="sourceLine" id="cb126-2" title="2">colinIm&lt;-<span class="kw">readNIfTI</span>(<span class="st">&quot;colin_1mm&quot;</span>) <span class="co">#1 x 1 x 1</span></a>
<a class="sourceLine" id="cb126-3" title="3"><span class="kw">class</span>(colinIm)</a></code></pre></div>
<pre><code>## [1] &quot;nifti&quot;
## attr(,&quot;package&quot;)
## [1] &quot;oro.nifti&quot;</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" title="1"><span class="co"># look at 2 images side by side</span></a>
<a class="sourceLine" id="cb128-2" title="2">neurobase<span class="op">::</span><span class="kw">double_ortho</span>(img, template)</a></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/tar%20file-1.png" width="672" /></p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" title="1"><span class="co">#combining colin and mca map</span></a>
<a class="sourceLine" id="cb129-2" title="2">img2&lt;-(img<span class="op">*</span><span class="dv">1000</span>)<span class="op">+</span>template<span class="op">/</span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb129-3" title="3">neurobase<span class="op">::</span><span class="kw">ortho2</span>(img2,<span class="dt">col.y =</span> <span class="kw">alpha</span>(<span class="st">&quot;red&quot;</span>,.<span class="dv">3</span>))</a></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/tar%20file-2.png" width="672" /></p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" title="1"><span class="kw">library</span>(RNiftyReg)</a></code></pre></div>
<pre><code>## Warning: package &#39;RNiftyReg&#39; was built under R version 3.6.1</code></pre>
<pre><code>## 
## Attaching package: &#39;RNiftyReg&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:oro.nifti&#39;:
## 
##     pixdim, pixdim&lt;-</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" title="1">epi_t2&lt;-<span class="st"> </span><span class="kw">readNIfTI</span>(<span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;epi_t2.nii.gz&quot;</span>, <span class="dt">package=</span><span class="st">&quot;RNiftyReg&quot;</span>))</a>
<a class="sourceLine" id="cb134-2" title="2"><span class="kw">class</span>(epi_t2)</a></code></pre></div>
<pre><code>## [1] &quot;nifti&quot;
## attr(,&quot;package&quot;)
## [1] &quot;oro.nifti&quot;</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" title="1">neurobase<span class="op">::</span><span class="kw">ortho2</span>(epi_t2) <span class="co">#2.5 2.5 2.5</span></a></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/tar%20file-3.png" width="672" /></p>
</div>
<div id="image-registration" class="section level4">
<h4><span class="header-section-number">3.2.5.4</span> Image registration</h4>
<p>There are many different libraries for performing registration.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" title="1"><span class="kw">library</span>(RNiftyReg)</a>
<a class="sourceLine" id="cb137-2" title="2">source &lt;-<span class="st"> </span><span class="kw">readNifti</span>(<span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;epi_t2.nii.gz&quot;</span>, <span class="dt">package=</span><span class="st">&quot;RNiftyReg&quot;</span>))</a>
<a class="sourceLine" id="cb137-3" title="3">target &lt;-<span class="st"> </span><span class="kw">readNifti</span>(<span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;flash_t1.nii.gz&quot;</span>, <span class="dt">package=</span><span class="st">&quot;RNiftyReg&quot;</span>))</a>
<a class="sourceLine" id="cb137-4" title="4">result &lt;-<span class="st"> </span><span class="kw">niftyreg</span>(source, target)</a>
<a class="sourceLine" id="cb137-5" title="5"><span class="co">#affine transformation</span></a>
<a class="sourceLine" id="cb137-6" title="6">result<span class="op">$</span>forwardTransforms</a></code></pre></div>
<pre><code>## [[1]]
## NiftyReg affine matrix:
##   0.99654954672    0.00006395929   -0.01666618139    0.38126888871
##  -0.00058156595    1.00101470947   -0.02364275604    0.42281147838
##   0.01961987652    0.01305449661    1.00201129913  -28.21409225464
##   0.00000000000    0.00000000000    0.00000000000    1.00000000000</code></pre>
</div>
</div>
<div id="mesh-generation" class="section level3">
<h3><span class="header-section-number">3.2.6</span> Mesh generation</h3>
<p>Generate 3D mesh from brain</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb139-1" title="1"><span class="kw">library</span>(Rvcg)</a></code></pre></div>
<pre><code>## Warning: package &#39;Rvcg&#39; was built under R version 3.6.3</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb141-1" title="1"><span class="kw">library</span>(oro.nifti)</a>
<a class="sourceLine" id="cb141-2" title="2"><span class="kw">library</span>(rgl)</a>
<a class="sourceLine" id="cb141-3" title="3"><span class="kw">library</span>(misc3d)</a>
<a class="sourceLine" id="cb141-4" title="4"><span class="co">###load image</span></a>
<a class="sourceLine" id="cb141-5" title="5">mca &lt;-<span class="st"> </span><span class="kw">readNIfTI</span>(<span class="st">&quot;./Data-Use/mca_notpa.nii.gz&quot;</span>)</a>
<a class="sourceLine" id="cb141-6" title="6">mca2=(mca<span class="op">*</span><span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb141-7" title="7"><span class="co">#array</span></a>
<a class="sourceLine" id="cb141-8" title="8">k&lt;-mca2<span class="op">@</span>.Data</a>
<a class="sourceLine" id="cb141-9" title="9"></a>
<a class="sourceLine" id="cb141-10" title="10"><span class="co">### Generate surface</span></a>
<a class="sourceLine" id="cb141-11" title="11">kmesh&lt;-<span class="kw">vcgIsosurface</span>(k, <span class="dt">threshold =</span> <span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb141-12" title="12"></a>
<a class="sourceLine" id="cb141-13" title="13"><span class="co">### decimate it</span></a>
<a class="sourceLine" id="cb141-14" title="14">kmesh &lt;-<span class="st"> </span><span class="kw">vcgQEdecim</span>(kmesh,<span class="dt">edgeLength =</span> <span class="dv">1</span>)</a></code></pre></div>
<pre><code>## Warning in vcgQEdecim(kmesh, edgeLength = 1): edges already shorter than
## required - nothing to do</code></pre>
<pre><code>## reducing it to 1943 faces
## Initial Heap Size 2592
## Result: 858 vertices and 1728 faces.
## Estimated error: 1.63298e-15 
## Mean Edge length is 1.06048258318692</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb144-1" title="1"><span class="co">### smooth it</span></a>
<a class="sourceLine" id="cb144-2" title="2">kmesh &lt;-<span class="st"> </span><span class="kw">vcgSmooth</span>(kmesh)</a>
<a class="sourceLine" id="cb144-3" title="3"></a>
<a class="sourceLine" id="cb144-4" title="4"><span class="co">### save it to disk </span></a>
<a class="sourceLine" id="cb144-5" title="5"><span class="kw">vcgPlyWrite</span>(kmesh)</a>
<a class="sourceLine" id="cb144-6" title="6"></a>
<a class="sourceLine" id="cb144-7" title="7"><span class="kw">shade3d</span>(<span class="kw">vcgSmooth</span>(kmesh,<span class="st">&quot;HC&quot;</span>,<span class="dt">iteration=</span><span class="dv">3</span>),<span class="dt">col=</span><span class="st">&quot;pink&quot;</span>) </a>
<a class="sourceLine" id="cb144-8" title="8"></a>
<a class="sourceLine" id="cb144-9" title="9">kbp &lt;-<span class="st"> </span><span class="kw">vcgBallPivoting</span>(kmesh, <span class="dt">radius =</span> <span class="fl">0.0022</span>, <span class="dt">clustering =</span> <span class="fl">0.2</span>, <span class="dt">angle =</span> pi<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb144-10" title="10"><span class="kw">shade3d</span>(kbp, <span class="dt">col =</span> <span class="kw">rainbow</span>(<span class="dv">1000</span>), <span class="dt">specular =</span> <span class="st">&quot;black&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in shade3d.mesh3d(kbp, col = rainbow(1000), specular = &quot;black&quot;):
## Default coloring for meshes changed in rgl 0.100.1</code></pre>
</div>
</div>
<div id="tidy-data" class="section level2">
<h2><span class="header-section-number">3.3</span> Tidy data</h2>
<p>Attention to collection of data is important as it shows the way for performing analysis. In general each row represents an observation (ie patient 1) and each column represents an attribute of that observation (ie patient 1 having CT abdomen). Avoid the temptation to embed 2 types of attributes into a column (avoid patient 1 having CT abdomen positive).</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" title="1">df2&lt;-<span class="kw">data.frame</span>(<span class="dt">Var=</span><span class="kw">c</span>(<span class="st">&quot;test positive&quot;</span>,<span class="st">&quot;test negative&quot;</span>), <span class="dt">Result=</span><span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">10</span>))</a>
<a class="sourceLine" id="cb146-2" title="2">df2</a></code></pre></div>
<pre><code>##             Var Result
## 1 test positive      5
## 2 test negative     10</code></pre>
<p>The above example should be entered this way. This change allows one to group variables by Test status: ‘positive’ or ‘negative’. One can easily perform a t test here (not recommend in this case as the data contains only 2 rows).</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" title="1">df2&lt;-<span class="kw">data.frame</span>(<span class="dt">Test=</span><span class="kw">c</span>(<span class="st">&quot;positive&quot;</span>,<span class="st">&quot;negative&quot;</span>), <span class="dt">Result=</span><span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">10</span>))</a>
<a class="sourceLine" id="cb148-2" title="2">df2</a></code></pre></div>
<pre><code>##       Test Result
## 1 positive      5
## 2 negative     10</code></pre>
<p>The below example is about collapsing of column using the base R.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb150-1" title="1">dfa&lt;-<span class="kw">data.frame</span>(<span class="dt">City=</span><span class="kw">c</span>(<span class="st">&quot;Melbourne&quot;</span>,<span class="st">&quot;Sydney&quot;</span>,<span class="st">&quot;Adelaide&quot;</span>),<span class="dt">State=</span><span class="kw">c</span>(<span class="st">&quot;Victoria&quot;</span>,<span class="st">&quot;NSW&quot;</span>,<span class="st">&quot;South Australia&quot;</span>))</a>
<a class="sourceLine" id="cb150-2" title="2"><span class="co">#collapsing City and State columns and generate new column address</span></a>
<a class="sourceLine" id="cb150-3" title="3">dfa<span class="op">$</span>addresses&lt;-<span class="kw">paste0</span>(dfa<span class="op">$</span>City,<span class="st">&quot;,&quot;</span>, dfa<span class="op">$</span>State) <span class="co">#separate by comma</span></a>
<a class="sourceLine" id="cb150-4" title="4">dfa<span class="op">$</span>addresses2&lt;-<span class="kw">paste0</span>(dfa<span class="op">$</span>City,<span class="st">&quot;,&quot;</span>, dfa<span class="op">$</span>State,<span class="st">&quot;, Australia&quot;</span>)</a>
<a class="sourceLine" id="cb150-5" title="5">dfa</a></code></pre></div>
<pre><code>##        City           State                addresses
## 1 Melbourne        Victoria       Melbourne,Victoria
## 2    Sydney             NSW               Sydney,NSW
## 3  Adelaide South Australia Adelaide,South Australia
##                            addresses2
## 1       Melbourne,Victoria, Australia
## 2               Sydney,NSW, Australia
## 3 Adelaide,South Australia, Australia</code></pre>
<p>This exanple is same as above but uses verbs from <em>tidyr</em>. This is useful for collapsing address for geocoding.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb152-1" title="1"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb152-2" title="2">dfa1&lt;-dfa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unite</span> (<span class="st">&quot;new_address&quot;</span>,City<span class="op">:</span>State,<span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</a>
<a class="sourceLine" id="cb152-3" title="3">dfa1</a></code></pre></div>
<pre><code>##                new_address                addresses
## 1       Melbourne,Victoria       Melbourne,Victoria
## 2               Sydney,NSW               Sydney,NSW
## 3 Adelaide,South Australia Adelaide,South Australia
##                            addresses2
## 1       Melbourne,Victoria, Australia
## 2               Sydney,NSW, Australia
## 3 Adelaide,South Australia, Australia</code></pre>
<p>Using the data above, let’s split the column address</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb154-1" title="1"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb154-2" title="2">dfa2&lt;-dfa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">separate</span>(addresses, <span class="kw">c</span>(<span class="st">&quot;City2&quot;</span>, <span class="st">&quot;State2&quot;</span>))</a></code></pre></div>
<pre><code>## Warning: Expected 2 pieces. Additional pieces discarded in 1 rows [3].</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb156-1" title="1">dfa2</a></code></pre></div>
<pre><code>##        City           State     City2   State2
## 1 Melbourne        Victoria Melbourne Victoria
## 2    Sydney             NSW    Sydney      NSW
## 3  Adelaide South Australia  Adelaide    South
##                            addresses2
## 1       Melbourne,Victoria, Australia
## 2               Sydney,NSW, Australia
## 3 Adelaide,South Australia, Australia</code></pre>
<div id="factors" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Factors</h3>
<p>There are several types of factors in R: ordered and not ordered. It is important to pay attention to how factors are coded. Sometimes, male is represented as 1 and female as 0. Sometimes, female is represented as 2. This discussion may seems trivial but a paper had been retracted in a high impact factor journal Jama because of miscoding of the trial assignment 1 and 2 rather than the assignment of 0 and 1. This error led to reversing the results with logistic regression <span class="citation">(Aboumatar and Wise <a href="#ref-pmid31593277">2019</a>)</span>. This error led to report that an outpatient management program for chronic obstructive pulmonary disease resulted in fewer admissions. Below is an example which can occur when data is transformed into factor and back to number. Note that the coding goes from 0 and 1 to 2 and 1.</p>
<p>In certain analyses, the libraries prefer to use the dependent or outcome variable as binary coding in numeric format eg logistic regression and random forest. The library <em>e1071</em> for performing supprt vector machine prefers the outcome variable as factor.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb158-1" title="1"><span class="kw">library</span>(Stat2Data)</a>
<a class="sourceLine" id="cb158-2" title="2"><span class="kw">data</span>(<span class="st">&quot;Leukemia&quot;</span>) <span class="co">#treatment of leukemia</span></a>
<a class="sourceLine" id="cb158-3" title="3">Leukemia<span class="op">$</span>Resp</a></code></pre></div>
<pre><code>##  [1] 1 1 1 1 1 0 1 1 1 0 1 1 0 1 0 1 1 0 1 1 0 0 0 0 1 1 0 0 1 0 1 0 0 0 0
## [36] 0 0 0 0 1 0 0 0 1 0 0 1 0 1 1 0</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb160-1" title="1">Leukemia<span class="op">$</span>Response.factor&lt;-<span class="kw">as.factor</span>(Leukemia<span class="op">$</span>Resp)</a>
<a class="sourceLine" id="cb160-2" title="2">Leukemia<span class="op">$</span>Response.factor</a></code></pre></div>
<pre><code>##  [1] 1 1 1 1 1 0 1 1 1 0 1 1 0 1 0 1 1 0 1 1 0 0 0 0 1 1 0 0 1 0 1 0 0 0 0
## [36] 0 0 0 0 1 0 0 0 1 0 0 1 0 1 1 0
## Levels: 0 1</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb162-1" title="1">Leukemia<span class="op">$</span>Response.numeric&lt;-<span class="kw">as.numeric</span>(Leukemia<span class="op">$</span>Response.factor)</a>
<a class="sourceLine" id="cb162-2" title="2">Leukemia<span class="op">$</span>Response.numeric</a></code></pre></div>
<pre><code>##  [1] 2 2 2 2 2 1 2 2 2 1 2 2 1 2 1 2 2 1 2 2 1 1 1 1 2 2 1 1 2 1 2 1 1 1 1
## [36] 1 1 1 1 2 1 1 1 2 1 1 2 1 2 2 1</code></pre>
<p>This illustration describes conversion of a continuous variable into orderly factors.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb164-1" title="1"><span class="kw">library</span>(Stat2Data)</a>
<a class="sourceLine" id="cb164-2" title="2"><span class="kw">data</span>(<span class="st">&quot;Leukemia&quot;</span>) <span class="co">#treatment of leukemia</span></a>
<a class="sourceLine" id="cb164-3" title="3"><span class="co">#partition Age into 8 ordered factors</span></a>
<a class="sourceLine" id="cb164-4" title="4">Leukemia<span class="op">$</span>AgeCat&lt;-ggplot2<span class="op">::</span><span class="kw">cut_interval</span>(Leukemia<span class="op">$</span>Age, <span class="dt">n=</span><span class="dv">8</span>, <span class="dt">ordered_result=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb164-5" title="5"><span class="kw">class</span>(Leukemia<span class="op">$</span>AgeCat)</a></code></pre></div>
<pre><code>## [1] &quot;ordered&quot; &quot;factor&quot;</code></pre>
</div>
<div id="multiple-files" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Multiple files</h3>
<p>Merging of files can be done using <em>dplyr</em> to perform <em>inner_join</em>, <em>outer_join</em>, <em>left_join</em> and <em>right_join</em>. Note that this can also be done in base R or using syntax of <em>data.table</em>.</p>
</div>
<div id="pivot" class="section level3">
<h3><span class="header-section-number">3.3.3</span> Pivot</h3>
<p>A variety of different expressions are used to describe data format such as wide and long formats. In some case the distinction between such formats is not clear. The verbs for performing these operations are <em>pivot_wide</em>, <em>pivot_long</em>. Again <em>data.table</em> uses different verbs such as <em>cast</em> and <em>melt</em>. In general, most regression analyses are performed with data in wide format. In this case each row represents a unique ID. Longitudinal analyses are performed with data in long format. In this format, there are several rows with the same ID. In the next Chapter on Statistics, an example of data generated in wide format and coverted to long format using <em>plyr</em>. Here we will demonstrate the use of <em>tidyr</em> to pivot loner or wider.</p>
<p>The best way to think about how data should be presented is that data is analyzed according to columns not rows. The data below is extracted from CDC COVID website. Details are given below under Web scraping on how this task was performed.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb166-1" title="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb166-2" title="2"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb166-3" title="3"><span class="kw">library</span>(stringr)</a>
<a class="sourceLine" id="cb166-4" title="4">usa&lt;-<span class="kw">read.csv</span>(<span class="st">&quot;./Data-Use/Covid_bystate_Table130420.csv&quot;</span>)</a>
<a class="sourceLine" id="cb166-5" title="5"><span class="co"># for demonstration we will select 3 columns of interest</span></a>
<a class="sourceLine" id="cb166-6" title="6">usa_long &lt;-usa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(Jurisdiction,NumberCases31.<span class="fl">03.20</span>,NumberCases07.<span class="fl">04.20</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_longer</span>(<span class="op">-</span>Jurisdiction,<span class="dt">names_to =</span> <span class="st">&quot;Date&quot;</span>,<span class="dt">values_to =</span> <span class="st">&quot;Number.Cases&quot;</span>)  </a>
<a class="sourceLine" id="cb166-7" title="7">usa_long<span class="op">$</span>Date &lt;-<span class="st"> </span><span class="kw">str_replace</span>(usa_long<span class="op">$</span>Date,<span class="st">&quot;NumberCases&quot;</span>,<span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb166-8" title="8"><span class="kw">head</span>(usa <span class="op">%&gt;%</span><span class="kw">select</span>(Jurisdiction,NumberCases31.<span class="fl">03.20</span>,NumberCases07.<span class="fl">04.20</span>),<span class="dv">6</span>) <span class="co">#data in wide format</span></a></code></pre></div>
<pre><code>##   Jurisdiction NumberCases31.03.20 NumberCases07.04.20
## 1      Alabama                 999                2197
## 2       Alaska                 133                 213
## 3      Arizona                1289                2575
## 4     Arkansas                 560                 993
## 5   California                8131               15865
## 6     Colorado                2966                5429</code></pre>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb168-1" title="1"><span class="kw">head</span>(usa_long,<span class="dv">6</span>) <span class="co">#data in long format</span></a></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   Jurisdiction Date     Number.Cases
##   &lt;fct&gt;        &lt;chr&gt;           &lt;int&gt;
## 1 Alabama      31.03.20          999
## 2 Alabama      07.04.20         2197
## 3 Alaska       31.03.20          133
## 4 Alaska       07.04.20          213
## 5 Arizona      31.03.20         1289
## 6 Arizona      07.04.20         2575</code></pre>
<p>This second illustrates that sometimes the <em>pivot_long</em> call helps to organise data in wide format. This dataset is taken from article in Jama on variations in death in New York.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb170-1" title="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb170-2" title="2">dfj&lt;-<span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb170-3" title="3"><span class="dt">Borough=</span><span class="kw">c</span>(<span class="st">&quot;Bronx&quot;</span>,<span class="st">&quot;Brooklyn&quot;</span>,<span class="st">&quot;Manhattan&quot;</span>,<span class="st">&quot;Queens&quot;</span>,<span class="st">&quot;Staten Island&quot;</span>),</a>
<a class="sourceLine" id="cb170-4" title="4"><span class="dt">Pop=</span><span class="kw">c</span>(<span class="dv">1432132</span>,<span class="dv">2582830</span>,<span class="dv">1628701</span>,<span class="dv">2278906</span>,<span class="dv">476179</span>),</a>
<a class="sourceLine" id="cb170-5" title="5"><span class="dt">Age65=</span><span class="kw">c</span>(<span class="fl">12.8</span>,<span class="fl">13.9</span>,<span class="fl">16.5</span>,<span class="fl">15.7</span>,<span class="fl">16.2</span>),</a>
<a class="sourceLine" id="cb170-6" title="6"><span class="dt">White=</span><span class="kw">c</span>(<span class="fl">25.1</span>,<span class="fl">46.6</span>,<span class="fl">59.2</span>,<span class="fl">39.6</span>,<span class="fl">75.1</span>),</a>
<a class="sourceLine" id="cb170-7" title="7"><span class="dt">Hispanic=</span><span class="kw">c</span>(<span class="fl">56.4</span>,<span class="fl">19.1</span>,<span class="fl">25.9</span>,<span class="fl">28.1</span>,<span class="fl">18.7</span>),</a>
<a class="sourceLine" id="cb170-8" title="8"><span class="dt">Afro.American=</span><span class="kw">c</span>(<span class="fl">38.3</span>,<span class="fl">33.5</span>,<span class="fl">16.9</span>,<span class="fl">19.9</span>,<span class="fl">11.5</span>),</a>
<a class="sourceLine" id="cb170-9" title="9"><span class="dt">Asian=</span><span class="kw">c</span>(<span class="fl">4.6</span>,<span class="fl">13.4</span>,<span class="dv">14</span>,<span class="fl">27.5</span>,<span class="dv">11</span>),</a>
<a class="sourceLine" id="cb170-10" title="10"><span class="dt">Others=</span><span class="kw">c</span>(<span class="fl">36.8</span>,<span class="fl">10.4</span>,<span class="fl">15.4</span>,<span class="dv">17</span>,<span class="fl">5.2</span>),</a>
<a class="sourceLine" id="cb170-11" title="11"><span class="dt">Income=</span><span class="kw">c</span>(<span class="dv">38467</span>,<span class="dv">61220</span>,<span class="dv">85066</span>,<span class="dv">69320</span>,<span class="dv">82166</span>),</a>
<a class="sourceLine" id="cb170-12" title="12"><span class="dt">Beds=</span><span class="kw">c</span>(<span class="dv">336</span>,<span class="dv">214</span>,<span class="dv">534</span>,<span class="dv">144</span>,<span class="dv">234</span>),</a>
<a class="sourceLine" id="cb170-13" title="13"><span class="dt">COVIDtest=</span><span class="kw">c</span>(<span class="dv">4599</span>,<span class="dv">2970</span>,<span class="dv">2844</span>,<span class="dv">3800</span>,<span class="dv">5603</span>),</a>
<a class="sourceLine" id="cb170-14" title="14"><span class="dt">COVIDhosp=</span><span class="kw">c</span>(<span class="dv">634</span>,<span class="dv">400</span>,<span class="dv">331</span>,<span class="dv">560</span>,<span class="dv">370</span>),</a>
<a class="sourceLine" id="cb170-15" title="15"><span class="dt">COVIDdeath=</span><span class="kw">c</span>(<span class="dv">224</span>,<span class="dv">181</span>,<span class="dv">122</span>,<span class="dv">200</span>,<span class="dv">143</span>),</a>
<a class="sourceLine" id="cb170-16" title="16"><span class="dt">COVIDdeathlab=</span><span class="kw">c</span>(<span class="dv">173</span>,<span class="dv">132</span>,<span class="dv">91</span>,<span class="dv">154</span>,<span class="dv">117</span>)</a>
<a class="sourceLine" id="cb170-17" title="17">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb170-18" title="18"><span class="st">  </span><span class="co">#reverse prevalence per 100000 to raw</span></a>
<a class="sourceLine" id="cb170-19" title="19"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Age65raw=</span><span class="kw">round</span>(Age65<span class="op">/</span><span class="dv">100</span><span class="op">*</span>Pop,<span class="dv">0</span>),</a>
<a class="sourceLine" id="cb170-20" title="20">               <span class="dt">Bedsraw=</span><span class="kw">round</span>(Beds<span class="op">/</span><span class="dv">100000</span><span class="op">*</span>Pop,<span class="dv">0</span>),</a>
<a class="sourceLine" id="cb170-21" title="21">               <span class="dt">COVIDtestraw=</span><span class="kw">round</span>(COVIDtest<span class="op">/</span><span class="dv">100000</span><span class="op">*</span>Pop,<span class="dv">0</span>),</a>
<a class="sourceLine" id="cb170-22" title="22">               <span class="dt">COVIDhospraw=</span><span class="kw">round</span>(COVIDhosp<span class="op">/</span><span class="dv">100000</span><span class="op">*</span>Pop,<span class="dv">0</span>),</a>
<a class="sourceLine" id="cb170-23" title="23">               <span class="dt">COVIDdeathraw=</span><span class="kw">round</span>(COVIDdeath<span class="op">/</span><span class="dv">100000</span><span class="op">*</span>Pop),<span class="dv">0</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb170-24" title="24"><span class="co">#move all ethnic types under Ethnicity and percentage to Proportion</span></a>
<a class="sourceLine" id="cb170-25" title="25"><span class="kw">pivot_longer</span>(<span class="dt">names_to =</span> <span class="st">&quot;Ethnicity&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;Proportion&quot;</span>,<span class="dt">cols=</span><span class="kw">c</span>(White,Afro.American,Asian,Hispanic,Others))</a></code></pre></div>
</div>
</div>
<div id="regular-expressions" class="section level2">
<h2><span class="header-section-number">3.4</span> Regular Expressions</h2>
<p>Here is a short tutorial on regular expression. We will begin using base R. This section is based on experience trying to clean a data frame containing many words used to describe one disease or one drug.</p>
<div id="base-r" class="section level3">
<h3><span class="header-section-number">3.4.1</span> base R</h3>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb171-1" title="1"><span class="co">#create example dataframe</span></a>
<a class="sourceLine" id="cb171-2" title="2">df&lt;-<span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb171-3" title="3">  <span class="dt">drug=</span><span class="kw">c</span>(<span class="st">&quot;valium 1mg&quot;</span>,<span class="st">&quot;verapamil sr&quot;</span>,<span class="st">&quot;betaloc zoc&quot;</span>,<span class="st">&quot;tramadol&quot;</span>,<span class="st">&quot;valium (diazepam)&quot;</span>),</a>
<a class="sourceLine" id="cb171-4" title="4">  <span class="dt">infection=</span><span class="kw">c</span>(<span class="st">&quot;pneumonia&quot;</span>,<span class="st">&quot;aspiration pneumonia&quot;</span>,<span class="st">&quot;tracheobronchitis&quot;</span>,<span class="st">&quot;respiratory tract infection&quot;</span>,<span class="st">&quot;respiratory.tract.infection&quot;</span>))</a>
<a class="sourceLine" id="cb171-5" title="5">df</a></code></pre></div>
<pre><code>##                drug                   infection
## 1        valium 1mg                   pneumonia
## 2      verapamil sr        aspiration pneumonia
## 3       betaloc zoc           tracheobronchitis
## 4          tramadol respiratory tract infection
## 5 valium (diazepam) respiratory.tract.infection</code></pre>
<p>Now that we have a data frame, we can use pattern matching to replace part of phrase. This step can be done simply using <em>gsub</em> command. First create a list so that the computer searches the phrases in the list.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb173-1" title="1"><span class="co">#create list to remove phrase</span></a>
<a class="sourceLine" id="cb173-2" title="2">redun=<span class="kw">c</span>(<span class="st">&quot;1mg&quot;</span>, <span class="st">&quot;zoc&quot;</span>, <span class="st">&quot;sr&quot;</span>)</a>
<a class="sourceLine" id="cb173-3" title="3">pat=<span class="kw">paste0</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">b(&quot;</span>,<span class="kw">paste0</span>(redun,<span class="dt">collapse =</span> <span class="st">&quot;|&quot;</span>),<span class="st">&quot;)</span><span class="ch">\\</span><span class="st">b&quot;</span>)</a>
<a class="sourceLine" id="cb173-4" title="4">df<span class="op">$</span>drug1&lt;-<span class="kw">gsub</span>(pat,<span class="st">&quot;&quot;</span>,df<span class="op">$</span>drug)</a>
<a class="sourceLine" id="cb173-5" title="5">df<span class="op">$</span>drug1</a></code></pre></div>
<pre><code>## [1] &quot;valium &quot;           &quot;verapamil &quot;        &quot;betaloc &quot;         
## [4] &quot;tramadol&quot;          &quot;valium (diazepam)&quot;</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb175-1" title="1"><span class="co">#create list to remove phrase</span></a>
<a class="sourceLine" id="cb175-2" title="2">redunc1=<span class="kw">c</span>(<span class="st">&quot;respiratory tract infection&quot;</span>, <span class="st">&quot;tracheobronchitis&quot;</span>, <span class="st">&quot;aspiration&quot;</span>)</a>
<a class="sourceLine" id="cb175-3" title="3">pat=<span class="kw">paste0</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">b(&quot;</span>,<span class="kw">paste0</span>(redunc1,<span class="dt">collapse =</span> <span class="st">&quot;|&quot;</span>),<span class="st">&quot;)</span><span class="ch">\\</span><span class="st">b&quot;</span>)</a>
<a class="sourceLine" id="cb175-4" title="4">df<span class="op">$</span>infection1&lt;-<span class="kw">gsub</span>(pat,<span class="st">&quot;&quot;</span>,df<span class="op">$</span>infection)</a>
<a class="sourceLine" id="cb175-5" title="5">df<span class="op">$</span>infection1</a></code></pre></div>
<pre><code>## [1] &quot;pneumonia&quot;                   &quot; pneumonia&quot;                 
## [3] &quot;&quot;                            &quot;&quot;                           
## [5] &quot;respiratory.tract.infection&quot;</code></pre>
<p>This section deals with meta-characterers. Examples of meta-characters include $ . + * ? ^ () {} []. These meta-characters requires the double back slashes \.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb177-1" title="1"><span class="co">#create list to remove phrase</span></a>
<a class="sourceLine" id="cb177-2" title="2">redun=<span class="kw">c</span>(<span class="st">&quot;1mg&quot;</span>, <span class="st">&quot;zoc&quot;</span>, <span class="st">&quot;sr&quot;</span>)</a>
<a class="sourceLine" id="cb177-3" title="3">pat=<span class="kw">paste0</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">b(&quot;</span>,<span class="kw">paste0</span>(redun, <span class="dt">collapse =</span> <span class="st">&quot;|&quot;</span>),<span class="st">&quot;)</span><span class="ch">\\</span><span class="st">b&quot;</span>)   </a>
<a class="sourceLine" id="cb177-4" title="4">df<span class="op">$</span>drug2&lt;-<span class="kw">gsub</span>(pat,<span class="st">&quot;&quot;</span>,df<span class="op">$</span>drug)</a>
<a class="sourceLine" id="cb177-5" title="5"></a>
<a class="sourceLine" id="cb177-6" title="6"><span class="co">#[a-z] indicates any letter</span></a>
<a class="sourceLine" id="cb177-7" title="7"><span class="co">#[a-z]+ indicates any letter and those that follow the intial letter</span></a>
<a class="sourceLine" id="cb177-8" title="8">df<span class="op">$</span>drug2&lt;-<span class="kw">gsub</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">(|[a-z]+</span><span class="ch">\\</span><span class="st">)&quot;</span>,<span class="st">&quot;&quot;</span>,df<span class="op">$</span>drug2)</a>
<a class="sourceLine" id="cb177-9" title="9">df<span class="op">$</span>drug2</a></code></pre></div>
<pre><code>## [1] &quot;valium &quot;    &quot;verapamil &quot; &quot;betaloc &quot;   &quot;tramadol&quot;   &quot;valium &quot;</code></pre>
<p>Back to our data frame df, we want to remove the change the different words accounting for pneumonia.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb179-1" title="1">redunc=<span class="kw">c</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">.&quot;</span>)</a>
<a class="sourceLine" id="cb179-2" title="2">redunc1=<span class="kw">c</span>(<span class="st">&quot;respiratory tract infection&quot;</span>, <span class="st">&quot;tracheobronchitis&quot;</span>, <span class="st">&quot;aspiration&quot;</span>)</a>
<a class="sourceLine" id="cb179-3" title="3">pat=<span class="kw">paste0</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">b(&quot;</span>,<span class="kw">paste0</span>(redunc,<span class="dt">collapse =</span> <span class="st">&quot;|&quot;</span>),<span class="st">&quot;)</span><span class="ch">\\</span><span class="st">b&quot;</span>)</a>
<a class="sourceLine" id="cb179-4" title="4">df<span class="op">$</span>infection2&lt;-<span class="kw">gsub</span>(pat,<span class="st">&quot; &quot;</span>,df<span class="op">$</span>infection)</a>
<a class="sourceLine" id="cb179-5" title="5">pat=<span class="kw">paste0</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">b(&quot;</span>,<span class="kw">paste0</span>(redunc1,<span class="dt">collapse =</span> <span class="st">&quot;|&quot;</span>),<span class="st">&quot;)</span><span class="ch">\\</span><span class="st">b&quot;</span>)</a>
<a class="sourceLine" id="cb179-6" title="6">df<span class="op">$</span>infection2&lt;-<span class="kw">gsub</span>(pat,<span class="st">&quot; &quot;</span>,df<span class="op">$</span>infection2)</a>
<a class="sourceLine" id="cb179-7" title="7">df<span class="op">$</span>infection2</a></code></pre></div>
<pre><code>## [1] &quot;pneumonia&quot;   &quot;  pneumonia&quot; &quot; &quot;           &quot; &quot;           &quot; &quot;</code></pre>
</div>
<div id="stringr" class="section level3">
<h3><span class="header-section-number">3.4.2</span> stringr</h3>
<p>The following examples are taken from excel after conversion from pdf. In the process of conversion errors were introduced in the conversion from pdf to excel.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb181-1" title="1"><span class="kw">library</span>(stringr)</a>
<a class="sourceLine" id="cb181-2" title="2"><span class="co">#error introduced by double space </span></a>
<a class="sourceLine" id="cb181-3" title="3">a&lt;-<span class="kw">c</span>(<span class="st">&quot;8396 (7890 to 8920)&quot;</span>,<span class="st">&quot;6 301 113(6 085 757 to 6 517 308)&quot;</span>,<span class="st">&quot;4 841 208 (4 533 619 to 5 141 654)&quot;</span>,<span class="st">&quot;1 407 701 (127 445 922 to 138 273 863)&quot;</span>,<span class="st">&quot;4 841 208</span><span class="ch">\n</span><span class="st">(4 533 619 to</span><span class="ch">\n</span><span class="st">5 141 654)&quot;</span>)</a>
<a class="sourceLine" id="cb181-4" title="4"></a>
<a class="sourceLine" id="cb181-5" title="5">b&lt;-<span class="kw">str_replace</span> (a, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">(c.*</span><span class="ch">\\</span><span class="st">)&quot;</span>,<span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb181-6" title="6"></a>
<a class="sourceLine" id="cb181-7" title="7"><span class="co">#this is a complex example to clean and requires several steps. Note that the original data in the list a is now assigned to b. </span></a>
<a class="sourceLine" id="cb181-8" title="8">b&lt;-<span class="kw">str_replace</span>(a,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="st">&quot;&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb181-9" title="9"><span class="st">  </span><span class="kw">str_replace</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">(.*&quot;</span>,<span class="st">&quot;&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb181-10" title="10"><span class="st">  </span><span class="kw">str_replace</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">.*&quot;</span>,<span class="st">&quot;&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb181-11" title="11"><span class="st">  </span><span class="kw">str_replace</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">)&quot;</span>,<span class="st">&quot;&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb181-12" title="12"><span class="kw">str_replace</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">s&quot;</span>,<span class="st">&quot;&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb181-13" title="13"><span class="st">  </span><span class="kw">str_replace</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">s&quot;</span>,<span class="st">&quot;&quot;</span>)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.numeric</span>()</a>
<a class="sourceLine" id="cb181-14" title="14">b</a></code></pre></div>
<pre><code>## [1]    8396 6301113 4841208 1407701 4841208</code></pre>
<p>Another example. This time the 2 numbers in the column are separated by a slash sign. Supposed you want to keep the denominator. The first remove the number before the slash sign. The * metacharacter denotes the action occurs at the end.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb183-1" title="1">df.d&lt;-<span class="kw">data.frame</span>(<span class="dt">seizure.rate=</span><span class="kw">c</span>(<span class="st">&quot;59/90&quot;</span>, <span class="st">&quot;90/100&quot;</span>, <span class="st">&quot;3/23&quot;</span>))</a>
<a class="sourceLine" id="cb183-2" title="2">df.d<span class="op">$</span>seizure.number&lt;-<span class="kw">str_replace</span>(df.d<span class="op">$</span>seizure.rate,<span class="st">&quot;[0-9]*&quot;</span>,<span class="st">&quot;&quot;</span>) </a>
<a class="sourceLine" id="cb183-3" title="3">df.d<span class="op">$</span>seizure.number</a></code></pre></div>
<pre><code>## [1] &quot;/90&quot;  &quot;/100&quot; &quot;/23&quot;</code></pre>
<p>Now combine with the next step to remove the slash sign.</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb185-1" title="1"><span class="co">#We used [0-9] to denote any number from 0 to 9. For text, one can use [A-Z].</span></a>
<a class="sourceLine" id="cb185-2" title="2">df.d<span class="op">$</span>seizure.number&lt;-<span class="kw">str_replace</span>(df.d<span class="op">$</span>seizure.rate,<span class="st">&quot;^[0-9]*&quot;</span>,<span class="st">&quot;&quot;</span>)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb185-3" title="3"><span class="st">  </span><span class="kw">str_replace</span>(<span class="st">&quot;/&quot;</span>,<span class="st">&quot;</span><span class="ch">\\</span><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb185-4" title="4">df.d<span class="op">$</span>seizure.number</a></code></pre></div>
<pre><code>## [1] &quot;90&quot;  &quot;100&quot; &quot;23&quot;</code></pre>
<p>Removing the denominator requires a different approach. First remove the last number then the slash sign.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb187-1" title="1">df.d<span class="op">$</span>case&lt;-<span class="kw">str_replace</span>(df.d<span class="op">$</span>seizure.rate,<span class="st">&quot;/[0-9]*&quot;</span>,<span class="st">&quot; &quot;</span>)</a>
<a class="sourceLine" id="cb187-2" title="2">df.d<span class="op">$</span>case</a></code></pre></div>
<pre><code>## [1] &quot;59 &quot; &quot;90 &quot; &quot;3 &quot;</code></pre>
</div>
</div>
<div id="pdf-to-xcel" class="section level2">
<h2><span class="header-section-number">3.5</span> PDF to xcel</h2>
<p>Sometimes data from public governement sites come in PDF form instead of excel. Conversion from pdf to excel or text can be difficult especially with special character eg Danish. There are several libraries for doing this: <em>pdftables</em> (require API key) and <em>pdftools</em>. The example below uses <em>pdftools</em>. Documentation for <em>pdftools</em> is available at <a href="https://docs.ropensci.org/pdftools/" class="uri">https://docs.ropensci.org/pdftools/</a>. The document is the 2018 Danish Stroke Registry report. The <em>tabulizer</em> package is excellent for converting table data. However, <em>tabulizer</em> package depends on <em>rJava</em> and requires deft handling.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb189-1" title="1"><span class="kw">library</span>(pdftools)</a></code></pre></div>
<pre><code>## Warning: package &#39;pdftools&#39; was built under R version 3.6.1</code></pre>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb191-1" title="1">txtDK&lt;-<span class="kw">pdf_text</span>(<span class="st">&quot;./Data-Use/4669_dap_aarsrapport-2018_24062019final.pdf&quot;</span>)</a>
<a class="sourceLine" id="cb191-2" title="2"><span class="kw">cat</span>(txtDK[<span class="dv">17</span>]) <span class="co">#browse data page 13+4 filler pages</span></a></code></pre></div>
<pre><code>## 3. Indikatorresultater på lands-, regions- og afdelingsniveau
## Indikator 1a: Andel af patienter med akut apopleksi som indlægges inden for 3 timer
## efter symptomdebut. Standard: = 30%
## Indikator 1b: Andel af patienter med akut apopleksi som indlægges inden for 4,5
## timer efter symptomdebut. Standard: = 40%
##                                      Inden for 3 timer
##                                                   Uoplyst   Aktuelle år         Tidligere år
##                            Standard   Tæller/      antal      2018          2017            2016
##                             opfyldt   nævner        (%)    %    95% CI   % (95% CI)     % (95% CI)
##   Danmark                     ja    4730 / 11794   49 (0)  40  (39 - 41) 39 (38-40)     37 (36-38)
##   Hovedstaden                 ja     1502 / 3439   49 (1)  44  (42 - 45) 40 (38-42)     40 (39-42)
##   Sjælland                    ja      760 / 1917     0 (0) 40  (37 - 42) 39 (36-41)     40 (38-43)
##   Syddanmark                  ja      942 / 2433     0 (0) 39  (37 - 41) 39 (37-41)     35 (33-37)
##   Midtjylland                 ja      918 / 2590     0 (0) 35  (34 - 37) 36 (34-38)     35 (33-37)
##   Nordjylland                 ja      577 / 1341     0 (0) 43  (40 - 46) 41 (39-44)     35 (32-37)
##   Bopæl uden for Danmark      ja          31 / 74    0 (0) 42  (31 - 54) 51 (36-66)     39 (26-53)
##   Hovedstaden                 ja     1502 / 3439   49 (1)  44  (42 - 45) 40 (38-42)     40 (39-42)
##   Albertslund                 ja          17 / 52    0 (0) 33  (20 - 47) 30 (18-44)     43 (27-59)
##   Allerød                     ja          22 / 53    0 (0) 42  (28 - 56) 32 (20-46)     35 (22-50)
##   Ballerup                    ja        43 / 106     0 (0) 41  (31 - 51) 48 (38-58)     40 (31-51)
##   Bornholms Regionskommune    ja          38 / 98    0 (0) 39  (29 - 49) 28 (19-38)     32 (22-43)
##   Brøndby                     ja        45 / 113     0 (0) 40  (31 - 49) 31 (22-42)     34 (23-47)
##   Dragør                      ja          18 / 43    0 (0) 42  (27 - 58) 47 (30-65)     33 (17-54)
##   Egedal                      ja          45 / 95    0 (0) 47  (37 - 58) 40 (30-52)     48 (37-59)
##   Fredensborg                 ja          36 / 99    0 (0) 36  (27 - 47) 37 (27-47)     43 (33-53)
##   Frederiksberg               ja        74 / 141   13 (8)  52  (44 - 61) 42 (35-50)     52 (44-61)
##   Frederikssund               ja        53 / 141     0 (0) 38  (30 - 46) 39 (31-48)     42 (33-51)
##   Furesø                      ja        55 / 110     0 (0) 50  (40 - 60) 56 (44-67)     50 (38-62)
##   Gentofte                    ja        65 / 123     1 (1) 53  (44 - 62) 46 (37-56)     38 (30-47)
##   Gladsaxe                    ja        68 / 129     0 (0) 53  (44 - 62) 48 (38-57)     36 (27-44)
##   Glostrup                    ja          38 / 72    0 (0) 53  (41 - 65) 40 (27-54)     48 (33-63)
##   Gribskov                    ja        46 / 129     0 (0) 36  (27 - 45) 35 (26-44)     36 (28-46)
##   Halsnæs                     ja          45 / 92    0 (0) 49  (38 - 60) 34 (25-45)     34 (25-44)
##   Helsingør                   ja        50 / 129     0 (0) 39  (30 - 48) 32 (24-40)     38 (30-45)
##   Herlev                      ja          25 / 50    0 (0) 50  (36 - 64) 52 (38-65)     33 (22-46)
##   Hillerød                    ja        47 / 121     0 (0) 39  (30 - 48) 39 (30-49)     40 (30-50)
##   Hvidovre                    ja        57 / 135     0 (0) 42  (34 - 51) 38 (29-48)     47 (37-57)
##                                                                                                    13</code></pre>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb193-1" title="1"><span class="co">#render page for screen shot</span></a>
<a class="sourceLine" id="cb193-2" title="2">screenshot13&lt;-<span class="kw">pdf_render_page</span>(<span class="st">&quot;./Data-Use/4669_dap_aarsrapport-2018_24062019final.pdf&quot;</span>, <span class="dt">page =</span><span class="dv">17</span>)</a>
<a class="sourceLine" id="cb193-3" title="3"><span class="co">#take screen shot</span></a>
<a class="sourceLine" id="cb193-4" title="4">png<span class="op">::</span><span class="kw">writePNG</span>(screenshot13, <span class="st">&quot;./Data-Use/Danish-Stroke-page13.png&quot;</span>)</a>
<a class="sourceLine" id="cb193-5" title="5"><span class="co">#knit screenshot</span></a>
<a class="sourceLine" id="cb193-6" title="6">knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&quot;./Data-Use/Danish-Stroke-page13.png&quot;</span>)</a></code></pre></div>
<p><img src="Data-Use/Danish-Stroke-page13.png" width="298" /></p>
<p>An alternatively dataset is from New York City Health Department of Health and Mental Hygiene available at <a href="https://www1.nyc.gov/assets/doh/downloads/pdf/vs/2017sum.pdf" class="uri">https://www1.nyc.gov/assets/doh/downloads/pdf/vs/2017sum.pdf</a>. This table is illustrated as the data for life expectanct and age adjusted deathrate is not tidy.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb194-1" title="1"><span class="kw">library</span>(pdftools)</a>
<a class="sourceLine" id="cb194-2" title="2">txtNY&lt;-<span class="kw">pdf_text</span>(<span class="st">&quot;./Ext-Data/2017nyc.pdf&quot;</span>)</a>
<a class="sourceLine" id="cb194-3" title="3"><span class="kw">cat</span>(txtNY[<span class="dv">10</span>]) <span class="co">#life expectancy</span></a></code></pre></div>
<pre><code>##                                                       LIFE EXPECTANCY
##                    Figure 4. Life Expectancy at Birth by Community District, New York City, 2008-2017
##             Life Expectancy at Birth
##                                                                                                                                      Bronx
##                           Neighborhood Health Action Center
##                           Parks &amp; Airports
##                           75.6 - 79.8
##                           79.9 - 81.4                             Manhattan
##                           81.5 - 83.1
##                           83.2 - 84.7
##                           84.8 - 86.7
##                                                                                                                                                  Queens
##                            Staten
##                              Island
##                                                                            Brooklyn
##                                                                          See Map of Community Districts and Boroughs, New York City on page 105.
##                                                                          Source: Bureau of Vital Statistics, based on NYC resident deaths, including New York
##                                                                          State occurrence, 2008-2017.
## •      For 2008-2017, New York City’s life expectancy at birth was highest in Greenwich Village/SOHO (86.7), the Upper East Side
##        (86.4), Murray Hill (86.3), Sunnyside/Woodside (86.3) and Elmhurst/Corona (86.3).
## •      For 2008-2017, life expectancy at birth was lowest in Brownsville (75.6), Morrisania (76.8), Central Harlem (76.9), the
##        Rockaways (76.9), and East Harlem (77.9).
##          Life Expectancy at Birth by Community District (CD) of Residence, New York City, 2008-2017
##                                        Life                                         Life                                             Life                                       Life
##      CD           MANHATTAN                        CD           BRONX                           CD            BROOKLYN                          CD            QUEENS
##                                     Expectancy                                   Expectancy                                       Expectancy                                 Expectancy
## MN01       Battery Park, Tribeca       85.9    BX01   Mott Haven                    78.0    BK01    Williamsburg, Greenpoint         82.2    QN01  Astoria, Long Island City    83.6
## MN02       Greenwich Village, SOHO     86.7    BX02   Hunts Point                   79.8    BK02    Fort Greene, Brooklyn Heights    81.6    QN02  Sunnyside, Woodside          86.3
## MN03       Lower East Side             83.2    BX03   Morrisania                    76.8    BK03    Bedford Stuyvesant               78.0    QN03  Jackson Heights              85.7
## MN04       Chelsea, Clinton            84.1    BX04   Concourse, Highbridge         79.6    BK04    Bushwick                         81.1    QN04  Elmhurst, Corona             86.3
## MN05      Midtown Business District    85.6    BX05   University, Morris Heights    80.3    BK05    East New York                    79.1    QN05  Ridgewood, Glendale          81.7
## MN06      Murray Hill                  86.3    BX06   East Tremont                  78.0    BK06    Park Slope                       82.0    QN06  Rego Park, Forest Hills      84.9
## MN07      Upper West Side              85.2    BX07   Fordham                       79.9    BK07    Sunset Park                      83.3    QN07  Flushing                     84.7
## MN08      Upper East Side              86.4    BX08   Riverdale                     81.3    BK08    Crown Heights North              80.2    QN08  Fresh Meadows, Briarwood     84.4
## MN09      Manhattanville               82.1    BX09   Unionport, Soundview          80.4    BK09    Crown Heights South              82.0    QN09  Woodhaven                    83.4
## MN10      Central Harlem               76.9    BX10   Throgs Neck                   81.4    BK10    Bay Ridge                        83.7    QN10  Howard Beach                 81.9
## MN11      East Harlem                  77.9    BX11   Pelham Parkway                80.3    BK11    Bensonhurst                      84.2    QN11  Bayside                      84.9
## MN12      Washington Heights           84.4    BX12   Williamsbridge                81.4    BK12    Borough Park                     84.4    QN12  Jamaica, St. Albans          81.1
##                                                                                             BK13    Coney Island                     80.6    QN13  Queens Village               83.1
##      CD          STATEN ISLAND                                                              BK14    Flatbush, Midwood                82.6    QN14  The Rockaways                76.9
## SI01      Port Richmond                79.4                                                 BK15    Sheepshead Bay                   83.9
## SI02      Willowbrook, South Beach     81.6                                                 BK16    Brownsville                      75.6
## SI03      Tottenville                  81.3                                                 BK17    East Flatbush                    82.8
##                                                                                             BK18    Canarsie                         82.1
##                                                                                             10</code></pre>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb196-1" title="1"><span class="kw">cat</span>(txtNY[<span class="dv">12</span>]) <span class="co"># age adjusted death</span></a></code></pre></div>
<pre><code>##                                   NEIGHBORHOOD MORTALITY
##          Figure 8. Age-adjusted Death Rates by Community District of Residence, New York City, 2017
##                   Age-adjusted Death Rate
##                   Per 100,000 Population                                                                                        Bronx
##                                Neighborhood Health Action Center
##                                Parks &amp; Airports
##                                627.6 - 809.4                     Manhattan
##                                550.3 - 627.5
##                                471.8 - 550.2
##                                406.4 - 471.7
##                                311.7 - 406.3                                                                                               Queens
##               Citywide average: 545.7
##                                Staten
##                                 Island
##                                                                            Brooklyn
##                                                                           See Map of Community Districts and Boroughs, New York City on page 105
##                                                                           Source: Bureau of Vital Statistics, based on events occurring in 2017.
## •     In 2017, Brownsville had the highest age-adjusted death rate, at 809.4 deaths per 100,000 population, followed by 800.5 in
##       Central Harlem, 738.8 in the Rockaways, 736.5 in Morrisania, and 701.7 in Mott Haven.
## •     In 2017, age-adjusted death rates were lowest in Greenwich Village/SOHO at 311.7 deaths per 100,000 population, followed
##       by 320.2 in Sunnyside/Woodside, 338.9 in Bayside, 354.4 in Elmhurst/Corona, and 364.0 in the Upper East Side.
##           Age-adjusted Death Rates per 100,000 Population by Community District (CD) of Residence,
##                                                                           New York City, 2017
##                                        Age-                                      Age-                                             Age-
##                                                                                                                                                                               Age-
##                                      adjusted                                  adjusted                                         adjusted
##    CD             MANHATTAN                    CD            BRONX                         CD                BROOKLYN                       CD               QUEENS         adjusted
##                                       Death                                     Death                                            Death
##                                                                                                                                                                            Death Rates
##                                       Rates                                      Rates                                           Rates
##   MN01   Battery Park, Tribeca        437.3   BX01 Mott Haven                   701.7     BK01    Williamsburg, Greenpoint       444.8     QN01  Astoria, Long Island City   471.7
##   MN02   Greenwich Village, SOHO      311.7   BX02 Hunts Point                  599.2     BK02    Fort Greene, Brooklyn Heights  484.2     QN02  Sunnyside, Woodside         320.2
##   MN03   Lower East Side              436.2   BX03 Morrisania                   736.5     BK03    Bedford Stuyvesant             627.5     QN03  Jackson Heights             390.4
##   MN04   Chelsea, Clinton             383.3   BX04 Concourse, Highbridge        601.5     BK04    Bushwick                       579.4     QN04  Elmhurst, Corona            354.4
##   MN05   Midtown Business District    368.5   BX05 University, Morris Heights   637.6     BK05    East New York                  641.5     QN05  Ridgewood, Glendale         514.4
##   MN06   Murray Hill                  366.1   BX06 East Tremont                 694.4     BK06    Park Slope                     516.6     QN06  Rego Park, Forest Hills     414.1
##   MN07   Upper West Side              406.3   BX07 Fordham                      609.8     BK07    Sunset Park                    468.7     QN07  Flushing                    390.3
##   MN08   Upper East Side              364.0   BX08 Riverdale                    557.8     BK08    Crown Heights North            604.3     QN08  Fresh Meadows, Briarwood    406.7
##   MN09   Manhattanville               510.9   BX09 Unionport, Soundview         552.9     BK09    Crown Heights South            550.2     QN09  Woodhaven                   454.8
##   MN10   Central Harlem               800.5   BX10 Throgs Neck                  548.6     BK10    Bay Ridge                      455.5     QN10  Howard Beach                475.0
##   MN11   East Harlem                  685.0   BX11 Pelham Parkway               582.6     BK11    Bensonhurst                    441.4     QN11  Bayside                     338.9
##   MN12   Washington Heights           415.3   BX12 Williamsbridge               581.1     BK12    Borough Park                   446.3     QN12  Jamaica, St. Albans         508.6
##                                                                                           BK13    Coney Island                   646.7     QN13  Queens Village              375.0
##    CD           STATEN ISLAND                                                             BK14    Flatbush, Midwood              524.4     QN14  The Rockaways               738.8
##   SI01   Port Richmond                639.8                                               BK15    Sheepshead Bay                 508.2
##   SI02   Willowbrook, South Beach     559.3                                               BK16    Brownsville                    809.4
##   SI03   Tottenville                  621.3                                               BK17    East Flatbush                  529.5
##                                                                                           BK18    Canarsie                       546.2
##                                                                                         12</code></pre>
<div id="scanned-text-or-picture" class="section level3">
<h3><span class="header-section-number">3.5.1</span> Scanned text or picture</h3>
<p>Importing data from scanned text will require use of Optical Character Recognition (OCR). The <em>tesseract</em> library provides an R interface for OCR. In the example below, a picture is taken from same CDC website containing mortality data (<a href="https://www.cdc.gov/coronavirus/2019-ncov/covid-data/covidview/04102020/nchs-data.html" class="uri">https://www.cdc.gov/coronavirus/2019-ncov/covid-data/covidview/04102020/nchs-data.html</a>). The screenshot of this website was then cleaned in <em>paint</em>. The data is available in the Data-Use folder.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb198-1" title="1"><span class="kw">library</span>(tesseract)</a></code></pre></div>
<pre><code>## Warning: package &#39;tesseract&#39; was built under R version 3.6.1</code></pre>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb200-1" title="1">eng &lt;-<span class="st"> </span><span class="kw">tesseract</span>(<span class="st">&quot;eng&quot;</span>) <span class="co">#english</span></a>
<a class="sourceLine" id="cb200-2" title="2">text &lt;-<span class="st"> </span>tesseract<span class="op">::</span><span class="kw">ocr</span>(<span class="st">&quot;./Data-Use/Covid_PNG100420.png&quot;</span>, <span class="dt">engine =</span> eng)</a>
<a class="sourceLine" id="cb200-3" title="3"><span class="kw">cat</span>(text)</a></code></pre></div>
<pre><code>## NCHS Mortality Surveillance Data
## Data as of April 9, 2020
## For the Week Ending April 4, 2020 (Week 14)
## 
## COVID-19 Deaths Pneumonia Deaths* Influenza Deaths
## Year Week TotalDeaths Number %ofTotal Number %ofTotal Number  %of Total
## 2019 40 52,452 0 0 2,703 5.15 16 0.03
## 2019 4) 52,860 0 0 2,770 5.24 16 0.03
## 2019 42 54,129 0 0 2,977 5.50 18 0.03
## 2019 43 53,914 0 0 2,985 5.54 30 0.06
## 2019 44 53,980 0 0 2,908 5.39 31 0.06
## 2019 AS 55,468 0 0 3,063 5.52 31 0.06
## 2019 46 55,684 0 0 3,096 5.56 39 0.07
## 2019 47 55,986 0 0 2,993 5.35 50 0.09
## 2019 48 55,238 0 0 2,976 5.38 65 0.12
## 2019 49 56,990 0 0 3,305 5.80 99 0.17
## 2019 50 57,276 0 0 3,448 6.02 111 0.19
## 2019 51 56,999 0 0 3,345 5.87 125 0.22
## 2019 52 57,956 0 0 3,478 5.99 198 0.34
## 2020 1 58,961 0 0 3,998 6.77 416 0.71
## 2020 2 58,962 0 0 3,995 6.76 450 0.76
## 2020 3 57,371 0 0 3,903 6.78 441 0.77
## 2020 4 56,666 0 0 3,742 6.56 468 0.83
## 2020 5 56,381 0 0 3,617 6.42 452 0.80
## 2020 6 56,713 0 0 3,599 6.35 482 0.85
## 2020 7 55,237 0 0 3,577 6.48 487 0.88</code></pre>
</div>
</div>
<div id="web-scraping" class="section level2">
<h2><span class="header-section-number">3.6</span> Web scraping</h2>
<p>The readers may ask why web scraping for healthcare. A pertinent example related to COVID-19 data is provided below. The library <em>rvest</em> is helpful at scraping data from an internet page. The <em>rvest</em> library assumes that web contents have xml document-tree representation. The different options available for web scraping with <em>rvest</em> are available at the website <a href="https://rvest.tidyverse.org/reference/" class="uri">https://rvest.tidyverse.org/reference/</a>. The user can use CSS selectors to scrape content. The library <em>Rselenium</em> is also useful for web scraping. For dynamic web page, the library <em>CasperJS</em> library does a better job especially if the data contain embedded java script.</p>
<p>The library <em>cdccovidview</em> provides access to the CDC website on COVID-19. In the example below, we will try to this manually. Data from CDC website on COVID-19 is downloaded, cleaned and saved in csv format. It is important to pay attention to the data. The first row contains header and is removed. There are several columns with commas. These commas can be removed using the exercises above. Further the data is updated on weekly basis. As such the data needs to be converted into a date time format using <em>lubridate</em>.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb202-1" title="1"><span class="kw">library</span>(rvest)</a></code></pre></div>
<pre><code>## 
## Attaching package: &#39;rvest&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     pluck</code></pre>
<pre><code>## The following object is masked from &#39;package:readr&#39;:
## 
##     guess_encoding</code></pre>
<pre><code>## The following object is masked from &#39;package:XML&#39;:
## 
##     xml</code></pre>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb207-1" title="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb207-2" title="2"><span class="co">#assign handle to web page accessed 12/4/20</span></a>
<a class="sourceLine" id="cb207-3" title="3">cdc&lt;-<span class="kw">read_html</span>(<span class="st">&quot;https://www.cdc.gov/coronavirus/2019-ncov/covid-data/covidview/04102020/nchs-data.html&quot;</span>)<span class="co">#&quot;xml_document&quot; &quot;xml_node&quot;  </span></a>
<a class="sourceLine" id="cb207-4" title="4"><span class="co"># scrape all div tags</span></a>
<a class="sourceLine" id="cb207-5" title="5">html_tag &lt;-<span class="st"> </span>cdc <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_nodes</span>(<span class="st">&quot;div&quot;</span>)</a>
<a class="sourceLine" id="cb207-6" title="6"><span class="co"># scrape header h1 tags</span></a>
<a class="sourceLine" id="cb207-7" title="7">html_list&lt;-html_tag <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_nodes</span>(<span class="st">&quot;h1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_text</span>()</a>
<a class="sourceLine" id="cb207-8" title="8"><span class="co">#there is only one table on this web page</span></a>
<a class="sourceLine" id="cb207-9" title="9">Table1&lt;-<span class="st"> </span>cdc <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_node</span>(<span class="st">&quot;table&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_table</span>(<span class="dt">fill =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb207-10" title="10"><span class="co">#Table1 has a header row</span></a>
<a class="sourceLine" id="cb207-11" title="11">Table1&lt;-Table1[<span class="op">-</span><span class="dv">1</span>,]</a>
<a class="sourceLine" id="cb207-12" title="12"><span class="co">#The data in the Total Deaths column has a comma </span></a>
<a class="sourceLine" id="cb207-13" title="13">Table1<span class="op">$</span>Total.Deaths&lt;-<span class="kw">as.numeric</span>(<span class="kw">gsub</span>(<span class="st">&quot;,&quot;</span>,<span class="st">&quot;&quot;</span>,Table1<span class="op">$</span><span class="st">`</span><span class="dt">Total Deaths</span><span class="st">`</span>))</a>
<a class="sourceLine" id="cb207-14" title="14"><span class="co">#now combine the year and week column to Date</span></a>
<a class="sourceLine" id="cb207-15" title="15">Table1<span class="op">$</span>Date&lt;-lubridate<span class="op">::</span><span class="kw">parse_date_time</span>(<span class="kw">paste</span>(Table1<span class="op">$</span>Year, Table1<span class="op">$</span>Week, <span class="st">&#39;Mon&#39;</span>, <span class="dt">sep=</span><span class="st">&quot;/&quot;</span>),<span class="st">&#39;Y/W/a&#39;</span>)</a>
<a class="sourceLine" id="cb207-16" title="16"><span class="co">#there are still commas remaining in some columns. This is a useful exercise for the reader. A solution is provided in the next example.  </span></a>
<a class="sourceLine" id="cb207-17" title="17"><span class="co">#write.csv(Table1,file=&quot;./Data-Use/Covid_Table100420.csv&quot;)</span></a></code></pre></div>
<p>The next example is from the CDC COVID-19 website. It poses a different challenges as there are several columns with the same names. In this case we will rename the column by index. There are several columns containing commas. Rather than removing column by column we will write a function with lapply to do it over the table. the apply function returns a matrix whereas lapply returns a dataframe. There is one column containing percentage enclosed in a bracket. This can be removed using the example above on metacharacter ie using doule back slash in front of bracket and again at close of bracket.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb208-1" title="1"><span class="kw">library</span>(rvest)</a>
<a class="sourceLine" id="cb208-2" title="2"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb208-3" title="3">cdc&lt;-<span class="kw">read_html</span>(<span class="st">&quot;https://www.cdc.gov/mmwr/volumes/69/wr/mm6915e4.htm?s_cid=mm6915e4_w&quot;</span>) <span class="co">#&quot;xml_document&quot; &quot;xml_node&quot;   </span></a>
<a class="sourceLine" id="cb208-4" title="4"><span class="co"># scrape all div tags</span></a>
<a class="sourceLine" id="cb208-5" title="5">html_tag &lt;-<span class="st"> </span>cdc <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_nodes</span>(<span class="st">&quot;div&quot;</span>)</a>
<a class="sourceLine" id="cb208-6" title="6"><span class="co"># scrape header h1 tags</span></a>
<a class="sourceLine" id="cb208-7" title="7">html_list&lt;-html_tag <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_nodes</span>(<span class="st">&quot;h1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_text</span>()</a>
<a class="sourceLine" id="cb208-8" title="8"><span class="co">#there is only one table on this web page</span></a>
<a class="sourceLine" id="cb208-9" title="9">Table2&lt;-<span class="st"> </span>cdc <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_node</span>(<span class="st">&quot;table&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">html_table</span>(<span class="dt">fill =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb208-10" title="10"><span class="co">#first row is header</span></a>
<a class="sourceLine" id="cb208-11" title="11"><span class="kw">names</span>(Table2) &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(Table2[<span class="dv">1</span>, ])</a>
<a class="sourceLine" id="cb208-12" title="12">Table2&lt;-Table2[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dv">55</span>),]<span class="co">#rows 1 and 2 are redundant</span></a>
<a class="sourceLine" id="cb208-13" title="13"><span class="co">#rename the columns by index </span></a>
<a class="sourceLine" id="cb208-14" title="14"><span class="kw">names</span>(Table2)[<span class="dv">2</span>] &lt;-<span class="st">&quot;NumberCases31.03.20&quot;</span></a>
<a class="sourceLine" id="cb208-15" title="15"><span class="kw">names</span>(Table2)[<span class="dv">3</span>]&lt;-<span class="st">&quot;CumulativeIncidence31.03.20&quot;</span></a>
<a class="sourceLine" id="cb208-16" title="16"><span class="kw">names</span>(Table2)[<span class="dv">4</span>]&lt;-<span class="st">&quot;NumberCases07.04.20&quot;</span></a>
<a class="sourceLine" id="cb208-17" title="17"><span class="kw">names</span>(Table2)[<span class="dv">5</span>]&lt;-<span class="st">&quot;NumberDeath07.04.20&quot;</span></a>
<a class="sourceLine" id="cb208-18" title="18"><span class="kw">names</span>(Table2)[<span class="dv">6</span>]&lt;-<span class="st">&quot;CumulativeIncidence07.04.20&quot;</span></a>
<a class="sourceLine" id="cb208-19" title="19"><span class="co">#rather than removing column by column we will write a function with lapply to remove commas over the table. the apply function returns a matrix whereas lapply returns a dataframe.</span></a>
<a class="sourceLine" id="cb208-20" title="20">Table2&lt;-<span class="kw">as.data.frame</span>(<span class="kw">lapply</span>(Table2, <span class="cf">function</span>(y) <span class="kw">gsub</span>(<span class="st">&quot;,&quot;</span>, <span class="st">&quot;&quot;</span>, y))) </a>
<a class="sourceLine" id="cb208-21" title="21">Table2&lt;-<span class="kw">as.data.frame</span>(<span class="kw">lapply</span>(Table2, <span class="cf">function</span>(x)</a>
<a class="sourceLine" id="cb208-22" title="22">  <span class="kw">gsub</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">(|[0-9]+</span><span class="ch">\\</span><span class="st">)&quot;</span>,<span class="st">&quot;&quot;</span>,x)))</a>
<a class="sourceLine" id="cb208-23" title="23"><span class="co">#write.csv(Table2,file=&quot;./Data-Use/Covid_bystate_Table130420.csv&quot;)</span></a></code></pre></div>
<p>The script above can be used to extract data from any open access article from medical journals. It does not work if the article has not provided full access. For example full access articles from Stroke or Circulation can easily be accessed except more recent articles.</p>
<p>Reference a figure by its code chunk label with the <code>fig:</code> prefix, e.g., see Figure <a href="#fig:nice-fig"><strong>??</strong></a>. Similarly, you can reference tables generated from <code>knitr::kable()</code>, e.g., see Table <a href="data-wrangling.html#tab:nice-tab">3.1</a>.</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb209-1" title="1">knitr<span class="op">::</span><span class="kw">kable</span>(</a>
<a class="sourceLine" id="cb209-2" title="2">  df, <span class="dt">caption =</span> <span class="st">&#39;Table containing uncleaned data above&#39;</span>,</a>
<a class="sourceLine" id="cb209-3" title="3">  <span class="dt">booktabs =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb209-4" title="4">)</a></code></pre></div>
<table>
<caption><span id="tab:nice-tab">Table 3.1: </span>Table containing uncleaned data above</caption>
<thead>
<tr class="header">
<th align="left">drug</th>
<th align="left">infection</th>
<th align="left">drug1</th>
<th align="left">infection1</th>
<th align="left">drug2</th>
<th align="left">infection2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">valium 1mg</td>
<td align="left">pneumonia</td>
<td align="left">valium</td>
<td align="left">pneumonia</td>
<td align="left">valium</td>
<td align="left">pneumonia</td>
</tr>
<tr class="even">
<td align="left">verapamil sr</td>
<td align="left">aspiration pneumonia</td>
<td align="left">verapamil</td>
<td align="left">pneumonia</td>
<td align="left">verapamil</td>
<td align="left">pneumonia</td>
</tr>
<tr class="odd">
<td align="left">betaloc zoc</td>
<td align="left">tracheobronchitis</td>
<td align="left">betaloc</td>
<td align="left"></td>
<td align="left">betaloc</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">tramadol</td>
<td align="left">respiratory tract infection</td>
<td align="left">tramadol</td>
<td align="left"></td>
<td align="left">tramadol</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">valium (diazepam)</td>
<td align="left">respiratory.tract.infection</td>
<td align="left">valium (diazepam)</td>
<td align="left">respiratory.tract.infection</td>
<td align="left">valium</td>
<td align="left"></td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb210-1" title="1">knitr<span class="op">::</span><span class="kw">kable</span>(</a>
<a class="sourceLine" id="cb210-2" title="2">  Table2, <span class="dt">caption =</span> <span class="st">&#39;Table containing cleaned data above&#39;</span>,</a>
<a class="sourceLine" id="cb210-3" title="3">  <span class="dt">booktabs =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb210-4" title="4">)</a></code></pre></div>
<table>
<caption><span id="tab:nice-tab2">Table 3.2: </span>Table containing cleaned data above</caption>
<thead>
<tr class="header">
<th align="left">Jurisdiction</th>
<th align="left">NumberCases31.03.20</th>
<th align="left">CumulativeIncidence31.03.20</th>
<th align="left">NumberCases07.04.20</th>
<th align="left">NumberDeath07.04.20</th>
<th align="left">CumulativeIncidence07.04.20</th>
<th align="left">Absolute.change.in.cumulative.incidence.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Alabama</td>
<td align="left">999</td>
<td align="left">20.4</td>
<td align="left">2197</td>
<td align="left">39 1.</td>
<td align="left">44.9</td>
<td align="left">24.5</td>
</tr>
<tr class="even">
<td align="left">Alaska</td>
<td align="left">133</td>
<td align="left">18.0</td>
<td align="left">213</td>
<td align="left">6 2.</td>
<td align="left">28.9</td>
<td align="left">10.8</td>
</tr>
<tr class="odd">
<td align="left">Arizona</td>
<td align="left">1289</td>
<td align="left">18.0</td>
<td align="left">2575</td>
<td align="left">73 2.</td>
<td align="left">35.9</td>
<td align="left">17.9</td>
</tr>
<tr class="even">
<td align="left">Arkansas</td>
<td align="left">560</td>
<td align="left">18.6</td>
<td align="left">993</td>
<td align="left">18 1.</td>
<td align="left">32.9</td>
<td align="left">14.4</td>
</tr>
<tr class="odd">
<td align="left">California</td>
<td align="left">8131</td>
<td align="left">20.6</td>
<td align="left">15865</td>
<td align="left">374 2.</td>
<td align="left">40.1</td>
<td align="left">19.6</td>
</tr>
<tr class="even">
<td align="left">Colorado</td>
<td align="left">2966</td>
<td align="left">52.1</td>
<td align="left">5429</td>
<td align="left">179 3.</td>
<td align="left">95.3</td>
<td align="left">43.2</td>
</tr>
<tr class="odd">
<td align="left">Connecticut</td>
<td align="left">3128</td>
<td align="left">87.6</td>
<td align="left">7781</td>
<td align="left">277 3.</td>
<td align="left">217.8</td>
<td align="left">130.2</td>
</tr>
<tr class="even">
<td align="left">Delaware</td>
<td align="left">319</td>
<td align="left">33.0</td>
<td align="left">928</td>
<td align="left">16 1.</td>
<td align="left">95.9</td>
<td align="left">63.0</td>
</tr>
<tr class="odd">
<td align="left">District of Columbia</td>
<td align="left">495</td>
<td align="left">70.5</td>
<td align="left">1211</td>
<td align="left">24 2.</td>
<td align="left">172.4</td>
<td align="left">101.9</td>
</tr>
<tr class="even">
<td align="left">Florida</td>
<td align="left">6490</td>
<td align="left">30.5</td>
<td align="left">14302</td>
<td align="left">296 2.</td>
<td align="left">67.1</td>
<td align="left">36.7</td>
</tr>
<tr class="odd">
<td align="left">Georgia</td>
<td align="left">4585</td>
<td align="left">43.6</td>
<td align="left">9713</td>
<td align="left">351 3.</td>
<td align="left">92.3</td>
<td align="left">48.7</td>
</tr>
<tr class="even">
<td align="left">Hawaii</td>
<td align="left">185</td>
<td align="left">13.0</td>
<td align="left">362</td>
<td align="left">5 1.</td>
<td align="left">25.5</td>
<td align="left">12.5</td>
</tr>
<tr class="odd">
<td align="left">Idaho</td>
<td align="left">525</td>
<td align="left">29.9</td>
<td align="left">1210</td>
<td align="left">15 1.</td>
<td align="left">69.0</td>
<td align="left">39.0</td>
</tr>
<tr class="even">
<td align="left">Illinois</td>
<td align="left">5994</td>
<td align="left">47.0</td>
<td align="left">13549</td>
<td align="left">380 2.</td>
<td align="left">106.3</td>
<td align="left">59.3</td>
</tr>
<tr class="odd">
<td align="left">Indiana</td>
<td align="left">2159</td>
<td align="left">32.3</td>
<td align="left">5507</td>
<td align="left">173 3.</td>
<td align="left">82.3</td>
<td align="left">50.0</td>
</tr>
<tr class="even">
<td align="left">Iowa</td>
<td align="left">497</td>
<td align="left">15.7</td>
<td align="left">1048</td>
<td align="left">26 2.</td>
<td align="left">33.2</td>
<td align="left">17.5</td>
</tr>
<tr class="odd">
<td align="left">Kansas</td>
<td align="left">428</td>
<td align="left">14.7</td>
<td align="left">900</td>
<td align="left">27 3.</td>
<td align="left">30.9</td>
<td align="left">16.2</td>
</tr>
<tr class="even">
<td align="left">Kentucky</td>
<td align="left">591</td>
<td align="left">13.2</td>
<td align="left">1149</td>
<td align="left">65 5.</td>
<td align="left">25.7</td>
<td align="left">12.5</td>
</tr>
<tr class="odd">
<td align="left">Louisiana</td>
<td align="left">5237</td>
<td align="left">112.4</td>
<td align="left">16284</td>
<td align="left">582 3.</td>
<td align="left">349.4</td>
<td align="left">237.1</td>
</tr>
<tr class="even">
<td align="left">Maine</td>
<td align="left">303</td>
<td align="left">22.6</td>
<td align="left">519</td>
<td align="left">12 2.</td>
<td align="left">38.8</td>
<td align="left">16.1</td>
</tr>
<tr class="odd">
<td align="left">Maryland</td>
<td align="left">1660</td>
<td align="left">27.5</td>
<td align="left">5529</td>
<td align="left">124 2.</td>
<td align="left">91.5</td>
<td align="left">64.0</td>
</tr>
<tr class="even">
<td align="left">Massachusetts</td>
<td align="left">6620</td>
<td align="left">95.9</td>
<td align="left">15202</td>
<td align="left">356 2.</td>
<td align="left">220.3</td>
<td align="left">124.3</td>
</tr>
<tr class="odd">
<td align="left">Michigan</td>
<td align="left">7615</td>
<td align="left">76.2</td>
<td align="left">18970</td>
<td align="left">845 4.</td>
<td align="left">189.8</td>
<td align="left">113.6</td>
</tr>
<tr class="even">
<td align="left">Minnesota</td>
<td align="left">689</td>
<td align="left">12.3</td>
<td align="left">1154</td>
<td align="left">39 3.</td>
<td align="left">20.6</td>
<td align="left">8.3</td>
</tr>
<tr class="odd">
<td align="left">Mississippi</td>
<td align="left">1073</td>
<td align="left">35.9</td>
<td align="left">2003</td>
<td align="left">67 3.</td>
<td align="left">67.1</td>
<td align="left">31.1</td>
</tr>
<tr class="even">
<td align="left">Missouri</td>
<td align="left">1327</td>
<td align="left">21.7</td>
<td align="left">3037</td>
<td align="left">53 1.</td>
<td align="left">49.6</td>
<td align="left">27.9</td>
</tr>
<tr class="odd">
<td align="left">Montana</td>
<td align="left">203</td>
<td align="left">19.1</td>
<td align="left">332</td>
<td align="left">6 1.</td>
<td align="left">31.3</td>
<td align="left">12.1</td>
</tr>
<tr class="even">
<td align="left">Nebraska</td>
<td align="left">177</td>
<td align="left">9.2</td>
<td align="left">478</td>
<td align="left">10 2.</td>
<td align="left">24.8</td>
<td align="left">15.6</td>
</tr>
<tr class="odd">
<td align="left">Nevada</td>
<td align="left">1113</td>
<td align="left">36.7</td>
<td align="left">2087</td>
<td align="left">71 3.</td>
<td align="left">68.8</td>
<td align="left">32.1</td>
</tr>
<tr class="even">
<td align="left">New Hampshire</td>
<td align="left">367</td>
<td align="left">27.1</td>
<td align="left">747</td>
<td align="left">13 1.</td>
<td align="left">55.1</td>
<td align="left">28.0</td>
</tr>
<tr class="odd">
<td align="left">New Jersey</td>
<td align="left">18696</td>
<td align="left">209.9</td>
<td align="left">44416</td>
<td align="left">1232 2.</td>
<td align="left">498.6</td>
<td align="left">288.7</td>
</tr>
<tr class="even">
<td align="left">New Mexico</td>
<td align="left">315</td>
<td align="left">15.0</td>
<td align="left">794</td>
<td align="left">13 1.</td>
<td align="left">37.9</td>
<td align="left">22.9</td>
</tr>
<tr class="odd">
<td align="left">New York†</td>
<td align="left">32656</td>
<td align="left">293.1</td>
<td align="left">61897</td>
<td align="left">1378 2.</td>
<td align="left">555.5</td>
<td align="left">262.4</td>
</tr>
<tr class="even">
<td align="left">New York City</td>
<td align="left">41771</td>
<td align="left">497.3</td>
<td align="left">76876</td>
<td align="left">4111 5.</td>
<td align="left">915.3</td>
<td align="left">418.0</td>
</tr>
<tr class="odd">
<td align="left">North Carolina</td>
<td align="left">1584</td>
<td align="left">15.3</td>
<td align="left">3221</td>
<td align="left">46 1.</td>
<td align="left">31.0</td>
<td align="left">15.8</td>
</tr>
<tr class="even">
<td align="left">North Dakota</td>
<td align="left">126</td>
<td align="left">16.6</td>
<td align="left">237</td>
<td align="left">4 1.</td>
<td align="left">31.2</td>
<td align="left">14.6</td>
</tr>
<tr class="odd">
<td align="left">Ohio</td>
<td align="left">2199</td>
<td align="left">18.8</td>
<td align="left">4782</td>
<td align="left">167 3.</td>
<td align="left">40.9</td>
<td align="left">22.1</td>
</tr>
<tr class="even">
<td align="left">Oklahoma</td>
<td align="left">565</td>
<td align="left">14.3</td>
<td align="left">1472</td>
<td align="left">67 4.</td>
<td align="left">37.3</td>
<td align="left">23.0</td>
</tr>
<tr class="odd">
<td align="left">Oregon</td>
<td align="left">690</td>
<td align="left">16.5</td>
<td align="left">1181</td>
<td align="left">33 2.</td>
<td align="left">28.2</td>
<td align="left">11.7</td>
</tr>
<tr class="even">
<td align="left">Pennsylvania</td>
<td align="left">4843</td>
<td align="left">37.8</td>
<td align="left">14559</td>
<td align="left">240 1.</td>
<td align="left">113.7</td>
<td align="left">75.9</td>
</tr>
<tr class="odd">
<td align="left">Rhode Island</td>
<td align="left">520</td>
<td align="left">49.2</td>
<td align="left">1414</td>
<td align="left">30 2.</td>
<td align="left">133.7</td>
<td align="left">84.6</td>
</tr>
<tr class="even">
<td align="left">South Carolina</td>
<td align="left">1083</td>
<td align="left">21.3</td>
<td align="left">2417</td>
<td align="left">51 2.</td>
<td align="left">47.5</td>
<td align="left">26.2</td>
</tr>
<tr class="odd">
<td align="left">South Dakota</td>
<td align="left">108</td>
<td align="left">12.2</td>
<td align="left">320</td>
<td align="left">6 1.</td>
<td align="left">36.3</td>
<td align="left">24.0</td>
</tr>
<tr class="even">
<td align="left">Tennessee</td>
<td align="left">2239</td>
<td align="left">33.1</td>
<td align="left">4139</td>
<td align="left">72 1.</td>
<td align="left">61.1</td>
<td align="left">28.1</td>
</tr>
<tr class="odd">
<td align="left">Texas</td>
<td align="left">3266</td>
<td align="left">11.4</td>
<td align="left">8262</td>
<td align="left">154 1.</td>
<td align="left">28.8</td>
<td align="left">17.4</td>
</tr>
<tr class="even">
<td align="left">Utah</td>
<td align="left">934</td>
<td align="left">29.5</td>
<td align="left">1804</td>
<td align="left">13 0.</td>
<td align="left">57.1</td>
<td align="left">27.5</td>
</tr>
<tr class="odd">
<td align="left">Vermont</td>
<td align="left">293</td>
<td align="left">46.8</td>
<td align="left">575</td>
<td align="left">23 4.</td>
<td align="left">91.8</td>
<td align="left">45.0</td>
</tr>
<tr class="even">
<td align="left">Virginia</td>
<td align="left">1484</td>
<td align="left">17.4</td>
<td align="left">3645</td>
<td align="left">75 2.</td>
<td align="left">42.8</td>
<td align="left">25.4</td>
</tr>
<tr class="odd">
<td align="left">Washington</td>
<td align="left">4896</td>
<td align="left">65.0</td>
<td align="left">8682</td>
<td align="left">394 4.</td>
<td align="left">115.2</td>
<td align="left">50.2</td>
</tr>
<tr class="even">
<td align="left">West Virginia</td>
<td align="left">162</td>
<td align="left">9.0</td>
<td align="left">412</td>
<td align="left">4 1.</td>
<td align="left">22.8</td>
<td align="left">13.8</td>
</tr>
<tr class="odd">
<td align="left">Wisconsin</td>
<td align="left">1351</td>
<td align="left">23.2</td>
<td align="left">2578</td>
<td align="left">92 3.</td>
<td align="left">44.3</td>
<td align="left">21.1</td>
</tr>
<tr class="even">
<td align="left">Wyoming</td>
<td align="left">120</td>
<td align="left">20.8</td>
<td align="left">221</td>
<td align="left">0 —)</td>
<td align="left">38.3</td>
<td align="left">17.5</td>
</tr>
<tr class="odd">
<td align="left">American Samoa</td>
<td align="left">0</td>
<td align="left">0.0</td>
<td align="left">0</td>
<td align="left">0 —)</td>
<td align="left">0.0</td>
<td align="left">0.0</td>
</tr>
<tr class="even">
<td align="left">Federated States of Micronesia</td>
<td align="left">0</td>
<td align="left">0.0</td>
<td align="left">0</td>
<td align="left">0 —)</td>
<td align="left">0.0</td>
<td align="left">0.0</td>
</tr>
<tr class="odd">
<td align="left">Guam</td>
<td align="left">71</td>
<td align="left">42.8</td>
<td align="left">122</td>
<td align="left">4 3.</td>
<td align="left">73.6</td>
<td align="left">30.8</td>
</tr>
<tr class="even">
<td align="left">Marshall Islands</td>
<td align="left">0</td>
<td align="left">0.0</td>
<td align="left">0</td>
<td align="left">0 —)</td>
<td align="left">0.0</td>
<td align="left">0.0</td>
</tr>
<tr class="odd">
<td align="left">Northern Mariana Islands</td>
<td align="left">2</td>
<td align="left">3.5</td>
<td align="left">8</td>
<td align="left">2 25.</td>
<td align="left">14.1</td>
<td align="left">10.5</td>
</tr>
<tr class="even">
<td align="left">Palau</td>
<td align="left">0</td>
<td align="left">0.0</td>
<td align="left">0</td>
<td align="left">0 —)</td>
<td align="left">0.0</td>
<td align="left">0.0</td>
</tr>
<tr class="odd">
<td align="left">Puerto Rico</td>
<td align="left">239</td>
<td align="left">7.5</td>
<td align="left">573</td>
<td align="left">23 4.</td>
<td align="left">17.9</td>
<td align="left">10.5</td>
</tr>
<tr class="even">
<td align="left">U.S. Virgin Islands</td>
<td align="left">30</td>
<td align="left">28.0</td>
<td align="left">45</td>
<td align="left">1 2.</td>
<td align="left">42.1</td>
<td align="left">14.0</td>
</tr>
<tr class="odd">
<td align="left">U.S. Total</td>
<td align="left">186101</td>
<td align="left">56.2</td>
<td align="left">395926</td>
<td align="left">12757 3.</td>
<td align="left">119.6</td>
<td align="left">63.4</td>
</tr>
</tbody>
</table>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-pmid31593277">
<p>Aboumatar, H., and R. A. Wise. 2019. “Notice of Retraction. Aboumatar et al. Effect of a Program Combining Transitional Care and Long-term Self-management Support on Outcomes of Hospitalized Patients With Chronic Obstructive Pulmonary Disease: A Randomized Clinical Trial. JAMA. 2018;320(22):2335-2343.” <em>JAMA</em> 322 (14): 1417–8.</p>
</div>
<div id="ref-Amunts1472">
<p>Amunts, Katrin, Claude Lepage, Louis Borgeat, Hartmut Mohlberg, Timo Dickscheid, Marc-Étienne Rousseau, Sebastian Bludau, et al. 2013. “BigBrain: An Ultrahigh-Resolution 3D Human Brain Model.” <em>Science</em> 340 (6139): 1472–5. <a href="https://doi.org/10.1126/science.1235381">https://doi.org/10.1126/science.1235381</a>.</p>
</div>
<div id="ref-pmid8126267">
<p>Collins, D. L., P. Neelin, T. M. Peters, and A. C. Evans. 1994. “Automatic 3D intersubject registration of MR volumetric data in standardized Talairach space.” <em>J Comput Assist Tomogr</em> 18 (2): 192–205.</p>
</div>
<div id="ref-muschelli2017pitchperfect">
<p>Muschelli, John, Elizabeth M Sweeney, Natalie L Ullman, Paul Vespa, Daniel F Hanley, and Ciprian M Crainiceanu. 2017. “PItcHPERFeCT: Primary Intracranial Hemorrhage Probability Estimation Using Random Forests on CT.” <em>NeuroImage: Clinical</em> 14: 379–90.</p>
</div>
<div id="ref-10.3389/fninf.2016.00035">
<p>Vincent, Robert D., Peter Neelin, Najmeh Khalili-Mahani, Andrew L. Janke, Vladimir S. Fonov, Steven M. Robbins, Leila Baghdadi, et al. 2016. “MINC 2.0: A Flexible Format for Multi-Modal Images.” <em>Frontiers in Neuroinformatics</em> 10: 35. <a href="https://doi.org/10.3389/fninf.2016.00035">https://doi.org/10.3389/fninf.2016.00035</a>.</p>
</div>
<div id="ref-Wickham2019">
<p>Wickham, Hadley. 2019. 2nd ed. Chapman &amp; Hall/Crc the R Series. Chapman; Hall/CRC; 2 edition (May 30, 2019).</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Statistics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/02-Data-Wrangling.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Applications-of-R-in-Healthcare.pdf", "Applications-of-R-in-Healthcare.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
