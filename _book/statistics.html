<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Statistics | Applications of R in Healthcare</title>
  <meta name="description" content="This is a book describing the use of R in Healthcare. It is aimed at beginners of R language. The majority of the examples are taken from works in Neurology. Where possible data from other disease such as heart disease, cancer and vaccine are used. The ideas and principles can be applied to other aspects of Healthcare. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Statistics | Applications of R in Healthcare" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a book describing the use of R in Healthcare. It is aimed at beginners of R language. The majority of the examples are taken from works in Neurology. Where possible data from other disease such as heart disease, cancer and vaccine are used. The ideas and principles can be applied to other aspects of Healthcare. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="GNtem2/HealthcareRbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Statistics | Applications of R in Healthcare" />
  
  <meta name="twitter:description" content="This is a book describing the use of R in Healthcare. It is aimed at beginners of R language. The majority of the examples are taken from works in Neurology. Where possible data from other disease such as heart disease, cancer and vaccine are used. The ideas and principles can be applied to other aspects of Healthcare. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Thanh Phan" />


<meta name="date" content="2024-02-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-wrangling.html"/>
<link rel="next" href="multivariate-analysis.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.10/grViz.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applications-of-R-in-Healthcare</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preamble</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#plot-using-base-r"><i class="fa fa-check"></i><b>2.1</b> Plot using base R</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#ggplot2"><i class="fa fa-check"></i><b>2.2</b> ggplot2</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#histogram"><i class="fa fa-check"></i><b>2.2.1</b> Histogram</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#bar-plot"><i class="fa fa-check"></i><b>2.2.2</b> Bar plot</a></li>
<li class="chapter" data-level="2.2.3" data-path="intro.html"><a href="intro.html#pie-chart"><i class="fa fa-check"></i><b>2.2.3</b> Pie chart</a></li>
<li class="chapter" data-level="2.2.4" data-path="intro.html"><a href="intro.html#scatter-plot"><i class="fa fa-check"></i><b>2.2.4</b> Scatter plot</a></li>
<li class="chapter" data-level="2.2.5" data-path="intro.html"><a href="intro.html#arrange-plot-in-grids"><i class="fa fa-check"></i><b>2.2.5</b> arrange plot in grids</a></li>
<li class="chapter" data-level="2.2.6" data-path="intro.html"><a href="intro.html#line-plot"><i class="fa fa-check"></i><b>2.2.6</b> Line plot</a></li>
<li class="chapter" data-level="2.2.7" data-path="intro.html"><a href="intro.html#facet-wrap"><i class="fa fa-check"></i><b>2.2.7</b> Facet wrap</a></li>
<li class="chapter" data-level="2.2.8" data-path="intro.html"><a href="intro.html#polygons"><i class="fa fa-check"></i><b>2.2.8</b> Polygons</a></li>
<li class="chapter" data-level="2.2.9" data-path="intro.html"><a href="intro.html#gantt-chart"><i class="fa fa-check"></i><b>2.2.9</b> Gantt chart</a></li>
<li class="chapter" data-level="2.2.10" data-path="intro.html"><a href="intro.html#heatmap"><i class="fa fa-check"></i><b>2.2.10</b> Heatmap</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#ggplot2-extra"><i class="fa fa-check"></i><b>2.3</b> ggplot2 extra</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#alluvial-and-sankey-diagram"><i class="fa fa-check"></i><b>2.3.1</b> Alluvial and Sankey diagram</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro.html"><a href="intro.html#survival-plot"><i class="fa fa-check"></i><b>2.3.2</b> Survival plot</a></li>
<li class="chapter" data-level="2.3.3" data-path="intro.html"><a href="intro.html#ggraph-and-tidygraph"><i class="fa fa-check"></i><b>2.3.3</b> ggraph and tidygraph</a></li>
<li class="chapter" data-level="2.3.4" data-path="intro.html"><a href="intro.html#ggparty-decision-tree"><i class="fa fa-check"></i><b>2.3.4</b> ggparty-decision tree</a></li>
<li class="chapter" data-level="2.3.5" data-path="intro.html"><a href="intro.html#map"><i class="fa fa-check"></i><b>2.3.5</b> Map</a></li>
<li class="chapter" data-level="2.3.6" data-path="intro.html"><a href="intro.html#ggwordcloud"><i class="fa fa-check"></i><b>2.3.6</b> ggwordcloud</a></li>
<li class="chapter" data-level="2.3.7" data-path="intro.html"><a href="intro.html#gganimate"><i class="fa fa-check"></i><b>2.3.7</b> gganimate</a></li>
<li class="chapter" data-level="2.3.8" data-path="intro.html"><a href="intro.html#ggneuro"><i class="fa fa-check"></i><b>2.3.8</b> ggneuro</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#plotly"><i class="fa fa-check"></i><b>2.4</b> plotly</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="intro.html"><a href="intro.html#scatter-plot-with-plotly"><i class="fa fa-check"></i><b>2.4.1</b> Scatter plot with plotly</a></li>
<li class="chapter" data-level="2.4.2" data-path="intro.html"><a href="intro.html#bar-plot-with-plotly"><i class="fa fa-check"></i><b>2.4.2</b> Bar plot with plotly</a></li>
<li class="chapter" data-level="2.4.3" data-path="intro.html"><a href="intro.html#heatmap-1"><i class="fa fa-check"></i><b>2.4.3</b> Heatmap</a></li>
<li class="chapter" data-level="2.4.4" data-path="intro.html"><a href="intro.html#map-1"><i class="fa fa-check"></i><b>2.4.4</b> map</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>3</b> Data Wrangling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-wrangling.html"><a href="data-wrangling.html#data"><i class="fa fa-check"></i><b>3.1</b> Data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="data-wrangling.html"><a href="data-wrangling.html#vector-arrays-matrix"><i class="fa fa-check"></i><b>3.1.1</b> Vector, Arrays, Matrix</a></li>
<li class="chapter" data-level="3.1.2" data-path="data-wrangling.html"><a href="data-wrangling.html#operators"><i class="fa fa-check"></i><b>3.1.2</b> Operators</a></li>
<li class="chapter" data-level="3.1.3" data-path="data-wrangling.html"><a href="data-wrangling.html#simple-function"><i class="fa fa-check"></i><b>3.1.3</b> Simple function</a></li>
<li class="chapter" data-level="3.1.4" data-path="data-wrangling.html"><a href="data-wrangling.html#for-loop"><i class="fa fa-check"></i><b>3.1.4</b> for loop</a></li>
<li class="chapter" data-level="3.1.5" data-path="data-wrangling.html"><a href="data-wrangling.html#apply-lapply-sapply"><i class="fa fa-check"></i><b>3.1.5</b> apply, lapply, sapply</a></li>
<li class="chapter" data-level="3.1.6" data-path="data-wrangling.html"><a href="data-wrangling.html#functional"><i class="fa fa-check"></i><b>3.1.6</b> Functional</a></li>
<li class="chapter" data-level="3.1.7" data-path="data-wrangling.html"><a href="data-wrangling.html#iteration"><i class="fa fa-check"></i><b>3.1.7</b> Iteration</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-wrangling.html"><a href="data-wrangling.html#data-storage"><i class="fa fa-check"></i><b>3.2</b> Data storage</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-wrangling.html"><a href="data-wrangling.html#data-frame"><i class="fa fa-check"></i><b>3.2.1</b> Data frame</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-wrangling.html"><a href="data-wrangling.html#excel-data"><i class="fa fa-check"></i><b>3.2.2</b> Excel data</a></li>
<li class="chapter" data-level="3.2.3" data-path="data-wrangling.html"><a href="data-wrangling.html#foreign-data"><i class="fa fa-check"></i><b>3.2.3</b> Foreign data</a></li>
<li class="chapter" data-level="3.2.4" data-path="data-wrangling.html"><a href="data-wrangling.html#json-format"><i class="fa fa-check"></i><b>3.2.4</b> json format</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-wrangling.html"><a href="data-wrangling.html#tidy-data"><i class="fa fa-check"></i><b>3.3</b> Tidy data</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-wrangling.html"><a href="data-wrangling.html#factors"><i class="fa fa-check"></i><b>3.3.1</b> Factors</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-wrangling.html"><a href="data-wrangling.html#multiple-files"><i class="fa fa-check"></i><b>3.3.2</b> Multiple files</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-wrangling.html"><a href="data-wrangling.html#tidy-evaluation"><i class="fa fa-check"></i><b>3.3.3</b> Tidy evaluation</a></li>
<li class="chapter" data-level="3.3.4" data-path="data-wrangling.html"><a href="data-wrangling.html#pivot-wide-and-long"><i class="fa fa-check"></i><b>3.3.4</b> Pivot wide and long</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-wrangling.html"><a href="data-wrangling.html#regular-expressions"><i class="fa fa-check"></i><b>3.4</b> Regular Expressions</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="data-wrangling.html"><a href="data-wrangling.html#base-r"><i class="fa fa-check"></i><b>3.4.1</b> base R</a></li>
<li class="chapter" data-level="3.4.2" data-path="data-wrangling.html"><a href="data-wrangling.html#stringr"><i class="fa fa-check"></i><b>3.4.2</b> stringr</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="data-wrangling.html"><a href="data-wrangling.html#pdf-to-xcel"><i class="fa fa-check"></i><b>3.5</b> PDF to xcel</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="data-wrangling.html"><a href="data-wrangling.html#scanned-text-or-picture"><i class="fa fa-check"></i><b>3.5.1</b> Scanned text or picture</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="data-wrangling.html"><a href="data-wrangling.html#web-scraping"><i class="fa fa-check"></i><b>3.6</b> Web scraping</a></li>
<li class="chapter" data-level="3.7" data-path="data-wrangling.html"><a href="data-wrangling.html#medical-images"><i class="fa fa-check"></i><b>3.7</b> Medical Images</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="data-wrangling.html"><a href="data-wrangling.html#dicom-and-nifti-format"><i class="fa fa-check"></i><b>3.7.1</b> DICOM and nifti format</a></li>
<li class="chapter" data-level="3.7.2" data-path="data-wrangling.html"><a href="data-wrangling.html#manipulating-array-of-medical-images"><i class="fa fa-check"></i><b>3.7.2</b> Manipulating array of medical images</a></li>
<li class="chapter" data-level="3.7.3" data-path="data-wrangling.html"><a href="data-wrangling.html#combining-arrays"><i class="fa fa-check"></i><b>3.7.3</b> Combining arrays</a></li>
<li class="chapter" data-level="3.7.4" data-path="data-wrangling.html"><a href="data-wrangling.html#math-operation-on-multidimensional-array"><i class="fa fa-check"></i><b>3.7.4</b> Math operation on multidimensional array</a></li>
<li class="chapter" data-level="3.7.5" data-path="data-wrangling.html"><a href="data-wrangling.html#math-operation-on-list"><i class="fa fa-check"></i><b>3.7.5</b> Math operation on list</a></li>
<li class="chapter" data-level="3.7.6" data-path="data-wrangling.html"><a href="data-wrangling.html#vectorising-nifti-object"><i class="fa fa-check"></i><b>3.7.6</b> Vectorising nifti object</a></li>
<li class="chapter" data-level="3.7.7" data-path="data-wrangling.html"><a href="data-wrangling.html#tar-file"><i class="fa fa-check"></i><b>3.7.7</b> tar file</a></li>
<li class="chapter" data-level="3.7.8" data-path="data-wrangling.html"><a href="data-wrangling.html#image-registration"><i class="fa fa-check"></i><b>3.7.8</b> Image registration</a></li>
<li class="chapter" data-level="3.7.9" data-path="data-wrangling.html"><a href="data-wrangling.html#rescaling"><i class="fa fa-check"></i><b>3.7.9</b> Rescaling</a></li>
<li class="chapter" data-level="3.7.10" data-path="data-wrangling.html"><a href="data-wrangling.html#mni-template"><i class="fa fa-check"></i><b>3.7.10</b> MNI template</a></li>
<li class="chapter" data-level="3.7.11" data-path="data-wrangling.html"><a href="data-wrangling.html#atlases"><i class="fa fa-check"></i><b>3.7.11</b> Atlases</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="data-wrangling.html"><a href="data-wrangling.html#ecg-signal-processing"><i class="fa fa-check"></i><b>3.8</b> ECG Signal processing</a></li>
<li class="chapter" data-level="3.9" data-path="data-wrangling.html"><a href="data-wrangling.html#eeg-signal-processing"><i class="fa fa-check"></i><b>3.9</b> EEG signal processing</a></li>
<li class="chapter" data-level="3.10" data-path="data-wrangling.html"><a href="data-wrangling.html#python"><i class="fa fa-check"></i><b>3.10</b> Python</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="data-wrangling.html"><a href="data-wrangling.html#reticulate"><i class="fa fa-check"></i><b>3.10.1</b> Reticulate</a></li>
<li class="chapter" data-level="3.10.2" data-path="data-wrangling.html"><a href="data-wrangling.html#minconda"><i class="fa fa-check"></i><b>3.10.2</b> Minconda</a></li>
<li class="chapter" data-level="3.10.3" data-path="data-wrangling.html"><a href="data-wrangling.html#python-environment"><i class="fa fa-check"></i><b>3.10.3</b> Python environment</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="data-wrangling.html"><a href="data-wrangling.html#matlab"><i class="fa fa-check"></i><b>3.11</b> Matlab</a></li>
<li class="chapter" data-level="3.12" data-path="data-wrangling.html"><a href="data-wrangling.html#stata"><i class="fa fa-check"></i><b>3.12</b> Stata</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>4</b> Statistics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="statistics.html"><a href="statistics.html#univariable-analyses"><i class="fa fa-check"></i><b>4.1</b> Univariable analyses</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="statistics.html"><a href="statistics.html#parametric-tests"><i class="fa fa-check"></i><b>4.1.1</b> Parametric tests</a></li>
<li class="chapter" data-level="4.1.2" data-path="statistics.html"><a href="statistics.html#non-parametric-tests"><i class="fa fa-check"></i><b>4.1.2</b> Non-parametric tests</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="statistics.html"><a href="statistics.html#regression"><i class="fa fa-check"></i><b>4.2</b> Regression</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="statistics.html"><a href="statistics.html#brief-review-of-matrix"><i class="fa fa-check"></i><b>4.2.1</b> Brief review of matrix</a></li>
<li class="chapter" data-level="4.2.2" data-path="statistics.html"><a href="statistics.html#linear-least-square-regression"><i class="fa fa-check"></i><b>4.2.2</b> Linear (least square) regression</a></li>
<li class="chapter" data-level="4.2.3" data-path="statistics.html"><a href="statistics.html#logistic-regression"><i class="fa fa-check"></i><b>4.2.3</b> Logistic regression</a></li>
<li class="chapter" data-level="4.2.4" data-path="statistics.html"><a href="statistics.html#discrimination-and-calibration"><i class="fa fa-check"></i><b>4.2.4</b> Discrimination and Calibration</a></li>
<li class="chapter" data-level="4.2.5" data-path="statistics.html"><a href="statistics.html#interaction"><i class="fa fa-check"></i><b>4.2.5</b> Interaction</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="statistics.html"><a href="statistics.html#confounder"><i class="fa fa-check"></i><b>4.3</b> Confounder</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="statistics.html"><a href="statistics.html#confounder-weighted-model"><i class="fa fa-check"></i><b>4.3.1</b> Confounder weighted model</a></li>
<li class="chapter" data-level="4.3.2" data-path="statistics.html"><a href="statistics.html#propensity-matching"><i class="fa fa-check"></i><b>4.3.2</b> Propensity matching</a></li>
<li class="chapter" data-level="4.3.3" data-path="statistics.html"><a href="statistics.html#e-values"><i class="fa fa-check"></i><b>4.3.3</b> E-values</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="statistics.html"><a href="statistics.html#causal-inference"><i class="fa fa-check"></i><b>4.4</b> Causal inference</a></li>
<li class="chapter" data-level="4.5" data-path="statistics.html"><a href="statistics.html#special-types-of-regression"><i class="fa fa-check"></i><b>4.5</b> Special types of regression</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="statistics.html"><a href="statistics.html#ordinal-regression"><i class="fa fa-check"></i><b>4.5.1</b> Ordinal regression</a></li>
<li class="chapter" data-level="4.5.2" data-path="statistics.html"><a href="statistics.html#survival-analysis"><i class="fa fa-check"></i><b>4.5.2</b> Survival analysis</a></li>
<li class="chapter" data-level="4.5.3" data-path="statistics.html"><a href="statistics.html#quantile-regression"><i class="fa fa-check"></i><b>4.5.3</b> Quantile regression</a></li>
<li class="chapter" data-level="4.5.4" data-path="statistics.html"><a href="statistics.html#non-negative-regression"><i class="fa fa-check"></i><b>4.5.4</b> Non-negative regression</a></li>
<li class="chapter" data-level="4.5.5" data-path="statistics.html"><a href="statistics.html#poisson-regression"><i class="fa fa-check"></i><b>4.5.5</b> Poisson regression</a></li>
<li class="chapter" data-level="4.5.6" data-path="statistics.html"><a href="statistics.html#conditional-logistic-regression"><i class="fa fa-check"></i><b>4.5.6</b> Conditional logistic regression</a></li>
<li class="chapter" data-level="4.5.7" data-path="statistics.html"><a href="statistics.html#multinomial-modelling"><i class="fa fa-check"></i><b>4.5.7</b> Multinomial modelling</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="statistics.html"><a href="statistics.html#sample-size-estimation"><i class="fa fa-check"></i><b>4.6</b> Sample size estimation</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="statistics.html"><a href="statistics.html#proportion"><i class="fa fa-check"></i><b>4.6.1</b> Proportion</a></li>
<li class="chapter" data-level="4.6.2" data-path="statistics.html"><a href="statistics.html#logistic-regression-1"><i class="fa fa-check"></i><b>4.6.2</b> Logistic regression</a></li>
<li class="chapter" data-level="4.6.3" data-path="statistics.html"><a href="statistics.html#survival-studies"><i class="fa fa-check"></i><b>4.6.3</b> Survival studies</a></li>
<li class="chapter" data-level="4.6.4" data-path="statistics.html"><a href="statistics.html#multiple-regression"><i class="fa fa-check"></i><b>4.6.4</b> Multiple regression</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="statistics.html"><a href="statistics.html#randomised-clinical-trials"><i class="fa fa-check"></i><b>4.7</b> Randomised clinical trials</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="statistics.html"><a href="statistics.html#covariate-adjustment-in-trials"><i class="fa fa-check"></i><b>4.7.1</b> Covariate adjustment in trials</a></li>
<li class="chapter" data-level="4.7.2" data-path="statistics.html"><a href="statistics.html#subgroup-analysis"><i class="fa fa-check"></i><b>4.7.2</b> Subgroup analysis</a></li>
<li class="chapter" data-level="4.7.3" data-path="statistics.html"><a href="statistics.html#p-value-for-interaction"><i class="fa fa-check"></i><b>4.7.3</b> p value for interaction</a></li>
<li class="chapter" data-level="4.7.4" data-path="statistics.html"><a href="statistics.html#interpreting-risk-reduction-in-clinical-trials"><i class="fa fa-check"></i><b>4.7.4</b> Interpreting risk reduction in clinical trials</a></li>
<li class="chapter" data-level="4.7.5" data-path="statistics.html"><a href="statistics.html#nnt-from-arr"><i class="fa fa-check"></i><b>4.7.5</b> NNT from ARR</a></li>
<li class="chapter" data-level="4.7.6" data-path="statistics.html"><a href="statistics.html#nnt-from-odds-ratio"><i class="fa fa-check"></i><b>4.7.6</b> NNT from odds ratio</a></li>
<li class="chapter" data-level="4.7.7" data-path="statistics.html"><a href="statistics.html#nnt-from-risk-ratio"><i class="fa fa-check"></i><b>4.7.7</b> NNT from risk ratio</a></li>
<li class="chapter" data-level="4.7.8" data-path="statistics.html"><a href="statistics.html#nnt-from-hazard-ratio"><i class="fa fa-check"></i><b>4.7.8</b> NNT from hazard ratio</a></li>
<li class="chapter" data-level="4.7.9" data-path="statistics.html"><a href="statistics.html#nnt-from-metaananlysis"><i class="fa fa-check"></i><b>4.7.9</b> NNT from metaananlysis</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="statistics.html"><a href="statistics.html#diagnostic-test"><i class="fa fa-check"></i><b>4.8</b> Diagnostic test</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="statistics.html"><a href="statistics.html#sensitivity-specificity"><i class="fa fa-check"></i><b>4.8.1</b> Sensitivity, specificity</a></li>
<li class="chapter" data-level="4.8.2" data-path="statistics.html"><a href="statistics.html#auc"><i class="fa fa-check"></i><b>4.8.2</b> AUC</a></li>
<li class="chapter" data-level="4.8.3" data-path="statistics.html"><a href="statistics.html#likelihood-ratio"><i class="fa fa-check"></i><b>4.8.3</b> Likelihood ratio</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="statistics.html"><a href="statistics.html#metaanalysis"><i class="fa fa-check"></i><b>4.9</b> Metaanalysis</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="statistics.html"><a href="statistics.html#quality-of-study"><i class="fa fa-check"></i><b>4.9.1</b> Quality of study</a></li>
<li class="chapter" data-level="4.9.2" data-path="statistics.html"><a href="statistics.html#prisma"><i class="fa fa-check"></i><b>4.9.2</b> PRISMA</a></li>
<li class="chapter" data-level="4.9.3" data-path="statistics.html"><a href="statistics.html#conversion-of-median-to-mean"><i class="fa fa-check"></i><b>4.9.3</b> Conversion of median to mean</a></li>
<li class="chapter" data-level="4.9.4" data-path="statistics.html"><a href="statistics.html#inconsistency-i2"><i class="fa fa-check"></i><b>4.9.4</b> Inconsistency I2</a></li>
<li class="chapter" data-level="4.9.5" data-path="statistics.html"><a href="statistics.html#metaanalysis-of-proportion"><i class="fa fa-check"></i><b>4.9.5</b> Metaanalysis of proportion</a></li>
<li class="chapter" data-level="4.9.6" data-path="statistics.html"><a href="statistics.html#metaanalysis-of-continuous-data"><i class="fa fa-check"></i><b>4.9.6</b> Metaanalysis of continuous data</a></li>
<li class="chapter" data-level="4.9.7" data-path="statistics.html"><a href="statistics.html#bivariate-metaanalysis"><i class="fa fa-check"></i><b>4.9.7</b> Bivariate Metaanalysis</a></li>
<li class="chapter" data-level="4.9.8" data-path="statistics.html"><a href="statistics.html#metaanalysis-of-clinical-trial."><i class="fa fa-check"></i><b>4.9.8</b> Metaanalysis of clinical trial.</a></li>
<li class="chapter" data-level="4.9.9" data-path="statistics.html"><a href="statistics.html#metaregression"><i class="fa fa-check"></i><b>4.9.9</b> Metaregression</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="statistics.html"><a href="statistics.html#data-simulation"><i class="fa fa-check"></i><b>4.10</b> Data simulation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html"><i class="fa fa-check"></i><b>5</b> Multivariate Analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#multivariate-regression"><i class="fa fa-check"></i><b>5.1</b> Multivariate regression</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#penalised-regression"><i class="fa fa-check"></i><b>5.1.1</b> Penalised regression</a></li>
<li class="chapter" data-level="5.1.2" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#mars"><i class="fa fa-check"></i><b>5.1.2</b> MARS</a></li>
<li class="chapter" data-level="5.1.3" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#mixed-modelling"><i class="fa fa-check"></i><b>5.1.3</b> Mixed modelling</a></li>
<li class="chapter" data-level="5.1.4" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#trajectory-modelling"><i class="fa fa-check"></i><b>5.1.4</b> Trajectory modelling</a></li>
<li class="chapter" data-level="5.1.5" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#generalized-estimating-equation-gee"><i class="fa fa-check"></i><b>5.1.5</b> Generalized estimating equation (GEE)</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#principal-component-analysis"><i class="fa fa-check"></i><b>5.2</b> Principal component analysis</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#pca-with-mri"><i class="fa fa-check"></i><b>5.2.1</b> PCA with MRI</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#independent-component-analysis"><i class="fa fa-check"></i><b>5.3</b> Independent component analysis</a></li>
<li class="chapter" data-level="5.4" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#partial-least-squares"><i class="fa fa-check"></i><b>5.4</b> Partial least squares</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="machine-learning.html"><a href="machine-learning.html"><i class="fa fa-check"></i><b>6</b> Machine learning</a>
<ul>
<li class="chapter" data-level="6.1" data-path="machine-learning.html"><a href="machine-learning.html#decision-tree-analysis"><i class="fa fa-check"></i><b>6.1</b> Decision tree analysis</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="machine-learning.html"><a href="machine-learning.html#information-theory-driven"><i class="fa fa-check"></i><b>6.1.1</b> Information theory driven</a></li>
<li class="chapter" data-level="6.1.2" data-path="machine-learning.html"><a href="machine-learning.html#conditional-decision-tree"><i class="fa fa-check"></i><b>6.1.2</b> Conditional decision tree</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="machine-learning.html"><a href="machine-learning.html#ensemble-tree-methods"><i class="fa fa-check"></i><b>6.2</b> Ensemble tree methods</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="machine-learning.html"><a href="machine-learning.html#bagging-trees"><i class="fa fa-check"></i><b>6.2.1</b> Bagging trees</a></li>
<li class="chapter" data-level="6.2.2" data-path="machine-learning.html"><a href="machine-learning.html#boosting-trees"><i class="fa fa-check"></i><b>6.2.2</b> Boosting trees</a></li>
<li class="chapter" data-level="6.2.3" data-path="machine-learning.html"><a href="machine-learning.html#bayesian-trees-method"><i class="fa fa-check"></i><b>6.2.3</b> Bayesian trees method</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="machine-learning.html"><a href="machine-learning.html#knn"><i class="fa fa-check"></i><b>6.3</b> KNN</a></li>
<li class="chapter" data-level="6.4" data-path="machine-learning.html"><a href="machine-learning.html#support-vector-machine"><i class="fa fa-check"></i><b>6.4</b> Support vector machine</a></li>
<li class="chapter" data-level="6.5" data-path="machine-learning.html"><a href="machine-learning.html#non-negative-matrix-factorisation"><i class="fa fa-check"></i><b>6.5</b> Non-negative matrix factorisation</a></li>
<li class="chapter" data-level="6.6" data-path="machine-learning.html"><a href="machine-learning.html#formal-concept-analysis"><i class="fa fa-check"></i><b>6.6</b> Formal concept analysis</a></li>
<li class="chapter" data-level="6.7" data-path="machine-learning.html"><a href="machine-learning.html#evolutionary-algorithm"><i class="fa fa-check"></i><b>6.7</b> Evolutionary Algorithm</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="machine-learning.html"><a href="machine-learning.html#simulated-annealing"><i class="fa fa-check"></i><b>6.7.1</b> Simulated Annealing</a></li>
<li class="chapter" data-level="6.7.2" data-path="machine-learning.html"><a href="machine-learning.html#genetic-algorithm"><i class="fa fa-check"></i><b>6.7.2</b> Genetic Algorithm</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="machine-learning.html"><a href="machine-learning.html#manifold-learning"><i class="fa fa-check"></i><b>6.8</b> Manifold learning</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="machine-learning.html"><a href="machine-learning.html#t-stochastic-neighbourhood-embedding"><i class="fa fa-check"></i><b>6.8.1</b> T-Stochastic Neighbourhood Embedding</a></li>
<li class="chapter" data-level="6.8.2" data-path="machine-learning.html"><a href="machine-learning.html#self-organising-map"><i class="fa fa-check"></i><b>6.8.2</b> Self organising map</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="machine-learning.html"><a href="machine-learning.html#deep-learning"><i class="fa fa-check"></i><b>6.9</b> Deep learning</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="machine-learning.html"><a href="machine-learning.html#deep-neural-network"><i class="fa fa-check"></i><b>6.9.1</b> Deep neural network</a></li>
<li class="chapter" data-level="6.9.2" data-path="machine-learning.html"><a href="machine-learning.html#tabnet"><i class="fa fa-check"></i><b>6.9.2</b> Tabnet</a></li>
<li class="chapter" data-level="6.9.3" data-path="machine-learning.html"><a href="machine-learning.html#cnn"><i class="fa fa-check"></i><b>6.9.3</b> CNN</a></li>
<li class="chapter" data-level="6.9.4" data-path="machine-learning.html"><a href="machine-learning.html#rnn"><i class="fa fa-check"></i><b>6.9.4</b> RNN</a></li>
<li class="chapter" data-level="6.9.5" data-path="machine-learning.html"><a href="machine-learning.html#reinforcement-learning"><i class="fa fa-check"></i><b>6.9.5</b> Reinforcement learning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html"><i class="fa fa-check"></i><b>7</b> Machine Learning Part 2</a>
<ul>
<li class="chapter" data-level="7.1" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#bag-of-words"><i class="fa fa-check"></i><b>7.1</b> Bag of words</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#tfidf"><i class="fa fa-check"></i><b>7.1.1</b> TFIDF</a></li>
<li class="chapter" data-level="7.1.2" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#extracting-data-from-web"><i class="fa fa-check"></i><b>7.1.2</b> Extracting data from web</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#wordcloud"><i class="fa fa-check"></i><b>7.2</b> Wordcloud</a></li>
<li class="chapter" data-level="7.3" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#bigram-analysis"><i class="fa fa-check"></i><b>7.3</b> Bigram analysis</a></li>
<li class="chapter" data-level="7.4" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#trigram"><i class="fa fa-check"></i><b>7.4</b> Trigram</a></li>
<li class="chapter" data-level="7.5" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#topic-modeling-or-thematic-analysis"><i class="fa fa-check"></i><b>7.5</b> Topic modeling or thematic analysis</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#probabilistic-topic-model"><i class="fa fa-check"></i><b>7.5.1</b> Probabilistic topic model</a></li>
<li class="chapter" data-level="7.5.2" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#nmf"><i class="fa fa-check"></i><b>7.5.2</b> NMF</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html"><i class="fa fa-check"></i><b>8</b> Bayesian Analysis</a>
<ul>
<li class="chapter" data-level="8.1" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#baysian-belief"><i class="fa fa-check"></i><b>8.1</b> Baysian belief</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#conditional-probability"><i class="fa fa-check"></i><b>8.1.1</b> Conditional probability</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#markov-model"><i class="fa fa-check"></i><b>8.2</b> Markov model</a></li>
<li class="chapter" data-level="8.3" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#inla-stan-and-bugs"><i class="fa fa-check"></i><b>8.3</b> INLA, Stan and BUGS</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#linear-regression"><i class="fa fa-check"></i><b>8.3.1</b> Linear regression</a></li>
<li class="chapter" data-level="8.3.2" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#logistic-regression-2"><i class="fa fa-check"></i><b>8.3.2</b> Logistic regression</a></li>
<li class="chapter" data-level="8.3.3" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#mixed-model"><i class="fa fa-check"></i><b>8.3.3</b> Mixed model</a></li>
<li class="chapter" data-level="8.3.4" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#bayesian-metaanalysis"><i class="fa fa-check"></i><b>8.3.4</b> Bayesian Metaanalysis</a></li>
<li class="chapter" data-level="8.3.5" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#cost"><i class="fa fa-check"></i><b>8.3.5</b> Cost</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="operational-research.html"><a href="operational-research.html"><i class="fa fa-check"></i><b>9</b> Operational Research</a>
<ul>
<li class="chapter" data-level="9.1" data-path="operational-research.html"><a href="operational-research.html#queueing-theory"><i class="fa fa-check"></i><b>9.1</b> Queueing theory</a></li>
<li class="chapter" data-level="9.2" data-path="operational-research.html"><a href="operational-research.html#discrete-event-simulations"><i class="fa fa-check"></i><b>9.2</b> Discrete Event Simulations</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="operational-research.html"><a href="operational-research.html#simulate-capacity-of-system"><i class="fa fa-check"></i><b>9.2.1</b> Simulate capacity of system</a></li>
<li class="chapter" data-level="9.2.2" data-path="operational-research.html"><a href="operational-research.html#queuing-network"><i class="fa fa-check"></i><b>9.2.2</b> Queuing network</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="operational-research.html"><a href="operational-research.html#linear-programming"><i class="fa fa-check"></i><b>9.3</b> Linear Programming</a></li>
<li class="chapter" data-level="9.4" data-path="operational-research.html"><a href="operational-research.html#forecasting"><i class="fa fa-check"></i><b>9.4</b> Forecasting</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="operational-research.html"><a href="operational-research.html#bed-requirement"><i class="fa fa-check"></i><b>9.4.1</b> Bed requirement</a></li>
<li class="chapter" data-level="9.4.2" data-path="operational-research.html"><a href="operational-research.html#length-of-stay"><i class="fa fa-check"></i><b>9.4.2</b> Length of stay</a></li>
<li class="chapter" data-level="9.4.3" data-path="operational-research.html"><a href="operational-research.html#customer-churns"><i class="fa fa-check"></i><b>9.4.3</b> Customer churns</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="operational-research.html"><a href="operational-research.html#process-mapping"><i class="fa fa-check"></i><b>9.5</b> Process mapping</a></li>
<li class="chapter" data-level="9.6" data-path="operational-research.html"><a href="operational-research.html#supply-chains"><i class="fa fa-check"></i><b>9.6</b> Supply chains</a></li>
<li class="chapter" data-level="9.7" data-path="operational-research.html"><a href="operational-research.html#health-economics"><i class="fa fa-check"></i><b>9.7</b> Health economics</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="operational-research.html"><a href="operational-research.html#cost-1"><i class="fa fa-check"></i><b>9.7.1</b> Cost</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="graph-theory.html"><a href="graph-theory.html"><i class="fa fa-check"></i><b>10</b> Graph Theory</a>
<ul>
<li class="chapter" data-level="10.1" data-path="graph-theory.html"><a href="graph-theory.html#special-graphs"><i class="fa fa-check"></i><b>10.1</b> Special graphs</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="graph-theory.html"><a href="graph-theory.html#laplacian-matrix"><i class="fa fa-check"></i><b>10.1.1</b> Laplacian matrix</a></li>
<li class="chapter" data-level="10.1.2" data-path="graph-theory.html"><a href="graph-theory.html#bimodal-bipartite-graph"><i class="fa fa-check"></i><b>10.1.2</b> Bimodal (bipartite) graph</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="graph-theory.html"><a href="graph-theory.html#centrality-measures"><i class="fa fa-check"></i><b>10.2</b> Centrality Measures</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="graph-theory.html"><a href="graph-theory.html#local-centrality-measures"><i class="fa fa-check"></i><b>10.2.1</b> Local centrality measures</a></li>
<li class="chapter" data-level="10.2.2" data-path="graph-theory.html"><a href="graph-theory.html#global-centrality-measures"><i class="fa fa-check"></i><b>10.2.2</b> Global centrality measures</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="graph-theory.html"><a href="graph-theory.html#community"><i class="fa fa-check"></i><b>10.3</b> Community</a></li>
<li class="chapter" data-level="10.4" data-path="graph-theory.html"><a href="graph-theory.html#visualising-graph"><i class="fa fa-check"></i><b>10.4</b> Visualising graph</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="graph-theory.html"><a href="graph-theory.html#visnetwork"><i class="fa fa-check"></i><b>10.4.1</b> Visnetwork</a></li>
<li class="chapter" data-level="10.4.2" data-path="graph-theory.html"><a href="graph-theory.html#large-graph"><i class="fa fa-check"></i><b>10.4.2</b> Large graph</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="graph-theory.html"><a href="graph-theory.html#social-media-and-network-analysis"><i class="fa fa-check"></i><b>10.5</b> Social Media and Network Analysis</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="graph-theory.html"><a href="graph-theory.html#twitter"><i class="fa fa-check"></i><b>10.5.1</b> Twitter</a></li>
<li class="chapter" data-level="10.5.2" data-path="graph-theory.html"><a href="graph-theory.html#youtube"><i class="fa fa-check"></i><b>10.5.2</b> Youtube</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html"><i class="fa fa-check"></i><b>11</b> Geospatial analysis</a>
<ul>
<li class="chapter" data-level="11.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#geocoding"><i class="fa fa-check"></i><b>11.1</b> Geocoding</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#openstreetmap"><i class="fa fa-check"></i><b>11.1.1</b> OpenStreetMap</a></li>
<li class="chapter" data-level="11.1.2" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#google-maps-api"><i class="fa fa-check"></i><b>11.1.2</b> Google Maps API</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#sp-and-sf-objects"><i class="fa fa-check"></i><b>11.2</b> Sp and sf objects</a></li>
<li class="chapter" data-level="11.3" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#thematic-map-1"><i class="fa fa-check"></i><b>11.3</b> Thematic map</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#calculate-distance-to-hospital-openstreetmap"><i class="fa fa-check"></i><b>11.3.1</b> Calculate distance to Hospital-OpenStreetMap</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#spatial-regression"><i class="fa fa-check"></i><b>11.4</b> Spatial regression</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#new-york-covid-19-mortality"><i class="fa fa-check"></i><b>11.4.1</b> New York COVID-19 mortality</a></li>
<li class="chapter" data-level="11.4.2" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#danish-stroke-registry"><i class="fa fa-check"></i><b>11.4.2</b> Danish Stroke Registry</a></li>
<li class="chapter" data-level="11.4.3" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#inla"><i class="fa fa-check"></i><b>11.4.3</b> INLA</a></li>
<li class="chapter" data-level="11.4.4" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#stan"><i class="fa fa-check"></i><b>11.4.4</b> Stan</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#machine-learning-in-spatial-analysis"><i class="fa fa-check"></i><b>11.5</b> Machine learning in spatial analysis</a></li>
<li class="chapter" data-level="11.6" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#spatio-temporal-regression"><i class="fa fa-check"></i><b>11.6</b> Spatio-temporal regression</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="app.html"><a href="app.html"><i class="fa fa-check"></i><b>12</b> App</a>
<ul>
<li class="chapter" data-level="12.1" data-path="app.html"><a href="app.html#brief-introduction-to-shiny-app"><i class="fa fa-check"></i><b>12.1</b> Brief introduction to Shiny app</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>13</b> Appendix</a>
<ul>
<li class="chapter" data-level="13.1" data-path="appendix.html"><a href="appendix.html#brief-introduction-to-matrix"><i class="fa fa-check"></i><b>13.1</b> Brief introduction to Matrix</a></li>
<li class="chapter" data-level="13.2" data-path="appendix.html"><a href="appendix.html#regression-1"><i class="fa fa-check"></i><b>13.2</b> Regression</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="appendix.html"><a href="appendix.html#linear-regression-1"><i class="fa fa-check"></i><b>13.2.1</b> Linear regression</a></li>
<li class="chapter" data-level="13.2.2" data-path="appendix.html"><a href="appendix.html#logistic-regression-3"><i class="fa fa-check"></i><b>13.2.2</b> Logistic regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applications of R in Healthcare</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="statistics" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Statistics<a href="statistics.html#statistics" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This section is not intended as a textbook on statistics. Rather it demonstrates regression approaches that can be used including sample size estimation, R codes provided.</p>
<div id="univariable-analyses" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Univariable analyses<a href="statistics.html#univariable-analyses" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="parametric-tests" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Parametric tests<a href="statistics.html#parametric-tests" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>T-test is the workhorse for comparing if 2 datasets are have the same distribution. Performing t-test in R requires data from 2 columns: one
containing the variables for comparison and one to label the group. There are different forms of t-test depending on whether the two samples are paired or unpaired. In general, the analysis takes the form of <span class="math inline">\(t=\frac{\mu_1 - \mu_2}{variance}\)</span>. It is recommended to check the distribution of the data by using histogram. For this exercise, we will use the simulated data from ECR trials. The grouping variable is the trial assignment.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="statistics.html#cb1-1" tabindex="-1"></a><span class="co">#comparison of early neurological recovery (ENI) by tral (T)</span></span>
<span id="cb1-2"><a href="statistics.html#cb1-2" tabindex="-1"></a>dtTrial<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">&quot;./Data-Use/dtTrial_simulated.csv&quot;</span>)</span>
<span id="cb1-3"><a href="statistics.html#cb1-3" tabindex="-1"></a><span class="fu">t.test</span>(dtTrial<span class="sc">$</span>ENI<span class="sc">~</span>dtTrial<span class="sc">$</span>T)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  dtTrial$ENI by dtTrial$T
## t = 0.17454, df = 487.36, p-value = 0.8615
## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
## 95 percent confidence interval:
##  -0.04569535  0.05460540
## sample estimates:
## mean in group 0 mean in group 1 
##       0.3084644       0.3040094</code></pre>
</div>
<div id="non-parametric-tests" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Non-parametric tests<a href="statistics.html#non-parametric-tests" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Chi-squared and Fisher-exact tests can be done by using the <em>table</em> function for setting up the count data into 2 x 2 contingency table or confusion matrix. The formula for the Chi-squared test takes on a familiar form <span class="math inline">\(\chi^2=\frac{(observed-expected)^2}{expected}\)</span>. In this example we will use the data above.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="statistics.html#cb3-1" tabindex="-1"></a><span class="fu">table</span>(dtTrial<span class="sc">$</span>HT,dtTrial<span class="sc">$</span>T)</span></code></pre></div>
<pre><code>##    
##       0   1
##   0 112 101
##   1 144 143</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="statistics.html#cb5-1" tabindex="-1"></a><span class="fu">chisq.test</span>(dtTrial<span class="sc">$</span>HT,dtTrial<span class="sc">$</span>T)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  dtTrial$HT and dtTrial$T
## X-squared = 0.19553, df = 1, p-value = 0.6584</code></pre>
<p>The Wilcoxon rank sum test is performed with continuous data organised in the
same way as the t-test. There are several different approaches to performing Wilcoxon rank sum test. The <em>coin</em> package allows handling of ties.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="statistics.html#cb7-1" tabindex="-1"></a><span class="fu">library</span>(coin)</span></code></pre></div>
<pre><code>## Loading required package: survival</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="statistics.html#cb9-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(ENI<span class="sc">~</span>T, <span class="at">data=</span>dtTrial)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon rank sum test with continuity correction
## 
## data:  ENI by T
## W = 31159, p-value = 0.9642
## alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<div id="regression" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Regression<a href="statistics.html#regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are many different form of regression methods. A key principle is that the predictors are independent of each others. This issue will be expand on in the later in the section on collinearity. Special methods are required when the predictors are collinear.</p>
<div id="brief-review-of-matrix" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Brief review of matrix<a href="statistics.html#brief-review-of-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A vector is has length one. A matrix is an ordered array in 2 dimensions. A
tensor is an ordered array in 3 dimensions.</p>
<p>A matrix in which the columns are linearly related are said to be rank
deficient. The rank of a given matrix is an expression of the number of linearly independent columns of that matrix. Given that row rank and column rank are equivalent, rank deficiency of a matrix is expressed as the difference between
the lesser of the number of rows and columns, and the rank of the matrix.
A matrix with rank of 1 is likely to be linearly related.</p>
</div>
<div id="linear-least-square-regression" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Linear (least square) regression<a href="statistics.html#linear-least-square-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Least square regression uses the geometric properties of Euclidean geometry to identify the line of best. The sum of squares <span class="math inline">\(SSE\)</span> is <span class="math inline">\(\sum(observed-expected)^2\)</span>. The <span class="math inline">\(R^2\)</span> is a measure of the fit of the model. It
is given by <span class="math inline">\(1-\frac{SS_(res)}{SS_(total)}\)</span>. Low <span class="math inline">\(R^2\)</span> indicates a poorly fitted model and high <span class="math inline">\(R^2\)</span> indicates excellent fitting. The assumption here is that
the outcome variable is a continuous variable.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="statistics.html#cb11-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb11-2"><a href="statistics.html#cb11-2" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;./Data-Use/world_stroke.Rda&quot;</span>)</span>
<span id="cb11-3"><a href="statistics.html#cb11-3" tabindex="-1"></a></span>
<span id="cb11-4"><a href="statistics.html#cb11-4" tabindex="-1"></a><span class="fu">ggplot</span>(world_sfdf, <span class="fu">aes</span>(<span class="at">x=</span>LifeExpectancy,<span class="at">y=</span>MeanLifetimeRisk))<span class="sc">+</span></span>
<span id="cb11-5"><a href="statistics.html#cb11-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="fu">aes</span>(<span class="at">Group=</span>Income, <span class="at">linetype=</span>Income))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&quot;Life Expectancy&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-3-1.png" width="672" /></p>
</div>
<div id="logistic-regression" class="section level3 hasAnchor" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Logistic regression<a href="statistics.html#logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For outcome that are binary in nature such as yes or no, then least square regression is not appropriate. There are no close form solution for this
analysis and a numerical approach using maximum likelihood approach is needed. When examining the results of logistic regression one is often enchanted by the large odds ratio. It is important to look at the metrics of model calibration
(discussed below). A clue to a poorly calibrated model is the observation that
the width of the confidence interval for odds ratio is wide.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="statistics.html#cb13-1" tabindex="-1"></a><span class="co">#glm</span></span>
<span id="cb13-2"><a href="statistics.html#cb13-2" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;BreastCancer&quot;</span>,<span class="at">package =</span> <span class="st">&quot;mlbench&quot;</span>)</span>
<span id="cb13-3"><a href="statistics.html#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="statistics.html#cb13-4" tabindex="-1"></a><span class="co">#remove id column and column with NA to feed into iml later</span></span>
<span id="cb13-5"><a href="statistics.html#cb13-5" tabindex="-1"></a>BreastCancer2<span class="ot">&lt;-</span><span class="fu">lapply</span>(BreastCancer[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>)], as.numeric)</span>
<span id="cb13-6"><a href="statistics.html#cb13-6" tabindex="-1"></a>BreastCancer2<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(BreastCancer2)</span>
<span id="cb13-7"><a href="statistics.html#cb13-7" tabindex="-1"></a></span>
<span id="cb13-8"><a href="statistics.html#cb13-8" tabindex="-1"></a>DCa<span class="ot">&lt;-</span><span class="fu">glm</span>(Class<span class="sc">~</span>., <span class="at">data=</span>BreastCancer2)</span>
<span id="cb13-9"><a href="statistics.html#cb13-9" tabindex="-1"></a></span>
<span id="cb13-10"><a href="statistics.html#cb13-10" tabindex="-1"></a><span class="fu">summary</span>(DCa)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = Class ~ ., data = BreastCancer2)
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     0.723054   0.018613  38.847  &lt; 2e-16 ***
## Cl.thickness    0.042754   0.003992  10.709  &lt; 2e-16 ***
## Cell.size       0.019263   0.007293   2.641  0.00845 ** 
## Cell.shape      0.032217   0.007016   4.592 5.22e-06 ***
## Marg.adhesion   0.021463   0.004386   4.893 1.24e-06 ***
## Epith.c.size    0.011637   0.005965   1.951  0.05148 .  
## Bl.cromatin     0.035266   0.005650   6.241 7.57e-10 ***
## Normal.nucleoli 0.016928   0.004247   3.986 7.44e-05 ***
## Mitoses         0.001086   0.006048   0.180  0.85757    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for gaussian family taken to be 0.0481263)
## 
##     Null deviance: 157.908  on 698  degrees of freedom
## Residual deviance:  33.207  on 690  degrees of freedom
## AIC: -126.1
## 
## Number of Fisher Scoring iterations: 2</code></pre>
</div>
<div id="discrimination-and-calibration" class="section level3 hasAnchor" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> Discrimination and Calibration<a href="statistics.html#discrimination-and-calibration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A high _<span class="math inline">\(R^2\)</span> suggests that the linear regression model is well calibrated. This metric is often not displayed but should be sought when interpreting the data.</p>
<p>The areas under the receiver operating characteristic curve (AUC) is used to assess how well the models discriminate between those who have the disease and those who do not have the disease of interest. An AUC of 0.5 is classified as no better than by chance; 0.8 to 0.89 provides good (excellent) discrimination, and 0.9 to 1.0 provides outstanding discrimination. This rule of thumb about interpreting AUC when reading the literature is language the authors used to describe the AUC. This test of discrimination is not synonymous with calibration. It is possible to have a model with high discrimination but poor calibration <span class="citation">(<a href="#ref-pmid1738016">Diamond 1992</a>)</span>. The AUC is similar to Harrell’s c-index but the interpretation of difference in AUC and c-index between models is not straightforward. A difference in 0.1 of AUC correspond to the number of subject rank correctly. The c-index was originally described for survival analysis <span class="citation">(<a href="#ref-pmid7069920">Harrell FE Jr 1982</a>)</span>. Harrell described the c-index (concordance index) as estimating the probability that, of two randomly chosen patients, the patient with the higher prognostic score will outlive the patient with the lower prognostic score. As such the c-index should be interpreted as the number of concordant pairs relative to the total number of comparable pairs. It has been proposed that the AUC and c-index is not appropriate for survival analysis as they do not account for the dynamic nature of the data<span class="citation">(<a href="#ref-LONGATO2020103496">Longato, Vettoretti, and Di Camillo 2020</a>)</span>. The integrated Graf score has been proposed to account for difference in the estimated event-free survival probabilities with the actual outcome <span class="citation">(<a href="#ref-pmid10474158">Graf E 1999</a>)</span>.</p>
<p>Calibration of logistic regression model is performed using the Hosmer–Lemeshow goodness-of-ﬁt test and the Nagelkerke generalized R2. A model is well
calibrated when the Hosmer–Lemeshow goodness-of-ﬁt test shows no difference between observed and expected outcome or P value approaching 1. A high
generalized <span class="math inline">\(R^2\)</span> value suggests a well-calibrated regression model. Running regression through the <em>rms</em> or <em>PredictABEL</em> library provide these results. The generalized <span class="math inline">\(R^2\)</span> can be obtained manually from base R by running an intercept only model and again with covariates. It is given by <span class="math inline">\(1-\frac{L1}{L0}\)</span>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="statistics.html#cb15-1" tabindex="-1"></a><span class="co">#lrm on logistic regression analysis for Breast Cancer</span></span>
<span id="cb15-2"><a href="statistics.html#cb15-2" tabindex="-1"></a><span class="fu">library</span>(rms)</span></code></pre></div>
<pre><code>## Loading required package: Hmisc</code></pre>
<pre><code>## 
## Attaching package: &#39;Hmisc&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     format.pval, units</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="statistics.html#cb19-1" tabindex="-1"></a>DCa_rms<span class="ot">&lt;-</span><span class="fu">lrm</span>(Class<span class="sc">~</span>., <span class="at">data=</span>BreastCancer2)</span>
<span id="cb19-2"><a href="statistics.html#cb19-2" tabindex="-1"></a>DCa_rms</span></code></pre></div>
<pre><code>## Logistic Regression Model
## 
## lrm(formula = Class ~ ., data = BreastCancer2)
## 
##                        Model Likelihood      Discrimination    Rank Discrim.    
##                              Ratio Test             Indexes          Indexes    
## Obs           699    LR chi2     759.86      R2       0.915    C       0.993    
##  1            458    d.f.             8      R2(8,699)0.659    Dxy     0.986    
##  2            241    Pr(&gt; chi2) &lt;0.0001    R2(8,473.7)0.795    gamma   0.986    
## max |deriv| 8e-10                            Brier    0.028    tau-a   0.446    
## 
##                 Coef    S.E.   Wald Z Pr(&gt;|Z|)
## Intercept       -9.9477 1.0317 -9.64  &lt;0.0001 
## Cl.thickness     0.5776 0.1190  4.85  &lt;0.0001 
## Cell.size       -0.0115 0.1759 -0.07  0.9479  
## Cell.shape       0.5679 0.1913  2.97  0.0030  
## Marg.adhesion    0.3137 0.1004  3.13  0.0018  
## Epith.c.size     0.1306 0.1406  0.93  0.3529  
## Bl.cromatin      0.5800 0.1456  3.98  &lt;0.0001 
## Normal.nucleoli  0.1232 0.0987  1.25  0.2120  
## Mitoses          0.6092 0.3226  1.89  0.0590</code></pre>
<div id="measuring-improvement-in-regression-models" class="section level4 hasAnchor" number="4.2.4.1">
<h4><span class="header-section-number">4.2.4.1</span> Measuring Improvement in Regression Models<a href="statistics.html#measuring-improvement-in-regression-models" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The net reclassification improvement (NRI) and integrated discrimination improvement (IDI) have been proposed as more sensitive metrics of improvement in model discrimination.The NRI can be considered as a percentage reclassiﬁcation
for the risk categories and the IDI is the mean difference in predicted probabilities between 2 models (constructed from cases with disease and without disease). The NRI and IDI scores are expressed as fractions and can be converted to percentage by multiplying 100.The continuous NRI and IDI can be performed
using <em>PredictABEL</em> [<span class="citation">Phan et al. (<a href="#ref-pmid28579970">2017</a>)</span>]<span class="citation">(<a href="#ref-pmid26796056">Phan et al. 2016</a>)</span>.</p>
</div>
<div id="shapley-value" class="section level4 hasAnchor" number="4.2.4.2">
<h4><span class="header-section-number">4.2.4.2</span> Shapley value<a href="statistics.html#shapley-value" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We can use ideas from game theory relating to fair distribution of proﬁt in coalition games; the coalition (co-operative) game in this case can be
interpreted as contribution of the covariates to the model. The Shapley value regression method calculates the marginal contribution of each covariate as the average of all permutations of the coalition of the covariates containing the covariate of interest minus the coalition without the covariate of interest. The advantage of this approach is that it can handle multicollinearity (relatedness) among the covariates.</p>
<p>The feature importance is used to assess the impact of the features on the
model’s decision</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="statistics.html#cb21-1" tabindex="-1"></a><span class="co">#this section takes the output from logistic regression above.</span></span>
<span id="cb21-2"><a href="statistics.html#cb21-2" tabindex="-1"></a><span class="fu">library</span>(iml)</span>
<span id="cb21-3"><a href="statistics.html#cb21-3" tabindex="-1"></a>X <span class="ot">=</span> BreastCancer2[<span class="fu">which</span>(<span class="fu">names</span>(BreastCancer2) <span class="sc">!=</span> <span class="st">&quot;Class&quot;</span>)]</span>
<span id="cb21-4"><a href="statistics.html#cb21-4" tabindex="-1"></a>predictor <span class="ot">=</span> Predictor<span class="sc">$</span><span class="fu">new</span>(DCa, <span class="at">data =</span> X, <span class="at">y =</span> BreastCancer2<span class="sc">$</span>Class)</span>
<span id="cb21-5"><a href="statistics.html#cb21-5" tabindex="-1"></a>imp <span class="ot">=</span> FeatureImp<span class="sc">$</span><span class="fu">new</span>(predictor, <span class="at">loss =</span> <span class="st">&quot;mae&quot;</span>)</span>
<span id="cb21-6"><a href="statistics.html#cb21-6" tabindex="-1"></a><span class="fu">plot</span>(imp)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-5-1.png" width="672" /></p>
<p>From the logistic regression above cell thickness and cromatin have the highest coefficient and lowest p value. This is the same as feature importance. By contrast the Shapley values show that cell shape and marg adhesion make the largest impact on the model when considering the contribution to the model after considering all the contribution by different coalitions.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="statistics.html#cb22-1" tabindex="-1"></a><span class="co">#explain with game theory</span></span>
<span id="cb22-2"><a href="statistics.html#cb22-2" tabindex="-1"></a>shapley <span class="ot">&lt;-</span> Shapley<span class="sc">$</span><span class="fu">new</span>(predictor, <span class="at">x.interest =</span> X[<span class="dv">1</span>, ])</span>
<span id="cb22-3"><a href="statistics.html#cb22-3" tabindex="-1"></a>shapley<span class="sc">$</span><span class="fu">plot</span>()</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-5-1-1.png" width="672" /></p>
</div>
<div id="ice" class="section level4 hasAnchor" number="4.2.4.3">
<h4><span class="header-section-number">4.2.4.3</span> ICE<a href="statistics.html#ice" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The individual conditional expectation (ICE) curves is the plot of the
expectation fof the predictive value for each observation at the unique value
for the feature.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="statistics.html#cb23-1" tabindex="-1"></a><span class="co">#feature is the covariate of interest</span></span>
<span id="cb23-2"><a href="statistics.html#cb23-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb23-3"><a href="statistics.html#cb23-3" tabindex="-1"></a>eff_thick <span class="ot">&lt;-</span> FeatureEffect<span class="sc">$</span><span class="fu">new</span>(predictor, </span>
<span id="cb23-4"><a href="statistics.html#cb23-4" tabindex="-1"></a>                         <span class="at">feature =</span> <span class="st">&quot;Cl.thickness&quot;</span>, </span>
<span id="cb23-5"><a href="statistics.html#cb23-5" tabindex="-1"></a>                         <span class="at">method =</span> <span class="st">&quot;ice&quot;</span>,</span>
<span id="cb23-6"><a href="statistics.html#cb23-6" tabindex="-1"></a>                         <span class="at">center.at =</span> <span class="dv">0</span>)</span>
<span id="cb23-7"><a href="statistics.html#cb23-7" tabindex="-1"></a></span>
<span id="cb23-8"><a href="statistics.html#cb23-8" tabindex="-1"></a><span class="fu">plot</span>(eff_thick)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-5-2-1.png" width="672" /></p>
</div>
</div>
<div id="interaction" class="section level3 hasAnchor" number="4.2.5">
<h3><span class="header-section-number">4.2.5</span> Interaction<a href="statistics.html#interaction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Interactions is plotted here using lollipop bar. The <em>ggalt</em> library can be used to create this type of plot with <em>geom_lollipop</em>. The strength of interaction is measured using Friedman’s H-statistics. The H-statistics ranges from 0 to 1 with
1 indicating the overall interaction strength. In the case with Breast Cancer data, the interaction strength is low.</p>
<p>When describing interaction terms it is recommended that the results be
expressed as β coefficients rather than as odds ratio.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="statistics.html#cb24-1" tabindex="-1"></a><span class="co">#plot interactions</span></span>
<span id="cb24-2"><a href="statistics.html#cb24-2" tabindex="-1"></a>interact <span class="ot">&lt;-</span> Interaction<span class="sc">$</span><span class="fu">new</span>(predictor)</span>
<span id="cb24-3"><a href="statistics.html#cb24-3" tabindex="-1"></a><span class="fu">plot</span>(interact)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-5-3-1.png" width="672" /></p>
</div>
</div>
<div id="confounder" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Confounder<a href="statistics.html#confounder" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A confounder is a covariate that serves as a cause of both exposure and outcome and as such confound the analysis. A mediator exist on the causal pathway from exposure to outcome. A common misconception is that the multiple regression adjust for imbalance in covariates in clinical trial. This issue was observed in the pivotal NINDS alteplase trial. The results of the trial has since been accepted with re-analysis of this trial using covariate adjustment <span class="citation">(<a href="#ref-pmid15345796">Ingall et al. 2004</a>)</span>.</p>
<p>There are several methods for covariate adjustment in radomised trials: direct adjustment, standardisation and inverse-probability-of-treatment weighting.</p>
<div id="confounder-weighted-model" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Confounder weighted model<a href="statistics.html#confounder-weighted-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The issue asked is whether one should choose to perform confounder analysis or propensity matching.</p>
</div>
<div id="propensity-matching" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Propensity matching<a href="statistics.html#propensity-matching" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Propensity matching is an important technique to adjust for imbalance in covariates between 2 arms. There are concerns with mis-use of this technique
such as difference in placebo arms from multiple sclerosis trials <span class="citation">(<a href="#ref-doi10.1001/jamaneurol.2020.0678">Signori et al. 2020</a>)</span>. It is proposed that this technique should be
used only if all the confounders are measurable. This situation may not be satisfied if the data were accrued at different period, in different continent etc.</p>
</div>
<div id="e-values" class="section level3 hasAnchor" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> E-values<a href="statistics.html#e-values" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The E-values <span class="citation">(<a href="#ref-pmid28693043">VanderWeele TJ 2017</a>)</span> has been proposed a measure of unmeasured confounders in observational studies. The E-value is a measure of the extent to which the confounder have on the treatment–outcome association, conditional on the measured covariates. A large E-value is desirable. The E-values is available in <em>Evalue</em> library <span class="citation">(<a href="#ref-pmid29912013">Mathur MB 2018</a>)</span>.</p>
</div>
</div>
<div id="causal-inference" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Causal inference<a href="statistics.html#causal-inference" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Causation and association are often miscontrued to be the same. However, the finding of correlation (association) does necessarily imply causation. Causal inference evaluates the response of an effect variable in the setting of change in the cause of the effect variable. There are issues with approach to analysis of causal inference. It can be performed using frequentist such as confounder weighted model or Bayesian methods such as <a href="machine-learning.html#bayesian-trees-method">(Baysian additive regression tree)</a>.</p>
</div>
<div id="special-types-of-regression" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Special types of regression<a href="statistics.html#special-types-of-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="ordinal-regression" class="section level3 hasAnchor" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Ordinal regression<a href="statistics.html#ordinal-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Ordinal regression is appropriate when the outcome variable is in the form of ordered categorical values. For example, the Rankin scale of disability is
bounded between the values of 0 and 6. This type of analysis uses the
proportional odds model and the requirement for this model is stringent. When examining results of ordinal regression check that the authors provide this metric, the Brant test. The Brant test assesses the parallel regression assumption. Ordinal regression is performed using <em>polr</em> function in <em>MASS</em> library. The Brant test is available in the <em>Brant</em> library.</p>
</div>
<div id="survival-analysis" class="section level3 hasAnchor" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> Survival analysis<a href="statistics.html#survival-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Survival analysis is useful when dealing with time to event data. Time to event data can be left, interval and right censoring. Left censoring exists when events may have already occurred at the start of the study eg purchase of phones. Right censoring exists when events have not happened yet eg cancer trial. Interval censoring exists when an insurance has been purchased but the date of product purchase is not yet known.</p>
<p>The Cox model assesses the hazard of outcome between two groups. The assumption of this model is that the hazard between each arm is proportional <span class="citation">(<a href="#ref-pmid32167523">Stensrud and Hernan 2020</a>)</span>. The proportional hazard model can be tested based on the weighted Schoenfeld residuals<span class="citation">(<a href="#ref-10.1093/biomet/81.3.515">Grambsch and Therneau 1994</a>)</span>. There are non-parametric models available when the assumption of the proportional hazard model does not hold.</p>
<p>In the next chapter on machine learning, an illustration of <a href="machine-learning.html#random-survival-forest-with-rfsrc">random survival forest with <em>rfrsc</em> library</a> and <em>ranger</em> library are provided. In the section on [clinical trial][Interpreting clinical trials] we illustrate how the results can be converted to numbers needed to treat. The median survival corresponding to survival probability of 0.50 can be determined here. Metrics for assessing survival model was described <a href="statistics.html#discrimination-and-calibration">above</a>.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="statistics.html#cb25-1" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb25-2"><a href="statistics.html#cb25-2" tabindex="-1"></a><span class="fu">library</span>(survminer)</span></code></pre></div>
<pre><code>## Loading required package: ggpubr</code></pre>
<pre><code>## 
## Attaching package: &#39;survminer&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:survival&#39;:
## 
##     myeloma</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="statistics.html#cb29-1" tabindex="-1"></a><span class="co">#data from survival package on NCCTG lung cancer trial</span></span>
<span id="cb29-2"><a href="statistics.html#cb29-2" tabindex="-1"></a><span class="co">#https://stat.ethz.ch/R-manual/R-devel/library/survival/html/lung.html</span></span>
<span id="cb29-3"><a href="statistics.html#cb29-3" tabindex="-1"></a><span class="fu">data</span>(cancer, <span class="at">package=</span><span class="st">&quot;survival&quot;</span>)</span>
<span id="cb29-4"><a href="statistics.html#cb29-4" tabindex="-1"></a></span>
<span id="cb29-5"><a href="statistics.html#cb29-5" tabindex="-1"></a><span class="co">#time in is available in days</span></span>
<span id="cb29-6"><a href="statistics.html#cb29-6" tabindex="-1"></a><span class="co">#status censored=1, dead=2</span></span>
<span id="cb29-7"><a href="statistics.html#cb29-7" tabindex="-1"></a><span class="co">#sex:Male=1 Female=2</span></span>
<span id="cb29-8"><a href="statistics.html#cb29-8" tabindex="-1"></a></span>
<span id="cb29-9"><a href="statistics.html#cb29-9" tabindex="-1"></a><span class="fu">survfit</span>(<span class="fu">Surv</span>(time, status) <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> cancer)</span></code></pre></div>
<pre><code>## Call: survfit(formula = Surv(time, status) ~ 1, data = cancer)
## 
##        n events median 0.95LCL 0.95UCL
## [1,] 228    165    310     285     363</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="statistics.html#cb31-1" tabindex="-1"></a>sfit<span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(time, status) <span class="sc">~</span> age<span class="sc">+</span>sex<span class="sc">+</span>ph.ecog<span class="sc">+</span>ph.karno<span class="sc">+</span>wt.loss, <span class="at">data =</span> cancer)</span>
<span id="cb31-2"><a href="statistics.html#cb31-2" tabindex="-1"></a><span class="fu">summary</span>(sfit)</span></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(time, status) ~ age + sex + ph.ecog + ph.karno + 
##     wt.loss, data = cancer)
## 
##   n= 213, number of events= 151 
##    (15 observations deleted due to missingness)
## 
##               coef exp(coef)  se(coef)      z Pr(&gt;|z|)    
## age       0.015157  1.015273  0.009763  1.553 0.120538    
## sex      -0.631422  0.531835  0.177134 -3.565 0.000364 ***
## ph.ecog   0.740204  2.096364  0.191332  3.869 0.000109 ***
## ph.karno  0.015251  1.015368  0.009797  1.557 0.119553    
## wt.loss  -0.009298  0.990745  0.006699 -1.388 0.165168    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##          exp(coef) exp(-coef) lower .95 upper .95
## age         1.0153     0.9850    0.9960    1.0349
## sex         0.5318     1.8803    0.3758    0.7526
## ph.ecog     2.0964     0.4770    1.4408    3.0502
## ph.karno    1.0154     0.9849    0.9961    1.0351
## wt.loss     0.9907     1.0093    0.9778    1.0038
## 
## Concordance= 0.64  (se = 0.026 )
## Likelihood ratio test= 33.53  on 5 df,   p=3e-06
## Wald test            = 32.27  on 5 df,   p=5e-06
## Score (logrank) test = 32.83  on 5 df,   p=4e-06</code></pre>
<p>Test proportional hazard assumption using weighted residuals <span class="citation">(<a href="#ref-10.1093/biomet/81.3.515">Grambsch and Therneau 1994</a>)</span>. The finding below shows that inclusion of covariate ph.karno violate proportional hazard assumption.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="statistics.html#cb33-1" tabindex="-1"></a><span class="fu">cox.zph</span>(sfit)</span></code></pre></div>
<pre><code>##          chisq df     p
## age      0.186  1 0.666
## sex      2.059  1 0.151
## ph.ecog  1.359  1 0.244
## ph.karno 4.916  1 0.027
## wt.loss  0.110  1 0.740
## GLOBAL   7.174  5 0.208</code></pre>
<p>Plot fit of survival model</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="statistics.html#cb35-1" tabindex="-1"></a><span class="fu">ggcoxdiagnostics</span>(sfit, <span class="at">type =</span> <span class="st">&quot;deviance&quot;</span>, </span>
<span id="cb35-2"><a href="statistics.html#cb35-2" tabindex="-1"></a> <span class="at">ox.scale =</span> <span class="st">&quot;linear.predictions&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: `gather_()` was deprecated in tidyr 1.2.0.
## ℹ Please use `gather()` instead.
## ℹ The deprecated feature was likely used in the survminer package.
##   Please report the issue at &lt;https://github.com/kassambara/survminer/issues&gt;.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-6-3-1.png" width="672" /></p>
<p>Forest plot of outcome from survival analysis</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="statistics.html#cb38-1" tabindex="-1"></a><span class="fu">ggforest</span>(sfit)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-6-4-1.png" width="672" /></p>
<p>An alternative way to display the output from Cox regression is to use <em>forestmodel</em> library .</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="statistics.html#cb39-1" tabindex="-1"></a>forestmodel<span class="sc">::</span><span class="fu">forest_model</span>(sfit)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-6-5-1.png" width="672" /></p>
<p>The pseudoR2 for Cox regression model proposed by Royston can be evaluated</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="statistics.html#cb40-1" tabindex="-1"></a><span class="fu">royston</span>(sfit)</span></code></pre></div>
<pre><code>##         D     se(D)       R.D      R.KO       R.N      C.GH 
## 0.8546894 0.1495706 0.1484960 0.1515108 0.1459168 0.6418894</code></pre>
</div>
<div id="quantile-regression" class="section level3 hasAnchor" number="4.5.3">
<h3><span class="header-section-number">4.5.3</span> Quantile regression<a href="statistics.html#quantile-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Least spare regression is appropriate when the data is homoscedascity or the
error term remain constant. This can be seen as the data varies around the
fitted line. Homoscedascity implies that the data is homogenous. Quantile regression is appropriate when the distribution of the data is non-normal and it is more appropriate to look at the conditional median of the dependent variable. There are several libraries for this task <em>quantreg</em> and Bayesian libraries. In the example below, the life time risk of stroke is regressed against life expectancy using lest square and quantile regression.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="statistics.html#cb42-1" tabindex="-1"></a><span class="fu">library</span>(quantreg)</span>
<span id="cb42-2"><a href="statistics.html#cb42-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb42-3"><a href="statistics.html#cb42-3" tabindex="-1"></a></span>
<span id="cb42-4"><a href="statistics.html#cb42-4" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;./Data-Use/world_stroke.Rda&quot;</span>)</span>
<span id="cb42-5"><a href="statistics.html#cb42-5" tabindex="-1"></a></span>
<span id="cb42-6"><a href="statistics.html#cb42-6" tabindex="-1"></a><span class="co">#quantile regression</span></span>
<span id="cb42-7"><a href="statistics.html#cb42-7" tabindex="-1"></a>rqfit <span class="ot">&lt;-</span> <span class="fu">rq</span>( MeanLifetimeRisk<span class="sc">~</span> LifeExpectancy, <span class="at">data =</span> world_sfdf)</span>
<span id="cb42-8"><a href="statistics.html#cb42-8" tabindex="-1"></a>rqfit_sum<span class="ot">&lt;-</span><span class="fu">summary</span>(rqfit)</span>
<span id="cb42-9"><a href="statistics.html#cb42-9" tabindex="-1"></a></span>
<span id="cb42-10"><a href="statistics.html#cb42-10" tabindex="-1"></a><span class="co">#least square regression</span></span>
<span id="cb42-11"><a href="statistics.html#cb42-11" tabindex="-1"></a>lsfit<span class="ot">&lt;-</span><span class="fu">lm</span>(MeanLifetimeRisk<span class="sc">~</span>LifeExpectancy,<span class="at">data=</span>world_sfdf)</span>
<span id="cb42-12"><a href="statistics.html#cb42-12" tabindex="-1"></a>lsfit_sum<span class="ot">&lt;-</span><span class="fu">summary</span>(lsfit) </span>
<span id="cb42-13"><a href="statistics.html#cb42-13" tabindex="-1"></a></span>
<span id="cb42-14"><a href="statistics.html#cb42-14" tabindex="-1"></a><span class="co">#plot</span></span>
<span id="cb42-15"><a href="statistics.html#cb42-15" tabindex="-1"></a><span class="fu">ggplot</span>(world_sfdf,  <span class="fu">aes</span>(<span class="at">x=</span>LifeExpectancy,<span class="at">y=</span>MeanLifetimeRisk))<span class="sc">+</span></span>
<span id="cb42-16"><a href="statistics.html#cb42-16" tabindex="-1"></a>  <span class="co">#add fitted line for least square</span></span>
<span id="cb42-17"><a href="statistics.html#cb42-17" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span>lsfit_sum<span class="sc">$</span>coefficients[<span class="dv">1</span>], <span class="at">slope=</span>lsfit_sum<span class="sc">$</span>coefficients[<span class="dv">2</span>],<span class="at">color=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb42-18"><a href="statistics.html#cb42-18" tabindex="-1"></a>  <span class="co">#add fitted line for quantile regression</span></span>
<span id="cb42-19"><a href="statistics.html#cb42-19" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&quot;Life Expectancy&quot;</span>)<span class="sc">+</span></span>
<span id="cb42-20"><a href="statistics.html#cb42-20" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span>rqfit_sum<span class="sc">$</span>coefficients[<span class="dv">1</span>], <span class="at">slope=</span>rqfit_sum<span class="sc">$</span>coefficients[<span class="dv">2</span>],<span class="at">color=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-7-1.png" width="672" /></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="statistics.html#cb43-1" tabindex="-1"></a><span class="co">#annotate least square and quantile at position x, y</span></span>
<span id="cb43-2"><a href="statistics.html#cb43-2" tabindex="-1"></a><span class="co">#annotate(&quot;text&quot;,x=60, y=27, label=paste0(&quot;least square =&quot;,                        round(lsfit_sum$coefficients[1],2) ,&quot;+&quot;, round(lsfit_sum$coefficients[2],2),&quot;x &quot;,&quot;Life Expectancy&quot;),color=&quot;red&quot;)+ annotate(&quot;text&quot;,x=75, y=12,label=paste0(&quot;quantile =&quot;,round(rqfit_sum$coefficients[1],2), &quot; + &quot;, round(rqfit_sum$coefficients[2],2),&quot; x &quot;,&quot;Life Expectancy&quot;),color=&quot;blue&quot;)</span></span></code></pre></div>
</div>
<div id="non-negative-regression" class="section level3 hasAnchor" number="4.5.4">
<h3><span class="header-section-number">4.5.4</span> Non-negative regression<a href="statistics.html#non-negative-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In certain situations, it is necessary to constrain the analysis so that the regression coefifcients are non-negative. For example, when regressing brain regions against infarct volume, there is no reason believe that a negative coefficient attributable to a brain region is possible<span class="citation">(<a href="#ref-pmid16504541">Phan, Donnan, Koga, et al. 2006</a>)</span> . Non-negative regression can be performed in R using <em>nnls</em>.</p>
</div>
<div id="poisson-regression" class="section level3 hasAnchor" number="4.5.5">
<h3><span class="header-section-number">4.5.5</span> Poisson regression<a href="statistics.html#poisson-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Poisson regression is used when dealing with number of event over time or
distance such as number of new admissions or new cases of hepatitis or TIA over time. An assumption of the Poisson distribution is that the mean &amp; lambda; and variance λ are the same.</p>
<p>A special case of Poisson regression is the negative binomial regression. This latter method is used when the variance is greater than the mean pf the data or over-dispersed data. Negative binomial regression can be applied to number of ‘failure’ event over time. Here ‘failure’ has a lose definition and can be stroke recurrence after TIA or cirrhosis after hepatitis C infection.</p>
<p>Zero-inflated data occurs when there is an abundance of zeroes in the data (true and excess zeroes).</p>
</div>
<div id="conditional-logistic-regression" class="section level3 hasAnchor" number="4.5.6">
<h3><span class="header-section-number">4.5.6</span> Conditional logistic regression<a href="statistics.html#conditional-logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Conditional logistical regression model should be used when the aim is to
compare pair of objects from the same patient. Examples include left and right arms or left and right carotid arteries. This method is available from <em>clogit</em> in <em>survival</em>.</p>
</div>
<div id="multinomial-modelling" class="section level3 hasAnchor" number="4.5.7">
<h3><span class="header-section-number">4.5.7</span> Multinomial modelling<a href="statistics.html#multinomial-modelling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Multinomial modelling is used when the outcome categorical variables are not ordered. This situation can occur when analysis involves choice outcome (choices of fruit: apple, orange or pear). In this case, the log odds of each of the categorical outcomes are analysed as a linear combination of the predictor variables. The <em>nnet</em> library have functions for performing this analysis.</p>
</div>
</div>
<div id="sample-size-estimation" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Sample size estimation<a href="statistics.html#sample-size-estimation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Clinicians are often frustrated about sample size and power estimation for a study, grant or clinical trial. This aspect is scrutinised by ethics committee
and in peer review process for journals. Luckily, R provides several packages
for sample size amd power estimation: <em>pwr</em> library. Cohen has written reference textbook on this subject <span class="citation">(<a href="#ref-COHEN1977179">Cohen 1977</a>)</span>.</p>
<div id="proportion" class="section level3 hasAnchor" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> Proportion<a href="statistics.html#proportion" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="statistics.html#cb44-1" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb44-2"><a href="statistics.html#cb44-2" tabindex="-1"></a><span class="co">#ttest-d is effect size </span></span>
<span id="cb44-3"><a href="statistics.html#cb44-3" tabindex="-1"></a><span class="co">#d = )mean group1 -mean group2)/variance</span></span>
<span id="cb44-4"><a href="statistics.html#cb44-4" tabindex="-1"></a><span class="fu">pwr.t.test</span>(<span class="at">n=</span><span class="dv">300</span>,<span class="at">d=</span><span class="fl">0.2</span>,<span class="at">sig.level=</span>.<span class="dv">05</span>,<span class="at">alternative=</span><span class="st">&quot;greater&quot;</span>) </span></code></pre></div>
<pre><code>## 
##      Two-sample t test power calculation 
## 
##               n = 300
##               d = 0.2
##       sig.level = 0.05
##           power = 0.7886842
##     alternative = greater
## 
## NOTE: n is number in *each* group</code></pre>
<p>We provided an example below for generating power of clinical trial. Examples
are taken from a paper on sample size estimation for phase II trials <span class="citation">(<a href="#ref-pmid16931782">Phan, Donnan, Davis, et al. 2006</a>)</span>.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="statistics.html#cb46-1" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb46-2"><a href="statistics.html#cb46-2" tabindex="-1"></a><span class="co">#h is effect size. effect size of 0.5 is very large </span></span>
<span id="cb46-3"><a href="statistics.html#cb46-3" tabindex="-1"></a><span class="co">#sample size</span></span>
<span id="cb46-4"><a href="statistics.html#cb46-4" tabindex="-1"></a><span class="fu">pwr.2p.test</span>(<span class="at">h=</span><span class="fl">0.5</span>,<span class="at">n=</span><span class="dv">50</span>,<span class="at">sig.level=</span><span class="fl">0.05</span>,<span class="at">alternative=</span><span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<pre><code>## 
##      Difference of proportion power calculation for binomial distribution (arcsine transformation) 
## 
##               h = 0.5
##               n = 50
##       sig.level = 0.05
##           power = 0.705418
##     alternative = two.sided
## 
## NOTE: same sample sizes</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="statistics.html#cb48-1" tabindex="-1"></a><span class="co">#medium effect size</span></span>
<span id="cb48-2"><a href="statistics.html#cb48-2" tabindex="-1"></a><span class="fu">pwr.2p.test</span>(<span class="at">h=</span><span class="fl">0.1</span>,<span class="at">n=</span><span class="dv">50</span>,<span class="at">sig.level=</span><span class="fl">0.05</span>,<span class="at">alternative=</span><span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<pre><code>## 
##      Difference of proportion power calculation for binomial distribution (arcsine transformation) 
## 
##               h = 0.1
##               n = 50
##       sig.level = 0.05
##           power = 0.07909753
##     alternative = two.sided
## 
## NOTE: same sample sizes</code></pre>
<p>The output of the sample size calculation can be put into a table or plot.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="statistics.html#cb50-1" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb50-2"><a href="statistics.html#cb50-2" tabindex="-1"></a><span class="co">#pwr.2p.test(h=0.3,n=80,sig.level=0.05,alternative=&quot;two.sided&quot;)</span></span>
<span id="cb50-3"><a href="statistics.html#cb50-3" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fu">seq</span>(.<span class="dv">1</span>,.<span class="dv">5</span>,.<span class="dv">1</span>) <span class="co">#from 0.1 to 0.3 by 0.05</span></span>
<span id="cb50-4"><a href="statistics.html#cb50-4" tabindex="-1"></a>nh <span class="ot">&lt;-</span> <span class="fu">length</span>(h) <span class="co">#5</span></span>
<span id="cb50-5"><a href="statistics.html#cb50-5" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">seq</span>(.<span class="dv">3</span>,.<span class="dv">9</span>,.<span class="dv">1</span>)<span class="co"># power from 0.5 to 0.9 by 0.1</span></span>
<span id="cb50-6"><a href="statistics.html#cb50-6" tabindex="-1"></a>np <span class="ot">&lt;-</span> <span class="fu">length</span>(p) <span class="co">#9</span></span>
<span id="cb50-7"><a href="statistics.html#cb50-7" tabindex="-1"></a><span class="co"># create an empty array 9 x 5</span></span>
<span id="cb50-8"><a href="statistics.html#cb50-8" tabindex="-1"></a>samplesize <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="fu">numeric</span>(nh<span class="sc">*</span>np), <span class="at">dim=</span><span class="fu">c</span>(nh,np))</span>
<span id="cb50-9"><a href="statistics.html#cb50-9" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>np){</span>
<span id="cb50-10"><a href="statistics.html#cb50-10" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nh){</span>
<span id="cb50-11"><a href="statistics.html#cb50-11" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">pwr.2p.test</span>(<span class="at">n =</span> <span class="cn">NULL</span>, <span class="at">h =</span> h[j],</span>
<span id="cb50-12"><a href="statistics.html#cb50-12" tabindex="-1"></a>    <span class="co">#result &lt;- pwr.r.test(n = NULL, h = h[j],</span></span>
<span id="cb50-13"><a href="statistics.html#cb50-13" tabindex="-1"></a>    <span class="at">sig.level =</span> .<span class="dv">05</span>, <span class="at">power =</span> p[i],</span>
<span id="cb50-14"><a href="statistics.html#cb50-14" tabindex="-1"></a>    <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb50-15"><a href="statistics.html#cb50-15" tabindex="-1"></a>    samplesize[j,i] <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(result<span class="sc">$</span>n)</span>
<span id="cb50-16"><a href="statistics.html#cb50-16" tabindex="-1"></a>  }</span>
<span id="cb50-17"><a href="statistics.html#cb50-17" tabindex="-1"></a>}</span>
<span id="cb50-18"><a href="statistics.html#cb50-18" tabindex="-1"></a>samplesize</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]
## [1,]  412  583  769  980 1235 1570 2102
## [2,]  103  146  193  245  309  393  526
## [3,]   46   65   86  109  138  175  234
## [4,]   26   37   49   62   78   99  132
## [5,]   17   24   31   40   50   63   85</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="statistics.html#cb52-1" tabindex="-1"></a><span class="co">#graph</span></span>
<span id="cb52-2"><a href="statistics.html#cb52-2" tabindex="-1"></a>xrange <span class="ot">&lt;-</span> <span class="fu">range</span>(h)</span>
<span id="cb52-3"><a href="statistics.html#cb52-3" tabindex="-1"></a>yrange <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">range</span>(samplesize))</span>
<span id="cb52-4"><a href="statistics.html#cb52-4" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(<span class="fu">length</span>(p))</span>
<span id="cb52-5"><a href="statistics.html#cb52-5" tabindex="-1"></a><span class="fu">plot</span>(xrange, yrange, <span class="at">type=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb52-6"><a href="statistics.html#cb52-6" tabindex="-1"></a>  <span class="at">xlab=</span><span class="st">&quot;Effect size (h)&quot;</span>,</span>
<span id="cb52-7"><a href="statistics.html#cb52-7" tabindex="-1"></a>  <span class="at">ylab=</span><span class="st">&quot;Sample Size (n)&quot;</span> )</span>
<span id="cb52-8"><a href="statistics.html#cb52-8" tabindex="-1"></a><span class="co"># add power curves</span></span>
<span id="cb52-9"><a href="statistics.html#cb52-9" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>np){</span>
<span id="cb52-10"><a href="statistics.html#cb52-10" tabindex="-1"></a>  <span class="fu">lines</span>(h, samplesize[,i], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span>colors[i])</span>
<span id="cb52-11"><a href="statistics.html#cb52-11" tabindex="-1"></a>}</span>
<span id="cb52-12"><a href="statistics.html#cb52-12" tabindex="-1"></a><span class="co"># add annotation (grid lines, title, legend) </span></span>
<span id="cb52-13"><a href="statistics.html#cb52-13" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>, <span class="at">h=</span><span class="fu">seq</span>(<span class="dv">0</span>,yrange[<span class="dv">2</span>],<span class="dv">50</span>), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;grey89&quot;</span>)</span>
<span id="cb52-14"><a href="statistics.html#cb52-14" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">v=</span><span class="fu">seq</span>(xrange[<span class="dv">1</span>],xrange[<span class="dv">2</span>],.<span class="dv">02</span>), <span class="at">lty=</span><span class="dv">2</span>,</span>
<span id="cb52-15"><a href="statistics.html#cb52-15" tabindex="-1"></a>   <span class="at">col=</span><span class="st">&quot;grey89&quot;</span>)</span>
<span id="cb52-16"><a href="statistics.html#cb52-16" tabindex="-1"></a><span class="fu">title</span>(<span class="st">&quot;Sample Size Estimation</span><span class="sc">\n</span><span class="st"> Difference in Proportion&quot;</span>)</span>
<span id="cb52-17"><a href="statistics.html#cb52-17" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">title=</span><span class="st">&quot;Power&quot;</span>, <span class="fu">as.character</span>(p),</span>
<span id="cb52-18"><a href="statistics.html#cb52-18" tabindex="-1"></a>   <span class="at">fill=</span>colors)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-10-1.png" width="672" /></p>
<div id="non-inferiority" class="section level4 hasAnchor" number="4.6.1.1">
<h4><span class="header-section-number">4.6.1.1</span> Non-inferiority<a href="statistics.html#non-inferiority" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Non-inferiority trials may offer information in a way that a traditional superiority design do not. The design may be interested in other aspect of the treatment such as cost and lower toxicity <span class="citation">(<a href="#ref-pmid26080342">Kaji and Lewis 2015</a>)</span>. Examples of non-inferiority trial designs include antibiotics versus surgery for
appendicitis <span class="citation">(<a href="#ref-pmid26080338">Salminen et al. 2015</a>)</span>. There are concerns with reporting of
noninferiority trial. Justification for the margin provided in 27.6% <span class="citation">(<a href="#ref-pmid25781447">Gopal et al. 2015</a>)</span>. The following describes a trial design where it’s expected that drug will result in a certain outcome <em>p1</em> and the control arm <em>p2</em> and the
ratio of subject in treatment to control arm is <em>k</em>. The difference in outcome
is <em>delta</em>. The margin is defined as non-inferior if &lt;0.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="statistics.html#cb53-1" tabindex="-1"></a><span class="fu">library</span>(TrialSize)</span>
<span id="cb53-2"><a href="statistics.html#cb53-2" tabindex="-1"></a><span class="fu">TwoSampleProportion.NIS</span>(<span class="at">alpha=</span>.<span class="dv">05</span>, </span>
<span id="cb53-3"><a href="statistics.html#cb53-3" tabindex="-1"></a>                        <span class="at">beta=</span>.<span class="dv">8</span>,</span>
<span id="cb53-4"><a href="statistics.html#cb53-4" tabindex="-1"></a>                        <span class="at">p1=</span>.<span class="dv">6</span>,</span>
<span id="cb53-5"><a href="statistics.html#cb53-5" tabindex="-1"></a>                        <span class="at">p2=</span>.<span class="dv">7</span>,</span>
<span id="cb53-6"><a href="statistics.html#cb53-6" tabindex="-1"></a>                        <span class="at">k=</span><span class="dv">1</span>,</span>
<span id="cb53-7"><a href="statistics.html#cb53-7" tabindex="-1"></a>                        <span class="at">delta =</span> .<span class="dv">1</span>,       </span>
<span id="cb53-8"><a href="statistics.html#cb53-8" tabindex="-1"></a>                        <span class="at">margin=</span><span class="sc">-</span>.<span class="dv">2</span></span>
<span id="cb53-9"><a href="statistics.html#cb53-9" tabindex="-1"></a>                        )</span></code></pre></div>
<pre><code>## [1] 3.225911</code></pre>
</div>
</div>
<div id="logistic-regression-1" class="section level3 hasAnchor" number="4.6.2">
<h3><span class="header-section-number">4.6.2</span> Logistic regression<a href="statistics.html#logistic-regression-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="statistics.html#cb55-1" tabindex="-1"></a><span class="fu">library</span>(powerMediation)</span>
<span id="cb55-2"><a href="statistics.html#cb55-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb55-3"><a href="statistics.html#cb55-3" tabindex="-1"></a></span>
<span id="cb55-4"><a href="statistics.html#cb55-4" tabindex="-1"></a><span class="co">#continuous predictor</span></span>
<span id="cb55-5"><a href="statistics.html#cb55-5" tabindex="-1"></a><span class="co">#p1=event rate</span></span>
<span id="cb55-6"><a href="statistics.html#cb55-6" tabindex="-1"></a><span class="co">#exp(0.405) =1.5</span></span>
<span id="cb55-7"><a href="statistics.html#cb55-7" tabindex="-1"></a></span>
<span id="cb55-8"><a href="statistics.html#cb55-8" tabindex="-1"></a><span class="fu">powerLogisticCon</span>(<span class="at">n=</span><span class="dv">200</span>, <span class="at">p1=</span><span class="fl">0.265</span>, <span class="at">OR=</span><span class="fu">exp</span>(<span class="fl">0.014</span>), <span class="at">alpha=</span><span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 0.03056289</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="statistics.html#cb57-1" tabindex="-1"></a><span class="co"># creating a data frame using data from </span></span>
<span id="cb57-2"><a href="statistics.html#cb57-2" tabindex="-1"></a>a<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">05.4</span>,<span class="fl">0.05</span>)</span>
<span id="cb57-3"><a href="statistics.html#cb57-3" tabindex="-1"></a>df_power<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="st">`</span><span class="at">ASPECTS</span><span class="st">`</span><span class="ot">=</span> a,</span>
<span id="cb57-4"><a href="statistics.html#cb57-4" tabindex="-1"></a><span class="st">&quot;Power&quot;</span><span class="ot">=</span><span class="fu">powerLogisticCon</span>(<span class="at">n=</span><span class="dv">100</span>, <span class="at">p1=</span>a, <span class="at">OR=</span><span class="fu">exp</span>(.<span class="dv">695</span>), <span class="at">alpha=</span><span class="fl">0.05</span>)</span>
<span id="cb57-5"><a href="statistics.html#cb57-5" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Warning in sqrt(n * beta.star^2 * p1 * (1 - p1)): NaNs produced</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="statistics.html#cb59-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df_power, <span class="fu">aes</span>(<span class="at">x=</span>ASPECTS, <span class="at">y=</span>Power))<span class="sc">+</span><span class="fu">geom_point</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 88 rows containing missing values (`geom_point()`).</code></pre>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-12-1.png" width="672" /></p>
<p>An alternative library to perform sample size for logistic regression is <em>WebPower</em> library.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="statistics.html#cb61-1" tabindex="-1"></a><span class="fu">library</span>(WebPower) </span></code></pre></div>
<pre><code>## Loading required package: lme4</code></pre>
<pre><code>## 
## Attaching package: &#39;lme4&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:modeltools&#39;:
## 
##     refit</code></pre>
<pre><code>## The following object is masked from &#39;package:nlme&#39;:
## 
##     lmList</code></pre>
<pre><code>## The following object is masked from &#39;package:MatrixModels&#39;:
## 
##     mkRespMod</code></pre>
<pre><code>## The following object is masked from &#39;package:generics&#39;:
## 
##     refit</code></pre>
<pre><code>## Loading required package: lavaan</code></pre>
<pre><code>## This is lavaan 0.6-15
## lavaan is FREE software! Please report any bugs.</code></pre>
<pre><code>## Loading required package: PearsonDS</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="statistics.html#cb71-1" tabindex="-1"></a><span class="fu">wp.logistic</span>(<span class="at">p0=</span><span class="fl">0.007</span>, <span class="co">#Prob (Y=1|X=0) </span></span>
<span id="cb71-2"><a href="statistics.html#cb71-2" tabindex="-1"></a>            <span class="at">p1=</span><span class="fl">0.012</span>, <span class="co">#Prob (Y=1|X=1)</span></span>
<span id="cb71-3"><a href="statistics.html#cb71-3" tabindex="-1"></a>            <span class="at">alpha=</span><span class="fl">0.05</span>, </span>
<span id="cb71-4"><a href="statistics.html#cb71-4" tabindex="-1"></a>            <span class="at">power=</span><span class="fl">0.80</span>, </span>
<span id="cb71-5"><a href="statistics.html#cb71-5" tabindex="-1"></a>            <span class="at">alternative=</span><span class="st">&quot;two.sided&quot;</span>, </span>
<span id="cb71-6"><a href="statistics.html#cb71-6" tabindex="-1"></a>            <span class="at">family=</span><span class="st">&quot;normal&quot;</span>)</span></code></pre></div>
<pre><code>## Power for logistic regression
## 
##        p0    p1     beta0     beta1      n alpha power
##     0.007 0.012 -4.954821 0.5440445 3336.2  0.05   0.8
## 
## URL: http://psychstat.org/logistic</code></pre>
</div>
<div id="survival-studies" class="section level3 hasAnchor" number="4.6.3">
<h3><span class="header-section-number">4.6.3</span> Survival studies<a href="statistics.html#survival-studies" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Sample size for survival studies can be performed using <em>powerSurvEpi</em> or <em>gsDesign</em>.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="statistics.html#cb73-1" tabindex="-1"></a><span class="fu">library</span>(powerSurvEpi)</span>
<span id="cb73-2"><a href="statistics.html#cb73-2" tabindex="-1"></a></span>
<span id="cb73-3"><a href="statistics.html#cb73-3" tabindex="-1"></a><span class="co">#sample size</span></span>
<span id="cb73-4"><a href="statistics.html#cb73-4" tabindex="-1"></a><span class="fu">ssizeEpi.default</span>(<span class="at">power =</span> <span class="fl">0.80</span>, </span>
<span id="cb73-5"><a href="statistics.html#cb73-5" tabindex="-1"></a>                 <span class="at">theta =</span> <span class="dv">2</span>, </span>
<span id="cb73-6"><a href="statistics.html#cb73-6" tabindex="-1"></a>                 <span class="at">p =</span> <span class="fl">0.408</span> , </span>
<span id="cb73-7"><a href="statistics.html#cb73-7" tabindex="-1"></a>                 <span class="at">psi =</span> <span class="fl">0.15</span>,</span>
<span id="cb73-8"><a href="statistics.html#cb73-8" tabindex="-1"></a>                 <span class="at">rho2 =</span> <span class="fl">0.344</span><span class="sc">^</span><span class="dv">2</span>, </span>
<span id="cb73-9"><a href="statistics.html#cb73-9" tabindex="-1"></a>                 <span class="at">alpha =</span> <span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 512</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="statistics.html#cb75-1" tabindex="-1"></a><span class="co">#power</span></span>
<span id="cb75-2"><a href="statistics.html#cb75-2" tabindex="-1"></a><span class="fu">powerEpi.default</span>(<span class="at">n =</span> <span class="dv">2691</span>, </span>
<span id="cb75-3"><a href="statistics.html#cb75-3" tabindex="-1"></a>                 <span class="at">theta =</span> <span class="dv">2</span>, </span>
<span id="cb75-4"><a href="statistics.html#cb75-4" tabindex="-1"></a>                 <span class="at">p =</span> <span class="fl">0.408</span>, </span>
<span id="cb75-5"><a href="statistics.html#cb75-5" tabindex="-1"></a>                 <span class="at">psi =</span> <span class="fl">0.250</span>,</span>
<span id="cb75-6"><a href="statistics.html#cb75-6" tabindex="-1"></a>                 <span class="at">rho2 =</span> <span class="fl">0.344</span><span class="sc">^</span><span class="dv">2</span>, </span>
<span id="cb75-7"><a href="statistics.html#cb75-7" tabindex="-1"></a>                 <span class="at">alpha =</span> <span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="statistics.html#cb77-1" tabindex="-1"></a><span class="co">#Amarenco NEJM 2020 #equal sample size k=1</span></span>
<span id="cb77-2"><a href="statistics.html#cb77-2" tabindex="-1"></a><span class="fu">ssizeCT.default</span>(<span class="at">power =</span> <span class="fl">0.8</span>, <span class="at">k =</span> .<span class="dv">8</span>, <span class="at">pE =</span> <span class="fl">0.085</span>, </span>
<span id="cb77-3"><a href="statistics.html#cb77-3" tabindex="-1"></a>                <span class="at">pC =</span> <span class="fl">0.109</span>, </span>
<span id="cb77-4"><a href="statistics.html#cb77-4" tabindex="-1"></a>                <span class="at">RR =</span> <span class="fl">0.78</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>##   nE   nC 
## 2417 3021</code></pre>
</div>
<div id="multiple-regression" class="section level3 hasAnchor" number="4.6.4">
<h3><span class="header-section-number">4.6.4</span> Multiple regression<a href="statistics.html#multiple-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The power for general linear model can be calculated using the <em>pwr.f2.test</em> function.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="statistics.html#cb79-1" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb79-2"><a href="statistics.html#cb79-2" tabindex="-1"></a><span class="co">#u=degrees of freedom for numerator</span></span>
<span id="cb79-3"><a href="statistics.html#cb79-3" tabindex="-1"></a><span class="co">#v=degrees of freedomfor denominator</span></span>
<span id="cb79-4"><a href="statistics.html#cb79-4" tabindex="-1"></a><span class="co">#f2=effect size</span></span></code></pre></div>
</div>
</div>
<div id="randomised-clinical-trials" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> Randomised clinical trials<a href="statistics.html#randomised-clinical-trials" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A common misconception is that the multiple regression adjust for imbalance in covariates in clinical trial. This issue was observed in the pivotal NINDS alteplase trial. The results of the trial has since been accepted with re-analysis of this trial using covariate adjustment<span class="citation">(<a href="#ref-pmid15345796">Ingall et al. 2004</a>)</span>. There are several methods for covariate adjustment in radomised trials: direct adjustment, standardisation and inverse-probability-of-treatment weighting.</p>
<div id="covariate-adjustment-in-trials" class="section level3 hasAnchor" number="4.7.1">
<h3><span class="header-section-number">4.7.1</span> Covariate adjustment in trials<a href="statistics.html#covariate-adjustment-in-trials" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Specifically, covariate adjustment refers to adjustment of covariates available at the time of randomisation, i.e. prespecified variables and not variables after randomisation such as pneumonia post stroke trials. The advantage of covariate adjustment is that it results in narrower confidence interval as well as increase the power of the trial up to 7% <span class="citation">(<a href="#ref-10.1186/1745-6215-15-139">Kahan 2014</a>)</span>. The increased power is highest when prognostic variables are used but can decrease power when non-prognostic variables are used <span class="citation">(<a href="#ref-10.1186/1745-6215-15-139">Kahan 2014</a>)</span>.</p>
</div>
<div id="subgroup-analysis" class="section level3 hasAnchor" number="4.7.2">
<h3><span class="header-section-number">4.7.2</span> Subgroup analysis<a href="statistics.html#subgroup-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Subgroup analysis can be misleading especially if not specified prior to trial analysis <span class="citation">(<a href="#ref-doi:10.1056/NEJMsr077003">Wang et al. 2007</a>)</span>. Furthermore, increasing the number of subgroup analysis will lead to increasing the chance of false positive result or multiplicity. It is important to differentiate between prespecified and posthoc analyses as posthoc analyses may be biased by examination of the data.</p>
</div>
<div id="p-value-for-interaction" class="section level3 hasAnchor" number="4.7.3">
<h3><span class="header-section-number">4.7.3</span> p value for interaction<a href="statistics.html#p-value-for-interaction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The p value for interaction describe the influence by a baseline variable treatment effect on outcome in clinical trial <span class="citation">(<a href="#ref-doi:10.1056/NEJMsr077003">Wang et al. 2007</a>)</span>. In a hypothetical trial, a significant p value for interaction between males and females for treatment effect on primary outcome indicates heterogenity of treatment effect.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="statistics.html#cb80-1" tabindex="-1"></a><span class="fu">library</span>(Publish)</span></code></pre></div>
<pre><code>## Warning: package &#39;Publish&#39; was built under R version 4.3.2</code></pre>
<pre><code>## Loading required package: prodlim</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;Publish&#39;:
##   method   from
##   print.ci coin</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="statistics.html#cb84-1" tabindex="-1"></a><span class="fu">library</span>(survival)</span></code></pre></div>
</div>
<div id="interpreting-risk-reduction-in-clinical-trials" class="section level3 hasAnchor" number="4.7.4">
<h3><span class="header-section-number">4.7.4</span> Interpreting risk reduction in clinical trials<a href="statistics.html#interpreting-risk-reduction-in-clinical-trials" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A key issue in interpreting of clinical trials occurs when the relative risk
reduction or relative hazard risk are provided. This issue affect the clinical interpretation of the trial finding and its application in practice. An example is the result of the ACAS asymptomatic carotid artery trial is often quoted as showing 50% risk reduction. In fact, there was 2% annual risk of ipsilateral stroke in the medical and 1% risk in the surgical arm. The absolute risk reduction or ARR was 1% per year. However, the 50% relative risk reduction is often quoted to explain to patients.</p>
</div>
<div id="nnt-from-arr" class="section level3 hasAnchor" number="4.7.5">
<h3><span class="header-section-number">4.7.5</span> NNT from ARR<a href="statistics.html#nnt-from-arr" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this case, the number needed to treat (NNT) is given by <span class="math inline">\(\frac{1}{ARR}\)</span> or <span class="math inline">\(\frac{1}{0.01}=100\)</span> to achieve the trial outcome or 100 patients are needed to be treated to reduce the stroke risk to 1%. The recommendation is that the 95% confidence interval for NNT should be provided.</p>
</div>
<div id="nnt-from-odds-ratio" class="section level3 hasAnchor" number="4.7.6">
<h3><span class="header-section-number">4.7.6</span> NNT from odds ratio<a href="statistics.html#nnt-from-odds-ratio" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Calculation of NNT for odds ratio requires knowledge of the outcome of the placebo group. The NNT is given by <span class="math inline">\(\frac{1}{ACR-\frac{OR*ACR}{1-(ACR+OR*ACR)}}\)</span>. The ACR represents the assumed control risk. The NNT can be calculated from <em>nnt</em> function in <em>meta</em> library.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="statistics.html#cb85-1" tabindex="-1"></a><span class="fu">library</span>(meta)</span></code></pre></div>
<pre><code>## Warning: package &#39;meta&#39; was built under R version 4.3.2</code></pre>
<pre><code>## Loading required package: metadat</code></pre>
<pre><code>## Loading &#39;meta&#39; package (version 7.0-0).
## Type &#39;help(meta)&#39; for a brief overview.
## Readers of &#39;Meta-Analysis with R (Use R!)&#39; should install
## older version of &#39;meta&#39; package: https://tinyurl.com/dt4y5drs</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="statistics.html#cb89-1" tabindex="-1"></a><span class="co">#p.c = baseline risk</span></span>
<span id="cb89-2"><a href="statistics.html#cb89-2" tabindex="-1"></a><span class="fu">nnt</span>(<span class="fl">0.73</span>, <span class="at">p.c =</span> <span class="fl">0.3</span>, <span class="at">sm =</span> <span class="st">&quot;OR&quot;</span>)</span></code></pre></div>
<pre><code>##     OR p.c      NNT
## 1 0.73 0.3 16.20811</code></pre>
</div>
<div id="nnt-from-risk-ratio" class="section level3 hasAnchor" number="4.7.7">
<h3><span class="header-section-number">4.7.7</span> NNT from risk ratio<a href="statistics.html#nnt-from-risk-ratio" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="statistics.html#cb91-1" tabindex="-1"></a><span class="co">#data from EXTEND-IV trial in NEJM 2019</span></span>
<span id="cb91-2"><a href="statistics.html#cb91-2" tabindex="-1"></a><span class="co">#outcome 35.4% in tpa and 29.5% in control</span></span>
<span id="cb91-3"><a href="statistics.html#cb91-3" tabindex="-1"></a><span class="fu">nnt</span>(<span class="fl">1.44</span>, <span class="at">p.c =</span> <span class="fl">0.295</span>, <span class="at">sm =</span> <span class="st">&quot;RR&quot;</span>)</span></code></pre></div>
<pre><code>##     RR   p.c      NNT
## 1 1.44 0.295 -7.70416</code></pre>
</div>
<div id="nnt-from-hazard-ratio" class="section level3 hasAnchor" number="4.7.8">
<h3><span class="header-section-number">4.7.8</span> NNT from hazard ratio<a href="statistics.html#nnt-from-hazard-ratio" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Calculation of NNT for hazard ratio requires knowledge of the outcome of the placebo group and the hazard ratio or <em>HR</em>. The formula using the binomial theorem is <span class="math inline">\(p=1-q\)</span> where q is given by the ratio of outcome and numbers recruited in the placebo group. The formula is taken from <span class="citation">(<a href="#ref-pmid32404155">Ludwig, Darmon, and Guerci 2020</a>)</span> . The NNT is given
<span class="math inline">\(\frac{1}{[p^{HR}-p}\)</span> . We illustrated this using data from metaanalysis on aspirin use in stroke in Lancet 2016. There were 45 events among 16053 patients
in the control group. The HR was 0.44. The NNT from this formula <span class="math inline">\(\frac{1}{.9971968^.44-.9971968}\)</span> was 637.</p>
</div>
<div id="nnt-from-metaananlysis" class="section level3 hasAnchor" number="4.7.9">
<h3><span class="header-section-number">4.7.9</span> NNT from metaananlysis<a href="statistics.html#nnt-from-metaananlysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are concerns with using NNT from the results of metaanalysis as the findings are amalgations of trials with different settings <span class="citation">(<a href="#ref-pmid12614141">Marx 2003</a>)</span> <span class="citation">(<a href="#ref-pmid10356018">Smeeth 1999</a>)</span>. The caution applies when baseline risks or absolute risk differences vary across trials.</p>
</div>
</div>
<div id="diagnostic-test" class="section level2 hasAnchor" number="4.8">
<h2><span class="header-section-number">4.8</span> Diagnostic test<a href="statistics.html#diagnostic-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="sensitivity-specificity" class="section level3 hasAnchor" number="4.8.1">
<h3><span class="header-section-number">4.8.1</span> Sensitivity, specificity<a href="statistics.html#sensitivity-specificity" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The sensitivity of a diagnostic test is the true positive rate and the specificity is the true negative rate. Example of 2 x 2 table is provided here. As an exercise, consider a paper about a diagnostic test for peripheral vertigo reporting 100% sensitivity and 94.4% specificity. There are 114 patients, 72 patients without stroke have vertigo and positive test findings. Among patients with stroke 7 of 42 have positive test findings. The sensitivity is <span class="math inline">\(TP=\frac{TP}{TP+FN}\)</span> and the specificity is the <span class="math inline">\(TN=\frac{TN}{TN+FP}\)</span>.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="statistics.html#cb93-1" tabindex="-1"></a><span class="co">#              Peripheral Vertigo</span></span>
<span id="cb93-2"><a href="statistics.html#cb93-2" tabindex="-1"></a><span class="co">#            Disease Positive     Disease Negative</span></span>
<span id="cb93-3"><a href="statistics.html#cb93-3" tabindex="-1"></a><span class="co">#$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$</span></span>
<span id="cb93-4"><a href="statistics.html#cb93-4" tabindex="-1"></a><span class="co"># HIT Test#                 #                      $</span></span>
<span id="cb93-5"><a href="statistics.html#cb93-5" tabindex="-1"></a><span class="co"># Positive# True Positive   # False Positive       $  </span></span>
<span id="cb93-6"><a href="statistics.html#cb93-6" tabindex="-1"></a><span class="co">#         #     72          #       7              $</span></span>
<span id="cb93-7"><a href="statistics.html#cb93-7" tabindex="-1"></a><span class="co">#$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$</span></span>
<span id="cb93-8"><a href="statistics.html#cb93-8" tabindex="-1"></a><span class="co"># HIT Test#                 #                      $</span></span>
<span id="cb93-9"><a href="statistics.html#cb93-9" tabindex="-1"></a><span class="co"># Negative# False Negative  # True Negative        $</span></span>
<span id="cb93-10"><a href="statistics.html#cb93-10" tabindex="-1"></a><span class="co">#         #     0           #       35             $ </span></span>
<span id="cb93-11"><a href="statistics.html#cb93-11" tabindex="-1"></a><span class="co">#$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$</span></span>
<span id="cb93-12"><a href="statistics.html#cb93-12" tabindex="-1"></a></span>
<span id="cb93-13"><a href="statistics.html#cb93-13" tabindex="-1"></a><span class="co"># Peripheral Vertigo</span></span>
<span id="cb93-14"><a href="statistics.html#cb93-14" tabindex="-1"></a><span class="co">#Sensitiviy=TP/(TP+FN)=100%</span></span>
<span id="cb93-15"><a href="statistics.html#cb93-15" tabindex="-1"></a><span class="co">#Specificity=TN/(TN+FP)=83%</span></span></code></pre></div>
</div>
<div id="auc" class="section level3 hasAnchor" number="4.8.2">
<h3><span class="header-section-number">4.8.2</span> AUC<a href="statistics.html#auc" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The area under the receiver operating characteristics (ROC) curve or AUC is a measure of the accuracy of the test. It is recommended that ROC curve is used when there are multiple threshold. It should not be used when the test has only one threshold. Some investigators suggest caution regarding the validity of using receiver operating curve with single threshold diagnostic tests <span class="citation">(<a href="#ref-pmid33250548">J 2020</a>)</span>. An AUC of 0.5 is classified as no better than by chance; 0.6–0.69 provides poor discrimination; 0.7–0.79 provides acceptable (fair) discrimination, 0.8 to 0.89 provides good (excellent) discrimination, and 0.9 to 1.0 provides outstanding discrimination.</p>
</div>
<div id="likelihood-ratio" class="section level3 hasAnchor" number="4.8.3">
<h3><span class="header-section-number">4.8.3</span> Likelihood ratio<a href="statistics.html#likelihood-ratio" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Positive likelihood ratio (PLR) is the ratio of sensitivity to false positive rate (FPR); the negative (NLR) likelihood ratio is the ratio of 1-sensitivity to specificity. A PLR indicates the likelihood that a positive spot sign (test) would be expected in a patient with ICH (target disorder) compared with the likelihood that the same result would be expected in a patient without ICH. Using the recommendation by Jaeschke et al, a high PLR (&gt;5) and low NLR (&lt;0.2) indicate that the test results would make moderate changes in the likelihood of hematoma growth from baseline risk. PLRs of &gt;10 and NLRs of &lt;0.1 would confer very large changes from baseline risk .</p>
<div id="fagans-normogram" class="section level4 hasAnchor" number="4.8.3.1">
<h4><span class="header-section-number">4.8.3.1</span> Fagan’s normogram<a href="statistics.html#fagans-normogram" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Fagan’s normogram can be conceptualised as a sliding ruler to match the disease
prevalence and likelihood ratios to evaluate the impact on the post-test probability <span class="citation">(<a href="#ref-pmid1143310">TJ 1975</a>)</span>. At the current disease prevalence of 23.4% and PLR 4.65, the post-test probability remains low at 0.60.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="statistics.html#cb94-1" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;https://raw.githubusercontent.com/achekroud/nomogrammer/master/nomogrammer.r&quot;</span>)</span>
<span id="cb94-2"><a href="statistics.html#cb94-2" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">nomogrammer</span>(<span class="at">Prevalence =</span> .<span class="dv">234</span>, <span class="at">Plr =</span> <span class="fl">4.85</span>, <span class="at">Nlr =</span> <span class="fl">0.49</span>)</span></code></pre></div>
<pre><code>## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
## ℹ Please use `linewidth` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="statistics.html#cb96-1" tabindex="-1"></a>p<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">&quot;Fagan&#39;s normogram for Spot Sign and ICH growth&quot;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-14-3-2-1.png" width="672" /></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="statistics.html#cb97-1" tabindex="-1"></a><span class="co">#to save the file</span></span>
<span id="cb97-2"><a href="statistics.html#cb97-2" tabindex="-1"></a><span class="co">#ggsave(p,file=&quot;Fagan_SpotSign.png&quot;,width=5.99,height=3.99,units=&quot;in&quot;)</span></span></code></pre></div>
</div>
<div id="likelihood-ratio-graph" class="section level4 hasAnchor" number="4.8.3.2">
<h4><span class="header-section-number">4.8.3.2</span> Likelihood ratio graph<a href="statistics.html#likelihood-ratio-graph" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Likelihood ratio graph is a tool for comparing diagnostic tests <span class="citation">(<a href="#ref-pmid10700737">BJ 2000</a>)</span>.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="statistics.html#cb98-1" tabindex="-1"></a><span class="co">#plot likelihood ratio graph</span></span>
<span id="cb98-2"><a href="statistics.html#cb98-2" tabindex="-1"></a></span>
<span id="cb98-3"><a href="statistics.html#cb98-3" tabindex="-1"></a>LR_graph<span class="ot">&lt;-</span><span class="cf">function</span> (Read,sheet,Sensitivity, Specificity){</span>
<span id="cb98-4"><a href="statistics.html#cb98-4" tabindex="-1"></a>  </span>
<span id="cb98-5"><a href="statistics.html#cb98-5" tabindex="-1"></a>  Read1<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(Read, <span class="at">sheet =</span> sheet)</span>
<span id="cb98-6"><a href="statistics.html#cb98-6" tabindex="-1"></a>  </span>
<span id="cb98-7"><a href="statistics.html#cb98-7" tabindex="-1"></a>  <span class="co">#binary data</span></span>
<span id="cb98-8"><a href="statistics.html#cb98-8" tabindex="-1"></a>  <span class="co">#A=True pos %B=False positive   %C=False negative   %D=True negative</span></span>
<span id="cb98-9"><a href="statistics.html#cb98-9" tabindex="-1"></a>  </span>
<span id="cb98-10"><a href="statistics.html#cb98-10" tabindex="-1"></a>  A<span class="ot">=</span>Read1<span class="sc">$</span>TP</span>
<span id="cb98-11"><a href="statistics.html#cb98-11" tabindex="-1"></a>  B<span class="ot">=</span>Read1<span class="sc">$</span>FP</span>
<span id="cb98-12"><a href="statistics.html#cb98-12" tabindex="-1"></a>  C<span class="ot">=</span>Read1<span class="sc">$</span>FN</span>
<span id="cb98-13"><a href="statistics.html#cb98-13" tabindex="-1"></a>  D<span class="ot">=</span>Read1<span class="sc">$</span>TN</span>
<span id="cb98-14"><a href="statistics.html#cb98-14" tabindex="-1"></a>  </span>
<span id="cb98-15"><a href="statistics.html#cb98-15" tabindex="-1"></a>  TPR<span class="ot">=</span>A<span class="sc">/</span>(A<span class="sc">+</span>C)</span>
<span id="cb98-16"><a href="statistics.html#cb98-16" tabindex="-1"></a>  FPR<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span>(D<span class="sc">/</span>(D<span class="sc">+</span>B))</span>
<span id="cb98-17"><a href="statistics.html#cb98-17" tabindex="-1"></a>  </span>
<span id="cb98-18"><a href="statistics.html#cb98-18" tabindex="-1"></a>  TPR_DiagnosticTest<span class="ot">=</span>Sensitivity</span>
<span id="cb98-19"><a href="statistics.html#cb98-19" tabindex="-1"></a>  FPR_DiagnosticTest<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span>Specificity</span>
<span id="cb98-20"><a href="statistics.html#cb98-20" tabindex="-1"></a>  </span>
<span id="cb98-21"><a href="statistics.html#cb98-21" tabindex="-1"></a>  <span class="co"># set plot</span></span>
<span id="cb98-22"><a href="statistics.html#cb98-22" tabindex="-1"></a>  </span>
<span id="cb98-23"><a href="statistics.html#cb98-23" tabindex="-1"></a>  X<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span>.<span class="dv">1</span>)</span>
<span id="cb98-24"><a href="statistics.html#cb98-24" tabindex="-1"></a>  Y<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span>.<span class="dv">1</span>)</span>
<span id="cb98-25"><a href="statistics.html#cb98-25" tabindex="-1"></a></span>
<span id="cb98-26"><a href="statistics.html#cb98-26" tabindex="-1"></a>  <span class="fu">plot</span>(X,Y,<span class="at">main=</span><span class="st">&quot;Likelihood Ratio graph&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;1-Specificity&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Sensitivity&quot;</span>,<span class="at">cex=</span>.<span class="dv">25</span>)</span>
<span id="cb98-27"><a href="statistics.html#cb98-27" tabindex="-1"></a>  </span>
<span id="cb98-28"><a href="statistics.html#cb98-28" tabindex="-1"></a>  <span class="co">#pch describe the shape. The value 1 corresponds o</span></span>
<span id="cb98-29"><a href="statistics.html#cb98-29" tabindex="-1"></a>  <span class="fu">points</span>(FPR_DiagnosticTest,TPR_DiagnosticTest,<span class="at">pch=</span><span class="dv">8</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">cex=</span><span class="dv">2</span>)</span>
<span id="cb98-30"><a href="statistics.html#cb98-30" tabindex="-1"></a>  </span>
<span id="cb98-31"><a href="statistics.html#cb98-31" tabindex="-1"></a>  <span class="co">#pch describe the shape. The value 8 corresponds *</span></span>
<span id="cb98-32"><a href="statistics.html#cb98-32" tabindex="-1"></a>  <span class="fu">points</span>(FPR,TPR,<span class="at">pch=</span><span class="dv">1</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">cex=</span><span class="dv">2</span>) <span class="co">#add point</span></span>
<span id="cb98-33"><a href="statistics.html#cb98-33" tabindex="-1"></a>  <span class="co">#abline(coef = c(0,1)) #add diagonal line</span></span>
<span id="cb98-34"><a href="statistics.html#cb98-34" tabindex="-1"></a>  df1<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">c1=</span><span class="fu">c</span>(<span class="dv">0</span>,TPR_DiagnosticTest),<span class="at">c2=</span><span class="fu">c</span>(<span class="dv">0</span>,FPR_DiagnosticTest))</span>
<span id="cb98-35"><a href="statistics.html#cb98-35" tabindex="-1"></a>  reg1<span class="ot">&lt;-</span><span class="fu">lm</span>(c1<span class="sc">~</span>c2,<span class="at">data=</span>df1)</span>
<span id="cb98-36"><a href="statistics.html#cb98-36" tabindex="-1"></a>  df2<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">c1=</span><span class="fu">c</span>(TPR_DiagnosticTest,<span class="dv">1</span>),<span class="at">c2=</span><span class="fu">c</span>(FPR_DiagnosticTest,<span class="dv">1</span>))</span>
<span id="cb98-37"><a href="statistics.html#cb98-37" tabindex="-1"></a>  reg2<span class="ot">&lt;-</span><span class="fu">lm</span>(c1<span class="sc">~</span>c2,<span class="at">data=</span>df2)</span>
<span id="cb98-38"><a href="statistics.html#cb98-38" tabindex="-1"></a>  <span class="fu">abline</span>(reg1)</span>
<span id="cb98-39"><a href="statistics.html#cb98-39" tabindex="-1"></a>  <span class="fu">abline</span>(reg2)</span>
<span id="cb98-40"><a href="statistics.html#cb98-40" tabindex="-1"></a>  <span class="fu">text</span>(<span class="at">x=</span>FPR_DiagnosticTest,<span class="at">y=</span>TPR_DiagnosticTest<span class="fl">+.3</span>,<span class="at">label=</span><span class="st">&quot;Superior&quot;</span>,<span class="at">cex=</span>.<span class="dv">7</span>)</span>
<span id="cb98-41"><a href="statistics.html#cb98-41" tabindex="-1"></a>  <span class="fu">text</span>(<span class="at">x=</span>FPR_DiagnosticTest<span class="fl">+.2</span>,<span class="at">y=</span>TPR_DiagnosticTest<span class="fl">+.2</span>,<span class="at">label=</span><span class="st">&quot;Absence&quot;</span>,<span class="at">cex=</span>.<span class="dv">7</span>)</span>
<span id="cb98-42"><a href="statistics.html#cb98-42" tabindex="-1"></a>  <span class="fu">text</span>(<span class="at">x=</span>.<span class="dv">0125</span>,<span class="at">y=</span>TPR_DiagnosticTest<span class="fl">-.1</span>,<span class="at">label=</span><span class="st">&quot;Presence&quot;</span>,<span class="at">cex=</span>.<span class="dv">7</span>)</span>
<span id="cb98-43"><a href="statistics.html#cb98-43" tabindex="-1"></a>  <span class="fu">text</span>(<span class="at">x=</span>FPR_DiagnosticTest<span class="fl">+.1</span>,<span class="at">y=</span>TPR_DiagnosticTest,<span class="at">label=</span><span class="st">&quot;Inferior&quot;</span>,<span class="at">cex=</span>.<span class="dv">7</span>)</span>
<span id="cb98-44"><a href="statistics.html#cb98-44" tabindex="-1"></a>  <span class="fu">text</span>(<span class="at">x=</span>.<span class="dv">7</span>,<span class="at">y=</span>.<span class="dv">2</span>,<span class="at">label=</span><span class="st">&quot;Reference = Content Expert&quot;</span>,<span class="at">cex=</span>.<span class="dv">7</span>)</span>
<span id="cb98-45"><a href="statistics.html#cb98-45" tabindex="-1"></a>  <span class="fu">text</span>(<span class="at">x=</span>.<span class="dv">7</span>,<span class="at">y=</span>.<span class="dv">15</span>, <span class="at">label=</span><span class="st">&quot;Diagnostic Test software&quot;</span>, <span class="at">cex=</span>.<span class="dv">7</span>)</span>
<span id="cb98-46"><a href="statistics.html#cb98-46" tabindex="-1"></a></span>
<span id="cb98-47"><a href="statistics.html#cb98-47" tabindex="-1"></a>}</span></code></pre></div>
<p>Runnning the function from above</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="statistics.html#cb99-1" tabindex="-1"></a><span class="co">#Sensitivity=0.623</span></span>
<span id="cb99-2"><a href="statistics.html#cb99-2" tabindex="-1"></a><span class="co">#Specificity=1-.927</span></span>
<span id="cb99-3"><a href="statistics.html#cb99-3" tabindex="-1"></a></span>
<span id="cb99-4"><a href="statistics.html#cb99-4" tabindex="-1"></a><span class="fu">LR_graph</span>(<span class="st">&quot;./Data-Use/Diagnostic_test_summary.xlsx&quot;</span>,<span class="dv">1</span>,.<span class="dv">623</span>,.<span class="dv">927</span>)</span></code></pre></div>
<pre><code>## New names:
## • `` -&gt; `...11`</code></pre>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-14-3-3-1-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="metaanalysis" class="section level2 hasAnchor" number="4.9">
<h2><span class="header-section-number">4.9</span> Metaanalysis<a href="statistics.html#metaanalysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>During journal club, junior doctors are often taught about the importance of metaanalysis. It is worth knowing how to perform a metaanalysis in order to critique the study. This is an important issue as the junior doctor is supervised by someone who a content expert but not necessarily a method expert. Metaanalysis can be performed for clinical trials, cohort studies or diagnostic studies. As an example, it is not well known outside of statistics journal that the bivariate analysis is the preferred method to evaluate diagnostic studies <span class="citation">(<a href="#ref-pmid16168343">Reitsma et al. 2005</a>)</span>. By contrast, the majority of metaanalysis of diagnostic studies uses the univariate method of Moses and Littenberg <span class="citation">(<a href="#ref-pmid8210827">Moses, Shapiro, and Littenberg 1993</a>)</span>. This issue will be expanded below.</p>
<div id="quality-of-study" class="section level3 hasAnchor" number="4.9.1">
<h3><span class="header-section-number">4.9.1</span> Quality of study<a href="statistics.html#quality-of-study" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>All studies require evaluation of the quality of the individual studies. This can be done with the QUADAS2 tool, available at
<a href="https://annals.org/aim/fullarticle/474994/quadas-2-revised-tool-quality-assessment-diagnostic-accuracy-studies" class="uri">https://annals.org/aim/fullarticle/474994/quadas-2-revised-tool-quality-assessment-diagnostic-accuracy-studies</a>.</p>
</div>
<div id="prisma" class="section level3 hasAnchor" number="4.9.2">
<h3><span class="header-section-number">4.9.2</span> PRISMA<a href="statistics.html#prisma" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The PRISMA statement is useful for understanding the search strategy and the papers removed and retained in the metaanalysis. An example of generating the statement is provided below in R. The example given here is from a paper on the use of spot sign to predict enlargment of intracerebral hemorrhage <span class="citation">(<a href="#ref-pmid31272327">Phan et al. 2019</a>)</span>.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="statistics.html#cb101-1" tabindex="-1"></a><span class="fu">library</span>(PRISMAstatement)</span>
<span id="cb101-2"><a href="statistics.html#cb101-2" tabindex="-1"></a><span class="co">#example from Spot sign paper. Stroke 2019</span></span>
<span id="cb101-3"><a href="statistics.html#cb101-3" tabindex="-1"></a><span class="fu">prisma</span>(<span class="at">found =</span> <span class="dv">193</span>,</span>
<span id="cb101-4"><a href="statistics.html#cb101-4" tabindex="-1"></a>       <span class="at">found_other =</span> <span class="dv">27</span>,</span>
<span id="cb101-5"><a href="statistics.html#cb101-5" tabindex="-1"></a>       <span class="at">no_dupes =</span> <span class="dv">141</span>, </span>
<span id="cb101-6"><a href="statistics.html#cb101-6" tabindex="-1"></a>       <span class="at">screened =</span> <span class="dv">141</span>, </span>
<span id="cb101-7"><a href="statistics.html#cb101-7" tabindex="-1"></a>       <span class="at">screen_exclusions =</span> <span class="dv">3</span>, </span>
<span id="cb101-8"><a href="statistics.html#cb101-8" tabindex="-1"></a>       <span class="at">full_text =</span> <span class="dv">138</span>,</span>
<span id="cb101-9"><a href="statistics.html#cb101-9" tabindex="-1"></a>       <span class="at">full_text_exclusions =</span> <span class="dv">112</span>, </span>
<span id="cb101-10"><a href="statistics.html#cb101-10" tabindex="-1"></a>       <span class="at">qualitative =</span> <span class="dv">26</span>, </span>
<span id="cb101-11"><a href="statistics.html#cb101-11" tabindex="-1"></a>       <span class="at">quantitative =</span> <span class="dv">26</span>,</span>
<span id="cb101-12"><a href="statistics.html#cb101-12" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">800</span>, <span class="at">height =</span> <span class="dv">800</span>)</span></code></pre></div>
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-ac8318d6762cd5c410cc" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-ac8318d6762cd5c410cc">{"x":{"diagram":"digraph prisma {\n    node [shape=\"box\", fontsize = 10];\n    graph [splines=ortho, nodesep=1, dpi = 72]\n    a -> nodups;\n    b -> nodups;\n    a [label=\"Records identified through\ndatabase searching\n(n = 193)\"];\n    b [label=\"Additional records identified\nthrough other sources\n(n = 27)\"]\n    nodups -> incex;\n    nodups [label=\"Records after duplicates removed\n(n = 141)\"];\n    incex -> {ex; ft}\n    incex [label=\"Records screened\n(n = 141)\"];\n    ex [label=\"Records excluded\n(n = 3)\"];\n    {rank=same; incex ex}\n    ft -> {qual; ftex};\n    ft [label=\"Full-text articles assessed\nfor eligibility\n(n = 138)\"];\n    {rank=same; ft ftex}\n    ftex [label=\"Full-text articles excluded,\nwith reasons\n(n = 112)\"];\n    qual -> quant\n    qual [label=\"Studies included in qualitative synthesis\n(n = 26)\"];\n    quant [label=\"Studies included in\nquantitative synthesis\n(meta-analysis)\n(n = 26)\"];\n  }","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="statistics.html#cb102-1" tabindex="-1"></a><span class="co">#https://rich-iannone.github.io/DiagrammeR/graphviz_and_mermaid.html#attributes</span></span>
<span id="cb102-2"><a href="statistics.html#cb102-2" tabindex="-1"></a><span class="fu">library</span>(DiagrammeR)</span>
<span id="cb102-3"><a href="statistics.html#cb102-3" tabindex="-1"></a><span class="fu">grViz</span>(<span class="st">&quot;</span></span>
<span id="cb102-4"><a href="statistics.html#cb102-4" tabindex="-1"></a><span class="st">digraph boxes_and_circles {</span></span>
<span id="cb102-5"><a href="statistics.html#cb102-5" tabindex="-1"></a></span>
<span id="cb102-6"><a href="statistics.html#cb102-6" tabindex="-1"></a><span class="st">  # a &#39;graph&#39; statement</span></span>
<span id="cb102-7"><a href="statistics.html#cb102-7" tabindex="-1"></a><span class="st">  graph [overlap = true, fontsize = 10]</span></span>
<span id="cb102-8"><a href="statistics.html#cb102-8" tabindex="-1"></a></span>
<span id="cb102-9"><a href="statistics.html#cb102-9" tabindex="-1"></a><span class="st">  # several &#39;node&#39; statements</span></span>
<span id="cb102-10"><a href="statistics.html#cb102-10" tabindex="-1"></a><span class="st">  node [shape = box,</span></span>
<span id="cb102-11"><a href="statistics.html#cb102-11" tabindex="-1"></a><span class="st">        fontname = Helvetica]</span></span>
<span id="cb102-12"><a href="statistics.html#cb102-12" tabindex="-1"></a><span class="st">  Stroke</span></span>
<span id="cb102-13"><a href="statistics.html#cb102-13" tabindex="-1"></a></span>
<span id="cb102-14"><a href="statistics.html#cb102-14" tabindex="-1"></a><span class="st">  node [shape = oval,</span></span>
<span id="cb102-15"><a href="statistics.html#cb102-15" tabindex="-1"></a><span class="st">        fixedsize = false,</span></span>
<span id="cb102-16"><a href="statistics.html#cb102-16" tabindex="-1"></a><span class="st">        color=red,</span></span>
<span id="cb102-17"><a href="statistics.html#cb102-17" tabindex="-1"></a><span class="st">        width = 0.9] </span></span>
<span id="cb102-18"><a href="statistics.html#cb102-18" tabindex="-1"></a><span class="st">  Hypertension; &#39;No Hypertension&#39;</span></span>
<span id="cb102-19"><a href="statistics.html#cb102-19" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb102-20"><a href="statistics.html#cb102-20" tabindex="-1"></a><span class="st">  node [shape= circle,</span></span>
<span id="cb102-21"><a href="statistics.html#cb102-21" tabindex="-1"></a><span class="st">  fontcolor=red,</span></span>
<span id="cb102-22"><a href="statistics.html#cb102-22" tabindex="-1"></a><span class="st">        color=blue,</span></span>
<span id="cb102-23"><a href="statistics.html#cb102-23" tabindex="-1"></a><span class="st">        fixedsize=false]</span></span>
<span id="cb102-24"><a href="statistics.html#cb102-24" tabindex="-1"></a></span>
<span id="cb102-25"><a href="statistics.html#cb102-25" tabindex="-1"></a><span class="st">  Hypokalemia; &#39;No Hypokalemia&#39;        </span></span>
<span id="cb102-26"><a href="statistics.html#cb102-26" tabindex="-1"></a></span>
<span id="cb102-27"><a href="statistics.html#cb102-27" tabindex="-1"></a><span class="st">  # several &#39;edge&#39; statements</span></span>
<span id="cb102-28"><a href="statistics.html#cb102-28" tabindex="-1"></a><span class="st">  edge [arrowhead=diamond]</span></span>
<span id="cb102-29"><a href="statistics.html#cb102-29" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb102-30"><a href="statistics.html#cb102-30" tabindex="-1"></a><span class="st">  Stroke-&gt;{Hypertension, &#39;No Hypertension&#39;}</span></span>
<span id="cb102-31"><a href="statistics.html#cb102-31" tabindex="-1"></a><span class="st">  Hypertension-&gt;{Hypokalemia, &#39;No Hypokalemia&#39;}</span></span>
<span id="cb102-32"><a href="statistics.html#cb102-32" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb102-33"><a href="statistics.html#cb102-33" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb102-34"><a href="statistics.html#cb102-34" tabindex="-1"></a></span>
<span id="cb102-35"><a href="statistics.html#cb102-35" tabindex="-1"></a><span class="st">&quot;</span>)</span></code></pre></div>
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-d53a70309cce939296c5" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-d53a70309cce939296c5">{"x":{"diagram":"\ndigraph boxes_and_circles {\n\n  # a \"graph\" statement\n  graph [overlap = true, fontsize = 10]\n\n  # several \"node\" statements\n  node [shape = box,\n        fontname = Helvetica]\n  Stroke\n\n  node [shape = oval,\n        fixedsize = false,\n        color=red,\n        width = 0.9] \n  Hypertension; \"No Hypertension\"\n  \n  node [shape= circle,\n  fontcolor=red,\n        color=blue,\n        fixedsize=false]\n\n  Hypokalemia; \"No Hypokalemia\"        \n\n  # several \"edge\" statements\n  edge [arrowhead=diamond]\n  \n  Stroke->{Hypertension, \"No Hypertension\"}\n  Hypertension->{Hypokalemia, \"No Hypokalemia\"}\n  \n}\n\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="statistics.html#cb103-1" tabindex="-1"></a><span class="do">## alternative</span></span>
<span id="cb103-2"><a href="statistics.html#cb103-2" tabindex="-1"></a></span>
<span id="cb103-3"><a href="statistics.html#cb103-3" tabindex="-1"></a><span class="fu">grViz</span>(<span class="st">&quot;digraph flowchart {</span></span>
<span id="cb103-4"><a href="statistics.html#cb103-4" tabindex="-1"></a><span class="st">      # node definitions with substituted label text</span></span>
<span id="cb103-5"><a href="statistics.html#cb103-5" tabindex="-1"></a><span class="st">      node [fontname = Helvetica, shape = rectangle]        </span></span>
<span id="cb103-6"><a href="statistics.html#cb103-6" tabindex="-1"></a><span class="st">      tab1 [label = &#39;@@1&#39;]</span></span>
<span id="cb103-7"><a href="statistics.html#cb103-7" tabindex="-1"></a><span class="st">      tab2 [label = &#39;@@2&#39;]</span></span>
<span id="cb103-8"><a href="statistics.html#cb103-8" tabindex="-1"></a><span class="st">      tab3 [label = &#39;@@3&#39;]</span></span>
<span id="cb103-9"><a href="statistics.html#cb103-9" tabindex="-1"></a><span class="st">      tab4 [label = &#39;@@4&#39;]</span></span>
<span id="cb103-10"><a href="statistics.html#cb103-10" tabindex="-1"></a><span class="st">      tab5 [label = &#39;@@5&#39;]</span></span>
<span id="cb103-11"><a href="statistics.html#cb103-11" tabindex="-1"></a></span>
<span id="cb103-12"><a href="statistics.html#cb103-12" tabindex="-1"></a><span class="st"> </span></span>
<span id="cb103-13"><a href="statistics.html#cb103-13" tabindex="-1"></a><span class="st"># edge definitions with the node IDs</span></span>
<span id="cb103-14"><a href="statistics.html#cb103-14" tabindex="-1"></a><span class="st">      tab1 -&gt; tab3 </span></span>
<span id="cb103-15"><a href="statistics.html#cb103-15" tabindex="-1"></a><span class="st">      tab1-&gt; tab2 </span></span>
<span id="cb103-16"><a href="statistics.html#cb103-16" tabindex="-1"></a><span class="st">      #tab2-&gt;tab3</span></span>
<span id="cb103-17"><a href="statistics.html#cb103-17" tabindex="-1"></a><span class="st">      tab2 -&gt; tab4 </span></span>
<span id="cb103-18"><a href="statistics.html#cb103-18" tabindex="-1"></a><span class="st">      tab2-&gt; tab5;</span></span>
<span id="cb103-19"><a href="statistics.html#cb103-19" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb103-20"><a href="statistics.html#cb103-20" tabindex="-1"></a></span>
<span id="cb103-21"><a href="statistics.html#cb103-21" tabindex="-1"></a><span class="st">      [1]: &#39;Stroke n=19&#39;</span></span>
<span id="cb103-22"><a href="statistics.html#cb103-22" tabindex="-1"></a><span class="st">      [2]: &#39;Hypertension n=10&#39;</span></span>
<span id="cb103-23"><a href="statistics.html#cb103-23" tabindex="-1"></a><span class="st">      [3]: &#39;No Hypertension n=9&#39;</span></span>
<span id="cb103-24"><a href="statistics.html#cb103-24" tabindex="-1"></a><span class="st">      [4]: &#39;Hypokalemia n=?&#39;</span></span>
<span id="cb103-25"><a href="statistics.html#cb103-25" tabindex="-1"></a><span class="st">      [5]: &#39;No Hypokalemia n=?&#39;</span></span>
<span id="cb103-26"><a href="statistics.html#cb103-26" tabindex="-1"></a><span class="st">      &quot;</span>)</span></code></pre></div>
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-ce39427d9444aa96e26e" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-ce39427d9444aa96e26e">{"x":{"diagram":"digraph flowchart {\n      # node definitions with substituted label text\n      node [fontname = Helvetica, shape = rectangle]        \n      tab1 [label = \"Stroke n=19\"]\n      tab2 [label = \"Hypertension n=10\"]\n      tab3 [label = \"No Hypertension n=9\"]\n      tab4 [label = \"Hypokalemia n=?\"]\n      tab5 [label = \"No Hypokalemia n=?\"]\n\n \n# edge definitions with the node IDs\n      tab1 -> tab3 \n      tab1-> tab2 \n      #tab2->tab3\n      tab2 -> tab4 \n      tab2-> tab5;\n      }","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="conversion-of-median-to-mean" class="section level3 hasAnchor" number="4.9.3">
<h3><span class="header-section-number">4.9.3</span> Conversion of median to mean<a href="statistics.html#conversion-of-median-to-mean" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One issue with performing metaanalysis is that one paper may report mean and another report median age. The formula for the mean is given by <span class="math inline">\(\frac{a+2m+b}{4}\)</span> where <em>m</em> is the median, <em>a</em> is the upper and <em>b</em> is the lower range <span class="citation">(<a href="#ref-pmid25524443">Wan 2014</a>)</span>. The variance is given by <span class="math inline">\(S^2=\frac{1}{12}(\frac{(a+2m+b)^2}{4}+{(b-a)^2})\)</span>. This formula requires examination of the data such as the figure to obtain the upper and lower range. These changes are incorporated into <em>meta</em> libray using <em>meatamean</em> function <span class="citation">(<a href="#ref-doi10.1136/ebmental-2019-300117">Balduzzi, Rücker, and Schwarzer 2019</a>)</span>. More recently, investigators suggest to also consider the skewness of the data from the 5 number summary data <span class="citation">(<a href="#ref-pmid37161735">Shi et al. 2023</a>)</span>. The argument <em>method.mean</em> in function <em>metamean</em> is used to specify the method for estimating the mean. In this case we chose the Luo method for illustration Luo <span class="citation">(<a href="#ref-doi:10.1177/0962280216669183">Luo et al. 2018</a>)</span>. See the help page by typing question mark before <em>metamean</em> for more options.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="statistics.html#cb104-1" tabindex="-1"></a><span class="fu">library</span>(meta)</span>
<span id="cb104-2"><a href="statistics.html#cb104-2" tabindex="-1"></a></span>
<span id="cb104-3"><a href="statistics.html#cb104-3" tabindex="-1"></a><span class="co">#NIHSS data from ANGEL large core trial in NEJM 2023</span></span>
<span id="cb104-4"><a href="statistics.html#cb104-4" tabindex="-1"></a><span class="fu">metamean</span>(<span class="at">q1=</span><span class="dv">4</span>,<span class="at">q3=</span><span class="dv">20</span>,<span class="at">median=</span><span class="dv">16</span>,<span class="at">n=</span><span class="dv">230</span>, <span class="at">method.mean =</span> <span class="st">&quot;Luo&quot;</span>)</span></code></pre></div>
<pre><code>## Number of observations: o = 230
## 
##     mean             95%-CI
##  13.1932 [11.6506; 14.7358]
## 
## Details:
## - Untransformed (raw) means</code></pre>
<p>Here the same data is used for the McGrath method <span class="citation">(<a href="#ref-doi:10.1177/0962280219889080">McGrath et al. 2020</a>)</span>.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="statistics.html#cb106-1" tabindex="-1"></a><span class="fu">metamean</span>(<span class="at">q1=</span><span class="dv">4</span>,<span class="at">q3=</span><span class="dv">20</span>,<span class="at">median=</span><span class="dv">16</span>,<span class="at">n=</span><span class="dv">230</span>, <span class="at">method.mean =</span> <span class="st">&quot;QE-McGrath&quot;</span>)</span></code></pre></div>
<pre><code>## Number of observations: o = 230
## 
##     mean             95%-CI
##  13.3333 [11.7907; 14.8759]
## 
## Details:
## - Untransformed (raw) means</code></pre>
<p>The conversion from median to mean in <em>metafor</em> is performed using <em>conv.fivenum</em> function <span class="citation">(<a href="#ref-JSSv036i03">Viechtbauer 2010</a>)</span>. There is an update on the <em>metafor</em> page as well as discussion on alternate approach. The default method of this function is to use the methods by Luo <span class="citation">(<a href="#ref-doi:10.1177/0962280216669183">Luo et al. 2018</a>)</span>, Wan <span class="citation">(<a href="#ref-pmid25524443">Wan 2014</a>)</span> and Shi <span class="citation">(<a href="#ref-pmid37161735">Shi et al. 2023</a>)</span></p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="statistics.html#cb108-1" tabindex="-1"></a><span class="fu">library</span>(metafor)</span></code></pre></div>
<pre><code>## Loading required package: numDeriv</code></pre>
<pre><code>## 
## Loading the &#39;metafor&#39; package (version 4.2-0). For an
## introduction to the package please type: help(metafor)</code></pre>
<pre><code>## 
## Attaching package: &#39;metafor&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:rms&#39;:
## 
##     vif</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="statistics.html#cb113-1" tabindex="-1"></a><span class="co"># example data frame</span></span>
<span id="cb113-2"><a href="statistics.html#cb113-2" tabindex="-1"></a>EstMean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Paper=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="cn">NA</span>), <span class="at">min=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="cn">NA</span>,<span class="dv">2</span>,<span class="cn">NA</span>), <span class="at">q1=</span><span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="cn">NA</span>),</span>
<span id="cb113-3"><a href="statistics.html#cb113-3" tabindex="-1"></a>                  <span class="at">median=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">6</span>,<span class="cn">NA</span>), <span class="at">q3=</span><span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="dv">10</span>,<span class="dv">10</span>,<span class="cn">NA</span>),</span>
<span id="cb113-4"><a href="statistics.html#cb113-4" tabindex="-1"></a>                  <span class="at">max=</span><span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">14</span>,<span class="cn">NA</span>,<span class="dv">14</span>,<span class="cn">NA</span>),</span>
<span id="cb113-5"><a href="statistics.html#cb113-5" tabindex="-1"></a>                  <span class="at">mean=</span><span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="fl">7.0</span>), <span class="at">sd=</span><span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="fl">4.2</span>),</span>
<span id="cb113-6"><a href="statistics.html#cb113-6" tabindex="-1"></a>                  <span class="at">n=</span><span class="fu">c</span>(<span class="dv">30</span>,<span class="dv">30</span>,<span class="dv">30</span>,<span class="dv">30</span>,<span class="dv">30</span>))</span>
<span id="cb113-7"><a href="statistics.html#cb113-7" tabindex="-1"></a>EstMean</span></code></pre></div>
<pre><code>##   Paper min q1 median q3 max mean  sd  n
## 1     1   1 NA      5 NA  12   NA  NA 30
## 2     2   2 NA      6 NA  14   NA  NA 30
## 3     3  NA  4      6 10  NA   NA  NA 30
## 4     4   2  4      6 10  14   NA  NA 30
## 5    NA  NA NA     NA NA  NA    7 4.2 30</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="statistics.html#cb115-1" tabindex="-1"></a>EstMean <span class="ot">&lt;-</span> <span class="fu">conv.fivenum</span>(<span class="at">min=</span>min, <span class="at">q1=</span>q1, <span class="at">median=</span>median, <span class="at">q3=</span>q3, <span class="at">max=</span>max, <span class="at">n=</span>n, <span class="at">data=</span>EstMean)</span>
<span id="cb115-2"><a href="statistics.html#cb115-2" tabindex="-1"></a></span>
<span id="cb115-3"><a href="statistics.html#cb115-3" tabindex="-1"></a>EstMean</span></code></pre></div>
<pre><code>##   Paper min q1 median q3 max     mean       sd  n
## 1     1   1 NA      5 NA  12 5.356748 2.695707 30
## 2     2   2 NA      6 NA  14 6.475664 2.940771 30
## 3     3  NA  4      6 10  NA 6.713000 4.670521 30
## 4     4   2  4      6 10  14 6.882074 3.546379 30
## 5    NA  NA NA     NA NA  NA 7.000000 4.200000 30</code></pre>
<p>The <em>estmeansd</em> library uses quantile estimation method with <em>qe.mean.sd</em> function when the data available are the median and quartile ranges <span class="citation">(<a href="#ref-doi:10.1177/0962280219889080">McGrath et al. 2020</a>)</span> <span class="citation">(<a href="#ref-pmid36412105">McGrath et al. 2022</a>)</span>.The approach here is to use simulation to estimate the parameters.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="statistics.html#cb117-1" tabindex="-1"></a><span class="fu">library</span>(estmeansd)</span></code></pre></div>
<pre><code>## Warning: package &#39;estmeansd&#39; was built under R version 4.3.2</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="statistics.html#cb119-1" tabindex="-1"></a><span class="co">#data from ANGEL large core trial in NEJM 2023</span></span>
<span id="cb119-2"><a href="statistics.html#cb119-2" tabindex="-1"></a>res_qe <span class="ot">&lt;-</span> <span class="fu">bc.mean.sd</span>(<span class="at">q1.val =</span> <span class="dv">13</span>, <span class="at">med.val =</span> <span class="dv">16</span>, <span class="at">q3.val =</span> <span class="dv">20</span>, <span class="at">n =</span> <span class="dv">230</span>)</span>
<span id="cb119-3"><a href="statistics.html#cb119-3" tabindex="-1"></a>res_qe </span></code></pre></div>
<pre><code>## $est.mean
## [1] 17.00748
## 
## $est.sd
## [1] 5.815726</code></pre>
<p>The standard error from the mean can be estimated using <em>get_SE</em> function.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="statistics.html#cb121-1" tabindex="-1"></a><span class="fu">get_SE</span>(res_qe)</span></code></pre></div>
<pre><code>## $est.se
## [1] 0.4922415
## 
## $boot_means
##    [1] 16.87991 17.14172 16.95313 16.68203 16.56053 16.86812 17.15030 16.97379
##    [9] 16.71541 17.74775 16.59086 17.02446 16.80924 16.64308 16.55371 16.31588
##   [17] 16.86772 17.20916 17.32541 16.52969 16.68171 17.13063 16.82962 17.15085
##   [25] 15.90924 16.44482 16.78636 17.10417 16.23885 16.67869 17.03853 17.00123
##   [33] 16.47368 16.40935 16.32533 16.19331 17.58570 16.88390 16.80751 15.98699
##   [41] 17.21037 16.41521 16.28797 15.43386 16.43574 16.53304 16.08837 16.13372
##   [49] 17.35627 16.38003 17.48651 17.72729 17.51627 17.08103 15.87308 16.37014
##   [57] 17.43486 16.77427 17.35266 17.34012 17.34873 16.57619 17.88952 16.62764
##   [65] 17.07991 16.84501 16.73553 16.23439 16.39875 16.33986 16.81581 16.69933
##   [73] 17.24425 17.43694 17.06847 16.49872 16.90791 16.95022 16.90796 15.52966
##   [81] 16.60512 16.71589 17.05658 17.08813 16.80623 16.78089 16.65833 16.91498
##   [89] 16.82236 16.82052 17.28110 17.07085 15.96031 16.87352 16.47865 16.32104
##   [97] 16.54299 16.73389 16.44866 16.93736 16.68199 16.49783 16.80317 16.88824
##  [105] 16.69935 16.36794 16.65372 16.37717 16.63966 15.93912 16.57428 16.88056
##  [113] 17.42797 17.73374 16.40135 15.85709 17.20397 17.12850 17.10718 16.43615
##  [121] 16.17704 16.40656 16.57770 17.54063 16.99185 17.35517 16.71691 16.09703
##  [129] 16.78836 16.74520 16.69064 16.61192 16.31707 16.02064 17.32278 17.94998
##  [137] 16.31180 16.32577 16.99068 16.47566 16.71434 17.30154 17.48771 16.54302
##  [145] 17.04359 16.34281 16.11862 17.21133 16.41156 17.41825 15.90379 15.50646
##  [153] 16.83054 16.79934 16.89998 16.17282 17.22941 16.31834 16.74497 16.98010
##  [161] 16.39968 16.88736 16.41644 16.58776 17.34845 15.87257 15.29175 16.19112
##  [169] 17.48300 16.26054 17.53876 16.10222 16.92970 16.84991 17.32693 16.82909
##  [177] 16.63365 16.36874 16.14510 17.39986 16.68299 17.13099 16.84867 16.34372
##  [185] 16.83347 16.64242 16.34778 16.85272 16.35931 16.74208 17.70283 16.91731
##  [193] 16.51928 16.88665 16.44124 17.02976 16.89352 15.97288 17.90488 16.52084
##  [201] 16.20563 16.62966 16.92934 17.70356 17.04017 17.51211 16.77976 17.04703
##  [209] 16.56909 17.16111 16.98166 18.02138 16.68652 16.37466 16.87533 16.35450
##  [217] 17.38306 17.24799 16.68342 16.29580 17.32407 16.25117 16.92852 17.14111
##  [225] 16.23510 16.13384 17.24339 16.79909 17.00126 16.36587 17.39706 17.72984
##  [233] 16.40824 17.16246 16.67169 16.97313 16.79809 15.49010 17.08347 16.68527
##  [241] 16.35198 16.49652 16.44849 15.86329 17.39113 17.20776 17.56743 17.15767
##  [249] 17.34150 16.32621 16.75576 16.57942 15.98631 17.05275 16.72646 16.41259
##  [257] 16.47029 16.20732 16.03896 17.42660 16.49803 16.67066 17.52036 15.99388
##  [265] 16.62628 17.21986 17.18590 16.08943 17.00366 17.50029 16.92305 16.26708
##  [273] 16.87858 16.03303 16.94293 16.74194 17.51619 16.57753 16.73977 16.72987
##  [281] 16.39841 17.18172 17.66157 17.40641 16.84056 16.30871 17.03589 16.89962
##  [289] 15.65132 17.47385 16.81961 16.47234 17.52289 16.55289 16.25365 17.42898
##  [297] 17.04442 16.56411 16.80686 16.71901 16.22802 17.07226 17.25504 16.24341
##  [305] 17.29081 16.68537 17.12916 17.22083 17.39499 16.69031 16.82688 16.42497
##  [313] 16.79227 17.32457 17.38791 16.77000 16.45581 16.54349 16.93597 17.28958
##  [321] 17.15059 16.02064 17.07649 17.24729 16.22791 15.80680 15.51048 17.80623
##  [329] 16.76840 16.90715 17.04199 16.56112 17.57265 16.79328 16.91461 17.38446
##  [337] 17.39254 16.44015 17.45458 17.14599 16.79772 16.04805 17.40295 17.51181
##  [345] 16.94131 16.65040 17.06704 16.72452 16.76563 16.97706 17.61556 17.57567
##  [353] 16.23489 17.23339 18.29824 16.72339 16.63724 17.34477 15.95971 16.54211
##  [361] 16.57988 16.59220 16.47693 16.44076 16.65422 15.70414 16.10984 17.07187
##  [369] 16.80706 16.50561 17.18617 16.57505 16.19982 16.17355 16.44421 17.42058
##  [377] 17.05442 16.36647 16.59346 16.65624 17.71085 16.86168 16.43488 17.15428
##  [385] 16.44247 16.87380 17.28984 17.39023 16.41721 17.10443 16.66542 16.51212
##  [393] 16.21685 16.60299 17.55791 17.13347 16.80995 17.30991 16.13328 17.21066
##  [401] 17.01051 17.69857 16.94820 17.21398 16.72890 17.17627 15.22767 17.19112
##  [409] 16.14372 16.87111 17.03160 17.83390 16.03816 16.69603 17.27914 17.03061
##  [417] 17.21915 16.21239 17.40601 16.26802 16.91524 17.49414 16.89108 16.46129
##  [425] 16.98557 16.83112 16.85436 15.98952 16.77962 16.82063 15.95013 17.49366
##  [433] 17.03643 16.54811 16.82167 17.00403 16.51240 16.57292 16.39142 17.76946
##  [441] 16.99843 16.56160 17.17401 16.36329 16.74315 17.26123 16.73007 17.11125
##  [449] 16.23886 16.97882 16.87985 16.62911 17.69756 16.29058 16.77863 16.19370
##  [457] 17.08275 16.95904 17.02440 17.07470 17.86842 17.98415 16.93050 16.48963
##  [465] 16.16955 17.47203 17.30934 17.44890 16.25278 16.67137 16.87242 15.05229
##  [473] 16.65468 17.45136 16.94370 16.64546 17.72217 16.60261 16.27026 16.98469
##  [481] 16.30494 17.52937 16.82253 16.53219 16.84974 16.35134 16.44022 16.55947
##  [489] 15.69055 15.96859 16.24595 17.41190 17.38172 16.83057 16.51814 16.87211
##  [497] 15.95324 16.62211 16.48372 16.94081 16.62059 17.29312 17.38138 17.58894
##  [505] 16.15007 15.75786 16.77247 16.48919 16.48577 16.89330 15.80484 16.35386
##  [513] 16.48174 17.15816 17.16746 16.35984 17.04358 16.44663 16.28848 16.81851
##  [521] 15.86583 16.98186 16.25927 16.22421 17.37142 17.10981 16.69714 16.13643
##  [529] 16.38813 17.99143 16.35375 17.07985 17.25396 17.26543 16.64836 16.81653
##  [537] 16.23056 16.40519 15.89373 17.31237 16.88649 16.41227 16.45472 16.40462
##  [545] 16.59258 15.84734 16.47528 17.00405 17.78683 16.73716 16.93043 17.17582
##  [553] 16.70527 16.16375 17.32274 17.26580 16.22375 16.76325 16.92298 16.91512
##  [561] 15.56599 17.37279 16.53090 16.71978 16.77857 16.50684 17.31566 16.07870
##  [569] 16.75035 16.38249 17.21587 17.22037 15.97990 17.26654 17.66741 16.45733
##  [577] 16.88949 16.33767 16.57092 17.02745 17.14469 16.71961 16.48600 16.58829
##  [585] 16.91051 17.19182 16.54321 17.00703 16.45031 17.39350 16.95381 17.12100
##  [593] 16.65551 15.63277 16.41044 16.91422 16.56859 16.79886 16.60576 15.62128
##  [601] 16.84767 16.54522 15.91729 16.51684 17.16835 16.31146 17.18451 17.32273
##  [609] 16.70219 17.22737 16.24267 16.38981 16.35911 16.56112 16.92163 15.86380
##  [617] 17.06751 16.19125 16.38535 17.11663 16.82292 17.52031 17.04376 16.00606
##  [625] 16.97196 16.92621 16.62872 16.83892 16.67618 16.09415 17.57126 17.08427
##  [633] 16.76455 16.41358 16.42785 16.15697 16.72265 16.28260 16.59532 16.96302
##  [641] 17.25748 16.56539 18.22773 16.31525 17.05694 16.97277 17.27619 16.59479
##  [649] 17.23124 17.31027 15.93917 17.08656 17.15791 17.36403 17.06718 16.49816
##  [657] 16.53951 16.21952 17.46236 16.65168 16.15544 17.12469 17.42262 16.02971
##  [665] 16.97677 17.25450 17.04617 17.24144 17.14522 16.61433 17.10228 16.76218
##  [673] 16.53843 16.47405 16.61549 16.38016 16.15869 17.05084 16.91882 16.10057
##  [681] 16.66031 17.28959 16.46641 17.07065 16.62769 17.06658 16.56266 16.41304
##  [689] 17.08788 16.41366 16.97903 15.99359 16.01224 16.65206 17.66052 16.13380
##  [697] 16.93033 17.06070 16.93555 16.57956 16.29979 16.67922 15.91313 16.06113
##  [705] 16.84581 17.29598 16.86485 16.46986 16.85729 16.03261 17.09721 16.07239
##  [713] 17.08958 16.65186 16.66662 15.85242 16.72152 16.62022 16.77899 16.92257
##  [721] 16.06465 16.75866 16.62102 16.43800 16.95587 16.45659 15.65606 16.11203
##  [729] 16.31687 16.04183 17.10211 17.12880 17.21831 16.93981 16.71934 16.98728
##  [737] 16.53434 17.05073 15.85629 16.45354 16.98680 16.75190 16.48740 17.47616
##  [745] 17.43022 17.20281 16.80649 15.73073 17.10606 16.97097 16.81129 17.83472
##  [753] 15.87295 16.41078 16.54458 17.46800 16.25106 16.54925 15.95605 16.34670
##  [761] 16.64590 16.59660 16.60010 17.80392 16.20377 16.82048 17.15537 16.97880
##  [769] 16.35405 17.30390 16.48469 16.81175 17.64186 17.04479 16.15636 17.00496
##  [777] 16.44165 16.27543 17.02909 17.36870 16.52413 17.65579 16.86104 16.65968
##  [785] 16.54598 16.94020 16.88723 17.08575 17.10277 17.09417 17.04056 17.16251
##  [793] 16.94514 16.20736 17.01742 17.20478 16.78733 17.49479 16.14966 15.78603
##  [801] 16.32881 16.04227 16.71677 16.84690 17.15130 16.37378 17.31753 17.03919
##  [809] 17.19571 16.39664 16.56740 17.05338 16.10816 17.01319 16.30927 16.11106
##  [817] 16.92197 16.98476 16.43461 17.57636 16.75212 16.92726 16.55920 17.43406
##  [825] 16.49022 15.91023 16.18773 16.95270 16.81804 16.64584 17.69388 16.43355
##  [833] 16.59227 16.31196 16.23722 17.35840 15.72771 16.87111 17.62715 16.47928
##  [841] 16.04170 16.82498 16.20665 16.30235 16.80320 16.82743 17.38700 16.76637
##  [849] 16.85318 16.13147 16.90041 17.62181 17.29488 16.49006 16.80080 17.16920
##  [857] 17.00429 18.28410 17.33787 15.97068 16.55749 17.61199 15.71208 16.88730
##  [865] 16.39312 16.78792 16.69177 16.75772 16.92669 16.27034 16.47205 17.04062
##  [873] 16.08294 16.17509 16.55549 15.94336 16.50386 16.60985 17.18239 16.93504
##  [881] 16.46880 16.77238 16.85659 16.10133 16.42306 16.88304 16.73729 17.67129
##  [889] 17.31502 17.12053 17.08089 16.94270 16.30119 16.72189 17.29738 17.04630
##  [897] 17.50370 17.48268 16.21260 16.26477 17.21324 16.31614 16.30613 16.79926
##  [905] 16.29986 16.57519 16.11449 17.15316 17.04616 16.63256 16.40994 16.40852
##  [913] 16.43286 16.29109 16.69818 17.28116 16.91039 17.29917 16.52164 16.33047
##  [921] 17.34080 16.76860 17.04468 16.25078 16.80777 16.73393 18.10670 17.60459
##  [929] 16.40734 17.47814 17.20076 16.80127 17.43414 16.32663 17.40252 17.06633
##  [937] 16.89286 17.16439 17.08706 16.31340 16.18836 16.08327 16.61889 16.32467
##  [945] 15.69973 17.71016 16.75805 17.06882 16.23924 16.90670 17.07088 16.62663
##  [953] 16.38057 17.25635 16.68257 16.96551 17.11508 16.39960 17.11811 17.54878
##  [961] 15.55910 17.57702 17.09481 17.38666 17.50850 17.01411 17.12127 16.40903
##  [969] 17.37305 16.28045 17.20544 16.48296 16.90122 16.06669 17.04376 16.42973
##  [977] 16.83231 16.46925 16.05954 16.56033 16.30462 17.08817 17.15602 16.36573
##  [985] 16.86706 16.22933 17.70380 17.37077 16.41941 17.83869 16.85072 16.13855
##  [993] 16.55412 16.72485 15.67776 16.33078 16.32285 17.06626 16.46504 16.48885
## 
## $boot_sds
##    [1] 4.874567 5.757825 5.798850 5.579564 4.837042 5.510946 5.299448 5.661303
##    [9] 5.066487 6.309862 4.490566 5.179907 5.521354 5.710071 4.886281 4.831200
##   [17] 5.903522 5.982525 6.242225 5.009345 4.536642 5.664716 6.049515 5.896180
##   [25] 4.825721 4.643020 5.922572 5.882185 5.787816 6.094377 5.072456 5.819899
##   [33] 4.821493 4.954602 4.399490 4.872088 6.323662 5.627914 4.704601 5.252226
##   [41] 6.088492 5.278759 4.764711 4.692564 5.617238 5.280933 4.862509 4.151461
##   [49] 6.281021 4.809423 6.029984 5.629173 6.581683 5.888235 5.056050 5.818303
##   [57] 5.764461 5.267626 5.534876 5.339616 5.513888 5.384673 5.816247 5.433861
##   [65] 4.997564 5.094475 5.066723 5.365937 4.606440 5.435217 6.092363 6.391354
##   [73] 6.063768 5.889917 5.826564 4.993000 4.998288 5.819401 5.978363 4.260472
##   [81] 5.495624 5.080239 5.770891 5.584043 5.110279 5.814895 5.033142 5.232987
##   [89] 6.292681 4.896365 6.247258 5.842841 4.944989 5.522372 4.839530 4.627021
##   [97] 5.628671 5.169646 4.415902 5.789836 5.094985 5.551361 5.515150 5.800960
##  [105] 5.107903 5.211927 5.526450 5.194303 5.086164 4.427109 5.220777 5.519826
##  [113] 6.984259 6.287459 4.511131 5.435463 6.198389 5.663391 5.542592 4.837507
##  [121] 4.572497 5.321994 5.497830 6.886156 5.863157 5.573420 5.680133 5.562968
##  [129] 6.329074 4.959501 4.779121 5.256072 5.256931 3.997301 5.653780 6.346206
##  [137] 4.495483 5.133261 5.687339 5.192791 4.835188 6.167942 6.039971 4.791529
##  [145] 5.963458 4.473765 5.468344 6.129869 6.011211 6.480877 4.189664 4.448638
##  [153] 4.933106 4.876879 5.895590 5.130751 5.515116 5.683391 5.663397 5.966722
##  [161] 5.454324 5.579044 5.205760 4.920753 5.543737 4.292067 3.865701 5.084997
##  [169] 5.801373 5.248456 5.236404 5.806805 5.391924 5.947378 6.425782 5.399236
##  [177] 5.242203 5.284926 5.801341 6.157593 5.898725 6.420065 5.431204 5.205909
##  [185] 5.971636 5.379171 5.246766 5.381145 4.739833 5.546062 6.968542 5.784778
##  [193] 5.206222 5.629549 5.368781 5.377875 5.581098 5.180280 6.621297 5.163763
##  [201] 5.860362 5.903562 4.849922 5.691922 5.027341 5.472443 5.606328 6.111772
##  [209] 5.902739 6.576784 5.839121 6.092340 5.514086 5.250860 5.884552 4.875404
##  [217] 5.491499 5.761231 5.506463 5.534828 7.026293 4.794215 5.316137 5.766731
##  [225] 5.489454 4.566711 6.089784 5.469145 6.066453 4.358110 6.383306 6.396468
##  [233] 5.072137 5.595634 4.984086 4.844598 5.592377 4.264796 5.811202 4.761005
##  [241] 5.585006 4.976279 4.711174 4.713530 6.439092 6.148795 6.732650 5.162336
##  [249] 5.885276 5.337432 5.440326 5.030718 4.529654 6.416849 5.099141 4.619212
##  [257] 5.897976 5.251253 5.167407 5.908584 5.024638 5.417052 5.127333 4.896236
##  [265] 5.372170 5.707399 6.349103 4.940506 6.187279 5.742451 5.686291 5.173519
##  [273] 5.472531 4.909772 5.057094 5.344071 6.201064 5.140191 4.857812 5.448280
##  [281] 4.835003 5.425509 6.572678 6.827760 5.294649 5.274360 5.921958 6.249563
##  [289] 4.645454 6.203397 5.066421 5.566833 6.241360 6.009171 4.961146 5.849082
##  [297] 5.785381 4.724654 5.798987 6.015758 5.263111 5.756759 5.359673 4.686271
##  [305] 5.463763 5.490597 5.576047 5.714999 5.181645 5.532101 5.943637 4.726255
##  [313] 5.285392 6.719080 5.947825 5.404830 4.988587 5.546418 5.607591 5.719317
##  [321] 6.414063 5.678328 5.472118 5.250666 5.399082 5.193374 4.458546 5.793345
##  [329] 5.701644 4.619932 5.843841 4.727099 5.758692 4.880823 5.302765 5.716671
##  [337] 5.950475 4.571906 5.532681 4.922895 4.885262 5.263746 6.127202 6.147126
##  [345] 4.608814 5.394590 5.532225 5.106726 5.243187 6.025851 6.079016 5.241054
##  [353] 5.420350 6.516130 7.945566 6.556123 4.362839 5.293383 5.120601 4.732115
##  [361] 5.086212 5.631777 4.643302 4.410964 5.078038 5.295302 5.143124 5.139441
##  [369] 6.080852 4.874714 6.067300 4.065789 5.483062 4.919991 5.234386 6.939604
##  [377] 5.553989 5.065618 5.519067 5.276604 5.738654 5.752637 5.240027 6.202187
##  [385] 5.481007 5.269649 6.069157 5.671802 5.261816 5.947621 4.764603 4.777210
##  [393] 5.260427 5.527682 6.190689 5.237907 4.916895 5.641633 5.418912 5.728421
##  [401] 5.170443 6.616052 5.533259 4.761889 5.796896 5.871390 4.756562 5.664581
##  [409] 5.260483 5.660177 5.879956 6.007966 5.555295 5.373302 6.224796 5.374951
##  [417] 5.920587 4.878901 5.460109 4.882724 5.777124 5.948925 5.205052 4.591816
##  [425] 5.183100 5.190715 4.623030 5.346435 6.376312 5.221113 5.341994 5.167709
##  [433] 5.151976 4.839467 5.283574 5.520714 5.098918 6.005359 3.965708 5.756529
##  [441] 5.404472 4.787874 5.776304 5.878387 5.365079 5.846969 4.658432 5.244922
##  [449] 5.190223 6.264669 5.699683 5.149288 6.561952 5.001373 6.412450 5.171754
##  [457] 5.807964 5.846614 5.146042 5.424207 6.723431 6.141727 6.295082 4.643342
##  [465] 4.658383 5.976286 6.241591 6.409863 4.586566 5.194962 5.850967 4.824035
##  [473] 5.413032 6.788218 5.840986 5.212189 6.131060 4.575701 5.009801 5.435975
##  [481] 4.835846 5.737226 5.004942 5.361660 5.651933 5.588312 5.038269 5.226660
##  [489] 4.121846 4.070128 5.316803 4.929256 5.279664 4.889397 5.064819 5.933879
##  [497] 4.995964 4.680865 5.837408 6.671949 5.503480 5.760588 7.094739 5.179235
##  [505] 4.966262 4.757663 5.503130 5.462815 5.071512 5.801009 4.979750 5.121682
##  [513] 5.022853 5.252318 6.188775 4.891185 5.567481 5.716421 4.626707 5.128540
##  [521] 5.111964 5.454439 4.507011 4.767176 5.542209 5.786555 5.551845 5.226920
##  [529] 5.260378 6.902432 5.475864 5.751474 5.940250 5.280735 5.683472 5.077053
##  [537] 4.952054 5.486158 4.792536 6.418158 5.103073 5.944075 4.785341 5.043028
##  [545] 4.709338 4.638518 4.868111 5.685296 5.888556 5.355625 6.271266 5.247733
##  [553] 5.266305 5.107490 5.625029 7.234436 4.777347 5.819880 5.562890 5.435479
##  [561] 5.123548 6.206895 5.961251 4.891632 6.000269 5.671626 5.295827 5.214524
##  [569] 5.370869 4.540082 5.593552 5.740503 4.863701 6.902243 6.347857 5.061907
##  [577] 5.672374 4.650674 4.874149 5.903546 5.266227 5.618434 5.361148 5.499952
##  [585] 5.693439 6.410182 5.526016 5.508927 4.971833 5.726052 5.488161 6.219140
##  [593] 5.493889 4.665196 5.035545 5.602201 5.212063 5.018762 5.670414 4.162507
##  [601] 6.011278 4.900377 4.603472 5.686442 5.354058 5.410059 5.709937 5.796016
##  [609] 5.387224 5.936832 5.373904 4.529471 5.601805 5.305234 5.673229 5.158868
##  [617] 5.367547 5.001507 5.590907 5.430657 5.555753 5.988805 5.301858 4.815989
##  [625] 5.383035 6.085534 5.120310 5.304489 5.956395 3.579187 5.891133 5.307083
##  [633] 5.443032 5.672825 4.637375 4.780737 5.781056 4.487317 4.262838 5.427921
##  [641] 5.424658 5.163032 6.300263 5.717261 5.447621 5.952790 4.818815 4.397791
##  [649] 6.381714 5.684867 4.469703 5.634629 5.964364 5.748772 5.891967 5.009820
##  [657] 5.426365 5.247214 5.633066 5.651742 5.176228 5.431066 5.111630 4.565161
##  [665] 5.602629 5.727935 5.809191 5.396446 5.790623 5.624940 5.856217 4.486707
##  [673] 4.757674 5.012668 5.309347 5.397851 4.759618 5.784991 5.712880 5.132890
##  [681] 5.229721 6.702414 5.101908 5.568054 5.214948 6.330832 5.205478 4.830822
##  [689] 5.615862 5.475753 6.049668 5.100352 3.900679 4.356033 5.962824 4.871689
##  [697] 5.555197 5.378856 5.692429 5.052398 5.413809 4.445226 4.344019 5.213036
##  [705] 6.106717 6.682205 5.355962 4.652876 4.968251 4.747703 5.686069 5.434950
##  [713] 5.168829 5.186066 5.091901 4.180733 5.471924 5.008671 5.926059 5.908555
##  [721] 4.901807 5.185738 4.558872 4.660483 5.683378 5.131470 4.482017 4.568829
##  [729] 5.680741 4.708510 6.025986 5.984365 5.357327 5.536448 5.721703 4.726097
##  [737] 5.532801 6.098888 3.722646 5.310640 5.104164 4.976809 5.317802 5.338484
##  [745] 5.236343 6.455612 5.663635 5.161608 5.845089 4.974593 5.438681 6.876668
##  [753] 4.817792 3.315140 4.873072 5.814870 4.967930 4.850109 4.138574 4.922924
##  [761] 5.198885 5.748966 5.148764 6.446682 4.818451 5.290010 5.508697 6.571759
##  [769] 5.115438 5.575599 5.083516 4.877856 5.068673 4.996227 4.888985 4.914375
##  [777] 5.238515 4.163326 5.215268 6.187013 4.646969 6.440791 5.171270 5.094878
##  [785] 4.823842 5.034893 5.008424 6.031931 5.982235 4.977433 5.603284 5.595537
##  [793] 5.254345 4.612176 5.700316 6.400273 5.799820 5.906568 4.933768 4.958341
##  [801] 4.998022 4.954581 5.409566 5.209115 5.422821 5.316381 6.336266 5.635254
##  [809] 5.515408 5.422950 5.537584 5.432891 4.832241 5.211221 5.867126 4.451743
##  [817] 5.752508 5.952289 4.742938 6.544980 5.019109 6.167973 5.633369 5.764301
##  [825] 4.882185 4.878336 5.370110 5.861454 4.960116 5.722629 5.549231 4.699889
##  [833] 5.415016 5.067567 5.369332 6.971540 4.377176 5.243694 6.432138 4.441184
##  [841] 4.592590 4.893681 5.740245 5.043458 5.405631 4.613332 5.426757 5.598836
##  [849] 4.977504 4.980055 6.116715 5.717349 4.745710 4.811421 5.638872 5.424938
##  [857] 5.568677 5.762271 5.246704 4.835348 5.585006 6.036143 5.426533 5.145090
##  [865] 5.886113 5.615395 5.283256 5.548187 4.963703 4.087169 4.975652 6.697531
##  [873] 5.339109 4.985061 5.852529 4.490989 5.226025 5.861954 6.375595 5.213533
##  [881] 5.830324 5.629258 5.584000 5.017956 5.834020 5.124882 4.790239 6.636782
##  [889] 5.316947 6.161024 5.142324 5.450868 4.861863 4.889334 5.635858 5.670831
##  [897] 5.765890 5.705158 5.263384 4.562458 6.058547 4.752733 5.021986 4.850287
##  [905] 5.366643 5.803272 4.646130 6.437402 5.218980 5.396531 4.771340 4.882006
##  [913] 5.388870 4.879203 4.958500 6.788177 5.227743 5.616885 4.882695 4.733517
##  [921] 5.845980 5.403850 6.069242 5.329533 5.299518 4.602808 6.558455 6.765202
##  [929] 4.960033 5.309739 5.898303 4.942026 6.484997 5.059107 6.296770 5.761959
##  [937] 4.776026 5.866703 6.041855 5.261106 5.536236 4.473481 4.861571 5.250115
##  [945] 4.531515 6.771871 4.853488 5.037365 5.108538 6.159046 5.667668 5.300866
##  [953] 5.667772 5.104881 5.654132 6.295258 5.165107 5.455285 5.737052 5.264372
##  [961] 4.908671 6.030500 5.190545 5.870104 6.289020 6.350722 5.164475 4.857609
##  [969] 6.419195 4.912821 6.373941 4.451860 4.800616 5.310352 5.574221 4.946962
##  [977] 6.131580 5.416962 4.540015 4.581594 5.070912 5.658708 5.305138 5.176563
##  [985] 5.434906 4.621621 5.864920 5.186555 5.900767 6.086884 5.353773 4.954226
##  [993] 5.069338 4.828878 4.355551 5.148454 4.310202 4.946036 5.048387 5.176745</code></pre>
<p>The <em>estmeansd</em> library uses Box-Cox method for estimating mean and sd when the data available are the median, minimum and maximum values.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="statistics.html#cb123-1" tabindex="-1"></a><span class="fu">library</span>(estmeansd)</span>
<span id="cb123-2"><a href="statistics.html#cb123-2" tabindex="-1"></a></span>
<span id="cb123-3"><a href="statistics.html#cb123-3" tabindex="-1"></a>res_bc <span class="ot">&lt;-</span> <span class="fu">bc.mean.sd</span>(<span class="at">min.val =</span> <span class="dv">13</span>, <span class="at">med.val =</span> <span class="dv">16</span>, <span class="at">max.val =</span> <span class="dv">42</span>, <span class="at">n =</span> <span class="dv">230</span>)</span>
<span id="cb123-4"><a href="statistics.html#cb123-4" tabindex="-1"></a>res_bc </span></code></pre></div>
<pre><code>## $est.mean
## [1] 16.69497
## 
## $est.sd
## [1] 3.508168</code></pre>
<p>Again, the standard error from the mean can be estimated using <em>get_SE</em> function.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="statistics.html#cb125-1" tabindex="-1"></a><span class="fu">get_SE</span>(res_bc)</span></code></pre></div>
<pre><code>## $est.se
## [1] 0.3024458
## 
## $boot_means
##    [1] 17.36607 16.74149 16.41749 16.75205 16.75348 16.37918 16.77575 16.59997
##    [9] 17.10559 16.66127 16.79816 16.45489 16.88438 17.05422 17.07187 17.30018
##   [17] 16.88029 16.65236 16.21984 16.43727 16.64165 16.48997 16.52584 16.66691
##   [25] 16.64180 16.68669 16.75312 16.74339 16.91598 16.89176 16.81231 16.64271
##   [33] 16.76737 17.46485 16.70770 17.08332 16.96156 17.19373 16.82255 16.65268
##   [41] 16.49374 16.15405 16.59963 17.04170 16.90302 16.52480 16.79836 16.59813
##   [49] 17.50338 16.65237 16.40120 16.98575 16.29716 16.90254 17.14909 16.80582
##   [57] 16.36568 17.26195 16.63182 17.13461 16.84823 16.84466 16.34991 16.88521
##   [65] 16.52407 17.15732 17.05846 16.66128 16.86640 17.00639 17.34647 16.78309
##   [73] 16.72167 17.30673 17.19062 17.06750 16.61692 17.00016 17.04413 16.89705
##   [81] 17.06844 16.23978 16.93614 17.17376 16.63467 16.64716 16.82392 16.81333
##   [89] 16.60338 16.61266 16.55309 16.63412 17.64190 17.01466 16.64512 17.38707
##   [97] 16.36157 16.33143 16.81267 16.66639 16.60983 16.93266 16.61014 16.88798
##  [105] 16.68881 16.67473 16.70643 16.58332 16.95560 17.22986 16.41215 16.71773
##  [113] 16.80010 16.37261 16.63634 16.97703 16.72410 16.38229 17.08198 17.03817
##  [121] 16.99558 16.20164 16.63613 16.83371 16.70834 16.99216 16.40231 16.53236
##  [129] 16.86027 16.97845 16.59602 16.85344 16.71170 16.47347 16.78683 16.96574
##  [137] 16.59059 16.43464 16.74973 17.41242 16.46977 16.85526 16.51147 17.03533
##  [145] 16.89966 16.40706 17.13667 17.09296 16.79604 16.98555 16.78237 17.12696
##  [153] 17.31764 16.79490 16.95697 16.58749 16.92284 16.92197 16.78468 16.52205
##  [161] 16.59477 16.01431 16.54826 16.55542 16.80327 16.69345 16.21527 16.88307
##  [169] 17.11683 17.22887 16.55613 17.23226 16.40735 17.24563 16.63420 17.04051
##  [177] 16.71892 16.86676 16.70212 16.66587 16.61722 16.45562 16.69346 16.55564
##  [185] 16.66068 16.10769 16.79463 17.00242 17.00656 16.68638 16.71073 16.84451
##  [193] 16.47947 17.05716 17.23949 16.17294 16.65624 16.49400 16.28834 16.40865
##  [201] 16.28071 16.83512 16.55279 16.77555 16.67633 17.07645 16.30175 17.23207
##  [209] 16.73161 16.30761 16.76629 17.02264 16.24045 16.76047 17.26376 16.50211
##  [217] 16.72949 16.87409 16.41916 17.07704 16.37262 17.16258 16.97011 17.30955
##  [225] 16.46806 16.53978 16.84833 16.79415 17.30022 16.82767 16.59682 16.34403
##  [233] 16.71317 17.11467 17.09538 16.70136 16.69578 17.03659 16.88730 16.20128
##  [241] 16.70935 17.01553 16.95379 16.80905 16.26677 16.39111 16.39725 17.32640
##  [249] 16.71852 16.62978 16.28605 16.58338 16.91685 16.65868 16.55696 16.77947
##  [257] 16.65965 16.95895 16.59242 16.89810 16.62804 16.35850 16.10097 16.66932
##  [265] 16.71704 16.81717 16.72876 16.97030 16.55392 16.76215 16.97886 16.61411
##  [273] 16.78579 16.61812 16.93998 16.72546 16.69263 16.72578 17.00453 16.44603
##  [281] 16.73718 16.57815 16.34314 16.28318 16.25611 16.18927 17.00747 16.29259
##  [289] 16.55947 16.68824 16.16102 16.71529 16.68784 16.72167 16.30725 16.84108
##  [297] 16.80984 16.66335 16.83903 16.73371 16.71490 16.59109 16.46449 16.52623
##  [305] 16.59872 16.87694 16.67588 16.61258 16.91432 16.86191 16.53611 16.57640
##  [313] 16.86089 17.84259 16.19356 16.72176 17.28123 16.68206 17.31126 16.59279
##  [321] 16.41871 16.27068 16.40251 16.88169 16.50186 16.59610 16.93961 17.22119
##  [329] 16.21868 16.71414 16.37193 16.78917 16.26077 16.51254 16.54015 16.23659
##  [337] 16.85542 17.01417 16.60426 17.49256 16.85817 15.87799 16.50544 16.49200
##  [345] 16.17577 16.77579 17.04011 16.64282 16.99526 16.28235 16.83343 16.75518
##  [353] 17.61580 16.05996 16.68990 16.77094 16.08910 16.65044 17.00878 16.63802
##  [361] 16.58022 16.76859 16.45534 16.56787 17.21286 16.62327 16.90604 17.08023
##  [369] 16.75400 16.94542 16.92827 17.25565 17.09193 17.09992 17.09863 17.00194
##  [377] 16.40200 16.41983 16.61827 17.06384 16.66018 17.12787 16.75039 16.87816
##  [385] 16.59067 16.24118 16.95473 16.55289 16.60809 16.88940 16.75253 16.80080
##  [393] 16.81599 17.03450 16.77324 16.56444 16.59023 17.22136 16.57525 17.05346
##  [401] 17.01483 16.84759 16.88808 16.41303 17.29835 16.92600 17.02559 16.59125
##  [409] 16.32885 17.12718 16.50144 16.70249 16.60760 16.76094 16.91339 16.80023
##  [417] 16.81584 16.85119 17.03262 16.44218 16.69821 16.59300 16.83672 16.27104
##  [425] 16.91168 16.59411 16.22562 16.71425 17.01446 16.33442 16.17419 16.25635
##  [433] 16.41197 16.92814 16.07313 16.12464 16.60584 16.63332 16.83736 16.89302
##  [441] 16.81162 16.68316 16.86362 16.55647 17.07408 16.54325 17.19544 16.40973
##  [449] 16.88123 17.08277 16.50374 17.27928 16.63491 16.64445 16.97887 16.64417
##  [457] 16.69263 16.71387 17.01602 16.78453 16.73212 16.73593 16.63712 16.83951
##  [465] 16.51050 16.41318 17.17622 16.25079 16.98468 16.97880 16.92672 17.15352
##  [473] 16.47943 16.50768 16.69714 16.79859 16.11701 16.75491 16.65215 16.76789
##  [481] 16.70554 16.67514 16.69458 16.65544 16.70657 16.65282 16.48443 17.35728
##  [489] 16.57373 17.24326 17.14891 16.68258 17.17579 17.20306 16.59625 16.77253
##  [497] 16.07814 16.75418 16.79115 15.90267 17.07363 17.13858 16.39834 16.26458
##  [505] 16.47662 16.78506 17.39552 16.67940 16.66099 16.62566 16.87497 16.52903
##  [513] 16.80597 16.99801 16.65066 16.65910 16.89513 16.71627 16.83529 16.55216
##  [521] 16.59989 16.65849 17.02385 16.05112 16.39398 16.88492 16.67765 16.25639
##  [529] 16.76052 16.89348 16.85241 16.66833 16.22403 17.28846 16.07769 16.95761
##  [537] 16.60050 16.60640 16.55423 16.95301 16.80168 16.46490 16.89330 16.94388
##  [545] 16.52515 16.87314 16.75632 16.99520 16.45269 16.40483 16.63251 16.49646
##  [553] 17.01415 16.60268 16.20321 16.92549 16.57108 16.69264 16.73367 16.63631
##  [561] 16.87760 17.02777 16.47406 16.80705 16.71191 16.77174 16.42327 16.56899
##  [569] 16.82253 17.33606 16.57664 16.76487 16.51114 16.82070 16.40267 16.60904
##  [577] 16.74116 16.48355 16.57405 16.98684 16.70105 16.60904 16.62383 16.97423
##  [585] 16.23020 16.68348 16.62150 16.67496 16.35641 16.39460 16.80331 16.87390
##  [593] 16.92531 16.91200 16.71949 16.39160 16.97110 17.20308 16.83710 16.57259
##  [601] 16.83163 16.63540 16.60085 17.71302 16.70798 16.39533 16.53946 16.65497
##  [609] 16.80837 16.38163 17.20108 16.96141 16.38836 17.10643 16.31885 16.38517
##  [617] 16.35033 16.75158 17.42521 17.08041 16.87646 16.43208 17.14905 16.34062
##  [625] 16.73599 17.06982 16.83382 16.96344 17.06448 17.10248 16.64179 16.56899
##  [633] 16.77098 16.64807 16.82623 16.39178 16.86667 16.78259 16.99598 16.80414
##  [641] 16.84859 17.24667 16.38051 16.92461 16.92051 17.03055 17.83377 16.64802
##  [649] 16.77590 16.99701 17.28891 16.21180 16.38275 16.78668 16.51901 16.66771
##  [657] 16.74065 16.68705 16.66778 16.42967 16.70844 16.65395 17.15536 17.11924
##  [665] 16.04981 17.02122 16.54325 16.96514 17.01524 17.47231 16.61990 17.42054
##  [673] 16.43147 16.90652 16.84097 16.53064 16.28990 16.70392 16.63326 16.85592
##  [681] 17.07752 17.23452 16.80218 16.84454 16.89241 17.01343 16.52011 16.86875
##  [689] 16.18416 16.39614 17.25420 17.07773 16.66778 16.71658 16.96418 16.56639
##  [697] 16.83508 16.80952 16.42297 16.62805 16.65026 16.87081 17.61714 17.00172
##  [705] 16.52286 16.58778 16.45661 17.37695 16.80399 16.39718 16.42079 16.55643
##  [713] 16.40764 16.56022 17.12973 16.42825 16.62397 17.02047 16.43572 16.77054
##  [721] 16.80264 16.43458 17.05546 16.35745 17.19951 16.88610 17.03402 17.14859
##  [729] 16.81058 17.06377 17.06594 17.02620 16.62986 17.38639 16.63297 17.38767
##  [737] 17.48528 16.83141 16.08947 16.71413 16.59091 16.79910 16.32474 16.50160
##  [745] 16.56072 16.47072 17.17311 16.61576 16.62859 17.06919 16.57516 16.69736
##  [753] 16.52515 16.22763 16.61281 16.88553 16.49968 16.73486 16.17686 16.60769
##  [761] 16.68033 16.71056 16.31115 16.69110 16.78118 16.67138 16.69876 16.34645
##  [769] 17.05728 16.39028 16.75684 16.37446 16.61944 17.24401 17.05488 16.88258
##  [777] 16.45085 16.82439 17.01220 16.52795 17.47845 16.80583 16.50282 16.74356
##  [785] 16.38963 16.45711 16.98880 16.37536 16.62648 17.14105 16.54117 16.41150
##  [793] 16.13320 17.30475 16.59104 16.32556 16.25796 17.25612 16.42516 17.16570
##  [801] 17.13264 16.75008 17.03855 16.91343 16.59156 17.37614 17.44891 16.81343
##  [809] 15.99570 16.87299 17.09111 16.43018 16.82263 16.66184 16.55839 16.97417
##  [817] 16.62530 16.72296 17.29899 16.58172 16.38729 16.51976 16.77925 16.81301
##  [825] 16.52946 16.23383 16.96071 16.73090 16.96582 16.64609 16.99048 17.06495
##  [833] 16.73506 16.92431 16.82313 16.68345 16.53333 17.31305 16.25674 16.54747
##  [841] 16.71225 17.00516 16.26246 16.56877 16.54589 16.57282 16.42195 15.95083
##  [849] 16.64332 16.47126 16.74813 16.75765 16.73766 16.85146 16.51516 17.06498
##  [857] 16.66164 16.91832 16.39920 16.66433 16.81114 16.76290 17.08800 17.00541
##  [865] 16.88682 16.83234 16.64009 16.38066 16.56680 16.60115 16.55773 16.56748
##  [873] 16.41978 17.09799 16.60889 16.20535 16.96272 17.23620 17.26855 16.80841
##  [881] 16.55986 17.03594 16.41207 16.42693 16.55611 16.92224 17.03839 16.15071
##  [889] 16.30577 16.45797 16.90452 16.82653 16.96902 17.02365 16.53589 16.86978
##  [897] 17.13948 16.58097 16.48820 16.63546 17.12599 16.34539 16.47557 17.26121
##  [905] 17.01301 16.57977 16.87141 17.13336 16.33788 16.80113 17.08565 16.52584
##  [913] 16.55744 16.74898 16.08659 16.60457 17.06956 17.26090 16.65410 16.52493
##  [921] 17.03760 17.31896 16.75444 16.72565 17.36681 16.46049 16.49972 16.71872
##  [929] 16.43184 16.21160 16.51045 17.08008 16.78666 16.71053 16.49637 16.58165
##  [937] 17.15449 16.46055 16.35556 16.75700 16.92887 16.15625 16.33778 16.45739
##  [945] 16.48740 16.95567 16.74862 16.95577 16.76966 16.84096 16.90300 17.28110
##  [953] 17.05809 16.80973 17.00068 16.34872 16.59209 17.04524 16.35475 16.86838
##  [961] 16.60832 16.53124 16.39313 16.70740 16.49096 17.01372 16.89396 17.17760
##  [969] 16.97321 16.76018 16.54103 16.10683 16.71876 16.42297 16.13400 16.48293
##  [977] 16.32871 16.95502 16.51840 16.91439 16.37330 16.89111 16.55954 16.59112
##  [985] 16.24343 16.69545 16.17599 17.34101 16.87438 16.77811 16.98047 16.34944
##  [993] 16.34609 16.92248 16.91035 16.49149 16.86530 16.63098 17.11160 16.71236
## 
## $boot_sds
##    [1] 3.964575 3.826417 3.069833 3.527496 3.935949 3.038042 3.009586 3.459169
##    [9] 3.905040 3.858553 3.824111 3.573439 3.597026 3.897675 4.039339 3.980896
##   [17] 3.773259 3.317552 3.299832 3.420414 3.666531 3.704380 3.318356 3.638655
##   [25] 3.348041 3.974383 3.791131 3.534340 3.636163 3.085159 3.545801 3.258296
##   [33] 3.551928 4.069434 3.851294 3.534854 3.453003 3.620079 3.245007 3.471350
##   [41] 3.072136 3.611344 3.641047 3.996070 3.153218 3.076456 3.308234 3.600275
##   [49] 4.595433 3.479378 3.277869 3.996848 3.165449 3.253488 4.260961 3.735433
##   [57] 3.448481 3.558688 3.332423 3.735475 3.766021 3.218984 3.644237 3.936918
##   [65] 3.022704 3.426259 3.779020 3.422524 3.762437 4.023112 3.332035 3.857229
##   [73] 3.519049 4.050777 3.673196 3.783636 4.138379 4.473704 2.918614 4.127534
##   [81] 3.543498 3.162184 4.254752 3.095234 3.906481 3.823041 3.639274 4.045194
##   [89] 2.966333 3.976307 3.152816 3.195107 4.725679 3.892126 2.899154 3.538697
##   [97] 3.347023 3.024112 3.253087 3.534549 3.490049 3.394088 3.112289 3.973098
##  [105] 3.077510 3.128363 3.436676 3.651667 3.375031 4.103268 3.546323 3.773640
##  [113] 4.112709 3.524887 3.247119 3.790043 3.133115 3.517168 3.536028 3.353580
##  [121] 3.450671 3.095549 3.248226 3.761039 3.229415 3.732227 3.380312 3.118768
##  [129] 3.735060 3.854980 3.193225 4.578086 3.323035 3.452242 4.211788 3.342866
##  [137] 3.545377 3.331393 2.968800 3.583722 2.885201 3.071777 3.775374 4.065215
##  [145] 3.404138 3.312804 3.185645 3.482591 3.549950 3.157060 3.679448 3.771368
##  [153] 3.433983 4.214125 3.260438 3.326617 3.043668 2.889794 3.676822 3.178135
##  [161] 3.754827 3.622149 4.779344 3.433719 3.517542 3.444307 3.452309 3.523891
##  [169] 3.570756 3.238913 3.258961 3.176940 4.035357 3.937313 3.548986 2.730851
##  [177] 3.348235 2.860024 3.199143 3.591047 4.079093 3.212677 3.762847 3.156641
##  [185] 2.743385 2.809739 3.274921 3.405832 3.705300 3.072009 3.520416 3.319889
##  [193] 3.175180 3.341913 3.916281 2.917440 3.330344 3.377347 3.855452 3.069780
##  [201] 3.171783 3.749749 3.482123 3.417071 3.290929 3.232936 4.066132 3.268885
##  [209] 3.329290 2.942937 3.052649 3.408325 3.790903 3.558008 3.117080 3.663184
##  [217] 2.660728 3.680367 3.166554 3.720728 3.139043 3.291162 3.197283 3.217717
##  [225] 4.101354 3.396988 3.412841 3.395137 3.943672 3.677259 3.762632 3.880164
##  [233] 3.191403 4.183089 4.318079 3.216173 3.831657 3.430960 3.456240 3.311962
##  [241] 3.382110 4.350560 4.647922 3.876811 3.218063 3.396399 3.346798 3.542077
##  [249] 3.340225 3.099966 3.539542 3.901789 3.697919 3.574091 3.884491 3.087476
##  [257] 3.213892 4.817689 3.705627 3.345009 3.866922 3.477636 3.037931 3.711622
##  [265] 3.984396 3.212282 3.556516 3.657564 3.490876 3.385835 3.368994 3.485640
##  [273] 3.638030 3.573608 3.216711 3.849462 3.796144 3.503518 3.866444 3.005610
##  [281] 3.229872 3.001456 3.827667 3.107915 3.672102 3.236885 3.526654 3.507107
##  [289] 3.891519 3.312101 2.880277 3.994591 3.659160 3.323354 3.022297 3.594686
##  [297] 3.926580 3.199613 3.881998 3.631927 4.251354 3.617389 3.137944 3.101658
##  [305] 4.372173 3.875819 4.021414 3.505225 4.542376 3.783777 3.153395 3.547393
##  [313] 3.101882 4.350337 3.154084 3.722902 4.178912 3.590373 4.017827 3.375540
##  [321] 3.663712 3.128086 3.671756 3.457307 3.160706 3.542908 3.697623 3.422158
##  [329] 3.019872 3.380846 3.166800 3.345752 2.958339 3.066553 3.164405 3.063389
##  [337] 3.512818 3.921587 3.049743 4.515055 3.691266 2.773802 3.559562 3.581181
##  [345] 3.175735 3.875324 4.216108 3.718131 3.332551 3.381152 3.201160 3.503898
##  [353] 4.344451 3.380462 3.716407 3.894983 4.053011 3.580841 3.159021 3.998027
##  [361] 3.291775 3.491019 3.496069 3.425957 4.427176 3.447291 3.400110 4.656254
##  [369] 3.740108 4.095409 4.245822 4.248288 3.043618 3.245610 3.489374 3.758460
##  [377] 3.994726 3.451763 3.451764 3.275167 3.768322 3.490215 3.410971 3.516769
##  [385] 3.272475 3.163585 3.687926 3.906227 3.964743 3.635024 3.119409 3.420167
##  [393] 3.268393 3.935523 2.930094 3.296097 3.206907 3.761208 2.591798 3.950539
##  [401] 3.689995 3.142142 3.410444 3.323090 4.224638 3.893966 3.426535 3.392612
##  [409] 3.596040 3.720394 3.232502 3.632984 3.521353 4.034652 3.950186 3.751873
##  [417] 3.114762 3.380075 4.564714 2.835575 3.223686 3.244070 3.123380 3.100333
##  [425] 3.583256 3.165480 3.137335 2.946416 3.622042 3.180118 2.993693 3.559328
##  [433] 3.540398 3.377574 3.540841 3.208279 3.000080 3.409782 3.501199 3.496263
##  [441] 3.217303 3.947996 3.721131 3.099573 3.782698 3.199553 3.318000 3.377203
##  [449] 3.775072 3.819982 3.382465 4.560405 3.681649 3.429824 3.536390 3.164676
##  [457] 3.113603 3.370896 3.249054 3.949757 2.855889 3.664079 3.435292 3.236391
##  [465] 3.040892 3.273879 3.759680 3.267838 3.500017 4.862152 3.990348 3.460721
##  [473] 3.634304 2.605850 3.167863 3.732638 3.217893 3.606610 3.420397 3.449666
##  [481] 2.729454 3.418504 4.065734 3.014804 3.357962 3.340304 3.434119 4.433051
##  [489] 3.294156 3.689871 3.974755 3.250500 4.294098 3.565685 3.679240 3.534731
##  [497] 2.639268 3.727261 3.957659 3.052947 3.402059 3.246991 3.605359 2.704012
##  [505] 3.206336 4.133522 4.031505 3.208900 3.010972 3.902282 3.435167 4.115925
##  [513] 3.543889 3.377128 3.260633 3.582537 3.482442 3.245400 3.411835 3.276139
##  [521] 3.213689 2.777008 3.858297 3.071704 3.291432 3.397908 3.308306 3.297347
##  [529] 2.955577 3.716195 4.114868 3.462116 3.474608 3.981126 3.939341 3.325218
##  [537] 3.187548 3.748708 3.461724 3.384567 3.836600 3.464921 3.514566 3.945625
##  [545] 3.185878 3.314149 3.652924 2.954899 3.461819 3.180028 4.024467 3.670847
##  [553] 3.515021 3.224113 3.628995 3.773571 2.796324 3.131542 3.155287 3.032456
##  [561] 3.293708 4.410185 3.590078 3.538845 3.263855 3.352054 3.188778 3.360273
##  [569] 3.964911 3.802448 3.569684 3.680027 2.951923 3.998952 4.133811 3.225352
##  [577] 3.329310 2.897311 3.281750 3.189003 3.345750 3.425908 3.487956 4.125469
##  [585] 3.404047 3.382893 3.044749 3.731468 3.821494 3.959086 3.827074 3.276636
##  [593] 3.699112 3.595661 4.488179 3.456238 3.584640 3.221317 4.157373 3.500340
##  [601] 3.344589 3.886810 3.784285 4.622982 3.935045 3.018647 3.785575 3.572299
##  [609] 3.760079 3.286194 3.652966 3.408228 3.832993 3.829341 2.916655 3.680137
##  [617] 3.412853 3.792654 4.187222 3.294857 3.264057 3.342760 4.036145 3.694244
##  [625] 3.082393 3.675446 3.984700 3.653909 4.307175 3.584279 3.489606 2.844285
##  [633] 3.402555 3.590168 3.887520 2.986806 3.474311 3.028823 3.693289 3.441169
##  [641] 2.933523 3.552349 3.207541 3.709791 3.877049 3.570722 4.515004 3.521888
##  [649] 3.749533 2.964317 3.139163 2.992309 3.180068 3.590126 3.534994 3.997852
##  [657] 3.129112 3.166290 3.592409 3.256560 3.636337 3.312708 3.984098 4.514727
##  [665] 3.314418 3.484914 3.327771 3.255013 3.623438 3.591408 2.902589 4.872466
##  [673] 3.318049 3.492160 3.442652 3.040125 3.543925 3.454444 3.676091 3.490585
##  [681] 4.261895 3.670423 3.822301 3.919213 3.328691 2.893706 3.397452 3.386076
##  [689] 3.306322 3.738970 4.408155 3.850804 3.585441 3.323552 3.920616 3.462918
##  [697] 3.141393 3.436493 3.334157 3.394626 3.865455 3.528784 3.339084 3.838106
##  [705] 3.540689 2.694693 3.153768 3.751622 3.526702 3.035168 3.414591 3.423545
##  [713] 3.529503 3.006258 3.632768 3.365144 3.005821 3.208847 3.466184 3.447588
##  [721] 3.738325 3.818767 3.906253 3.766812 3.348889 3.592774 2.899159 3.741995
##  [729] 3.473884 3.695562 3.496856 4.072642 2.837648 4.215998 3.473543 3.716659
##  [737] 4.198487 3.156106 3.903751 3.111410 3.437727 3.304388 3.219721 3.328385
##  [745] 3.178776 3.131689 3.442199 4.607975 3.356963 3.659918 3.430925 3.184747
##  [753] 3.504853 3.129581 3.484921 3.590497 3.298231 3.912324 2.842006 3.220742
##  [761] 3.720398 3.848162 3.447412 3.542235 3.171748 4.049537 3.119237 3.556556
##  [769] 4.298489 3.573262 3.815777 3.061813 3.473742 4.347007 3.935045 4.162285
##  [777] 2.827774 3.588510 3.452706 3.382543 3.700229 3.606553 3.502778 3.254071
##  [785] 3.704783 3.698028 3.510247 2.980910 3.280170 3.050845 2.987299 2.940192
##  [793] 3.129437 3.222925 3.155028 2.889729 3.867892 4.256128 3.114405 4.044824
##  [801] 3.269921 3.360985 3.804588 3.005333 3.573252 3.759134 3.653955 3.396997
##  [809] 3.055257 3.663932 3.867342 3.065344 3.483053 3.722149 3.426441 3.445352
##  [817] 3.157580 2.885400 3.540963 3.633285 3.184892 2.962384 3.542143 3.202184
##  [825] 3.268556 3.127047 4.181477 3.345858 3.792294 3.703971 3.566479 3.053540
##  [833] 4.094500 3.281667 3.155931 3.798095 3.478729 4.280786 2.999738 3.236626
##  [841] 3.646726 3.647102 3.622524 3.078721 3.837969 3.099406 4.077749 3.002146
##  [849] 3.923957 3.240301 3.829959 3.392816 3.699411 3.353133 3.123500 4.264831
##  [857] 3.079712 3.130495 3.110019 3.899497 3.870154 3.284713 4.798837 3.956051
##  [865] 3.296976 3.227297 3.260665 3.636192 2.856440 3.716266 3.891356 3.259863
##  [873] 3.384371 4.342082 2.954489 2.827289 3.039976 3.826816 3.114925 3.145807
##  [881] 3.586877 3.700463 3.559633 3.332273 3.209383 3.298817 3.518856 3.011563
##  [889] 3.315867 3.464810 3.529471 3.838296 3.404069 3.648906 3.363524 3.575065
##  [897] 3.573378 4.141783 3.118612 3.506935 3.472818 2.995547 3.436645 4.804810
##  [905] 4.584283 3.399303 4.300087 3.319141 3.225249 3.451082 3.474294 3.217329
##  [913] 3.511150 3.622070 3.313726 4.043587 3.070540 3.200642 3.701912 3.221337
##  [921] 4.024323 4.199880 3.468723 3.508775 4.524628 3.516579 4.194718 3.289362
##  [929] 3.503701 3.660042 3.426543 3.687152 4.357135 3.575070 3.463576 3.293138
##  [937] 3.290023 3.109273 3.459672 3.626928 3.259837 3.875850 3.575518 3.020942
##  [945] 3.326555 3.805159 2.965211 3.237102 3.419278 3.360548 3.510671 4.492767
##  [953] 3.214197 3.025671 3.556451 3.406567 2.967228 4.224238 3.201373 3.780894
##  [961] 3.355981 3.679482 3.258541 3.967044 3.449517 3.509877 3.450699 2.972296
##  [969] 3.450563 2.977288 3.272521 3.346747 3.408031 3.419901 3.017055 3.813536
##  [977] 3.213526 4.120211 3.709899 2.663562 3.378906 4.083974 3.676538 3.732629
##  [985] 3.174336 3.372011 3.317277 3.578203 3.777193 3.882168 4.235385 3.449901
##  [993] 2.645372 3.684526 4.113377 3.596493 3.817612 3.811159 4.139988 3.467992</code></pre>
</div>
<div id="inconsistency-i2" class="section level3 hasAnchor" number="4.9.4">
<h3><span class="header-section-number">4.9.4</span> Inconsistency I2<a href="statistics.html#inconsistency-i2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The inconsistency <span class="math inline">\(I^2\)</span> index is the sum of the squared deviations from the overall effect and weighted by the study size. Value &lt;25% is classified as low
and greater than 75% as high heterogeneity. This test can be performed using metafor package <span class="citation">(<a href="#ref-JSSv036i03">Viechtbauer 2010</a>)</span>. The presence of high <span class="math inline">\(I^2\)</span> suggests a need to proceed to meta-regression on the data to understand the source of heterogeneity. The fixed component were the covariates which were being tested for their effect on heterogeneity. The random effect components were the sensitivity and FPR. The <span class="math inline">\(I^2\)</span> value for the TIA clinic study is 34.41%. As such meta-regression is not needed for that study. By contrast, the <span class="math inline">\(I^2\)</span> is much higher for the spot sign study, necessitating metaregression.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="statistics.html#cb127-1" tabindex="-1"></a><span class="fu">library</span>(PRISMAstatement)</span>
<span id="cb127-2"><a href="statistics.html#cb127-2" tabindex="-1"></a></span>
<span id="cb127-3"><a href="statistics.html#cb127-3" tabindex="-1"></a><span class="co">#example from Spot sign paper. Stroke 2019</span></span>
<span id="cb127-4"><a href="statistics.html#cb127-4" tabindex="-1"></a><span class="fu">prisma</span>(<span class="at">found =</span> <span class="dv">193</span>,</span>
<span id="cb127-5"><a href="statistics.html#cb127-5" tabindex="-1"></a>       <span class="at">found_other =</span> <span class="dv">27</span>,</span>
<span id="cb127-6"><a href="statistics.html#cb127-6" tabindex="-1"></a>       <span class="at">no_dupes =</span> <span class="dv">141</span>, </span>
<span id="cb127-7"><a href="statistics.html#cb127-7" tabindex="-1"></a>       <span class="at">screened =</span> <span class="dv">141</span>, </span>
<span id="cb127-8"><a href="statistics.html#cb127-8" tabindex="-1"></a>       <span class="at">screen_exclusions =</span> <span class="dv">3</span>, </span>
<span id="cb127-9"><a href="statistics.html#cb127-9" tabindex="-1"></a>       <span class="at">full_text =</span> <span class="dv">138</span>,</span>
<span id="cb127-10"><a href="statistics.html#cb127-10" tabindex="-1"></a>       <span class="at">full_text_exclusions =</span> <span class="dv">112</span>, </span>
<span id="cb127-11"><a href="statistics.html#cb127-11" tabindex="-1"></a>       <span class="at">qualitative =</span> <span class="dv">26</span>, </span>
<span id="cb127-12"><a href="statistics.html#cb127-12" tabindex="-1"></a>       <span class="at">quantitative =</span> <span class="dv">26</span>,</span>
<span id="cb127-13"><a href="statistics.html#cb127-13" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">800</span>, <span class="at">height =</span> <span class="dv">800</span>)</span></code></pre></div>
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-04f0d374d79c1df208e0" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-04f0d374d79c1df208e0">{"x":{"diagram":"digraph prisma {\n    node [shape=\"box\", fontsize = 10];\n    graph [splines=ortho, nodesep=1, dpi = 72]\n    a -> nodups;\n    b -> nodups;\n    a [label=\"Records identified through\ndatabase searching\n(n = 193)\"];\n    b [label=\"Additional records identified\nthrough other sources\n(n = 27)\"]\n    nodups -> incex;\n    nodups [label=\"Records after duplicates removed\n(n = 141)\"];\n    incex -> {ex; ft}\n    incex [label=\"Records screened\n(n = 141)\"];\n    ex [label=\"Records excluded\n(n = 3)\"];\n    {rank=same; incex ex}\n    ft -> {qual; ftex};\n    ft [label=\"Full-text articles assessed\nfor eligibility\n(n = 138)\"];\n    {rank=same; ft ftex}\n    ftex [label=\"Full-text articles excluded,\nwith reasons\n(n = 112)\"];\n    qual -> quant\n    qual [label=\"Studies included in qualitative synthesis\n(n = 26)\"];\n    quant [label=\"Studies included in\nquantitative synthesis\n(meta-analysis)\n(n = 26)\"];\n  }","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="metaanalysis-of-proportion" class="section level3 hasAnchor" number="4.9.5">
<h3><span class="header-section-number">4.9.5</span> Metaanalysis of proportion<a href="statistics.html#metaanalysis-of-proportion" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is an example of metaanalysis of stroke recurrence following management in rapid TIA clinic. A variety of different methods for calculating the 95% confidence interval of the binomial distribution. The mean of the binomial distribution is given by p and the variance by <span class="math inline">\(\frac{p \times (1-p)}{n}\)</span>. The term <span class="math inline">\(z\)</span> is given by <span class="math inline">\(1-\frac{\alpha}{2}\)</span> quantile of normal distribution. A standard way of calculating the confidence interval is the Wald method <span class="math inline">\(p\pm z\times \sqrt{\frac{p \times(1-p)}{n}}\)</span>. The Freeman-Tukey double arcsine transformation tries to transform the data to a normal distribution. This approach is useful when occurence of event is rare. The exact or Clopper-Pearson method is suggested as the most conservative of the methods for calculating confidence interval for proportion. It is based on cumulative properties of the binomial distribution. The Wilson method has similarities to the Wald method. It has an extra term <span class="math inline">\(z^2/n\)</span>. There are many different methods for calculating the confidence interval for proportions. Investigators such as Agresti proposed that approximate methods are better than exact method <span class="citation">(<a href="#ref-doi:10.1080/00031305.1998.10480550">Agresti and Coull 1998</a>)</span>. Brown and colleagues proposed the use of the Wilson method <span class="citation">(<a href="#ref-brown2001">Brown, Cai, and DasGupta 2001</a>)</span></p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="statistics.html#cb128-1" tabindex="-1"></a><span class="fu">library</span>(metafor) <span class="co">#open software metafor</span></span>
<span id="cb128-2"><a href="statistics.html#cb128-2" tabindex="-1"></a><span class="co">#create data frame dat</span></span>
<span id="cb128-3"><a href="statistics.html#cb128-3" tabindex="-1"></a><span class="co">#xi is numerator</span></span>
<span id="cb128-4"><a href="statistics.html#cb128-4" tabindex="-1"></a><span class="co">#ni is denominator</span></span>
<span id="cb128-5"><a href="statistics.html#cb128-5" tabindex="-1"></a></span>
<span id="cb128-6"><a href="statistics.html#cb128-6" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model=</span><span class="fu">c</span>(<span class="st">&quot;melbourne&quot;</span>,<span class="st">&quot;paris&quot;</span>,<span class="st">&quot;oxford&quot;</span>,<span class="st">&quot;stanford&quot;</span>,<span class="st">&quot;ottawa&quot;</span>,<span class="st">&quot;new zealand&quot;</span>),</span>
<span id="cb128-7"><a href="statistics.html#cb128-7" tabindex="-1"></a><span class="at">xi=</span><span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">7</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">31</span>,<span class="dv">2</span>), </span>
<span id="cb128-8"><a href="statistics.html#cb128-8" tabindex="-1"></a><span class="at">ni=</span><span class="fu">c</span>(<span class="dv">468</span>,<span class="dv">296</span>, <span class="dv">281</span>,<span class="dv">223</span>,<span class="dv">982</span>,<span class="dv">172</span>))</span>
<span id="cb128-9"><a href="statistics.html#cb128-9" tabindex="-1"></a></span>
<span id="cb128-10"><a href="statistics.html#cb128-10" tabindex="-1"></a><span class="co">#calculate new variable pi base on ratio xi/ni</span></span>
<span id="cb128-11"><a href="statistics.html#cb128-11" tabindex="-1"></a>dat<span class="sc">$</span>pi <span class="ot">&lt;-</span> <span class="fu">with</span>(dat, xi<span class="sc">/</span>ni)</span>
<span id="cb128-12"><a href="statistics.html#cb128-12" tabindex="-1"></a></span>
<span id="cb128-13"><a href="statistics.html#cb128-13" tabindex="-1"></a><span class="co">#Freeman-Tukey double arcsine trasformation</span></span>
<span id="cb128-14"><a href="statistics.html#cb128-14" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">escalc</span>(<span class="at">measure=</span><span class="st">&quot;PFT&quot;</span>, <span class="at">xi=</span>xi, <span class="at">ni=</span>ni, <span class="at">data=</span>dat, <span class="at">add=</span><span class="dv">0</span>) </span>
<span id="cb128-15"><a href="statistics.html#cb128-15" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">rma</span>(yi, vi, <span class="at">method=</span><span class="st">&quot;REML&quot;</span>, <span class="at">data=</span>dat, <span class="at">slab=</span><span class="fu">paste</span>(model))</span>
<span id="cb128-16"><a href="statistics.html#cb128-16" tabindex="-1"></a></span>
<span id="cb128-17"><a href="statistics.html#cb128-17" tabindex="-1"></a><span class="co">#create forest plot with labels</span></span>
<span id="cb128-18"><a href="statistics.html#cb128-18" tabindex="-1"></a>metafor<span class="sc">::</span><span class="fu">forest</span>(res, <span class="at">transf=</span>transf.ipft.hm, <span class="at">targs=</span><span class="fu">list</span>(<span class="at">ni=</span>dat<span class="sc">$</span>ni), <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="fl">1.4</span>),<span class="at">refline=</span>res<span class="sc">$</span>beta[<span class="dv">1</span>],</span>
<span id="cb128-19"><a href="statistics.html#cb128-19" tabindex="-1"></a>       <span class="at">cex=</span>.<span class="dv">8</span>, <span class="at">ilab=</span><span class="fu">cbind</span>(dat<span class="sc">$</span>xi, dat<span class="sc">$</span>ni), </span>
<span id="cb128-20"><a href="statistics.html#cb128-20" tabindex="-1"></a>       <span class="co">#position of data on x-axis</span></span>
<span id="cb128-21"><a href="statistics.html#cb128-21" tabindex="-1"></a>       <span class="at">ilab.xpos=</span><span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">6</span>,<span class="sc">-</span>.<span class="dv">4</span>),<span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb128-22"><a href="statistics.html#cb128-22" tabindex="-1"></a></span>
<span id="cb128-23"><a href="statistics.html#cb128-23" tabindex="-1"></a><span class="co">#par function combine multiple plots into one</span></span>
<span id="cb128-24"><a href="statistics.html#cb128-24" tabindex="-1"></a>op <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">cex=</span>.<span class="dv">75</span>, <span class="at">font=</span><span class="dv">2</span>)</span>
<span id="cb128-25"><a href="statistics.html#cb128-25" tabindex="-1"></a><span class="co">#position of column names on x-axis</span></span>
<span id="cb128-26"><a href="statistics.html#cb128-26" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span><span class="fl">1.0</span>, <span class="fl">7.5</span>, <span class="st">&quot;model &quot;</span>,<span class="at">pos=</span><span class="dv">4</span>)</span>
<span id="cb128-27"><a href="statistics.html#cb128-27" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">55</span>,<span class="sc">-</span>.<span class="dv">2</span>), <span class="fl">7.5</span>, <span class="fu">c</span>(<span class="st">&quot;recurrence&quot;</span>, <span class="st">&quot; total subjects&quot;</span>))</span>
<span id="cb128-28"><a href="statistics.html#cb128-28" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">1.4</span>,<span class="fl">7.5</span>, <span class="st">&quot;Proportion [95% CI]&quot;</span>, <span class="at">pos=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-16-1.png" width="672" /></p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="statistics.html#cb129-1" tabindex="-1"></a><span class="fu">par</span>(op)</span></code></pre></div>
<p>Exact 95% confidence interval for proportion is provided below using the TIA
data above. This solution was provided on <em>stack overflow</em>. This is performed using the <em>binomial.test</em> function.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="statistics.html#cb130-1" tabindex="-1"></a><span class="co">#exact confidence interval</span></span>
<span id="cb130-2"><a href="statistics.html#cb130-2" tabindex="-1"></a><span class="fu">sapply</span>(<span class="fu">split</span>(dat, dat<span class="sc">$</span>model), <span class="cf">function</span>(x) <span class="fu">binom.test</span>(x<span class="sc">$</span>xi, x<span class="sc">$</span>ni)<span class="sc">$</span>conf.int)</span></code></pre></div>
<pre><code>##       melbourne new zealand     ottawa      oxford      paris    stanford
## [1,] 0.00603419 0.001411309 0.02154780 0.007875285 0.00955965 0.001087992
## [2,] 0.03057375 0.041370853 0.04451101 0.045893259 0.04811612 0.032020390</code></pre>
<p>The data needs to be transposed using <em>t</em> function. This generates one column
for lower and another for upper CI. Note that sapply returns a matrix or array
and the column names have to be assigned.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="statistics.html#cb132-1" tabindex="-1"></a><span class="co">#the data</span></span>
<span id="cb132-2"><a href="statistics.html#cb132-2" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">sapply</span>(<span class="fu">split</span>(dat, dat<span class="sc">$</span>model), <span class="cf">function</span>(x) <span class="fu">binom.test</span>(x<span class="sc">$</span>xi, x<span class="sc">$</span>ni)<span class="sc">$</span>conf.int))</span>
<span id="cb132-3"><a href="statistics.html#cb132-3" tabindex="-1"></a>tmp</span></code></pre></div>
<pre><code>##                    [,1]       [,2]
## melbourne   0.006034190 0.03057375
## new zealand 0.001411309 0.04137085
## ottawa      0.021547797 0.04451101
## oxford      0.007875285 0.04589326
## paris       0.009559650 0.04811612
## stanford    0.001087992 0.03202039</code></pre>
<p>The exact confidence is now put back into the dat data frame.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="statistics.html#cb134-1" tabindex="-1"></a>dat<span class="sc">$</span>ci.lb <span class="ot">&lt;-</span> tmp[,<span class="dv">1</span>] <span class="co">#adding column to data frame dat</span></span>
<span id="cb134-2"><a href="statistics.html#cb134-2" tabindex="-1"></a>dat<span class="sc">$</span>ci.ub <span class="ot">&lt;-</span> tmp[,<span class="dv">2</span>] <span class="co">#adding column to data frame dat</span></span>
<span id="cb134-3"><a href="statistics.html#cb134-3" tabindex="-1"></a></span>
<span id="cb134-4"><a href="statistics.html#cb134-4" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">escalc</span>(<span class="at">measure=</span><span class="st">&quot;PFT&quot;</span>, <span class="at">xi=</span>xi, <span class="at">ni=</span>ni, <span class="at">data=</span>dat, <span class="at">add=</span><span class="dv">0</span>) </span>
<span id="cb134-5"><a href="statistics.html#cb134-5" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">rma.glmm</span>(<span class="at">measure=</span><span class="st">&quot;PLO&quot;</span>, <span class="at">xi=</span>xi, <span class="at">ni=</span>ni, <span class="at">data=</span>dat)</span>
<span id="cb134-6"><a href="statistics.html#cb134-6" tabindex="-1"></a></span>
<span id="cb134-7"><a href="statistics.html#cb134-7" tabindex="-1"></a></span>
<span id="cb134-8"><a href="statistics.html#cb134-8" tabindex="-1"></a><span class="co">#insert the exact confidence interval </span></span>
<span id="cb134-9"><a href="statistics.html#cb134-9" tabindex="-1"></a><span class="fu">with</span>(dat, metafor<span class="sc">::</span><span class="fu">forest</span>(yi, <span class="at">ci.lb=</span>ci.lb, <span class="at">ci.ub=</span>ci.ub, </span>
<span id="cb134-10"><a href="statistics.html#cb134-10" tabindex="-1"></a>  <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span>,<span class="fl">8.5</span>), </span>
<span id="cb134-11"><a href="statistics.html#cb134-11" tabindex="-1"></a>  <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.1</span>,<span class="dv">1</span>), </span>
<span id="cb134-12"><a href="statistics.html#cb134-12" tabindex="-1"></a>  <span class="at">refline=</span><span class="fu">predict</span>(res, <span class="at">transf=</span>transf.ilogit)<span class="sc">$</span>pred,</span>
<span id="cb134-13"><a href="statistics.html#cb134-13" tabindex="-1"></a>  <span class="at">cex=</span>.<span class="dv">8</span>, </span>
<span id="cb134-14"><a href="statistics.html#cb134-14" tabindex="-1"></a>  <span class="at">ilab=</span><span class="fu">cbind</span>(dat<span class="sc">$</span>xi, dat<span class="sc">$</span>ni), </span>
<span id="cb134-15"><a href="statistics.html#cb134-15" tabindex="-1"></a>  <span class="at">ilab.xpos=</span><span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">6</span>,<span class="sc">-</span>.<span class="dv">2</span>),<span class="at">digits=</span><span class="dv">3</span>))</span>
<span id="cb134-16"><a href="statistics.html#cb134-16" tabindex="-1"></a>  </span>
<span id="cb134-17"><a href="statistics.html#cb134-17" tabindex="-1"></a>op <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">cex=</span>.<span class="dv">75</span>, <span class="at">font=</span><span class="dv">2</span>)</span>
<span id="cb134-18"><a href="statistics.html#cb134-18" tabindex="-1"></a><span class="fu">addpoly</span>(res, <span class="at">row=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">transf=</span>transf.ilogit)</span>
<span id="cb134-19"><a href="statistics.html#cb134-19" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span>
<span id="cb134-20"><a href="statistics.html#cb134-20" tabindex="-1"></a><span class="co">#position of column names on x-axis</span></span>
<span id="cb134-21"><a href="statistics.html#cb134-21" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span>.<span class="dv">9</span>, <span class="fl">7.5</span>, <span class="st">&quot;Model&quot;</span>, <span class="at">pos=</span><span class="dv">2</span>)</span>
<span id="cb134-22"><a href="statistics.html#cb134-22" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">55</span>,<span class="sc">-</span>.<span class="dv">2</span>), <span class="fl">7.5</span>, <span class="fu">c</span>(<span class="st">&quot;recurrence&quot;</span>, <span class="st">&quot; total subjects&quot;</span>))</span>
<span id="cb134-23"><a href="statistics.html#cb134-23" tabindex="-1"></a><span class="fu">text</span>( <span class="dv">1</span>,   <span class="fl">7.5</span>, <span class="st">&quot;Proportion [95% CI]&quot;</span>, <span class="at">pos=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/Statistics-16-3-1.png" width="672" /></p>
</div>
<div id="metaanalysis-of-continuous-data" class="section level3 hasAnchor" number="4.9.6">
<h3><span class="header-section-number">4.9.6</span> Metaanalysis of continuous data<a href="statistics.html#metaanalysis-of-continuous-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Metanalysis of continuous outcome data can be performed using standardised mean difference or ratio of means. It is available in the <em>meta</em> library using <em>metacont</em> function <span class="citation">(<a href="#ref-doi10.1136/ebmental-2019-300117">Balduzzi, Rücker, and Schwarzer 2019</a>)</span>.</p>
</div>
<div id="bivariate-metaanalysis" class="section level3 hasAnchor" number="4.9.7">
<h3><span class="header-section-number">4.9.7</span> Bivariate Metaanalysis<a href="statistics.html#bivariate-metaanalysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The univariate method of Moses-Shapiro-Littenberg combines these measures (sensitivity and specificity) into a single measure of accuracy (diagnostic odds ratio)<span class="citation">(<a href="#ref-pmid8210827">Moses, Shapiro, and Littenberg 1993</a>)</span> . This approach has been criticized for losing data on sensitivity and specificity of the test. Similar to the univariate method, the bivariate method employs a random effect to take into account the within study correlation <span class="citation">(<a href="#ref-pmid16168343">Reitsma et al. 2005</a>)</span>. Additionally, the bivariate method also accounts
for the between-study correlation in sensitivity and specificity. Bivariate analysis is performed using <em>mada</em> package. A <a href="bayesian-analysis.html#bayesian-metaanalysis">Bayesian library</a> for bivariate analysis <em>meta4diag</em> is illustrated later.</p>
<p>The example below is taken from a metaanalysis of spot sign as predictor
expansion of intracerebral hemorrhage <span class="citation">(<a href="#ref-pmid31272327">Phan et al. 2019</a>)</span>. The data for this
analysis is available in the Data-Use sub-folder.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="statistics.html#cb135-1" tabindex="-1"></a><span class="fu">library</span>(mada)</span></code></pre></div>
<pre><code>## Loading required package: ellipse</code></pre>
<pre><code>## 
## Attaching package: &#39;ellipse&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:graphics&#39;:
## 
##     pairs</code></pre>
<pre><code>## Loading required package: mvmeta</code></pre>
<pre><code>## This is mvmeta 1.0.3. For an overview type: help(&#39;mvmeta-package&#39;).</code></pre>
<pre><code>## 
## Attaching package: &#39;mvmeta&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:metafor&#39;:
## 
##     blup</code></pre>
<pre><code>## The following object is masked from &#39;package:meta&#39;:
## 
##     blup</code></pre>
<pre><code>## The following object is masked from &#39;package:checkmate&#39;:
## 
##     qtest</code></pre>
<pre><code>## 
## Attaching package: &#39;mada&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:metafor&#39;:
## 
##     forest</code></pre>
<pre><code>## The following object is masked from &#39;package:meta&#39;:
## 
##     forest</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="statistics.html#cb148-1" tabindex="-1"></a><span class="co">#spot sign data</span></span>
<span id="cb148-2"><a href="statistics.html#cb148-2" tabindex="-1"></a>Data<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">&quot;./Data-Use/ss150718.csv&quot;</span>)</span>
<span id="cb148-3"><a href="statistics.html#cb148-3" tabindex="-1"></a></span>
<span id="cb148-4"><a href="statistics.html#cb148-4" tabindex="-1"></a><span class="co">#remove duplicates using subset</span></span>
<span id="cb148-5"><a href="statistics.html#cb148-5" tabindex="-1"></a><span class="co">#another way is to use filter from dplyr</span></span>
<span id="cb148-6"><a href="statistics.html#cb148-6" tabindex="-1"></a>Dat<span class="ot">&lt;-</span><span class="fu">subset</span>(Data, Data<span class="sc">$</span>retain<span class="sc">==</span><span class="st">&quot;yes&quot;</span>) </span>
<span id="cb148-7"><a href="statistics.html#cb148-7" tabindex="-1"></a>(ss<span class="ot">&lt;-</span><span class="fu">reitsma</span>(Dat))</span></code></pre></div>
<pre><code>## Call:  reitsma.default(data = Dat)
## 
## Fixed-effects coefficients:
##               tsens     tfpr
## (Intercept)  0.2548  -1.9989
## 
## 27 studies, 2 fixed and 3 random-effects parameters
##   logLik       AIC       BIC  
##  52.0325  -94.0650  -84.1201</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="statistics.html#cb150-1" tabindex="-1"></a><span class="fu">summary</span>(ss)</span></code></pre></div>
<pre><code>## Call:  reitsma.default(data = Dat)
## 
## Bivariate diagnostic random-effects meta-analysis
## Estimation method: REML
## 
## Fixed-effects coefficients
##                   Estimate Std. Error       z Pr(&gt;|z|) 95%ci.lb 95%ci.ub    
## tsens.(Intercept)    0.255      0.152   1.676    0.094   -0.043    0.553   .
## tfpr.(Intercept)    -1.999      0.097 -20.664    0.000   -2.189   -1.809 ***
## sensitivity          0.563          -       -        -    0.489    0.635    
## false pos. rate      0.119          -       -        -    0.101    0.141    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 
## 
## Variance components: between-studies Std. Dev and correlation matrix
##       Std. Dev  tsens  tfpr
## tsens    0.692  1.000     .
## tfpr     0.400 -0.003 1.000
## 
##  logLik     AIC     BIC 
##  52.033 -94.065 -84.120 
## 
## AUC:  0.858
## Partial AUC (restricted to observed FPRs and normalized):  0.547
## 
## I2 estimates 
## Zhou and Dendukuri approach:  10.2 % 
## Holling sample size unadjusted approaches:  64.2 - 79.9 % 
## Holling sample size adjusted approaches:  4.7 - 5 %</code></pre>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="statistics.html#cb152-1" tabindex="-1"></a><span class="fu">AUC</span>(<span class="fu">reitsma</span>(<span class="at">data =</span> Dat))</span></code></pre></div>
<pre><code>## $AUC
## [1] 0.8576619
## 
## $pAUC
## [1] 0.5474316
## 
## attr(,&quot;sroc.type&quot;)
## [1] &quot;ruttergatsonis&quot;</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="statistics.html#cb154-1" tabindex="-1"></a>sumss<span class="ot">&lt;-</span><span class="fu">SummaryPts</span>(ss,<span class="at">n.iter =</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>) <span class="co">#bivariate pooled LR</span></span>
<span id="cb154-2"><a href="statistics.html#cb154-2" tabindex="-1"></a><span class="fu">summary</span>(sumss)</span></code></pre></div>
<pre><code>##           Mean Median  2.5%  97.5%
## posLR    4.740  4.700 3.860  5.760
## negLR    0.497  0.496 0.412  0.582
## invnegLR 2.030  2.020 1.720  2.430
## DOR      9.670  9.390 6.930 13.600</code></pre>
</div>
<div id="metaanalysis-of-clinical-trial." class="section level3 hasAnchor" number="4.9.8">
<h3><span class="header-section-number">4.9.8</span> Metaanalysis of clinical trial.<a href="statistics.html#metaanalysis-of-clinical-trial." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Fixed effect (Peto or Mantel-Haenszel) approaches assume that the population is the same for all studies and thus each study is the source of error. Random
effect (DerSimonian Laird) assumes an additional source of error between studies.The random effect approach results in more conservate estimate of effect size confidence interval. A criticism of DerSimnonian and Laird approach is that it is prone to type I error especially when the number of number of studies is small (n&lt;20) or moderate heterogeneity. It’s estimated that 25% of the significant findings with DerSimonian Laird method may be non-significant with Hartung-Knapp method (BMC Medical Research Methodology 2014, 14:25). The Hartung-Knapp method (Stat Med 2001;20:3875-89) estimate the between studies variance and treat it as fixed. It employs quantile of t-distribution rather than normal distribution. The Hartung-Knapp method is available in meta and metafor package.</p>
<p>The data is from Jama Cardiology on Associations of Omega-3 Fatty Acid Supplement Use With Cardiovascular Disease Risks Meta-analysis of 10 Trials Involving 77917 Individuals <span class="citation">(<a href="#ref-pmid29387889">Aung T 2018</a>)</span>. Subsequently a meta-analysis <span class="citation">(<a href="#ref-pmid31567003">Hu 2019</a>)</span> reported that contrary to the earlier meta-analysis, Omega-3 lowers the risk of cardiovascular diseases with effect related to dose. The analysis using DerSimonian Laird and Hartung Knapp method is illustrated below.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="statistics.html#cb156-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
## ✔ forcats   1.0.0     ✔ readr     2.1.4
## ✔ lubridate 1.9.2     ✔ tidyr     1.3.0
## ✔ purrr     1.0.1     
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ purrr::%@%()           masks rlang::%@%()
## ✖ rlang:::=()            masks data.table:::=()
## ✖ dplyr::between()       masks data.table::between()
## ✖ readr::col_factor()    masks scales::col_factor()
## ✖ dplyr::collapse()      masks nlme::collapse()
## ✖ gridExtra::combine()   masks dplyr::combine()
## ✖ matrixStats::count()   masks dplyr::count()
## ✖ dplyr::data_frame()    masks tibble::data_frame(), vctrs::data_frame()
## ✖ dplyr::dim_desc()      masks pillar::dim_desc()
## ✖ purrr::discard()       masks scales::discard()
## ✖ tidyr::expand()        masks Matrix::expand()
## ✖ tidyr::extract()       masks magrittr::extract()
## ✖ dplyr::filter()        masks stats::filter()
## ✖ dplyr::first()         masks data.table::first()
## ✖ purrr::flatten()       masks jsonlite::flatten(), rlang::flatten()
## ✖ purrr::flatten_chr()   masks rlang::flatten_chr()
## ✖ purrr::flatten_dbl()   masks rlang::flatten_dbl()
## ✖ purrr::flatten_int()   masks rlang::flatten_int()
## ✖ purrr::flatten_lgl()   masks rlang::flatten_lgl()
## ✖ purrr::flatten_raw()   masks rlang::flatten_raw()
## ✖ lubridate::hour()      masks data.table::hour()
## ✖ purrr::invoke()        masks rlang::invoke()
## ✖ lubridate::isoweek()   masks data.table::isoweek()
## ✖ dplyr::lag()           masks stats::lag()
## ✖ dplyr::last()          masks data.table::last()
## ✖ rlang::ll()            masks Metrics::ll()
## ✖ rlang::local_options() masks withr::local_options()
## ✖ purrr::map()           masks listenv::map()
## ✖ lubridate::mday()      masks data.table::mday()
## ✖ lubridate::minute()    masks data.table::minute()
## ✖ lubridate::month()     masks data.table::month()
## ✖ tidyr::pack()          masks Matrix::pack()
## ✖ lubridate::quarter()   masks data.table::quarter()
## ✖ lubridate::second()    masks data.table::second()
## ✖ dplyr::select()        masks MASS::select()
## ✖ purrr::set_names()     masks rlang::set_names(), magrittr::set_names()
## ✖ readr::spec()          masks mada::spec()
## ✖ purrr::splice()        masks rlang::splice()
## ✖ dplyr::src()           masks Hmisc::src()
## ✖ cli::style_bold()      masks pillar::style_bold()
## ✖ dplyr::summarize()     masks Hmisc::summarize()
## ✖ purrr::transpose()     masks data.table::transpose()
## ✖ cli::tree()            masks xfun::tree()
## ✖ jsonlite::unbox()      masks rlang::unbox()
## ✖ tidyr::unpack()        masks Matrix::unpack()
## ✖ jsonlite::validate()   masks rms::validate()
## ✖ lubridate::wday()      masks data.table::wday()
## ✖ lubridate::week()      masks data.table::week()
## ✖ rlang::with_options()  masks withr::with_options()
## ✖ lubridate::yday()      masks data.table::yday()
## ✖ lubridate::year()      masks data.table::year()
## ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="statistics.html#cb158-1" tabindex="-1"></a><span class="fu">library</span>(metafor)</span>
<span id="cb158-2"><a href="statistics.html#cb158-2" tabindex="-1"></a></span>
<span id="cb158-3"><a href="statistics.html#cb158-3" tabindex="-1"></a><span class="co">#Omega 3 data</span></span>
<span id="cb158-4"><a href="statistics.html#cb158-4" tabindex="-1"></a>Year<span class="ot">=</span><span class="fu">c</span>(<span class="dv">2010</span>,<span class="dv">2014</span>,<span class="dv">2010</span>,<span class="dv">2007</span>,<span class="dv">2010</span>,<span class="dv">2010</span>,<span class="dv">2013</span>,<span class="dv">2008</span>,<span class="dv">2012</span>,<span class="dv">1999</span>)</span>
<span id="cb158-5"><a href="statistics.html#cb158-5" tabindex="-1"></a>Trials<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;DOIT&quot;</span>,<span class="st">&quot;AREDS-2&quot;</span>,<span class="st">&quot;SU.FOL.OM3&quot;</span>,<span class="st">&quot;JELIS&quot;</span>,<span class="st">&quot;Alpha Omega&quot;</span>,<span class="st">&quot;OMEGA&quot;</span>,<span class="st">&quot;R&amp;P&quot;</span>,<span class="st">&quot;GISSI-HF&quot;</span>,<span class="st">&quot;ORIGIN&quot;</span>,<span class="st">&quot;GISSI-P&quot;</span>)</span>
<span id="cb158-6"><a href="statistics.html#cb158-6" tabindex="-1"></a>Treatment<span class="ot">=</span><span class="fu">c</span>(<span class="dv">29</span>,<span class="dv">213</span>,<span class="dv">216</span>,<span class="dv">262</span>,<span class="dv">332</span>,<span class="dv">534</span>,<span class="dv">733</span>,<span class="dv">783</span>,<span class="dv">1276</span>,<span class="dv">1552</span>)</span>
<span id="cb158-7"><a href="statistics.html#cb158-7" tabindex="-1"></a>Treatment.per<span class="ot">=</span><span class="fu">c</span>(<span class="fl">10.3</span>,<span class="fl">9.9</span>,<span class="fl">17.2</span>,<span class="fl">2.8</span>,<span class="fl">13.8</span>,<span class="fl">27.7</span>,<span class="fl">11.7</span>,<span class="fl">22.4</span>,<span class="fl">20.3</span>,<span class="fl">27.4</span>)</span>
<span id="cb158-8"><a href="statistics.html#cb158-8" tabindex="-1"></a>Control<span class="ot">=</span><span class="fu">c</span>(<span class="dv">35</span>,<span class="dv">208</span>,<span class="dv">211</span>,<span class="dv">324</span>,<span class="dv">331</span>,<span class="dv">541</span>,<span class="dv">745</span>,<span class="dv">831</span>,<span class="dv">1295</span>,<span class="dv">1550</span>)</span>
<span id="cb158-9"><a href="statistics.html#cb158-9" tabindex="-1"></a>Control.per<span class="ot">=</span><span class="fu">c</span>(<span class="fl">12.5</span>,<span class="fl">10.1</span>,<span class="fl">16.9</span>,<span class="fl">3.5</span>,<span class="fl">13.6</span>,<span class="fl">28.6</span>, <span class="fl">11.9</span>,<span class="fl">23.9</span>,<span class="fl">20.7</span>,<span class="fl">27.3</span>)</span>
<span id="cb158-10"><a href="statistics.html#cb158-10" tabindex="-1"></a></span>
<span id="cb158-11"><a href="statistics.html#cb158-11" tabindex="-1"></a><span class="co">#combine into data frame</span></span>
<span id="cb158-12"><a href="statistics.html#cb158-12" tabindex="-1"></a>rct<span class="ot">&lt;-</span><span class="fu">data.frame</span>(Year,Trials,Treatment,Treatment.per,Control,Control.per) <span class="sc">%&gt;%</span></span>
<span id="cb158-13"><a href="statistics.html#cb158-13" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Treatment.number=</span><span class="fu">round</span>(Treatment<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span>Treatment.per,<span class="dv">0</span>),</span>
<span id="cb158-14"><a href="statistics.html#cb158-14" tabindex="-1"></a>         <span class="at">Control.number=</span><span class="fu">round</span>(Control<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span>Control.per,<span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb158-15"><a href="statistics.html#cb158-15" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">ai=</span>Treatment,<span class="at">n1i=</span>Treatment.number,<span class="at">ci=</span>Control,</span>
<span id="cb158-16"><a href="statistics.html#cb158-16" tabindex="-1"></a>         <span class="at">n2i=</span>Control.number,<span class="at">study=</span>Trials,<span class="at">year=</span>Year)</span>
<span id="cb158-17"><a href="statistics.html#cb158-17" tabindex="-1"></a></span>
<span id="cb158-18"><a href="statistics.html#cb158-18" tabindex="-1"></a></span>
<span id="cb158-19"><a href="statistics.html#cb158-19" tabindex="-1"></a><span class="co">#peto&#39;s fixed effect method</span></span>
<span id="cb158-20"><a href="statistics.html#cb158-20" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">rma.peto</span>(<span class="at">ai=</span>ai, <span class="at">n1i=</span>n1i, <span class="at">ci=</span>ci, <span class="at">n2i=</span>n2i, <span class="at">data=</span>rct)</span>
<span id="cb158-21"><a href="statistics.html#cb158-21" tabindex="-1"></a><span class="fu">print</span>(res, <span class="at">digits=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## 
## Equal-Effects Model (k = 10)
## 
## I^2 (total heterogeneity / total variability):  0.00%
## H^2 (total variability / sampling variability): 0.93
## 
## Test for Heterogeneity: 
## Q(df = 9) = 8.36, p-val = 0.50
## 
## Model Results (log scale):
## 
## estimate    se   zval  pval  ci.lb  ci.ub 
##    -0.04  0.02  -1.72  0.08  -0.08   0.00 
## 
## Model Results (OR scale):
## 
## estimate  ci.lb  ci.ub 
##     0.97   0.93   1.00</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="statistics.html#cb160-1" tabindex="-1"></a>result<span class="ot">&lt;-</span><span class="fu">predict</span>(res, <span class="at">transf=</span>exp, <span class="at">digits=</span><span class="dv">2</span>)</span>
<span id="cb160-2"><a href="statistics.html#cb160-2" tabindex="-1"></a><span class="co">#forest plot</span></span>
<span id="cb160-3"><a href="statistics.html#cb160-3" tabindex="-1"></a>metafor<span class="sc">::</span><span class="fu">forest</span>(res, <span class="at">targs=</span><span class="fu">list</span>(<span class="at">study=</span>rct<span class="sc">$</span>study), </span>
<span id="cb160-4"><a href="statistics.html#cb160-4" tabindex="-1"></a><span class="at">main=</span><span class="st">&quot;RCT of Omega3 fatty acid for cardiovascular disease-Peto&quot;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-17-1-1.png" width="672" /></p>
<p>The funnel plot is used here to illustrate presence or absence publication bias. In this case the funnel plot reflects the same findings as the low <span class="math inline">\(I^2\)</span> value. There is one outlier. We will explore this further with the <em>GOSH</em> plot below.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="statistics.html#cb161-1" tabindex="-1"></a><span class="co"># funnel plot </span></span>
<span id="cb161-2"><a href="statistics.html#cb161-2" tabindex="-1"></a><span class="fu">funnel</span>(res, <span class="at">refline=</span><span class="dv">0</span>, <span class="at">level=</span><span class="fu">c</span>(<span class="dv">90</span>, <span class="dv">95</span>, <span class="dv">99</span>), </span>
<span id="cb161-3"><a href="statistics.html#cb161-3" tabindex="-1"></a>       <span class="at">shade=</span><span class="fu">c</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;gray&quot;</span>, <span class="st">&quot;darkgray&quot;</span>))</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-17-2-1.png" width="672" /></p>
<p>Random effect (DerSimonian Laird) assumes an additional source of error between studies when calculating odds ratio.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="statistics.html#cb162-1" tabindex="-1"></a><span class="co">#DL</span></span>
<span id="cb162-2"><a href="statistics.html#cb162-2" tabindex="-1"></a>datO3 <span class="ot">&lt;-</span> <span class="fu">escalc</span>(<span class="at">measure =</span> <span class="st">&quot;OR&quot;</span>,<span class="at">ai=</span>ai, <span class="at">n1i=</span>n1i, <span class="at">ci=</span>ci, <span class="at">n2i=</span>n2i,<span class="at">data=</span>rct)</span>
<span id="cb162-3"><a href="statistics.html#cb162-3" tabindex="-1"></a>res.DL<span class="ot">&lt;-</span><span class="fu">rma</span>(yi,vi, <span class="at">method =</span> <span class="st">&quot;DL&quot;</span>,<span class="at">data=</span>datO3)</span>
<span id="cb162-4"><a href="statistics.html#cb162-4" tabindex="-1"></a>metafor<span class="sc">::</span><span class="fu">forest</span>(res.DL,<span class="at">main=</span><span class="st">&quot;RCT of Omega3 fatty acid for cardiovascular disease-DL&quot;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-17-3-1.png" width="672" /></p>
<p>DerSimonian Laird method may not be appropriate for metaanalysis with small
number of studies . The recommendation is to use the Hartung Knapp random effect method. This analysis show that inspite of the small sample size the significant findings remain.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="statistics.html#cb163-1" tabindex="-1"></a><span class="co">#Hartung-ignore error message</span></span>
<span id="cb163-2"><a href="statistics.html#cb163-2" tabindex="-1"></a>res.HK<span class="ot">&lt;-</span><span class="fu">rma.uni</span>(yi,<span class="at">vi=</span><span class="dv">1</span><span class="sc">/</span>vi,<span class="at">method=</span><span class="st">&quot;FE&quot;</span>,<span class="at">knha=</span><span class="cn">TRUE</span>,<span class="at">data=</span>datO3)</span>
<span id="cb163-3"><a href="statistics.html#cb163-3" tabindex="-1"></a>metafor<span class="sc">::</span><span class="fu">forest</span>(res.HK,<span class="at">main=</span><span class="st">&quot;RCT of Omega3 fatty acid for cardiovascular disease-HK&quot;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-17-4-1.png" width="672" /></p>
<p>Subgroup analysis is one way of exploring the data for group effect. Metaregression is illustrated later.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="statistics.html#cb164-1" tabindex="-1"></a><span class="co">#create subgroups for Omega 3 trial based on year of publication</span></span>
<span id="cb164-2"><a href="statistics.html#cb164-2" tabindex="-1"></a>rct1<span class="ot">&lt;-</span>rct[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,]</span>
<span id="cb164-3"><a href="statistics.html#cb164-3" tabindex="-1"></a>rct2<span class="ot">&lt;-</span>rct[<span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>,]</span>
<span id="cb164-4"><a href="statistics.html#cb164-4" tabindex="-1"></a>rct1<span class="sc">$</span>group[rct1<span class="sc">$</span>year<span class="sc">&gt;=</span><span class="dv">1999</span>]<span class="ot">&lt;-</span><span class="st">&quot;wide&quot;</span></span>
<span id="cb164-5"><a href="statistics.html#cb164-5" tabindex="-1"></a>rct2<span class="sc">$</span>group[rct2<span class="sc">$</span>year<span class="sc">&gt;=</span><span class="dv">1999</span>]<span class="ot">&lt;-</span><span class="st">&quot;narrow&quot;</span></span>
<span id="cb164-6"><a href="statistics.html#cb164-6" tabindex="-1"></a>rct3<span class="ot">&lt;-</span><span class="fu">rbind</span>(rct1,rct2)</span>
<span id="cb164-7"><a href="statistics.html#cb164-7" tabindex="-1"></a></span>
<span id="cb164-8"><a href="statistics.html#cb164-8" tabindex="-1"></a>datO3<span class="sc">$</span>group<span class="ot">&lt;-</span>rct3<span class="sc">$</span>group</span>
<span id="cb164-9"><a href="statistics.html#cb164-9" tabindex="-1"></a><span class="co">#plot subgroups</span></span>
<span id="cb164-10"><a href="statistics.html#cb164-10" tabindex="-1"></a>res.group <span class="ot">&lt;-</span> <span class="fu">rma</span>(yi, vi, <span class="at">mods =</span> <span class="sc">~</span> group, <span class="at">data=</span>datO3)</span>
<span id="cb164-11"><a href="statistics.html#cb164-11" tabindex="-1"></a>res.wide<span class="ot">&lt;-</span> <span class="fu">rma</span>(yi, vi, <span class="at">subset=</span>(group<span class="sc">==</span><span class="st">&quot;wide&quot;</span>), <span class="at">data=</span>datO3)</span>
<span id="cb164-12"><a href="statistics.html#cb164-12" tabindex="-1"></a>res.wide</span></code></pre></div>
<pre><code>## 
## Random-Effects Model (k = 5; tau^2 estimator: REML)
## 
## tau^2 (estimated amount of total heterogeneity): 0.0069 (SE = 0.0127)
## tau (square root of estimated tau^2 value):      0.0831
## I^2 (total heterogeneity / total variability):   38.46%
## H^2 (total variability / sampling variability):  1.62
## 
## Test for Heterogeneity:
## Q(df = 4) = 5.9601, p-val = 0.2022
## 
## Model Results:
## 
## estimate      se     zval    pval    ci.lb   ci.ub    
##  -0.0676  0.0611  -1.1077  0.2680  -0.1873  0.0520    
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="statistics.html#cb166-1" tabindex="-1"></a>res.narrow<span class="ot">&lt;-</span> <span class="fu">rma</span>(yi, vi, <span class="at">subset=</span>(group<span class="sc">==</span><span class="st">&quot;narrow&quot;</span>), <span class="at">data=</span>datO3)</span>
<span id="cb166-2"><a href="statistics.html#cb166-2" tabindex="-1"></a>res.narrow</span></code></pre></div>
<pre><code>## 
## Random-Effects Model (k = 5; tau^2 estimator: REML)
## 
## tau^2 (estimated amount of total heterogeneity): 0 (SE = 0.0018)
## tau (square root of estimated tau^2 value):      0
## I^2 (total heterogeneity / total variability):   0.00%
## H^2 (total variability / sampling variability):  1.00
## 
## Test for Heterogeneity:
## Q(df = 4) = 1.6888, p-val = 0.7928
## 
## Model Results:
## 
## estimate      se     zval    pval    ci.lb   ci.ub    
##  -0.0266  0.0229  -1.1609  0.2457  -0.0715  0.0183    
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="statistics.html#cb168-1" tabindex="-1"></a><span class="co">#https://stackoverflow.com/questions/39392706/using-the-r-forestplot-package-</span></span>
<span id="cb168-2"><a href="statistics.html#cb168-2" tabindex="-1"></a><span class="co">#is-there-a-way-to-assign-variable-colors-to-boxe</span></span>
<span id="cb168-3"><a href="statistics.html#cb168-3" tabindex="-1"></a></span>
<span id="cb168-4"><a href="statistics.html#cb168-4" tabindex="-1"></a><span class="co">#confidence interval</span></span>
<span id="cb168-5"><a href="statistics.html#cb168-5" tabindex="-1"></a>rmeta_conf <span class="ot">&lt;-</span> </span>
<span id="cb168-6"><a href="statistics.html#cb168-6" tabindex="-1"></a>  <span class="fu">structure</span>(<span class="fu">list</span>(</span>
<span id="cb168-7"><a href="statistics.html#cb168-7" tabindex="-1"></a>    <span class="at">mean  =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.0676</span>), <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.0266</span>),  <span class="cn">NA</span>, <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.0352</span>)), </span>
<span id="cb168-8"><a href="statistics.html#cb168-8" tabindex="-1"></a>    <span class="at">lower =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.1873</span>), <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.0715</span>),  <span class="cn">NA</span>, <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.0753</span>)),</span>
<span id="cb168-9"><a href="statistics.html#cb168-9" tabindex="-1"></a>    <span class="at">upper =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fu">exp</span>(<span class="fl">0.0520</span>), <span class="fu">exp</span>(<span class="fl">0.0183</span>),  <span class="cn">NA</span>, <span class="fu">exp</span>(<span class="fl">0.0049</span>))),</span>
<span id="cb168-10"><a href="statistics.html#cb168-10" tabindex="-1"></a>    <span class="at">.Names =</span> <span class="fu">c</span>(<span class="st">&quot;mean&quot;</span>, <span class="st">&quot;lower&quot;</span>, <span class="st">&quot;upper&quot;</span>), </span>
<span id="cb168-11"><a href="statistics.html#cb168-11" tabindex="-1"></a>    <span class="at">row.names =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="sc">-</span>6L), </span>
<span id="cb168-12"><a href="statistics.html#cb168-12" tabindex="-1"></a>    <span class="at">class =</span> <span class="st">&quot;data.frame&quot;</span>)</span>
<span id="cb168-13"><a href="statistics.html#cb168-13" tabindex="-1"></a></span>
<span id="cb168-14"><a href="statistics.html#cb168-14" tabindex="-1"></a><span class="co">#table data</span></span>
<span id="cb168-15"><a href="statistics.html#cb168-15" tabindex="-1"></a>tabletext<span class="ot">&lt;-</span><span class="fu">cbind</span>(<span class="fu">c</span>(<span class="st">&quot;&quot;</span>,<span class="st">&quot;Trials&quot;</span>,<span class="st">&quot;wide&quot;</span>,<span class="st">&quot;narrow&quot;</span>,<span class="cn">NA</span>,<span class="st">&quot;Summary&quot;</span>),</span>
<span id="cb168-16"><a href="statistics.html#cb168-16" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;Events&quot;</span>,<span class="st">&quot;(Drugs)&quot;</span>,<span class="fu">sum</span>(<span class="fu">filter</span>(datO3,group<span class="sc">==</span><span class="st">&quot;wide&quot;</span>)<span class="sc">$</span>ai),</span>
<span id="cb168-17"><a href="statistics.html#cb168-17" tabindex="-1"></a>      <span class="fu">sum</span>(<span class="fu">filter</span>(datO3,group<span class="sc">==</span><span class="st">&quot;narrow&quot;</span>)<span class="sc">$</span>ai),<span class="cn">NA</span>,<span class="cn">NA</span>),</span>
<span id="cb168-18"><a href="statistics.html#cb168-18" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;Events&quot;</span>,<span class="st">&quot;(Control)&quot;</span>,<span class="fu">sum</span>(<span class="fu">filter</span>(datO3,group<span class="sc">==</span><span class="st">&quot;wide&quot;</span>)<span class="sc">$</span>ci),</span>
<span id="cb168-19"><a href="statistics.html#cb168-19" tabindex="-1"></a>      <span class="fu">sum</span>(<span class="fu">filter</span>(datO3,group<span class="sc">==</span><span class="st">&quot;narrow&quot;</span>)<span class="sc">$</span>ci),<span class="cn">NA</span>,<span class="cn">NA</span>),     </span>
<span id="cb168-20"><a href="statistics.html#cb168-20" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;&quot;</span>,<span class="st">&quot;OR&quot;</span>,<span class="st">&quot;0.934&quot;</span>,<span class="st">&quot;0.974&quot;</span>,<span class="cn">NA</span>,<span class="st">&quot;0.965&quot;</span>)</span>
<span id="cb168-21"><a href="statistics.html#cb168-21" tabindex="-1"></a>                 )</span>
<span id="cb168-22"><a href="statistics.html#cb168-22" tabindex="-1"></a><span class="co">#use forestplot as another library to perform forest plot</span></span>
<span id="cb168-23"><a href="statistics.html#cb168-23" tabindex="-1"></a><span class="fu">library</span>(forestplot)</span></code></pre></div>
<pre><code>## Loading required package: abind</code></pre>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="statistics.html#cb170-1" tabindex="-1"></a> <span class="fu">forestplot</span>(tabletext, </span>
<span id="cb170-2"><a href="statistics.html#cb170-2" tabindex="-1"></a>       rmeta_conf,<span class="at">new_page =</span> <span class="cn">TRUE</span>,</span>
<span id="cb170-3"><a href="statistics.html#cb170-3" tabindex="-1"></a>       <span class="at">is.summary=</span><span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">TRUE</span>,<span class="fu">rep</span>(<span class="cn">FALSE</span>,<span class="dv">8</span>),<span class="cn">TRUE</span>),</span>
<span id="cb170-4"><a href="statistics.html#cb170-4" tabindex="-1"></a>       <span class="at">clip=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">2.5</span>), </span>
<span id="cb170-5"><a href="statistics.html#cb170-5" tabindex="-1"></a>       <span class="at">xlog=</span><span class="cn">TRUE</span>, </span>
<span id="cb170-6"><a href="statistics.html#cb170-6" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">fpColors</span>(<span class="at">box=</span><span class="st">&quot;royalblue&quot;</span>,<span class="at">line=</span><span class="st">&quot;darkblue&quot;</span>, <span class="at">summary=</span><span class="st">&quot;royalblue&quot;</span>))</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-17-5-1.png" width="672" /></p>
<p>Baujat plot is another method in addition to funnel plot explore heterogeneity</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="statistics.html#cb171-1" tabindex="-1"></a><span class="co"># adjust margins so the space is better used</span></span>
<span id="cb171-2"><a href="statistics.html#cb171-2" tabindex="-1"></a></span>
<span id="cb171-3"><a href="statistics.html#cb171-3" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb171-4"><a href="statistics.html#cb171-4" tabindex="-1"></a><span class="co"># create Baujat plot to explore source of heterogeneity</span></span>
<span id="cb171-5"><a href="statistics.html#cb171-5" tabindex="-1"></a><span class="fu">baujat</span>(res.DL, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.2</span>))</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-17-6-1.png" width="672" /></p>
<p>GOSH plot explores study heterogeneity using output of fixed effect model for
all possible subsets</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="statistics.html#cb172-1" tabindex="-1"></a><span class="do">## fit FE model to all possible subsets</span></span>
<span id="cb172-2"><a href="statistics.html#cb172-2" tabindex="-1"></a><span class="co"># uses output from DL analysis</span></span>
<span id="cb172-3"><a href="statistics.html#cb172-3" tabindex="-1"></a></span>
<span id="cb172-4"><a href="statistics.html#cb172-4" tabindex="-1"></a>sav <span class="ot">&lt;-</span> <span class="fu">gosh</span>(res.DL)</span></code></pre></div>
<pre><code>## Fitting 1023 models (based on all possible subsets).</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="statistics.html#cb174-1" tabindex="-1"></a><span class="do">### create GOSH plot</span></span>
<span id="cb174-2"><a href="statistics.html#cb174-2" tabindex="-1"></a><span class="do">### red points for subsets that include and blue points</span></span>
<span id="cb174-3"><a href="statistics.html#cb174-3" tabindex="-1"></a><span class="do">### for subsets that exclude study 16 (the ISIS-4 trial)</span></span>
<span id="cb174-4"><a href="statistics.html#cb174-4" tabindex="-1"></a></span>
<span id="cb174-5"><a href="statistics.html#cb174-5" tabindex="-1"></a><span class="fu">plot</span>(sav, <span class="at">out=</span><span class="fu">dim</span>(rct)[<span class="dv">1</span>], <span class="at">breaks=</span><span class="dv">100</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-17-7-1.png" width="672" /></p>
</div>
<div id="metaregression" class="section level3 hasAnchor" number="4.9.9">
<h3><span class="header-section-number">4.9.9</span> Metaregression<a href="statistics.html#metaregression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="statistics.html#cb175-1" tabindex="-1"></a><span class="co">#separate metaregression for tsens and tfpr</span></span>
<span id="cb175-2"><a href="statistics.html#cb175-2" tabindex="-1"></a></span>
<span id="cb175-3"><a href="statistics.html#cb175-3" tabindex="-1"></a><span class="co">#tsens - setting single or multicentre for spot sign metaanalysis</span></span>
<span id="cb175-4"><a href="statistics.html#cb175-4" tabindex="-1"></a>dat1<span class="ot">&lt;-</span><span class="fu">subset</span>(Dat, Dat<span class="sc">$</span>result_id<span class="sc">==</span><span class="dv">1</span> )</span>
<span id="cb175-5"><a href="statistics.html#cb175-5" tabindex="-1"></a>(metass<span class="ot">&lt;-</span><span class="fu">reitsma</span>(dat1, <span class="at">formula =</span> <span class="fu">cbind</span>(tsens,tfpr)<span class="sc">~</span>PubYear<span class="sc">+</span>Study.type<span class="sc">+</span>Setting<span class="sc">+</span>Quality.assessment)) </span></code></pre></div>
<pre><code>## Call:  reitsma.default(data = dat1, formula = cbind(tsens, tfpr) ~ PubYear + 
##     Study.type + Setting + Quality.assessment)
## 
## Fixed-effects coefficients:
##                        tsens       tfpr
## (Intercept)         298.7348  -164.8603
## PubYear              -0.1484     0.0828
## Study.typeRetro       0.3554    -0.1489
## SettingSingle         0.2283    -0.1301
## Quality.assessment   -0.0040    -0.0834
## 
## 26 studies, 10 fixed and 3 random-effects parameters
##   logLik       AIC       BIC  
##  48.5386  -71.0771  -45.7109</code></pre>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="statistics.html#cb177-1" tabindex="-1"></a><span class="fu">summary</span>(metass)</span></code></pre></div>
<pre><code>## Call:  reitsma.default(data = dat1, formula = cbind(tsens, tfpr) ~ PubYear + 
##     Study.type + Setting + Quality.assessment)
## 
## Bivariate diagnostic random-effects meta-regression
## Estimation method: REML
## 
## Fixed-effects coefficients
##                          Estimate Std. Error      z Pr(&gt;|z|) 95%ci.lb 95%ci.ub
## tsens.(Intercept)         298.735    143.547  2.081    0.037   17.387  580.083
## tsens.PubYear              -0.148      0.071 -2.078    0.038   -0.288   -0.008
## tsens.Study.typeRetro       0.355      0.310  1.146    0.252   -0.253    0.963
## tsens.SettingSingle         0.228      0.495  0.462    0.644   -0.741    1.198
## tsens.Quality.assessment   -0.004      0.050 -0.081    0.936   -0.102    0.094
## tfpr.(Intercept)         -164.860     80.574 -2.046    0.041 -322.783   -6.938
## tfpr.PubYear                0.083      0.040  2.066    0.039    0.004    0.161
## tfpr.Study.typeRetro       -0.149      0.172 -0.865    0.387   -0.486    0.188
## tfpr.SettingSingle         -0.130      0.276 -0.471    0.638   -0.672    0.412
## tfpr.Quality.assessment    -0.083      0.026 -3.190    0.001   -0.135   -0.032
##                            
## tsens.(Intercept)         *
## tsens.PubYear             *
## tsens.Study.typeRetro      
## tsens.SettingSingle        
## tsens.Quality.assessment   
## tfpr.(Intercept)          *
## tfpr.PubYear              *
## tfpr.Study.typeRetro       
## tfpr.SettingSingle         
## tfpr.Quality.assessment  **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 
## 
## Variance components: between-studies Std. Dev and correlation matrix
##       Std. Dev tsens  tfpr
## tsens    0.657 1.000     .
## tfpr     0.297 0.312 1.000
## 
##  logLik     AIC     BIC 
##  48.539 -71.077 -45.711 
## 
## 
## I2 estimates 
## Zhou and Dendukuri approach:  0 % 
## Holling sample size unadjusted approaches:  66.8 - 80.5 % 
## Holling sample size adjusted approaches:  5.4 - 5.8 %</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="statistics.html#cb179-1" tabindex="-1"></a><span class="co">#tfpr - setting single or multicentre for spot sign metaanalysis</span></span>
<span id="cb179-2"><a href="statistics.html#cb179-2" tabindex="-1"></a>dat1<span class="ot">&lt;-</span><span class="fu">subset</span>(Dat, Dat<span class="sc">$</span>result_id<span class="sc">==</span><span class="dv">1</span> )</span>
<span id="cb179-3"><a href="statistics.html#cb179-3" tabindex="-1"></a>(metassfull<span class="ot">&lt;-</span><span class="fu">reitsma</span>(dat1, <span class="at">formula =</span> <span class="fu">cbind</span>(tsens,tfpr)<span class="sc">~</span></span>
<span id="cb179-4"><a href="statistics.html#cb179-4" tabindex="-1"></a>        PubYear<span class="sc">+</span>clinical<span class="sc">+</span>Study.type<span class="sc">+</span>CTA6hrs<span class="sc">+</span>Setting<span class="sc">+</span>Quality.assessment)) </span></code></pre></div>
<pre><code>## Call:  reitsma.default(data = dat1, formula = cbind(tsens, tfpr) ~ PubYear + 
##     clinical + Study.type + CTA6hrs + Setting + Quality.assessment)
## 
## Fixed-effects coefficients:
##                        tsens       tfpr
## (Intercept)         297.5416  -144.2754
## PubYear              -0.1480     0.0724
## clinical             -0.4703    -0.1810
## Study.typeRetro       0.4884    -0.0989
## CTA6hrsyes           -0.2141    -0.2342
## SettingSingle         0.2568    -0.1435
## Quality.assessment    0.0130    -0.0738
## 
## 26 studies, 14 fixed and 3 random-effects parameters
##   logLik       AIC       BIC  
##  48.4477  -62.8955  -29.7243</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="statistics.html#cb181-1" tabindex="-1"></a><span class="fu">summary</span>(metassfull)</span></code></pre></div>
<pre><code>## Call:  reitsma.default(data = dat1, formula = cbind(tsens, tfpr) ~ PubYear + 
##     clinical + Study.type + CTA6hrs + Setting + Quality.assessment)
## 
## Bivariate diagnostic random-effects meta-regression
## Estimation method: REML
## 
## Fixed-effects coefficients
##                          Estimate Std. Error      z Pr(&gt;|z|) 95%ci.lb 95%ci.ub
## tsens.(Intercept)         297.542    150.543  1.976    0.048    2.482  592.601
## tsens.PubYear              -0.148      0.075 -1.977    0.048   -0.295   -0.001
## tsens.clinical             -0.470      0.333 -1.411    0.158   -1.124    0.183
## tsens.Study.typeRetro       0.488      0.321  1.523    0.128   -0.140    1.117
## tsens.CTA6hrsyes           -0.214      0.322 -0.665    0.506   -0.845    0.417
## tsens.SettingSingle         0.257      0.495  0.519    0.604   -0.714    1.228
## tsens.Quality.assessment    0.013      0.051  0.255    0.799   -0.087    0.113
## tfpr.(Intercept)         -144.275     82.720 -1.744    0.081 -306.403   17.852
## tfpr.PubYear                0.072      0.041  1.761    0.078   -0.008    0.153
## tfpr.clinical              -0.181      0.187 -0.969    0.333   -0.547    0.185
## tfpr.Study.typeRetro       -0.099      0.177 -0.558    0.577   -0.446    0.249
## tfpr.CTA6hrsyes            -0.234      0.177 -1.322    0.186   -0.581    0.113
## tfpr.SettingSingle         -0.144      0.274 -0.524    0.600   -0.680    0.393
## tfpr.Quality.assessment    -0.074      0.027 -2.774    0.006   -0.126   -0.022
##                            
## tsens.(Intercept)         *
## tsens.PubYear             *
## tsens.clinical             
## tsens.Study.typeRetro      
## tsens.CTA6hrsyes           
## tsens.SettingSingle        
## tsens.Quality.assessment   
## tfpr.(Intercept)          .
## tfpr.PubYear              .
## tfpr.clinical              
## tfpr.Study.typeRetro       
## tfpr.CTA6hrsyes            
## tfpr.SettingSingle         
## tfpr.Quality.assessment  **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 
## 
## Variance components: between-studies Std. Dev and correlation matrix
##       Std. Dev tsens  tfpr
## tsens    0.650 1.000     .
## tfpr     0.285 0.188 1.000
## 
##  logLik     AIC     BIC 
##  48.448 -62.895 -29.724 
## 
## 
## I2 estimates 
## Zhou and Dendukuri approach:  0 % 
## Holling sample size unadjusted approaches:  66.8 - 80.5 % 
## Holling sample size adjusted approaches:  5.4 - 5.8 %</code></pre>
<p>Plot year against tsens from metaregression</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="statistics.html#cb183-1" tabindex="-1"></a><span class="co">#using output from spot sign</span></span>
<span id="cb183-2"><a href="statistics.html#cb183-2" tabindex="-1"></a></span>
<span id="cb183-3"><a href="statistics.html#cb183-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb183-4"><a href="statistics.html#cb183-4" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb183-5"><a href="statistics.html#cb183-5" tabindex="-1"></a>ssr<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(ss<span class="sc">$</span>residuals)</span>
<span id="cb183-6"><a href="statistics.html#cb183-6" tabindex="-1"></a><span class="co">#convert character to year</span></span>
<span id="cb183-7"><a href="statistics.html#cb183-7" tabindex="-1"></a>ssr<span class="sc">$</span>Year<span class="ot">&lt;-</span><span class="fu">as.Date</span>(<span class="fu">as.character</span>(Dat<span class="sc">$</span>PubYear),<span class="st">&quot;%Y&quot;</span>)</span>
<span id="cb183-8"><a href="statistics.html#cb183-8" tabindex="-1"></a>ssr<span class="sc">$</span>Quality<span class="ot">&lt;-</span>Dat<span class="sc">$</span>Quality.assessment</span>
<span id="cb183-9"><a href="statistics.html#cb183-9" tabindex="-1"></a><span class="fu">ggplot</span>(ssr, <span class="fu">aes</span>(<span class="at">x=</span>ssr<span class="sc">$</span>Year,<span class="at">y=</span>ssr<span class="sc">$</span>tsens))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb183-10"><a href="statistics.html#cb183-10" tabindex="-1"></a>  <span class="fu">scale_x_date</span>()<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>)<span class="sc">+</span></span>
<span id="cb183-11"><a href="statistics.html#cb183-11" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Relationship between transformed sensitivity and Publication Year&quot;</span>)<span class="sc">+</span></span>
<span id="cb183-12"><a href="statistics.html#cb183-12" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Year&quot;</span>,<span class="at">y=</span><span class="st">&quot;transformed sensitivity&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-17-9-1.png" width="672" /></p>
<div id="summary-positive-and-negative-likelihood-ratio" class="section level4 hasAnchor" number="4.9.9.1">
<h4><span class="header-section-number">4.9.9.1</span> summary Positive and Negative Likelihood Ratio<a href="statistics.html#summary-positive-and-negative-likelihood-ratio" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Positive likelihood ratio (PLR) is the ratio of sensitivity to false positive
rate (FPR); the negative (NLR) likelihood ratio is the ratio of 1-sensitivity
to specificity. A PLR indicates the likelihood that a positive spot sign (test) would be expected in a patient with target disorder compared with the
likelihood that the same result would be expected in a patient without target disorder. Using the recommendation by Jaeschke et al<span class="citation">(<a href="#ref-pmid8309035">Jaeschke, Guyatt, and Sackett 1994</a>)</span> a
high PLR (&gt;5) and low NLR (&lt;0.2) indicate that the test results would make moderate changes in the likelihood of hematoma growth from baseline risk.
PLRs of &gt;10 and NLRs of &lt;0.1 would confer very large changes from baseline risk. The pooled likelihood ratios were used to calculate post-test odds according to Bayes’ Theorem and post-test probabilities of outcome after a positive test
result for a range of possible values of baseline risk.</p>
<p>Data from likelihood ratio can be used to create Fagan’s normogram.</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="statistics.html#cb185-1" tabindex="-1"></a><span class="co">#The code for this is available at</span></span>
<span id="cb185-2"><a href="statistics.html#cb185-2" tabindex="-1"></a><span class="co">#&quot;https://raw.githubusercontent.com/achekroud/nomogrammer/master/nomogrammer.r&quot;</span></span>
<span id="cb185-3"><a href="statistics.html#cb185-3" tabindex="-1"></a><span class="fu">library</span>(nomogrammer)</span>
<span id="cb185-4"><a href="statistics.html#cb185-4" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">nomogrammer</span>(<span class="at">Prevalence =</span> .<span class="dv">234</span>, <span class="at">Plr =</span> <span class="fl">4.85</span>, <span class="at">Nlr =</span> <span class="fl">0.49</span>)</span>
<span id="cb185-5"><a href="statistics.html#cb185-5" tabindex="-1"></a>p<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">&quot;Fagan&#39;s normogram for Spot Sign and ICH growth&quot;</span>)</span>
<span id="cb185-6"><a href="statistics.html#cb185-6" tabindex="-1"></a><span class="co">#ggsave(p,file=&quot;Fagan_SpotSign.png&quot;,width=5.99,height=3.99,units=&quot;in&quot;)</span></span></code></pre></div>
</div>
</div>
</div>
<div id="data-simulation" class="section level2 hasAnchor" number="4.10">
<h2><span class="header-section-number">4.10</span> Data simulation<a href="statistics.html#data-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Data simulation is an important aspects of data science. The example below is taken from our experience trying to simulate data from recent clot retrieval trials in stroke <span class="citation">(<a href="#ref-pmid25517348">Berkhemer et al. 2015</a>)</span> <span class="citation">(<a href="#ref-pmid25671797">Campbell et al. 2015</a>)</span>. Simulation is performed using <em>simstudy</em> library.</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="statistics.html#cb186-1" tabindex="-1"></a><span class="fu">library</span> (simstudy)</span>
<span id="cb186-2"><a href="statistics.html#cb186-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb186-3"><a href="statistics.html#cb186-3" tabindex="-1"></a></span>
<span id="cb186-4"><a href="statistics.html#cb186-4" tabindex="-1"></a><span class="co">#T is Trial</span></span>
<span id="cb186-5"><a href="statistics.html#cb186-5" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">&quot;T&quot;</span>, <span class="at">dist =</span> <span class="st">&quot;binary&quot;</span>, <span class="at">formula =</span> <span class="fl">0.5</span>)</span>
<span id="cb186-6"><a href="statistics.html#cb186-6" tabindex="-1"></a></span>
<span id="cb186-7"><a href="statistics.html#cb186-7" tabindex="-1"></a><span class="co">#early neurological improvement (ENI) .37 in TPA and .8 in ECR</span></span>
<span id="cb186-8"><a href="statistics.html#cb186-8" tabindex="-1"></a><span class="co">#baseline NIHSS 13 in TPA and 17 in ECR</span></span>
<span id="cb186-9"><a href="statistics.html#cb186-9" tabindex="-1"></a></span>
<span id="cb186-10"><a href="statistics.html#cb186-10" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def, <span class="at">varname =</span> <span class="st">&quot;ENI&quot;</span>, <span class="at">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="at">formula =</span> .<span class="dv">8</span><span class="fl">-.53</span><span class="sc">*</span>T, <span class="at">variance =</span> .<span class="dv">1</span>)</span>
<span id="cb186-11"><a href="statistics.html#cb186-11" tabindex="-1"></a></span>
<span id="cb186-12"><a href="statistics.html#cb186-12" tabindex="-1"></a><span class="co">#baseline NIHSS 13 in TPA and 17 in ECR</span></span>
<span id="cb186-13"><a href="statistics.html#cb186-13" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def, <span class="at">varname =</span> <span class="st">&quot;Y1&quot;</span>, <span class="at">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="at">formula=</span><span class="dv">13</span>, <span class="at">variance =</span> <span class="dv">1</span>)</span>
<span id="cb186-14"><a href="statistics.html#cb186-14" tabindex="-1"></a></span>
<span id="cb186-15"><a href="statistics.html#cb186-15" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def, <span class="at">varname =</span> <span class="st">&quot;Y2&quot;</span>, <span class="at">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="at">formula =</span> <span class="st">&quot;Y1*ENI - 5 * T &gt;5&quot;</span>,<span class="at">variance =</span> <span class="dv">1</span>)</span>
<span id="cb186-16"><a href="statistics.html#cb186-16" tabindex="-1"></a></span>
<span id="cb186-17"><a href="statistics.html#cb186-17" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def, <span class="at">varname =</span> <span class="st">&quot;Y3&quot;</span>, <span class="at">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="at">formula =</span> <span class="st">&quot;Y2- 4*T&gt;2&quot;</span>,<span class="at">variance =</span> <span class="dv">1</span>)</span>
<span id="cb186-18"><a href="statistics.html#cb186-18" tabindex="-1"></a></span>
<span id="cb186-19"><a href="statistics.html#cb186-19" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def, <span class="at">varname =</span> <span class="st">&quot;Y4&quot;</span>, <span class="at">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="at">formula =</span> <span class="st">&quot;Y3- 2*T&gt;0&quot;</span>, <span class="at">variance =</span> <span class="dv">1</span>)</span>
<span id="cb186-20"><a href="statistics.html#cb186-20" tabindex="-1"></a></span>
<span id="cb186-21"><a href="statistics.html#cb186-21" tabindex="-1"></a><span class="co">#male</span></span>
<span id="cb186-22"><a href="statistics.html#cb186-22" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def,<span class="at">varname =</span> <span class="st">&quot;Male&quot;</span>, <span class="at">dist =</span> <span class="st">&quot;binary&quot;</span>, <span class="at">formula =</span> <span class="fl">0.49</span><span class="sc">*</span>T)</span>
<span id="cb186-23"><a href="statistics.html#cb186-23" tabindex="-1"></a></span>
<span id="cb186-24"><a href="statistics.html#cb186-24" tabindex="-1"></a><span class="co">#diabetes .23 in TPA and .06 in ECR</span></span>
<span id="cb186-25"><a href="statistics.html#cb186-25" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def,<span class="at">varname =</span> <span class="st">&quot;Diabetes&quot;</span>, <span class="at">dist =</span> <span class="st">&quot;binary&quot;</span>, <span class="at">formula =</span> .<span class="dv">23</span><span class="fl">-.17</span><span class="sc">*</span>T)</span>
<span id="cb186-26"><a href="statistics.html#cb186-26" tabindex="-1"></a></span>
<span id="cb186-27"><a href="statistics.html#cb186-27" tabindex="-1"></a><span class="co">#HT .66 TPA vs .6 ECR</span></span>
<span id="cb186-28"><a href="statistics.html#cb186-28" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def,<span class="at">varname =</span> <span class="st">&quot;HT&quot;</span>, <span class="at">dist =</span> <span class="st">&quot;binary&quot;</span>, <span class="at">formula =</span> .<span class="dv">66</span><span class="fl">-.06</span><span class="sc">*</span>T)</span>
<span id="cb186-29"><a href="statistics.html#cb186-29" tabindex="-1"></a></span>
<span id="cb186-30"><a href="statistics.html#cb186-30" tabindex="-1"></a><span class="co">#generate data frame</span></span>
<span id="cb186-31"><a href="statistics.html#cb186-31" tabindex="-1"></a>dtTrial <span class="ot">&lt;-</span> <span class="fu">genData</span>(<span class="dv">500</span>, def)</span>
<span id="cb186-32"><a href="statistics.html#cb186-32" tabindex="-1"></a></span>
<span id="cb186-33"><a href="statistics.html#cb186-33" tabindex="-1"></a><span class="co">#define parameter for mRS</span></span>
<span id="cb186-34"><a href="statistics.html#cb186-34" tabindex="-1"></a></span>
<span id="cb186-35"><a href="statistics.html#cb186-35" tabindex="-1"></a></span>
<span id="cb186-36"><a href="statistics.html#cb186-36" tabindex="-1"></a><span class="co">#Add conditional column with field name &quot;mRS&quot;</span></span>
<span id="cb186-37"><a href="statistics.html#cb186-37" tabindex="-1"></a></span>
<span id="cb186-38"><a href="statistics.html#cb186-38" tabindex="-1"></a></span>
<span id="cb186-39"><a href="statistics.html#cb186-39" tabindex="-1"></a></span>
<span id="cb186-40"><a href="statistics.html#cb186-40" tabindex="-1"></a>dtTime <span class="ot">&lt;-</span> <span class="fu">addPeriods</span>(dtTrial, <span class="at">nPeriods =</span> <span class="dv">4</span>, <span class="at">idvars =</span> <span class="st">&quot;id&quot;</span>, </span>
<span id="cb186-41"><a href="statistics.html#cb186-41" tabindex="-1"></a>            <span class="at">timevars =</span> <span class="fu">c</span>(<span class="st">&quot;Y1&quot;</span>, <span class="st">&quot;Y2&quot;</span>, <span class="st">&quot;Y3&quot;</span>,<span class="st">&quot;Y4&quot;</span>), <span class="at">timevarName =</span> <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb186-42"><a href="statistics.html#cb186-42" tabindex="-1"></a>dtTime</span></code></pre></div>
<pre><code>##        id period T         ENI Male Diabetes HT           Y timeID
##    1:   1      0 0  0.05155929    1        0  1 12.75075513      1
##    2:   1      1 0  0.05155929    1        0  1  1.03677819      2
##    3:   1      2 0  0.05155929    1        0  1 -0.06286235      3
##    4:   1      3 0  0.05155929    1        0  1  0.21662525      4
##    5:   2      0 0 -0.27568310    0        0  0 13.44818508      5
##   ---                                                             
## 1996: 499      3 1  0.14142181    1        0  0 -0.42869265   1996
## 1997: 500      0 0  0.38714375    1        0  1 13.17836454   1997
## 1998: 500      1 0  0.38714375    1        0  1  1.03691916   1998
## 1999: 500      2 0  0.38714375    1        0  1 -0.80777463   1999
## 2000: 500      3 0  0.38714375    1        0  1 -1.85164598   2000</code></pre>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="statistics.html#cb188-1" tabindex="-1"></a><span class="co">#check  that 2 groups are similar at start but not at finish</span></span>
<span id="cb188-2"><a href="statistics.html#cb188-2" tabindex="-1"></a><span class="fu">t.test</span>(Y1<span class="sc">~</span>T,<span class="at">data=</span>dtTrial)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Y1 by T
## t = -1.0666, df = 497.24, p-value = 0.2866
## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
## 95 percent confidence interval:
##  -0.27825765  0.08243833
## sample estimates:
## mean in group 0 mean in group 1 
##        12.97746        13.07537</code></pre>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="statistics.html#cb190-1" tabindex="-1"></a><span class="fu">t.test</span>(Y4<span class="sc">~</span>T,<span class="at">data=</span>dtTrial)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Y4 by T
## t = 4.5458, df = 495.22, p-value = 6.886e-06
## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
## 95 percent confidence interval:
##  0.2528716 0.6378541
## sample estimates:
## mean in group 0 mean in group 1 
##      0.48521191      0.03984904</code></pre>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="statistics.html#cb192-1" tabindex="-1"></a><span class="fu">t.test</span>(Male<span class="sc">~</span>T,<span class="at">data=</span>dtTrial)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Male by T
## t = -0.53539, df = 497.97, p-value = 0.5926
## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
## 95 percent confidence interval:
##  -0.11200120  0.06403243
## sample estimates:
## mean in group 0 mean in group 1 
##       0.4899598       0.5139442</code></pre>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="statistics.html#cb194-1" tabindex="-1"></a><span class="co">#putting the 4 time periods together - long format</span></span>
<span id="cb194-2"><a href="statistics.html#cb194-2" tabindex="-1"></a>dtTime <span class="ot">&lt;-</span> <span class="fu">addPeriods</span>(dtTrial, <span class="at">nPeriods =</span> <span class="dv">3</span>, <span class="at">idvars =</span> <span class="st">&quot;id&quot;</span>, <span class="at">timevars =</span> <span class="fu">c</span>(<span class="st">&quot;Y1&quot;</span>, <span class="st">&quot;Y2&quot;</span>, <span class="st">&quot;Y3&quot;</span>,<span class="st">&quot;Y4&quot;</span>), <span class="at">timevarName =</span> <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb194-3"><a href="statistics.html#cb194-3" tabindex="-1"></a></span>
<span id="cb194-4"><a href="statistics.html#cb194-4" tabindex="-1"></a><span class="co">#summarise data using group_by</span></span>
<span id="cb194-5"><a href="statistics.html#cb194-5" tabindex="-1"></a>dtTime2<span class="ot">&lt;-</span>dtTime <span class="sc">%&gt;%</span></span>
<span id="cb194-6"><a href="statistics.html#cb194-6" tabindex="-1"></a>  <span class="fu">group_by</span>(period, T) <span class="sc">%&gt;%</span></span>
<span id="cb194-7"><a href="statistics.html#cb194-7" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">meanY=</span><span class="fu">mean</span>(Y),</span>
<span id="cb194-8"><a href="statistics.html#cb194-8" tabindex="-1"></a>            <span class="at">sdY=</span><span class="fu">sd</span>(Y),</span>
<span id="cb194-9"><a href="statistics.html#cb194-9" tabindex="-1"></a>            <span class="at">upperY=</span>meanY<span class="sc">+</span>sdY,</span>
<span id="cb194-10"><a href="statistics.html#cb194-10" tabindex="-1"></a>            <span class="at">lowerY=</span>meanY<span class="sc">-</span>sdY)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;period&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="statistics.html#cb196-1" tabindex="-1"></a><span class="co">#write.csv(dtTime, file=&quot;./Data-Use/dtTime_simulated.csv&quot;)</span></span>
<span id="cb196-2"><a href="statistics.html#cb196-2" tabindex="-1"></a><span class="co">#write.csv(dtTrial,          file=&quot;./Data-Use/dtTrial_simulated.csv&quot;)</span></span></code></pre></div>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-doi:10.1080/00031305.1998.10480550" class="csl-entry">
Agresti, Alan, and Brent A. Coull. 1998. <span>“Approximate Is Better Than <span>‘Exact’</span> for Interval Estimation of Binomial Proportions.”</span> <em>The American Statistician</em> 52 (2): 119–26. <a href="https://doi.org/10.1080/00031305.1998.10480550">https://doi.org/10.1080/00031305.1998.10480550</a>.
</div>
<div id="ref-pmid29387889" class="csl-entry">
Aung T, Kromhout D, Halsey J. 2018. <span>“Associations of Omega-3 Fatty Acid Supplement Use with Cardiovascular Disease Risks: Meta-Analysis of 10 Trials Involving 77 917 Individuals.”</span> <em>Jama Cardiol</em>, March. <a href="https://doi.org/doi: 10.1001/jamacardio.2017.5205">https://doi.org/doi: 10.1001/jamacardio.2017.5205</a>.
</div>
<div id="ref-doi10.1136/ebmental-2019-300117" class="csl-entry">
Balduzzi, Sara, Gerta Rücker, and Guido Schwarzer. 2019. <span>“How to Perform a Meta-Analysis with <span>R</span>: A Practical Tutorial.”</span> <em>Evidence-Based Mental Health</em>, no. 22: 153–60.
</div>
<div id="ref-pmid25517348" class="csl-entry">
Berkhemer, O. A., P. S. Fransen, D. Beumer, L. A. van den Berg, H. F. Lingsma, A. J. Yoo, W. J. Schonewille, et al. 2015. <span>“<span class="nocase"><span>A</span> randomized trial of intraarterial treatment for acute ischemic stroke</span>.”</span> <em>N. Engl. J. Med.</em> 372 (1): 11–20.
</div>
<div id="ref-pmid10700737" class="csl-entry">
BJ, Biggerstaff. 2000. <span>“Comparing Diagnostic Tests: A Simple Graphic Using Likelihood Ratios.”</span> <em>Stat Med</em> 19 (March): 649–63. <a href="https://doi.org/10.1002/(sici)1097-0258(20000315)19:5&lt;649::aid-sim371&gt;3.0.co;2-h">https://doi.org/10.1002/(sici)1097-0258(20000315)19:5&lt;649::aid-sim371&gt;3.0.co;2-h</a>.
</div>
<div id="ref-brown2001" class="csl-entry">
Brown, Lawrence D., T. Tony Cai, and Anirban DasGupta. 2001. <span>“Interval Estimation for a Binomial Proportion.”</span> <em>Statist. Sci.</em> 16 (2): 101–33. <a href="https://doi.org/10.1214/ss/1009213286">https://doi.org/10.1214/ss/1009213286</a>.
</div>
<div id="ref-pmid25671797" class="csl-entry">
Campbell, B. C., P. J. Mitchell, T. J. Kleinig, H. M. Dewey, L. Churilov, N. Yassi, B. Yan, et al. 2015. <span>“<span class="nocase"><span>E</span>ndovascular therapy for ischemic stroke with perfusion-imaging selection</span>.”</span> <em>N. Engl. J. Med.</em> 372 (11): 1009–18.
</div>
<div id="ref-COHEN1977179" class="csl-entry">
Cohen, Jacob. 1977. <span>“CHAPTER 6 - Differences Between Proportions.”</span> In <em>Statistical Power Analysis for the Behavioral Sciences</em>, edited by Jacob Cohen, 179–213. Academic Press. https://doi.org/<a href="https://doi.org/10.1016/B978-0-12-179060-8.50011-6">https://doi.org/10.1016/B978-0-12-179060-8.50011-6</a>.
</div>
<div id="ref-pmid1738016" class="csl-entry">
Diamond, G. A. 1992. <span>“<span class="nocase"><span>W</span>hat price perfection? <span>C</span>alibration and discrimination of clinical prediction models</span>.”</span> <em>J Clin Epidemiol</em> 45 (1): 85–89.
</div>
<div id="ref-pmid25781447" class="csl-entry">
Gopal, A. D., N. R. Desai, T. Tse, and J. S. Ross. 2015. <span>“<span class="nocase"><span>R</span>eporting of noninferiority trials in <span>C</span>linical<span>T</span>rials.gov and corresponding publications</span>.”</span> <em>JAMA</em> 313 (11): 1163–65.
</div>
<div id="ref-pmid10474158" class="csl-entry">
Graf E, Sauerbrei W, Schmoor C. 1999. <span>“Assessment and Comparison of Prognostic Classification Schemes for Survival Data.”</span> <em>Stat Med</em> 18 (September): 2529–45. <a href="https://doi.org/10.1002/(sici)1097-0258(19990915/30)18:17/18&lt;2529::aid-sim274&gt;3.0.co;2-5">https://doi.org/10.1002/(sici)1097-0258(19990915/30)18:17/18&lt;2529::aid-sim274&gt;3.0.co;2-5</a>.
</div>
<div id="ref-10.1093/biomet/81.3.515" class="csl-entry">
Grambsch, P. M., and T. M. Therneau. 1994. <span>“<span class="nocase">Proportional hazards tests and diagnostics based on weighted residuals</span>.”</span> <em>Biometrika</em> 81 (3): 515–26. <a href="https://doi.org/10.1093/biomet/81.3.515">https://doi.org/10.1093/biomet/81.3.515</a>.
</div>
<div id="ref-pmid7069920" class="csl-entry">
Harrell FE Jr, Pryor DB, Califf RM. 1982. <span>“Evaluating the Yield of Medical Tests.”</span> <em>JAMA</em> 247 (May): 2543–46.
</div>
<div id="ref-pmid31567003" class="csl-entry">
Hu, Hu, Y. 2019. <span>“Marine Omega‐3 Supplementation and Cardiovascular Disease: An Updated Meta‐analysis of 13 Randomized Controlled Trials Involving 127 477 Participants.”</span> <em>JAHA</em>, September. https://doi.org/<a href="https://doi.org/10.1161/JAHA.119.013543">https://doi.org/10.1161/JAHA.119.013543</a>.
</div>
<div id="ref-pmid15345796" class="csl-entry">
Ingall, Timothy John, William Michael O’Fallon, Kjell Asplund, Lewis Robert Goldfrank, Vicki S. Hertzberg, Thomas Arthur Louis, and Teresa J. Hengy Christianson. 2004. <span>“Findings from the Reanalysis of the NINDS Tissue Plasminogen Activator for Acute Ischemic Stroke Treatment Trial.”</span> <em>Stroke</em> 35 (10): 2418–24. <a href="https://doi.org/10.1161/01.STR.0000140891.70547.56">https://doi.org/10.1161/01.STR.0000140891.70547.56</a>.
</div>
<div id="ref-pmid33250548" class="csl-entry">
J, Muschelli. 2020. <span>“ROC and AUC with a Binary Predictor: A Potentially Misleading Metric.”</span> <em>J Classif</em> 37 (October): 696–708. <a href="https://doi.org/10.1007/s00357-019-09345-1">https://doi.org/10.1007/s00357-019-09345-1</a>.
</div>
<div id="ref-pmid8309035" class="csl-entry">
Jaeschke, R., G. H. Guyatt, and D. L. Sackett. 1994. <span>“<span class="nocase"><span>U</span>sers’ guides to the medical literature. <span>I</span><span>I</span><span>I</span>. <span>H</span>ow to use an article about a diagnostic test. <span>B</span>. <span>W</span>hat are the results and will they help me in caring for my patients? <span>T</span>he <span>E</span>vidence-<span>B</span>ased <span>M</span>edicine <span>W</span>orking <span>G</span>roup</span>.”</span> <em>JAMA</em> 271 (9): 703–7.
</div>
<div id="ref-10.1186/1745-6215-15-139" class="csl-entry">
Kahan, Jairath, B. C. 2014. <span>“The Risks and Rewards of Covariate Adjustment in Randomized Trials: An Assessment of 12 Outcomes from 8 Studies.”</span> <em>Trials</em> 15: 139. <a href="https://doi.org/10.1186/1745-6215-15-139">https://doi.org/10.1186/1745-6215-15-139</a>.
</div>
<div id="ref-pmid26080342" class="csl-entry">
Kaji, A. H., and R. J. Lewis. 2015. <span>“<span class="nocase"><span>N</span>oninferiority <span>T</span>rials: <span>I</span>s a <span>N</span>ew <span>T</span>reatment <span>A</span>lmost as <span>E</span>ffective as <span>A</span>nother?</span>”</span> <em>JAMA</em> 313 (23): 2371–72.
</div>
<div id="ref-LONGATO2020103496" class="csl-entry">
Longato, Enrico, Martina Vettoretti, and Barbara Di Camillo. 2020. <span>“A Practical Perspective on the Concordance Index for the Evaluation and Selection of Prognostic Time-to-Event Models.”</span> <em>Journal of Biomedical Informatics</em> 108: 103496. https://doi.org/<a href="https://doi.org/10.1016/j.jbi.2020.103496">https://doi.org/10.1016/j.jbi.2020.103496</a>.
</div>
<div id="ref-pmid32404155" class="csl-entry">
Ludwig, L., P. Darmon, and B Guerci. 2020. <span>“<span class="nocase">Computing and interpreting the Number Needed to Treat for Cardiovascular Outcomes Trials:Perspective on GLP-1 RA and SGLT-2i therapies</span>.”</span> <em>Cardiovasc Diabetol</em>, May. <a href="https://doi.org/10.1186/s12933-020-01034-3">https://doi.org/10.1186/s12933-020-01034-3</a>.
</div>
<div id="ref-doi:10.1177/0962280216669183" class="csl-entry">
Luo, Dehui, Xiang Wan, Jiming Liu, and Tiejun Tong. 2018. <span>“Optimally Estimating the Sample Mean from the Sample Size, Median, Mid-Range, and/or Mid-Quartile Range.”</span> <em>Statistical Methods in Medical Research</em> 27 (6): 1785–805. <a href="https://doi.org/10.1177/0962280216669183">https://doi.org/10.1177/0962280216669183</a>.
</div>
<div id="ref-pmid12614141" class="csl-entry">
Marx, Heiner C, Arthur. Bucher. 2003. <span>“Numbers Needed to Treat Derived from Meta-Analysis: A Word of Caution.”</span> <em>BMJ Evidence-Based Medicine</em> 8 (2): 36–37. <a href="https://doi.org/10.1136/ebm.8.2.36">https://doi.org/10.1136/ebm.8.2.36</a>.
</div>
<div id="ref-pmid29912013" class="csl-entry">
Mathur MB, Riddell CA, Ding P. 2018. <span>“Web Site and r Package for Computing e-Values.”</span> <em>Epidemiology</em>, e45–47. <a href="https://doi.org/10.1097/EDE.0000000000000864">https://doi.org/10.1097/EDE.0000000000000864</a>.
</div>
<div id="ref-pmid36412105" class="csl-entry">
McGrath, Sean, Stephan Katzenschlager, Alexander J. Zimmer, Alexander Seitel, Russell J. Steele, and Andrea Benedetti. 2022. <span>“Standard Error Estimation in Meta-Analysis of Studies Reporting Medians.”</span> <em>Statistical Methods in Medical Research</em> 32: 373–88. <a href="https://doi.org/10.1177/09622802221139233">https://doi.org/10.1177/09622802221139233</a>.
</div>
<div id="ref-doi:10.1177/0962280219889080" class="csl-entry">
McGrath, Sean, XiaoFei Zhao, Russell Steele, Brett D. Thombs, Andrea Benedetti, the DEPRESsion Screening Data (DEPRESSD) Collaboration, Brooke Levis, et al. 2020. <span>“Estimating the Sample Mean and Standard Deviation from Commonly Reported Quantiles in Meta-Analysis.”</span> <em>Statistical Methods in Medical Research</em> 29 (9): 2520–37. <a href="https://doi.org/10.1177/0962280219889080">https://doi.org/10.1177/0962280219889080</a>.
</div>
<div id="ref-pmid8210827" class="csl-entry">
Moses, L. E., D. Shapiro, and B. Littenberg. 1993. <span>“<span class="nocase"><span>C</span>ombining independent studies of a diagnostic test into a summary <span>R</span><span>O</span><span>C</span> curve: data-analytic approaches and some additional considerations</span>.”</span> <em>Stat Med</em> 12 (14): 1293–1316.
</div>
<div id="ref-pmid28579970" class="csl-entry">
Phan, T. G., B. B. Clissold, H. Ma, J. V. Ly, and V. Srikanth. 2017. <span>“<span class="nocase"><span>P</span>redicting <span>D</span>isability after <span>I</span>schemic <span>S</span>troke <span>B</span>ased on <span>C</span>omorbidity <span>I</span>ndex and <span>S</span>troke <span>S</span>everity-<span>F</span>rom the <span>V</span>irtual <span>I</span>nternational <span>S</span>troke <span>T</span>rials <span>A</span>rchive-<span>A</span>cute <span>C</span>ollaboration</span>.”</span> <em>Front Neurol</em> 8: 192.
</div>
<div id="ref-pmid26796056" class="csl-entry">
Phan, T. G., B. Clissold, J. Ly, H. Ma, C. Moran, V. Srikanth, K. R. Lees, et al. 2016. <span>“<span class="nocase"><span>S</span>troke <span>S</span>everity and <span>C</span>omorbidity <span>I</span>ndex for <span>P</span>rediction of <span>M</span>ortality after <span>I</span>schemic <span>S</span>troke from the <span>V</span>irtual <span>I</span>nternational <span>S</span>troke <span>T</span>rials <span>A</span>rchive-<span>A</span>cute <span>C</span>ollaboration</span>.”</span> <em>J Stroke Cerebrovasc Dis</em> 25 (4): 835–42.
</div>
<div id="ref-pmid16931782" class="csl-entry">
Phan, T. G., G. A. Donnan, S. M. Davis, and G. Byrnes. 2006. <span>“<span class="nocase"><span>P</span>roof-of-principle phase <span>I</span><span>I</span> <span>M</span><span>R</span><span>I</span> studies in stroke: sample size estimates from dichotomous and continuous data</span>.”</span> <em>Stroke</em> 37 (10): 2521–25.
</div>
<div id="ref-pmid16504541" class="csl-entry">
Phan, T. G., G. A. Donnan, M. Koga, L. A. Mitchell, M. Molan, G. Fitt, W. Chong, M. Holt, and D. C. Reutens. 2006. <span>“<span class="nocase"><span>T</span>he <span>A</span><span>S</span><span>P</span><span>E</span><span>C</span><span>T</span><span>S</span> template is weighted in favor of the striatocapsular region</span>.”</span> <em>Neuroimage</em> 31 (2): 477–81.
</div>
<div id="ref-pmid31272327" class="csl-entry">
Phan, T. G., N. Krishnadas, V. W. Y. Lai, M. Batt, L. A. Slater, R. V. Chandra, V. Srikanth, and H. Ma. 2019. <span>“<span class="nocase"><span>M</span>eta-<span>A</span>nalysis of <span>A</span>ccuracy of the <span>S</span>pot <span>S</span>ign for <span>P</span>redicting <span>H</span>ematoma <span>G</span>rowth and <span>C</span>linical <span>O</span>utcomes</span>.”</span> <em>Stroke</em> 50 (8): 2030–36.
</div>
<div id="ref-pmid16168343" class="csl-entry">
Reitsma, J. B., A. S. Glas, A. W. Rutjes, R. J. Scholten, P. M. Bossuyt, and A. H. Zwinderman. 2005. <span>“<span class="nocase"><span>B</span>ivariate analysis of sensitivity and specificity produces informative summary measures in diagnostic reviews</span>.”</span> <em>J Clin Epidemiol</em> 58 (10): 982–90.
</div>
<div id="ref-pmid26080338" class="csl-entry">
Salminen, P., H. Paajanen, T. Rautio, P. Nordstrom, M. Aarnio, T. Rantanen, R. Tuominen, et al. 2015. <span>“<span class="nocase"><span>A</span>ntibiotic <span>T</span>herapy vs <span>A</span>ppendectomy for <span>T</span>reatment of <span>U</span>ncomplicated <span>A</span>cute <span>A</span>ppendicitis: <span>T</span>he <span>A</span><span>P</span><span>P</span><span>A</span><span>C</span> <span>R</span>andomized <span>C</span>linical <span>T</span>rial</span>.”</span> <em>JAMA</em> 313 (23): 2340–48.
</div>
<div id="ref-pmid37161735" class="csl-entry">
Shi, Jiandong, Dehui Luo, Xiang Wan, Yue Liu, Jiming Liu, Zhaoxiang Bian, and Tiejun Tong. 2023. <span>“Detecting the Skewness of Data from the Five-Number Summary and Its Application in Meta-Analysis.”</span> <em>Statistical Methods in Medical Research</em> 32 (7): 1338–60. <a href="https://doi.org/10.1177/09622802231172043">https://doi.org/10.1177/09622802231172043</a>.
</div>
<div id="ref-doi10.1001/jamaneurol.2020.0678" class="csl-entry">
Signori, Alessio, Fabio Pellegrini, Francesca Bovis, Luca Carmisciano, Carl de Moor, and Maria Pia Sormani. 2020. <span>“<span class="nocase">Comparison of Placebos and Propensity Score Adjustment in Multiple Sclerosis Nonrandomized Studies</span>.”</span> <em>JAMA Neurology</em>, April. <a href="https://doi.org/10.1001/jamaneurol.2020.0678">https://doi.org/10.1001/jamaneurol.2020.0678</a>.
</div>
<div id="ref-pmid10356018" class="csl-entry">
Smeeth, A. Ebrahim, L. Haines. 1999. <span>“<span class="nocase">Numbers needed to treat derived from meta-analyses–sometimes informative, usually misleading</span>.”</span> <em>BMJ</em> 318: 1548–51. <a href="https://doi.org/10.1136/bmj.318.7197.1548">https://doi.org/10.1136/bmj.318.7197.1548</a>.
</div>
<div id="ref-pmid32167523" class="csl-entry">
Stensrud, M. J., and M. A. Hernan. 2020. <span>“<span class="nocase"><span>W</span>hy <span>T</span>est for <span>P</span>roportional <span>H</span>azards?</span>”</span> <em>JAMA</em>, March.
</div>
<div id="ref-pmid1143310" class="csl-entry">
TJ, Fagan. 1975. <span>“Nomogram for Bayes’s Theorem.”</span> <em>N Engl J Med</em> 293 (July): 257. <a href="https://doi.org/10.1056/NEJM197507312930513">https://doi.org/10.1056/NEJM197507312930513</a>.
</div>
<div id="ref-pmid28693043" class="csl-entry">
VanderWeele TJ, Ding P. 2017. <span>“Sensitivity Analysis in Observational Research: Introducing the e-Value.”</span> <em>Ann Intern Med</em> 167 (August): 268–74. <a href="https://doi.org/10.7326/M16-2607">https://doi.org/10.7326/M16-2607</a>.
</div>
<div id="ref-JSSv036i03" class="csl-entry">
Viechtbauer, Wolfgang. 2010. <span>“Conducting Meta-Analyses in r with the Metafor Package.”</span> <em>Journal of Statistical Software</em> 36 (3): 1–48. <a href="https://doi.org/10.18637/jss.v036.i03">https://doi.org/10.18637/jss.v036.i03</a>.
</div>
<div id="ref-pmid25524443" class="csl-entry">
Wan, Wang, X. 2014. <span>“Estimating the Sample Mean and Standard Deviation from the Sample Size, Median, Range and/or Interquartile Range.”</span> <em>BMC Med Res Methodol</em>, December. https://doi.org/<a href="https://doi.org/10.1186/1471-2288-14-135">https://doi.org/10.1186/1471-2288-14-135</a>.
</div>
<div id="ref-doi:10.1056/NEJMsr077003" class="csl-entry">
Wang, Rui, Stephen W. Lagakos, James H. Ware, David J. Hunter, and Jeffrey M. Drazen. 2007. <span>“Statistics in Medicine — Reporting of Subgroup Analyses in Clinical Trials.”</span> <em>New England Journal of Medicine</em> 357 (21): 2189–94. <a href="https://doi.org/10.1056/NEJMsr077003">https://doi.org/10.1056/NEJMsr077003</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-wrangling.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multivariate-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/03-Statistics.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Applications-of-R-in-Healthcare.pdf", "Applications-of-R-in-Healthcare.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
