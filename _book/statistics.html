<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Statistics | Applications of R in Healthcare</title>
  <meta name="description" content="This is a book describing the use of R in Healthcare. It is aimed at beginners of R language. The majority of the examples are taken from works in Neurology. Where possible data from other disease such as heart disease, cancer and vaccine are used. The ideas and principles can be applied to other aspects of Healthcare. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Statistics | Applications of R in Healthcare" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a book describing the use of R in Healthcare. It is aimed at beginners of R language. The majority of the examples are taken from works in Neurology. Where possible data from other disease such as heart disease, cancer and vaccine are used. The ideas and principles can be applied to other aspects of Healthcare. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="GNtem2/HealthcareRbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Statistics | Applications of R in Healthcare" />
  
  <meta name="twitter:description" content="This is a book describing the use of R in Healthcare. It is aimed at beginners of R language. The majority of the examples are taken from works in Neurology. Where possible data from other disease such as heart disease, cancer and vaccine are used. The ideas and principles can be applied to other aspects of Healthcare. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Thanh Phan" />


<meta name="date" content="2024-02-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-wrangling.html"/>
<link rel="next" href="multivariate-analysis.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.10/grViz.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applications-of-R-in-Healthcare</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preamble</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#plot-using-base-r"><i class="fa fa-check"></i><b>2.1</b> Plot using base R</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#ggplot2"><i class="fa fa-check"></i><b>2.2</b> ggplot2</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#histogram"><i class="fa fa-check"></i><b>2.2.1</b> Histogram</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#bar-plot"><i class="fa fa-check"></i><b>2.2.2</b> Bar plot</a></li>
<li class="chapter" data-level="2.2.3" data-path="intro.html"><a href="intro.html#pie-chart"><i class="fa fa-check"></i><b>2.2.3</b> Pie chart</a></li>
<li class="chapter" data-level="2.2.4" data-path="intro.html"><a href="intro.html#scatter-plot"><i class="fa fa-check"></i><b>2.2.4</b> Scatter plot</a></li>
<li class="chapter" data-level="2.2.5" data-path="intro.html"><a href="intro.html#arrange-plot-in-grids"><i class="fa fa-check"></i><b>2.2.5</b> arrange plot in grids</a></li>
<li class="chapter" data-level="2.2.6" data-path="intro.html"><a href="intro.html#line-plot"><i class="fa fa-check"></i><b>2.2.6</b> Line plot</a></li>
<li class="chapter" data-level="2.2.7" data-path="intro.html"><a href="intro.html#facet-wrap"><i class="fa fa-check"></i><b>2.2.7</b> Facet wrap</a></li>
<li class="chapter" data-level="2.2.8" data-path="intro.html"><a href="intro.html#polygons"><i class="fa fa-check"></i><b>2.2.8</b> Polygons</a></li>
<li class="chapter" data-level="2.2.9" data-path="intro.html"><a href="intro.html#gantt-chart"><i class="fa fa-check"></i><b>2.2.9</b> Gantt chart</a></li>
<li class="chapter" data-level="2.2.10" data-path="intro.html"><a href="intro.html#heatmap"><i class="fa fa-check"></i><b>2.2.10</b> Heatmap</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#ggplot2-extra"><i class="fa fa-check"></i><b>2.3</b> ggplot2 extra</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#alluvial-and-sankey-diagram"><i class="fa fa-check"></i><b>2.3.1</b> Alluvial and Sankey diagram</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro.html"><a href="intro.html#survival-plot"><i class="fa fa-check"></i><b>2.3.2</b> Survival plot</a></li>
<li class="chapter" data-level="2.3.3" data-path="intro.html"><a href="intro.html#ggraph-and-tidygraph"><i class="fa fa-check"></i><b>2.3.3</b> ggraph and tidygraph</a></li>
<li class="chapter" data-level="2.3.4" data-path="intro.html"><a href="intro.html#ggparty-decision-tree"><i class="fa fa-check"></i><b>2.3.4</b> ggparty-decision tree</a></li>
<li class="chapter" data-level="2.3.5" data-path="intro.html"><a href="intro.html#map"><i class="fa fa-check"></i><b>2.3.5</b> Map</a></li>
<li class="chapter" data-level="2.3.6" data-path="intro.html"><a href="intro.html#ggwordcloud"><i class="fa fa-check"></i><b>2.3.6</b> ggwordcloud</a></li>
<li class="chapter" data-level="2.3.7" data-path="intro.html"><a href="intro.html#gganimate"><i class="fa fa-check"></i><b>2.3.7</b> gganimate</a></li>
<li class="chapter" data-level="2.3.8" data-path="intro.html"><a href="intro.html#ggneuro"><i class="fa fa-check"></i><b>2.3.8</b> ggneuro</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#plotly"><i class="fa fa-check"></i><b>2.4</b> plotly</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="intro.html"><a href="intro.html#scatter-plot-with-plotly"><i class="fa fa-check"></i><b>2.4.1</b> Scatter plot with plotly</a></li>
<li class="chapter" data-level="2.4.2" data-path="intro.html"><a href="intro.html#bar-plot-with-plotly"><i class="fa fa-check"></i><b>2.4.2</b> Bar plot with plotly</a></li>
<li class="chapter" data-level="2.4.3" data-path="intro.html"><a href="intro.html#heatmap-1"><i class="fa fa-check"></i><b>2.4.3</b> Heatmap</a></li>
<li class="chapter" data-level="2.4.4" data-path="intro.html"><a href="intro.html#map-1"><i class="fa fa-check"></i><b>2.4.4</b> map</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>3</b> Data Wrangling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-wrangling.html"><a href="data-wrangling.html#data"><i class="fa fa-check"></i><b>3.1</b> Data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="data-wrangling.html"><a href="data-wrangling.html#vector-arrays-matrix"><i class="fa fa-check"></i><b>3.1.1</b> Vector, Arrays, Matrix</a></li>
<li class="chapter" data-level="3.1.2" data-path="data-wrangling.html"><a href="data-wrangling.html#operators"><i class="fa fa-check"></i><b>3.1.2</b> Operators</a></li>
<li class="chapter" data-level="3.1.3" data-path="data-wrangling.html"><a href="data-wrangling.html#simple-function"><i class="fa fa-check"></i><b>3.1.3</b> Simple function</a></li>
<li class="chapter" data-level="3.1.4" data-path="data-wrangling.html"><a href="data-wrangling.html#for-loop"><i class="fa fa-check"></i><b>3.1.4</b> for loop</a></li>
<li class="chapter" data-level="3.1.5" data-path="data-wrangling.html"><a href="data-wrangling.html#apply-lapply-sapply"><i class="fa fa-check"></i><b>3.1.5</b> apply, lapply, sapply</a></li>
<li class="chapter" data-level="3.1.6" data-path="data-wrangling.html"><a href="data-wrangling.html#functional"><i class="fa fa-check"></i><b>3.1.6</b> Functional</a></li>
<li class="chapter" data-level="3.1.7" data-path="data-wrangling.html"><a href="data-wrangling.html#iteration"><i class="fa fa-check"></i><b>3.1.7</b> Iteration</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-wrangling.html"><a href="data-wrangling.html#data-storage"><i class="fa fa-check"></i><b>3.2</b> Data storage</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-wrangling.html"><a href="data-wrangling.html#data-frame"><i class="fa fa-check"></i><b>3.2.1</b> Data frame</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-wrangling.html"><a href="data-wrangling.html#excel-data"><i class="fa fa-check"></i><b>3.2.2</b> Excel data</a></li>
<li class="chapter" data-level="3.2.3" data-path="data-wrangling.html"><a href="data-wrangling.html#foreign-data"><i class="fa fa-check"></i><b>3.2.3</b> Foreign data</a></li>
<li class="chapter" data-level="3.2.4" data-path="data-wrangling.html"><a href="data-wrangling.html#json-format"><i class="fa fa-check"></i><b>3.2.4</b> json format</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-wrangling.html"><a href="data-wrangling.html#tidy-data"><i class="fa fa-check"></i><b>3.3</b> Tidy data</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-wrangling.html"><a href="data-wrangling.html#factors"><i class="fa fa-check"></i><b>3.3.1</b> Factors</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-wrangling.html"><a href="data-wrangling.html#multiple-files"><i class="fa fa-check"></i><b>3.3.2</b> Multiple files</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-wrangling.html"><a href="data-wrangling.html#tidy-evaluation"><i class="fa fa-check"></i><b>3.3.3</b> Tidy evaluation</a></li>
<li class="chapter" data-level="3.3.4" data-path="data-wrangling.html"><a href="data-wrangling.html#pivot-wide-and-long"><i class="fa fa-check"></i><b>3.3.4</b> Pivot wide and long</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-wrangling.html"><a href="data-wrangling.html#regular-expressions"><i class="fa fa-check"></i><b>3.4</b> Regular Expressions</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="data-wrangling.html"><a href="data-wrangling.html#base-r"><i class="fa fa-check"></i><b>3.4.1</b> base R</a></li>
<li class="chapter" data-level="3.4.2" data-path="data-wrangling.html"><a href="data-wrangling.html#stringr"><i class="fa fa-check"></i><b>3.4.2</b> stringr</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="data-wrangling.html"><a href="data-wrangling.html#pdf-to-xcel"><i class="fa fa-check"></i><b>3.5</b> PDF to xcel</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="data-wrangling.html"><a href="data-wrangling.html#scanned-text-or-picture"><i class="fa fa-check"></i><b>3.5.1</b> Scanned text or picture</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="data-wrangling.html"><a href="data-wrangling.html#web-scraping"><i class="fa fa-check"></i><b>3.6</b> Web scraping</a></li>
<li class="chapter" data-level="3.7" data-path="data-wrangling.html"><a href="data-wrangling.html#medical-images"><i class="fa fa-check"></i><b>3.7</b> Medical Images</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="data-wrangling.html"><a href="data-wrangling.html#dicom-and-nifti-format"><i class="fa fa-check"></i><b>3.7.1</b> DICOM and nifti format</a></li>
<li class="chapter" data-level="3.7.2" data-path="data-wrangling.html"><a href="data-wrangling.html#manipulating-array-of-medical-images"><i class="fa fa-check"></i><b>3.7.2</b> Manipulating array of medical images</a></li>
<li class="chapter" data-level="3.7.3" data-path="data-wrangling.html"><a href="data-wrangling.html#combining-arrays"><i class="fa fa-check"></i><b>3.7.3</b> Combining arrays</a></li>
<li class="chapter" data-level="3.7.4" data-path="data-wrangling.html"><a href="data-wrangling.html#math-operation-on-multidimensional-array"><i class="fa fa-check"></i><b>3.7.4</b> Math operation on multidimensional array</a></li>
<li class="chapter" data-level="3.7.5" data-path="data-wrangling.html"><a href="data-wrangling.html#math-operation-on-list"><i class="fa fa-check"></i><b>3.7.5</b> Math operation on list</a></li>
<li class="chapter" data-level="3.7.6" data-path="data-wrangling.html"><a href="data-wrangling.html#vectorising-nifti-object"><i class="fa fa-check"></i><b>3.7.6</b> Vectorising nifti object</a></li>
<li class="chapter" data-level="3.7.7" data-path="data-wrangling.html"><a href="data-wrangling.html#tar-file"><i class="fa fa-check"></i><b>3.7.7</b> tar file</a></li>
<li class="chapter" data-level="3.7.8" data-path="data-wrangling.html"><a href="data-wrangling.html#image-registration"><i class="fa fa-check"></i><b>3.7.8</b> Image registration</a></li>
<li class="chapter" data-level="3.7.9" data-path="data-wrangling.html"><a href="data-wrangling.html#rescaling"><i class="fa fa-check"></i><b>3.7.9</b> Rescaling</a></li>
<li class="chapter" data-level="3.7.10" data-path="data-wrangling.html"><a href="data-wrangling.html#mni-template"><i class="fa fa-check"></i><b>3.7.10</b> MNI template</a></li>
<li class="chapter" data-level="3.7.11" data-path="data-wrangling.html"><a href="data-wrangling.html#atlases"><i class="fa fa-check"></i><b>3.7.11</b> Atlases</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="data-wrangling.html"><a href="data-wrangling.html#ecg-signal-processing"><i class="fa fa-check"></i><b>3.8</b> ECG Signal processing</a></li>
<li class="chapter" data-level="3.9" data-path="data-wrangling.html"><a href="data-wrangling.html#eeg-signal-processing"><i class="fa fa-check"></i><b>3.9</b> EEG signal processing</a></li>
<li class="chapter" data-level="3.10" data-path="data-wrangling.html"><a href="data-wrangling.html#python"><i class="fa fa-check"></i><b>3.10</b> Python</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="data-wrangling.html"><a href="data-wrangling.html#reticulate"><i class="fa fa-check"></i><b>3.10.1</b> Reticulate</a></li>
<li class="chapter" data-level="3.10.2" data-path="data-wrangling.html"><a href="data-wrangling.html#minconda"><i class="fa fa-check"></i><b>3.10.2</b> Minconda</a></li>
<li class="chapter" data-level="3.10.3" data-path="data-wrangling.html"><a href="data-wrangling.html#python-environment"><i class="fa fa-check"></i><b>3.10.3</b> Python environment</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="data-wrangling.html"><a href="data-wrangling.html#matlab"><i class="fa fa-check"></i><b>3.11</b> Matlab</a></li>
<li class="chapter" data-level="3.12" data-path="data-wrangling.html"><a href="data-wrangling.html#stata"><i class="fa fa-check"></i><b>3.12</b> Stata</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>4</b> Statistics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="statistics.html"><a href="statistics.html#univariable-analyses"><i class="fa fa-check"></i><b>4.1</b> Univariable analyses</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="statistics.html"><a href="statistics.html#parametric-tests"><i class="fa fa-check"></i><b>4.1.1</b> Parametric tests</a></li>
<li class="chapter" data-level="4.1.2" data-path="statistics.html"><a href="statistics.html#non-parametric-tests"><i class="fa fa-check"></i><b>4.1.2</b> Non-parametric tests</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="statistics.html"><a href="statistics.html#regression"><i class="fa fa-check"></i><b>4.2</b> Regression</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="statistics.html"><a href="statistics.html#brief-review-of-matrix"><i class="fa fa-check"></i><b>4.2.1</b> Brief review of matrix</a></li>
<li class="chapter" data-level="4.2.2" data-path="statistics.html"><a href="statistics.html#linear-least-square-regression"><i class="fa fa-check"></i><b>4.2.2</b> Linear (least square) regression</a></li>
<li class="chapter" data-level="4.2.3" data-path="statistics.html"><a href="statistics.html#logistic-regression"><i class="fa fa-check"></i><b>4.2.3</b> Logistic regression</a></li>
<li class="chapter" data-level="4.2.4" data-path="statistics.html"><a href="statistics.html#discrimination-and-calibration"><i class="fa fa-check"></i><b>4.2.4</b> Discrimination and Calibration</a></li>
<li class="chapter" data-level="4.2.5" data-path="statistics.html"><a href="statistics.html#interaction"><i class="fa fa-check"></i><b>4.2.5</b> Interaction</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="statistics.html"><a href="statistics.html#confounder"><i class="fa fa-check"></i><b>4.3</b> Confounder</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="statistics.html"><a href="statistics.html#confounder-weighted-model"><i class="fa fa-check"></i><b>4.3.1</b> Confounder weighted model</a></li>
<li class="chapter" data-level="4.3.2" data-path="statistics.html"><a href="statistics.html#propensity-matching"><i class="fa fa-check"></i><b>4.3.2</b> Propensity matching</a></li>
<li class="chapter" data-level="4.3.3" data-path="statistics.html"><a href="statistics.html#e-values"><i class="fa fa-check"></i><b>4.3.3</b> E-values</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="statistics.html"><a href="statistics.html#causal-inference"><i class="fa fa-check"></i><b>4.4</b> Causal inference</a></li>
<li class="chapter" data-level="4.5" data-path="statistics.html"><a href="statistics.html#special-types-of-regression"><i class="fa fa-check"></i><b>4.5</b> Special types of regression</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="statistics.html"><a href="statistics.html#ordinal-regression"><i class="fa fa-check"></i><b>4.5.1</b> Ordinal regression</a></li>
<li class="chapter" data-level="4.5.2" data-path="statistics.html"><a href="statistics.html#survival-analysis"><i class="fa fa-check"></i><b>4.5.2</b> Survival analysis</a></li>
<li class="chapter" data-level="4.5.3" data-path="statistics.html"><a href="statistics.html#quantile-regression"><i class="fa fa-check"></i><b>4.5.3</b> Quantile regression</a></li>
<li class="chapter" data-level="4.5.4" data-path="statistics.html"><a href="statistics.html#non-negative-regression"><i class="fa fa-check"></i><b>4.5.4</b> Non-negative regression</a></li>
<li class="chapter" data-level="4.5.5" data-path="statistics.html"><a href="statistics.html#poisson-regression"><i class="fa fa-check"></i><b>4.5.5</b> Poisson regression</a></li>
<li class="chapter" data-level="4.5.6" data-path="statistics.html"><a href="statistics.html#conditional-logistic-regression"><i class="fa fa-check"></i><b>4.5.6</b> Conditional logistic regression</a></li>
<li class="chapter" data-level="4.5.7" data-path="statistics.html"><a href="statistics.html#multinomial-modelling"><i class="fa fa-check"></i><b>4.5.7</b> Multinomial modelling</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="statistics.html"><a href="statistics.html#sample-size-estimation"><i class="fa fa-check"></i><b>4.6</b> Sample size estimation</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="statistics.html"><a href="statistics.html#proportion"><i class="fa fa-check"></i><b>4.6.1</b> Proportion</a></li>
<li class="chapter" data-level="4.6.2" data-path="statistics.html"><a href="statistics.html#logistic-regression-1"><i class="fa fa-check"></i><b>4.6.2</b> Logistic regression</a></li>
<li class="chapter" data-level="4.6.3" data-path="statistics.html"><a href="statistics.html#survival-studies"><i class="fa fa-check"></i><b>4.6.3</b> Survival studies</a></li>
<li class="chapter" data-level="4.6.4" data-path="statistics.html"><a href="statistics.html#multiple-regression"><i class="fa fa-check"></i><b>4.6.4</b> Multiple regression</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="statistics.html"><a href="statistics.html#randomised-clinical-trials"><i class="fa fa-check"></i><b>4.7</b> Randomised clinical trials</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="statistics.html"><a href="statistics.html#covariate-adjustment-in-trials"><i class="fa fa-check"></i><b>4.7.1</b> Covariate adjustment in trials</a></li>
<li class="chapter" data-level="4.7.2" data-path="statistics.html"><a href="statistics.html#subgroup-analysis"><i class="fa fa-check"></i><b>4.7.2</b> Subgroup analysis</a></li>
<li class="chapter" data-level="4.7.3" data-path="statistics.html"><a href="statistics.html#p-value-for-interaction"><i class="fa fa-check"></i><b>4.7.3</b> p value for interaction</a></li>
<li class="chapter" data-level="4.7.4" data-path="statistics.html"><a href="statistics.html#interpreting-risk-reduction-in-clinical-trials"><i class="fa fa-check"></i><b>4.7.4</b> Interpreting risk reduction in clinical trials</a></li>
<li class="chapter" data-level="4.7.5" data-path="statistics.html"><a href="statistics.html#nnt-from-arr"><i class="fa fa-check"></i><b>4.7.5</b> NNT from ARR</a></li>
<li class="chapter" data-level="4.7.6" data-path="statistics.html"><a href="statistics.html#nnt-from-odds-ratio"><i class="fa fa-check"></i><b>4.7.6</b> NNT from odds ratio</a></li>
<li class="chapter" data-level="4.7.7" data-path="statistics.html"><a href="statistics.html#nnt-from-risk-ratio"><i class="fa fa-check"></i><b>4.7.7</b> NNT from risk ratio</a></li>
<li class="chapter" data-level="4.7.8" data-path="statistics.html"><a href="statistics.html#nnt-from-hazard-ratio"><i class="fa fa-check"></i><b>4.7.8</b> NNT from hazard ratio</a></li>
<li class="chapter" data-level="4.7.9" data-path="statistics.html"><a href="statistics.html#nnt-from-metaananlysis"><i class="fa fa-check"></i><b>4.7.9</b> NNT from metaananlysis</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="statistics.html"><a href="statistics.html#diagnostic-test"><i class="fa fa-check"></i><b>4.8</b> Diagnostic test</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="statistics.html"><a href="statistics.html#sensitivity-specificity"><i class="fa fa-check"></i><b>4.8.1</b> Sensitivity, specificity</a></li>
<li class="chapter" data-level="4.8.2" data-path="statistics.html"><a href="statistics.html#auc"><i class="fa fa-check"></i><b>4.8.2</b> AUC</a></li>
<li class="chapter" data-level="4.8.3" data-path="statistics.html"><a href="statistics.html#likelihood-ratio"><i class="fa fa-check"></i><b>4.8.3</b> Likelihood ratio</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="statistics.html"><a href="statistics.html#metaanalysis"><i class="fa fa-check"></i><b>4.9</b> Metaanalysis</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="statistics.html"><a href="statistics.html#quality-of-study"><i class="fa fa-check"></i><b>4.9.1</b> Quality of study</a></li>
<li class="chapter" data-level="4.9.2" data-path="statistics.html"><a href="statistics.html#prisma"><i class="fa fa-check"></i><b>4.9.2</b> PRISMA</a></li>
<li class="chapter" data-level="4.9.3" data-path="statistics.html"><a href="statistics.html#conversion-of-median-to-mean"><i class="fa fa-check"></i><b>4.9.3</b> Conversion of median to mean</a></li>
<li class="chapter" data-level="4.9.4" data-path="statistics.html"><a href="statistics.html#inconsistency-i2"><i class="fa fa-check"></i><b>4.9.4</b> Inconsistency I2</a></li>
<li class="chapter" data-level="4.9.5" data-path="statistics.html"><a href="statistics.html#metaanalysis-of-proportion"><i class="fa fa-check"></i><b>4.9.5</b> Metaanalysis of proportion</a></li>
<li class="chapter" data-level="4.9.6" data-path="statistics.html"><a href="statistics.html#metaanalysis-of-continuous-data"><i class="fa fa-check"></i><b>4.9.6</b> Metaanalysis of continuous data</a></li>
<li class="chapter" data-level="4.9.7" data-path="statistics.html"><a href="statistics.html#bivariate-metaanalysis"><i class="fa fa-check"></i><b>4.9.7</b> Bivariate Metaanalysis</a></li>
<li class="chapter" data-level="4.9.8" data-path="statistics.html"><a href="statistics.html#metaanalysis-of-clinical-trial."><i class="fa fa-check"></i><b>4.9.8</b> Metaanalysis of clinical trial.</a></li>
<li class="chapter" data-level="4.9.9" data-path="statistics.html"><a href="statistics.html#metaregression"><i class="fa fa-check"></i><b>4.9.9</b> Metaregression</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="statistics.html"><a href="statistics.html#data-simulation"><i class="fa fa-check"></i><b>4.10</b> Data simulation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html"><i class="fa fa-check"></i><b>5</b> Multivariate Analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#multivariate-regression"><i class="fa fa-check"></i><b>5.1</b> Multivariate regression</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#penalised-regression"><i class="fa fa-check"></i><b>5.1.1</b> Penalised regression</a></li>
<li class="chapter" data-level="5.1.2" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#mars"><i class="fa fa-check"></i><b>5.1.2</b> MARS</a></li>
<li class="chapter" data-level="5.1.3" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#mixed-modelling"><i class="fa fa-check"></i><b>5.1.3</b> Mixed modelling</a></li>
<li class="chapter" data-level="5.1.4" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#trajectory-modelling"><i class="fa fa-check"></i><b>5.1.4</b> Trajectory modelling</a></li>
<li class="chapter" data-level="5.1.5" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#generalized-estimating-equation-gee"><i class="fa fa-check"></i><b>5.1.5</b> Generalized estimating equation (GEE)</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#principal-component-analysis"><i class="fa fa-check"></i><b>5.2</b> Principal component analysis</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#pca-with-mri"><i class="fa fa-check"></i><b>5.2.1</b> PCA with MRI</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#independent-component-analysis"><i class="fa fa-check"></i><b>5.3</b> Independent component analysis</a></li>
<li class="chapter" data-level="5.4" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#partial-least-squares"><i class="fa fa-check"></i><b>5.4</b> Partial least squares</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="machine-learning.html"><a href="machine-learning.html"><i class="fa fa-check"></i><b>6</b> Machine learning</a>
<ul>
<li class="chapter" data-level="6.1" data-path="machine-learning.html"><a href="machine-learning.html#decision-tree-analysis"><i class="fa fa-check"></i><b>6.1</b> Decision tree analysis</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="machine-learning.html"><a href="machine-learning.html#information-theory-driven"><i class="fa fa-check"></i><b>6.1.1</b> Information theory driven</a></li>
<li class="chapter" data-level="6.1.2" data-path="machine-learning.html"><a href="machine-learning.html#conditional-decision-tree"><i class="fa fa-check"></i><b>6.1.2</b> Conditional decision tree</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="machine-learning.html"><a href="machine-learning.html#ensemble-tree-methods"><i class="fa fa-check"></i><b>6.2</b> Ensemble tree methods</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="machine-learning.html"><a href="machine-learning.html#bagging-trees"><i class="fa fa-check"></i><b>6.2.1</b> Bagging trees</a></li>
<li class="chapter" data-level="6.2.2" data-path="machine-learning.html"><a href="machine-learning.html#boosting-trees"><i class="fa fa-check"></i><b>6.2.2</b> Boosting trees</a></li>
<li class="chapter" data-level="6.2.3" data-path="machine-learning.html"><a href="machine-learning.html#bayesian-trees-method"><i class="fa fa-check"></i><b>6.2.3</b> Bayesian trees method</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="machine-learning.html"><a href="machine-learning.html#knn"><i class="fa fa-check"></i><b>6.3</b> KNN</a></li>
<li class="chapter" data-level="6.4" data-path="machine-learning.html"><a href="machine-learning.html#support-vector-machine"><i class="fa fa-check"></i><b>6.4</b> Support vector machine</a></li>
<li class="chapter" data-level="6.5" data-path="machine-learning.html"><a href="machine-learning.html#non-negative-matrix-factorisation"><i class="fa fa-check"></i><b>6.5</b> Non-negative matrix factorisation</a></li>
<li class="chapter" data-level="6.6" data-path="machine-learning.html"><a href="machine-learning.html#formal-concept-analysis"><i class="fa fa-check"></i><b>6.6</b> Formal concept analysis</a></li>
<li class="chapter" data-level="6.7" data-path="machine-learning.html"><a href="machine-learning.html#evolutionary-algorithm"><i class="fa fa-check"></i><b>6.7</b> Evolutionary Algorithm</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="machine-learning.html"><a href="machine-learning.html#simulated-annealing"><i class="fa fa-check"></i><b>6.7.1</b> Simulated Annealing</a></li>
<li class="chapter" data-level="6.7.2" data-path="machine-learning.html"><a href="machine-learning.html#genetic-algorithm"><i class="fa fa-check"></i><b>6.7.2</b> Genetic Algorithm</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="machine-learning.html"><a href="machine-learning.html#manifold-learning"><i class="fa fa-check"></i><b>6.8</b> Manifold learning</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="machine-learning.html"><a href="machine-learning.html#t-stochastic-neighbourhood-embedding"><i class="fa fa-check"></i><b>6.8.1</b> T-Stochastic Neighbourhood Embedding</a></li>
<li class="chapter" data-level="6.8.2" data-path="machine-learning.html"><a href="machine-learning.html#self-organising-map"><i class="fa fa-check"></i><b>6.8.2</b> Self organising map</a></li>
<li class="chapter" data-level="6.8.3" data-path="machine-learning.html"><a href="machine-learning.html#multidimensional-scaling"><i class="fa fa-check"></i><b>6.8.3</b> Multidimensional scaling</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="machine-learning.html"><a href="machine-learning.html#deep-learning"><i class="fa fa-check"></i><b>6.9</b> Deep learning</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="machine-learning.html"><a href="machine-learning.html#deep-neural-network"><i class="fa fa-check"></i><b>6.9.1</b> Deep neural network</a></li>
<li class="chapter" data-level="6.9.2" data-path="machine-learning.html"><a href="machine-learning.html#tabnet"><i class="fa fa-check"></i><b>6.9.2</b> Tabnet</a></li>
<li class="chapter" data-level="6.9.3" data-path="machine-learning.html"><a href="machine-learning.html#cnn"><i class="fa fa-check"></i><b>6.9.3</b> CNN</a></li>
<li class="chapter" data-level="6.9.4" data-path="machine-learning.html"><a href="machine-learning.html#rnn"><i class="fa fa-check"></i><b>6.9.4</b> RNN</a></li>
<li class="chapter" data-level="6.9.5" data-path="machine-learning.html"><a href="machine-learning.html#reinforcement-learning"><i class="fa fa-check"></i><b>6.9.5</b> Reinforcement learning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html"><i class="fa fa-check"></i><b>7</b> Machine Learning Part 2</a>
<ul>
<li class="chapter" data-level="7.1" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#bag-of-words"><i class="fa fa-check"></i><b>7.1</b> Bag of words</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#tfidf"><i class="fa fa-check"></i><b>7.1.1</b> TFIDF</a></li>
<li class="chapter" data-level="7.1.2" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#extracting-data-from-web"><i class="fa fa-check"></i><b>7.1.2</b> Extracting data from web</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#wordcloud"><i class="fa fa-check"></i><b>7.2</b> Wordcloud</a></li>
<li class="chapter" data-level="7.3" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#bigram-analysis"><i class="fa fa-check"></i><b>7.3</b> Bigram analysis</a></li>
<li class="chapter" data-level="7.4" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#trigram"><i class="fa fa-check"></i><b>7.4</b> Trigram</a></li>
<li class="chapter" data-level="7.5" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#topic-modeling-or-thematic-analysis"><i class="fa fa-check"></i><b>7.5</b> Topic modeling or thematic analysis</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#probabilistic-topic-model"><i class="fa fa-check"></i><b>7.5.1</b> Probabilistic topic model</a></li>
<li class="chapter" data-level="7.5.2" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#nmf"><i class="fa fa-check"></i><b>7.5.2</b> NMF</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html"><i class="fa fa-check"></i><b>8</b> Bayesian Analysis</a>
<ul>
<li class="chapter" data-level="8.1" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#baysian-belief"><i class="fa fa-check"></i><b>8.1</b> Baysian belief</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#conditional-probability"><i class="fa fa-check"></i><b>8.1.1</b> Conditional probability</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#markov-model"><i class="fa fa-check"></i><b>8.2</b> Markov model</a></li>
<li class="chapter" data-level="8.3" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#inla-stan-and-bugs"><i class="fa fa-check"></i><b>8.3</b> INLA, Stan and BUGS</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#linear-regression"><i class="fa fa-check"></i><b>8.3.1</b> Linear regression</a></li>
<li class="chapter" data-level="8.3.2" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#logistic-regression-2"><i class="fa fa-check"></i><b>8.3.2</b> Logistic regression</a></li>
<li class="chapter" data-level="8.3.3" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#mixed-model"><i class="fa fa-check"></i><b>8.3.3</b> Mixed model</a></li>
<li class="chapter" data-level="8.3.4" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#bayesian-metaanalysis"><i class="fa fa-check"></i><b>8.3.4</b> Bayesian Metaanalysis</a></li>
<li class="chapter" data-level="8.3.5" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#cost"><i class="fa fa-check"></i><b>8.3.5</b> Cost</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="operational-research.html"><a href="operational-research.html"><i class="fa fa-check"></i><b>9</b> Operational Research</a>
<ul>
<li class="chapter" data-level="9.1" data-path="operational-research.html"><a href="operational-research.html#queueing-theory"><i class="fa fa-check"></i><b>9.1</b> Queueing theory</a></li>
<li class="chapter" data-level="9.2" data-path="operational-research.html"><a href="operational-research.html#discrete-event-simulations"><i class="fa fa-check"></i><b>9.2</b> Discrete Event Simulations</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="operational-research.html"><a href="operational-research.html#simulate-capacity-of-system"><i class="fa fa-check"></i><b>9.2.1</b> Simulate capacity of system</a></li>
<li class="chapter" data-level="9.2.2" data-path="operational-research.html"><a href="operational-research.html#queuing-network"><i class="fa fa-check"></i><b>9.2.2</b> Queuing network</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="operational-research.html"><a href="operational-research.html#linear-programming"><i class="fa fa-check"></i><b>9.3</b> Linear Programming</a></li>
<li class="chapter" data-level="9.4" data-path="operational-research.html"><a href="operational-research.html#forecasting"><i class="fa fa-check"></i><b>9.4</b> Forecasting</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="operational-research.html"><a href="operational-research.html#bed-requirement"><i class="fa fa-check"></i><b>9.4.1</b> Bed requirement</a></li>
<li class="chapter" data-level="9.4.2" data-path="operational-research.html"><a href="operational-research.html#length-of-stay"><i class="fa fa-check"></i><b>9.4.2</b> Length of stay</a></li>
<li class="chapter" data-level="9.4.3" data-path="operational-research.html"><a href="operational-research.html#customer-churns"><i class="fa fa-check"></i><b>9.4.3</b> Customer churns</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="operational-research.html"><a href="operational-research.html#process-mapping"><i class="fa fa-check"></i><b>9.5</b> Process mapping</a></li>
<li class="chapter" data-level="9.6" data-path="operational-research.html"><a href="operational-research.html#supply-chains"><i class="fa fa-check"></i><b>9.6</b> Supply chains</a></li>
<li class="chapter" data-level="9.7" data-path="operational-research.html"><a href="operational-research.html#health-economics"><i class="fa fa-check"></i><b>9.7</b> Health economics</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="operational-research.html"><a href="operational-research.html#cost-1"><i class="fa fa-check"></i><b>9.7.1</b> Cost</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="graph-theory.html"><a href="graph-theory.html"><i class="fa fa-check"></i><b>10</b> Graph Theory</a>
<ul>
<li class="chapter" data-level="10.1" data-path="graph-theory.html"><a href="graph-theory.html#special-graphs"><i class="fa fa-check"></i><b>10.1</b> Special graphs</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="graph-theory.html"><a href="graph-theory.html#laplacian-matrix"><i class="fa fa-check"></i><b>10.1.1</b> Laplacian matrix</a></li>
<li class="chapter" data-level="10.1.2" data-path="graph-theory.html"><a href="graph-theory.html#bimodal-bipartite-graph"><i class="fa fa-check"></i><b>10.1.2</b> Bimodal (bipartite) graph</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="graph-theory.html"><a href="graph-theory.html#centrality-measures"><i class="fa fa-check"></i><b>10.2</b> Centrality Measures</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="graph-theory.html"><a href="graph-theory.html#local-centrality-measures"><i class="fa fa-check"></i><b>10.2.1</b> Local centrality measures</a></li>
<li class="chapter" data-level="10.2.2" data-path="graph-theory.html"><a href="graph-theory.html#global-centrality-measures"><i class="fa fa-check"></i><b>10.2.2</b> Global centrality measures</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="graph-theory.html"><a href="graph-theory.html#community"><i class="fa fa-check"></i><b>10.3</b> Community</a></li>
<li class="chapter" data-level="10.4" data-path="graph-theory.html"><a href="graph-theory.html#visualising-graph"><i class="fa fa-check"></i><b>10.4</b> Visualising graph</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="graph-theory.html"><a href="graph-theory.html#visnetwork"><i class="fa fa-check"></i><b>10.4.1</b> Visnetwork</a></li>
<li class="chapter" data-level="10.4.2" data-path="graph-theory.html"><a href="graph-theory.html#large-graph"><i class="fa fa-check"></i><b>10.4.2</b> Large graph</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="graph-theory.html"><a href="graph-theory.html#social-media-and-network-analysis"><i class="fa fa-check"></i><b>10.5</b> Social Media and Network Analysis</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="graph-theory.html"><a href="graph-theory.html#twitter"><i class="fa fa-check"></i><b>10.5.1</b> Twitter</a></li>
<li class="chapter" data-level="10.5.2" data-path="graph-theory.html"><a href="graph-theory.html#youtube"><i class="fa fa-check"></i><b>10.5.2</b> Youtube</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html"><i class="fa fa-check"></i><b>11</b> Geospatial analysis</a>
<ul>
<li class="chapter" data-level="11.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#geocoding"><i class="fa fa-check"></i><b>11.1</b> Geocoding</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#openstreetmap"><i class="fa fa-check"></i><b>11.1.1</b> OpenStreetMap</a></li>
<li class="chapter" data-level="11.1.2" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#google-maps-api"><i class="fa fa-check"></i><b>11.1.2</b> Google Maps API</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#sp-and-sf-objects"><i class="fa fa-check"></i><b>11.2</b> Sp and sf objects</a></li>
<li class="chapter" data-level="11.3" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#thematic-map-1"><i class="fa fa-check"></i><b>11.3</b> Thematic map</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#calculate-distance-to-hospital-openstreetmap"><i class="fa fa-check"></i><b>11.3.1</b> Calculate distance to Hospital-OpenStreetMap</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#spatial-regression"><i class="fa fa-check"></i><b>11.4</b> Spatial regression</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#new-york-covid-19-mortality"><i class="fa fa-check"></i><b>11.4.1</b> New York COVID-19 mortality</a></li>
<li class="chapter" data-level="11.4.2" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#danish-stroke-registry"><i class="fa fa-check"></i><b>11.4.2</b> Danish Stroke Registry</a></li>
<li class="chapter" data-level="11.4.3" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#inla"><i class="fa fa-check"></i><b>11.4.3</b> INLA</a></li>
<li class="chapter" data-level="11.4.4" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#stan"><i class="fa fa-check"></i><b>11.4.4</b> Stan</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#machine-learning-in-spatial-analysis"><i class="fa fa-check"></i><b>11.5</b> Machine learning in spatial analysis</a></li>
<li class="chapter" data-level="11.6" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#spatio-temporal-regression"><i class="fa fa-check"></i><b>11.6</b> Spatio-temporal regression</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="app.html"><a href="app.html"><i class="fa fa-check"></i><b>12</b> App</a>
<ul>
<li class="chapter" data-level="12.1" data-path="app.html"><a href="app.html#brief-introduction-to-shiny-app"><i class="fa fa-check"></i><b>12.1</b> Brief introduction to Shiny app</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>13</b> Appendix</a>
<ul>
<li class="chapter" data-level="13.1" data-path="appendix.html"><a href="appendix.html#brief-introduction-to-matrix"><i class="fa fa-check"></i><b>13.1</b> Brief introduction to Matrix</a></li>
<li class="chapter" data-level="13.2" data-path="appendix.html"><a href="appendix.html#regression-1"><i class="fa fa-check"></i><b>13.2</b> Regression</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="appendix.html"><a href="appendix.html#linear-regression-1"><i class="fa fa-check"></i><b>13.2.1</b> Linear regression</a></li>
<li class="chapter" data-level="13.2.2" data-path="appendix.html"><a href="appendix.html#logistic-regression-3"><i class="fa fa-check"></i><b>13.2.2</b> Logistic regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applications of R in Healthcare</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="statistics" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Statistics<a href="statistics.html#statistics" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This section is not intended as a textbook on statistics. Rather it demonstrates regression approaches that can be used including sample size estimation, R codes provided.</p>
<div id="univariable-analyses" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Univariable analyses<a href="statistics.html#univariable-analyses" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="parametric-tests" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Parametric tests<a href="statistics.html#parametric-tests" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>T-test is the workhorse for comparing if 2 datasets are have the same distribution. Performing t-test in R requires data from 2 columns: one
containing the variables for comparison and one to label the group. There are different forms of t-test depending on whether the two samples are paired or unpaired. In general, the analysis takes the form of <span class="math inline">\(t=\frac{\mu_1 - \mu_2}{variance}\)</span>. It is recommended to check the distribution of the data by using histogram. For this exercise, we will use the simulated data from ECR trials. The grouping variable is the trial assignment.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="statistics.html#cb1-1" tabindex="-1"></a><span class="co">#comparison of early neurological recovery (ENI) by tral (T)</span></span>
<span id="cb1-2"><a href="statistics.html#cb1-2" tabindex="-1"></a>dtTrial<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">&quot;./Data-Use/dtTrial_simulated.csv&quot;</span>)</span>
<span id="cb1-3"><a href="statistics.html#cb1-3" tabindex="-1"></a><span class="fu">t.test</span>(dtTrial<span class="sc">$</span>ENI<span class="sc">~</span>dtTrial<span class="sc">$</span>T)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  dtTrial$ENI by dtTrial$T
## t = 0.17454, df = 487.36, p-value = 0.8615
## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
## 95 percent confidence interval:
##  -0.04569535  0.05460540
## sample estimates:
## mean in group 0 mean in group 1 
##       0.3084644       0.3040094</code></pre>
</div>
<div id="non-parametric-tests" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Non-parametric tests<a href="statistics.html#non-parametric-tests" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Chi-squared and Fisher-exact tests can be done by using the <em>table</em> function for setting up the count data into 2 x 2 contingency table or confusion matrix. The formula for the Chi-squared test takes on a familiar form <span class="math inline">\(\chi^2=\frac{(observed-expected)^2}{expected}\)</span>. In this example we will use the data above.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="statistics.html#cb3-1" tabindex="-1"></a><span class="fu">table</span>(dtTrial<span class="sc">$</span>HT,dtTrial<span class="sc">$</span>T)</span></code></pre></div>
<pre><code>##    
##       0   1
##   0 112 101
##   1 144 143</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="statistics.html#cb5-1" tabindex="-1"></a><span class="fu">chisq.test</span>(dtTrial<span class="sc">$</span>HT,dtTrial<span class="sc">$</span>T)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  dtTrial$HT and dtTrial$T
## X-squared = 0.19553, df = 1, p-value = 0.6584</code></pre>
<p>The Wilcoxon rank sum test is performed with continuous data organised in the
same way as the t-test. There are several different approaches to performing Wilcoxon rank sum test. The <em>coin</em> package allows handling of ties.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="statistics.html#cb7-1" tabindex="-1"></a><span class="fu">library</span>(coin)</span></code></pre></div>
<pre><code>## Loading required package: survival</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="statistics.html#cb9-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(ENI<span class="sc">~</span>T, <span class="at">data=</span>dtTrial)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon rank sum test with continuity correction
## 
## data:  ENI by T
## W = 31159, p-value = 0.9642
## alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<div id="regression" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Regression<a href="statistics.html#regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are many different form of regression methods. A key principle is that the predictors are independent of each others. This issue will be expand on in the later in the section on collinearity. Special methods are required when the predictors are collinear.</p>
<div id="brief-review-of-matrix" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Brief review of matrix<a href="statistics.html#brief-review-of-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A vector is has length one. A matrix is an ordered array in 2 dimensions. A
tensor is an ordered array in 3 dimensions.</p>
<p>A matrix in which the columns are linearly related are said to be rank
deficient. The rank of a given matrix is an expression of the number of linearly independent columns of that matrix. Given that row rank and column rank are equivalent, rank deficiency of a matrix is expressed as the difference between
the lesser of the number of rows and columns, and the rank of the matrix.
A matrix with rank of 1 is likely to be linearly related.</p>
</div>
<div id="linear-least-square-regression" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Linear (least square) regression<a href="statistics.html#linear-least-square-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Least square regression uses the geometric properties of Euclidean geometry to identify the line of best. The sum of squares <span class="math inline">\(SSE\)</span> is <span class="math inline">\(\sum(observed-expected)^2\)</span>. The <span class="math inline">\(R^2\)</span> is a measure of the fit of the model. It
is given by <span class="math inline">\(1-\frac{SS_(res)}{SS_(total)}\)</span>. Low <span class="math inline">\(R^2\)</span> indicates a poorly fitted model and high <span class="math inline">\(R^2\)</span> indicates excellent fitting. The assumption here is that
the outcome variable is a continuous variable.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="statistics.html#cb11-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb11-2"><a href="statistics.html#cb11-2" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;./Data-Use/world_stroke.Rda&quot;</span>)</span>
<span id="cb11-3"><a href="statistics.html#cb11-3" tabindex="-1"></a></span>
<span id="cb11-4"><a href="statistics.html#cb11-4" tabindex="-1"></a><span class="fu">ggplot</span>(world_sfdf, <span class="fu">aes</span>(<span class="at">x=</span>LifeExpectancy,<span class="at">y=</span>MeanLifetimeRisk))<span class="sc">+</span></span>
<span id="cb11-5"><a href="statistics.html#cb11-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="fu">aes</span>(<span class="at">Group=</span>Income, <span class="at">linetype=</span>Income))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&quot;Life Expectancy&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-3-1.png" width="672" /></p>
</div>
<div id="logistic-regression" class="section level3 hasAnchor" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Logistic regression<a href="statistics.html#logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For outcome that are binary in nature such as yes or no, then least square regression is not appropriate. There are no close form solution for this
analysis and a numerical approach using maximum likelihood approach is needed. When examining the results of logistic regression one is often enchanted by the large odds ratio. It is important to look at the metrics of model calibration
(discussed below). A clue to a poorly calibrated model is the observation that
the width of the confidence interval for odds ratio is wide.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="statistics.html#cb13-1" tabindex="-1"></a><span class="co">#glm</span></span>
<span id="cb13-2"><a href="statistics.html#cb13-2" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;BreastCancer&quot;</span>,<span class="at">package =</span> <span class="st">&quot;mlbench&quot;</span>)</span>
<span id="cb13-3"><a href="statistics.html#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="statistics.html#cb13-4" tabindex="-1"></a><span class="co">#remove id column and column with NA to feed into iml later</span></span>
<span id="cb13-5"><a href="statistics.html#cb13-5" tabindex="-1"></a>BreastCancer2<span class="ot">&lt;-</span><span class="fu">lapply</span>(BreastCancer[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>)], as.numeric)</span>
<span id="cb13-6"><a href="statistics.html#cb13-6" tabindex="-1"></a>BreastCancer2<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(BreastCancer2)</span>
<span id="cb13-7"><a href="statistics.html#cb13-7" tabindex="-1"></a></span>
<span id="cb13-8"><a href="statistics.html#cb13-8" tabindex="-1"></a>DCa<span class="ot">&lt;-</span><span class="fu">glm</span>(Class<span class="sc">~</span>., <span class="at">data=</span>BreastCancer2)</span>
<span id="cb13-9"><a href="statistics.html#cb13-9" tabindex="-1"></a></span>
<span id="cb13-10"><a href="statistics.html#cb13-10" tabindex="-1"></a><span class="fu">summary</span>(DCa)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = Class ~ ., data = BreastCancer2)
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     0.723054   0.018613  38.847  &lt; 2e-16 ***
## Cl.thickness    0.042754   0.003992  10.709  &lt; 2e-16 ***
## Cell.size       0.019263   0.007293   2.641  0.00845 ** 
## Cell.shape      0.032217   0.007016   4.592 5.22e-06 ***
## Marg.adhesion   0.021463   0.004386   4.893 1.24e-06 ***
## Epith.c.size    0.011637   0.005965   1.951  0.05148 .  
## Bl.cromatin     0.035266   0.005650   6.241 7.57e-10 ***
## Normal.nucleoli 0.016928   0.004247   3.986 7.44e-05 ***
## Mitoses         0.001086   0.006048   0.180  0.85757    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for gaussian family taken to be 0.0481263)
## 
##     Null deviance: 157.908  on 698  degrees of freedom
## Residual deviance:  33.207  on 690  degrees of freedom
## AIC: -126.1
## 
## Number of Fisher Scoring iterations: 2</code></pre>
</div>
<div id="discrimination-and-calibration" class="section level3 hasAnchor" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> Discrimination and Calibration<a href="statistics.html#discrimination-and-calibration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A high _<span class="math inline">\(R^2\)</span> suggests that the linear regression model is well calibrated. This metric is often not displayed but should be sought when interpreting the data.</p>
<p>The areas under the receiver operating characteristic curve (AUC) is used to assess how well the models discriminate between those who have the disease and those who do not have the disease of interest. An AUC of 0.5 is classified as no better than by chance; 0.8 to 0.89 provides good (excellent) discrimination, and 0.9 to 1.0 provides outstanding discrimination. This rule of thumb about interpreting AUC when reading the literature is language the authors used to describe the AUC. This test of discrimination is not synonymous with calibration. It is possible to have a model with high discrimination but poor calibration <span class="citation">(<a href="#ref-pmid1738016">Diamond 1992</a>)</span>. The AUC is similar to Harrells c-index but the interpretation of difference in AUC and c-index between models is not straightforward. A difference in 0.1 of AUC correspond to the number of subject rank correctly. The c-index was originally described for survival analysis <span class="citation">(<a href="#ref-pmid7069920">Harrell FE Jr 1982</a>)</span>. Harrell described the c-index (concordance index) as estimating the probability that, of two randomly chosen patients, the patient with the higher prognostic score will outlive the patient with the lower prognostic score. As such the c-index should be interpreted as the number of concordant pairs relative to the total number of comparable pairs. It has been proposed that the AUC and c-index is not appropriate for survival analysis as they do not account for the dynamic nature of the data<span class="citation">(<a href="#ref-LONGATO2020103496">Longato, Vettoretti, and Di Camillo 2020</a>)</span>. The integrated Graf score has been proposed to account for difference in the estimated event-free survival probabilities with the actual outcome <span class="citation">(<a href="#ref-pmid10474158">Graf E 1999</a>)</span>.</p>
<p>Calibration of logistic regression model is performed using the HosmerLemeshow goodness-of-t test and the Nagelkerke generalized R2. A model is well
calibrated when the HosmerLemeshow goodness-of-t test shows no difference between observed and expected outcome or P value approaching 1. A high
generalized <span class="math inline">\(R^2\)</span> value suggests a well-calibrated regression model. Running regression through the <em>rms</em> or <em>PredictABEL</em> library provide these results. The generalized <span class="math inline">\(R^2\)</span> can be obtained manually from base R by running an intercept only model and again with covariates. It is given by <span class="math inline">\(1-\frac{L1}{L0}\)</span>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="statistics.html#cb15-1" tabindex="-1"></a><span class="co">#lrm on logistic regression analysis for Breast Cancer</span></span>
<span id="cb15-2"><a href="statistics.html#cb15-2" tabindex="-1"></a><span class="fu">library</span>(rms)</span></code></pre></div>
<pre><code>## Loading required package: Hmisc</code></pre>
<pre><code>## 
## Attaching package: &#39;Hmisc&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     format.pval, units</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="statistics.html#cb19-1" tabindex="-1"></a>DCa_rms<span class="ot">&lt;-</span><span class="fu">lrm</span>(Class<span class="sc">~</span>., <span class="at">data=</span>BreastCancer2)</span>
<span id="cb19-2"><a href="statistics.html#cb19-2" tabindex="-1"></a>DCa_rms</span></code></pre></div>
<pre><code>## Logistic Regression Model
## 
## lrm(formula = Class ~ ., data = BreastCancer2)
## 
##                        Model Likelihood      Discrimination    Rank Discrim.    
##                              Ratio Test             Indexes          Indexes    
## Obs           699    LR chi2     759.86      R2       0.915    C       0.993    
##  1            458    d.f.             8      R2(8,699)0.659    Dxy     0.986    
##  2            241    Pr(&gt; chi2) &lt;0.0001    R2(8,473.7)0.795    gamma   0.986    
## max |deriv| 8e-10                            Brier    0.028    tau-a   0.446    
## 
##                 Coef    S.E.   Wald Z Pr(&gt;|Z|)
## Intercept       -9.9477 1.0317 -9.64  &lt;0.0001 
## Cl.thickness     0.5776 0.1190  4.85  &lt;0.0001 
## Cell.size       -0.0115 0.1759 -0.07  0.9479  
## Cell.shape       0.5679 0.1913  2.97  0.0030  
## Marg.adhesion    0.3137 0.1004  3.13  0.0018  
## Epith.c.size     0.1306 0.1406  0.93  0.3529  
## Bl.cromatin      0.5800 0.1456  3.98  &lt;0.0001 
## Normal.nucleoli  0.1232 0.0987  1.25  0.2120  
## Mitoses          0.6092 0.3226  1.89  0.0590</code></pre>
<div id="measuring-improvement-in-regression-models" class="section level4 hasAnchor" number="4.2.4.1">
<h4><span class="header-section-number">4.2.4.1</span> Measuring Improvement in Regression Models<a href="statistics.html#measuring-improvement-in-regression-models" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The net reclassification improvement (NRI) and integrated discrimination improvement (IDI) have been proposed as more sensitive metrics of improvement in model discrimination.The NRI can be considered as a percentage reclassication
for the risk categories and the IDI is the mean difference in predicted probabilities between 2 models (constructed from cases with disease and without disease). The NRI and IDI scores are expressed as fractions and can be converted to percentage by multiplying 100.The continuous NRI and IDI can be performed
using <em>PredictABEL</em> [<span class="citation">Phan et al. (<a href="#ref-pmid28579970">2017</a>)</span>]<span class="citation">(<a href="#ref-pmid26796056">Phan et al. 2016</a>)</span>.</p>
</div>
<div id="shapley-value" class="section level4 hasAnchor" number="4.2.4.2">
<h4><span class="header-section-number">4.2.4.2</span> Shapley value<a href="statistics.html#shapley-value" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We can use ideas from game theory relating to fair distribution of prot in coalition games; the coalition (co-operative) game in this case can be
interpreted as contribution of the covariates to the model. The Shapley value regression method calculates the marginal contribution of each covariate as the average of all permutations of the coalition of the covariates containing the covariate of interest minus the coalition without the covariate of interest. The advantage of this approach is that it can handle multicollinearity (relatedness) among the covariates.</p>
<p>The feature importance is used to assess the impact of the features on the
models decision</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="statistics.html#cb21-1" tabindex="-1"></a><span class="co">#this section takes the output from logistic regression above.</span></span>
<span id="cb21-2"><a href="statistics.html#cb21-2" tabindex="-1"></a><span class="fu">library</span>(iml)</span>
<span id="cb21-3"><a href="statistics.html#cb21-3" tabindex="-1"></a>X <span class="ot">=</span> BreastCancer2[<span class="fu">which</span>(<span class="fu">names</span>(BreastCancer2) <span class="sc">!=</span> <span class="st">&quot;Class&quot;</span>)]</span>
<span id="cb21-4"><a href="statistics.html#cb21-4" tabindex="-1"></a>predictor <span class="ot">=</span> Predictor<span class="sc">$</span><span class="fu">new</span>(DCa, <span class="at">data =</span> X, <span class="at">y =</span> BreastCancer2<span class="sc">$</span>Class)</span>
<span id="cb21-5"><a href="statistics.html#cb21-5" tabindex="-1"></a>imp <span class="ot">=</span> FeatureImp<span class="sc">$</span><span class="fu">new</span>(predictor, <span class="at">loss =</span> <span class="st">&quot;mae&quot;</span>)</span>
<span id="cb21-6"><a href="statistics.html#cb21-6" tabindex="-1"></a><span class="fu">plot</span>(imp)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-5-1.png" width="672" /></p>
<p>From the logistic regression above cell thickness and cromatin have the highest coefficient and lowest p value. This is the same as feature importance. By contrast the Shapley values show that cell shape and marg adhesion make the largest impact on the model when considering the contribution to the model after considering all the contribution by different coalitions.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="statistics.html#cb22-1" tabindex="-1"></a><span class="co">#explain with game theory</span></span>
<span id="cb22-2"><a href="statistics.html#cb22-2" tabindex="-1"></a>shapley <span class="ot">&lt;-</span> Shapley<span class="sc">$</span><span class="fu">new</span>(predictor, <span class="at">x.interest =</span> X[<span class="dv">1</span>, ])</span>
<span id="cb22-3"><a href="statistics.html#cb22-3" tabindex="-1"></a>shapley<span class="sc">$</span><span class="fu">plot</span>()</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-5-1-1.png" width="672" /></p>
</div>
<div id="ice" class="section level4 hasAnchor" number="4.2.4.3">
<h4><span class="header-section-number">4.2.4.3</span> ICE<a href="statistics.html#ice" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The individual conditional expectation (ICE) curves is the plot of the
expectation fof the predictive value for each observation at the unique value
for the feature.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="statistics.html#cb23-1" tabindex="-1"></a><span class="co">#feature is the covariate of interest</span></span>
<span id="cb23-2"><a href="statistics.html#cb23-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb23-3"><a href="statistics.html#cb23-3" tabindex="-1"></a>eff_thick <span class="ot">&lt;-</span> FeatureEffect<span class="sc">$</span><span class="fu">new</span>(predictor, </span>
<span id="cb23-4"><a href="statistics.html#cb23-4" tabindex="-1"></a>                         <span class="at">feature =</span> <span class="st">&quot;Cl.thickness&quot;</span>, </span>
<span id="cb23-5"><a href="statistics.html#cb23-5" tabindex="-1"></a>                         <span class="at">method =</span> <span class="st">&quot;ice&quot;</span>,</span>
<span id="cb23-6"><a href="statistics.html#cb23-6" tabindex="-1"></a>                         <span class="at">center.at =</span> <span class="dv">0</span>)</span>
<span id="cb23-7"><a href="statistics.html#cb23-7" tabindex="-1"></a></span>
<span id="cb23-8"><a href="statistics.html#cb23-8" tabindex="-1"></a><span class="fu">plot</span>(eff_thick)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-5-2-1.png" width="672" /></p>
</div>
</div>
<div id="interaction" class="section level3 hasAnchor" number="4.2.5">
<h3><span class="header-section-number">4.2.5</span> Interaction<a href="statistics.html#interaction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Interactions is plotted here using lollipop bar. The <em>ggalt</em> library can be used to create this type of plot with <em>geom_lollipop</em>. The strength of interaction is measured using Friedmans H-statistics. The H-statistics ranges from 0 to 1 with
1 indicating the overall interaction strength. In the case with Breast Cancer data, the interaction strength is low.</p>
<p>When describing interaction terms it is recommended that the results be
expressed as  coefficients rather than as odds ratio.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="statistics.html#cb24-1" tabindex="-1"></a><span class="co">#plot interactions</span></span>
<span id="cb24-2"><a href="statistics.html#cb24-2" tabindex="-1"></a>interact <span class="ot">&lt;-</span> Interaction<span class="sc">$</span><span class="fu">new</span>(predictor)</span>
<span id="cb24-3"><a href="statistics.html#cb24-3" tabindex="-1"></a><span class="fu">plot</span>(interact)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-5-3-1.png" width="672" /></p>
</div>
</div>
<div id="confounder" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Confounder<a href="statistics.html#confounder" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A confounder is a covariate that serves as a cause of both exposure and outcome and as such confound the analysis. A mediator exist on the causal pathway from exposure to outcome. A common misconception is that the multiple regression adjust for imbalance in covariates in clinical trial. This issue was observed in the pivotal NINDS alteplase trial. The results of the trial has since been accepted with re-analysis of this trial using covariate adjustment <span class="citation">(<a href="#ref-pmid15345796">Ingall et al. 2004</a>)</span>.</p>
<p>There are several methods for covariate adjustment in radomised trials: direct adjustment, standardisation and inverse-probability-of-treatment weighting.</p>
<div id="confounder-weighted-model" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Confounder weighted model<a href="statistics.html#confounder-weighted-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The issue asked is whether one should choose to perform confounder analysis or propensity matching.</p>
</div>
<div id="propensity-matching" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Propensity matching<a href="statistics.html#propensity-matching" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Propensity matching is an important technique to adjust for imbalance in covariates between 2 arms. There are concerns with mis-use of this technique
such as difference in placebo arms from multiple sclerosis trials <span class="citation">(<a href="#ref-doi10.1001/jamaneurol.2020.0678">Signori et al. 2020</a>)</span>. It is proposed that this technique should be
used only if all the confounders are measurable. This situation may not be satisfied if the data were accrued at different period, in different continent etc.</p>
</div>
<div id="e-values" class="section level3 hasAnchor" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> E-values<a href="statistics.html#e-values" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The E-values <span class="citation">(<a href="#ref-pmid28693043">VanderWeele TJ 2017</a>)</span> has been proposed a measure of unmeasured confounders in observational studies. The E-value is a measure of the extent to which the confounder have on the treatmentoutcome association, conditional on the measured covariates. A large E-value is desirable. The E-values is available in <em>Evalue</em> library <span class="citation">(<a href="#ref-pmid29912013">Mathur MB 2018</a>)</span>.</p>
</div>
</div>
<div id="causal-inference" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Causal inference<a href="statistics.html#causal-inference" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Causation and association are often miscontrued to be the same. However, the finding of correlation (association) does necessarily imply causation. Causal inference evaluates the response of an effect variable in the setting of change in the cause of the effect variable. There are issues with approach to analysis of causal inference. It can be performed using frequentist such as confounder weighted model or Bayesian methods such as <a href="machine-learning.html#bayesian-trees-method">(Baysian additive regression tree)</a>.</p>
</div>
<div id="special-types-of-regression" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Special types of regression<a href="statistics.html#special-types-of-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="ordinal-regression" class="section level3 hasAnchor" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Ordinal regression<a href="statistics.html#ordinal-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Ordinal regression is appropriate when the outcome variable is in the form of ordered categorical values. For example, the Rankin scale of disability is
bounded between the values of 0 and 6. This type of analysis uses the
proportional odds model and the requirement for this model is stringent. When examining results of ordinal regression check that the authors provide this metric, the Brant test. The Brant test assesses the parallel regression assumption. Ordinal regression is performed using <em>polr</em> function in <em>MASS</em> library. The Brant test is available in the <em>Brant</em> library.</p>
</div>
<div id="survival-analysis" class="section level3 hasAnchor" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> Survival analysis<a href="statistics.html#survival-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Survival analysis is useful when dealing with time to event data. Time to event data can be left, interval and right censoring. Left censoring exists when events may have already occurred at the start of the study eg purchase of phones. Right censoring exists when events have not happened yet eg cancer trial. Interval censoring exists when an insurance has been purchased but the date of product purchase is not yet known.</p>
<p>The Cox model assesses the hazard of outcome between two groups. The assumption of this model is that the hazard between each arm is proportional <span class="citation">(<a href="#ref-pmid32167523">Stensrud and Hernan 2020</a>)</span>. The proportional hazard model can be tested based on the weighted Schoenfeld residuals<span class="citation">(<a href="#ref-10.1093/biomet/81.3.515">Grambsch and Therneau 1994</a>)</span>. There are non-parametric models available when the assumption of the proportional hazard model does not hold.</p>
<p>In the next chapter on machine learning, an illustration of <a href="machine-learning.html#random-survival-forest-with-rfsrc">random survival forest with <em>rfrsc</em> library</a> and <em>ranger</em> library are provided. In the section on [clinical trial][Interpreting clinical trials] we illustrate how the results can be converted to numbers needed to treat. The median survival corresponding to survival probability of 0.50 can be determined here. Metrics for assessing survival model was described <a href="statistics.html#discrimination-and-calibration">above</a>.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="statistics.html#cb25-1" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb25-2"><a href="statistics.html#cb25-2" tabindex="-1"></a><span class="fu">library</span>(survminer)</span></code></pre></div>
<pre><code>## Loading required package: ggpubr</code></pre>
<pre><code>## 
## Attaching package: &#39;survminer&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:survival&#39;:
## 
##     myeloma</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="statistics.html#cb29-1" tabindex="-1"></a><span class="co">#data from survival package on NCCTG lung cancer trial</span></span>
<span id="cb29-2"><a href="statistics.html#cb29-2" tabindex="-1"></a><span class="co">#https://stat.ethz.ch/R-manual/R-devel/library/survival/html/lung.html</span></span>
<span id="cb29-3"><a href="statistics.html#cb29-3" tabindex="-1"></a><span class="fu">data</span>(cancer, <span class="at">package=</span><span class="st">&quot;survival&quot;</span>)</span>
<span id="cb29-4"><a href="statistics.html#cb29-4" tabindex="-1"></a></span>
<span id="cb29-5"><a href="statistics.html#cb29-5" tabindex="-1"></a><span class="co">#time in is available in days</span></span>
<span id="cb29-6"><a href="statistics.html#cb29-6" tabindex="-1"></a><span class="co">#status censored=1, dead=2</span></span>
<span id="cb29-7"><a href="statistics.html#cb29-7" tabindex="-1"></a><span class="co">#sex:Male=1 Female=2</span></span>
<span id="cb29-8"><a href="statistics.html#cb29-8" tabindex="-1"></a></span>
<span id="cb29-9"><a href="statistics.html#cb29-9" tabindex="-1"></a><span class="fu">survfit</span>(<span class="fu">Surv</span>(time, status) <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> cancer)</span></code></pre></div>
<pre><code>## Call: survfit(formula = Surv(time, status) ~ 1, data = cancer)
## 
##        n events median 0.95LCL 0.95UCL
## [1,] 228    165    310     285     363</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="statistics.html#cb31-1" tabindex="-1"></a>sfit<span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(time, status) <span class="sc">~</span> age<span class="sc">+</span>sex<span class="sc">+</span>ph.ecog<span class="sc">+</span>ph.karno<span class="sc">+</span>wt.loss, <span class="at">data =</span> cancer)</span>
<span id="cb31-2"><a href="statistics.html#cb31-2" tabindex="-1"></a><span class="fu">summary</span>(sfit)</span></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(time, status) ~ age + sex + ph.ecog + ph.karno + 
##     wt.loss, data = cancer)
## 
##   n= 213, number of events= 151 
##    (15 observations deleted due to missingness)
## 
##               coef exp(coef)  se(coef)      z Pr(&gt;|z|)    
## age       0.015157  1.015273  0.009763  1.553 0.120538    
## sex      -0.631422  0.531835  0.177134 -3.565 0.000364 ***
## ph.ecog   0.740204  2.096364  0.191332  3.869 0.000109 ***
## ph.karno  0.015251  1.015368  0.009797  1.557 0.119553    
## wt.loss  -0.009298  0.990745  0.006699 -1.388 0.165168    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##          exp(coef) exp(-coef) lower .95 upper .95
## age         1.0153     0.9850    0.9960    1.0349
## sex         0.5318     1.8803    0.3758    0.7526
## ph.ecog     2.0964     0.4770    1.4408    3.0502
## ph.karno    1.0154     0.9849    0.9961    1.0351
## wt.loss     0.9907     1.0093    0.9778    1.0038
## 
## Concordance= 0.64  (se = 0.026 )
## Likelihood ratio test= 33.53  on 5 df,   p=3e-06
## Wald test            = 32.27  on 5 df,   p=5e-06
## Score (logrank) test = 32.83  on 5 df,   p=4e-06</code></pre>
<p>Test proportional hazard assumption using weighted residuals <span class="citation">(<a href="#ref-10.1093/biomet/81.3.515">Grambsch and Therneau 1994</a>)</span>. The finding below shows that inclusion of covariate ph.karno violate proportional hazard assumption.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="statistics.html#cb33-1" tabindex="-1"></a><span class="fu">cox.zph</span>(sfit)</span></code></pre></div>
<pre><code>##          chisq df     p
## age      0.186  1 0.666
## sex      2.059  1 0.151
## ph.ecog  1.359  1 0.244
## ph.karno 4.916  1 0.027
## wt.loss  0.110  1 0.740
## GLOBAL   7.174  5 0.208</code></pre>
<p>Plot fit of survival model</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="statistics.html#cb35-1" tabindex="-1"></a><span class="fu">ggcoxdiagnostics</span>(sfit, <span class="at">type =</span> <span class="st">&quot;deviance&quot;</span>, </span>
<span id="cb35-2"><a href="statistics.html#cb35-2" tabindex="-1"></a> <span class="at">ox.scale =</span> <span class="st">&quot;linear.predictions&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: `gather_()` was deprecated in tidyr 1.2.0.
##  Please use `gather()` instead.
##  The deprecated feature was likely used in the survminer package.
##   Please report the issue at &lt;https://github.com/kassambara/survminer/issues&gt;.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-6-3-1.png" width="672" /></p>
<p>Forest plot of outcome from survival analysis</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="statistics.html#cb38-1" tabindex="-1"></a><span class="fu">ggforest</span>(sfit)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-6-4-1.png" width="672" /></p>
<p>An alternative way to display the output from Cox regression is to use <em>forestmodel</em> library .</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="statistics.html#cb39-1" tabindex="-1"></a>forestmodel<span class="sc">::</span><span class="fu">forest_model</span>(sfit)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-6-5-1.png" width="672" /></p>
<p>The pseudoR2 for Cox regression model proposed by Royston can be evaluated</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="statistics.html#cb40-1" tabindex="-1"></a><span class="fu">royston</span>(sfit)</span></code></pre></div>
<pre><code>##         D     se(D)       R.D      R.KO       R.N      C.GH 
## 0.8546894 0.1495706 0.1484960 0.1515108 0.1459168 0.6418894</code></pre>
</div>
<div id="quantile-regression" class="section level3 hasAnchor" number="4.5.3">
<h3><span class="header-section-number">4.5.3</span> Quantile regression<a href="statistics.html#quantile-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Least spare regression is appropriate when the data is homoscedascity or the
error term remain constant. This can be seen as the data varies around the
fitted line. Homoscedascity implies that the data is homogenous. Quantile regression is appropriate when the distribution of the data is non-normal and it is more appropriate to look at the conditional median of the dependent variable. There are several libraries for this task <em>quantreg</em> and Bayesian libraries. In the example below, the life time risk of stroke is regressed against life expectancy using lest square and quantile regression.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="statistics.html#cb42-1" tabindex="-1"></a><span class="fu">library</span>(quantreg)</span>
<span id="cb42-2"><a href="statistics.html#cb42-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb42-3"><a href="statistics.html#cb42-3" tabindex="-1"></a></span>
<span id="cb42-4"><a href="statistics.html#cb42-4" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;./Data-Use/world_stroke.Rda&quot;</span>)</span>
<span id="cb42-5"><a href="statistics.html#cb42-5" tabindex="-1"></a></span>
<span id="cb42-6"><a href="statistics.html#cb42-6" tabindex="-1"></a><span class="co">#quantile regression</span></span>
<span id="cb42-7"><a href="statistics.html#cb42-7" tabindex="-1"></a>rqfit <span class="ot">&lt;-</span> <span class="fu">rq</span>( MeanLifetimeRisk<span class="sc">~</span> LifeExpectancy, <span class="at">data =</span> world_sfdf)</span>
<span id="cb42-8"><a href="statistics.html#cb42-8" tabindex="-1"></a>rqfit_sum<span class="ot">&lt;-</span><span class="fu">summary</span>(rqfit)</span>
<span id="cb42-9"><a href="statistics.html#cb42-9" tabindex="-1"></a></span>
<span id="cb42-10"><a href="statistics.html#cb42-10" tabindex="-1"></a><span class="co">#least square regression</span></span>
<span id="cb42-11"><a href="statistics.html#cb42-11" tabindex="-1"></a>lsfit<span class="ot">&lt;-</span><span class="fu">lm</span>(MeanLifetimeRisk<span class="sc">~</span>LifeExpectancy,<span class="at">data=</span>world_sfdf)</span>
<span id="cb42-12"><a href="statistics.html#cb42-12" tabindex="-1"></a>lsfit_sum<span class="ot">&lt;-</span><span class="fu">summary</span>(lsfit) </span>
<span id="cb42-13"><a href="statistics.html#cb42-13" tabindex="-1"></a></span>
<span id="cb42-14"><a href="statistics.html#cb42-14" tabindex="-1"></a><span class="co">#plot</span></span>
<span id="cb42-15"><a href="statistics.html#cb42-15" tabindex="-1"></a><span class="fu">ggplot</span>(world_sfdf,  <span class="fu">aes</span>(<span class="at">x=</span>LifeExpectancy,<span class="at">y=</span>MeanLifetimeRisk))<span class="sc">+</span></span>
<span id="cb42-16"><a href="statistics.html#cb42-16" tabindex="-1"></a>  <span class="co">#add fitted line for least square</span></span>
<span id="cb42-17"><a href="statistics.html#cb42-17" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span>lsfit_sum<span class="sc">$</span>coefficients[<span class="dv">1</span>], <span class="at">slope=</span>lsfit_sum<span class="sc">$</span>coefficients[<span class="dv">2</span>],<span class="at">color=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb42-18"><a href="statistics.html#cb42-18" tabindex="-1"></a>  <span class="co">#add fitted line for quantile regression</span></span>
<span id="cb42-19"><a href="statistics.html#cb42-19" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&quot;Life Expectancy&quot;</span>)<span class="sc">+</span></span>
<span id="cb42-20"><a href="statistics.html#cb42-20" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span>rqfit_sum<span class="sc">$</span>coefficients[<span class="dv">1</span>], <span class="at">slope=</span>rqfit_sum<span class="sc">$</span>coefficients[<span class="dv">2</span>],<span class="at">color=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-7-1.png" width="672" /></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="statistics.html#cb43-1" tabindex="-1"></a><span class="co">#annotate least square and quantile at position x, y</span></span>
<span id="cb43-2"><a href="statistics.html#cb43-2" tabindex="-1"></a><span class="co">#annotate(&quot;text&quot;,x=60, y=27, label=paste0(&quot;least square =&quot;,                        round(lsfit_sum$coefficients[1],2) ,&quot;+&quot;, round(lsfit_sum$coefficients[2],2),&quot;x &quot;,&quot;Life Expectancy&quot;),color=&quot;red&quot;)+ annotate(&quot;text&quot;,x=75, y=12,label=paste0(&quot;quantile =&quot;,round(rqfit_sum$coefficients[1],2), &quot; + &quot;, round(rqfit_sum$coefficients[2],2),&quot; x &quot;,&quot;Life Expectancy&quot;),color=&quot;blue&quot;)</span></span></code></pre></div>
</div>
<div id="non-negative-regression" class="section level3 hasAnchor" number="4.5.4">
<h3><span class="header-section-number">4.5.4</span> Non-negative regression<a href="statistics.html#non-negative-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In certain situations, it is necessary to constrain the analysis so that the regression coefifcients are non-negative. For example, when regressing brain regions against infarct volume, there is no reason believe that a negative coefficient attributable to a brain region is possible<span class="citation">(<a href="#ref-pmid16504541">Phan, Donnan, Koga, et al. 2006</a>)</span> . Non-negative regression can be performed in R using <em>nnls</em>.</p>
</div>
<div id="poisson-regression" class="section level3 hasAnchor" number="4.5.5">
<h3><span class="header-section-number">4.5.5</span> Poisson regression<a href="statistics.html#poisson-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Poisson regression is used when dealing with number of event over time or
distance such as number of new admissions or new cases of hepatitis or TIA over time. An assumption of the Poisson distribution is that the mean &amp; lambda; and variance  are the same.</p>
<p>A special case of Poisson regression is the negative binomial regression. This latter method is used when the variance is greater than the mean pf the data or over-dispersed data. Negative binomial regression can be applied to number of failure event over time. Here failure has a lose definition and can be stroke recurrence after TIA or cirrhosis after hepatitis C infection.</p>
<p>Zero-inflated data occurs when there is an abundance of zeroes in the data (true and excess zeroes).</p>
</div>
<div id="conditional-logistic-regression" class="section level3 hasAnchor" number="4.5.6">
<h3><span class="header-section-number">4.5.6</span> Conditional logistic regression<a href="statistics.html#conditional-logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Conditional logistical regression model should be used when the aim is to
compare pair of objects from the same patient. Examples include left and right arms or left and right carotid arteries. This method is available from <em>clogit</em> in <em>survival</em>.</p>
</div>
<div id="multinomial-modelling" class="section level3 hasAnchor" number="4.5.7">
<h3><span class="header-section-number">4.5.7</span> Multinomial modelling<a href="statistics.html#multinomial-modelling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Multinomial modelling is used when the outcome categorical variables are not ordered. This situation can occur when analysis involves choice outcome (choices of fruit: apple, orange or pear). In this case, the log odds of each of the categorical outcomes are analysed as a linear combination of the predictor variables. The <em>nnet</em> library have functions for performing this analysis.</p>
</div>
</div>
<div id="sample-size-estimation" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Sample size estimation<a href="statistics.html#sample-size-estimation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Clinicians are often frustrated about sample size and power estimation for a study, grant or clinical trial. This aspect is scrutinised by ethics committee
and in peer review process for journals. Luckily, R provides several packages
for sample size amd power estimation: <em>pwr</em> library. Cohen has written reference textbook on this subject <span class="citation">(<a href="#ref-COHEN1977179">Cohen 1977</a>)</span>.</p>
<div id="proportion" class="section level3 hasAnchor" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> Proportion<a href="statistics.html#proportion" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="statistics.html#cb44-1" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb44-2"><a href="statistics.html#cb44-2" tabindex="-1"></a><span class="co">#ttest-d is effect size </span></span>
<span id="cb44-3"><a href="statistics.html#cb44-3" tabindex="-1"></a><span class="co">#d = )mean group1 -mean group2)/variance</span></span>
<span id="cb44-4"><a href="statistics.html#cb44-4" tabindex="-1"></a><span class="fu">pwr.t.test</span>(<span class="at">n=</span><span class="dv">300</span>,<span class="at">d=</span><span class="fl">0.2</span>,<span class="at">sig.level=</span>.<span class="dv">05</span>,<span class="at">alternative=</span><span class="st">&quot;greater&quot;</span>) </span></code></pre></div>
<pre><code>## 
##      Two-sample t test power calculation 
## 
##               n = 300
##               d = 0.2
##       sig.level = 0.05
##           power = 0.7886842
##     alternative = greater
## 
## NOTE: n is number in *each* group</code></pre>
<p>We provided an example below for generating power of clinical trial. Examples
are taken from a paper on sample size estimation for phase II trials <span class="citation">(<a href="#ref-pmid16931782">Phan, Donnan, Davis, et al. 2006</a>)</span>.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="statistics.html#cb46-1" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb46-2"><a href="statistics.html#cb46-2" tabindex="-1"></a><span class="co">#h is effect size. effect size of 0.5 is very large </span></span>
<span id="cb46-3"><a href="statistics.html#cb46-3" tabindex="-1"></a><span class="co">#sample size</span></span>
<span id="cb46-4"><a href="statistics.html#cb46-4" tabindex="-1"></a><span class="fu">pwr.2p.test</span>(<span class="at">h=</span><span class="fl">0.5</span>,<span class="at">n=</span><span class="dv">50</span>,<span class="at">sig.level=</span><span class="fl">0.05</span>,<span class="at">alternative=</span><span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<pre><code>## 
##      Difference of proportion power calculation for binomial distribution (arcsine transformation) 
## 
##               h = 0.5
##               n = 50
##       sig.level = 0.05
##           power = 0.705418
##     alternative = two.sided
## 
## NOTE: same sample sizes</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="statistics.html#cb48-1" tabindex="-1"></a><span class="co">#medium effect size</span></span>
<span id="cb48-2"><a href="statistics.html#cb48-2" tabindex="-1"></a><span class="fu">pwr.2p.test</span>(<span class="at">h=</span><span class="fl">0.1</span>,<span class="at">n=</span><span class="dv">50</span>,<span class="at">sig.level=</span><span class="fl">0.05</span>,<span class="at">alternative=</span><span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<pre><code>## 
##      Difference of proportion power calculation for binomial distribution (arcsine transformation) 
## 
##               h = 0.1
##               n = 50
##       sig.level = 0.05
##           power = 0.07909753
##     alternative = two.sided
## 
## NOTE: same sample sizes</code></pre>
<p>The output of the sample size calculation can be put into a table or plot.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="statistics.html#cb50-1" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb50-2"><a href="statistics.html#cb50-2" tabindex="-1"></a><span class="co">#pwr.2p.test(h=0.3,n=80,sig.level=0.05,alternative=&quot;two.sided&quot;)</span></span>
<span id="cb50-3"><a href="statistics.html#cb50-3" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fu">seq</span>(.<span class="dv">1</span>,.<span class="dv">5</span>,.<span class="dv">1</span>) <span class="co">#from 0.1 to 0.3 by 0.05</span></span>
<span id="cb50-4"><a href="statistics.html#cb50-4" tabindex="-1"></a>nh <span class="ot">&lt;-</span> <span class="fu">length</span>(h) <span class="co">#5</span></span>
<span id="cb50-5"><a href="statistics.html#cb50-5" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">seq</span>(.<span class="dv">3</span>,.<span class="dv">9</span>,.<span class="dv">1</span>)<span class="co"># power from 0.5 to 0.9 by 0.1</span></span>
<span id="cb50-6"><a href="statistics.html#cb50-6" tabindex="-1"></a>np <span class="ot">&lt;-</span> <span class="fu">length</span>(p) <span class="co">#9</span></span>
<span id="cb50-7"><a href="statistics.html#cb50-7" tabindex="-1"></a><span class="co"># create an empty array 9 x 5</span></span>
<span id="cb50-8"><a href="statistics.html#cb50-8" tabindex="-1"></a>samplesize <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="fu">numeric</span>(nh<span class="sc">*</span>np), <span class="at">dim=</span><span class="fu">c</span>(nh,np))</span>
<span id="cb50-9"><a href="statistics.html#cb50-9" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>np){</span>
<span id="cb50-10"><a href="statistics.html#cb50-10" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nh){</span>
<span id="cb50-11"><a href="statistics.html#cb50-11" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">pwr.2p.test</span>(<span class="at">n =</span> <span class="cn">NULL</span>, <span class="at">h =</span> h[j],</span>
<span id="cb50-12"><a href="statistics.html#cb50-12" tabindex="-1"></a>    <span class="co">#result &lt;- pwr.r.test(n = NULL, h = h[j],</span></span>
<span id="cb50-13"><a href="statistics.html#cb50-13" tabindex="-1"></a>    <span class="at">sig.level =</span> .<span class="dv">05</span>, <span class="at">power =</span> p[i],</span>
<span id="cb50-14"><a href="statistics.html#cb50-14" tabindex="-1"></a>    <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb50-15"><a href="statistics.html#cb50-15" tabindex="-1"></a>    samplesize[j,i] <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(result<span class="sc">$</span>n)</span>
<span id="cb50-16"><a href="statistics.html#cb50-16" tabindex="-1"></a>  }</span>
<span id="cb50-17"><a href="statistics.html#cb50-17" tabindex="-1"></a>}</span>
<span id="cb50-18"><a href="statistics.html#cb50-18" tabindex="-1"></a>samplesize</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]
## [1,]  412  583  769  980 1235 1570 2102
## [2,]  103  146  193  245  309  393  526
## [3,]   46   65   86  109  138  175  234
## [4,]   26   37   49   62   78   99  132
## [5,]   17   24   31   40   50   63   85</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="statistics.html#cb52-1" tabindex="-1"></a><span class="co">#graph</span></span>
<span id="cb52-2"><a href="statistics.html#cb52-2" tabindex="-1"></a>xrange <span class="ot">&lt;-</span> <span class="fu">range</span>(h)</span>
<span id="cb52-3"><a href="statistics.html#cb52-3" tabindex="-1"></a>yrange <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">range</span>(samplesize))</span>
<span id="cb52-4"><a href="statistics.html#cb52-4" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(<span class="fu">length</span>(p))</span>
<span id="cb52-5"><a href="statistics.html#cb52-5" tabindex="-1"></a><span class="fu">plot</span>(xrange, yrange, <span class="at">type=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb52-6"><a href="statistics.html#cb52-6" tabindex="-1"></a>  <span class="at">xlab=</span><span class="st">&quot;Effect size (h)&quot;</span>,</span>
<span id="cb52-7"><a href="statistics.html#cb52-7" tabindex="-1"></a>  <span class="at">ylab=</span><span class="st">&quot;Sample Size (n)&quot;</span> )</span>
<span id="cb52-8"><a href="statistics.html#cb52-8" tabindex="-1"></a><span class="co"># add power curves</span></span>
<span id="cb52-9"><a href="statistics.html#cb52-9" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>np){</span>
<span id="cb52-10"><a href="statistics.html#cb52-10" tabindex="-1"></a>  <span class="fu">lines</span>(h, samplesize[,i], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span>colors[i])</span>
<span id="cb52-11"><a href="statistics.html#cb52-11" tabindex="-1"></a>}</span>
<span id="cb52-12"><a href="statistics.html#cb52-12" tabindex="-1"></a><span class="co"># add annotation (grid lines, title, legend) </span></span>
<span id="cb52-13"><a href="statistics.html#cb52-13" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>, <span class="at">h=</span><span class="fu">seq</span>(<span class="dv">0</span>,yrange[<span class="dv">2</span>],<span class="dv">50</span>), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;grey89&quot;</span>)</span>
<span id="cb52-14"><a href="statistics.html#cb52-14" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">v=</span><span class="fu">seq</span>(xrange[<span class="dv">1</span>],xrange[<span class="dv">2</span>],.<span class="dv">02</span>), <span class="at">lty=</span><span class="dv">2</span>,</span>
<span id="cb52-15"><a href="statistics.html#cb52-15" tabindex="-1"></a>   <span class="at">col=</span><span class="st">&quot;grey89&quot;</span>)</span>
<span id="cb52-16"><a href="statistics.html#cb52-16" tabindex="-1"></a><span class="fu">title</span>(<span class="st">&quot;Sample Size Estimation</span><span class="sc">\n</span><span class="st"> Difference in Proportion&quot;</span>)</span>
<span id="cb52-17"><a href="statistics.html#cb52-17" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">title=</span><span class="st">&quot;Power&quot;</span>, <span class="fu">as.character</span>(p),</span>
<span id="cb52-18"><a href="statistics.html#cb52-18" tabindex="-1"></a>   <span class="at">fill=</span>colors)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-10-1.png" width="672" /></p>
<div id="non-inferiority" class="section level4 hasAnchor" number="4.6.1.1">
<h4><span class="header-section-number">4.6.1.1</span> Non-inferiority<a href="statistics.html#non-inferiority" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Non-inferiority trials may offer information in a way that a traditional superiority design do not. The design may be interested in other aspect of the treatment such as cost and lower toxicity <span class="citation">(<a href="#ref-pmid26080342">Kaji and Lewis 2015</a>)</span>. Examples of non-inferiority trial designs include antibiotics versus surgery for
appendicitis <span class="citation">(<a href="#ref-pmid26080338">Salminen et al. 2015</a>)</span>. There are concerns with reporting of
noninferiority trial. Justification for the margin provided in 27.6% <span class="citation">(<a href="#ref-pmid25781447">Gopal et al. 2015</a>)</span>. The following describes a trial design where its expected that drug will result in a certain outcome <em>p1</em> and the control arm <em>p2</em> and the
ratio of subject in treatment to control arm is <em>k</em>. The difference in outcome
is <em>delta</em>. The margin is defined as non-inferior if &lt;0.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="statistics.html#cb53-1" tabindex="-1"></a><span class="fu">library</span>(TrialSize)</span>
<span id="cb53-2"><a href="statistics.html#cb53-2" tabindex="-1"></a><span class="fu">TwoSampleProportion.NIS</span>(<span class="at">alpha=</span>.<span class="dv">05</span>, </span>
<span id="cb53-3"><a href="statistics.html#cb53-3" tabindex="-1"></a>                        <span class="at">beta=</span>.<span class="dv">8</span>,</span>
<span id="cb53-4"><a href="statistics.html#cb53-4" tabindex="-1"></a>                        <span class="at">p1=</span>.<span class="dv">6</span>,</span>
<span id="cb53-5"><a href="statistics.html#cb53-5" tabindex="-1"></a>                        <span class="at">p2=</span>.<span class="dv">7</span>,</span>
<span id="cb53-6"><a href="statistics.html#cb53-6" tabindex="-1"></a>                        <span class="at">k=</span><span class="dv">1</span>,</span>
<span id="cb53-7"><a href="statistics.html#cb53-7" tabindex="-1"></a>                        <span class="at">delta =</span> .<span class="dv">1</span>,       </span>
<span id="cb53-8"><a href="statistics.html#cb53-8" tabindex="-1"></a>                        <span class="at">margin=</span><span class="sc">-</span>.<span class="dv">2</span></span>
<span id="cb53-9"><a href="statistics.html#cb53-9" tabindex="-1"></a>                        )</span></code></pre></div>
<pre><code>## [1] 3.225911</code></pre>
</div>
</div>
<div id="logistic-regression-1" class="section level3 hasAnchor" number="4.6.2">
<h3><span class="header-section-number">4.6.2</span> Logistic regression<a href="statistics.html#logistic-regression-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="statistics.html#cb55-1" tabindex="-1"></a><span class="fu">library</span>(powerMediation)</span>
<span id="cb55-2"><a href="statistics.html#cb55-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb55-3"><a href="statistics.html#cb55-3" tabindex="-1"></a></span>
<span id="cb55-4"><a href="statistics.html#cb55-4" tabindex="-1"></a><span class="co">#continuous predictor</span></span>
<span id="cb55-5"><a href="statistics.html#cb55-5" tabindex="-1"></a><span class="co">#p1=event rate</span></span>
<span id="cb55-6"><a href="statistics.html#cb55-6" tabindex="-1"></a><span class="co">#exp(0.405) =1.5</span></span>
<span id="cb55-7"><a href="statistics.html#cb55-7" tabindex="-1"></a></span>
<span id="cb55-8"><a href="statistics.html#cb55-8" tabindex="-1"></a><span class="fu">powerLogisticCon</span>(<span class="at">n=</span><span class="dv">200</span>, <span class="at">p1=</span><span class="fl">0.265</span>, <span class="at">OR=</span><span class="fu">exp</span>(<span class="fl">0.014</span>), <span class="at">alpha=</span><span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 0.03056289</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="statistics.html#cb57-1" tabindex="-1"></a><span class="co"># creating a data frame using data from </span></span>
<span id="cb57-2"><a href="statistics.html#cb57-2" tabindex="-1"></a>a<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">05.4</span>,<span class="fl">0.05</span>)</span>
<span id="cb57-3"><a href="statistics.html#cb57-3" tabindex="-1"></a>df_power<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="st">`</span><span class="at">ASPECTS</span><span class="st">`</span><span class="ot">=</span> a,</span>
<span id="cb57-4"><a href="statistics.html#cb57-4" tabindex="-1"></a><span class="st">&quot;Power&quot;</span><span class="ot">=</span><span class="fu">powerLogisticCon</span>(<span class="at">n=</span><span class="dv">100</span>, <span class="at">p1=</span>a, <span class="at">OR=</span><span class="fu">exp</span>(.<span class="dv">695</span>), <span class="at">alpha=</span><span class="fl">0.05</span>)</span>
<span id="cb57-5"><a href="statistics.html#cb57-5" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Warning in sqrt(n * beta.star^2 * p1 * (1 - p1)): NaNs produced</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="statistics.html#cb59-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df_power, <span class="fu">aes</span>(<span class="at">x=</span>ASPECTS, <span class="at">y=</span>Power))<span class="sc">+</span><span class="fu">geom_point</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 88 rows containing missing values (`geom_point()`).</code></pre>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-12-1.png" width="672" /></p>
<p>An alternative library to perform sample size for logistic regression is <em>WebPower</em> library.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="statistics.html#cb61-1" tabindex="-1"></a><span class="fu">library</span>(WebPower) </span></code></pre></div>
<pre><code>## Loading required package: lme4</code></pre>
<pre><code>## 
## Attaching package: &#39;lme4&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:modeltools&#39;:
## 
##     refit</code></pre>
<pre><code>## The following object is masked from &#39;package:nlme&#39;:
## 
##     lmList</code></pre>
<pre><code>## The following object is masked from &#39;package:MatrixModels&#39;:
## 
##     mkRespMod</code></pre>
<pre><code>## The following object is masked from &#39;package:generics&#39;:
## 
##     refit</code></pre>
<pre><code>## Loading required package: lavaan</code></pre>
<pre><code>## This is lavaan 0.6-15
## lavaan is FREE software! Please report any bugs.</code></pre>
<pre><code>## Loading required package: PearsonDS</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="statistics.html#cb71-1" tabindex="-1"></a><span class="fu">wp.logistic</span>(<span class="at">p0=</span><span class="fl">0.007</span>, <span class="co">#Prob (Y=1|X=0) </span></span>
<span id="cb71-2"><a href="statistics.html#cb71-2" tabindex="-1"></a>            <span class="at">p1=</span><span class="fl">0.012</span>, <span class="co">#Prob (Y=1|X=1)</span></span>
<span id="cb71-3"><a href="statistics.html#cb71-3" tabindex="-1"></a>            <span class="at">alpha=</span><span class="fl">0.05</span>, </span>
<span id="cb71-4"><a href="statistics.html#cb71-4" tabindex="-1"></a>            <span class="at">power=</span><span class="fl">0.80</span>, </span>
<span id="cb71-5"><a href="statistics.html#cb71-5" tabindex="-1"></a>            <span class="at">alternative=</span><span class="st">&quot;two.sided&quot;</span>, </span>
<span id="cb71-6"><a href="statistics.html#cb71-6" tabindex="-1"></a>            <span class="at">family=</span><span class="st">&quot;normal&quot;</span>)</span></code></pre></div>
<pre><code>## Power for logistic regression
## 
##        p0    p1     beta0     beta1      n alpha power
##     0.007 0.012 -4.954821 0.5440445 3336.2  0.05   0.8
## 
## URL: http://psychstat.org/logistic</code></pre>
</div>
<div id="survival-studies" class="section level3 hasAnchor" number="4.6.3">
<h3><span class="header-section-number">4.6.3</span> Survival studies<a href="statistics.html#survival-studies" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Sample size for survival studies can be performed using <em>powerSurvEpi</em> or <em>gsDesign</em>.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="statistics.html#cb73-1" tabindex="-1"></a><span class="fu">library</span>(powerSurvEpi)</span>
<span id="cb73-2"><a href="statistics.html#cb73-2" tabindex="-1"></a></span>
<span id="cb73-3"><a href="statistics.html#cb73-3" tabindex="-1"></a><span class="co">#sample size</span></span>
<span id="cb73-4"><a href="statistics.html#cb73-4" tabindex="-1"></a><span class="fu">ssizeEpi.default</span>(<span class="at">power =</span> <span class="fl">0.80</span>, </span>
<span id="cb73-5"><a href="statistics.html#cb73-5" tabindex="-1"></a>                 <span class="at">theta =</span> <span class="dv">2</span>, </span>
<span id="cb73-6"><a href="statistics.html#cb73-6" tabindex="-1"></a>                 <span class="at">p =</span> <span class="fl">0.408</span> , </span>
<span id="cb73-7"><a href="statistics.html#cb73-7" tabindex="-1"></a>                 <span class="at">psi =</span> <span class="fl">0.15</span>,</span>
<span id="cb73-8"><a href="statistics.html#cb73-8" tabindex="-1"></a>                 <span class="at">rho2 =</span> <span class="fl">0.344</span><span class="sc">^</span><span class="dv">2</span>, </span>
<span id="cb73-9"><a href="statistics.html#cb73-9" tabindex="-1"></a>                 <span class="at">alpha =</span> <span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 512</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="statistics.html#cb75-1" tabindex="-1"></a><span class="co">#power</span></span>
<span id="cb75-2"><a href="statistics.html#cb75-2" tabindex="-1"></a><span class="fu">powerEpi.default</span>(<span class="at">n =</span> <span class="dv">2691</span>, </span>
<span id="cb75-3"><a href="statistics.html#cb75-3" tabindex="-1"></a>                 <span class="at">theta =</span> <span class="dv">2</span>, </span>
<span id="cb75-4"><a href="statistics.html#cb75-4" tabindex="-1"></a>                 <span class="at">p =</span> <span class="fl">0.408</span>, </span>
<span id="cb75-5"><a href="statistics.html#cb75-5" tabindex="-1"></a>                 <span class="at">psi =</span> <span class="fl">0.250</span>,</span>
<span id="cb75-6"><a href="statistics.html#cb75-6" tabindex="-1"></a>                 <span class="at">rho2 =</span> <span class="fl">0.344</span><span class="sc">^</span><span class="dv">2</span>, </span>
<span id="cb75-7"><a href="statistics.html#cb75-7" tabindex="-1"></a>                 <span class="at">alpha =</span> <span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="statistics.html#cb77-1" tabindex="-1"></a><span class="co">#Amarenco NEJM 2020 #equal sample size k=1</span></span>
<span id="cb77-2"><a href="statistics.html#cb77-2" tabindex="-1"></a><span class="fu">ssizeCT.default</span>(<span class="at">power =</span> <span class="fl">0.8</span>, <span class="at">k =</span> .<span class="dv">8</span>, <span class="at">pE =</span> <span class="fl">0.085</span>, </span>
<span id="cb77-3"><a href="statistics.html#cb77-3" tabindex="-1"></a>                <span class="at">pC =</span> <span class="fl">0.109</span>, </span>
<span id="cb77-4"><a href="statistics.html#cb77-4" tabindex="-1"></a>                <span class="at">RR =</span> <span class="fl">0.78</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>##   nE   nC 
## 2417 3021</code></pre>
</div>
<div id="multiple-regression" class="section level3 hasAnchor" number="4.6.4">
<h3><span class="header-section-number">4.6.4</span> Multiple regression<a href="statistics.html#multiple-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The power for general linear model can be calculated using the <em>pwr.f2.test</em> function.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="statistics.html#cb79-1" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb79-2"><a href="statistics.html#cb79-2" tabindex="-1"></a><span class="co">#u=degrees of freedom for numerator</span></span>
<span id="cb79-3"><a href="statistics.html#cb79-3" tabindex="-1"></a><span class="co">#v=degrees of freedomfor denominator</span></span>
<span id="cb79-4"><a href="statistics.html#cb79-4" tabindex="-1"></a><span class="co">#f2=effect size</span></span></code></pre></div>
</div>
</div>
<div id="randomised-clinical-trials" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> Randomised clinical trials<a href="statistics.html#randomised-clinical-trials" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A common misconception is that the multiple regression adjust for imbalance in covariates in clinical trial. This issue was observed in the pivotal NINDS alteplase trial. The results of the trial has since been accepted with re-analysis of this trial using covariate adjustment<span class="citation">(<a href="#ref-pmid15345796">Ingall et al. 2004</a>)</span>. There are several methods for covariate adjustment in radomised trials: direct adjustment, standardisation and inverse-probability-of-treatment weighting.</p>
<div id="covariate-adjustment-in-trials" class="section level3 hasAnchor" number="4.7.1">
<h3><span class="header-section-number">4.7.1</span> Covariate adjustment in trials<a href="statistics.html#covariate-adjustment-in-trials" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Specifically, covariate adjustment refers to adjustment of covariates available at the time of randomisation, i.e.prespecified variables and not variables after randomisation such as pneumonia post stroke trials. The advantage of covariate adjustment is that it results in narrower confidence interval as well as increase the power of the trial up to 7% <span class="citation">(<a href="#ref-10.1186/1745-6215-15-139">Kahan 2014</a>)</span>. The increased power is highest when prognostic variables are used but can decrease power when non-prognostic variables are used <span class="citation">(<a href="#ref-10.1186/1745-6215-15-139">Kahan 2014</a>)</span>.</p>
</div>
<div id="subgroup-analysis" class="section level3 hasAnchor" number="4.7.2">
<h3><span class="header-section-number">4.7.2</span> Subgroup analysis<a href="statistics.html#subgroup-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Subgroup analysis can be misleading especially if not specified prior to trial analysis <span class="citation">(<a href="#ref-doi:10.1056/NEJMsr077003">Wang et al. 2007</a>)</span>. Furthermore, increasing the number of subgroup analysis will lead to increasing the chance of false positive result or multiplicity. It is important to differentiate between prespecified and posthoc analyses as posthoc analyses may be biased by examination of the data.</p>
</div>
<div id="p-value-for-interaction" class="section level3 hasAnchor" number="4.7.3">
<h3><span class="header-section-number">4.7.3</span> p value for interaction<a href="statistics.html#p-value-for-interaction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The p value for interaction describe the influence by a baseline variable treatment effect on outcome in clinical trial <span class="citation">(<a href="#ref-doi:10.1056/NEJMsr077003">Wang et al. 2007</a>)</span>. In a hypothetical trial, a significant p value for interaction between males and females for treatment effect on primary outcome indicates heterogenity of treatment effect.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="statistics.html#cb80-1" tabindex="-1"></a><span class="fu">library</span>(Publish)</span></code></pre></div>
<pre><code>## Warning: package &#39;Publish&#39; was built under R version 4.3.2</code></pre>
<pre><code>## Loading required package: prodlim</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;Publish&#39;:
##   method   from
##   print.ci coin</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="statistics.html#cb84-1" tabindex="-1"></a><span class="fu">library</span>(survival)</span></code></pre></div>
</div>
<div id="interpreting-risk-reduction-in-clinical-trials" class="section level3 hasAnchor" number="4.7.4">
<h3><span class="header-section-number">4.7.4</span> Interpreting risk reduction in clinical trials<a href="statistics.html#interpreting-risk-reduction-in-clinical-trials" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A key issue in interpreting of clinical trials occurs when the relative risk
reduction or relative hazard risk are provided. This issue affect the clinical interpretation of the trial finding and its application in practice. An example is the result of the ACAS asymptomatic carotid artery trial is often quoted as showing 50% risk reduction. In fact, there was 2% annual risk of ipsilateral stroke in the medical and 1% risk in the surgical arm. The absolute risk reduction or ARR was 1% per year. However, the 50% relative risk reduction is often quoted to explain to patients.</p>
</div>
<div id="nnt-from-arr" class="section level3 hasAnchor" number="4.7.5">
<h3><span class="header-section-number">4.7.5</span> NNT from ARR<a href="statistics.html#nnt-from-arr" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this case, the number needed to treat (NNT) is given by <span class="math inline">\(\frac{1}{ARR}\)</span> or <span class="math inline">\(\frac{1}{0.01}=100\)</span> to achieve the trial outcome or 100 patients are needed to be treated to reduce the stroke risk to 1%. The recommendation is that the 95% confidence interval for NNT should be provided.</p>
</div>
<div id="nnt-from-odds-ratio" class="section level3 hasAnchor" number="4.7.6">
<h3><span class="header-section-number">4.7.6</span> NNT from odds ratio<a href="statistics.html#nnt-from-odds-ratio" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Calculation of NNT for odds ratio requires knowledge of the outcome of the placebo group. The NNT is given by <span class="math inline">\(\frac{1}{ACR-\frac{OR*ACR}{1-(ACR+OR*ACR)}}\)</span>. The ACR represents the assumed control risk. The NNT can be calculated from <em>nnt</em> function in <em>meta</em> library.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="statistics.html#cb85-1" tabindex="-1"></a><span class="fu">library</span>(meta)</span></code></pre></div>
<pre><code>## Warning: package &#39;meta&#39; was built under R version 4.3.2</code></pre>
<pre><code>## Loading required package: metadat</code></pre>
<pre><code>## Loading &#39;meta&#39; package (version 7.0-0).
## Type &#39;help(meta)&#39; for a brief overview.
## Readers of &#39;Meta-Analysis with R (Use R!)&#39; should install
## older version of &#39;meta&#39; package: https://tinyurl.com/dt4y5drs</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="statistics.html#cb89-1" tabindex="-1"></a><span class="co">#p.c = baseline risk</span></span>
<span id="cb89-2"><a href="statistics.html#cb89-2" tabindex="-1"></a><span class="fu">nnt</span>(<span class="fl">0.73</span>, <span class="at">p.c =</span> <span class="fl">0.3</span>, <span class="at">sm =</span> <span class="st">&quot;OR&quot;</span>)</span></code></pre></div>
<pre><code>##     OR p.c      NNT
## 1 0.73 0.3 16.20811</code></pre>
</div>
<div id="nnt-from-risk-ratio" class="section level3 hasAnchor" number="4.7.7">
<h3><span class="header-section-number">4.7.7</span> NNT from risk ratio<a href="statistics.html#nnt-from-risk-ratio" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="statistics.html#cb91-1" tabindex="-1"></a><span class="co">#data from EXTEND-IV trial in NEJM 2019</span></span>
<span id="cb91-2"><a href="statistics.html#cb91-2" tabindex="-1"></a><span class="co">#outcome 35.4% in tpa and 29.5% in control</span></span>
<span id="cb91-3"><a href="statistics.html#cb91-3" tabindex="-1"></a><span class="fu">nnt</span>(<span class="fl">1.44</span>, <span class="at">p.c =</span> <span class="fl">0.295</span>, <span class="at">sm =</span> <span class="st">&quot;RR&quot;</span>)</span></code></pre></div>
<pre><code>##     RR   p.c      NNT
## 1 1.44 0.295 -7.70416</code></pre>
</div>
<div id="nnt-from-hazard-ratio" class="section level3 hasAnchor" number="4.7.8">
<h3><span class="header-section-number">4.7.8</span> NNT from hazard ratio<a href="statistics.html#nnt-from-hazard-ratio" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Calculation of NNT for hazard ratio requires knowledge of the outcome of the placebo group and the hazard ratio or <em>HR</em>. The formula using the binomial theorem is <span class="math inline">\(p=1-q\)</span> where q is given by the ratio of outcome and numbers recruited in the placebo group. The formula is taken from <span class="citation">(<a href="#ref-pmid32404155">Ludwig, Darmon, and Guerci 2020</a>)</span> . The NNT is given
<span class="math inline">\(\frac{1}{[p^{HR}-p}\)</span> . We illustrated this using data from metaanalysis on aspirin use in stroke in Lancet 2016. There were 45 events among 16053 patients
in the control group. The HR was 0.44. The NNT from this formula <span class="math inline">\(\frac{1}{.9971968^.44-.9971968}\)</span> was 637.</p>
</div>
<div id="nnt-from-metaananlysis" class="section level3 hasAnchor" number="4.7.9">
<h3><span class="header-section-number">4.7.9</span> NNT from metaananlysis<a href="statistics.html#nnt-from-metaananlysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are concerns with using NNT from the results of metaanalysis as the findings are amalgations of trials with different settings <span class="citation">(<a href="#ref-pmid12614141">Marx 2003</a>)</span> <span class="citation">(<a href="#ref-pmid10356018">Smeeth 1999</a>)</span>. The caution applies when baseline risks or absolute risk differences vary across trials.</p>
</div>
</div>
<div id="diagnostic-test" class="section level2 hasAnchor" number="4.8">
<h2><span class="header-section-number">4.8</span> Diagnostic test<a href="statistics.html#diagnostic-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="sensitivity-specificity" class="section level3 hasAnchor" number="4.8.1">
<h3><span class="header-section-number">4.8.1</span> Sensitivity, specificity<a href="statistics.html#sensitivity-specificity" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The sensitivity of a diagnostic test is the true positive rate and the specificity is the true negative rate. Example of 2 x 2 table is provided here. As an exercise, consider a paper about a diagnostic test for peripheral vertigo reporting 100% sensitivity and 94.4% specificity. There are 114 patients, 72 patients without stroke have vertigo and positive test findings. Among patients with stroke 7 of 42 have positive test findings. The sensitivity is <span class="math inline">\(TP=\frac{TP}{TP+FN}\)</span> and the specificity is the <span class="math inline">\(TN=\frac{TN}{TN+FP}\)</span>.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="statistics.html#cb93-1" tabindex="-1"></a><span class="co">#              Peripheral Vertigo</span></span>
<span id="cb93-2"><a href="statistics.html#cb93-2" tabindex="-1"></a><span class="co">#            Disease Positive     Disease Negative</span></span>
<span id="cb93-3"><a href="statistics.html#cb93-3" tabindex="-1"></a><span class="co">#$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$</span></span>
<span id="cb93-4"><a href="statistics.html#cb93-4" tabindex="-1"></a><span class="co"># HIT Test#                 #                      $</span></span>
<span id="cb93-5"><a href="statistics.html#cb93-5" tabindex="-1"></a><span class="co"># Positive# True Positive   # False Positive       $  </span></span>
<span id="cb93-6"><a href="statistics.html#cb93-6" tabindex="-1"></a><span class="co">#         #     72          #       7              $</span></span>
<span id="cb93-7"><a href="statistics.html#cb93-7" tabindex="-1"></a><span class="co">#$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$</span></span>
<span id="cb93-8"><a href="statistics.html#cb93-8" tabindex="-1"></a><span class="co"># HIT Test#                 #                      $</span></span>
<span id="cb93-9"><a href="statistics.html#cb93-9" tabindex="-1"></a><span class="co"># Negative# False Negative  # True Negative        $</span></span>
<span id="cb93-10"><a href="statistics.html#cb93-10" tabindex="-1"></a><span class="co">#         #     0           #       35             $ </span></span>
<span id="cb93-11"><a href="statistics.html#cb93-11" tabindex="-1"></a><span class="co">#$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$</span></span>
<span id="cb93-12"><a href="statistics.html#cb93-12" tabindex="-1"></a></span>
<span id="cb93-13"><a href="statistics.html#cb93-13" tabindex="-1"></a><span class="co"># Peripheral Vertigo</span></span>
<span id="cb93-14"><a href="statistics.html#cb93-14" tabindex="-1"></a><span class="co">#Sensitiviy=TP/(TP+FN)=100%</span></span>
<span id="cb93-15"><a href="statistics.html#cb93-15" tabindex="-1"></a><span class="co">#Specificity=TN/(TN+FP)=83%</span></span></code></pre></div>
</div>
<div id="auc" class="section level3 hasAnchor" number="4.8.2">
<h3><span class="header-section-number">4.8.2</span> AUC<a href="statistics.html#auc" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The area under the receiver operating characteristics (ROC) curve or AUC is a measure of the accuracy of the test. It is recommended that ROC curve is used when there are multiple threshold. It should not be used when the test has only one threshold. Some investigators suggest caution regarding the validity of using receiver operating curve with single threshold diagnostic tests <span class="citation">(<a href="#ref-pmid33250548">J 2020</a>)</span>. An AUC of 0.5 is classified as no better than by chance; 0.60.69 provides poor discrimination; 0.70.79 provides acceptable (fair) discrimination, 0.8 to 0.89 provides good (excellent) discrimination, and 0.9 to 1.0 provides outstanding discrimination.</p>
</div>
<div id="likelihood-ratio" class="section level3 hasAnchor" number="4.8.3">
<h3><span class="header-section-number">4.8.3</span> Likelihood ratio<a href="statistics.html#likelihood-ratio" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Positive likelihood ratio (PLR) is the ratio of sensitivity to false positive rate (FPR); the negative (NLR) likelihood ratio is the ratio of 1-sensitivity to specificity. A PLR indicates the likelihood that a positive spot sign (test) would be expected in a patient with ICH (target disorder) compared with the likelihood that the same result would be expected in a patient without ICH. Using the recommendation by Jaeschke et al, a high PLR (&gt;5) and low NLR (&lt;0.2) indicate that the test results would make moderate changes in the likelihood of hematoma growth from baseline risk. PLRs of &gt;10 and NLRs of &lt;0.1 would confer very large changes from baseline risk .</p>
<div id="fagans-normogram" class="section level4 hasAnchor" number="4.8.3.1">
<h4><span class="header-section-number">4.8.3.1</span> Fagans normogram<a href="statistics.html#fagans-normogram" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Fagans normogram can be conceptualised as a sliding ruler to match the disease
prevalence and likelihood ratios to evaluate the impact on the post-test probability <span class="citation">(<a href="#ref-pmid1143310">TJ 1975</a>)</span>. At the current disease prevalence of 23.4% and PLR 4.65, the post-test probability remains low at 0.60.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="statistics.html#cb94-1" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;https://raw.githubusercontent.com/achekroud/nomogrammer/master/nomogrammer.r&quot;</span>)</span>
<span id="cb94-2"><a href="statistics.html#cb94-2" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">nomogrammer</span>(<span class="at">Prevalence =</span> .<span class="dv">234</span>, <span class="at">Plr =</span> <span class="fl">4.85</span>, <span class="at">Nlr =</span> <span class="fl">0.49</span>)</span></code></pre></div>
<pre><code>## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
##  Please use `linewidth` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="statistics.html#cb96-1" tabindex="-1"></a>p<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">&quot;Fagan&#39;s normogram for Spot Sign and ICH growth&quot;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-14-3-2-1.png" width="672" /></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="statistics.html#cb97-1" tabindex="-1"></a><span class="co">#to save the file</span></span>
<span id="cb97-2"><a href="statistics.html#cb97-2" tabindex="-1"></a><span class="co">#ggsave(p,file=&quot;Fagan_SpotSign.png&quot;,width=5.99,height=3.99,units=&quot;in&quot;)</span></span></code></pre></div>
</div>
<div id="likelihood-ratio-graph" class="section level4 hasAnchor" number="4.8.3.2">
<h4><span class="header-section-number">4.8.3.2</span> Likelihood ratio graph<a href="statistics.html#likelihood-ratio-graph" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Likelihood ratio graph is a tool for comparing diagnostic tests <span class="citation">(<a href="#ref-pmid10700737">BJ 2000</a>)</span>.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="statistics.html#cb98-1" tabindex="-1"></a><span class="co">#plot likelihood ratio graph</span></span>
<span id="cb98-2"><a href="statistics.html#cb98-2" tabindex="-1"></a></span>
<span id="cb98-3"><a href="statistics.html#cb98-3" tabindex="-1"></a>LR_graph<span class="ot">&lt;-</span><span class="cf">function</span> (Read,sheet,Sensitivity, Specificity){</span>
<span id="cb98-4"><a href="statistics.html#cb98-4" tabindex="-1"></a>  </span>
<span id="cb98-5"><a href="statistics.html#cb98-5" tabindex="-1"></a>  Read1<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(Read, <span class="at">sheet =</span> sheet)</span>
<span id="cb98-6"><a href="statistics.html#cb98-6" tabindex="-1"></a>  </span>
<span id="cb98-7"><a href="statistics.html#cb98-7" tabindex="-1"></a>  <span class="co">#binary data</span></span>
<span id="cb98-8"><a href="statistics.html#cb98-8" tabindex="-1"></a>  <span class="co">#A=True pos %B=False positive   %C=False negative   %D=True negative</span></span>
<span id="cb98-9"><a href="statistics.html#cb98-9" tabindex="-1"></a>  </span>
<span id="cb98-10"><a href="statistics.html#cb98-10" tabindex="-1"></a>  A<span class="ot">=</span>Read1<span class="sc">$</span>TP</span>
<span id="cb98-11"><a href="statistics.html#cb98-11" tabindex="-1"></a>  B<span class="ot">=</span>Read1<span class="sc">$</span>FP</span>
<span id="cb98-12"><a href="statistics.html#cb98-12" tabindex="-1"></a>  C<span class="ot">=</span>Read1<span class="sc">$</span>FN</span>
<span id="cb98-13"><a href="statistics.html#cb98-13" tabindex="-1"></a>  D<span class="ot">=</span>Read1<span class="sc">$</span>TN</span>
<span id="cb98-14"><a href="statistics.html#cb98-14" tabindex="-1"></a>  </span>
<span id="cb98-15"><a href="statistics.html#cb98-15" tabindex="-1"></a>  TPR<span class="ot">=</span>A<span class="sc">/</span>(A<span class="sc">+</span>C)</span>
<span id="cb98-16"><a href="statistics.html#cb98-16" tabindex="-1"></a>  FPR<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span>(D<span class="sc">/</span>(D<span class="sc">+</span>B))</span>
<span id="cb98-17"><a href="statistics.html#cb98-17" tabindex="-1"></a>  </span>
<span id="cb98-18"><a href="statistics.html#cb98-18" tabindex="-1"></a>  TPR_DiagnosticTest<span class="ot">=</span>Sensitivity</span>
<span id="cb98-19"><a href="statistics.html#cb98-19" tabindex="-1"></a>  FPR_DiagnosticTest<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span>Specificity</span>
<span id="cb98-20"><a href="statistics.html#cb98-20" tabindex="-1"></a>  </span>
<span id="cb98-21"><a href="statistics.html#cb98-21" tabindex="-1"></a>  <span class="co"># set plot</span></span>
<span id="cb98-22"><a href="statistics.html#cb98-22" tabindex="-1"></a>  </span>
<span id="cb98-23"><a href="statistics.html#cb98-23" tabindex="-1"></a>  X<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span>.<span class="dv">1</span>)</span>
<span id="cb98-24"><a href="statistics.html#cb98-24" tabindex="-1"></a>  Y<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span>.<span class="dv">1</span>)</span>
<span id="cb98-25"><a href="statistics.html#cb98-25" tabindex="-1"></a></span>
<span id="cb98-26"><a href="statistics.html#cb98-26" tabindex="-1"></a>  <span class="fu">plot</span>(X,Y,<span class="at">main=</span><span class="st">&quot;Likelihood Ratio graph&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;1-Specificity&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Sensitivity&quot;</span>,<span class="at">cex=</span>.<span class="dv">25</span>)</span>
<span id="cb98-27"><a href="statistics.html#cb98-27" tabindex="-1"></a>  </span>
<span id="cb98-28"><a href="statistics.html#cb98-28" tabindex="-1"></a>  <span class="co">#pch describe the shape. The value 1 corresponds o</span></span>
<span id="cb98-29"><a href="statistics.html#cb98-29" tabindex="-1"></a>  <span class="fu">points</span>(FPR_DiagnosticTest,TPR_DiagnosticTest,<span class="at">pch=</span><span class="dv">8</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">cex=</span><span class="dv">2</span>)</span>
<span id="cb98-30"><a href="statistics.html#cb98-30" tabindex="-1"></a>  </span>
<span id="cb98-31"><a href="statistics.html#cb98-31" tabindex="-1"></a>  <span class="co">#pch describe the shape. The value 8 corresponds *</span></span>
<span id="cb98-32"><a href="statistics.html#cb98-32" tabindex="-1"></a>  <span class="fu">points</span>(FPR,TPR,<span class="at">pch=</span><span class="dv">1</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">cex=</span><span class="dv">2</span>) <span class="co">#add point</span></span>
<span id="cb98-33"><a href="statistics.html#cb98-33" tabindex="-1"></a>  <span class="co">#abline(coef = c(0,1)) #add diagonal line</span></span>
<span id="cb98-34"><a href="statistics.html#cb98-34" tabindex="-1"></a>  df1<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">c1=</span><span class="fu">c</span>(<span class="dv">0</span>,TPR_DiagnosticTest),<span class="at">c2=</span><span class="fu">c</span>(<span class="dv">0</span>,FPR_DiagnosticTest))</span>
<span id="cb98-35"><a href="statistics.html#cb98-35" tabindex="-1"></a>  reg1<span class="ot">&lt;-</span><span class="fu">lm</span>(c1<span class="sc">~</span>c2,<span class="at">data=</span>df1)</span>
<span id="cb98-36"><a href="statistics.html#cb98-36" tabindex="-1"></a>  df2<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">c1=</span><span class="fu">c</span>(TPR_DiagnosticTest,<span class="dv">1</span>),<span class="at">c2=</span><span class="fu">c</span>(FPR_DiagnosticTest,<span class="dv">1</span>))</span>
<span id="cb98-37"><a href="statistics.html#cb98-37" tabindex="-1"></a>  reg2<span class="ot">&lt;-</span><span class="fu">lm</span>(c1<span class="sc">~</span>c2,<span class="at">data=</span>df2)</span>
<span id="cb98-38"><a href="statistics.html#cb98-38" tabindex="-1"></a>  <span class="fu">abline</span>(reg1)</span>
<span id="cb98-39"><a href="statistics.html#cb98-39" tabindex="-1"></a>  <span class="fu">abline</span>(reg2)</span>
<span id="cb98-40"><a href="statistics.html#cb98-40" tabindex="-1"></a>  <span class="fu">text</span>(<span class="at">x=</span>FPR_DiagnosticTest,<span class="at">y=</span>TPR_DiagnosticTest<span class="fl">+.3</span>,<span class="at">label=</span><span class="st">&quot;Superior&quot;</span>,<span class="at">cex=</span>.<span class="dv">7</span>)</span>
<span id="cb98-41"><a href="statistics.html#cb98-41" tabindex="-1"></a>  <span class="fu">text</span>(<span class="at">x=</span>FPR_DiagnosticTest<span class="fl">+.2</span>,<span class="at">y=</span>TPR_DiagnosticTest<span class="fl">+.2</span>,<span class="at">label=</span><span class="st">&quot;Absence&quot;</span>,<span class="at">cex=</span>.<span class="dv">7</span>)</span>
<span id="cb98-42"><a href="statistics.html#cb98-42" tabindex="-1"></a>  <span class="fu">text</span>(<span class="at">x=</span>.<span class="dv">0125</span>,<span class="at">y=</span>TPR_DiagnosticTest<span class="fl">-.1</span>,<span class="at">label=</span><span class="st">&quot;Presence&quot;</span>,<span class="at">cex=</span>.<span class="dv">7</span>)</span>
<span id="cb98-43"><a href="statistics.html#cb98-43" tabindex="-1"></a>  <span class="fu">text</span>(<span class="at">x=</span>FPR_DiagnosticTest<span class="fl">+.1</span>,<span class="at">y=</span>TPR_DiagnosticTest,<span class="at">label=</span><span class="st">&quot;Inferior&quot;</span>,<span class="at">cex=</span>.<span class="dv">7</span>)</span>
<span id="cb98-44"><a href="statistics.html#cb98-44" tabindex="-1"></a>  <span class="fu">text</span>(<span class="at">x=</span>.<span class="dv">7</span>,<span class="at">y=</span>.<span class="dv">2</span>,<span class="at">label=</span><span class="st">&quot;Reference = Content Expert&quot;</span>,<span class="at">cex=</span>.<span class="dv">7</span>)</span>
<span id="cb98-45"><a href="statistics.html#cb98-45" tabindex="-1"></a>  <span class="fu">text</span>(<span class="at">x=</span>.<span class="dv">7</span>,<span class="at">y=</span>.<span class="dv">15</span>, <span class="at">label=</span><span class="st">&quot;Diagnostic Test software&quot;</span>, <span class="at">cex=</span>.<span class="dv">7</span>)</span>
<span id="cb98-46"><a href="statistics.html#cb98-46" tabindex="-1"></a></span>
<span id="cb98-47"><a href="statistics.html#cb98-47" tabindex="-1"></a>}</span></code></pre></div>
<p>Runnning the function from above</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="statistics.html#cb99-1" tabindex="-1"></a><span class="co">#Sensitivity=0.623</span></span>
<span id="cb99-2"><a href="statistics.html#cb99-2" tabindex="-1"></a><span class="co">#Specificity=1-.927</span></span>
<span id="cb99-3"><a href="statistics.html#cb99-3" tabindex="-1"></a></span>
<span id="cb99-4"><a href="statistics.html#cb99-4" tabindex="-1"></a><span class="fu">LR_graph</span>(<span class="st">&quot;./Data-Use/Diagnostic_test_summary.xlsx&quot;</span>,<span class="dv">1</span>,.<span class="dv">623</span>,.<span class="dv">927</span>)</span></code></pre></div>
<pre><code>## New names:
##  `` -&gt; `...11`</code></pre>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-14-3-3-1-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="metaanalysis" class="section level2 hasAnchor" number="4.9">
<h2><span class="header-section-number">4.9</span> Metaanalysis<a href="statistics.html#metaanalysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>During journal club, junior doctors are often taught about the importance of metaanalysis. It is worth knowing how to perform a metaanalysis in order to critique the study. This is an important issue as the junior doctor is supervised by someone who a content expert but not necessarily a method expert. Metaanalysis can be performed for clinical trials, cohort studies or diagnostic studies. As an example, it is not well known outside of statistics journal that the bivariate analysis is the preferred method to evaluate diagnostic studies <span class="citation">(<a href="#ref-pmid16168343">Reitsma et al. 2005</a>)</span>. By contrast, the majority of metaanalysis of diagnostic studies uses the univariate method of Moses and Littenberg <span class="citation">(<a href="#ref-pmid8210827">Moses, Shapiro, and Littenberg 1993</a>)</span>. This issue will be expanded below.</p>
<div id="quality-of-study" class="section level3 hasAnchor" number="4.9.1">
<h3><span class="header-section-number">4.9.1</span> Quality of study<a href="statistics.html#quality-of-study" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>All studies require evaluation of the quality of the individual studies. This can be done with the QUADAS2 tool, available at
<a href="https://annals.org/aim/fullarticle/474994/quadas-2-revised-tool-quality-assessment-diagnostic-accuracy-studies" class="uri">https://annals.org/aim/fullarticle/474994/quadas-2-revised-tool-quality-assessment-diagnostic-accuracy-studies</a>.</p>
</div>
<div id="prisma" class="section level3 hasAnchor" number="4.9.2">
<h3><span class="header-section-number">4.9.2</span> PRISMA<a href="statistics.html#prisma" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The PRISMA statement is useful for understanding the search strategy and the papers removed and retained in the metaanalysis. An example of generating the statement is provided below in R. The example given here is from a paper on the use of spot sign to predict enlargment of intracerebral hemorrhage <span class="citation">(<a href="#ref-pmid31272327">Phan et al. 2019</a>)</span>.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="statistics.html#cb101-1" tabindex="-1"></a><span class="fu">library</span>(PRISMAstatement)</span>
<span id="cb101-2"><a href="statistics.html#cb101-2" tabindex="-1"></a><span class="co">#example from Spot sign paper. Stroke 2019</span></span>
<span id="cb101-3"><a href="statistics.html#cb101-3" tabindex="-1"></a><span class="fu">prisma</span>(<span class="at">found =</span> <span class="dv">193</span>,</span>
<span id="cb101-4"><a href="statistics.html#cb101-4" tabindex="-1"></a>       <span class="at">found_other =</span> <span class="dv">27</span>,</span>
<span id="cb101-5"><a href="statistics.html#cb101-5" tabindex="-1"></a>       <span class="at">no_dupes =</span> <span class="dv">141</span>, </span>
<span id="cb101-6"><a href="statistics.html#cb101-6" tabindex="-1"></a>       <span class="at">screened =</span> <span class="dv">141</span>, </span>
<span id="cb101-7"><a href="statistics.html#cb101-7" tabindex="-1"></a>       <span class="at">screen_exclusions =</span> <span class="dv">3</span>, </span>
<span id="cb101-8"><a href="statistics.html#cb101-8" tabindex="-1"></a>       <span class="at">full_text =</span> <span class="dv">138</span>,</span>
<span id="cb101-9"><a href="statistics.html#cb101-9" tabindex="-1"></a>       <span class="at">full_text_exclusions =</span> <span class="dv">112</span>, </span>
<span id="cb101-10"><a href="statistics.html#cb101-10" tabindex="-1"></a>       <span class="at">qualitative =</span> <span class="dv">26</span>, </span>
<span id="cb101-11"><a href="statistics.html#cb101-11" tabindex="-1"></a>       <span class="at">quantitative =</span> <span class="dv">26</span>,</span>
<span id="cb101-12"><a href="statistics.html#cb101-12" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">800</span>, <span class="at">height =</span> <span class="dv">800</span>)</span></code></pre></div>
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-943a566fc710988d68eb" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-943a566fc710988d68eb">{"x":{"diagram":"digraph prisma {\n    node [shape=\"box\", fontsize = 10];\n    graph [splines=ortho, nodesep=1, dpi = 72]\n    a -> nodups;\n    b -> nodups;\n    a [label=\"Records identified through\ndatabase searching\n(n = 193)\"];\n    b [label=\"Additional records identified\nthrough other sources\n(n = 27)\"]\n    nodups -> incex;\n    nodups [label=\"Records after duplicates removed\n(n = 141)\"];\n    incex -> {ex; ft}\n    incex [label=\"Records screened\n(n = 141)\"];\n    ex [label=\"Records excluded\n(n = 3)\"];\n    {rank=same; incex ex}\n    ft -> {qual; ftex};\n    ft [label=\"Full-text articles assessed\nfor eligibility\n(n = 138)\"];\n    {rank=same; ft ftex}\n    ftex [label=\"Full-text articles excluded,\nwith reasons\n(n = 112)\"];\n    qual -> quant\n    qual [label=\"Studies included in qualitative synthesis\n(n = 26)\"];\n    quant [label=\"Studies included in\nquantitative synthesis\n(meta-analysis)\n(n = 26)\"];\n  }","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="statistics.html#cb102-1" tabindex="-1"></a><span class="co">#https://rich-iannone.github.io/DiagrammeR/graphviz_and_mermaid.html#attributes</span></span>
<span id="cb102-2"><a href="statistics.html#cb102-2" tabindex="-1"></a><span class="fu">library</span>(DiagrammeR)</span>
<span id="cb102-3"><a href="statistics.html#cb102-3" tabindex="-1"></a><span class="fu">grViz</span>(<span class="st">&quot;</span></span>
<span id="cb102-4"><a href="statistics.html#cb102-4" tabindex="-1"></a><span class="st">digraph boxes_and_circles {</span></span>
<span id="cb102-5"><a href="statistics.html#cb102-5" tabindex="-1"></a></span>
<span id="cb102-6"><a href="statistics.html#cb102-6" tabindex="-1"></a><span class="st">  # a &#39;graph&#39; statement</span></span>
<span id="cb102-7"><a href="statistics.html#cb102-7" tabindex="-1"></a><span class="st">  graph [overlap = true, fontsize = 10]</span></span>
<span id="cb102-8"><a href="statistics.html#cb102-8" tabindex="-1"></a></span>
<span id="cb102-9"><a href="statistics.html#cb102-9" tabindex="-1"></a><span class="st">  # several &#39;node&#39; statements</span></span>
<span id="cb102-10"><a href="statistics.html#cb102-10" tabindex="-1"></a><span class="st">  node [shape = box,</span></span>
<span id="cb102-11"><a href="statistics.html#cb102-11" tabindex="-1"></a><span class="st">        fontname = Helvetica]</span></span>
<span id="cb102-12"><a href="statistics.html#cb102-12" tabindex="-1"></a><span class="st">  Stroke</span></span>
<span id="cb102-13"><a href="statistics.html#cb102-13" tabindex="-1"></a></span>
<span id="cb102-14"><a href="statistics.html#cb102-14" tabindex="-1"></a><span class="st">  node [shape = oval,</span></span>
<span id="cb102-15"><a href="statistics.html#cb102-15" tabindex="-1"></a><span class="st">        fixedsize = false,</span></span>
<span id="cb102-16"><a href="statistics.html#cb102-16" tabindex="-1"></a><span class="st">        color=red,</span></span>
<span id="cb102-17"><a href="statistics.html#cb102-17" tabindex="-1"></a><span class="st">        width = 0.9] </span></span>
<span id="cb102-18"><a href="statistics.html#cb102-18" tabindex="-1"></a><span class="st">  Hypertension; &#39;No Hypertension&#39;</span></span>
<span id="cb102-19"><a href="statistics.html#cb102-19" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb102-20"><a href="statistics.html#cb102-20" tabindex="-1"></a><span class="st">  node [shape= circle,</span></span>
<span id="cb102-21"><a href="statistics.html#cb102-21" tabindex="-1"></a><span class="st">  fontcolor=red,</span></span>
<span id="cb102-22"><a href="statistics.html#cb102-22" tabindex="-1"></a><span class="st">        color=blue,</span></span>
<span id="cb102-23"><a href="statistics.html#cb102-23" tabindex="-1"></a><span class="st">        fixedsize=false]</span></span>
<span id="cb102-24"><a href="statistics.html#cb102-24" tabindex="-1"></a></span>
<span id="cb102-25"><a href="statistics.html#cb102-25" tabindex="-1"></a><span class="st">  Hypokalemia; &#39;No Hypokalemia&#39;        </span></span>
<span id="cb102-26"><a href="statistics.html#cb102-26" tabindex="-1"></a></span>
<span id="cb102-27"><a href="statistics.html#cb102-27" tabindex="-1"></a><span class="st">  # several &#39;edge&#39; statements</span></span>
<span id="cb102-28"><a href="statistics.html#cb102-28" tabindex="-1"></a><span class="st">  edge [arrowhead=diamond]</span></span>
<span id="cb102-29"><a href="statistics.html#cb102-29" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb102-30"><a href="statistics.html#cb102-30" tabindex="-1"></a><span class="st">  Stroke-&gt;{Hypertension, &#39;No Hypertension&#39;}</span></span>
<span id="cb102-31"><a href="statistics.html#cb102-31" tabindex="-1"></a><span class="st">  Hypertension-&gt;{Hypokalemia, &#39;No Hypokalemia&#39;}</span></span>
<span id="cb102-32"><a href="statistics.html#cb102-32" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb102-33"><a href="statistics.html#cb102-33" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb102-34"><a href="statistics.html#cb102-34" tabindex="-1"></a></span>
<span id="cb102-35"><a href="statistics.html#cb102-35" tabindex="-1"></a><span class="st">&quot;</span>)</span></code></pre></div>
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-a1b3739109f168ac6f2d" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-a1b3739109f168ac6f2d">{"x":{"diagram":"\ndigraph boxes_and_circles {\n\n  # a \"graph\" statement\n  graph [overlap = true, fontsize = 10]\n\n  # several \"node\" statements\n  node [shape = box,\n        fontname = Helvetica]\n  Stroke\n\n  node [shape = oval,\n        fixedsize = false,\n        color=red,\n        width = 0.9] \n  Hypertension; \"No Hypertension\"\n  \n  node [shape= circle,\n  fontcolor=red,\n        color=blue,\n        fixedsize=false]\n\n  Hypokalemia; \"No Hypokalemia\"        \n\n  # several \"edge\" statements\n  edge [arrowhead=diamond]\n  \n  Stroke->{Hypertension, \"No Hypertension\"}\n  Hypertension->{Hypokalemia, \"No Hypokalemia\"}\n  \n}\n\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="statistics.html#cb103-1" tabindex="-1"></a><span class="do">## alternative</span></span>
<span id="cb103-2"><a href="statistics.html#cb103-2" tabindex="-1"></a></span>
<span id="cb103-3"><a href="statistics.html#cb103-3" tabindex="-1"></a><span class="fu">grViz</span>(<span class="st">&quot;digraph flowchart {</span></span>
<span id="cb103-4"><a href="statistics.html#cb103-4" tabindex="-1"></a><span class="st">      # node definitions with substituted label text</span></span>
<span id="cb103-5"><a href="statistics.html#cb103-5" tabindex="-1"></a><span class="st">      node [fontname = Helvetica, shape = rectangle]        </span></span>
<span id="cb103-6"><a href="statistics.html#cb103-6" tabindex="-1"></a><span class="st">      tab1 [label = &#39;@@1&#39;]</span></span>
<span id="cb103-7"><a href="statistics.html#cb103-7" tabindex="-1"></a><span class="st">      tab2 [label = &#39;@@2&#39;]</span></span>
<span id="cb103-8"><a href="statistics.html#cb103-8" tabindex="-1"></a><span class="st">      tab3 [label = &#39;@@3&#39;]</span></span>
<span id="cb103-9"><a href="statistics.html#cb103-9" tabindex="-1"></a><span class="st">      tab4 [label = &#39;@@4&#39;]</span></span>
<span id="cb103-10"><a href="statistics.html#cb103-10" tabindex="-1"></a><span class="st">      tab5 [label = &#39;@@5&#39;]</span></span>
<span id="cb103-11"><a href="statistics.html#cb103-11" tabindex="-1"></a></span>
<span id="cb103-12"><a href="statistics.html#cb103-12" tabindex="-1"></a><span class="st"> </span></span>
<span id="cb103-13"><a href="statistics.html#cb103-13" tabindex="-1"></a><span class="st"># edge definitions with the node IDs</span></span>
<span id="cb103-14"><a href="statistics.html#cb103-14" tabindex="-1"></a><span class="st">      tab1 -&gt; tab3 </span></span>
<span id="cb103-15"><a href="statistics.html#cb103-15" tabindex="-1"></a><span class="st">      tab1-&gt; tab2 </span></span>
<span id="cb103-16"><a href="statistics.html#cb103-16" tabindex="-1"></a><span class="st">      #tab2-&gt;tab3</span></span>
<span id="cb103-17"><a href="statistics.html#cb103-17" tabindex="-1"></a><span class="st">      tab2 -&gt; tab4 </span></span>
<span id="cb103-18"><a href="statistics.html#cb103-18" tabindex="-1"></a><span class="st">      tab2-&gt; tab5;</span></span>
<span id="cb103-19"><a href="statistics.html#cb103-19" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb103-20"><a href="statistics.html#cb103-20" tabindex="-1"></a></span>
<span id="cb103-21"><a href="statistics.html#cb103-21" tabindex="-1"></a><span class="st">      [1]: &#39;Stroke n=19&#39;</span></span>
<span id="cb103-22"><a href="statistics.html#cb103-22" tabindex="-1"></a><span class="st">      [2]: &#39;Hypertension n=10&#39;</span></span>
<span id="cb103-23"><a href="statistics.html#cb103-23" tabindex="-1"></a><span class="st">      [3]: &#39;No Hypertension n=9&#39;</span></span>
<span id="cb103-24"><a href="statistics.html#cb103-24" tabindex="-1"></a><span class="st">      [4]: &#39;Hypokalemia n=?&#39;</span></span>
<span id="cb103-25"><a href="statistics.html#cb103-25" tabindex="-1"></a><span class="st">      [5]: &#39;No Hypokalemia n=?&#39;</span></span>
<span id="cb103-26"><a href="statistics.html#cb103-26" tabindex="-1"></a><span class="st">      &quot;</span>)</span></code></pre></div>
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-7d37ae5b19484b39c881" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-7d37ae5b19484b39c881">{"x":{"diagram":"digraph flowchart {\n      # node definitions with substituted label text\n      node [fontname = Helvetica, shape = rectangle]        \n      tab1 [label = \"Stroke n=19\"]\n      tab2 [label = \"Hypertension n=10\"]\n      tab3 [label = \"No Hypertension n=9\"]\n      tab4 [label = \"Hypokalemia n=?\"]\n      tab5 [label = \"No Hypokalemia n=?\"]\n\n \n# edge definitions with the node IDs\n      tab1 -> tab3 \n      tab1-> tab2 \n      #tab2->tab3\n      tab2 -> tab4 \n      tab2-> tab5;\n      }","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="conversion-of-median-to-mean" class="section level3 hasAnchor" number="4.9.3">
<h3><span class="header-section-number">4.9.3</span> Conversion of median to mean<a href="statistics.html#conversion-of-median-to-mean" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One issue with performing metaanalysis is that one paper may report mean and another report median age. The formula for the mean is given by <span class="math inline">\(\frac{a+2m+b}{4}\)</span> where <em>m</em> is the median, <em>a</em> is the upper and <em>b</em> is the lower range <span class="citation">(<a href="#ref-pmid25524443">Wan 2014</a>)</span>. The variance is given by <span class="math inline">\(S^2=\frac{1}{12}(\frac{(a+2m+b)^2}{4}+{(b-a)^2})\)</span>. This formula requires examination of the data such as the figure to obtain the upper and lower range. These changes are incorporated into <em>meta</em> libray using <em>meatamean</em> function <span class="citation">(<a href="#ref-doi10.1136/ebmental-2019-300117">Balduzzi, Rcker, and Schwarzer 2019</a>)</span>. More recently, investigators suggest to also consider the skewness of the data from the 5 number summary data <span class="citation">(<a href="#ref-pmid37161735">Shi et al. 2023</a>)</span>. The argument <em>method.mean</em> in function <em>metamean</em> is used to specify the method for estimating the mean. In this case we chose the Luo method for illustration Luo <span class="citation">(<a href="#ref-doi:10.1177/0962280216669183">Luo et al. 2018</a>)</span>. See the help page by typing question mark before <em>metamean</em> for more options.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="statistics.html#cb104-1" tabindex="-1"></a><span class="fu">library</span>(meta)</span>
<span id="cb104-2"><a href="statistics.html#cb104-2" tabindex="-1"></a></span>
<span id="cb104-3"><a href="statistics.html#cb104-3" tabindex="-1"></a><span class="co">#NIHSS data from ANGEL large core trial in NEJM 2023</span></span>
<span id="cb104-4"><a href="statistics.html#cb104-4" tabindex="-1"></a><span class="fu">metamean</span>(<span class="at">q1=</span><span class="dv">4</span>,<span class="at">q3=</span><span class="dv">20</span>,<span class="at">median=</span><span class="dv">16</span>,<span class="at">n=</span><span class="dv">230</span>, <span class="at">method.mean =</span> <span class="st">&quot;Luo&quot;</span>)</span></code></pre></div>
<pre><code>## Number of observations: o = 230
## 
##     mean             95%-CI
##  13.1932 [11.6506; 14.7358]
## 
## Details:
## - Untransformed (raw) means</code></pre>
<p>Here the same data is used for the McGrath method <span class="citation">(<a href="#ref-doi:10.1177/0962280219889080">McGrath et al. 2020</a>)</span>.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="statistics.html#cb106-1" tabindex="-1"></a><span class="fu">metamean</span>(<span class="at">q1=</span><span class="dv">4</span>,<span class="at">q3=</span><span class="dv">20</span>,<span class="at">median=</span><span class="dv">16</span>,<span class="at">n=</span><span class="dv">230</span>, <span class="at">method.mean =</span> <span class="st">&quot;QE-McGrath&quot;</span>)</span></code></pre></div>
<pre><code>## Number of observations: o = 230
## 
##     mean             95%-CI
##  13.3333 [11.7907; 14.8759]
## 
## Details:
## - Untransformed (raw) means</code></pre>
<p>The conversion from median to mean in <em>metafor</em> is performed using <em>conv.fivenum</em> function <span class="citation">(<a href="#ref-JSSv036i03">Viechtbauer 2010</a>)</span>. There is an update on the <em>metafor</em> page as well as discussion on alternate approach. The default method of this function is to use the methods by Luo <span class="citation">(<a href="#ref-doi:10.1177/0962280216669183">Luo et al. 2018</a>)</span>, Wan <span class="citation">(<a href="#ref-pmid25524443">Wan 2014</a>)</span> and Shi <span class="citation">(<a href="#ref-pmid37161735">Shi et al. 2023</a>)</span></p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="statistics.html#cb108-1" tabindex="-1"></a><span class="fu">library</span>(metafor)</span></code></pre></div>
<pre><code>## Loading required package: numDeriv</code></pre>
<pre><code>## 
## Loading the &#39;metafor&#39; package (version 4.2-0). For an
## introduction to the package please type: help(metafor)</code></pre>
<pre><code>## 
## Attaching package: &#39;metafor&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:rms&#39;:
## 
##     vif</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="statistics.html#cb113-1" tabindex="-1"></a><span class="co"># example data frame</span></span>
<span id="cb113-2"><a href="statistics.html#cb113-2" tabindex="-1"></a>EstMean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Paper=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="cn">NA</span>), <span class="at">min=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="cn">NA</span>,<span class="dv">2</span>,<span class="cn">NA</span>), <span class="at">q1=</span><span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="cn">NA</span>),</span>
<span id="cb113-3"><a href="statistics.html#cb113-3" tabindex="-1"></a>                  <span class="at">median=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">6</span>,<span class="cn">NA</span>), <span class="at">q3=</span><span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="dv">10</span>,<span class="dv">10</span>,<span class="cn">NA</span>),</span>
<span id="cb113-4"><a href="statistics.html#cb113-4" tabindex="-1"></a>                  <span class="at">max=</span><span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">14</span>,<span class="cn">NA</span>,<span class="dv">14</span>,<span class="cn">NA</span>),</span>
<span id="cb113-5"><a href="statistics.html#cb113-5" tabindex="-1"></a>                  <span class="at">mean=</span><span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="fl">7.0</span>), <span class="at">sd=</span><span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="fl">4.2</span>),</span>
<span id="cb113-6"><a href="statistics.html#cb113-6" tabindex="-1"></a>                  <span class="at">n=</span><span class="fu">c</span>(<span class="dv">30</span>,<span class="dv">30</span>,<span class="dv">30</span>,<span class="dv">30</span>,<span class="dv">30</span>))</span>
<span id="cb113-7"><a href="statistics.html#cb113-7" tabindex="-1"></a>EstMean</span></code></pre></div>
<pre><code>##   Paper min q1 median q3 max mean  sd  n
## 1     1   1 NA      5 NA  12   NA  NA 30
## 2     2   2 NA      6 NA  14   NA  NA 30
## 3     3  NA  4      6 10  NA   NA  NA 30
## 4     4   2  4      6 10  14   NA  NA 30
## 5    NA  NA NA     NA NA  NA    7 4.2 30</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="statistics.html#cb115-1" tabindex="-1"></a>EstMean <span class="ot">&lt;-</span> <span class="fu">conv.fivenum</span>(<span class="at">min=</span>min, <span class="at">q1=</span>q1, <span class="at">median=</span>median, <span class="at">q3=</span>q3, <span class="at">max=</span>max, <span class="at">n=</span>n, <span class="at">data=</span>EstMean)</span>
<span id="cb115-2"><a href="statistics.html#cb115-2" tabindex="-1"></a></span>
<span id="cb115-3"><a href="statistics.html#cb115-3" tabindex="-1"></a>EstMean</span></code></pre></div>
<pre><code>##   Paper min q1 median q3 max     mean       sd  n
## 1     1   1 NA      5 NA  12 5.356748 2.695707 30
## 2     2   2 NA      6 NA  14 6.475664 2.940771 30
## 3     3  NA  4      6 10  NA 6.713000 4.670521 30
## 4     4   2  4      6 10  14 6.882074 3.546379 30
## 5    NA  NA NA     NA NA  NA 7.000000 4.200000 30</code></pre>
<p>The <em>estmeansd</em> library uses quantile estimation method with <em>qe.mean.sd</em> function when the data available are the median and quartile ranges <span class="citation">(<a href="#ref-doi:10.1177/0962280219889080">McGrath et al. 2020</a>)</span> <span class="citation">(<a href="#ref-pmid36412105">McGrath et al. 2022</a>)</span>.The approach here is to use simulation to estimate the parameters.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="statistics.html#cb117-1" tabindex="-1"></a><span class="fu">library</span>(estmeansd)</span></code></pre></div>
<pre><code>## Warning: package &#39;estmeansd&#39; was built under R version 4.3.2</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="statistics.html#cb119-1" tabindex="-1"></a><span class="co">#data from ANGEL large core trial in NEJM 2023</span></span>
<span id="cb119-2"><a href="statistics.html#cb119-2" tabindex="-1"></a>res_qe <span class="ot">&lt;-</span> <span class="fu">bc.mean.sd</span>(<span class="at">q1.val =</span> <span class="dv">13</span>, <span class="at">med.val =</span> <span class="dv">16</span>, <span class="at">q3.val =</span> <span class="dv">20</span>, <span class="at">n =</span> <span class="dv">230</span>)</span>
<span id="cb119-3"><a href="statistics.html#cb119-3" tabindex="-1"></a>res_qe </span></code></pre></div>
<pre><code>## $est.mean
## [1] 17.14476
## 
## $est.sd
## [1] 5.650041</code></pre>
<p>The standard error from the mean can be estimated using <em>get_SE</em> function.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="statistics.html#cb121-1" tabindex="-1"></a><span class="fu">get_SE</span>(res_qe)</span></code></pre></div>
<pre><code>## $est.se
## [1] 0.5102898
## 
## $boot_means
##    [1] 16.66390 16.69817 15.89256 17.19883 16.55661 17.26537 17.12770 17.63886
##    [9] 17.41694 16.82139 17.60338 17.06845 16.98280 17.47791 17.13287 16.74243
##   [17] 16.06546 16.25667 16.40406 16.98778 16.24305 17.06542 17.10770 18.22134
##   [25] 15.71684 16.62984 16.31952 16.28308 16.23341 17.07702 16.67616 16.98810
##   [33] 16.04105 16.82488 16.63304 17.23908 16.62816 15.63161 16.48613 16.50746
##   [41] 16.97719 16.51825 16.14368 16.46287 16.72329 16.41238 16.50369 16.56787
##   [49] 17.29346 16.98682 16.72249 16.47381 17.06320 16.77228 16.60950 16.75800
##   [57] 16.66580 16.18258 16.40676 16.29448 15.29017 15.70036 16.85384 16.73239
##   [65] 15.43095 17.84255 16.36621 16.31963 16.86287 15.72336 16.22607 16.30642
##   [73] 15.66034 16.28695 17.02475 17.16609 17.17116 17.13025 18.25489 16.96275
##   [81] 16.92366 15.88248 16.72140 17.48468 16.23346 17.32635 16.61420 16.59357
##   [89] 16.18030 16.40490 15.63667 17.94863 16.42327 16.30130 16.69097 16.45597
##   [97] 16.92336 16.40641 16.28127 17.24317 16.81325 16.68946 16.16723 16.89440
##  [105] 16.87757 16.40807 17.08656 16.45680 17.05380 16.81444 16.63864 17.20234
##  [113] 16.65630 16.97083 16.54165 16.88519 17.19829 17.05603 16.14812 17.42908
##  [121] 16.47652 17.50298 16.30331 16.73512 16.76411 16.94170 16.78335 17.05584
##  [129] 16.60727 16.79810 16.88574 17.00636 16.46055 16.48565 15.83848 16.96492
##  [137] 16.50078 16.82822 17.11683 16.76974 16.55876 17.25655 16.61590 16.91282
##  [145] 15.99394 17.02790 17.03099 17.65331 17.11030 16.78000 16.21339 16.74618
##  [153] 17.72906 16.79823 16.12686 16.43094 16.27106 17.24803 16.44198 16.20235
##  [161] 16.78196 16.15586 16.28770 16.33374 16.80457 16.84903 16.97197 16.90438
##  [169] 16.98154 16.25183 16.63521 16.08649 16.45472 16.48943 16.84175 15.98306
##  [177] 16.89773 16.01818 17.30585 16.50023 16.64798 15.81947 16.86979 16.34850
##  [185] 16.47819 16.26823 17.02212 17.41595 16.83327 17.25751 17.62506 17.08525
##  [193] 16.03609 16.96108 16.66225 16.47223 16.11247 15.59941 17.14970 16.95419
##  [201] 16.50262 16.26690 16.84078 16.57393 16.59575 16.52833 17.18014 17.05306
##  [209] 15.65881 16.65131 16.35482 15.75010 16.77303 17.15287 15.69514 17.37811
##  [217] 16.47265 16.45071 17.23837 16.68875 17.10401 16.91896 16.90243 17.17555
##  [225] 16.57668 16.87490 17.48830 17.11829 17.06430 16.45008 17.19665 16.12800
##  [233] 16.81580 16.58545 15.95984 16.14233 16.72764 16.21510 16.60622 16.67476
##  [241] 16.99073 16.65368 16.51003 16.78206 17.49427 17.24463 16.81030 17.01023
##  [249] 17.59830 16.88146 16.99891 15.43474 16.59445 15.57332 17.88297 16.98120
##  [257] 16.57203 16.34280 17.35349 17.40068 16.29080 16.30923 16.32896 15.91147
##  [265] 16.92131 17.44460 16.58439 17.18785 16.61905 16.55740 17.39960 16.62983
##  [273] 16.15647 17.19792 16.64086 17.95710 16.53210 17.76875 18.05950 17.18600
##  [281] 16.02285 16.48049 17.01223 16.57632 16.62798 16.93156 16.68815 16.63011
##  [289] 16.97096 16.66177 17.18486 16.91122 16.87738 16.76235 17.32905 16.71355
##  [297] 17.07581 15.97298 17.04653 16.65056 17.00158 17.24009 16.64022 16.38995
##  [305] 17.13773 17.15573 17.79099 17.68078 16.70721 17.28505 15.91946 16.50384
##  [313] 16.96997 16.95185 15.83475 16.33372 16.61356 16.55019 15.50628 16.58150
##  [321] 16.78615 17.59912 16.91465 17.14837 16.52759 17.54634 16.22741 17.03333
##  [329] 16.19908 17.16992 17.20690 16.21432 17.29767 16.34184 16.43202 16.92260
##  [337] 16.52879 16.57742 16.72837 16.73170 16.98930 17.38665 16.94329 17.14435
##  [345] 16.60608 16.87458 16.43892 16.44838 17.19973 17.16572 16.98323 17.12301
##  [353] 17.43208 16.00597 17.08275 16.40327 17.36462 17.36512 15.92835 16.84114
##  [361] 16.54553 17.29970 16.68390 15.86605 16.61414 16.62438 16.38585 17.00589
##  [369] 16.41819 17.33280 16.77215 16.79483 16.72286 16.07997 16.33566 15.70615
##  [377] 17.08738 16.26688 15.98156 16.54304 17.02981 16.76078 17.36708 16.81734
##  [385] 16.07007 17.09194 17.70375 16.94583 16.35173 16.15827 17.47920 17.18136
##  [393] 15.90159 17.37906 16.33930 16.92159 17.15558 16.73426 17.09414 16.37992
##  [401] 17.14400 16.85447 17.00924 16.57262 16.53880 17.00669 16.71665 17.37289
##  [409] 17.32158 16.87272 16.25992 16.11820 17.61014 16.89474 17.48792 16.46693
##  [417] 16.27302 16.85829 17.17407 15.69916 17.04194 16.15027 16.48802 16.23594
##  [425] 16.92020 15.95365 16.36527 16.82771 16.65370 16.87483 15.56613 17.23290
##  [433] 17.58024 17.45919 18.33801 17.31612 17.25300 16.22515 17.00340 17.22449
##  [441] 17.22091 16.95706 17.38857 16.31062 17.54040 17.25248 18.35978 16.61568
##  [449] 17.13831 17.55593 16.68882 17.40981 17.37656 17.44421 17.00983 17.03580
##  [457] 17.16939 16.71202 16.77490 16.69644 17.26074 17.33776 17.05292 16.97609
##  [465] 16.84245 17.30706 16.67555 16.39560 16.38627 16.66285 17.06987 17.04695
##  [473] 16.99143 17.11926 17.31483 17.76141 16.54000 16.92423 16.48560 16.32153
##  [481] 16.94677 17.00891 16.75018 16.91479 16.40788 17.31253 17.77492 16.71086
##  [489] 17.11449 16.04348 16.98537 15.70928 16.32160 16.30002 17.82745 16.87492
##  [497] 16.31042 17.53756 16.92455 17.24326 16.78227 15.95024 16.84337 16.99254
##  [505] 16.78454 16.76887 16.86679 16.25574 16.92961 16.02868 16.62991 16.88548
##  [513] 16.45305 16.75567 16.56051 16.15590 17.19629 16.38255 16.15506 17.31280
##  [521] 17.24406 15.99549 16.56884 17.18757 17.02471 16.77021 16.27013 16.86561
##  [529] 16.39335 17.81978 16.57930 16.00565 16.54933 16.05425 16.39525 17.75376
##  [537] 16.15048 17.57924 17.35005 16.77684 16.55036 16.73871 17.13219 16.79646
##  [545] 16.51802 17.29724 16.29661 17.28578 17.56532 17.51885 16.77056 16.00573
##  [553] 16.67769 16.78641 16.23304 16.58838 16.49009 16.99835 16.89950 17.45483
##  [561] 16.96401 17.45701 16.89983 17.30552 17.08768 15.46666 16.05557 17.20520
##  [569] 16.16966 17.36305 15.81409 16.59071 17.86897 16.28986 16.36243 16.50485
##  [577] 17.23279 16.67212 16.20760 17.04323 16.46212 16.23928 17.15327 17.07648
##  [585] 17.13789 16.97970 16.55518 17.74439 16.56618 17.16697 15.29274 16.65612
##  [593] 16.34491 16.92109 16.59135 16.78995 16.80833 17.11525 15.98219 16.57879
##  [601] 17.03002 17.14752 16.54208 16.44082 16.03760 16.60479 16.50938 16.45549
##  [609] 16.80612 16.71769 16.57500 16.79048 16.10227 16.13110 17.25797 16.46660
##  [617] 16.48700 17.57859 16.95572 17.37138 16.56578 15.92920 16.26423 16.39801
##  [625] 16.03608 16.86167 17.33199 17.16877 16.71535 17.78375 16.38696 16.84344
##  [633] 17.73923 16.99409 16.85281 16.44584 16.50495 16.66592 16.79871 16.77443
##  [641] 16.60523 16.93995 17.06959 16.53240 17.50337 16.91155 17.46380 16.56852
##  [649] 16.60102 17.74939 16.85360 15.86915 16.64602 16.37676 17.08016 16.83050
##  [657] 17.29055 16.91859 15.96536 17.07857 16.43210 16.39255 17.21388 16.57483
##  [665] 17.10986 17.02509 16.61743 16.87328 16.96959 15.48141 16.94314 16.01972
##  [673] 15.72709 17.92634 17.28476 17.10887 16.05459 17.31006 17.09649 16.82255
##  [681] 17.25439 16.28537 16.19651 17.41953 16.67429 16.68488 16.85428 16.75418
##  [689] 17.02371 17.32062 17.89768 17.15978 16.92829 17.59519 17.73173 15.35916
##  [697] 16.71941 17.02790 16.95977 16.93416 16.42306 16.38133 16.23743 17.35646
##  [705] 16.44610 17.66137 15.75468 17.08788 16.90414 17.29375 17.09657 16.00563
##  [713] 16.76979 16.66262 16.56896 16.72521 16.50617 17.46384 17.03279 16.37153
##  [721] 17.43158 16.53022 16.31525 16.11451 17.71836 16.89635 16.07970 17.04622
##  [729] 16.48870 16.17329 16.70779 16.86119 16.96843 16.93623 17.05104 17.25447
##  [737] 16.73467 17.41983 17.08007 16.27411 16.90805 16.92668 16.65701 16.67813
##  [745] 16.68485 16.51040 16.72153 16.56719 17.68564 16.50952 17.28621 17.12134
##  [753] 15.36982 17.03726 16.99682 16.26720 16.49834 16.07202 16.74368 16.63903
##  [761] 16.29204 16.56971 16.29349 17.67395 16.65466 16.14457 16.93419 17.72199
##  [769] 16.83260 17.53090 15.98249 16.06516 17.07370 17.21883 17.28002 16.74909
##  [777] 16.98304 16.99338 16.84960 17.05050 16.80166 17.87578 18.07153 16.06044
##  [785] 16.51795 15.79198 16.19566 17.64799 17.18723 17.21312 17.25843 17.03963
##  [793] 16.57878 16.99321 17.28061 17.44849 17.17988 17.86028 15.68381 16.98306
##  [801] 16.68332 17.09027 16.83725 16.86283 15.88916 16.19037 16.17690 16.34122
##  [809] 16.46200 16.26975 17.45508 17.16127 15.72124 15.43782 17.45512 17.33485
##  [817] 16.61127 17.05466 16.75469 16.24850 16.96254 17.04013 15.53467 16.96025
##  [825] 16.66350 17.38544 17.12015 16.74572 16.95395 16.77743 15.92872 16.16924
##  [833] 17.86792 16.84860 16.55836 16.31146 17.68664 17.27751 17.30793 16.83957
##  [841] 16.96889 16.75248 16.89943 17.17725 16.66216 17.45462 16.98400 16.40689
##  [849] 17.55101 17.08755 16.03492 16.94719 16.14927 16.55916 16.23951 16.90644
##  [857] 16.22424 16.30078 16.34993 16.18523 17.03123 17.35194 16.71858 16.73831
##  [865] 16.80478 16.75904 16.87968 16.84739 15.79301 17.44405 16.87676 16.82792
##  [873] 17.23332 16.82122 16.89690 16.59562 16.85314 17.29962 17.28448 16.52256
##  [881] 15.76349 15.77726 17.45327 16.94128 16.67857 16.58123 17.34835 17.70388
##  [889] 16.86031 17.39771 17.07600 16.78007 16.77530 16.63418 16.18914 16.34622
##  [897] 16.91623 16.04808 17.27790 17.42853 17.32533 17.24570 16.68469 17.73565
##  [905] 16.60939 16.39931 17.31422 16.82109 16.06089 16.62562 16.71000 17.20637
##  [913] 17.36066 16.23623 16.95421 16.36926 17.08086 16.67267 16.79495 16.74830
##  [921] 16.66322 17.40728 16.77309 16.70344 16.96308 16.16975 17.49590 16.54738
##  [929] 15.57147 16.99469 16.22483 16.62322 17.08681 16.08595 17.46798 17.27020
##  [937] 16.86419 16.87760 15.72275 16.33403 16.01395 17.09091 16.89563 17.00088
##  [945] 17.21697 17.27473 17.13388 17.53623 15.92465 16.26260 17.76040 17.14835
##  [953] 17.54461 16.94364 16.85576 16.95647 16.21486 17.23631 17.36682 17.09795
##  [961] 16.18386 16.83304 17.06811 17.68435 17.54879 17.09970 16.88648 16.85357
##  [969] 17.10226 16.62532 16.31735 17.22562 17.59729 17.05508 17.10225 16.96725
##  [977] 17.77497 16.99661 16.38870 16.62570 16.93676 15.35403 17.14603 17.01993
##  [985] 16.87862 17.52553 17.36020 16.75609 16.95920 16.85935 16.74251 17.69623
##  [993] 15.99410 16.69309 16.65428 17.01933 15.83595 16.28879 15.64182 17.03454
## 
## $boot_sds
##    [1] 5.731674 5.711327 5.106518 5.905240 4.714492 5.744365 4.940112 6.103550
##    [9] 6.566073 5.822449 5.898619 5.442226 5.347790 4.767957 5.503518 5.277140
##   [17] 4.349023 5.312397 4.989625 6.092369 5.118435 5.027715 5.315142 7.017761
##   [25] 4.052215 4.645615 4.812545 5.590012 5.109759 5.059357 5.338483 5.898668
##   [33] 5.020366 5.705525 5.174121 5.726563 5.103541 4.521876 5.271354 5.890387
##   [41] 5.472917 5.423250 4.662886 5.621558 5.626551 4.886733 4.571805 5.165556
##   [49] 5.195755 5.237422 5.358395 4.549817 5.735572 5.534262 5.655606 5.797500
##   [57] 4.955324 5.108920 4.793119 5.031734 4.790921 4.374220 6.106122 4.682443
##   [65] 4.057534 6.359877 5.685989 4.979714 5.251994 4.449038 5.518989 6.058860
##   [73] 4.737227 4.743766 6.033789 5.946777 4.549205 6.046298 6.298423 5.123698
##   [81] 4.687258 4.827318 5.695938 6.067229 5.019821 5.040718 4.863941 5.041377
##   [89] 5.118786 5.360424 3.833376 5.795016 4.928607 5.365637 5.106887 5.763445
##   [97] 5.310718 5.132472 4.862092 5.769604 5.820183 5.106905 5.503604 5.173159
##  [105] 4.468881 4.994860 5.556114 5.456409 5.888077 5.365738 6.095231 4.753770
##  [113] 5.274245 6.258905 5.481630 5.899112 5.955495 5.564166 5.569488 5.430171
##  [121] 5.182991 6.476226 5.213254 5.477577 4.828859 6.112490 5.510687 5.999736
##  [129] 5.239661 6.145823 6.038522 6.108056 5.077740 5.583092 4.778979 5.733898
##  [137] 5.339212 5.604473 6.978787 6.506588 5.212858 6.139569 4.987649 4.590426
##  [145] 5.256367 5.170015 5.943217 5.422019 5.236253 5.632032 5.485879 5.470517
##  [153] 6.011220 5.599888 5.117834 5.109431 5.036687 5.878950 6.067126 4.844550
##  [161] 5.327956 4.808388 5.563918 5.041597 5.603222 5.908501 5.669196 5.599712
##  [169] 5.675483 5.495011 5.785932 5.096822 4.733499 5.266942 5.197982 5.484215
##  [177] 5.213279 4.853462 6.023075 4.890181 4.782283 4.689698 5.199803 5.542317
##  [185] 5.454340 4.578010 5.335697 5.432267 4.913958 6.352996 6.052775 4.602858
##  [193] 4.812478 5.583230 4.929825 5.167457 4.446312 4.781734 6.234423 4.291185
##  [201] 6.162833 4.754100 5.399827 5.205302 5.769196 4.112299 6.098719 6.291658
##  [209] 4.786049 5.002934 5.791284 4.651967 5.561714 5.187803 4.790549 5.583742
##  [217] 5.220875 5.159996 6.299826 5.280534 5.583761 5.250142 5.972700 5.659321
##  [225] 5.321871 5.043629 6.920453 5.556015 5.427027 5.276272 5.318629 4.630870
##  [233] 5.906533 5.414795 4.858116 4.866838 5.459260 4.858410 6.415918 5.919112
##  [241] 4.902056 5.814320 4.179139 4.995871 5.436449 5.746721 5.328714 5.301190
##  [249] 5.571012 5.762302 6.555226 4.317238 5.942752 4.046599 6.370138 4.326653
##  [257] 5.147559 4.666797 5.518523 5.968888 4.687160 5.253465 5.181595 4.917731
##  [265] 5.460886 5.848496 6.174812 5.532825 4.819207 4.975471 5.857759 5.448704
##  [273] 4.567108 6.224700 5.383355 5.951360 5.342444 6.224991 7.063858 5.920088
##  [281] 5.762049 5.686496 5.108715 5.317684 4.933784 5.415211 5.297130 5.292009
##  [289] 5.824780 5.887404 5.445744 5.813550 5.147047 6.026522 5.582780 5.868467
##  [297] 6.515628 4.899835 5.483996 6.104132 5.011129 5.938354 4.429912 5.047626
##  [305] 5.478882 5.718142 5.947486 5.633479 5.882611 5.423205 5.565210 3.941482
##  [313] 5.572920 5.643944 4.558274 4.491910 6.259940 5.812398 4.520367 4.988111
##  [321] 6.126802 6.570490 6.443818 6.116863 5.694632 5.892621 5.200710 6.206657
##  [329] 4.896445 5.354458 5.392115 5.084278 4.510475 4.162911 5.425874 5.421021
##  [337] 5.279961 5.719485 5.003716 5.404699 4.623271 5.901390 5.331591 6.740422
##  [345] 5.501967 6.239305 5.136553 5.272735 5.217876 6.069604 5.273860 5.214870
##  [353] 5.834624 4.857225 5.115195 5.073590 5.673244 6.288553 4.833588 5.079661
##  [361] 6.021549 6.528303 4.788386 5.309415 5.351731 5.649785 4.992545 5.213174
##  [369] 5.493670 6.247038 6.419886 6.263717 4.830148 5.642591 5.099402 3.651884
##  [377] 5.003781 4.944350 3.494121 5.230254 5.693471 5.427756 6.222895 4.645408
##  [385] 5.228410 5.651412 6.749457 6.166396 6.066530 5.104433 6.324110 5.269610
##  [393] 4.839769 6.914095 5.679454 5.932031 5.700533 5.899643 5.211892 5.580486
##  [401] 5.717447 5.420553 6.047265 4.815190 4.697055 5.291483 5.489613 5.834125
##  [409] 5.167855 5.648871 5.219623 4.645364 6.699366 4.931150 6.683547 4.975031
##  [417] 4.666283 5.859728 5.071972 5.165515 5.529733 5.451040 4.686386 5.390194
##  [425] 5.824026 4.587366 4.995735 5.258500 4.656426 5.505616 4.737069 5.876266
##  [433] 5.344230 6.758572 7.044363 5.823894 5.294875 5.010944 5.326877 6.555791
##  [441] 5.656474 5.306786 5.624647 5.763395 6.393253 5.566336 6.309720 5.879399
##  [449] 4.559250 6.401816 5.661604 5.110082 5.232359 6.761349 5.626387 5.279330
##  [457] 5.505087 5.496660 5.997142 5.620839 5.307218 5.493373 5.827494 5.614295
##  [465] 4.910031 5.839670 5.676724 4.577048 4.919680 5.170595 6.192470 5.358233
##  [473] 5.567197 5.593617 5.415632 6.515388 4.570166 5.507152 5.060601 5.517382
##  [481] 5.523182 5.328665 5.678428 5.997917 5.447862 6.149402 5.903219 5.432919
##  [489] 5.339903 5.418072 6.041234 4.205678 5.900034 4.585319 6.160252 5.370325
##  [497] 5.125423 5.659365 5.698207 5.346538 6.490163 4.980016 5.819829 5.927340
##  [505] 4.943976 5.979907 5.248590 4.656218 5.590080 4.223032 5.719803 5.981796
##  [513] 5.293608 6.106182 5.235243 4.796030 5.438438 4.673073 5.089780 6.419244
##  [521] 5.353933 5.381652 5.470525 5.569381 5.033766 5.864050 5.084895 5.010908
##  [529] 5.823833 6.730452 5.363621 4.499953 5.011106 4.763365 4.709202 6.470128
##  [537] 5.014221 6.271828 5.733738 5.831957 4.949795 5.149452 6.013225 5.370443
##  [545] 5.424047 6.322905 5.645399 6.866456 7.047611 6.248199 5.465685 4.222859
##  [553] 5.177431 4.978199 4.810072 4.579409 5.351100 5.388347 5.188592 5.744249
##  [561] 4.930916 5.951106 6.107270 6.105032 4.812485 4.334092 5.042018 5.874186
##  [569] 5.335846 6.410238 4.708212 4.589264 6.394967 4.987504 5.317099 4.921440
##  [577] 5.859360 4.975348 5.129490 5.291076 4.507050 4.954729 4.887258 4.951590
##  [585] 4.817087 5.288966 5.633440 5.467955 5.822204 4.735596 4.539159 5.724656
##  [593] 5.205789 4.911228 6.438306 5.105900 5.044926 6.314801 4.960397 5.223303
##  [601] 5.671284 5.872461 5.058451 4.790772 5.547913 5.110406 4.727390 5.188801
##  [609] 5.310020 4.887537 5.635017 5.281763 5.362775 4.607783 6.226574 5.156050
##  [617] 5.155685 5.604776 5.694536 5.923046 5.025073 4.925514 5.449492 5.449851
##  [625] 5.069821 6.316200 6.491826 5.921609 5.311796 6.006278 5.080713 5.665580
##  [633] 7.002622 5.816017 5.657794 5.623887 5.552691 5.313129 5.589053 5.470761
##  [641] 5.077439 5.393051 6.094549 4.898242 6.454321 4.959539 5.533122 5.079455
##  [649] 5.429490 5.461121 5.892950 4.760467 4.939814 5.617570 5.583998 6.029490
##  [657] 5.765476 5.393954 4.561855 5.924876 5.043377 5.176829 6.288178 5.639211
##  [665] 5.288653 5.323565 6.292976 6.682952 6.581737 4.686025 5.406136 5.047625
##  [673] 4.664726 5.830890 5.077602 5.433860 4.661098 6.295004 5.520582 5.691313
##  [681] 6.207427 4.643207 4.536410 6.583748 5.078893 4.672209 5.259182 5.583797
##  [689] 5.318493 5.774594 6.414333 5.704114 5.298108 5.915040 6.302429 4.602548
##  [697] 5.980011 5.464283 5.443386 5.311763 5.638537 5.173680 5.241457 5.196732
##  [705] 5.650890 6.746284 3.827292 5.623857 6.468530 5.318957 5.930201 4.601005
##  [713] 5.169923 5.679512 5.146218 4.831097 5.645148 6.365144 5.604888 5.290845
##  [721] 6.656409 5.409651 4.845658 5.585318 6.078243 4.963304 4.839141 5.303172
##  [729] 5.001453 4.853952 6.295917 5.535831 5.526155 6.380614 5.334328 5.617299
##  [737] 4.886293 5.609871 4.946660 4.676233 5.179922 5.408290 5.473896 5.151752
##  [745] 5.347430 5.406055 5.563501 4.956205 5.736472 4.776668 5.426516 5.517282
##  [753] 4.552135 6.004798 6.648548 4.724774 4.728907 5.475616 5.249338 5.017997
##  [761] 5.585049 5.412586 4.471075 6.401912 6.279737 4.886997 5.064448 6.447070
##  [769] 4.990685 5.715973 4.996236 4.715209 4.918222 5.935043 5.142893 5.281906
##  [777] 6.134859 5.247784 5.284013 5.526028 5.542817 5.586890 6.579543 5.042064
##  [785] 5.304707 4.454545 4.558359 5.593701 5.864181 5.868731 5.812478 5.030983
##  [793] 4.887841 5.530558 5.886579 5.754363 5.251569 6.887997 4.866740 5.626930
##  [801] 5.816094 6.259763 5.671692 5.793339 5.102684 4.529204 4.822549 4.938960
##  [809] 5.342537 5.248683 5.583804 6.179821 5.205857 4.882124 6.529293 5.344827
##  [817] 4.603925 6.029336 5.059175 4.824706 5.357083 4.869198 3.679600 6.086454
##  [825] 4.671062 6.172219 6.111059 5.066975 5.995053 4.992745 4.616861 4.719607
##  [833] 5.727202 4.812067 5.090828 4.928017 6.153932 5.082753 4.884595 5.354150
##  [841] 5.613485 5.255269 5.471433 5.803369 4.476267 5.863554 5.705285 4.784082
##  [849] 6.654877 5.420101 4.735719 5.382605 5.596769 5.441819 5.911021 4.915449
##  [857] 4.602496 5.019453 5.207152 4.801132 6.052355 6.186298 5.411848 5.438550
##  [865] 6.307387 5.034471 5.844043 4.650798 4.715343 6.374211 5.269856 4.676280
##  [873] 5.118930 5.563294 5.767063 5.330194 5.603388 6.145459 5.358729 6.125928
##  [881] 4.462031 5.103516 6.787669 5.988593 5.524328 5.177120 5.643472 6.454820
##  [889] 5.069440 5.033270 5.749102 4.876910 5.344713 5.651901 4.951807 5.452070
##  [897] 5.223368 4.539310 6.084998 6.839013 5.064130 5.578992 5.299960 7.134478
##  [905] 5.336398 5.991049 5.130393 5.355242 4.912503 5.393655 5.128546 5.776272
##  [913] 5.900075 5.248202 4.838368 5.004980 5.624669 4.897004 5.350120 4.792970
##  [921] 5.247386 5.396151 5.843045 4.768742 5.622255 5.144835 6.709401 4.884988
##  [929] 4.534265 5.613547 5.179974 5.035652 5.409945 4.817017 5.676707 6.084031
##  [937] 5.814191 4.892477 4.744969 5.216515 4.769660 5.992562 5.603937 5.412281
##  [945] 5.525922 5.960855 5.746896 5.373283 5.452030 5.612705 6.183900 5.168654
##  [953] 5.917644 4.872935 5.661680 5.379435 4.939169 5.327345 6.124504 5.769548
##  [961] 3.867053 4.496958 6.047610 5.779120 6.283248 5.732465 5.037656 6.103381
##  [969] 5.750601 5.025362 4.948621 5.968585 6.440133 5.035152 6.392193 5.800873
##  [977] 5.877060 5.002366 4.499273 5.474098 6.403544 4.401033 6.239325 5.385557
##  [985] 5.888133 6.144482 5.802325 4.838382 6.657979 5.761243 5.483952 6.708440
##  [993] 4.937843 5.477352 5.159454 5.636442 4.751123 5.504077 5.438781 5.384292</code></pre>
<p>The <em>estmeansd</em> library uses Box-Cox method for estimating mean and sd when the data available are the median, minimum and maximum values.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="statistics.html#cb123-1" tabindex="-1"></a><span class="fu">library</span>(estmeansd)</span>
<span id="cb123-2"><a href="statistics.html#cb123-2" tabindex="-1"></a></span>
<span id="cb123-3"><a href="statistics.html#cb123-3" tabindex="-1"></a>res_bc <span class="ot">&lt;-</span> <span class="fu">bc.mean.sd</span>(<span class="at">min.val =</span> <span class="dv">13</span>, <span class="at">med.val =</span> <span class="dv">16</span>, <span class="at">max.val =</span> <span class="dv">42</span>, <span class="at">n =</span> <span class="dv">230</span>)</span>
<span id="cb123-4"><a href="statistics.html#cb123-4" tabindex="-1"></a>res_bc </span></code></pre></div>
<pre><code>## $est.mean
## [1] 16.78124
## 
## $est.sd
## [1] 3.620486</code></pre>
<p>Again, the standard error from the mean can be estimated using <em>get_SE</em> function.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="statistics.html#cb125-1" tabindex="-1"></a><span class="fu">get_SE</span>(res_bc)</span></code></pre></div>
<pre><code>## $est.se
## [1] 0.3159123
## 
## $boot_means
##    [1] 16.36973 16.26959 17.15367 16.99423 16.50695 16.44299 16.42387 16.98426
##    [9] 16.78352 16.63405 16.62343 16.89744 17.08555 16.94106 17.28476 17.06704
##   [17] 16.75130 17.18460 16.98813 17.16287 16.96256 16.58709 16.69938 16.76587
##   [25] 16.73740 16.46059 16.69920 16.25824 17.00254 16.72158 16.54072 16.48712
##   [33] 16.97876 16.35847 16.86901 16.70816 16.63981 16.41903 16.90855 17.19039
##   [41] 17.07629 16.52323 16.99125 17.23578 17.49192 16.82722 16.76278 16.28822
##   [49] 17.01032 15.68034 16.94514 16.23976 16.47511 16.55716 16.98608 16.53124
##   [57] 16.24602 16.86618 17.24514 17.11329 17.30023 17.03223 16.80849 16.79404
##   [65] 16.53742 16.44880 16.63283 16.69111 16.82805 16.30253 16.65515 16.70346
##   [73] 16.77453 17.01370 16.95549 16.76316 16.73695 17.40289 17.20127 16.80803
##   [81] 16.84626 16.69448 16.85048 17.09828 16.59719 16.93714 16.82467 16.82607
##   [89] 16.81953 16.72016 16.85915 16.30198 16.73639 16.91168 17.18413 16.59540
##   [97] 16.65999 16.96364 16.81121 16.77963 17.03040 16.75472 17.05038 16.62802
##  [105] 16.23991 16.75458 16.86683 17.05859 16.86960 16.45787 16.82899 17.29005
##  [113] 16.79918 16.93983 17.53061 16.33062 17.17673 16.70287 17.05058 16.12741
##  [121] 16.63928 16.71883 16.35350 16.61079 16.88738 16.60579 16.49803 16.30194
##  [129] 16.67693 16.95848 16.69098 16.42750 16.94493 16.71006 16.89458 17.14519
##  [137] 16.43907 16.67258 16.96296 16.76290 16.47362 16.47884 17.06306 16.83980
##  [145] 16.06349 17.16829 16.91773 16.47392 16.79342 16.60466 16.38919 16.49888
##  [153] 16.99507 16.53215 16.70120 17.00818 16.74855 16.86533 17.20879 17.04889
##  [161] 16.24091 16.93588 17.08367 16.97088 16.62772 16.16024 16.13778 16.91182
##  [169] 16.35503 16.93954 16.59574 16.35616 16.80774 16.84431 16.81273 16.38367
##  [177] 16.74247 16.21357 16.13404 16.78408 17.42786 16.60172 17.09061 16.17013
##  [185] 16.66935 16.69080 16.89354 17.05117 16.66628 16.62785 16.87970 16.65018
##  [193] 16.44962 16.75080 16.23912 16.66394 16.67615 16.67911 17.01115 16.94477
##  [201] 16.56759 16.56466 16.91971 16.59605 16.86052 17.08419 16.49942 16.66458
##  [209] 16.53169 16.59244 16.61559 17.19243 17.02631 17.02976 17.18629 16.57196
##  [217] 15.79763 16.80512 16.48449 16.37687 17.41089 16.97118 16.25090 16.40284
##  [225] 17.02110 16.89981 16.58425 16.42443 16.28519 16.23113 16.73430 17.14037
##  [233] 16.66805 16.78579 16.30748 16.76084 16.65057 17.18279 16.85925 16.57478
##  [241] 16.30637 16.77129 17.22633 17.38975 16.83617 16.33566 16.72377 16.56743
##  [249] 16.60390 15.87243 16.53648 16.23392 16.34739 16.89679 16.25021 16.45676
##  [257] 16.70540 16.57933 16.82619 16.79891 16.73346 17.05746 17.05204 16.56101
##  [265] 16.65671 16.53367 16.60603 16.54302 16.00751 16.74156 17.02438 16.54077
##  [273] 16.36353 16.24136 16.42610 16.37338 16.84456 16.40193 16.40273 17.25834
##  [281] 16.74074 17.43928 16.00240 16.60039 16.45353 17.28571 17.48714 16.65773
##  [289] 16.13030 16.65032 16.50968 16.41920 17.02514 17.62715 16.51872 16.67063
##  [297] 17.40139 17.22806 16.51793 16.54786 16.67101 17.04019 16.97991 17.27122
##  [305] 16.56782 16.99257 17.12488 17.21700 16.27769 16.50109 16.47647 17.19398
##  [313] 16.86099 16.95269 17.15347 16.85541 16.86235 16.75945 16.69410 16.88384
##  [321] 16.86754 16.51141 16.50254 16.96486 16.95914 17.18383 16.67440 16.64490
##  [329] 16.58350 17.20387 16.84474 16.68643 16.45480 16.54660 16.79606 16.38367
##  [337] 17.11011 16.37519 17.14697 16.18132 16.76253 16.78539 17.26325 17.25802
##  [345] 16.46341 16.52816 17.03003 16.65299 16.68593 16.94635 17.09230 16.52622
##  [353] 16.17896 16.76537 17.00097 17.29503 17.00798 17.66089 16.82277 16.57139
##  [361] 16.75770 17.08259 16.84982 16.99257 16.88009 16.24903 16.71581 16.83071
##  [369] 16.97234 16.29096 16.19888 16.62610 16.46730 16.70092 16.49502 16.81694
##  [377] 16.91403 15.85259 16.89564 16.76808 16.57812 17.08142 16.57232 16.75247
##  [385] 16.85689 16.74915 16.64331 16.51011 16.85667 16.45775 16.48361 16.66253
##  [393] 16.67812 16.69544 16.40539 16.42139 16.34774 16.77001 16.82512 16.91338
##  [401] 16.83103 16.70386 16.92199 17.11315 16.70775 17.11525 16.65999 16.54482
##  [409] 17.09486 17.41458 16.53813 16.63457 17.09072 16.81325 16.63614 16.37419
##  [417] 15.99529 16.26886 16.68993 16.27791 16.65338 16.54244 17.43239 16.68714
##  [425] 16.29587 16.48584 16.28397 16.73755 16.71296 16.90813 16.53424 17.13808
##  [433] 16.32874 17.14689 16.71519 17.33409 16.90919 16.79635 16.32951 16.50025
##  [441] 16.37119 16.84596 16.81688 16.95170 16.91929 16.76323 16.92719 16.75952
##  [449] 16.57545 16.21785 16.77096 16.27476 16.80831 16.95874 16.50792 16.58709
##  [457] 16.70994 16.78106 16.52777 17.06643 16.73931 17.06445 17.35841 16.50568
##  [465] 16.99678 17.11555 16.56226 16.70004 16.62809 16.95858 16.67948 16.77986
##  [473] 16.39063 16.51609 16.04964 16.32628 16.57039 16.86468 16.74463 16.47243
##  [481] 16.85655 16.39082 16.82126 16.44048 17.17999 16.64418 16.74448 16.79964
##  [489] 16.82838 16.55194 16.44275 16.58281 16.56972 16.46403 16.87781 16.46420
##  [497] 16.73327 16.57401 16.92828 17.08860 16.62427 16.70391 16.74120 16.63360
##  [505] 16.50652 16.69655 17.05761 16.52812 17.36965 16.38375 16.75356 16.53499
##  [513] 16.19562 17.08247 16.66410 16.13667 16.96927 16.93219 16.94747 16.71714
##  [521] 16.34261 16.80583 16.57502 17.29676 16.82173 16.98816 16.31219 16.79340
##  [529] 17.01923 16.92699 16.54377 16.36797 16.81079 16.92759 17.30632 16.96824
##  [537] 16.51046 16.61998 16.24233 16.79523 16.56170 16.71196 16.95795 18.33661
##  [545] 17.18579 16.93046 16.76086 16.59735 16.78579 17.04590 16.39890 16.53154
##  [553] 16.79962 17.16866 16.63212 17.03289 16.79951 16.94249 16.39897 16.34713
##  [561] 16.46465 16.38825 16.84092 16.92479 16.77783 16.66557 16.52604 16.46224
##  [569] 16.79323 16.85828 17.11775 16.38367 16.56068 16.42324 16.45903 16.45962
##  [577] 17.36002 16.48030 16.95285 16.45972 16.47051 17.00426 15.84218 16.36366
##  [585] 16.57068 16.53107 16.44098 16.82244 16.39746 17.06636 16.88655 16.82494
##  [593] 16.62890 16.73669 16.80578 16.99653 16.75817 17.07950 16.65770 16.78420
##  [601] 16.97431 16.87934 16.94552 16.56508 16.74082 16.62889 17.04612 17.17836
##  [609] 16.82873 16.84810 16.88079 17.19818 16.39110 17.03562 16.20993 16.44890
##  [617] 16.60840 16.52873 17.14295 16.57719 16.66554 16.62495 16.84439 16.61300
##  [625] 16.79903 16.97570 16.21054 17.65702 16.55222 16.44887 17.12946 16.60876
##  [633] 16.54019 17.21881 16.29327 17.49057 17.32681 16.80908 16.60157 16.62897
##  [641] 16.48142 16.89646 16.22948 16.55148 16.43596 16.54767 16.50031 17.03918
##  [649] 16.92003 16.77536 17.15081 17.21557 16.12120 16.76416 16.94676 16.58946
##  [657] 16.98680 16.35233 16.93678 16.92444 16.79805 17.27272 17.07690 17.10125
##  [665] 16.97230 16.44582 16.87599 16.95563 16.82466 17.01757 15.97212 16.69946
##  [673] 16.79473 16.75319 16.34670 16.74964 16.65019 16.82680 16.52224 16.26323
##  [681] 16.83691 16.99849 16.86732 16.76714 16.73295 16.37931 16.35051 17.05280
##  [689] 16.23735 16.66852 16.65130 17.18322 16.19692 16.37713 16.61015 16.62276
##  [697] 16.66882 16.45817 16.22517 16.52512 16.96735 16.70137 16.82120 16.83372
##  [705] 16.66437 16.73878 16.61218 16.18650 15.99904 16.50540 16.53929 16.04689
##  [713] 16.53973 16.66202 16.57512 16.84988 16.55891 16.76877 16.75588 16.20048
##  [721] 16.27279 16.61225 16.73974 16.53927 16.96328 16.33570 16.70878 16.80659
##  [729] 17.05471 16.76628 16.38485 16.90356 16.90584 16.74729 16.66225 16.70755
##  [737] 16.87592 16.47557 17.15922 16.93576 16.60867 16.78757 16.88393 16.15783
##  [745] 16.40969 16.55355 17.00276 17.10913 16.55098 17.20976 16.99988 16.65604
##  [753] 16.86026 16.17160 16.87874 16.60293 16.68585 16.84049 16.48568 16.84726
##  [761] 16.68559 16.73676 16.63654 16.92159 16.60832 17.09343 16.02369 17.04727
##  [769] 16.42171 16.83587 16.90029 16.88540 16.12857 17.04272 16.56981 16.99311
##  [777] 16.21062 16.46131 16.40626 17.08377 16.98928 16.43287 16.76586 16.58633
##  [785] 16.29393 17.22972 16.15844 16.35671 16.55516 16.84286 16.44696 17.19328
##  [793] 16.74094 16.38257 16.81642 17.39731 16.37162 17.03635 16.97702 16.93500
##  [801] 16.64938 16.11514 16.64721 16.50641 16.02462 16.54419 16.33654 17.07209
##  [809] 16.53175 17.09885 16.30357 17.01901 17.27562 16.68429 16.84448 16.80476
##  [817] 16.11307 16.70463 16.81356 16.67251 16.30904 17.15020 17.34649 16.96417
##  [825] 16.64175 16.45496 15.63400 16.06638 17.03705 16.70256 17.13728 16.80536
##  [833] 17.31248 17.68862 16.21819 17.00212 16.78805 16.80345 16.73685 16.73685
##  [841] 16.73110 17.08312 16.95506 16.62740 16.44524 16.56575 16.80096 16.48826
##  [849] 16.54367 16.68529 16.52193 17.12994 16.34951 16.45681 17.13014 16.64527
##  [857] 16.80016 17.07322 16.94762 16.66345 16.82448 16.66281 17.05681 16.59260
##  [865] 16.72742 16.78357 17.01572 16.86950 16.31317 16.34596 16.25556 16.27194
##  [873] 17.07168 16.40608 16.74455 16.11871 16.24698 16.54865 17.34100 16.48918
##  [881] 17.30348 16.68915 16.47219 16.93727 16.81465 16.47745 16.44335 16.76967
##  [889] 16.92900 16.40013 16.61865 16.23016 16.90445 17.04027 16.22503 16.43600
##  [897] 16.80781 16.58224 16.50912 17.05053 16.56332 17.59159 16.64967 16.93335
##  [905] 16.44070 16.49760 16.91786 16.82867 16.48438 17.23943 16.98639 16.53970
##  [913] 16.84294 16.72829 16.41218 16.62974 16.84380 16.70074 16.14706 17.02510
##  [921] 16.85672 16.61573 16.60829 16.62101 17.06585 17.05568 16.47491 16.85056
##  [929] 16.76036 16.81847 16.96331 16.71807 15.84350 16.76119 16.82055 17.28133
##  [937] 16.76963 17.08769 16.42012 16.28405 16.72001 16.99190 17.23154 16.49755
##  [945] 16.73118 16.96103 17.06171 16.29564 16.19179 16.96018 17.08707 16.84823
##  [953] 16.45686 16.56945 16.62067 16.62452 17.21982 16.51824 16.73902 17.31942
##  [961] 16.29060 17.14523 16.76846 16.63133 16.64148 16.89332 16.29152 16.23140
##  [969] 16.97696 16.92971 16.53565 16.57736 16.47172 16.65789 16.71904 16.64264
##  [977] 17.03039 16.05208 16.28841 16.68077 16.43984 17.44317 16.98095 17.30962
##  [985] 16.75372 16.46145 16.77164 16.47272 16.88521 16.43649 16.51152 17.03112
##  [993] 16.03235 17.24691 16.57497 16.64969 16.79522 16.38489 17.17436 16.81115
## 
## $boot_sds
##    [1] 3.264182 3.418376 3.932716 3.795006 3.069613 3.436390 3.099321 3.113991
##    [9] 3.452569 3.090469 2.879393 3.736204 3.241162 3.766938 3.419759 3.303270
##   [17] 4.059296 3.780997 3.632543 3.379127 3.495170 3.042851 3.359160 3.621717
##   [25] 3.573456 2.914606 3.778868 3.649177 3.295095 2.923588 3.612427 3.523736
##   [33] 3.229138 2.838001 3.768649 3.775954 3.197051 3.574254 3.487912 3.245528
##   [41] 4.090674 4.026209 3.535609 4.273548 3.396579 4.133195 3.812073 2.861031
##   [49] 3.169982 3.305280 4.189325 3.167602 4.071319 3.755380 3.206960 3.861171
##   [57] 3.284189 3.295953 3.269447 3.452955 3.861482 3.251825 4.096568 3.379262
##   [65] 3.440139 3.418372 3.670464 3.603019 4.004391 3.338462 3.417738 3.585078
##   [73] 3.505021 3.752981 3.500083 3.686159 2.960588 4.005144 4.499132 3.431880
##   [81] 3.432210 3.239573 3.439567 3.687517 3.576084 3.795290 4.008347 3.572013
##   [89] 3.653796 3.578549 3.359999 3.236256 3.705913 3.625569 3.170197 3.435856
##   [97] 3.310435 3.559463 3.548488 3.409081 3.321605 2.720577 4.612444 3.756732
##  [105] 3.180137 3.613094 3.971182 3.748473 3.770371 3.323233 3.726403 4.448761
##  [113] 2.987376 3.416082 5.506258 3.435194 4.084867 3.772661 3.502890 3.125588
##  [121] 3.119383 3.389357 3.042282 3.282791 3.611949 3.417841 3.572956 3.075772
##  [129] 2.944630 3.657422 3.066889 3.745515 3.986879 3.556461 4.111367 4.137441
##  [137] 3.429734 3.539527 3.855382 3.002673 3.831407 2.950028 4.079331 3.004020
##  [145] 3.119800 4.057617 2.891926 3.565651 4.269538 2.647824 3.487349 3.198616
##  [153] 3.459444 3.561287 3.872447 3.743527 3.611397 3.893483 4.619937 3.534512
##  [161] 2.742440 4.077612 3.620109 3.179951 3.966954 3.352741 3.072035 3.604001
##  [169] 3.167692 3.139057 3.636682 2.897616 3.821965 3.037641 3.914581 4.020814
##  [177] 3.771760 3.138272 3.065913 4.014320 3.366747 3.361011 3.373170 3.778305
##  [185] 3.339421 3.337232 4.139374 3.193079 3.128200 2.810621 3.528943 3.779581
##  [193] 3.419653 3.086784 3.622297 3.347213 3.410731 3.106687 3.164729 3.576663
##  [201] 3.922356 3.525507 3.457198 2.809101 3.317588 3.441519 3.097974 3.649405
##  [209] 3.198746 3.386181 3.333921 3.870369 3.094455 3.507341 3.010325 3.302368
##  [217] 3.277465 2.971946 3.650121 3.002781 3.954294 3.636956 2.808485 3.758429
##  [225] 3.263053 3.059024 2.894830 3.339247 3.121393 3.268377 2.946377 3.509391
##  [233] 3.687356 3.989971 2.849603 3.814641 3.553129 2.979581 3.339749 2.736347
##  [241] 3.591554 3.571315 3.207949 3.848883 3.551386 3.081271 3.359414 3.614249
##  [249] 3.582412 3.376709 3.183789 3.387132 3.263553 3.833580 3.413982 4.025458
##  [257] 3.174474 3.205528 3.389808 3.550245 3.917385 3.263371 3.509697 2.837625
##  [265] 3.183534 3.171587 3.318419 3.125639 3.215982 4.113004 3.507506 2.871281
##  [273] 3.432916 3.175857 3.032239 3.275164 3.728799 3.593591 3.951161 4.364166
##  [281] 3.510333 4.100162 3.410970 3.232910 3.609139 4.492185 4.342234 3.730900
##  [289] 3.167265 3.327680 3.274618 2.662536 4.538888 4.471745 3.753700 3.633862
##  [297] 4.032058 3.320144 3.698934 3.454676 3.672060 3.219689 3.905211 4.107642
##  [305] 3.235399 3.197131 3.807245 3.512023 3.158438 2.936324 3.751188 4.635299
##  [313] 3.365060 3.791094 4.271068 4.401397 3.374408 2.823567 3.892038 3.616760
##  [321] 3.850892 3.612608 3.084603 3.539548 4.073666 3.156320 4.368271 3.238571
##  [329] 3.441248 3.653182 3.443686 3.842500 3.551969 3.646523 3.715986 3.281970
##  [337] 3.558923 3.050573 4.242872 3.321248 4.096506 3.049693 3.074409 3.979592
##  [345] 3.487491 3.313128 3.789699 3.987664 4.066909 3.475707 3.945821 3.345379
##  [353] 4.158270 3.683315 3.478480 3.465037 4.470237 4.217957 3.675478 2.967205
##  [361] 4.322614 3.344593 3.808490 3.783870 3.745493 3.646180 3.981218 3.756838
##  [369] 3.173168 3.260170 3.250382 3.484825 3.155605 3.643781 3.348504 2.863868
##  [377] 3.353840 2.772940 3.366758 3.242734 3.341592 4.046132 4.173502 4.515962
##  [385] 3.202536 4.227307 3.444041 3.042600 3.901144 3.127504 3.065007 3.118010
##  [393] 3.125256 4.150804 3.606647 3.150403 3.752830 3.967585 3.157963 3.557310
##  [401] 3.605610 3.596658 3.762793 3.361204 3.765957 3.608816 3.267626 3.761628
##  [409] 4.116622 4.236546 3.312256 3.929905 3.815533 4.098206 3.452381 2.997136
##  [417] 3.502736 2.942726 3.125612 3.298176 4.048384 3.261338 3.730924 4.468409
##  [425] 3.033877 3.650795 3.217927 3.652971 3.431543 3.993474 3.128276 3.855188
##  [433] 3.660562 3.322822 3.633776 3.472746 3.884586 3.295202 2.949342 3.220745
##  [441] 3.366773 3.585871 3.127912 3.585358 4.111919 4.090255 3.755996 4.375369
##  [449] 3.111411 3.400097 3.554110 3.826832 3.830430 3.150484 4.189604 3.508631
##  [457] 3.398438 3.874979 3.585876 3.984280 3.353826 3.660583 4.231112 3.355197
##  [465] 4.580917 3.771765 3.411449 3.633709 2.857635 3.816200 3.324032 3.460065
##  [473] 3.100667 2.972554 2.827177 3.144622 4.023099 3.306584 3.398619 3.324185
##  [481] 3.117681 3.121548 3.799754 4.001135 3.588927 3.669891 3.485010 3.326286
##  [489] 3.000027 3.973667 3.924897 3.635658 3.245561 3.244730 3.465272 3.132523
##  [497] 3.118825 3.575121 3.883939 3.396254 3.767161 3.756996 3.077979 3.207658
##  [505] 3.259309 3.627140 3.591418 3.540149 4.179355 3.562536 3.194569 3.320695
##  [513] 2.941146 4.173100 3.207109 3.372506 3.270854 3.382505 3.786408 4.150548
##  [521] 3.128650 2.879557 3.946464 3.552278 4.050953 3.718928 3.821732 4.053841
##  [529] 3.058260 3.215532 3.160763 3.209559 3.056723 3.349210 4.173329 3.856314
##  [537] 2.653713 3.321594 3.384212 3.490172 3.721798 3.758429 3.428290 4.801830
##  [545] 3.025675 3.871824 4.243442 3.940235 3.240833 3.278041 3.245486 2.992356
##  [553] 3.869419 3.517569 3.744510 3.261348 3.277176 4.407540 3.796034 3.480293
##  [561] 3.631274 3.610812 3.356866 3.044602 3.484969 4.045006 3.878764 3.246457
##  [569] 3.599969 3.279187 4.660049 2.989905 3.338677 3.790684 3.442193 3.326226
##  [577] 3.919704 3.577685 3.627042 2.866037 3.592285 3.766975 3.376956 2.915494
##  [585] 3.263889 3.259055 3.657590 3.221764 3.763808 3.872490 3.829631 3.962709
##  [593] 3.391220 3.283148 3.653979 4.040265 3.570027 3.650016 3.711116 3.969934
##  [601] 3.927569 3.694481 3.455100 3.113650 4.030127 3.520432 3.493645 4.249365
##  [609] 3.052656 3.845868 3.255132 3.557718 3.234342 4.127674 3.132973 3.729119
##  [617] 3.092757 3.147351 3.604325 3.282239 3.285520 3.177613 4.145934 3.038349
##  [625] 4.707794 3.530747 3.401670 4.997580 3.180520 2.905210 3.482746 3.384550
##  [633] 4.231672 3.713316 3.411735 3.662421 2.924949 3.755152 3.277508 3.599831
##  [641] 4.157821 4.312789 3.604197 3.334106 2.844432 3.534574 3.210223 4.074067
##  [649] 4.323200 4.166404 4.106195 3.617295 3.131354 3.978741 3.996458 3.871800
##  [657] 3.028138 3.298059 4.805999 3.521498 3.806930 3.981129 3.430258 3.499189
##  [665] 3.538910 3.521121 3.661071 4.169927 3.369941 3.251937 2.698638 3.849038
##  [673] 3.195816 3.791119 2.774958 3.619281 2.827243 4.231934 3.440605 3.946497
##  [681] 3.757376 2.982780 3.345506 3.431029 3.104652 3.191600 2.905148 3.328158
##  [689] 3.287103 3.072161 3.304793 3.529981 3.256706 3.422790 4.295426 3.536459
##  [697] 3.436829 3.220782 3.654813 3.700072 3.637473 3.530435 3.689524 3.854380
##  [705] 3.891200 3.779232 3.273631 3.329925 3.187480 3.847353 3.670424 3.310614
##  [713] 3.750767 3.507532 3.628694 4.004821 3.321927 3.571425 3.283250 3.172466
##  [721] 3.247915 3.453006 4.071563 3.115548 3.506210 4.256353 3.693314 3.227266
##  [729] 3.496090 3.675148 3.270293 3.914011 3.800973 3.690842 3.934800 3.337933
##  [737] 4.058072 3.550461 3.644089 3.401106 3.284553 3.723558 4.057453 3.097510
##  [745] 3.836434 3.612400 3.216805 4.194662 3.370697 3.641619 3.323020 3.808600
##  [753] 3.742380 3.362296 3.433816 3.184576 3.534217 3.229022 2.893914 3.246719
##  [761] 3.227099 3.167585 2.956596 4.070301 4.003043 4.509743 3.120401 4.163270
##  [769] 3.218876 3.242766 4.100840 3.563980 3.150512 3.627708 3.202831 4.045488
##  [777] 3.298380 3.583789 3.238806 3.300094 2.925929 3.214629 3.538181 3.070173
##  [785] 2.834629 3.033402 3.378662 3.158016 3.091672 3.397129 3.330504 3.848741
##  [793] 3.248977 3.295594 3.551946 4.236654 3.251598 3.443984 3.666744 3.384738
##  [801] 3.597379 3.296553 3.172919 3.058908 3.082289 3.389394 3.442150 4.037325
##  [809] 2.943633 3.676389 3.815390 4.043682 3.788352 2.946725 4.275520 3.070346
##  [817] 3.184300 3.792581 3.330125 3.613747 3.617658 3.856718 4.059394 3.708987
##  [825] 4.008422 3.197150 3.150639 2.781830 3.242113 3.545551 3.756044 3.589395
##  [833] 3.541244 4.910870 3.356783 3.263611 3.565128 3.307845 3.149260 3.476994
##  [841] 3.985597 3.347145 3.487662 3.330715 3.552659 3.308505 3.197583 3.026830
##  [849] 4.160975 3.545647 3.627798 3.565644 3.368064 3.288666 3.793541 3.302400
##  [857] 2.729409 3.959457 3.586160 3.850309 3.267162 3.044379 3.649068 3.423654
##  [865] 3.402048 3.083647 3.104269 3.691172 3.214212 3.376767 3.145955 3.166966
##  [873] 4.029460 3.556094 3.990011 3.139759 3.440092 3.450066 3.920659 3.839055
##  [881] 3.812033 3.484365 3.750943 4.166221 3.141597 3.661891 3.084659 3.944101
##  [889] 3.356693 3.429664 3.177593 3.067911 3.095241 3.368960 3.285935 3.420135
##  [897] 3.566470 4.081723 4.070337 3.940898 3.087301 3.925171 4.176834 3.364506
##  [905] 3.108096 3.619150 3.351012 3.618631 3.337634 3.529120 3.588882 3.102779
##  [913] 3.920161 3.636429 3.025325 3.277448 4.158195 3.631935 3.637149 3.255857
##  [921] 2.850887 3.811913 3.697684 4.373025 3.082950 3.939794 3.358903 3.389415
##  [929] 3.402311 2.956566 4.216493 3.947544 3.406696 3.647556 3.424345 3.814961
##  [937] 3.209986 3.768225 3.899379 2.765531 4.109358 3.223380 4.211539 3.654200
##  [945] 3.653490 3.060703 3.677096 3.123564 4.153492 3.731190 4.068915 4.031333
##  [953] 3.160970 3.191364 3.716898 3.694887 3.717072 3.303185 3.935567 4.479094
##  [961] 2.994234 4.005467 3.762583 2.927552 2.913867 3.567580 3.421111 3.092572
##  [969] 3.218826 4.073425 3.250302 3.059792 3.175819 3.215261 4.390667 3.199830
##  [977] 4.350301 4.132403 2.924961 3.918884 3.023725 3.404476 3.609961 3.219822
##  [985] 3.780715 3.336336 3.951050 3.214295 4.511409 3.200575 2.953631 3.281720
##  [993] 2.915015 3.997553 3.814915 3.758164 4.367444 3.785744 3.520424 3.355724</code></pre>
</div>
<div id="inconsistency-i2" class="section level3 hasAnchor" number="4.9.4">
<h3><span class="header-section-number">4.9.4</span> Inconsistency I2<a href="statistics.html#inconsistency-i2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The inconsistency <span class="math inline">\(I^2\)</span> index is the sum of the squared deviations from the overall effect and weighted by the study size. Value &lt;25% is classified as low
and greater than 75% as high heterogeneity. This test can be performed using metafor package <span class="citation">(<a href="#ref-JSSv036i03">Viechtbauer 2010</a>)</span>. The presence of high <span class="math inline">\(I^2\)</span> suggests a need to proceed to meta-regression on the data to understand the source of heterogeneity. The fixed component were the covariates which were being tested for their effect on heterogeneity. The random effect components were the sensitivity and FPR. The <span class="math inline">\(I^2\)</span> value for the TIA clinic study is 34.41%. As such meta-regression is not needed for that study. By contrast, the <span class="math inline">\(I^2\)</span> is much higher for the spot sign study, necessitating metaregression.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="statistics.html#cb127-1" tabindex="-1"></a><span class="fu">library</span>(PRISMAstatement)</span>
<span id="cb127-2"><a href="statistics.html#cb127-2" tabindex="-1"></a></span>
<span id="cb127-3"><a href="statistics.html#cb127-3" tabindex="-1"></a><span class="co">#example from Spot sign paper. Stroke 2019</span></span>
<span id="cb127-4"><a href="statistics.html#cb127-4" tabindex="-1"></a><span class="fu">prisma</span>(<span class="at">found =</span> <span class="dv">193</span>,</span>
<span id="cb127-5"><a href="statistics.html#cb127-5" tabindex="-1"></a>       <span class="at">found_other =</span> <span class="dv">27</span>,</span>
<span id="cb127-6"><a href="statistics.html#cb127-6" tabindex="-1"></a>       <span class="at">no_dupes =</span> <span class="dv">141</span>, </span>
<span id="cb127-7"><a href="statistics.html#cb127-7" tabindex="-1"></a>       <span class="at">screened =</span> <span class="dv">141</span>, </span>
<span id="cb127-8"><a href="statistics.html#cb127-8" tabindex="-1"></a>       <span class="at">screen_exclusions =</span> <span class="dv">3</span>, </span>
<span id="cb127-9"><a href="statistics.html#cb127-9" tabindex="-1"></a>       <span class="at">full_text =</span> <span class="dv">138</span>,</span>
<span id="cb127-10"><a href="statistics.html#cb127-10" tabindex="-1"></a>       <span class="at">full_text_exclusions =</span> <span class="dv">112</span>, </span>
<span id="cb127-11"><a href="statistics.html#cb127-11" tabindex="-1"></a>       <span class="at">qualitative =</span> <span class="dv">26</span>, </span>
<span id="cb127-12"><a href="statistics.html#cb127-12" tabindex="-1"></a>       <span class="at">quantitative =</span> <span class="dv">26</span>,</span>
<span id="cb127-13"><a href="statistics.html#cb127-13" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">800</span>, <span class="at">height =</span> <span class="dv">800</span>)</span></code></pre></div>
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-32c95afc0c9dee7aa1cb" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-32c95afc0c9dee7aa1cb">{"x":{"diagram":"digraph prisma {\n    node [shape=\"box\", fontsize = 10];\n    graph [splines=ortho, nodesep=1, dpi = 72]\n    a -> nodups;\n    b -> nodups;\n    a [label=\"Records identified through\ndatabase searching\n(n = 193)\"];\n    b [label=\"Additional records identified\nthrough other sources\n(n = 27)\"]\n    nodups -> incex;\n    nodups [label=\"Records after duplicates removed\n(n = 141)\"];\n    incex -> {ex; ft}\n    incex [label=\"Records screened\n(n = 141)\"];\n    ex [label=\"Records excluded\n(n = 3)\"];\n    {rank=same; incex ex}\n    ft -> {qual; ftex};\n    ft [label=\"Full-text articles assessed\nfor eligibility\n(n = 138)\"];\n    {rank=same; ft ftex}\n    ftex [label=\"Full-text articles excluded,\nwith reasons\n(n = 112)\"];\n    qual -> quant\n    qual [label=\"Studies included in qualitative synthesis\n(n = 26)\"];\n    quant [label=\"Studies included in\nquantitative synthesis\n(meta-analysis)\n(n = 26)\"];\n  }","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="metaanalysis-of-proportion" class="section level3 hasAnchor" number="4.9.5">
<h3><span class="header-section-number">4.9.5</span> Metaanalysis of proportion<a href="statistics.html#metaanalysis-of-proportion" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is an example of metaanalysis of stroke recurrence following management in rapid TIA clinic. A variety of different methods for calculating the 95% confidence interval of the binomial distribution. The mean of the binomial distribution is given by p and the variance by <span class="math inline">\(\frac{p \times (1-p)}{n}\)</span>. The term <span class="math inline">\(z\)</span> is given by <span class="math inline">\(1-\frac{\alpha}{2}\)</span> quantile of normal distribution. A standard way of calculating the confidence interval is the Wald method <span class="math inline">\(p\pm z\times \sqrt{\frac{p \times(1-p)}{n}}\)</span>. The Freeman-Tukey double arcsine transformation tries to transform the data to a normal distribution. This approach is useful when occurence of event is rare. The exact or Clopper-Pearson method is suggested as the most conservative of the methods for calculating confidence interval for proportion. It is based on cumulative properties of the binomial distribution. The Wilson method has similarities to the Wald method. It has an extra term <span class="math inline">\(z^2/n\)</span>. There are many different methods for calculating the confidence interval for proportions. Investigators such as Agresti proposed that approximate methods are better than exact method <span class="citation">(<a href="#ref-doi:10.1080/00031305.1998.10480550">Agresti and Coull 1998</a>)</span>. Brown and colleagues proposed the use of the Wilson method <span class="citation">(<a href="#ref-brown2001">Brown, Cai, and DasGupta 2001</a>)</span></p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="statistics.html#cb128-1" tabindex="-1"></a><span class="fu">library</span>(metafor) <span class="co">#open software metafor</span></span>
<span id="cb128-2"><a href="statistics.html#cb128-2" tabindex="-1"></a><span class="co">#create data frame dat</span></span>
<span id="cb128-3"><a href="statistics.html#cb128-3" tabindex="-1"></a><span class="co">#xi is numerator</span></span>
<span id="cb128-4"><a href="statistics.html#cb128-4" tabindex="-1"></a><span class="co">#ni is denominator</span></span>
<span id="cb128-5"><a href="statistics.html#cb128-5" tabindex="-1"></a></span>
<span id="cb128-6"><a href="statistics.html#cb128-6" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model=</span><span class="fu">c</span>(<span class="st">&quot;melbourne&quot;</span>,<span class="st">&quot;paris&quot;</span>,<span class="st">&quot;oxford&quot;</span>,<span class="st">&quot;stanford&quot;</span>,<span class="st">&quot;ottawa&quot;</span>,<span class="st">&quot;new zealand&quot;</span>),</span>
<span id="cb128-7"><a href="statistics.html#cb128-7" tabindex="-1"></a><span class="at">xi=</span><span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">7</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">31</span>,<span class="dv">2</span>), </span>
<span id="cb128-8"><a href="statistics.html#cb128-8" tabindex="-1"></a><span class="at">ni=</span><span class="fu">c</span>(<span class="dv">468</span>,<span class="dv">296</span>, <span class="dv">281</span>,<span class="dv">223</span>,<span class="dv">982</span>,<span class="dv">172</span>))</span>
<span id="cb128-9"><a href="statistics.html#cb128-9" tabindex="-1"></a></span>
<span id="cb128-10"><a href="statistics.html#cb128-10" tabindex="-1"></a><span class="co">#calculate new variable pi base on ratio xi/ni</span></span>
<span id="cb128-11"><a href="statistics.html#cb128-11" tabindex="-1"></a>dat<span class="sc">$</span>pi <span class="ot">&lt;-</span> <span class="fu">with</span>(dat, xi<span class="sc">/</span>ni)</span>
<span id="cb128-12"><a href="statistics.html#cb128-12" tabindex="-1"></a></span>
<span id="cb128-13"><a href="statistics.html#cb128-13" tabindex="-1"></a><span class="co">#Freeman-Tukey double arcsine trasformation</span></span>
<span id="cb128-14"><a href="statistics.html#cb128-14" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">escalc</span>(<span class="at">measure=</span><span class="st">&quot;PFT&quot;</span>, <span class="at">xi=</span>xi, <span class="at">ni=</span>ni, <span class="at">data=</span>dat, <span class="at">add=</span><span class="dv">0</span>) </span>
<span id="cb128-15"><a href="statistics.html#cb128-15" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">rma</span>(yi, vi, <span class="at">method=</span><span class="st">&quot;REML&quot;</span>, <span class="at">data=</span>dat, <span class="at">slab=</span><span class="fu">paste</span>(model))</span>
<span id="cb128-16"><a href="statistics.html#cb128-16" tabindex="-1"></a></span>
<span id="cb128-17"><a href="statistics.html#cb128-17" tabindex="-1"></a><span class="co">#create forest plot with labels</span></span>
<span id="cb128-18"><a href="statistics.html#cb128-18" tabindex="-1"></a>metafor<span class="sc">::</span><span class="fu">forest</span>(res, <span class="at">transf=</span>transf.ipft.hm, <span class="at">targs=</span><span class="fu">list</span>(<span class="at">ni=</span>dat<span class="sc">$</span>ni), <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="fl">1.4</span>),<span class="at">refline=</span>res<span class="sc">$</span>beta[<span class="dv">1</span>],</span>
<span id="cb128-19"><a href="statistics.html#cb128-19" tabindex="-1"></a>       <span class="at">cex=</span>.<span class="dv">8</span>, <span class="at">ilab=</span><span class="fu">cbind</span>(dat<span class="sc">$</span>xi, dat<span class="sc">$</span>ni), </span>
<span id="cb128-20"><a href="statistics.html#cb128-20" tabindex="-1"></a>       <span class="co">#position of data on x-axis</span></span>
<span id="cb128-21"><a href="statistics.html#cb128-21" tabindex="-1"></a>       <span class="at">ilab.xpos=</span><span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">6</span>,<span class="sc">-</span>.<span class="dv">4</span>),<span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb128-22"><a href="statistics.html#cb128-22" tabindex="-1"></a></span>
<span id="cb128-23"><a href="statistics.html#cb128-23" tabindex="-1"></a><span class="co">#par function combine multiple plots into one</span></span>
<span id="cb128-24"><a href="statistics.html#cb128-24" tabindex="-1"></a>op <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">cex=</span>.<span class="dv">75</span>, <span class="at">font=</span><span class="dv">2</span>)</span>
<span id="cb128-25"><a href="statistics.html#cb128-25" tabindex="-1"></a><span class="co">#position of column names on x-axis</span></span>
<span id="cb128-26"><a href="statistics.html#cb128-26" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span><span class="fl">1.0</span>, <span class="fl">7.5</span>, <span class="st">&quot;model &quot;</span>,<span class="at">pos=</span><span class="dv">4</span>)</span>
<span id="cb128-27"><a href="statistics.html#cb128-27" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">55</span>,<span class="sc">-</span>.<span class="dv">2</span>), <span class="fl">7.5</span>, <span class="fu">c</span>(<span class="st">&quot;recurrence&quot;</span>, <span class="st">&quot; total subjects&quot;</span>))</span>
<span id="cb128-28"><a href="statistics.html#cb128-28" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">1.4</span>,<span class="fl">7.5</span>, <span class="st">&quot;Proportion [95% CI]&quot;</span>, <span class="at">pos=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-16-1.png" width="672" /></p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="statistics.html#cb129-1" tabindex="-1"></a><span class="fu">par</span>(op)</span></code></pre></div>
<p>Exact 95% confidence interval for proportion is provided below using the TIA
data above. This solution was provided on <em>stack overflow</em>. This is performed using the <em>binomial.test</em> function.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="statistics.html#cb130-1" tabindex="-1"></a><span class="co">#exact confidence interval</span></span>
<span id="cb130-2"><a href="statistics.html#cb130-2" tabindex="-1"></a><span class="fu">sapply</span>(<span class="fu">split</span>(dat, dat<span class="sc">$</span>model), <span class="cf">function</span>(x) <span class="fu">binom.test</span>(x<span class="sc">$</span>xi, x<span class="sc">$</span>ni)<span class="sc">$</span>conf.int)</span></code></pre></div>
<pre><code>##       melbourne new zealand     ottawa      oxford      paris    stanford
## [1,] 0.00603419 0.001411309 0.02154780 0.007875285 0.00955965 0.001087992
## [2,] 0.03057375 0.041370853 0.04451101 0.045893259 0.04811612 0.032020390</code></pre>
<p>The data needs to be transposed using <em>t</em> function. This generates one column
for lower and another for upper CI. Note that sapply returns a matrix or array
and the column names have to be assigned.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="statistics.html#cb132-1" tabindex="-1"></a><span class="co">#the data</span></span>
<span id="cb132-2"><a href="statistics.html#cb132-2" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">sapply</span>(<span class="fu">split</span>(dat, dat<span class="sc">$</span>model), <span class="cf">function</span>(x) <span class="fu">binom.test</span>(x<span class="sc">$</span>xi, x<span class="sc">$</span>ni)<span class="sc">$</span>conf.int))</span>
<span id="cb132-3"><a href="statistics.html#cb132-3" tabindex="-1"></a>tmp</span></code></pre></div>
<pre><code>##                    [,1]       [,2]
## melbourne   0.006034190 0.03057375
## new zealand 0.001411309 0.04137085
## ottawa      0.021547797 0.04451101
## oxford      0.007875285 0.04589326
## paris       0.009559650 0.04811612
## stanford    0.001087992 0.03202039</code></pre>
<p>The exact confidence is now put back into the dat data frame.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="statistics.html#cb134-1" tabindex="-1"></a>dat<span class="sc">$</span>ci.lb <span class="ot">&lt;-</span> tmp[,<span class="dv">1</span>] <span class="co">#adding column to data frame dat</span></span>
<span id="cb134-2"><a href="statistics.html#cb134-2" tabindex="-1"></a>dat<span class="sc">$</span>ci.ub <span class="ot">&lt;-</span> tmp[,<span class="dv">2</span>] <span class="co">#adding column to data frame dat</span></span>
<span id="cb134-3"><a href="statistics.html#cb134-3" tabindex="-1"></a></span>
<span id="cb134-4"><a href="statistics.html#cb134-4" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">escalc</span>(<span class="at">measure=</span><span class="st">&quot;PFT&quot;</span>, <span class="at">xi=</span>xi, <span class="at">ni=</span>ni, <span class="at">data=</span>dat, <span class="at">add=</span><span class="dv">0</span>) </span>
<span id="cb134-5"><a href="statistics.html#cb134-5" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">rma.glmm</span>(<span class="at">measure=</span><span class="st">&quot;PLO&quot;</span>, <span class="at">xi=</span>xi, <span class="at">ni=</span>ni, <span class="at">data=</span>dat)</span>
<span id="cb134-6"><a href="statistics.html#cb134-6" tabindex="-1"></a></span>
<span id="cb134-7"><a href="statistics.html#cb134-7" tabindex="-1"></a></span>
<span id="cb134-8"><a href="statistics.html#cb134-8" tabindex="-1"></a><span class="co">#insert the exact confidence interval </span></span>
<span id="cb134-9"><a href="statistics.html#cb134-9" tabindex="-1"></a><span class="fu">with</span>(dat, metafor<span class="sc">::</span><span class="fu">forest</span>(yi, <span class="at">ci.lb=</span>ci.lb, <span class="at">ci.ub=</span>ci.ub, </span>
<span id="cb134-10"><a href="statistics.html#cb134-10" tabindex="-1"></a>  <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span>,<span class="fl">8.5</span>), </span>
<span id="cb134-11"><a href="statistics.html#cb134-11" tabindex="-1"></a>  <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.1</span>,<span class="dv">1</span>), </span>
<span id="cb134-12"><a href="statistics.html#cb134-12" tabindex="-1"></a>  <span class="at">refline=</span><span class="fu">predict</span>(res, <span class="at">transf=</span>transf.ilogit)<span class="sc">$</span>pred,</span>
<span id="cb134-13"><a href="statistics.html#cb134-13" tabindex="-1"></a>  <span class="at">cex=</span>.<span class="dv">8</span>, </span>
<span id="cb134-14"><a href="statistics.html#cb134-14" tabindex="-1"></a>  <span class="at">ilab=</span><span class="fu">cbind</span>(dat<span class="sc">$</span>xi, dat<span class="sc">$</span>ni), </span>
<span id="cb134-15"><a href="statistics.html#cb134-15" tabindex="-1"></a>  <span class="at">ilab.xpos=</span><span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">6</span>,<span class="sc">-</span>.<span class="dv">2</span>),<span class="at">digits=</span><span class="dv">3</span>))</span>
<span id="cb134-16"><a href="statistics.html#cb134-16" tabindex="-1"></a>  </span>
<span id="cb134-17"><a href="statistics.html#cb134-17" tabindex="-1"></a>op <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">cex=</span>.<span class="dv">75</span>, <span class="at">font=</span><span class="dv">2</span>)</span>
<span id="cb134-18"><a href="statistics.html#cb134-18" tabindex="-1"></a><span class="fu">addpoly</span>(res, <span class="at">row=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">transf=</span>transf.ilogit)</span>
<span id="cb134-19"><a href="statistics.html#cb134-19" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span>
<span id="cb134-20"><a href="statistics.html#cb134-20" tabindex="-1"></a><span class="co">#position of column names on x-axis</span></span>
<span id="cb134-21"><a href="statistics.html#cb134-21" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span>.<span class="dv">9</span>, <span class="fl">7.5</span>, <span class="st">&quot;Model&quot;</span>, <span class="at">pos=</span><span class="dv">2</span>)</span>
<span id="cb134-22"><a href="statistics.html#cb134-22" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">55</span>,<span class="sc">-</span>.<span class="dv">2</span>), <span class="fl">7.5</span>, <span class="fu">c</span>(<span class="st">&quot;recurrence&quot;</span>, <span class="st">&quot; total subjects&quot;</span>))</span>
<span id="cb134-23"><a href="statistics.html#cb134-23" tabindex="-1"></a><span class="fu">text</span>( <span class="dv">1</span>,   <span class="fl">7.5</span>, <span class="st">&quot;Proportion [95% CI]&quot;</span>, <span class="at">pos=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/Statistics-16-3-1.png" width="672" /></p>
</div>
<div id="metaanalysis-of-continuous-data" class="section level3 hasAnchor" number="4.9.6">
<h3><span class="header-section-number">4.9.6</span> Metaanalysis of continuous data<a href="statistics.html#metaanalysis-of-continuous-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Metanalysis of continuous outcome data can be performed using standardised mean difference or ratio of means. It is available in the <em>meta</em> library using <em>metacont</em> function <span class="citation">(<a href="#ref-doi10.1136/ebmental-2019-300117">Balduzzi, Rcker, and Schwarzer 2019</a>)</span>.</p>
</div>
<div id="bivariate-metaanalysis" class="section level3 hasAnchor" number="4.9.7">
<h3><span class="header-section-number">4.9.7</span> Bivariate Metaanalysis<a href="statistics.html#bivariate-metaanalysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The univariate method of Moses-Shapiro-Littenberg combines these measures (sensitivity and specificity) into a single measure of accuracy (diagnostic odds ratio)<span class="citation">(<a href="#ref-pmid8210827">Moses, Shapiro, and Littenberg 1993</a>)</span> . This approach has been criticized for losing data on sensitivity and specificity of the test. Similar to the univariate method, the bivariate method employs a random effect to take into account the within study correlation <span class="citation">(<a href="#ref-pmid16168343">Reitsma et al. 2005</a>)</span>. Additionally, the bivariate method also accounts
for the between-study correlation in sensitivity and specificity. Bivariate analysis is performed using <em>mada</em> package. A <a href="bayesian-analysis.html#bayesian-metaanalysis">Bayesian library</a> for bivariate analysis <em>meta4diag</em> is illustrated later.</p>
<p>The example below is taken from a metaanalysis of spot sign as predictor
expansion of intracerebral hemorrhage <span class="citation">(<a href="#ref-pmid31272327">Phan et al. 2019</a>)</span>. The data for this
analysis is available in the Data-Use sub-folder.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="statistics.html#cb135-1" tabindex="-1"></a><span class="fu">library</span>(mada)</span></code></pre></div>
<pre><code>## Loading required package: ellipse</code></pre>
<pre><code>## 
## Attaching package: &#39;ellipse&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:graphics&#39;:
## 
##     pairs</code></pre>
<pre><code>## Loading required package: mvmeta</code></pre>
<pre><code>## This is mvmeta 1.0.3. For an overview type: help(&#39;mvmeta-package&#39;).</code></pre>
<pre><code>## 
## Attaching package: &#39;mvmeta&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:metafor&#39;:
## 
##     blup</code></pre>
<pre><code>## The following object is masked from &#39;package:meta&#39;:
## 
##     blup</code></pre>
<pre><code>## The following object is masked from &#39;package:checkmate&#39;:
## 
##     qtest</code></pre>
<pre><code>## 
## Attaching package: &#39;mada&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:metafor&#39;:
## 
##     forest</code></pre>
<pre><code>## The following object is masked from &#39;package:meta&#39;:
## 
##     forest</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="statistics.html#cb148-1" tabindex="-1"></a><span class="co">#spot sign data</span></span>
<span id="cb148-2"><a href="statistics.html#cb148-2" tabindex="-1"></a>Data<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">&quot;./Data-Use/ss150718.csv&quot;</span>)</span>
<span id="cb148-3"><a href="statistics.html#cb148-3" tabindex="-1"></a></span>
<span id="cb148-4"><a href="statistics.html#cb148-4" tabindex="-1"></a><span class="co">#remove duplicates using subset</span></span>
<span id="cb148-5"><a href="statistics.html#cb148-5" tabindex="-1"></a><span class="co">#another way is to use filter from dplyr</span></span>
<span id="cb148-6"><a href="statistics.html#cb148-6" tabindex="-1"></a>Dat<span class="ot">&lt;-</span><span class="fu">subset</span>(Data, Data<span class="sc">$</span>retain<span class="sc">==</span><span class="st">&quot;yes&quot;</span>) </span>
<span id="cb148-7"><a href="statistics.html#cb148-7" tabindex="-1"></a>(ss<span class="ot">&lt;-</span><span class="fu">reitsma</span>(Dat))</span></code></pre></div>
<pre><code>## Call:  reitsma.default(data = Dat)
## 
## Fixed-effects coefficients:
##               tsens     tfpr
## (Intercept)  0.2548  -1.9989
## 
## 27 studies, 2 fixed and 3 random-effects parameters
##   logLik       AIC       BIC  
##  52.0325  -94.0650  -84.1201</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="statistics.html#cb150-1" tabindex="-1"></a><span class="fu">summary</span>(ss)</span></code></pre></div>
<pre><code>## Call:  reitsma.default(data = Dat)
## 
## Bivariate diagnostic random-effects meta-analysis
## Estimation method: REML
## 
## Fixed-effects coefficients
##                   Estimate Std. Error       z Pr(&gt;|z|) 95%ci.lb 95%ci.ub    
## tsens.(Intercept)    0.255      0.152   1.676    0.094   -0.043    0.553   .
## tfpr.(Intercept)    -1.999      0.097 -20.664    0.000   -2.189   -1.809 ***
## sensitivity          0.563          -       -        -    0.489    0.635    
## false pos. rate      0.119          -       -        -    0.101    0.141    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 
## 
## Variance components: between-studies Std. Dev and correlation matrix
##       Std. Dev  tsens  tfpr
## tsens    0.692  1.000     .
## tfpr     0.400 -0.003 1.000
## 
##  logLik     AIC     BIC 
##  52.033 -94.065 -84.120 
## 
## AUC:  0.858
## Partial AUC (restricted to observed FPRs and normalized):  0.547
## 
## I2 estimates 
## Zhou and Dendukuri approach:  10.2 % 
## Holling sample size unadjusted approaches:  64.2 - 79.9 % 
## Holling sample size adjusted approaches:  4.7 - 5 %</code></pre>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="statistics.html#cb152-1" tabindex="-1"></a><span class="fu">AUC</span>(<span class="fu">reitsma</span>(<span class="at">data =</span> Dat))</span></code></pre></div>
<pre><code>## $AUC
## [1] 0.8576619
## 
## $pAUC
## [1] 0.5474316
## 
## attr(,&quot;sroc.type&quot;)
## [1] &quot;ruttergatsonis&quot;</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="statistics.html#cb154-1" tabindex="-1"></a>sumss<span class="ot">&lt;-</span><span class="fu">SummaryPts</span>(ss,<span class="at">n.iter =</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>) <span class="co">#bivariate pooled LR</span></span>
<span id="cb154-2"><a href="statistics.html#cb154-2" tabindex="-1"></a><span class="fu">summary</span>(sumss)</span></code></pre></div>
<pre><code>##           Mean Median  2.5%  97.5%
## posLR    4.760  4.740 3.860  5.770
## negLR    0.496  0.495 0.412  0.577
## invnegLR 2.030  2.020 1.730  2.430
## DOR      9.730  9.590 6.750 13.300</code></pre>
</div>
<div id="metaanalysis-of-clinical-trial." class="section level3 hasAnchor" number="4.9.8">
<h3><span class="header-section-number">4.9.8</span> Metaanalysis of clinical trial.<a href="statistics.html#metaanalysis-of-clinical-trial." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Fixed effect (Peto or Mantel-Haenszel) approaches assume that the population is the same for all studies and thus each study is the source of error. Random
effect (DerSimonian Laird) assumes an additional source of error between studies.The random effect approach results in more conservate estimate of effect size confidence interval. A criticism of DerSimnonian and Laird approach is that it is prone to type I error especially when the number of number of studies is small (n&lt;20) or moderate heterogeneity. Its estimated that 25% of the significant findings with DerSimonian Laird method may be non-significant with Hartung-Knapp method (BMC Medical Research Methodology 2014, 14:25). The Hartung-Knapp method (Stat Med 2001;20:3875-89) estimate the between studies variance and treat it as fixed. It employs quantile of t-distribution rather than normal distribution. The Hartung-Knapp method is available in meta and metafor package.</p>
<p>The data is from Jama Cardiology on Associations of Omega-3 Fatty Acid Supplement Use With Cardiovascular Disease Risks Meta-analysis of 10 Trials Involving 77917 Individuals <span class="citation">(<a href="#ref-pmid29387889">Aung T 2018</a>)</span>. Subsequently a meta-analysis <span class="citation">(<a href="#ref-pmid31567003">Hu 2019</a>)</span> reported that contrary to the earlier meta-analysis, Omega-3 lowers the risk of cardiovascular diseases with effect related to dose. The analysis using DerSimonian Laird and Hartung Knapp method is illustrated below.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="statistics.html#cb156-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>##  Attaching core tidyverse packages  tidyverse 2.0.0 
##  forcats   1.0.0      readr     2.1.4
##  lubridate 1.9.2      tidyr     1.3.0
##  purrr     1.0.1     
##  Conflicts  tidyverse_conflicts() 
##  purrr::%@%()           masks rlang::%@%()
##  rlang:::=()            masks data.table:::=()
##  dplyr::between()       masks data.table::between()
##  readr::col_factor()    masks scales::col_factor()
##  dplyr::collapse()      masks nlme::collapse()
##  gridExtra::combine()   masks dplyr::combine()
##  matrixStats::count()   masks dplyr::count()
##  dplyr::data_frame()    masks tibble::data_frame(), vctrs::data_frame()
##  dplyr::dim_desc()      masks pillar::dim_desc()
##  purrr::discard()       masks scales::discard()
##  tidyr::expand()        masks Matrix::expand()
##  tidyr::extract()       masks magrittr::extract()
##  dplyr::filter()        masks stats::filter()
##  dplyr::first()         masks data.table::first()
##  purrr::flatten()       masks jsonlite::flatten(), rlang::flatten()
##  purrr::flatten_chr()   masks rlang::flatten_chr()
##  purrr::flatten_dbl()   masks rlang::flatten_dbl()
##  purrr::flatten_int()   masks rlang::flatten_int()
##  purrr::flatten_lgl()   masks rlang::flatten_lgl()
##  purrr::flatten_raw()   masks rlang::flatten_raw()
##  lubridate::hour()      masks data.table::hour()
##  purrr::invoke()        masks rlang::invoke()
##  lubridate::isoweek()   masks data.table::isoweek()
##  dplyr::lag()           masks stats::lag()
##  dplyr::last()          masks data.table::last()
##  rlang::ll()            masks Metrics::ll()
##  rlang::local_options() masks withr::local_options()
##  purrr::map()           masks listenv::map()
##  lubridate::mday()      masks data.table::mday()
##  lubridate::minute()    masks data.table::minute()
##  lubridate::month()     masks data.table::month()
##  tidyr::pack()          masks Matrix::pack()
##  lubridate::quarter()   masks data.table::quarter()
##  lubridate::second()    masks data.table::second()
##  dplyr::select()        masks MASS::select()
##  purrr::set_names()     masks rlang::set_names(), magrittr::set_names()
##  readr::spec()          masks mada::spec()
##  purrr::splice()        masks rlang::splice()
##  dplyr::src()           masks Hmisc::src()
##  cli::style_bold()      masks pillar::style_bold()
##  dplyr::summarize()     masks Hmisc::summarize()
##  purrr::transpose()     masks data.table::transpose()
##  cli::tree()            masks xfun::tree()
##  jsonlite::unbox()      masks rlang::unbox()
##  tidyr::unpack()        masks Matrix::unpack()
##  jsonlite::validate()   masks rms::validate()
##  lubridate::wday()      masks data.table::wday()
##  lubridate::week()      masks data.table::week()
##  rlang::with_options()  masks withr::with_options()
##  lubridate::yday()      masks data.table::yday()
##  lubridate::year()      masks data.table::year()
##  Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="statistics.html#cb158-1" tabindex="-1"></a><span class="fu">library</span>(metafor)</span>
<span id="cb158-2"><a href="statistics.html#cb158-2" tabindex="-1"></a></span>
<span id="cb158-3"><a href="statistics.html#cb158-3" tabindex="-1"></a><span class="co">#Omega 3 data</span></span>
<span id="cb158-4"><a href="statistics.html#cb158-4" tabindex="-1"></a>Year<span class="ot">=</span><span class="fu">c</span>(<span class="dv">2010</span>,<span class="dv">2014</span>,<span class="dv">2010</span>,<span class="dv">2007</span>,<span class="dv">2010</span>,<span class="dv">2010</span>,<span class="dv">2013</span>,<span class="dv">2008</span>,<span class="dv">2012</span>,<span class="dv">1999</span>)</span>
<span id="cb158-5"><a href="statistics.html#cb158-5" tabindex="-1"></a>Trials<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;DOIT&quot;</span>,<span class="st">&quot;AREDS-2&quot;</span>,<span class="st">&quot;SU.FOL.OM3&quot;</span>,<span class="st">&quot;JELIS&quot;</span>,<span class="st">&quot;Alpha Omega&quot;</span>,<span class="st">&quot;OMEGA&quot;</span>,<span class="st">&quot;R&amp;P&quot;</span>,<span class="st">&quot;GISSI-HF&quot;</span>,<span class="st">&quot;ORIGIN&quot;</span>,<span class="st">&quot;GISSI-P&quot;</span>)</span>
<span id="cb158-6"><a href="statistics.html#cb158-6" tabindex="-1"></a>Treatment<span class="ot">=</span><span class="fu">c</span>(<span class="dv">29</span>,<span class="dv">213</span>,<span class="dv">216</span>,<span class="dv">262</span>,<span class="dv">332</span>,<span class="dv">534</span>,<span class="dv">733</span>,<span class="dv">783</span>,<span class="dv">1276</span>,<span class="dv">1552</span>)</span>
<span id="cb158-7"><a href="statistics.html#cb158-7" tabindex="-1"></a>Treatment.per<span class="ot">=</span><span class="fu">c</span>(<span class="fl">10.3</span>,<span class="fl">9.9</span>,<span class="fl">17.2</span>,<span class="fl">2.8</span>,<span class="fl">13.8</span>,<span class="fl">27.7</span>,<span class="fl">11.7</span>,<span class="fl">22.4</span>,<span class="fl">20.3</span>,<span class="fl">27.4</span>)</span>
<span id="cb158-8"><a href="statistics.html#cb158-8" tabindex="-1"></a>Control<span class="ot">=</span><span class="fu">c</span>(<span class="dv">35</span>,<span class="dv">208</span>,<span class="dv">211</span>,<span class="dv">324</span>,<span class="dv">331</span>,<span class="dv">541</span>,<span class="dv">745</span>,<span class="dv">831</span>,<span class="dv">1295</span>,<span class="dv">1550</span>)</span>
<span id="cb158-9"><a href="statistics.html#cb158-9" tabindex="-1"></a>Control.per<span class="ot">=</span><span class="fu">c</span>(<span class="fl">12.5</span>,<span class="fl">10.1</span>,<span class="fl">16.9</span>,<span class="fl">3.5</span>,<span class="fl">13.6</span>,<span class="fl">28.6</span>, <span class="fl">11.9</span>,<span class="fl">23.9</span>,<span class="fl">20.7</span>,<span class="fl">27.3</span>)</span>
<span id="cb158-10"><a href="statistics.html#cb158-10" tabindex="-1"></a></span>
<span id="cb158-11"><a href="statistics.html#cb158-11" tabindex="-1"></a><span class="co">#combine into data frame</span></span>
<span id="cb158-12"><a href="statistics.html#cb158-12" tabindex="-1"></a>rct<span class="ot">&lt;-</span><span class="fu">data.frame</span>(Year,Trials,Treatment,Treatment.per,Control,Control.per) <span class="sc">%&gt;%</span></span>
<span id="cb158-13"><a href="statistics.html#cb158-13" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Treatment.number=</span><span class="fu">round</span>(Treatment<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span>Treatment.per,<span class="dv">0</span>),</span>
<span id="cb158-14"><a href="statistics.html#cb158-14" tabindex="-1"></a>         <span class="at">Control.number=</span><span class="fu">round</span>(Control<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span>Control.per,<span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb158-15"><a href="statistics.html#cb158-15" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">ai=</span>Treatment,<span class="at">n1i=</span>Treatment.number,<span class="at">ci=</span>Control,</span>
<span id="cb158-16"><a href="statistics.html#cb158-16" tabindex="-1"></a>         <span class="at">n2i=</span>Control.number,<span class="at">study=</span>Trials,<span class="at">year=</span>Year)</span>
<span id="cb158-17"><a href="statistics.html#cb158-17" tabindex="-1"></a></span>
<span id="cb158-18"><a href="statistics.html#cb158-18" tabindex="-1"></a></span>
<span id="cb158-19"><a href="statistics.html#cb158-19" tabindex="-1"></a><span class="co">#peto&#39;s fixed effect method</span></span>
<span id="cb158-20"><a href="statistics.html#cb158-20" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">rma.peto</span>(<span class="at">ai=</span>ai, <span class="at">n1i=</span>n1i, <span class="at">ci=</span>ci, <span class="at">n2i=</span>n2i, <span class="at">data=</span>rct)</span>
<span id="cb158-21"><a href="statistics.html#cb158-21" tabindex="-1"></a><span class="fu">print</span>(res, <span class="at">digits=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## 
## Equal-Effects Model (k = 10)
## 
## I^2 (total heterogeneity / total variability):  0.00%
## H^2 (total variability / sampling variability): 0.93
## 
## Test for Heterogeneity: 
## Q(df = 9) = 8.36, p-val = 0.50
## 
## Model Results (log scale):
## 
## estimate    se   zval  pval  ci.lb  ci.ub 
##    -0.04  0.02  -1.72  0.08  -0.08   0.00 
## 
## Model Results (OR scale):
## 
## estimate  ci.lb  ci.ub 
##     0.97   0.93   1.00</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="statistics.html#cb160-1" tabindex="-1"></a>result<span class="ot">&lt;-</span><span class="fu">predict</span>(res, <span class="at">transf=</span>exp, <span class="at">digits=</span><span class="dv">2</span>)</span>
<span id="cb160-2"><a href="statistics.html#cb160-2" tabindex="-1"></a><span class="co">#forest plot</span></span>
<span id="cb160-3"><a href="statistics.html#cb160-3" tabindex="-1"></a>metafor<span class="sc">::</span><span class="fu">forest</span>(res, <span class="at">targs=</span><span class="fu">list</span>(<span class="at">study=</span>rct<span class="sc">$</span>study), </span>
<span id="cb160-4"><a href="statistics.html#cb160-4" tabindex="-1"></a><span class="at">main=</span><span class="st">&quot;RCT of Omega3 fatty acid for cardiovascular disease-Peto&quot;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-17-1-1.png" width="672" /></p>
<p>The funnel plot is used here to illustrate presence or absence publication bias. In this case the funnel plot reflects the same findings as the low <span class="math inline">\(I^2\)</span> value. There is one outlier. We will explore this further with the <em>GOSH</em> plot below.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="statistics.html#cb161-1" tabindex="-1"></a><span class="co"># funnel plot </span></span>
<span id="cb161-2"><a href="statistics.html#cb161-2" tabindex="-1"></a><span class="fu">funnel</span>(res, <span class="at">refline=</span><span class="dv">0</span>, <span class="at">level=</span><span class="fu">c</span>(<span class="dv">90</span>, <span class="dv">95</span>, <span class="dv">99</span>), </span>
<span id="cb161-3"><a href="statistics.html#cb161-3" tabindex="-1"></a>       <span class="at">shade=</span><span class="fu">c</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;gray&quot;</span>, <span class="st">&quot;darkgray&quot;</span>))</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-17-2-1.png" width="672" /></p>
<p>Random effect (DerSimonian Laird) assumes an additional source of error between studies when calculating odds ratio.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="statistics.html#cb162-1" tabindex="-1"></a><span class="co">#DL</span></span>
<span id="cb162-2"><a href="statistics.html#cb162-2" tabindex="-1"></a>datO3 <span class="ot">&lt;-</span> <span class="fu">escalc</span>(<span class="at">measure =</span> <span class="st">&quot;OR&quot;</span>,<span class="at">ai=</span>ai, <span class="at">n1i=</span>n1i, <span class="at">ci=</span>ci, <span class="at">n2i=</span>n2i,<span class="at">data=</span>rct)</span>
<span id="cb162-3"><a href="statistics.html#cb162-3" tabindex="-1"></a>res.DL<span class="ot">&lt;-</span><span class="fu">rma</span>(yi,vi, <span class="at">method =</span> <span class="st">&quot;DL&quot;</span>,<span class="at">data=</span>datO3)</span>
<span id="cb162-4"><a href="statistics.html#cb162-4" tabindex="-1"></a>metafor<span class="sc">::</span><span class="fu">forest</span>(res.DL,<span class="at">main=</span><span class="st">&quot;RCT of Omega3 fatty acid for cardiovascular disease-DL&quot;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-17-3-1.png" width="672" /></p>
<p>DerSimonian Laird method may not be appropriate for metaanalysis with small
number of studies . The recommendation is to use the Hartung Knapp random effect method. This analysis show that inspite of the small sample size the significant findings remain.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="statistics.html#cb163-1" tabindex="-1"></a><span class="co">#Hartung-ignore error message</span></span>
<span id="cb163-2"><a href="statistics.html#cb163-2" tabindex="-1"></a>res.HK<span class="ot">&lt;-</span><span class="fu">rma.uni</span>(yi,<span class="at">vi=</span><span class="dv">1</span><span class="sc">/</span>vi,<span class="at">method=</span><span class="st">&quot;FE&quot;</span>,<span class="at">knha=</span><span class="cn">TRUE</span>,<span class="at">data=</span>datO3)</span>
<span id="cb163-3"><a href="statistics.html#cb163-3" tabindex="-1"></a>metafor<span class="sc">::</span><span class="fu">forest</span>(res.HK,<span class="at">main=</span><span class="st">&quot;RCT of Omega3 fatty acid for cardiovascular disease-HK&quot;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-17-4-1.png" width="672" /></p>
<p>Subgroup analysis is one way of exploring the data for group effect. Metaregression is illustrated later.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="statistics.html#cb164-1" tabindex="-1"></a><span class="co">#create subgroups for Omega 3 trial based on year of publication</span></span>
<span id="cb164-2"><a href="statistics.html#cb164-2" tabindex="-1"></a>rct1<span class="ot">&lt;-</span>rct[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,]</span>
<span id="cb164-3"><a href="statistics.html#cb164-3" tabindex="-1"></a>rct2<span class="ot">&lt;-</span>rct[<span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>,]</span>
<span id="cb164-4"><a href="statistics.html#cb164-4" tabindex="-1"></a>rct1<span class="sc">$</span>group[rct1<span class="sc">$</span>year<span class="sc">&gt;=</span><span class="dv">1999</span>]<span class="ot">&lt;-</span><span class="st">&quot;wide&quot;</span></span>
<span id="cb164-5"><a href="statistics.html#cb164-5" tabindex="-1"></a>rct2<span class="sc">$</span>group[rct2<span class="sc">$</span>year<span class="sc">&gt;=</span><span class="dv">1999</span>]<span class="ot">&lt;-</span><span class="st">&quot;narrow&quot;</span></span>
<span id="cb164-6"><a href="statistics.html#cb164-6" tabindex="-1"></a>rct3<span class="ot">&lt;-</span><span class="fu">rbind</span>(rct1,rct2)</span>
<span id="cb164-7"><a href="statistics.html#cb164-7" tabindex="-1"></a></span>
<span id="cb164-8"><a href="statistics.html#cb164-8" tabindex="-1"></a>datO3<span class="sc">$</span>group<span class="ot">&lt;-</span>rct3<span class="sc">$</span>group</span>
<span id="cb164-9"><a href="statistics.html#cb164-9" tabindex="-1"></a><span class="co">#plot subgroups</span></span>
<span id="cb164-10"><a href="statistics.html#cb164-10" tabindex="-1"></a>res.group <span class="ot">&lt;-</span> <span class="fu">rma</span>(yi, vi, <span class="at">mods =</span> <span class="sc">~</span> group, <span class="at">data=</span>datO3)</span>
<span id="cb164-11"><a href="statistics.html#cb164-11" tabindex="-1"></a>res.wide<span class="ot">&lt;-</span> <span class="fu">rma</span>(yi, vi, <span class="at">subset=</span>(group<span class="sc">==</span><span class="st">&quot;wide&quot;</span>), <span class="at">data=</span>datO3)</span>
<span id="cb164-12"><a href="statistics.html#cb164-12" tabindex="-1"></a>res.wide</span></code></pre></div>
<pre><code>## 
## Random-Effects Model (k = 5; tau^2 estimator: REML)
## 
## tau^2 (estimated amount of total heterogeneity): 0.0069 (SE = 0.0127)
## tau (square root of estimated tau^2 value):      0.0831
## I^2 (total heterogeneity / total variability):   38.46%
## H^2 (total variability / sampling variability):  1.62
## 
## Test for Heterogeneity:
## Q(df = 4) = 5.9601, p-val = 0.2022
## 
## Model Results:
## 
## estimate      se     zval    pval    ci.lb   ci.ub    
##  -0.0676  0.0611  -1.1077  0.2680  -0.1873  0.0520    
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="statistics.html#cb166-1" tabindex="-1"></a>res.narrow<span class="ot">&lt;-</span> <span class="fu">rma</span>(yi, vi, <span class="at">subset=</span>(group<span class="sc">==</span><span class="st">&quot;narrow&quot;</span>), <span class="at">data=</span>datO3)</span>
<span id="cb166-2"><a href="statistics.html#cb166-2" tabindex="-1"></a>res.narrow</span></code></pre></div>
<pre><code>## 
## Random-Effects Model (k = 5; tau^2 estimator: REML)
## 
## tau^2 (estimated amount of total heterogeneity): 0 (SE = 0.0018)
## tau (square root of estimated tau^2 value):      0
## I^2 (total heterogeneity / total variability):   0.00%
## H^2 (total variability / sampling variability):  1.00
## 
## Test for Heterogeneity:
## Q(df = 4) = 1.6888, p-val = 0.7928
## 
## Model Results:
## 
## estimate      se     zval    pval    ci.lb   ci.ub    
##  -0.0266  0.0229  -1.1609  0.2457  -0.0715  0.0183    
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="statistics.html#cb168-1" tabindex="-1"></a><span class="co">#https://stackoverflow.com/questions/39392706/using-the-r-forestplot-package-</span></span>
<span id="cb168-2"><a href="statistics.html#cb168-2" tabindex="-1"></a><span class="co">#is-there-a-way-to-assign-variable-colors-to-boxe</span></span>
<span id="cb168-3"><a href="statistics.html#cb168-3" tabindex="-1"></a></span>
<span id="cb168-4"><a href="statistics.html#cb168-4" tabindex="-1"></a><span class="co">#confidence interval</span></span>
<span id="cb168-5"><a href="statistics.html#cb168-5" tabindex="-1"></a>rmeta_conf <span class="ot">&lt;-</span> </span>
<span id="cb168-6"><a href="statistics.html#cb168-6" tabindex="-1"></a>  <span class="fu">structure</span>(<span class="fu">list</span>(</span>
<span id="cb168-7"><a href="statistics.html#cb168-7" tabindex="-1"></a>    <span class="at">mean  =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.0676</span>), <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.0266</span>),  <span class="cn">NA</span>, <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.0352</span>)), </span>
<span id="cb168-8"><a href="statistics.html#cb168-8" tabindex="-1"></a>    <span class="at">lower =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.1873</span>), <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.0715</span>),  <span class="cn">NA</span>, <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.0753</span>)),</span>
<span id="cb168-9"><a href="statistics.html#cb168-9" tabindex="-1"></a>    <span class="at">upper =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fu">exp</span>(<span class="fl">0.0520</span>), <span class="fu">exp</span>(<span class="fl">0.0183</span>),  <span class="cn">NA</span>, <span class="fu">exp</span>(<span class="fl">0.0049</span>))),</span>
<span id="cb168-10"><a href="statistics.html#cb168-10" tabindex="-1"></a>    <span class="at">.Names =</span> <span class="fu">c</span>(<span class="st">&quot;mean&quot;</span>, <span class="st">&quot;lower&quot;</span>, <span class="st">&quot;upper&quot;</span>), </span>
<span id="cb168-11"><a href="statistics.html#cb168-11" tabindex="-1"></a>    <span class="at">row.names =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="sc">-</span>6L), </span>
<span id="cb168-12"><a href="statistics.html#cb168-12" tabindex="-1"></a>    <span class="at">class =</span> <span class="st">&quot;data.frame&quot;</span>)</span>
<span id="cb168-13"><a href="statistics.html#cb168-13" tabindex="-1"></a></span>
<span id="cb168-14"><a href="statistics.html#cb168-14" tabindex="-1"></a><span class="co">#table data</span></span>
<span id="cb168-15"><a href="statistics.html#cb168-15" tabindex="-1"></a>tabletext<span class="ot">&lt;-</span><span class="fu">cbind</span>(<span class="fu">c</span>(<span class="st">&quot;&quot;</span>,<span class="st">&quot;Trials&quot;</span>,<span class="st">&quot;wide&quot;</span>,<span class="st">&quot;narrow&quot;</span>,<span class="cn">NA</span>,<span class="st">&quot;Summary&quot;</span>),</span>
<span id="cb168-16"><a href="statistics.html#cb168-16" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;Events&quot;</span>,<span class="st">&quot;(Drugs)&quot;</span>,<span class="fu">sum</span>(<span class="fu">filter</span>(datO3,group<span class="sc">==</span><span class="st">&quot;wide&quot;</span>)<span class="sc">$</span>ai),</span>
<span id="cb168-17"><a href="statistics.html#cb168-17" tabindex="-1"></a>      <span class="fu">sum</span>(<span class="fu">filter</span>(datO3,group<span class="sc">==</span><span class="st">&quot;narrow&quot;</span>)<span class="sc">$</span>ai),<span class="cn">NA</span>,<span class="cn">NA</span>),</span>
<span id="cb168-18"><a href="statistics.html#cb168-18" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;Events&quot;</span>,<span class="st">&quot;(Control)&quot;</span>,<span class="fu">sum</span>(<span class="fu">filter</span>(datO3,group<span class="sc">==</span><span class="st">&quot;wide&quot;</span>)<span class="sc">$</span>ci),</span>
<span id="cb168-19"><a href="statistics.html#cb168-19" tabindex="-1"></a>      <span class="fu">sum</span>(<span class="fu">filter</span>(datO3,group<span class="sc">==</span><span class="st">&quot;narrow&quot;</span>)<span class="sc">$</span>ci),<span class="cn">NA</span>,<span class="cn">NA</span>),     </span>
<span id="cb168-20"><a href="statistics.html#cb168-20" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;&quot;</span>,<span class="st">&quot;OR&quot;</span>,<span class="st">&quot;0.934&quot;</span>,<span class="st">&quot;0.974&quot;</span>,<span class="cn">NA</span>,<span class="st">&quot;0.965&quot;</span>)</span>
<span id="cb168-21"><a href="statistics.html#cb168-21" tabindex="-1"></a>                 )</span>
<span id="cb168-22"><a href="statistics.html#cb168-22" tabindex="-1"></a><span class="co">#use forestplot as another library to perform forest plot</span></span>
<span id="cb168-23"><a href="statistics.html#cb168-23" tabindex="-1"></a><span class="fu">library</span>(forestplot)</span></code></pre></div>
<pre><code>## Loading required package: abind</code></pre>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="statistics.html#cb170-1" tabindex="-1"></a> <span class="fu">forestplot</span>(tabletext, </span>
<span id="cb170-2"><a href="statistics.html#cb170-2" tabindex="-1"></a>       rmeta_conf,<span class="at">new_page =</span> <span class="cn">TRUE</span>,</span>
<span id="cb170-3"><a href="statistics.html#cb170-3" tabindex="-1"></a>       <span class="at">is.summary=</span><span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">TRUE</span>,<span class="fu">rep</span>(<span class="cn">FALSE</span>,<span class="dv">8</span>),<span class="cn">TRUE</span>),</span>
<span id="cb170-4"><a href="statistics.html#cb170-4" tabindex="-1"></a>       <span class="at">clip=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">2.5</span>), </span>
<span id="cb170-5"><a href="statistics.html#cb170-5" tabindex="-1"></a>       <span class="at">xlog=</span><span class="cn">TRUE</span>, </span>
<span id="cb170-6"><a href="statistics.html#cb170-6" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">fpColors</span>(<span class="at">box=</span><span class="st">&quot;royalblue&quot;</span>,<span class="at">line=</span><span class="st">&quot;darkblue&quot;</span>, <span class="at">summary=</span><span class="st">&quot;royalblue&quot;</span>))</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-17-5-1.png" width="672" /></p>
<p>Baujat plot is another method in addition to funnel plot explore heterogeneity</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="statistics.html#cb171-1" tabindex="-1"></a><span class="co"># adjust margins so the space is better used</span></span>
<span id="cb171-2"><a href="statistics.html#cb171-2" tabindex="-1"></a></span>
<span id="cb171-3"><a href="statistics.html#cb171-3" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb171-4"><a href="statistics.html#cb171-4" tabindex="-1"></a><span class="co"># create Baujat plot to explore source of heterogeneity</span></span>
<span id="cb171-5"><a href="statistics.html#cb171-5" tabindex="-1"></a><span class="fu">baujat</span>(res.DL, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.2</span>))</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-17-6-1.png" width="672" /></p>
<p>GOSH plot explores study heterogeneity using output of fixed effect model for
all possible subsets</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="statistics.html#cb172-1" tabindex="-1"></a><span class="do">## fit FE model to all possible subsets</span></span>
<span id="cb172-2"><a href="statistics.html#cb172-2" tabindex="-1"></a><span class="co"># uses output from DL analysis</span></span>
<span id="cb172-3"><a href="statistics.html#cb172-3" tabindex="-1"></a></span>
<span id="cb172-4"><a href="statistics.html#cb172-4" tabindex="-1"></a>sav <span class="ot">&lt;-</span> <span class="fu">gosh</span>(res.DL)</span></code></pre></div>
<pre><code>## Fitting 1023 models (based on all possible subsets).</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="statistics.html#cb174-1" tabindex="-1"></a><span class="do">### create GOSH plot</span></span>
<span id="cb174-2"><a href="statistics.html#cb174-2" tabindex="-1"></a><span class="do">### red points for subsets that include and blue points</span></span>
<span id="cb174-3"><a href="statistics.html#cb174-3" tabindex="-1"></a><span class="do">### for subsets that exclude study 16 (the ISIS-4 trial)</span></span>
<span id="cb174-4"><a href="statistics.html#cb174-4" tabindex="-1"></a></span>
<span id="cb174-5"><a href="statistics.html#cb174-5" tabindex="-1"></a><span class="fu">plot</span>(sav, <span class="at">out=</span><span class="fu">dim</span>(rct)[<span class="dv">1</span>], <span class="at">breaks=</span><span class="dv">100</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-17-7-1.png" width="672" /></p>
</div>
<div id="metaregression" class="section level3 hasAnchor" number="4.9.9">
<h3><span class="header-section-number">4.9.9</span> Metaregression<a href="statistics.html#metaregression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="statistics.html#cb175-1" tabindex="-1"></a><span class="co">#separate metaregression for tsens and tfpr</span></span>
<span id="cb175-2"><a href="statistics.html#cb175-2" tabindex="-1"></a></span>
<span id="cb175-3"><a href="statistics.html#cb175-3" tabindex="-1"></a><span class="co">#tsens - setting single or multicentre for spot sign metaanalysis</span></span>
<span id="cb175-4"><a href="statistics.html#cb175-4" tabindex="-1"></a>dat1<span class="ot">&lt;-</span><span class="fu">subset</span>(Dat, Dat<span class="sc">$</span>result_id<span class="sc">==</span><span class="dv">1</span> )</span>
<span id="cb175-5"><a href="statistics.html#cb175-5" tabindex="-1"></a>(metass<span class="ot">&lt;-</span><span class="fu">reitsma</span>(dat1, <span class="at">formula =</span> <span class="fu">cbind</span>(tsens,tfpr)<span class="sc">~</span>PubYear<span class="sc">+</span>Study.type<span class="sc">+</span>Setting<span class="sc">+</span>Quality.assessment)) </span></code></pre></div>
<pre><code>## Call:  reitsma.default(data = dat1, formula = cbind(tsens, tfpr) ~ PubYear + 
##     Study.type + Setting + Quality.assessment)
## 
## Fixed-effects coefficients:
##                        tsens       tfpr
## (Intercept)         298.7348  -164.8603
## PubYear              -0.1484     0.0828
## Study.typeRetro       0.3554    -0.1489
## SettingSingle         0.2283    -0.1301
## Quality.assessment   -0.0040    -0.0834
## 
## 26 studies, 10 fixed and 3 random-effects parameters
##   logLik       AIC       BIC  
##  48.5386  -71.0771  -45.7109</code></pre>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="statistics.html#cb177-1" tabindex="-1"></a><span class="fu">summary</span>(metass)</span></code></pre></div>
<pre><code>## Call:  reitsma.default(data = dat1, formula = cbind(tsens, tfpr) ~ PubYear + 
##     Study.type + Setting + Quality.assessment)
## 
## Bivariate diagnostic random-effects meta-regression
## Estimation method: REML
## 
## Fixed-effects coefficients
##                          Estimate Std. Error      z Pr(&gt;|z|) 95%ci.lb 95%ci.ub
## tsens.(Intercept)         298.735    143.547  2.081    0.037   17.387  580.083
## tsens.PubYear              -0.148      0.071 -2.078    0.038   -0.288   -0.008
## tsens.Study.typeRetro       0.355      0.310  1.146    0.252   -0.253    0.963
## tsens.SettingSingle         0.228      0.495  0.462    0.644   -0.741    1.198
## tsens.Quality.assessment   -0.004      0.050 -0.081    0.936   -0.102    0.094
## tfpr.(Intercept)         -164.860     80.574 -2.046    0.041 -322.783   -6.938
## tfpr.PubYear                0.083      0.040  2.066    0.039    0.004    0.161
## tfpr.Study.typeRetro       -0.149      0.172 -0.865    0.387   -0.486    0.188
## tfpr.SettingSingle         -0.130      0.276 -0.471    0.638   -0.672    0.412
## tfpr.Quality.assessment    -0.083      0.026 -3.190    0.001   -0.135   -0.032
##                            
## tsens.(Intercept)         *
## tsens.PubYear             *
## tsens.Study.typeRetro      
## tsens.SettingSingle        
## tsens.Quality.assessment   
## tfpr.(Intercept)          *
## tfpr.PubYear              *
## tfpr.Study.typeRetro       
## tfpr.SettingSingle         
## tfpr.Quality.assessment  **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 
## 
## Variance components: between-studies Std. Dev and correlation matrix
##       Std. Dev tsens  tfpr
## tsens    0.657 1.000     .
## tfpr     0.297 0.312 1.000
## 
##  logLik     AIC     BIC 
##  48.539 -71.077 -45.711 
## 
## 
## I2 estimates 
## Zhou and Dendukuri approach:  0 % 
## Holling sample size unadjusted approaches:  66.8 - 80.5 % 
## Holling sample size adjusted approaches:  5.4 - 5.8 %</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="statistics.html#cb179-1" tabindex="-1"></a><span class="co">#tfpr - setting single or multicentre for spot sign metaanalysis</span></span>
<span id="cb179-2"><a href="statistics.html#cb179-2" tabindex="-1"></a>dat1<span class="ot">&lt;-</span><span class="fu">subset</span>(Dat, Dat<span class="sc">$</span>result_id<span class="sc">==</span><span class="dv">1</span> )</span>
<span id="cb179-3"><a href="statistics.html#cb179-3" tabindex="-1"></a>(metassfull<span class="ot">&lt;-</span><span class="fu">reitsma</span>(dat1, <span class="at">formula =</span> <span class="fu">cbind</span>(tsens,tfpr)<span class="sc">~</span></span>
<span id="cb179-4"><a href="statistics.html#cb179-4" tabindex="-1"></a>        PubYear<span class="sc">+</span>clinical<span class="sc">+</span>Study.type<span class="sc">+</span>CTA6hrs<span class="sc">+</span>Setting<span class="sc">+</span>Quality.assessment)) </span></code></pre></div>
<pre><code>## Call:  reitsma.default(data = dat1, formula = cbind(tsens, tfpr) ~ PubYear + 
##     clinical + Study.type + CTA6hrs + Setting + Quality.assessment)
## 
## Fixed-effects coefficients:
##                        tsens       tfpr
## (Intercept)         297.5416  -144.2754
## PubYear              -0.1480     0.0724
## clinical             -0.4703    -0.1810
## Study.typeRetro       0.4884    -0.0989
## CTA6hrsyes           -0.2141    -0.2342
## SettingSingle         0.2568    -0.1435
## Quality.assessment    0.0130    -0.0738
## 
## 26 studies, 14 fixed and 3 random-effects parameters
##   logLik       AIC       BIC  
##  48.4477  -62.8955  -29.7243</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="statistics.html#cb181-1" tabindex="-1"></a><span class="fu">summary</span>(metassfull)</span></code></pre></div>
<pre><code>## Call:  reitsma.default(data = dat1, formula = cbind(tsens, tfpr) ~ PubYear + 
##     clinical + Study.type + CTA6hrs + Setting + Quality.assessment)
## 
## Bivariate diagnostic random-effects meta-regression
## Estimation method: REML
## 
## Fixed-effects coefficients
##                          Estimate Std. Error      z Pr(&gt;|z|) 95%ci.lb 95%ci.ub
## tsens.(Intercept)         297.542    150.543  1.976    0.048    2.482  592.601
## tsens.PubYear              -0.148      0.075 -1.977    0.048   -0.295   -0.001
## tsens.clinical             -0.470      0.333 -1.411    0.158   -1.124    0.183
## tsens.Study.typeRetro       0.488      0.321  1.523    0.128   -0.140    1.117
## tsens.CTA6hrsyes           -0.214      0.322 -0.665    0.506   -0.845    0.417
## tsens.SettingSingle         0.257      0.495  0.519    0.604   -0.714    1.228
## tsens.Quality.assessment    0.013      0.051  0.255    0.799   -0.087    0.113
## tfpr.(Intercept)         -144.275     82.720 -1.744    0.081 -306.403   17.852
## tfpr.PubYear                0.072      0.041  1.761    0.078   -0.008    0.153
## tfpr.clinical              -0.181      0.187 -0.969    0.333   -0.547    0.185
## tfpr.Study.typeRetro       -0.099      0.177 -0.558    0.577   -0.446    0.249
## tfpr.CTA6hrsyes            -0.234      0.177 -1.322    0.186   -0.581    0.113
## tfpr.SettingSingle         -0.144      0.274 -0.524    0.600   -0.680    0.393
## tfpr.Quality.assessment    -0.074      0.027 -2.774    0.006   -0.126   -0.022
##                            
## tsens.(Intercept)         *
## tsens.PubYear             *
## tsens.clinical             
## tsens.Study.typeRetro      
## tsens.CTA6hrsyes           
## tsens.SettingSingle        
## tsens.Quality.assessment   
## tfpr.(Intercept)          .
## tfpr.PubYear              .
## tfpr.clinical              
## tfpr.Study.typeRetro       
## tfpr.CTA6hrsyes            
## tfpr.SettingSingle         
## tfpr.Quality.assessment  **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 
## 
## Variance components: between-studies Std. Dev and correlation matrix
##       Std. Dev tsens  tfpr
## tsens    0.650 1.000     .
## tfpr     0.285 0.188 1.000
## 
##  logLik     AIC     BIC 
##  48.448 -62.895 -29.724 
## 
## 
## I2 estimates 
## Zhou and Dendukuri approach:  0 % 
## Holling sample size unadjusted approaches:  66.8 - 80.5 % 
## Holling sample size adjusted approaches:  5.4 - 5.8 %</code></pre>
<p>Plot year against tsens from metaregression</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="statistics.html#cb183-1" tabindex="-1"></a><span class="co">#using output from spot sign</span></span>
<span id="cb183-2"><a href="statistics.html#cb183-2" tabindex="-1"></a></span>
<span id="cb183-3"><a href="statistics.html#cb183-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb183-4"><a href="statistics.html#cb183-4" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb183-5"><a href="statistics.html#cb183-5" tabindex="-1"></a>ssr<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(ss<span class="sc">$</span>residuals)</span>
<span id="cb183-6"><a href="statistics.html#cb183-6" tabindex="-1"></a><span class="co">#convert character to year</span></span>
<span id="cb183-7"><a href="statistics.html#cb183-7" tabindex="-1"></a>ssr<span class="sc">$</span>Year<span class="ot">&lt;-</span><span class="fu">as.Date</span>(<span class="fu">as.character</span>(Dat<span class="sc">$</span>PubYear),<span class="st">&quot;%Y&quot;</span>)</span>
<span id="cb183-8"><a href="statistics.html#cb183-8" tabindex="-1"></a>ssr<span class="sc">$</span>Quality<span class="ot">&lt;-</span>Dat<span class="sc">$</span>Quality.assessment</span>
<span id="cb183-9"><a href="statistics.html#cb183-9" tabindex="-1"></a><span class="fu">ggplot</span>(ssr, <span class="fu">aes</span>(<span class="at">x=</span>ssr<span class="sc">$</span>Year,<span class="at">y=</span>ssr<span class="sc">$</span>tsens))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb183-10"><a href="statistics.html#cb183-10" tabindex="-1"></a>  <span class="fu">scale_x_date</span>()<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>)<span class="sc">+</span></span>
<span id="cb183-11"><a href="statistics.html#cb183-11" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Relationship between transformed sensitivity and Publication Year&quot;</span>)<span class="sc">+</span></span>
<span id="cb183-12"><a href="statistics.html#cb183-12" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Year&quot;</span>,<span class="at">y=</span><span class="st">&quot;transformed sensitivity&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-17-9-1.png" width="672" /></p>
<div id="summary-positive-and-negative-likelihood-ratio" class="section level4 hasAnchor" number="4.9.9.1">
<h4><span class="header-section-number">4.9.9.1</span> summary Positive and Negative Likelihood Ratio<a href="statistics.html#summary-positive-and-negative-likelihood-ratio" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Positive likelihood ratio (PLR) is the ratio of sensitivity to false positive
rate (FPR); the negative (NLR) likelihood ratio is the ratio of 1-sensitivity
to specificity. A PLR indicates the likelihood that a positive spot sign (test) would be expected in a patient with target disorder compared with the
likelihood that the same result would be expected in a patient without target disorder. Using the recommendation by Jaeschke et al<span class="citation">(<a href="#ref-pmid8309035">Jaeschke, Guyatt, and Sackett 1994</a>)</span> a
high PLR (&gt;5) and low NLR (&lt;0.2) indicate that the test results would make moderate changes in the likelihood of hematoma growth from baseline risk.
PLRs of &gt;10 and NLRs of &lt;0.1 would confer very large changes from baseline risk. The pooled likelihood ratios were used to calculate post-test odds according to Bayes Theorem and post-test probabilities of outcome after a positive test
result for a range of possible values of baseline risk.</p>
<p>Data from likelihood ratio can be used to create Fagans normogram.</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="statistics.html#cb185-1" tabindex="-1"></a><span class="co">#The code for this is available at</span></span>
<span id="cb185-2"><a href="statistics.html#cb185-2" tabindex="-1"></a><span class="co">#&quot;https://raw.githubusercontent.com/achekroud/nomogrammer/master/nomogrammer.r&quot;</span></span>
<span id="cb185-3"><a href="statistics.html#cb185-3" tabindex="-1"></a><span class="fu">library</span>(nomogrammer)</span>
<span id="cb185-4"><a href="statistics.html#cb185-4" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">nomogrammer</span>(<span class="at">Prevalence =</span> .<span class="dv">234</span>, <span class="at">Plr =</span> <span class="fl">4.85</span>, <span class="at">Nlr =</span> <span class="fl">0.49</span>)</span>
<span id="cb185-5"><a href="statistics.html#cb185-5" tabindex="-1"></a>p<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">&quot;Fagan&#39;s normogram for Spot Sign and ICH growth&quot;</span>)</span>
<span id="cb185-6"><a href="statistics.html#cb185-6" tabindex="-1"></a><span class="co">#ggsave(p,file=&quot;Fagan_SpotSign.png&quot;,width=5.99,height=3.99,units=&quot;in&quot;)</span></span></code></pre></div>
</div>
</div>
</div>
<div id="data-simulation" class="section level2 hasAnchor" number="4.10">
<h2><span class="header-section-number">4.10</span> Data simulation<a href="statistics.html#data-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Data simulation is an important aspects of data science. The example below is taken from our experience trying to simulate data from recent clot retrieval trials in stroke <span class="citation">(<a href="#ref-pmid25517348">Berkhemer et al. 2015</a>)</span> <span class="citation">(<a href="#ref-pmid25671797">Campbell et al. 2015</a>)</span>. Simulation is performed using <em>simstudy</em> library.</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="statistics.html#cb186-1" tabindex="-1"></a><span class="fu">library</span> (simstudy)</span>
<span id="cb186-2"><a href="statistics.html#cb186-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb186-3"><a href="statistics.html#cb186-3" tabindex="-1"></a></span>
<span id="cb186-4"><a href="statistics.html#cb186-4" tabindex="-1"></a><span class="co">#T is Trial</span></span>
<span id="cb186-5"><a href="statistics.html#cb186-5" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">&quot;T&quot;</span>, <span class="at">dist =</span> <span class="st">&quot;binary&quot;</span>, <span class="at">formula =</span> <span class="fl">0.5</span>)</span>
<span id="cb186-6"><a href="statistics.html#cb186-6" tabindex="-1"></a></span>
<span id="cb186-7"><a href="statistics.html#cb186-7" tabindex="-1"></a><span class="co">#early neurological improvement (ENI) .37 in TPA and .8 in ECR</span></span>
<span id="cb186-8"><a href="statistics.html#cb186-8" tabindex="-1"></a><span class="co">#baseline NIHSS 13 in TPA and 17 in ECR</span></span>
<span id="cb186-9"><a href="statistics.html#cb186-9" tabindex="-1"></a></span>
<span id="cb186-10"><a href="statistics.html#cb186-10" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def, <span class="at">varname =</span> <span class="st">&quot;ENI&quot;</span>, <span class="at">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="at">formula =</span> .<span class="dv">8</span><span class="fl">-.53</span><span class="sc">*</span>T, <span class="at">variance =</span> .<span class="dv">1</span>)</span>
<span id="cb186-11"><a href="statistics.html#cb186-11" tabindex="-1"></a></span>
<span id="cb186-12"><a href="statistics.html#cb186-12" tabindex="-1"></a><span class="co">#baseline NIHSS 13 in TPA and 17 in ECR</span></span>
<span id="cb186-13"><a href="statistics.html#cb186-13" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def, <span class="at">varname =</span> <span class="st">&quot;Y1&quot;</span>, <span class="at">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="at">formula=</span><span class="dv">13</span>, <span class="at">variance =</span> <span class="dv">1</span>)</span>
<span id="cb186-14"><a href="statistics.html#cb186-14" tabindex="-1"></a></span>
<span id="cb186-15"><a href="statistics.html#cb186-15" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def, <span class="at">varname =</span> <span class="st">&quot;Y2&quot;</span>, <span class="at">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="at">formula =</span> <span class="st">&quot;Y1*ENI - 5 * T &gt;5&quot;</span>,<span class="at">variance =</span> <span class="dv">1</span>)</span>
<span id="cb186-16"><a href="statistics.html#cb186-16" tabindex="-1"></a></span>
<span id="cb186-17"><a href="statistics.html#cb186-17" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def, <span class="at">varname =</span> <span class="st">&quot;Y3&quot;</span>, <span class="at">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="at">formula =</span> <span class="st">&quot;Y2- 4*T&gt;2&quot;</span>,<span class="at">variance =</span> <span class="dv">1</span>)</span>
<span id="cb186-18"><a href="statistics.html#cb186-18" tabindex="-1"></a></span>
<span id="cb186-19"><a href="statistics.html#cb186-19" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def, <span class="at">varname =</span> <span class="st">&quot;Y4&quot;</span>, <span class="at">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="at">formula =</span> <span class="st">&quot;Y3- 2*T&gt;0&quot;</span>, <span class="at">variance =</span> <span class="dv">1</span>)</span>
<span id="cb186-20"><a href="statistics.html#cb186-20" tabindex="-1"></a></span>
<span id="cb186-21"><a href="statistics.html#cb186-21" tabindex="-1"></a><span class="co">#male</span></span>
<span id="cb186-22"><a href="statistics.html#cb186-22" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def,<span class="at">varname =</span> <span class="st">&quot;Male&quot;</span>, <span class="at">dist =</span> <span class="st">&quot;binary&quot;</span>, <span class="at">formula =</span> <span class="fl">0.49</span><span class="sc">*</span>T)</span>
<span id="cb186-23"><a href="statistics.html#cb186-23" tabindex="-1"></a></span>
<span id="cb186-24"><a href="statistics.html#cb186-24" tabindex="-1"></a><span class="co">#diabetes .23 in TPA and .06 in ECR</span></span>
<span id="cb186-25"><a href="statistics.html#cb186-25" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def,<span class="at">varname =</span> <span class="st">&quot;Diabetes&quot;</span>, <span class="at">dist =</span> <span class="st">&quot;binary&quot;</span>, <span class="at">formula =</span> .<span class="dv">23</span><span class="fl">-.17</span><span class="sc">*</span>T)</span>
<span id="cb186-26"><a href="statistics.html#cb186-26" tabindex="-1"></a></span>
<span id="cb186-27"><a href="statistics.html#cb186-27" tabindex="-1"></a><span class="co">#HT .66 TPA vs .6 ECR</span></span>
<span id="cb186-28"><a href="statistics.html#cb186-28" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def,<span class="at">varname =</span> <span class="st">&quot;HT&quot;</span>, <span class="at">dist =</span> <span class="st">&quot;binary&quot;</span>, <span class="at">formula =</span> .<span class="dv">66</span><span class="fl">-.06</span><span class="sc">*</span>T)</span>
<span id="cb186-29"><a href="statistics.html#cb186-29" tabindex="-1"></a></span>
<span id="cb186-30"><a href="statistics.html#cb186-30" tabindex="-1"></a><span class="co">#generate data frame</span></span>
<span id="cb186-31"><a href="statistics.html#cb186-31" tabindex="-1"></a>dtTrial <span class="ot">&lt;-</span> <span class="fu">genData</span>(<span class="dv">500</span>, def)</span>
<span id="cb186-32"><a href="statistics.html#cb186-32" tabindex="-1"></a></span>
<span id="cb186-33"><a href="statistics.html#cb186-33" tabindex="-1"></a><span class="co">#define parameter for mRS</span></span>
<span id="cb186-34"><a href="statistics.html#cb186-34" tabindex="-1"></a></span>
<span id="cb186-35"><a href="statistics.html#cb186-35" tabindex="-1"></a></span>
<span id="cb186-36"><a href="statistics.html#cb186-36" tabindex="-1"></a><span class="co">#Add conditional column with field name &quot;mRS&quot;</span></span>
<span id="cb186-37"><a href="statistics.html#cb186-37" tabindex="-1"></a></span>
<span id="cb186-38"><a href="statistics.html#cb186-38" tabindex="-1"></a></span>
<span id="cb186-39"><a href="statistics.html#cb186-39" tabindex="-1"></a></span>
<span id="cb186-40"><a href="statistics.html#cb186-40" tabindex="-1"></a>dtTime <span class="ot">&lt;-</span> <span class="fu">addPeriods</span>(dtTrial, <span class="at">nPeriods =</span> <span class="dv">4</span>, <span class="at">idvars =</span> <span class="st">&quot;id&quot;</span>, </span>
<span id="cb186-41"><a href="statistics.html#cb186-41" tabindex="-1"></a>            <span class="at">timevars =</span> <span class="fu">c</span>(<span class="st">&quot;Y1&quot;</span>, <span class="st">&quot;Y2&quot;</span>, <span class="st">&quot;Y3&quot;</span>,<span class="st">&quot;Y4&quot;</span>), <span class="at">timevarName =</span> <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb186-42"><a href="statistics.html#cb186-42" tabindex="-1"></a>dtTime</span></code></pre></div>
<pre><code>##        id period T        ENI Male Diabetes HT            Y timeID
##    1:   1      0 1  0.6865101    1        0  0 13.487726418      1
##    2:   1      1 1  0.6865101    1        0  0 -0.759235490      2
##    3:   1      2 1  0.6865101    1        0  0 -0.173939710      3
##    4:   1      3 1  0.6865101    1        0  0 -0.115164184      4
##    5:   2      0 0 -0.1741510    1        0  0 13.732862935      5
##   ---                                                             
## 1996: 499      3 1 -0.2286396    1        0  1  0.509455573   1996
## 1997: 500      0 1  0.1863252    1        0  0 13.982381967   1997
## 1998: 500      1 1  0.1863252    1        0  0 -0.567360970   1998
## 1999: 500      2 1  0.1863252    1        0  0 -0.009112983   1999
## 2000: 500      3 1  0.1863252    1        0  0  1.178137896   2000</code></pre>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="statistics.html#cb188-1" tabindex="-1"></a><span class="co">#check  that 2 groups are similar at start but not at finish</span></span>
<span id="cb188-2"><a href="statistics.html#cb188-2" tabindex="-1"></a><span class="fu">t.test</span>(Y1<span class="sc">~</span>T,<span class="at">data=</span>dtTrial)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Y1 by T
## t = 0.10169, df = 496.81, p-value = 0.919
## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
## 95 percent confidence interval:
##  -0.1587929  0.1761272
## sample estimates:
## mean in group 0 mean in group 1 
##        12.99153        12.98286</code></pre>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="statistics.html#cb190-1" tabindex="-1"></a><span class="fu">t.test</span>(Y4<span class="sc">~</span>T,<span class="at">data=</span>dtTrial)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Y4 by T
## t = 4.5797, df = 483.72, p-value = 5.932e-06
## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
## 95 percent confidence interval:
##  0.2409061 0.6029656
## sample estimates:
## mean in group 0 mean in group 1 
##       0.4909581       0.0690222</code></pre>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="statistics.html#cb192-1" tabindex="-1"></a><span class="fu">t.test</span>(Male<span class="sc">~</span>T,<span class="at">data=</span>dtTrial)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Male by T
## t = -1.2948, df = 492.2, p-value = 0.196
## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
## 95 percent confidence interval:
##  -0.14594453  0.02999692
## sample estimates:
## mean in group 0 mean in group 1 
##       0.4533898       0.5113636</code></pre>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="statistics.html#cb194-1" tabindex="-1"></a><span class="co">#putting the 4 time periods together - long format</span></span>
<span id="cb194-2"><a href="statistics.html#cb194-2" tabindex="-1"></a>dtTime <span class="ot">&lt;-</span> <span class="fu">addPeriods</span>(dtTrial, <span class="at">nPeriods =</span> <span class="dv">3</span>, <span class="at">idvars =</span> <span class="st">&quot;id&quot;</span>, <span class="at">timevars =</span> <span class="fu">c</span>(<span class="st">&quot;Y1&quot;</span>, <span class="st">&quot;Y2&quot;</span>, <span class="st">&quot;Y3&quot;</span>,<span class="st">&quot;Y4&quot;</span>), <span class="at">timevarName =</span> <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb194-3"><a href="statistics.html#cb194-3" tabindex="-1"></a></span>
<span id="cb194-4"><a href="statistics.html#cb194-4" tabindex="-1"></a><span class="co">#summarise data using group_by</span></span>
<span id="cb194-5"><a href="statistics.html#cb194-5" tabindex="-1"></a>dtTime2<span class="ot">&lt;-</span>dtTime <span class="sc">%&gt;%</span></span>
<span id="cb194-6"><a href="statistics.html#cb194-6" tabindex="-1"></a>  <span class="fu">group_by</span>(period, T) <span class="sc">%&gt;%</span></span>
<span id="cb194-7"><a href="statistics.html#cb194-7" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">meanY=</span><span class="fu">mean</span>(Y),</span>
<span id="cb194-8"><a href="statistics.html#cb194-8" tabindex="-1"></a>            <span class="at">sdY=</span><span class="fu">sd</span>(Y),</span>
<span id="cb194-9"><a href="statistics.html#cb194-9" tabindex="-1"></a>            <span class="at">upperY=</span>meanY<span class="sc">+</span>sdY,</span>
<span id="cb194-10"><a href="statistics.html#cb194-10" tabindex="-1"></a>            <span class="at">lowerY=</span>meanY<span class="sc">-</span>sdY)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;period&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="statistics.html#cb196-1" tabindex="-1"></a><span class="co">#write.csv(dtTime, file=&quot;./Data-Use/dtTime_simulated.csv&quot;)</span></span>
<span id="cb196-2"><a href="statistics.html#cb196-2" tabindex="-1"></a><span class="co">#write.csv(dtTrial,          file=&quot;./Data-Use/dtTrial_simulated.csv&quot;)</span></span></code></pre></div>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-doi:10.1080/00031305.1998.10480550" class="csl-entry">
Agresti, Alan, and Brent A. Coull. 1998. <span>Approximate Is Better Than <span>Exact</span> for Interval Estimation of Binomial Proportions.</span> <em>The American Statistician</em> 52 (2): 11926. <a href="https://doi.org/10.1080/00031305.1998.10480550">https://doi.org/10.1080/00031305.1998.10480550</a>.
</div>
<div id="ref-pmid29387889" class="csl-entry">
Aung T, Kromhout D, Halsey J. 2018. <span>Associations of Omega-3 Fatty Acid Supplement Use with Cardiovascular Disease Risks: Meta-Analysis of 10 Trials Involving 77 917 Individuals.</span> <em>Jama Cardiol</em>, March. <a href="https://doi.org/doi: 10.1001/jamacardio.2017.5205">https://doi.org/doi: 10.1001/jamacardio.2017.5205</a>.
</div>
<div id="ref-doi10.1136/ebmental-2019-300117" class="csl-entry">
Balduzzi, Sara, Gerta Rcker, and Guido Schwarzer. 2019. <span>How to Perform a Meta-Analysis with <span>R</span>: A Practical Tutorial.</span> <em>Evidence-Based Mental Health</em>, no. 22: 15360.
</div>
<div id="ref-pmid25517348" class="csl-entry">
Berkhemer, O. A., P. S. Fransen, D. Beumer, L. A. van den Berg, H. F. Lingsma, A. J. Yoo, W. J. Schonewille, et al. 2015. <span><span class="nocase"><span>A</span> randomized trial of intraarterial treatment for acute ischemic stroke</span>.</span> <em>N. Engl. J. Med.</em> 372 (1): 1120.
</div>
<div id="ref-pmid10700737" class="csl-entry">
BJ, Biggerstaff. 2000. <span>Comparing Diagnostic Tests: A Simple Graphic Using Likelihood Ratios.</span> <em>Stat Med</em> 19 (March): 64963. <a href="https://doi.org/10.1002/(sici)1097-0258(20000315)19:5&lt;649::aid-sim371&gt;3.0.co;2-h">https://doi.org/10.1002/(sici)1097-0258(20000315)19:5&lt;649::aid-sim371&gt;3.0.co;2-h</a>.
</div>
<div id="ref-brown2001" class="csl-entry">
Brown, Lawrence D., T. Tony Cai, and Anirban DasGupta. 2001. <span>Interval Estimation for a Binomial Proportion.</span> <em>Statist. Sci.</em> 16 (2): 10133. <a href="https://doi.org/10.1214/ss/1009213286">https://doi.org/10.1214/ss/1009213286</a>.
</div>
<div id="ref-pmid25671797" class="csl-entry">
Campbell, B. C., P. J. Mitchell, T. J. Kleinig, H. M. Dewey, L. Churilov, N. Yassi, B. Yan, et al. 2015. <span><span class="nocase"><span>E</span>ndovascular therapy for ischemic stroke with perfusion-imaging selection</span>.</span> <em>N. Engl. J. Med.</em> 372 (11): 100918.
</div>
<div id="ref-COHEN1977179" class="csl-entry">
Cohen, Jacob. 1977. <span>CHAPTER 6 - Differences Between Proportions.</span> In <em>Statistical Power Analysis for the Behavioral Sciences</em>, edited by Jacob Cohen, 179213. Academic Press. https://doi.org/<a href="https://doi.org/10.1016/B978-0-12-179060-8.50011-6">https://doi.org/10.1016/B978-0-12-179060-8.50011-6</a>.
</div>
<div id="ref-pmid1738016" class="csl-entry">
Diamond, G. A. 1992. <span><span class="nocase"><span>W</span>hat price perfection? <span>C</span>alibration and discrimination of clinical prediction models</span>.</span> <em>J Clin Epidemiol</em> 45 (1): 8589.
</div>
<div id="ref-pmid25781447" class="csl-entry">
Gopal, A. D., N. R. Desai, T. Tse, and J. S. Ross. 2015. <span><span class="nocase"><span>R</span>eporting of noninferiority trials in <span>C</span>linical<span>T</span>rials.gov and corresponding publications</span>.</span> <em>JAMA</em> 313 (11): 116365.
</div>
<div id="ref-pmid10474158" class="csl-entry">
Graf E, Sauerbrei W, Schmoor C. 1999. <span>Assessment and Comparison of Prognostic Classification Schemes for Survival Data.</span> <em>Stat Med</em> 18 (September): 252945. <a href="https://doi.org/10.1002/(sici)1097-0258(19990915/30)18:17/18&lt;2529::aid-sim274&gt;3.0.co;2-5">https://doi.org/10.1002/(sici)1097-0258(19990915/30)18:17/18&lt;2529::aid-sim274&gt;3.0.co;2-5</a>.
</div>
<div id="ref-10.1093/biomet/81.3.515" class="csl-entry">
Grambsch, P. M., and T. M. Therneau. 1994. <span><span class="nocase">Proportional hazards tests and diagnostics based on weighted residuals</span>.</span> <em>Biometrika</em> 81 (3): 51526. <a href="https://doi.org/10.1093/biomet/81.3.515">https://doi.org/10.1093/biomet/81.3.515</a>.
</div>
<div id="ref-pmid7069920" class="csl-entry">
Harrell FE Jr, Pryor DB, Califf RM. 1982. <span>Evaluating the Yield of Medical Tests.</span> <em>JAMA</em> 247 (May): 254346.
</div>
<div id="ref-pmid31567003" class="csl-entry">
Hu, Hu, Y. 2019. <span>Marine Omega3 Supplementation and Cardiovascular Disease: An Updated Metaanalysis of 13 Randomized Controlled Trials Involving 127 477 Participants.</span> <em>JAHA</em>, September. https://doi.org/<a href="https://doi.org/10.1161/JAHA.119.013543">https://doi.org/10.1161/JAHA.119.013543</a>.
</div>
<div id="ref-pmid15345796" class="csl-entry">
Ingall, Timothy John, William Michael OFallon, Kjell Asplund, Lewis Robert Goldfrank, Vicki S. Hertzberg, Thomas Arthur Louis, and Teresa J. Hengy Christianson. 2004. <span>Findings from the Reanalysis of the NINDS Tissue Plasminogen Activator for Acute Ischemic Stroke Treatment Trial.</span> <em>Stroke</em> 35 (10): 241824. <a href="https://doi.org/10.1161/01.STR.0000140891.70547.56">https://doi.org/10.1161/01.STR.0000140891.70547.56</a>.
</div>
<div id="ref-pmid33250548" class="csl-entry">
J, Muschelli. 2020. <span>ROC and AUC with a Binary Predictor: A Potentially Misleading Metric.</span> <em>J Classif</em> 37 (October): 696708. <a href="https://doi.org/10.1007/s00357-019-09345-1">https://doi.org/10.1007/s00357-019-09345-1</a>.
</div>
<div id="ref-pmid8309035" class="csl-entry">
Jaeschke, R., G. H. Guyatt, and D. L. Sackett. 1994. <span><span class="nocase"><span>U</span>sers guides to the medical literature. <span>I</span><span>I</span><span>I</span>. <span>H</span>ow to use an article about a diagnostic test. <span>B</span>. <span>W</span>hat are the results and will they help me in caring for my patients? <span>T</span>he <span>E</span>vidence-<span>B</span>ased <span>M</span>edicine <span>W</span>orking <span>G</span>roup</span>.</span> <em>JAMA</em> 271 (9): 7037.
</div>
<div id="ref-10.1186/1745-6215-15-139" class="csl-entry">
Kahan, Jairath, B. C. 2014. <span>The Risks and Rewards of Covariate Adjustment in Randomized Trials: An Assessment of 12 Outcomes from 8 Studies.</span> <em>Trials</em> 15: 139. <a href="https://doi.org/10.1186/1745-6215-15-139">https://doi.org/10.1186/1745-6215-15-139</a>.
</div>
<div id="ref-pmid26080342" class="csl-entry">
Kaji, A. H., and R. J. Lewis. 2015. <span><span class="nocase"><span>N</span>oninferiority <span>T</span>rials: <span>I</span>s a <span>N</span>ew <span>T</span>reatment <span>A</span>lmost as <span>E</span>ffective as <span>A</span>nother?</span></span> <em>JAMA</em> 313 (23): 237172.
</div>
<div id="ref-LONGATO2020103496" class="csl-entry">
Longato, Enrico, Martina Vettoretti, and Barbara Di Camillo. 2020. <span>A Practical Perspective on the Concordance Index for the Evaluation and Selection of Prognostic Time-to-Event Models.</span> <em>Journal of Biomedical Informatics</em> 108: 103496. https://doi.org/<a href="https://doi.org/10.1016/j.jbi.2020.103496">https://doi.org/10.1016/j.jbi.2020.103496</a>.
</div>
<div id="ref-pmid32404155" class="csl-entry">
Ludwig, L., P. Darmon, and B Guerci. 2020. <span><span class="nocase">Computing and interpreting the Number Needed to Treat for Cardiovascular Outcomes Trials:Perspective on GLP-1 RA and SGLT-2i therapies</span>.</span> <em>Cardiovasc Diabetol</em>, May. <a href="https://doi.org/10.1186/s12933-020-01034-3">https://doi.org/10.1186/s12933-020-01034-3</a>.
</div>
<div id="ref-doi:10.1177/0962280216669183" class="csl-entry">
Luo, Dehui, Xiang Wan, Jiming Liu, and Tiejun Tong. 2018. <span>Optimally Estimating the Sample Mean from the Sample Size, Median, Mid-Range, and/or Mid-Quartile Range.</span> <em>Statistical Methods in Medical Research</em> 27 (6): 1785805. <a href="https://doi.org/10.1177/0962280216669183">https://doi.org/10.1177/0962280216669183</a>.
</div>
<div id="ref-pmid12614141" class="csl-entry">
Marx, Heiner C, Arthur. Bucher. 2003. <span>Numbers Needed to Treat Derived from Meta-Analysis: A Word of Caution.</span> <em>BMJ Evidence-Based Medicine</em> 8 (2): 3637. <a href="https://doi.org/10.1136/ebm.8.2.36">https://doi.org/10.1136/ebm.8.2.36</a>.
</div>
<div id="ref-pmid29912013" class="csl-entry">
Mathur MB, Riddell CA, Ding P. 2018. <span>Web Site and r Package for Computing e-Values.</span> <em>Epidemiology</em>, e4547. <a href="https://doi.org/10.1097/EDE.0000000000000864">https://doi.org/10.1097/EDE.0000000000000864</a>.
</div>
<div id="ref-pmid36412105" class="csl-entry">
McGrath, Sean, Stephan Katzenschlager, Alexander J. Zimmer, Alexander Seitel, Russell J. Steele, and Andrea Benedetti. 2022. <span>Standard Error Estimation in Meta-Analysis of Studies Reporting Medians.</span> <em>Statistical Methods in Medical Research</em> 32: 37388. <a href="https://doi.org/10.1177/09622802221139233">https://doi.org/10.1177/09622802221139233</a>.
</div>
<div id="ref-doi:10.1177/0962280219889080" class="csl-entry">
McGrath, Sean, XiaoFei Zhao, Russell Steele, Brett D. Thombs, Andrea Benedetti, the DEPRESsion Screening Data (DEPRESSD) Collaboration, Brooke Levis, et al. 2020. <span>Estimating the Sample Mean and Standard Deviation from Commonly Reported Quantiles in Meta-Analysis.</span> <em>Statistical Methods in Medical Research</em> 29 (9): 252037. <a href="https://doi.org/10.1177/0962280219889080">https://doi.org/10.1177/0962280219889080</a>.
</div>
<div id="ref-pmid8210827" class="csl-entry">
Moses, L. E., D. Shapiro, and B. Littenberg. 1993. <span><span class="nocase"><span>C</span>ombining independent studies of a diagnostic test into a summary <span>R</span><span>O</span><span>C</span> curve: data-analytic approaches and some additional considerations</span>.</span> <em>Stat Med</em> 12 (14): 12931316.
</div>
<div id="ref-pmid28579970" class="csl-entry">
Phan, T. G., B. B. Clissold, H. Ma, J. V. Ly, and V. Srikanth. 2017. <span><span class="nocase"><span>P</span>redicting <span>D</span>isability after <span>I</span>schemic <span>S</span>troke <span>B</span>ased on <span>C</span>omorbidity <span>I</span>ndex and <span>S</span>troke <span>S</span>everity-<span>F</span>rom the <span>V</span>irtual <span>I</span>nternational <span>S</span>troke <span>T</span>rials <span>A</span>rchive-<span>A</span>cute <span>C</span>ollaboration</span>.</span> <em>Front Neurol</em> 8: 192.
</div>
<div id="ref-pmid26796056" class="csl-entry">
Phan, T. G., B. Clissold, J. Ly, H. Ma, C. Moran, V. Srikanth, K. R. Lees, et al. 2016. <span><span class="nocase"><span>S</span>troke <span>S</span>everity and <span>C</span>omorbidity <span>I</span>ndex for <span>P</span>rediction of <span>M</span>ortality after <span>I</span>schemic <span>S</span>troke from the <span>V</span>irtual <span>I</span>nternational <span>S</span>troke <span>T</span>rials <span>A</span>rchive-<span>A</span>cute <span>C</span>ollaboration</span>.</span> <em>J Stroke Cerebrovasc Dis</em> 25 (4): 83542.
</div>
<div id="ref-pmid16931782" class="csl-entry">
Phan, T. G., G. A. Donnan, S. M. Davis, and G. Byrnes. 2006. <span><span class="nocase"><span>P</span>roof-of-principle phase <span>I</span><span>I</span> <span>M</span><span>R</span><span>I</span> studies in stroke: sample size estimates from dichotomous and continuous data</span>.</span> <em>Stroke</em> 37 (10): 252125.
</div>
<div id="ref-pmid16504541" class="csl-entry">
Phan, T. G., G. A. Donnan, M. Koga, L. A. Mitchell, M. Molan, G. Fitt, W. Chong, M. Holt, and D. C. Reutens. 2006. <span><span class="nocase"><span>T</span>he <span>A</span><span>S</span><span>P</span><span>E</span><span>C</span><span>T</span><span>S</span> template is weighted in favor of the striatocapsular region</span>.</span> <em>Neuroimage</em> 31 (2): 47781.
</div>
<div id="ref-pmid31272327" class="csl-entry">
Phan, T. G., N. Krishnadas, V. W. Y. Lai, M. Batt, L. A. Slater, R. V. Chandra, V. Srikanth, and H. Ma. 2019. <span><span class="nocase"><span>M</span>eta-<span>A</span>nalysis of <span>A</span>ccuracy of the <span>S</span>pot <span>S</span>ign for <span>P</span>redicting <span>H</span>ematoma <span>G</span>rowth and <span>C</span>linical <span>O</span>utcomes</span>.</span> <em>Stroke</em> 50 (8): 203036.
</div>
<div id="ref-pmid16168343" class="csl-entry">
Reitsma, J. B., A. S. Glas, A. W. Rutjes, R. J. Scholten, P. M. Bossuyt, and A. H. Zwinderman. 2005. <span><span class="nocase"><span>B</span>ivariate analysis of sensitivity and specificity produces informative summary measures in diagnostic reviews</span>.</span> <em>J Clin Epidemiol</em> 58 (10): 98290.
</div>
<div id="ref-pmid26080338" class="csl-entry">
Salminen, P., H. Paajanen, T. Rautio, P. Nordstrom, M. Aarnio, T. Rantanen, R. Tuominen, et al. 2015. <span><span class="nocase"><span>A</span>ntibiotic <span>T</span>herapy vs <span>A</span>ppendectomy for <span>T</span>reatment of <span>U</span>ncomplicated <span>A</span>cute <span>A</span>ppendicitis: <span>T</span>he <span>A</span><span>P</span><span>P</span><span>A</span><span>C</span> <span>R</span>andomized <span>C</span>linical <span>T</span>rial</span>.</span> <em>JAMA</em> 313 (23): 234048.
</div>
<div id="ref-pmid37161735" class="csl-entry">
Shi, Jiandong, Dehui Luo, Xiang Wan, Yue Liu, Jiming Liu, Zhaoxiang Bian, and Tiejun Tong. 2023. <span>Detecting the Skewness of Data from the Five-Number Summary and Its Application in Meta-Analysis.</span> <em>Statistical Methods in Medical Research</em> 32 (7): 133860. <a href="https://doi.org/10.1177/09622802231172043">https://doi.org/10.1177/09622802231172043</a>.
</div>
<div id="ref-doi10.1001/jamaneurol.2020.0678" class="csl-entry">
Signori, Alessio, Fabio Pellegrini, Francesca Bovis, Luca Carmisciano, Carl de Moor, and Maria Pia Sormani. 2020. <span><span class="nocase">Comparison of Placebos and Propensity Score Adjustment in Multiple Sclerosis Nonrandomized Studies</span>.</span> <em>JAMA Neurology</em>, April. <a href="https://doi.org/10.1001/jamaneurol.2020.0678">https://doi.org/10.1001/jamaneurol.2020.0678</a>.
</div>
<div id="ref-pmid10356018" class="csl-entry">
Smeeth, A. Ebrahim, L. Haines. 1999. <span><span class="nocase">Numbers needed to treat derived from meta-analysessometimes informative, usually misleading</span>.</span> <em>BMJ</em> 318: 154851. <a href="https://doi.org/10.1136/bmj.318.7197.1548">https://doi.org/10.1136/bmj.318.7197.1548</a>.
</div>
<div id="ref-pmid32167523" class="csl-entry">
Stensrud, M. J., and M. A. Hernan. 2020. <span><span class="nocase"><span>W</span>hy <span>T</span>est for <span>P</span>roportional <span>H</span>azards?</span></span> <em>JAMA</em>, March.
</div>
<div id="ref-pmid1143310" class="csl-entry">
TJ, Fagan. 1975. <span>Nomogram for Bayess Theorem.</span> <em>N Engl J Med</em> 293 (July): 257. <a href="https://doi.org/10.1056/NEJM197507312930513">https://doi.org/10.1056/NEJM197507312930513</a>.
</div>
<div id="ref-pmid28693043" class="csl-entry">
VanderWeele TJ, Ding P. 2017. <span>Sensitivity Analysis in Observational Research: Introducing the e-Value.</span> <em>Ann Intern Med</em> 167 (August): 26874. <a href="https://doi.org/10.7326/M16-2607">https://doi.org/10.7326/M16-2607</a>.
</div>
<div id="ref-JSSv036i03" class="csl-entry">
Viechtbauer, Wolfgang. 2010. <span>Conducting Meta-Analyses in r with the Metafor Package.</span> <em>Journal of Statistical Software</em> 36 (3): 148. <a href="https://doi.org/10.18637/jss.v036.i03">https://doi.org/10.18637/jss.v036.i03</a>.
</div>
<div id="ref-pmid25524443" class="csl-entry">
Wan, Wang, X. 2014. <span>Estimating the Sample Mean and Standard Deviation from the Sample Size, Median, Range and/or Interquartile Range.</span> <em>BMC Med Res Methodol</em>, December. https://doi.org/<a href="https://doi.org/10.1186/1471-2288-14-135">https://doi.org/10.1186/1471-2288-14-135</a>.
</div>
<div id="ref-doi:10.1056/NEJMsr077003" class="csl-entry">
Wang, Rui, Stephen W. Lagakos, James H. Ware, David J. Hunter, and Jeffrey M. Drazen. 2007. <span>Statistics in Medicine  Reporting of Subgroup Analyses in Clinical Trials.</span> <em>New England Journal of Medicine</em> 357 (21): 218994. <a href="https://doi.org/10.1056/NEJMsr077003">https://doi.org/10.1056/NEJMsr077003</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-wrangling.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multivariate-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/03-Statistics.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Applications-of-R-in-Healthcare.pdf", "Applications-of-R-in-Healthcare.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
