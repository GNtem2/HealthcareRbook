<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Statistics | Applications of R in Healthcare</title>
  <meta name="description" content="This is a book describing the use of R in Healthcare. It is aimed at beginners of R language. The majority of the examples are taken from works in Neurology. Where possible data from other disease such as heart disease, cancer and vaccine are used. The ideas and principles can be applied to other aspects of Healthcare. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Statistics | Applications of R in Healthcare" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a book describing the use of R in Healthcare. It is aimed at beginners of R language. The majority of the examples are taken from works in Neurology. Where possible data from other disease such as heart disease, cancer and vaccine are used. The ideas and principles can be applied to other aspects of Healthcare. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="GNtem2/HealthcareRbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Statistics | Applications of R in Healthcare" />
  
  <meta name="twitter:description" content="This is a book describing the use of R in Healthcare. It is aimed at beginners of R language. The majority of the examples are taken from works in Neurology. Where possible data from other disease such as heart disease, cancer and vaccine are used. The ideas and principles can be applied to other aspects of Healthcare. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Thanh Phan" />


<meta name="date" content="2024-02-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-wrangling.html"/>
<link rel="next" href="multivariate-analysis.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.2/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.2/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.2/leaflet-providers-plugin.js"></script>
<link href="libs/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="libs/HomeButton-0.0.1/home-button.js"></script>
<script src="libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.10/grViz.js"></script>
<script src="libs/d3-3.3.8/d3.min.js"></script>
<script src="libs/dagre-0.4.0/dagre-d3.min.js"></script>
<link href="libs/mermaid-0.3.0/dist/mermaid.css" rel="stylesheet" />
<script src="libs/mermaid-0.3.0/dist/mermaid.slim.min.js"></script>
<script src="libs/chromatography-0.1/chromatography.js"></script>
<script src="libs/DiagrammeR-binding-1.0.10/DiagrammeR.js"></script>
<link href="libs/vis-9.1.0/vis-network.min.css" rel="stylesheet" />
<script src="libs/vis-9.1.0/vis-network.min.js"></script>
<script src="libs/visNetwork-binding-2.1.2/visNetwork.js"></script>
<link href="libs/leaflet-awesomemarkers-2.0.3/leaflet.awesome-markers.css" rel="stylesheet" />
<script src="libs/leaflet-awesomemarkers-2.0.3/leaflet.awesome-markers.min.js"></script>
<link href="libs/ionicons-2.0.1/ionicons.min.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applications-of-R-in-Healthcare</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preamble</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#plot-using-base-r"><i class="fa fa-check"></i><b>2.1</b> Plot using base R</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#ggplot2"><i class="fa fa-check"></i><b>2.2</b> ggplot2</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#histogram"><i class="fa fa-check"></i><b>2.2.1</b> Histogram</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#bar-plot"><i class="fa fa-check"></i><b>2.2.2</b> Bar plot</a></li>
<li class="chapter" data-level="2.2.3" data-path="intro.html"><a href="intro.html#pie-chart"><i class="fa fa-check"></i><b>2.2.3</b> Pie chart</a></li>
<li class="chapter" data-level="2.2.4" data-path="intro.html"><a href="intro.html#scatter-plot"><i class="fa fa-check"></i><b>2.2.4</b> Scatter plot</a></li>
<li class="chapter" data-level="2.2.5" data-path="intro.html"><a href="intro.html#arrange-plot-in-grids"><i class="fa fa-check"></i><b>2.2.5</b> arrange plot in grids</a></li>
<li class="chapter" data-level="2.2.6" data-path="intro.html"><a href="intro.html#line-plot"><i class="fa fa-check"></i><b>2.2.6</b> Line plot</a></li>
<li class="chapter" data-level="2.2.7" data-path="intro.html"><a href="intro.html#facet-wrap"><i class="fa fa-check"></i><b>2.2.7</b> Facet wrap</a></li>
<li class="chapter" data-level="2.2.8" data-path="intro.html"><a href="intro.html#polygons"><i class="fa fa-check"></i><b>2.2.8</b> Polygons</a></li>
<li class="chapter" data-level="2.2.9" data-path="intro.html"><a href="intro.html#gantt-chart"><i class="fa fa-check"></i><b>2.2.9</b> Gantt chart</a></li>
<li class="chapter" data-level="2.2.10" data-path="intro.html"><a href="intro.html#heatmap"><i class="fa fa-check"></i><b>2.2.10</b> Heatmap</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#ggplot2-extra"><i class="fa fa-check"></i><b>2.3</b> ggplot2 extra</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#alluvial-and-sankey-diagram"><i class="fa fa-check"></i><b>2.3.1</b> Alluvial and Sankey diagram</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro.html"><a href="intro.html#survival-plot"><i class="fa fa-check"></i><b>2.3.2</b> Survival plot</a></li>
<li class="chapter" data-level="2.3.3" data-path="intro.html"><a href="intro.html#ggraph-and-tidygraph"><i class="fa fa-check"></i><b>2.3.3</b> ggraph and tidygraph</a></li>
<li class="chapter" data-level="2.3.4" data-path="intro.html"><a href="intro.html#ggparty-decision-tree"><i class="fa fa-check"></i><b>2.3.4</b> ggparty-decision tree</a></li>
<li class="chapter" data-level="2.3.5" data-path="intro.html"><a href="intro.html#map"><i class="fa fa-check"></i><b>2.3.5</b> Map</a></li>
<li class="chapter" data-level="2.3.6" data-path="intro.html"><a href="intro.html#ggwordcloud"><i class="fa fa-check"></i><b>2.3.6</b> ggwordcloud</a></li>
<li class="chapter" data-level="2.3.7" data-path="intro.html"><a href="intro.html#gganimate"><i class="fa fa-check"></i><b>2.3.7</b> gganimate</a></li>
<li class="chapter" data-level="2.3.8" data-path="intro.html"><a href="intro.html#ggneuro"><i class="fa fa-check"></i><b>2.3.8</b> ggneuro</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#plotly"><i class="fa fa-check"></i><b>2.4</b> plotly</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="intro.html"><a href="intro.html#scatter-plot-with-plotly"><i class="fa fa-check"></i><b>2.4.1</b> Scatter plot with plotly</a></li>
<li class="chapter" data-level="2.4.2" data-path="intro.html"><a href="intro.html#bar-plot-with-plotly"><i class="fa fa-check"></i><b>2.4.2</b> Bar plot with plotly</a></li>
<li class="chapter" data-level="2.4.3" data-path="intro.html"><a href="intro.html#heatmap-1"><i class="fa fa-check"></i><b>2.4.3</b> Heatmap</a></li>
<li class="chapter" data-level="2.4.4" data-path="intro.html"><a href="intro.html#map-1"><i class="fa fa-check"></i><b>2.4.4</b> map</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>3</b> Data Wrangling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-wrangling.html"><a href="data-wrangling.html#data"><i class="fa fa-check"></i><b>3.1</b> Data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="data-wrangling.html"><a href="data-wrangling.html#vector-arrays-matrix"><i class="fa fa-check"></i><b>3.1.1</b> Vector, Arrays, Matrix</a></li>
<li class="chapter" data-level="3.1.2" data-path="data-wrangling.html"><a href="data-wrangling.html#operators"><i class="fa fa-check"></i><b>3.1.2</b> Operators</a></li>
<li class="chapter" data-level="3.1.3" data-path="data-wrangling.html"><a href="data-wrangling.html#simple-function"><i class="fa fa-check"></i><b>3.1.3</b> Simple function</a></li>
<li class="chapter" data-level="3.1.4" data-path="data-wrangling.html"><a href="data-wrangling.html#for-loop"><i class="fa fa-check"></i><b>3.1.4</b> for loop</a></li>
<li class="chapter" data-level="3.1.5" data-path="data-wrangling.html"><a href="data-wrangling.html#apply-lapply-sapply"><i class="fa fa-check"></i><b>3.1.5</b> apply, lapply, sapply</a></li>
<li class="chapter" data-level="3.1.6" data-path="data-wrangling.html"><a href="data-wrangling.html#functional"><i class="fa fa-check"></i><b>3.1.6</b> Functional</a></li>
<li class="chapter" data-level="3.1.7" data-path="data-wrangling.html"><a href="data-wrangling.html#iteration"><i class="fa fa-check"></i><b>3.1.7</b> Iteration</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-wrangling.html"><a href="data-wrangling.html#data-storage"><i class="fa fa-check"></i><b>3.2</b> Data storage</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-wrangling.html"><a href="data-wrangling.html#data-frame"><i class="fa fa-check"></i><b>3.2.1</b> Data frame</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-wrangling.html"><a href="data-wrangling.html#excel-data"><i class="fa fa-check"></i><b>3.2.2</b> Excel data</a></li>
<li class="chapter" data-level="3.2.3" data-path="data-wrangling.html"><a href="data-wrangling.html#foreign-data"><i class="fa fa-check"></i><b>3.2.3</b> Foreign data</a></li>
<li class="chapter" data-level="3.2.4" data-path="data-wrangling.html"><a href="data-wrangling.html#json-format"><i class="fa fa-check"></i><b>3.2.4</b> json format</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-wrangling.html"><a href="data-wrangling.html#tidy-data"><i class="fa fa-check"></i><b>3.3</b> Tidy data</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-wrangling.html"><a href="data-wrangling.html#factors"><i class="fa fa-check"></i><b>3.3.1</b> Factors</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-wrangling.html"><a href="data-wrangling.html#multiple-files"><i class="fa fa-check"></i><b>3.3.2</b> Multiple files</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-wrangling.html"><a href="data-wrangling.html#tidy-evaluation"><i class="fa fa-check"></i><b>3.3.3</b> Tidy evaluation</a></li>
<li class="chapter" data-level="3.3.4" data-path="data-wrangling.html"><a href="data-wrangling.html#pivot-wide-and-long"><i class="fa fa-check"></i><b>3.3.4</b> Pivot wide and long</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-wrangling.html"><a href="data-wrangling.html#regular-expressions"><i class="fa fa-check"></i><b>3.4</b> Regular Expressions</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="data-wrangling.html"><a href="data-wrangling.html#base-r"><i class="fa fa-check"></i><b>3.4.1</b> base R</a></li>
<li class="chapter" data-level="3.4.2" data-path="data-wrangling.html"><a href="data-wrangling.html#stringr"><i class="fa fa-check"></i><b>3.4.2</b> stringr</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="data-wrangling.html"><a href="data-wrangling.html#pdf-to-xcel"><i class="fa fa-check"></i><b>3.5</b> PDF to xcel</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="data-wrangling.html"><a href="data-wrangling.html#scanned-text-or-picture"><i class="fa fa-check"></i><b>3.5.1</b> Scanned text or picture</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="data-wrangling.html"><a href="data-wrangling.html#web-scraping"><i class="fa fa-check"></i><b>3.6</b> Web scraping</a></li>
<li class="chapter" data-level="3.7" data-path="data-wrangling.html"><a href="data-wrangling.html#medical-images"><i class="fa fa-check"></i><b>3.7</b> Medical Images</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="data-wrangling.html"><a href="data-wrangling.html#dicom-and-nifti-format"><i class="fa fa-check"></i><b>3.7.1</b> DICOM and nifti format</a></li>
<li class="chapter" data-level="3.7.2" data-path="data-wrangling.html"><a href="data-wrangling.html#manipulating-array-of-medical-images"><i class="fa fa-check"></i><b>3.7.2</b> Manipulating array of medical images</a></li>
<li class="chapter" data-level="3.7.3" data-path="data-wrangling.html"><a href="data-wrangling.html#combining-arrays"><i class="fa fa-check"></i><b>3.7.3</b> Combining arrays</a></li>
<li class="chapter" data-level="3.7.4" data-path="data-wrangling.html"><a href="data-wrangling.html#math-operation-on-multidimensional-array"><i class="fa fa-check"></i><b>3.7.4</b> Math operation on multidimensional array</a></li>
<li class="chapter" data-level="3.7.5" data-path="data-wrangling.html"><a href="data-wrangling.html#math-operation-on-list"><i class="fa fa-check"></i><b>3.7.5</b> Math operation on list</a></li>
<li class="chapter" data-level="3.7.6" data-path="data-wrangling.html"><a href="data-wrangling.html#vectorising-nifti-object"><i class="fa fa-check"></i><b>3.7.6</b> Vectorising nifti object</a></li>
<li class="chapter" data-level="3.7.7" data-path="data-wrangling.html"><a href="data-wrangling.html#tar-file"><i class="fa fa-check"></i><b>3.7.7</b> tar file</a></li>
<li class="chapter" data-level="3.7.8" data-path="data-wrangling.html"><a href="data-wrangling.html#image-registration"><i class="fa fa-check"></i><b>3.7.8</b> Image registration</a></li>
<li class="chapter" data-level="3.7.9" data-path="data-wrangling.html"><a href="data-wrangling.html#rescaling"><i class="fa fa-check"></i><b>3.7.9</b> Rescaling</a></li>
<li class="chapter" data-level="3.7.10" data-path="data-wrangling.html"><a href="data-wrangling.html#mni-template"><i class="fa fa-check"></i><b>3.7.10</b> MNI template</a></li>
<li class="chapter" data-level="3.7.11" data-path="data-wrangling.html"><a href="data-wrangling.html#atlases"><i class="fa fa-check"></i><b>3.7.11</b> Atlases</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="data-wrangling.html"><a href="data-wrangling.html#ecg-signal-processing"><i class="fa fa-check"></i><b>3.8</b> ECG Signal processing</a></li>
<li class="chapter" data-level="3.9" data-path="data-wrangling.html"><a href="data-wrangling.html#eeg-signal-processing"><i class="fa fa-check"></i><b>3.9</b> EEG signal processing</a></li>
<li class="chapter" data-level="3.10" data-path="data-wrangling.html"><a href="data-wrangling.html#python"><i class="fa fa-check"></i><b>3.10</b> Python</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="data-wrangling.html"><a href="data-wrangling.html#reticulate"><i class="fa fa-check"></i><b>3.10.1</b> Reticulate</a></li>
<li class="chapter" data-level="3.10.2" data-path="data-wrangling.html"><a href="data-wrangling.html#minconda"><i class="fa fa-check"></i><b>3.10.2</b> Minconda</a></li>
<li class="chapter" data-level="3.10.3" data-path="data-wrangling.html"><a href="data-wrangling.html#python-environment"><i class="fa fa-check"></i><b>3.10.3</b> Python environment</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="data-wrangling.html"><a href="data-wrangling.html#matlab"><i class="fa fa-check"></i><b>3.11</b> Matlab</a></li>
<li class="chapter" data-level="3.12" data-path="data-wrangling.html"><a href="data-wrangling.html#stata"><i class="fa fa-check"></i><b>3.12</b> Stata</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>4</b> Statistics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="statistics.html"><a href="statistics.html#univariable-analyses"><i class="fa fa-check"></i><b>4.1</b> Univariable analyses</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="statistics.html"><a href="statistics.html#parametric-tests"><i class="fa fa-check"></i><b>4.1.1</b> Parametric tests</a></li>
<li class="chapter" data-level="4.1.2" data-path="statistics.html"><a href="statistics.html#non-parametric-tests"><i class="fa fa-check"></i><b>4.1.2</b> Non-parametric tests</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="statistics.html"><a href="statistics.html#regression"><i class="fa fa-check"></i><b>4.2</b> Regression</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="statistics.html"><a href="statistics.html#brief-review-of-matrix"><i class="fa fa-check"></i><b>4.2.1</b> Brief review of matrix</a></li>
<li class="chapter" data-level="4.2.2" data-path="statistics.html"><a href="statistics.html#linear-least-square-regression"><i class="fa fa-check"></i><b>4.2.2</b> Linear (least square) regression</a></li>
<li class="chapter" data-level="4.2.3" data-path="statistics.html"><a href="statistics.html#logistic-regression"><i class="fa fa-check"></i><b>4.2.3</b> Logistic regression</a></li>
<li class="chapter" data-level="4.2.4" data-path="statistics.html"><a href="statistics.html#discrimination-and-calibration"><i class="fa fa-check"></i><b>4.2.4</b> Discrimination and Calibration</a></li>
<li class="chapter" data-level="4.2.5" data-path="statistics.html"><a href="statistics.html#interaction"><i class="fa fa-check"></i><b>4.2.5</b> Interaction</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="statistics.html"><a href="statistics.html#confounder"><i class="fa fa-check"></i><b>4.3</b> Confounder</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="statistics.html"><a href="statistics.html#confounder-weighted-model"><i class="fa fa-check"></i><b>4.3.1</b> Confounder weighted model</a></li>
<li class="chapter" data-level="4.3.2" data-path="statistics.html"><a href="statistics.html#propensity-matching"><i class="fa fa-check"></i><b>4.3.2</b> Propensity matching</a></li>
<li class="chapter" data-level="4.3.3" data-path="statistics.html"><a href="statistics.html#e-values"><i class="fa fa-check"></i><b>4.3.3</b> E-values</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="statistics.html"><a href="statistics.html#causal-inference"><i class="fa fa-check"></i><b>4.4</b> Causal inference</a></li>
<li class="chapter" data-level="4.5" data-path="statistics.html"><a href="statistics.html#special-types-of-regression"><i class="fa fa-check"></i><b>4.5</b> Special types of regression</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="statistics.html"><a href="statistics.html#ordinal-regression"><i class="fa fa-check"></i><b>4.5.1</b> Ordinal regression</a></li>
<li class="chapter" data-level="4.5.2" data-path="statistics.html"><a href="statistics.html#survival-analysis"><i class="fa fa-check"></i><b>4.5.2</b> Survival analysis</a></li>
<li class="chapter" data-level="4.5.3" data-path="statistics.html"><a href="statistics.html#quantile-regression"><i class="fa fa-check"></i><b>4.5.3</b> Quantile regression</a></li>
<li class="chapter" data-level="4.5.4" data-path="statistics.html"><a href="statistics.html#non-negative-regression"><i class="fa fa-check"></i><b>4.5.4</b> Non-negative regression</a></li>
<li class="chapter" data-level="4.5.5" data-path="statistics.html"><a href="statistics.html#poisson-regression"><i class="fa fa-check"></i><b>4.5.5</b> Poisson regression</a></li>
<li class="chapter" data-level="4.5.6" data-path="statistics.html"><a href="statistics.html#conditional-logistic-regression"><i class="fa fa-check"></i><b>4.5.6</b> Conditional logistic regression</a></li>
<li class="chapter" data-level="4.5.7" data-path="statistics.html"><a href="statistics.html#multinomial-modelling"><i class="fa fa-check"></i><b>4.5.7</b> Multinomial modelling</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="statistics.html"><a href="statistics.html#sample-size-estimation"><i class="fa fa-check"></i><b>4.6</b> Sample size estimation</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="statistics.html"><a href="statistics.html#proportion"><i class="fa fa-check"></i><b>4.6.1</b> Proportion</a></li>
<li class="chapter" data-level="4.6.2" data-path="statistics.html"><a href="statistics.html#logistic-regression-1"><i class="fa fa-check"></i><b>4.6.2</b> Logistic regression</a></li>
<li class="chapter" data-level="4.6.3" data-path="statistics.html"><a href="statistics.html#survival-studies"><i class="fa fa-check"></i><b>4.6.3</b> Survival studies</a></li>
<li class="chapter" data-level="4.6.4" data-path="statistics.html"><a href="statistics.html#multiple-regression"><i class="fa fa-check"></i><b>4.6.4</b> Multiple regression</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="statistics.html"><a href="statistics.html#randomised-clinical-trials"><i class="fa fa-check"></i><b>4.7</b> Randomised clinical trials</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="statistics.html"><a href="statistics.html#covariate-adjustment-in-trials"><i class="fa fa-check"></i><b>4.7.1</b> Covariate adjustment in trials</a></li>
<li class="chapter" data-level="4.7.2" data-path="statistics.html"><a href="statistics.html#subgroup-analysis"><i class="fa fa-check"></i><b>4.7.2</b> Subgroup analysis</a></li>
<li class="chapter" data-level="4.7.3" data-path="statistics.html"><a href="statistics.html#p-value-for-interaction"><i class="fa fa-check"></i><b>4.7.3</b> p value for interaction</a></li>
<li class="chapter" data-level="4.7.4" data-path="statistics.html"><a href="statistics.html#interpreting-risk-reduction-in-clinical-trials"><i class="fa fa-check"></i><b>4.7.4</b> Interpreting risk reduction in clinical trials</a></li>
<li class="chapter" data-level="4.7.5" data-path="statistics.html"><a href="statistics.html#nnt-from-arr"><i class="fa fa-check"></i><b>4.7.5</b> NNT from ARR</a></li>
<li class="chapter" data-level="4.7.6" data-path="statistics.html"><a href="statistics.html#nnt-from-odds-ratio"><i class="fa fa-check"></i><b>4.7.6</b> NNT from odds ratio</a></li>
<li class="chapter" data-level="4.7.7" data-path="statistics.html"><a href="statistics.html#nnt-from-risk-ratio"><i class="fa fa-check"></i><b>4.7.7</b> NNT from risk ratio</a></li>
<li class="chapter" data-level="4.7.8" data-path="statistics.html"><a href="statistics.html#nnt-from-hazard-ratio"><i class="fa fa-check"></i><b>4.7.8</b> NNT from hazard ratio</a></li>
<li class="chapter" data-level="4.7.9" data-path="statistics.html"><a href="statistics.html#nnt-from-metaananlysis"><i class="fa fa-check"></i><b>4.7.9</b> NNT from metaananlysis</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="statistics.html"><a href="statistics.html#diagnostic-test"><i class="fa fa-check"></i><b>4.8</b> Diagnostic test</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="statistics.html"><a href="statistics.html#sensitivity-specificity"><i class="fa fa-check"></i><b>4.8.1</b> Sensitivity, specificity</a></li>
<li class="chapter" data-level="4.8.2" data-path="statistics.html"><a href="statistics.html#auc"><i class="fa fa-check"></i><b>4.8.2</b> AUC</a></li>
<li class="chapter" data-level="4.8.3" data-path="statistics.html"><a href="statistics.html#likelihood-ratio"><i class="fa fa-check"></i><b>4.8.3</b> Likelihood ratio</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="statistics.html"><a href="statistics.html#metaanalysis"><i class="fa fa-check"></i><b>4.9</b> Metaanalysis</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="statistics.html"><a href="statistics.html#quality-of-study"><i class="fa fa-check"></i><b>4.9.1</b> Quality of study</a></li>
<li class="chapter" data-level="4.9.2" data-path="statistics.html"><a href="statistics.html#prisma"><i class="fa fa-check"></i><b>4.9.2</b> PRISMA</a></li>
<li class="chapter" data-level="4.9.3" data-path="statistics.html"><a href="statistics.html#conversion-of-median-to-mean"><i class="fa fa-check"></i><b>4.9.3</b> Conversion of median to mean</a></li>
<li class="chapter" data-level="4.9.4" data-path="statistics.html"><a href="statistics.html#inconsistency-i2"><i class="fa fa-check"></i><b>4.9.4</b> Inconsistency I2</a></li>
<li class="chapter" data-level="4.9.5" data-path="statistics.html"><a href="statistics.html#metaanalysis-of-proportion"><i class="fa fa-check"></i><b>4.9.5</b> Metaanalysis of proportion</a></li>
<li class="chapter" data-level="4.9.6" data-path="statistics.html"><a href="statistics.html#metaanalysis-of-continuous-data"><i class="fa fa-check"></i><b>4.9.6</b> Metaanalysis of continuous data</a></li>
<li class="chapter" data-level="4.9.7" data-path="statistics.html"><a href="statistics.html#bivariate-metaanalysis"><i class="fa fa-check"></i><b>4.9.7</b> Bivariate Metaanalysis</a></li>
<li class="chapter" data-level="4.9.8" data-path="statistics.html"><a href="statistics.html#metaanalysis-of-clinical-trial."><i class="fa fa-check"></i><b>4.9.8</b> Metaanalysis of clinical trial.</a></li>
<li class="chapter" data-level="4.9.9" data-path="statistics.html"><a href="statistics.html#metaregression"><i class="fa fa-check"></i><b>4.9.9</b> Metaregression</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="statistics.html"><a href="statistics.html#data-simulation"><i class="fa fa-check"></i><b>4.10</b> Data simulation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html"><i class="fa fa-check"></i><b>5</b> Multivariate Analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#multivariate-regression"><i class="fa fa-check"></i><b>5.1</b> Multivariate regression</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#penalised-regression"><i class="fa fa-check"></i><b>5.1.1</b> Penalised regression</a></li>
<li class="chapter" data-level="5.1.2" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#mars"><i class="fa fa-check"></i><b>5.1.2</b> MARS</a></li>
<li class="chapter" data-level="5.1.3" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#mixed-modelling"><i class="fa fa-check"></i><b>5.1.3</b> Mixed modelling</a></li>
<li class="chapter" data-level="5.1.4" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#trajectory-modelling"><i class="fa fa-check"></i><b>5.1.4</b> Trajectory modelling</a></li>
<li class="chapter" data-level="5.1.5" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#generalized-estimating-equation-gee"><i class="fa fa-check"></i><b>5.1.5</b> Generalized estimating equation (GEE)</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#principal-component-analysis"><i class="fa fa-check"></i><b>5.2</b> Principal component analysis</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#pca-with-mri"><i class="fa fa-check"></i><b>5.2.1</b> PCA with MRI</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#independent-component-analysis"><i class="fa fa-check"></i><b>5.3</b> Independent component analysis</a></li>
<li class="chapter" data-level="5.4" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#partial-least-squares"><i class="fa fa-check"></i><b>5.4</b> Partial least squares</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="machine-learning.html"><a href="machine-learning.html"><i class="fa fa-check"></i><b>6</b> Machine learning</a>
<ul>
<li class="chapter" data-level="6.1" data-path="machine-learning.html"><a href="machine-learning.html#decision-tree-analysis"><i class="fa fa-check"></i><b>6.1</b> Decision tree analysis</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="machine-learning.html"><a href="machine-learning.html#information-theory-driven"><i class="fa fa-check"></i><b>6.1.1</b> Information theory driven</a></li>
<li class="chapter" data-level="6.1.2" data-path="machine-learning.html"><a href="machine-learning.html#conditional-decision-tree"><i class="fa fa-check"></i><b>6.1.2</b> Conditional decision tree</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="machine-learning.html"><a href="machine-learning.html#ensemble-tree-methods"><i class="fa fa-check"></i><b>6.2</b> Ensemble tree methods</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="machine-learning.html"><a href="machine-learning.html#bagging-trees"><i class="fa fa-check"></i><b>6.2.1</b> Bagging trees</a></li>
<li class="chapter" data-level="6.2.2" data-path="machine-learning.html"><a href="machine-learning.html#boosting-trees"><i class="fa fa-check"></i><b>6.2.2</b> Boosting trees</a></li>
<li class="chapter" data-level="6.2.3" data-path="machine-learning.html"><a href="machine-learning.html#bayesian-trees-method"><i class="fa fa-check"></i><b>6.2.3</b> Bayesian trees method</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="machine-learning.html"><a href="machine-learning.html#knn"><i class="fa fa-check"></i><b>6.3</b> KNN</a></li>
<li class="chapter" data-level="6.4" data-path="machine-learning.html"><a href="machine-learning.html#support-vector-machine"><i class="fa fa-check"></i><b>6.4</b> Support vector machine</a></li>
<li class="chapter" data-level="6.5" data-path="machine-learning.html"><a href="machine-learning.html#non-negative-matrix-factorisation"><i class="fa fa-check"></i><b>6.5</b> Non-negative matrix factorisation</a></li>
<li class="chapter" data-level="6.6" data-path="machine-learning.html"><a href="machine-learning.html#formal-concept-analysis"><i class="fa fa-check"></i><b>6.6</b> Formal concept analysis</a></li>
<li class="chapter" data-level="6.7" data-path="machine-learning.html"><a href="machine-learning.html#evolutionary-algorithm"><i class="fa fa-check"></i><b>6.7</b> Evolutionary Algorithm</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="machine-learning.html"><a href="machine-learning.html#simulated-annealing"><i class="fa fa-check"></i><b>6.7.1</b> Simulated Annealing</a></li>
<li class="chapter" data-level="6.7.2" data-path="machine-learning.html"><a href="machine-learning.html#genetic-algorithm"><i class="fa fa-check"></i><b>6.7.2</b> Genetic Algorithm</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="machine-learning.html"><a href="machine-learning.html#manifold-learning"><i class="fa fa-check"></i><b>6.8</b> Manifold learning</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="machine-learning.html"><a href="machine-learning.html#t-stochastic-neighbourhood-embedding"><i class="fa fa-check"></i><b>6.8.1</b> T-Stochastic Neighbourhood Embedding</a></li>
<li class="chapter" data-level="6.8.2" data-path="machine-learning.html"><a href="machine-learning.html#self-organising-map"><i class="fa fa-check"></i><b>6.8.2</b> Self organising map</a></li>
<li class="chapter" data-level="6.8.3" data-path="machine-learning.html"><a href="machine-learning.html#multidimensional-scaling"><i class="fa fa-check"></i><b>6.8.3</b> Multidimensional scaling</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="machine-learning.html"><a href="machine-learning.html#deep-learning"><i class="fa fa-check"></i><b>6.9</b> Deep learning</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="machine-learning.html"><a href="machine-learning.html#deep-neural-network"><i class="fa fa-check"></i><b>6.9.1</b> Deep neural network</a></li>
<li class="chapter" data-level="6.9.2" data-path="machine-learning.html"><a href="machine-learning.html#tabnet"><i class="fa fa-check"></i><b>6.9.2</b> Tabnet</a></li>
<li class="chapter" data-level="6.9.3" data-path="machine-learning.html"><a href="machine-learning.html#cnn"><i class="fa fa-check"></i><b>6.9.3</b> CNN</a></li>
<li class="chapter" data-level="6.9.4" data-path="machine-learning.html"><a href="machine-learning.html#rnn"><i class="fa fa-check"></i><b>6.9.4</b> RNN</a></li>
<li class="chapter" data-level="6.9.5" data-path="machine-learning.html"><a href="machine-learning.html#reinforcement-learning"><i class="fa fa-check"></i><b>6.9.5</b> Reinforcement learning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html"><i class="fa fa-check"></i><b>7</b> Machine Learning Part 2</a>
<ul>
<li class="chapter" data-level="7.1" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#bag-of-words"><i class="fa fa-check"></i><b>7.1</b> Bag of words</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#tfidf"><i class="fa fa-check"></i><b>7.1.1</b> TFIDF</a></li>
<li class="chapter" data-level="7.1.2" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#extracting-data-from-web"><i class="fa fa-check"></i><b>7.1.2</b> Extracting data from web</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#wordcloud"><i class="fa fa-check"></i><b>7.2</b> Wordcloud</a></li>
<li class="chapter" data-level="7.3" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#bigram-analysis"><i class="fa fa-check"></i><b>7.3</b> Bigram analysis</a></li>
<li class="chapter" data-level="7.4" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#trigram"><i class="fa fa-check"></i><b>7.4</b> Trigram</a></li>
<li class="chapter" data-level="7.5" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#topic-modeling-or-thematic-analysis"><i class="fa fa-check"></i><b>7.5</b> Topic modeling or thematic analysis</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#probabilistic-topic-model"><i class="fa fa-check"></i><b>7.5.1</b> Probabilistic topic model</a></li>
<li class="chapter" data-level="7.5.2" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#nmf"><i class="fa fa-check"></i><b>7.5.2</b> NMF</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html"><i class="fa fa-check"></i><b>8</b> Bayesian Analysis</a>
<ul>
<li class="chapter" data-level="8.1" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#baysian-belief"><i class="fa fa-check"></i><b>8.1</b> Baysian belief</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#conditional-probability"><i class="fa fa-check"></i><b>8.1.1</b> Conditional probability</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#markov-model"><i class="fa fa-check"></i><b>8.2</b> Markov model</a></li>
<li class="chapter" data-level="8.3" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#inla-stan-and-bugs"><i class="fa fa-check"></i><b>8.3</b> INLA, Stan and BUGS</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#linear-regression"><i class="fa fa-check"></i><b>8.3.1</b> Linear regression</a></li>
<li class="chapter" data-level="8.3.2" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#logistic-regression-2"><i class="fa fa-check"></i><b>8.3.2</b> Logistic regression</a></li>
<li class="chapter" data-level="8.3.3" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#mixed-model"><i class="fa fa-check"></i><b>8.3.3</b> Mixed model</a></li>
<li class="chapter" data-level="8.3.4" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#bayesian-metaanalysis"><i class="fa fa-check"></i><b>8.3.4</b> Bayesian Metaanalysis</a></li>
<li class="chapter" data-level="8.3.5" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#cost"><i class="fa fa-check"></i><b>8.3.5</b> Cost</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="operational-research.html"><a href="operational-research.html"><i class="fa fa-check"></i><b>9</b> Operational Research</a>
<ul>
<li class="chapter" data-level="9.1" data-path="operational-research.html"><a href="operational-research.html#queueing-theory"><i class="fa fa-check"></i><b>9.1</b> Queueing theory</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="operational-research.html"><a href="operational-research.html#simulate-capacity-of-system"><i class="fa fa-check"></i><b>9.1.1</b> Simulate capacity of system</a></li>
<li class="chapter" data-level="9.1.2" data-path="operational-research.html"><a href="operational-research.html#queuing-network"><i class="fa fa-check"></i><b>9.1.2</b> Queuing network</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="operational-research.html"><a href="operational-research.html#linear-programming"><i class="fa fa-check"></i><b>9.2</b> Linear Programming</a></li>
<li class="chapter" data-level="9.3" data-path="operational-research.html"><a href="operational-research.html#forecasting"><i class="fa fa-check"></i><b>9.3</b> Forecasting</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="operational-research.html"><a href="operational-research.html#bed-requirement"><i class="fa fa-check"></i><b>9.3.1</b> Bed requirement</a></li>
<li class="chapter" data-level="9.3.2" data-path="operational-research.html"><a href="operational-research.html#length-of-stay"><i class="fa fa-check"></i><b>9.3.2</b> Length of stay</a></li>
<li class="chapter" data-level="9.3.3" data-path="operational-research.html"><a href="operational-research.html#customer-churns"><i class="fa fa-check"></i><b>9.3.3</b> Customer churns</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="operational-research.html"><a href="operational-research.html#process-mapping"><i class="fa fa-check"></i><b>9.4</b> Process mapping</a></li>
<li class="chapter" data-level="9.5" data-path="operational-research.html"><a href="operational-research.html#supply-chains"><i class="fa fa-check"></i><b>9.5</b> Supply chains</a></li>
<li class="chapter" data-level="9.6" data-path="operational-research.html"><a href="operational-research.html#health-economics"><i class="fa fa-check"></i><b>9.6</b> Health economics</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="operational-research.html"><a href="operational-research.html#cost-1"><i class="fa fa-check"></i><b>9.6.1</b> Cost</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="graph-theory.html"><a href="graph-theory.html"><i class="fa fa-check"></i><b>10</b> Graph Theory</a>
<ul>
<li class="chapter" data-level="10.1" data-path="graph-theory.html"><a href="graph-theory.html#special-graphs"><i class="fa fa-check"></i><b>10.1</b> Special graphs</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="graph-theory.html"><a href="graph-theory.html#laplacian-matrix"><i class="fa fa-check"></i><b>10.1.1</b> Laplacian matrix</a></li>
<li class="chapter" data-level="10.1.2" data-path="graph-theory.html"><a href="graph-theory.html#bimodal-bipartite-graph"><i class="fa fa-check"></i><b>10.1.2</b> Bimodal (bipartite) graph</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="graph-theory.html"><a href="graph-theory.html#centrality-measures"><i class="fa fa-check"></i><b>10.2</b> Centrality Measures</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="graph-theory.html"><a href="graph-theory.html#local-centrality-measures"><i class="fa fa-check"></i><b>10.2.1</b> Local centrality measures</a></li>
<li class="chapter" data-level="10.2.2" data-path="graph-theory.html"><a href="graph-theory.html#global-centrality-measures"><i class="fa fa-check"></i><b>10.2.2</b> Global centrality measures</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="graph-theory.html"><a href="graph-theory.html#community"><i class="fa fa-check"></i><b>10.3</b> Community</a></li>
<li class="chapter" data-level="10.4" data-path="graph-theory.html"><a href="graph-theory.html#visualising-graph"><i class="fa fa-check"></i><b>10.4</b> Visualising graph</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="graph-theory.html"><a href="graph-theory.html#visnetwork"><i class="fa fa-check"></i><b>10.4.1</b> Visnetwork</a></li>
<li class="chapter" data-level="10.4.2" data-path="graph-theory.html"><a href="graph-theory.html#large-graph"><i class="fa fa-check"></i><b>10.4.2</b> Large graph</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="graph-theory.html"><a href="graph-theory.html#social-media-and-network-analysis"><i class="fa fa-check"></i><b>10.5</b> Social Media and Network Analysis</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="graph-theory.html"><a href="graph-theory.html#twitter"><i class="fa fa-check"></i><b>10.5.1</b> Twitter</a></li>
<li class="chapter" data-level="10.5.2" data-path="graph-theory.html"><a href="graph-theory.html#youtube"><i class="fa fa-check"></i><b>10.5.2</b> Youtube</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html"><i class="fa fa-check"></i><b>11</b> Geospatial analysis</a>
<ul>
<li class="chapter" data-level="11.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#geocoding"><i class="fa fa-check"></i><b>11.1</b> Geocoding</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#openstreetmap"><i class="fa fa-check"></i><b>11.1.1</b> OpenStreetMap</a></li>
<li class="chapter" data-level="11.1.2" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#google-maps-api"><i class="fa fa-check"></i><b>11.1.2</b> Google Maps API</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#sp-and-sf-objects"><i class="fa fa-check"></i><b>11.2</b> Sp and sf objects</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#section-1"><i class="fa fa-check"></i><b>11.2.1</b> </a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#thematic-map-1"><i class="fa fa-check"></i><b>11.3</b> Thematic map</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#calculate-distance-to-hospital-openstreetmap"><i class="fa fa-check"></i><b>11.3.1</b> Calculate distance to Hospital-OpenStreetMap</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#spatial-regression"><i class="fa fa-check"></i><b>11.4</b> Spatial regression</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#new-york-covid-19-mortality"><i class="fa fa-check"></i><b>11.4.1</b> New York COVID-19 mortality</a></li>
<li class="chapter" data-level="11.4.2" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#danish-stroke-registry"><i class="fa fa-check"></i><b>11.4.2</b> Danish Stroke Registry</a></li>
<li class="chapter" data-level="11.4.3" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#inla"><i class="fa fa-check"></i><b>11.4.3</b> INLA</a></li>
<li class="chapter" data-level="11.4.4" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#stan"><i class="fa fa-check"></i><b>11.4.4</b> Stan</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#machine-learning-in-spatial-analysis"><i class="fa fa-check"></i><b>11.5</b> Machine learning in spatial analysis</a></li>
<li class="chapter" data-level="11.6" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#spatio-temporal-regression"><i class="fa fa-check"></i><b>11.6</b> Spatio-temporal regression</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="app.html"><a href="app.html"><i class="fa fa-check"></i><b>12</b> App</a>
<ul>
<li class="chapter" data-level="12.1" data-path="app.html"><a href="app.html#brief-introduction-to-shiny-app"><i class="fa fa-check"></i><b>12.1</b> Brief introduction to Shiny app</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>13</b> Appendix</a>
<ul>
<li class="chapter" data-level="13.1" data-path="appendix.html"><a href="appendix.html#brief-introduction-to-matrix"><i class="fa fa-check"></i><b>13.1</b> Brief introduction to Matrix</a></li>
<li class="chapter" data-level="13.2" data-path="appendix.html"><a href="appendix.html#regression-1"><i class="fa fa-check"></i><b>13.2</b> Regression</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="appendix.html"><a href="appendix.html#linear-regression-1"><i class="fa fa-check"></i><b>13.2.1</b> Linear regression</a></li>
<li class="chapter" data-level="13.2.2" data-path="appendix.html"><a href="appendix.html#logistic-regression-3"><i class="fa fa-check"></i><b>13.2.2</b> Logistic regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applications of R in Healthcare</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="statistics" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Statistics<a href="statistics.html#statistics" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This section is not intended as a textbook on statistics. Rather it demonstrates regression approaches that can be used including sample size estimation, R codes provided.</p>
<div id="univariable-analyses" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Univariable analyses<a href="statistics.html#univariable-analyses" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="parametric-tests" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Parametric tests<a href="statistics.html#parametric-tests" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>T-test is the workhorse for comparing if 2 datasets are have the same distribution. Performing t-test in R requires data from 2 columns: one
containing the variables for comparison and one to label the group. There are different forms of t-test depending on whether the two samples are paired or unpaired. In general, the analysis takes the form of <span class="math inline">\(t=\frac{\mu_1 - \mu_2}{variance}\)</span>. It is recommended to check the distribution of the data by using histogram. For this exercise, we will use the simulated data from ECR trials. The grouping variable is the trial assignment.</p>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb535-1"><a href="statistics.html#cb535-1" tabindex="-1"></a><span class="co">#comparison of early neurological recovery (ENI) by tral (T)</span></span>
<span id="cb535-2"><a href="statistics.html#cb535-2" tabindex="-1"></a>dtTrial<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">&quot;./Data-Use/dtTrial_simulated.csv&quot;</span>)</span>
<span id="cb535-3"><a href="statistics.html#cb535-3" tabindex="-1"></a><span class="fu">t.test</span>(dtTrial<span class="sc">$</span>ENI<span class="sc">~</span>dtTrial<span class="sc">$</span>T)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  dtTrial$ENI by dtTrial$T
## t = 0.17454, df = 487.36, p-value = 0.8615
## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
## 95 percent confidence interval:
##  -0.04569535  0.05460540
## sample estimates:
## mean in group 0 mean in group 1 
##       0.3084644       0.3040094</code></pre>
</div>
<div id="non-parametric-tests" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Non-parametric tests<a href="statistics.html#non-parametric-tests" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Chi-squared and Fisher-exact tests can be done by using the <em>table</em> function for setting up the count data into 2 x 2 contingency table or confusion matrix. The formula for the Chi-squared test takes on a familiar form <span class="math inline">\(\chi^2=\frac{(observed-expected)^2}{expected}\)</span>. In this example we will use the data above.</p>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="statistics.html#cb537-1" tabindex="-1"></a><span class="fu">table</span>(dtTrial<span class="sc">$</span>HT,dtTrial<span class="sc">$</span>T)</span></code></pre></div>
<pre><code>##    
##       0   1
##   0 112 101
##   1 144 143</code></pre>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="statistics.html#cb539-1" tabindex="-1"></a><span class="fu">chisq.test</span>(dtTrial<span class="sc">$</span>HT,dtTrial<span class="sc">$</span>T)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  dtTrial$HT and dtTrial$T
## X-squared = 0.19553, df = 1, p-value = 0.6584</code></pre>
<p>The Wilcoxon rank sum test is performed with continuous data organised in the
same way as the t-test. There are several different approaches to performing Wilcoxon rank sum test. The <em>coin</em> package allows handling of ties.</p>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="statistics.html#cb541-1" tabindex="-1"></a><span class="fu">library</span>(coin)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;coin&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:scales&#39;:
## 
##     pvalue</code></pre>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="statistics.html#cb544-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(ENI<span class="sc">~</span>T, <span class="at">data=</span>dtTrial)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon rank sum test with continuity correction
## 
## data:  ENI by T
## W = 31159, p-value = 0.9642
## alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<div id="regression" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Regression<a href="statistics.html#regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are many different form of regression methods. A key principle is that the predictors are independent of each others. This issue will be expand on in the later in the section on collinearity. Special methods are required when the predictors are collinear.</p>
<div id="brief-review-of-matrix" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Brief review of matrix<a href="statistics.html#brief-review-of-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A vector is has length one. A matrix is an ordered array in 2 dimensions. A
tensor is an ordered array in 3 dimensions.</p>
<p>A matrix in which the columns are linearly related are said to be rank
deficient. The rank of a given matrix is an expression of the number of linearly independent columns of that matrix. Given that row rank and column rank are equivalent, rank deficiency of a matrix is expressed as the difference between
the lesser of the number of rows and columns, and the rank of the matrix.
A matrix with rank of 1 is likely to be linearly related.</p>
</div>
<div id="linear-least-square-regression" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Linear (least square) regression<a href="statistics.html#linear-least-square-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Least square regression uses the geometric properties of Euclidean geometry to identify the line of best. The sum of squares <span class="math inline">\(SSE\)</span> is <span class="math inline">\(\sum(observed-expected)^2\)</span>. The <span class="math inline">\(R^2\)</span> is a measure of the fit of the model. It
is given by <span class="math inline">\(1-\frac{SS_(res)}{SS_(total)}\)</span>. Low <span class="math inline">\(R^2\)</span> indicates a poorly fitted model and high <span class="math inline">\(R^2\)</span> indicates excellent fitting. The assumption here is that
the outcome variable is a continuous variable.</p>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="statistics.html#cb546-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb546-2"><a href="statistics.html#cb546-2" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;./Data-Use/world_stroke.Rda&quot;</span>)</span>
<span id="cb546-3"><a href="statistics.html#cb546-3" tabindex="-1"></a></span>
<span id="cb546-4"><a href="statistics.html#cb546-4" tabindex="-1"></a><span class="fu">ggplot</span>(world_sfdf, <span class="fu">aes</span>(<span class="at">x=</span>LifeExpectancy,<span class="at">y=</span>MeanLifetimeRisk))<span class="sc">+</span></span>
<span id="cb546-5"><a href="statistics.html#cb546-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="fu">aes</span>(<span class="at">Group=</span>Income, <span class="at">linetype=</span>Income))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&quot;Life Expectancy&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-3-1.png" width="672" /></p>
</div>
<div id="logistic-regression" class="section level3 hasAnchor" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Logistic regression<a href="statistics.html#logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For outcome that are binary in nature such as yes or no, then least square regression is not appropriate. There are no close form solution for this
analysis and a numerical approach using maximum likelihood approach is needed. When examining the results of logistic regression one is often enchanted by the large odds ratio. It is important to look at the metrics of model calibration
(discussed below). A clue to a poorly calibrated model is the observation that
the width of the confidence interval for odds ratio is wide.</p>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb548-1"><a href="statistics.html#cb548-1" tabindex="-1"></a><span class="co">#glm</span></span>
<span id="cb548-2"><a href="statistics.html#cb548-2" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;BreastCancer&quot;</span>,<span class="at">package =</span> <span class="st">&quot;mlbench&quot;</span>)</span>
<span id="cb548-3"><a href="statistics.html#cb548-3" tabindex="-1"></a></span>
<span id="cb548-4"><a href="statistics.html#cb548-4" tabindex="-1"></a><span class="co">#remove id column and column with NA to feed into iml later</span></span>
<span id="cb548-5"><a href="statistics.html#cb548-5" tabindex="-1"></a>BreastCancer2<span class="ot">&lt;-</span><span class="fu">lapply</span>(BreastCancer[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>)], as.numeric)</span>
<span id="cb548-6"><a href="statistics.html#cb548-6" tabindex="-1"></a>BreastCancer2<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(BreastCancer2)</span>
<span id="cb548-7"><a href="statistics.html#cb548-7" tabindex="-1"></a></span>
<span id="cb548-8"><a href="statistics.html#cb548-8" tabindex="-1"></a>DCa<span class="ot">&lt;-</span><span class="fu">glm</span>(Class<span class="sc">~</span>., <span class="at">data=</span>BreastCancer2)</span>
<span id="cb548-9"><a href="statistics.html#cb548-9" tabindex="-1"></a></span>
<span id="cb548-10"><a href="statistics.html#cb548-10" tabindex="-1"></a><span class="fu">summary</span>(DCa)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = Class ~ ., data = BreastCancer2)
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     0.723054   0.018613  38.847  &lt; 2e-16 ***
## Cl.thickness    0.042754   0.003992  10.709  &lt; 2e-16 ***
## Cell.size       0.019263   0.007293   2.641  0.00845 ** 
## Cell.shape      0.032217   0.007016   4.592 5.22e-06 ***
## Marg.adhesion   0.021463   0.004386   4.893 1.24e-06 ***
## Epith.c.size    0.011637   0.005965   1.951  0.05148 .  
## Bl.cromatin     0.035266   0.005650   6.241 7.57e-10 ***
## Normal.nucleoli 0.016928   0.004247   3.986 7.44e-05 ***
## Mitoses         0.001086   0.006048   0.180  0.85757    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for gaussian family taken to be 0.0481263)
## 
##     Null deviance: 157.908  on 698  degrees of freedom
## Residual deviance:  33.207  on 690  degrees of freedom
## AIC: -126.1
## 
## Number of Fisher Scoring iterations: 2</code></pre>
</div>
<div id="discrimination-and-calibration" class="section level3 hasAnchor" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> Discrimination and Calibration<a href="statistics.html#discrimination-and-calibration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A high _<span class="math inline">\(R^2\)</span> suggests that the linear regression model is well calibrated. This metric is often not displayed but should be sought when interpreting the data.</p>
<p>The areas under the receiver operating characteristic curve (AUC) is used to assess how well the models discriminate between those who have the disease and those who do not have the disease of interest. An AUC of 0.5 is classified as no better than by chance; 0.8 to 0.89 provides good (excellent) discrimination, and 0.9 to 1.0 provides outstanding discrimination. This rule of thumb about interpreting AUC when reading the literature is language the authors used to describe the AUC. This test of discrimination is not synonymous with calibration. It is possible to have a model with high discrimination but poor calibration <span class="citation">(<a href="#ref-pmid1738016">Diamond 1992</a>)</span>. The AUC is similar to Harrells c-index but the interpretation of difference in AUC and c-index between models is not straightforward. A difference in 0.1 of AUC correspond to the number of subject rank correctly. The c-index was originally described for survival analysis <span class="citation">(<a href="#ref-pmid7069920">Harrell FE Jr 1982</a>)</span>. Harrell described the c-index (concordance index) as estimating the probability that, of two randomly chosen patients, the patient with the higher prognostic score will outlive the patient with the lower prognostic score. As such the c-index should be interpreted as the number of concordant pairs relative to the total number of comparable pairs. It has been proposed that the AUC and c-index is not appropriate for survival analysis as they do not account for the dynamic nature of the data<span class="citation">(<a href="#ref-LONGATO2020103496">Longato, Vettoretti, and Di Camillo 2020</a>)</span>. The integrated Graf score has been proposed to account for difference in the estimated event-free survival probabilities with the actual outcome <span class="citation">(<a href="#ref-pmid10474158">Graf E 1999</a>)</span>.</p>
<p>Calibration of logistic regression model is performed using the HosmerLemeshow goodness-of-t test and the Nagelkerke generalized R2. A model is well
calibrated when the HosmerLemeshow goodness-of-t test shows no difference between observed and expected outcome or P value approaching 1. A high
generalized <span class="math inline">\(R^2\)</span> value suggests a well-calibrated regression model. Running regression through the <em>rms</em> or <em>PredictABEL</em> library provide these results. The generalized <span class="math inline">\(R^2\)</span> can be obtained manually from base R by running an intercept only model and again with covariates. It is given by <span class="math inline">\(1-\frac{L1}{L0}\)</span>.</p>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="statistics.html#cb550-1" tabindex="-1"></a><span class="co">#lrm on logistic regression analysis for Breast Cancer</span></span>
<span id="cb550-2"><a href="statistics.html#cb550-2" tabindex="-1"></a><span class="fu">library</span>(rms)</span></code></pre></div>
<pre><code>## Loading required package: Hmisc</code></pre>
<pre><code>## 
## Attaching package: &#39;Hmisc&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:RNiftyReg&#39;:
## 
##     translate</code></pre>
<pre><code>## The following object is masked from &#39;package:CHNOSZ&#39;:
## 
##     mtitle</code></pre>
<pre><code>## The following object is masked from &#39;package:plotly&#39;:
## 
##     subplot</code></pre>
<pre><code>## The following objects are masked from &#39;package:plyr&#39;:
## 
##     is.discrete, summarize</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     src, summarize</code></pre>
<pre><code>## The following object is masked from &#39;package:Biobase&#39;:
## 
##     contents</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     format.pval, units</code></pre>
<pre><code>## 
## Attaching package: &#39;rms&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:lomb&#39;:
## 
##     lsp</code></pre>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="statistics.html#cb562-1" tabindex="-1"></a>DCa_rms<span class="ot">&lt;-</span><span class="fu">lrm</span>(Class<span class="sc">~</span>., <span class="at">data=</span>BreastCancer2)</span>
<span id="cb562-2"><a href="statistics.html#cb562-2" tabindex="-1"></a>DCa_rms</span></code></pre></div>
<pre><code>## Logistic Regression Model
## 
## lrm(formula = Class ~ ., data = BreastCancer2)
## 
##                        Model Likelihood      Discrimination    Rank Discrim.    
##                              Ratio Test             Indexes          Indexes    
## Obs           699    LR chi2     759.86      R2       0.915    C       0.993    
##  1            458    d.f.             8      R2(8,699)0.659    Dxy     0.986    
##  2            241    Pr(&gt; chi2) &lt;0.0001    R2(8,473.7)0.795    gamma   0.986    
## max |deriv| 8e-10                            Brier    0.028    tau-a   0.446    
## 
##                 Coef    S.E.   Wald Z Pr(&gt;|Z|)
## Intercept       -9.9477 1.0317 -9.64  &lt;0.0001 
## Cl.thickness     0.5776 0.1190  4.85  &lt;0.0001 
## Cell.size       -0.0115 0.1759 -0.07  0.9479  
## Cell.shape       0.5679 0.1913  2.97  0.0030  
## Marg.adhesion    0.3137 0.1004  3.13  0.0018  
## Epith.c.size     0.1306 0.1406  0.93  0.3529  
## Bl.cromatin      0.5800 0.1456  3.98  &lt;0.0001 
## Normal.nucleoli  0.1232 0.0987  1.25  0.2120  
## Mitoses          0.6092 0.3226  1.89  0.0590</code></pre>
<div id="measuring-improvement-in-regression-models" class="section level4 hasAnchor" number="4.2.4.1">
<h4><span class="header-section-number">4.2.4.1</span> Measuring Improvement in Regression Models<a href="statistics.html#measuring-improvement-in-regression-models" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The net reclassification improvement (NRI) and integrated discrimination improvement (IDI) have been proposed as more sensitive metrics of improvement in model discrimination.The NRI can be considered as a percentage reclassication
for the risk categories and the IDI is the mean difference in predicted probabilities between 2 models (constructed from cases with disease and without disease). The NRI and IDI scores are expressed as fractions and can be converted to percentage by multiplying 100.The continuous NRI and IDI can be performed
using <em>PredictABEL</em> [<span class="citation">Phan et al. (<a href="#ref-pmid28579970">2017</a>)</span>]<span class="citation">(<a href="#ref-pmid26796056">Phan et al. 2016</a>)</span>.</p>
</div>
<div id="shapley-value" class="section level4 hasAnchor" number="4.2.4.2">
<h4><span class="header-section-number">4.2.4.2</span> Shapley value<a href="statistics.html#shapley-value" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We can use ideas from game theory relating to fair distribution of prot in coalition games; the coalition (co-operative) game in this case can be
interpreted as contribution of the covariates to the model. The Shapley value regression method calculates the marginal contribution of each covariate as the average of all permutations of the coalition of the covariates containing the covariate of interest minus the coalition without the covariate of interest. The advantage of this approach is that it can handle multicollinearity (relatedness) among the covariates.</p>
<p>The feature importance is used to assess the impact of the features on the
models decision</p>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb564-1"><a href="statistics.html#cb564-1" tabindex="-1"></a><span class="co">#this section takes the output from logistic regression above.</span></span>
<span id="cb564-2"><a href="statistics.html#cb564-2" tabindex="-1"></a><span class="fu">library</span>(iml)</span>
<span id="cb564-3"><a href="statistics.html#cb564-3" tabindex="-1"></a>X <span class="ot">=</span> BreastCancer2[<span class="fu">which</span>(<span class="fu">names</span>(BreastCancer2) <span class="sc">!=</span> <span class="st">&quot;Class&quot;</span>)]</span>
<span id="cb564-4"><a href="statistics.html#cb564-4" tabindex="-1"></a>predictor <span class="ot">=</span> Predictor<span class="sc">$</span><span class="fu">new</span>(DCa, <span class="at">data =</span> X, <span class="at">y =</span> BreastCancer2<span class="sc">$</span>Class)</span>
<span id="cb564-5"><a href="statistics.html#cb564-5" tabindex="-1"></a>imp <span class="ot">=</span> FeatureImp<span class="sc">$</span><span class="fu">new</span>(predictor, <span class="at">loss =</span> <span class="st">&quot;mae&quot;</span>)</span>
<span id="cb564-6"><a href="statistics.html#cb564-6" tabindex="-1"></a><span class="fu">plot</span>(imp)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-5-1.png" width="672" /></p>
<p>From the logistic regression above cell thickness and cromatin have the highest coefficient and lowest p value. This is the same as feature importance. By contrast the Shapley values show that cell shape and marg adhesion make the largest impact on the model when considering the contribution to the model after considering all the contribution by different coalitions.</p>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="statistics.html#cb565-1" tabindex="-1"></a><span class="co">#explain with game theory</span></span>
<span id="cb565-2"><a href="statistics.html#cb565-2" tabindex="-1"></a>shapley <span class="ot">&lt;-</span> Shapley<span class="sc">$</span><span class="fu">new</span>(predictor, <span class="at">x.interest =</span> X[<span class="dv">1</span>, ])</span>
<span id="cb565-3"><a href="statistics.html#cb565-3" tabindex="-1"></a>shapley<span class="sc">$</span><span class="fu">plot</span>()</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-5-1-1.png" width="672" /></p>
</div>
<div id="ice" class="section level4 hasAnchor" number="4.2.4.3">
<h4><span class="header-section-number">4.2.4.3</span> ICE<a href="statistics.html#ice" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The individual conditional expectation (ICE) curves is the plot of the
expectation fof the predictive value for each observation at the unique value
for the feature.</p>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb566-1"><a href="statistics.html#cb566-1" tabindex="-1"></a><span class="co">#feature is the covariate of interest</span></span>
<span id="cb566-2"><a href="statistics.html#cb566-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb566-3"><a href="statistics.html#cb566-3" tabindex="-1"></a>eff_thick <span class="ot">&lt;-</span> FeatureEffect<span class="sc">$</span><span class="fu">new</span>(predictor, </span>
<span id="cb566-4"><a href="statistics.html#cb566-4" tabindex="-1"></a>                         <span class="at">feature =</span> <span class="st">&quot;Cl.thickness&quot;</span>, </span>
<span id="cb566-5"><a href="statistics.html#cb566-5" tabindex="-1"></a>                         <span class="at">method =</span> <span class="st">&quot;ice&quot;</span>,</span>
<span id="cb566-6"><a href="statistics.html#cb566-6" tabindex="-1"></a>                         <span class="at">center.at =</span> <span class="dv">0</span>)</span>
<span id="cb566-7"><a href="statistics.html#cb566-7" tabindex="-1"></a></span>
<span id="cb566-8"><a href="statistics.html#cb566-8" tabindex="-1"></a><span class="fu">plot</span>(eff_thick)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-5-2-1.png" width="672" /></p>
</div>
</div>
<div id="interaction" class="section level3 hasAnchor" number="4.2.5">
<h3><span class="header-section-number">4.2.5</span> Interaction<a href="statistics.html#interaction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Interactions is plotted here using lollipop bar. The <em>ggalt</em> library can be used to create this type of plot with <em>geom_lollipop</em>. The strength of interaction is measured using Friedmans H-statistics. The H-statistics ranges from 0 to 1 with
1 indicating the overall interaction strength. In the case with Breast Cancer data, the interaction strength is low.</p>
<p>When describing interaction terms it is recommended that the results be
expressed as  coefficients rather than as odds ratio.</p>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb567-1"><a href="statistics.html#cb567-1" tabindex="-1"></a><span class="co">#plot interactions</span></span>
<span id="cb567-2"><a href="statistics.html#cb567-2" tabindex="-1"></a>interact <span class="ot">&lt;-</span> Interaction<span class="sc">$</span><span class="fu">new</span>(predictor)</span>
<span id="cb567-3"><a href="statistics.html#cb567-3" tabindex="-1"></a><span class="fu">plot</span>(interact)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-5-3-1.png" width="672" /></p>
</div>
</div>
<div id="confounder" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Confounder<a href="statistics.html#confounder" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A confounder is a covariate that serves as a cause of both exposure and outcome and as such confound the analysis. A mediator exist on the causal pathway from exposure to outcome. A common misconception is that the multiple regression adjust for imbalance in covariates in clinical trial. This issue was observed in the pivotal NINDS alteplase trial. The results of the trial has since been accepted with re-analysis of this trial using covariate adjustment <span class="citation">(<a href="#ref-pmid15345796">Ingall et al. 2004</a>)</span>.</p>
<p>There are several methods for covariate adjustment in radomised trials: direct adjustment, standardisation and inverse-probability-of-treatment weighting.</p>
<div id="confounder-weighted-model" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Confounder weighted model<a href="statistics.html#confounder-weighted-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The issue asked is whether one should choose to perform confounder analysis or propensity matching.</p>
</div>
<div id="propensity-matching" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Propensity matching<a href="statistics.html#propensity-matching" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Propensity matching is an important technique to adjust for imbalance in covariates between 2 arms. There are concerns with mis-use of this technique
such as difference in placebo arms from multiple sclerosis trials <span class="citation">(<a href="#ref-doi10.1001/jamaneurol.2020.0678">Signori et al. 2020</a>)</span>. It is proposed that this technique should be
used only if all the confounders are measurable. This situation may not be satisfied if the data were accrued at different period, in different continent etc.</p>
</div>
<div id="e-values" class="section level3 hasAnchor" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> E-values<a href="statistics.html#e-values" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The E-values <span class="citation">(<a href="#ref-pmid28693043">VanderWeele TJ 2017</a>)</span> has been proposed a measure of unmeasured confounders in observational studies. The E-value is a measure of the extent to which the confounder have on the treatmentoutcome association, conditional on the measured covariates. A large E-value is desirable. The E-values is available in <em>Evalue</em> library <span class="citation">(<a href="#ref-pmid29912013">Mathur MB 2018</a>)</span>.</p>
</div>
</div>
<div id="causal-inference" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Causal inference<a href="statistics.html#causal-inference" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Causation and association are often miscontrued to be the same. However, the finding of correlation (association) does necessarily imply causation. Causal inference evaluates the response of an effect variable in the setting of change in the cause of the effect variable. There are issues with approach to analysis of causal inference. It can be performed using frequentist such as confounder weighted model or Bayesian methods such as <a href="machine-learning.html#bayesian-trees-method">(Baysian additive regression tree)</a>.</p>
</div>
<div id="special-types-of-regression" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Special types of regression<a href="statistics.html#special-types-of-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="ordinal-regression" class="section level3 hasAnchor" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Ordinal regression<a href="statistics.html#ordinal-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Ordinal regression is appropriate when the outcome variable is in the form of ordered categorical values. For example, the Rankin scale of disability is
bounded between the values of 0 and 6. This type of analysis uses the
proportional odds model and the requirement for this model is stringent. When examining results of ordinal regression check that the authors provide this metric, the Brant test. The Brant test assesses the parallel regression assumption. Ordinal regression is performed using <em>polr</em> function in <em>MASS</em> library. The Brant test is available in the <em>Brant</em> library.</p>
</div>
<div id="survival-analysis" class="section level3 hasAnchor" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> Survival analysis<a href="statistics.html#survival-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Survival analysis is useful when dealing with time to event data. Time to event data can be left, interval and right censoring. Left censoring exists when events may have already occurred at the start of the study eg purchase of phones. Right censoring exists when events have not happened yet eg cancer trial. Interval censoring exists when an insurance has been purchased but the date of product purchase is not yet known.</p>
<p>The Cox model assesses the hazard of outcome between two groups. The assumption of this model is that the hazard between each arm is proportional <span class="citation">(<a href="#ref-pmid32167523">Stensrud and Hernan 2020</a>)</span>. The proportional hazard model can be tested based on the weighted Schoenfeld residuals<span class="citation">(<a href="#ref-10.1093/biomet/81.3.515">Grambsch and Therneau 1994</a>)</span>. There are non-parametric models available when the assumption of the proportional hazard model does not hold.</p>
<p>In the next chapter on machine learning, an illustration of <a href="machine-learning.html#random-survival-forest-with-rfsrc">random survival forest with <em>rfrsc</em> library</a> and <em>ranger</em> library are provided. In the section on [clinical trial][Interpreting clinical trials] we illustrate how the results can be converted to numbers needed to treat. The median survival corresponding to survival probability of 0.50 can be determined here. Metrics for assessing survival model was described <a href="statistics.html#discrimination-and-calibration">above</a>.</p>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="statistics.html#cb568-1" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb568-2"><a href="statistics.html#cb568-2" tabindex="-1"></a><span class="fu">library</span>(survminer)</span>
<span id="cb568-3"><a href="statistics.html#cb568-3" tabindex="-1"></a><span class="co">#data from survival package on NCCTG lung cancer trial</span></span>
<span id="cb568-4"><a href="statistics.html#cb568-4" tabindex="-1"></a><span class="co">#https://stat.ethz.ch/R-manual/R-devel/library/survival/html/lung.html</span></span>
<span id="cb568-5"><a href="statistics.html#cb568-5" tabindex="-1"></a><span class="fu">data</span>(cancer, <span class="at">package=</span><span class="st">&quot;survival&quot;</span>)</span>
<span id="cb568-6"><a href="statistics.html#cb568-6" tabindex="-1"></a></span>
<span id="cb568-7"><a href="statistics.html#cb568-7" tabindex="-1"></a><span class="co">#time in is available in days</span></span>
<span id="cb568-8"><a href="statistics.html#cb568-8" tabindex="-1"></a><span class="co">#status censored=1, dead=2</span></span>
<span id="cb568-9"><a href="statistics.html#cb568-9" tabindex="-1"></a><span class="co">#sex:Male=1 Female=2</span></span>
<span id="cb568-10"><a href="statistics.html#cb568-10" tabindex="-1"></a></span>
<span id="cb568-11"><a href="statistics.html#cb568-11" tabindex="-1"></a><span class="fu">survfit</span>(<span class="fu">Surv</span>(time, status) <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> cancer)</span></code></pre></div>
<pre><code>## Call: survfit(formula = Surv(time, status) ~ 1, data = cancer)
## 
##        n events median 0.95LCL 0.95UCL
## [1,] 228    165    310     285     363</code></pre>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="statistics.html#cb570-1" tabindex="-1"></a>sfit<span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(time, status) <span class="sc">~</span> age<span class="sc">+</span>sex<span class="sc">+</span>ph.ecog<span class="sc">+</span>ph.karno<span class="sc">+</span>wt.loss, <span class="at">data =</span> cancer)</span>
<span id="cb570-2"><a href="statistics.html#cb570-2" tabindex="-1"></a><span class="fu">summary</span>(sfit)</span></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(time, status) ~ age + sex + ph.ecog + ph.karno + 
##     wt.loss, data = cancer)
## 
##   n= 213, number of events= 151 
##    (15 observations deleted due to missingness)
## 
##               coef exp(coef)  se(coef)      z Pr(&gt;|z|)    
## age       0.015157  1.015273  0.009763  1.553 0.120538    
## sex      -0.631422  0.531835  0.177134 -3.565 0.000364 ***
## ph.ecog   0.740204  2.096364  0.191332  3.869 0.000109 ***
## ph.karno  0.015251  1.015368  0.009797  1.557 0.119553    
## wt.loss  -0.009298  0.990745  0.006699 -1.388 0.165168    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##          exp(coef) exp(-coef) lower .95 upper .95
## age         1.0153     0.9850    0.9960    1.0349
## sex         0.5318     1.8803    0.3758    0.7526
## ph.ecog     2.0964     0.4770    1.4408    3.0502
## ph.karno    1.0154     0.9849    0.9961    1.0351
## wt.loss     0.9907     1.0093    0.9778    1.0038
## 
## Concordance= 0.64  (se = 0.026 )
## Likelihood ratio test= 33.53  on 5 df,   p=3e-06
## Wald test            = 32.27  on 5 df,   p=5e-06
## Score (logrank) test = 32.83  on 5 df,   p=4e-06</code></pre>
<p>Test proportional hazard assumption using weighted residuals <span class="citation">(<a href="#ref-10.1093/biomet/81.3.515">Grambsch and Therneau 1994</a>)</span>. The finding below shows that inclusion of covariate ph.karno violate proportional hazard assumption.</p>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="statistics.html#cb572-1" tabindex="-1"></a><span class="fu">cox.zph</span>(sfit)</span></code></pre></div>
<pre><code>##          chisq df     p
## age      0.186  1 0.666
## sex      2.059  1 0.151
## ph.ecog  1.359  1 0.244
## ph.karno 4.916  1 0.027
## wt.loss  0.110  1 0.740
## GLOBAL   7.174  5 0.208</code></pre>
<p>Plot fit of survival model</p>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="statistics.html#cb574-1" tabindex="-1"></a><span class="fu">ggcoxdiagnostics</span>(sfit, <span class="at">type =</span> <span class="st">&quot;deviance&quot;</span>, </span>
<span id="cb574-2"><a href="statistics.html#cb574-2" tabindex="-1"></a> <span class="at">ox.scale =</span> <span class="st">&quot;linear.predictions&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: `gather_()` was deprecated in tidyr 1.2.0.
##  Please use `gather()` instead.
##  The deprecated feature was likely used in the survminer package.
##   Please report the issue at &lt;https://github.com/kassambara/survminer/issues&gt;.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</code></pre>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-6-3-1.png" width="672" /></p>
<p>Forest plot of outcome from survival analysis</p>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="statistics.html#cb577-1" tabindex="-1"></a><span class="fu">ggforest</span>(sfit)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-6-4-1.png" width="672" /></p>
<p>An alternative way to display the output from Cox regression is to use <em>forestmodel</em> library .</p>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb578-1"><a href="statistics.html#cb578-1" tabindex="-1"></a>forestmodel<span class="sc">::</span><span class="fu">forest_model</span>(sfit)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-6-5-1.png" width="672" /></p>
<p>The pseudoR2 for Cox regression model proposed by Royston can be evaluated</p>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb579-1"><a href="statistics.html#cb579-1" tabindex="-1"></a><span class="fu">royston</span>(sfit)</span></code></pre></div>
<pre><code>##         D     se(D)       R.D      R.KO       R.N      C.GH 
## 0.8546894 0.1495706 0.1484960 0.1515108 0.1459168 0.6418894</code></pre>
</div>
<div id="quantile-regression" class="section level3 hasAnchor" number="4.5.3">
<h3><span class="header-section-number">4.5.3</span> Quantile regression<a href="statistics.html#quantile-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Least spare regression is appropriate when the data is homoscedascity or the
error term remain constant. This can be seen as the data varies around the
fitted line. Homoscedascity implies that the data is homogenous. Quantile regression is appropriate when the distribution of the data is non-normal and it is more appropriate to look at the conditional median of the dependent variable. There are several libraries for this task <em>quantreg</em> and Bayesian libraries. In the example below, the life time risk of stroke is regressed against life expectancy using lest square and quantile regression.</p>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb581-1"><a href="statistics.html#cb581-1" tabindex="-1"></a><span class="fu">library</span>(quantreg)</span>
<span id="cb581-2"><a href="statistics.html#cb581-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb581-3"><a href="statistics.html#cb581-3" tabindex="-1"></a></span>
<span id="cb581-4"><a href="statistics.html#cb581-4" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;./Data-Use/world_stroke.Rda&quot;</span>)</span>
<span id="cb581-5"><a href="statistics.html#cb581-5" tabindex="-1"></a></span>
<span id="cb581-6"><a href="statistics.html#cb581-6" tabindex="-1"></a><span class="co">#quantile regression</span></span>
<span id="cb581-7"><a href="statistics.html#cb581-7" tabindex="-1"></a>rqfit <span class="ot">&lt;-</span> <span class="fu">rq</span>( MeanLifetimeRisk<span class="sc">~</span> LifeExpectancy, <span class="at">data =</span> world_sfdf)</span>
<span id="cb581-8"><a href="statistics.html#cb581-8" tabindex="-1"></a>rqfit_sum<span class="ot">&lt;-</span><span class="fu">summary</span>(rqfit)</span>
<span id="cb581-9"><a href="statistics.html#cb581-9" tabindex="-1"></a></span>
<span id="cb581-10"><a href="statistics.html#cb581-10" tabindex="-1"></a><span class="co">#least square regression</span></span>
<span id="cb581-11"><a href="statistics.html#cb581-11" tabindex="-1"></a>lsfit<span class="ot">&lt;-</span><span class="fu">lm</span>(MeanLifetimeRisk<span class="sc">~</span>LifeExpectancy,<span class="at">data=</span>world_sfdf)</span>
<span id="cb581-12"><a href="statistics.html#cb581-12" tabindex="-1"></a>lsfit_sum<span class="ot">&lt;-</span><span class="fu">summary</span>(lsfit) </span>
<span id="cb581-13"><a href="statistics.html#cb581-13" tabindex="-1"></a></span>
<span id="cb581-14"><a href="statistics.html#cb581-14" tabindex="-1"></a><span class="co">#plot</span></span>
<span id="cb581-15"><a href="statistics.html#cb581-15" tabindex="-1"></a><span class="fu">ggplot</span>(world_sfdf,  <span class="fu">aes</span>(<span class="at">x=</span>LifeExpectancy,<span class="at">y=</span>MeanLifetimeRisk))<span class="sc">+</span></span>
<span id="cb581-16"><a href="statistics.html#cb581-16" tabindex="-1"></a>  <span class="co">#add fitted line for least square</span></span>
<span id="cb581-17"><a href="statistics.html#cb581-17" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span>lsfit_sum<span class="sc">$</span>coefficients[<span class="dv">1</span>], <span class="at">slope=</span>lsfit_sum<span class="sc">$</span>coefficients[<span class="dv">2</span>],<span class="at">color=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb581-18"><a href="statistics.html#cb581-18" tabindex="-1"></a>  <span class="co">#add fitted line for quantile regression</span></span>
<span id="cb581-19"><a href="statistics.html#cb581-19" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&quot;Life Expectancy&quot;</span>)<span class="sc">+</span></span>
<span id="cb581-20"><a href="statistics.html#cb581-20" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span>rqfit_sum<span class="sc">$</span>coefficients[<span class="dv">1</span>], <span class="at">slope=</span>rqfit_sum<span class="sc">$</span>coefficients[<span class="dv">2</span>],<span class="at">color=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-7-1.png" width="672" /></p>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb582-1"><a href="statistics.html#cb582-1" tabindex="-1"></a><span class="co">#annotate least square and quantile at position x, y</span></span>
<span id="cb582-2"><a href="statistics.html#cb582-2" tabindex="-1"></a><span class="co">#annotate(&quot;text&quot;,x=60, y=27, label=paste0(&quot;least square =&quot;,                        round(lsfit_sum$coefficients[1],2) ,&quot;+&quot;, round(lsfit_sum$coefficients[2],2),&quot;x &quot;,&quot;Life Expectancy&quot;),color=&quot;red&quot;)+ annotate(&quot;text&quot;,x=75, y=12,label=paste0(&quot;quantile =&quot;,round(rqfit_sum$coefficients[1],2), &quot; + &quot;, round(rqfit_sum$coefficients[2],2),&quot; x &quot;,&quot;Life Expectancy&quot;),color=&quot;blue&quot;)</span></span></code></pre></div>
</div>
<div id="non-negative-regression" class="section level3 hasAnchor" number="4.5.4">
<h3><span class="header-section-number">4.5.4</span> Non-negative regression<a href="statistics.html#non-negative-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In certain situations, it is necessary to constrain the analysis so that the regression coefifcients are non-negative. For example, when regressing brain regions against infarct volume, there is no reason believe that a negative coefficient attributable to a brain region is possible<span class="citation">(<a href="#ref-pmid16504541">Phan, Donnan, Koga, et al. 2006</a>)</span> . Non-negative regression can be performed in R using <em>nnls</em>.</p>
</div>
<div id="poisson-regression" class="section level3 hasAnchor" number="4.5.5">
<h3><span class="header-section-number">4.5.5</span> Poisson regression<a href="statistics.html#poisson-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Poisson regression is used when dealing with number of event over time or
distance such as number of new admissions or new cases of hepatitis or TIA over time. An assumption of the Poisson distribution is that the mean &amp; lambda; and variance  are the same.</p>
<p>A special case of Poisson regression is the negative binomial regression. This latter method is used when the variance is greater than the mean pf the data or over-dispersed data. Negative binomial regression can be applied to number of failure event over time. Here failure has a lose definition and can be stroke recurrence after TIA or cirrhosis after hepatitis C infection.</p>
<p>Zero-inflated data occurs when there is an abundance of zeroes in the data (true and excess zeroes).</p>
</div>
<div id="conditional-logistic-regression" class="section level3 hasAnchor" number="4.5.6">
<h3><span class="header-section-number">4.5.6</span> Conditional logistic regression<a href="statistics.html#conditional-logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Conditional logistical regression model should be used when the aim is to
compare pair of objects from the same patient. Examples include left and right arms or left and right carotid arteries. This method is available from <em>clogit</em> in <em>survival</em>.</p>
</div>
<div id="multinomial-modelling" class="section level3 hasAnchor" number="4.5.7">
<h3><span class="header-section-number">4.5.7</span> Multinomial modelling<a href="statistics.html#multinomial-modelling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Multinomial modelling is used when the outcome categorical variables are not ordered. This situation can occur when analysis involves choice outcome (choices of fruit: apple, orange or pear). In this case, the log odds of each of the categorical outcomes are analysed as a linear combination of the predictor variables. The <em>nnet</em> library have functions for performing this analysis.</p>
</div>
</div>
<div id="sample-size-estimation" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Sample size estimation<a href="statistics.html#sample-size-estimation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Clinicians are often frustrated about sample size and power estimation for a study, grant or clinical trial. This aspect is scrutinised by ethics committee
and in peer review process for journals. Luckily, R provides several packages
for sample size amd power estimation: <em>pwr</em> library. Cohen has written reference textbook on this subject <span class="citation">(<a href="#ref-COHEN1977179">Cohen 1977</a>)</span>.</p>
<div id="proportion" class="section level3 hasAnchor" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> Proportion<a href="statistics.html#proportion" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb583"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb583-1"><a href="statistics.html#cb583-1" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb583-2"><a href="statistics.html#cb583-2" tabindex="-1"></a><span class="co">#ttest-d is effect size </span></span>
<span id="cb583-3"><a href="statistics.html#cb583-3" tabindex="-1"></a><span class="co">#d = )mean group1 -mean group2)/variance</span></span>
<span id="cb583-4"><a href="statistics.html#cb583-4" tabindex="-1"></a><span class="fu">pwr.t.test</span>(<span class="at">n=</span><span class="dv">300</span>,<span class="at">d=</span><span class="fl">0.2</span>,<span class="at">sig.level=</span>.<span class="dv">05</span>,<span class="at">alternative=</span><span class="st">&quot;greater&quot;</span>) </span></code></pre></div>
<pre><code>## 
##      Two-sample t test power calculation 
## 
##               n = 300
##               d = 0.2
##       sig.level = 0.05
##           power = 0.7886842
##     alternative = greater
## 
## NOTE: n is number in *each* group</code></pre>
<p>We provided an example below for generating power of clinical trial. Examples
are taken from a paper on sample size estimation for phase II trials <span class="citation">(<a href="#ref-pmid16931782">Phan, Donnan, Davis, et al. 2006</a>)</span>.</p>
<div class="sourceCode" id="cb585"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb585-1"><a href="statistics.html#cb585-1" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb585-2"><a href="statistics.html#cb585-2" tabindex="-1"></a><span class="co">#h is effect size. effect size of 0.5 is very large </span></span>
<span id="cb585-3"><a href="statistics.html#cb585-3" tabindex="-1"></a><span class="co">#sample size</span></span>
<span id="cb585-4"><a href="statistics.html#cb585-4" tabindex="-1"></a><span class="fu">pwr.2p.test</span>(<span class="at">h=</span><span class="fl">0.5</span>,<span class="at">n=</span><span class="dv">50</span>,<span class="at">sig.level=</span><span class="fl">0.05</span>,<span class="at">alternative=</span><span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<pre><code>## 
##      Difference of proportion power calculation for binomial distribution (arcsine transformation) 
## 
##               h = 0.5
##               n = 50
##       sig.level = 0.05
##           power = 0.705418
##     alternative = two.sided
## 
## NOTE: same sample sizes</code></pre>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb587-1"><a href="statistics.html#cb587-1" tabindex="-1"></a><span class="co">#medium effect size</span></span>
<span id="cb587-2"><a href="statistics.html#cb587-2" tabindex="-1"></a><span class="fu">pwr.2p.test</span>(<span class="at">h=</span><span class="fl">0.1</span>,<span class="at">n=</span><span class="dv">50</span>,<span class="at">sig.level=</span><span class="fl">0.05</span>,<span class="at">alternative=</span><span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<pre><code>## 
##      Difference of proportion power calculation for binomial distribution (arcsine transformation) 
## 
##               h = 0.1
##               n = 50
##       sig.level = 0.05
##           power = 0.07909753
##     alternative = two.sided
## 
## NOTE: same sample sizes</code></pre>
<p>The output of the sample size calculation can be put into a table or plot.</p>
<div class="sourceCode" id="cb589"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb589-1"><a href="statistics.html#cb589-1" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb589-2"><a href="statistics.html#cb589-2" tabindex="-1"></a><span class="co">#pwr.2p.test(h=0.3,n=80,sig.level=0.05,alternative=&quot;two.sided&quot;)</span></span>
<span id="cb589-3"><a href="statistics.html#cb589-3" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fu">seq</span>(.<span class="dv">1</span>,.<span class="dv">5</span>,.<span class="dv">1</span>) <span class="co">#from 0.1 to 0.3 by 0.05</span></span>
<span id="cb589-4"><a href="statistics.html#cb589-4" tabindex="-1"></a>nh <span class="ot">&lt;-</span> <span class="fu">length</span>(h) <span class="co">#5</span></span>
<span id="cb589-5"><a href="statistics.html#cb589-5" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">seq</span>(.<span class="dv">3</span>,.<span class="dv">9</span>,.<span class="dv">1</span>)<span class="co"># power from 0.5 to 0.9 by 0.1</span></span>
<span id="cb589-6"><a href="statistics.html#cb589-6" tabindex="-1"></a>np <span class="ot">&lt;-</span> <span class="fu">length</span>(p) <span class="co">#9</span></span>
<span id="cb589-7"><a href="statistics.html#cb589-7" tabindex="-1"></a><span class="co"># create an empty array 9 x 5</span></span>
<span id="cb589-8"><a href="statistics.html#cb589-8" tabindex="-1"></a>samplesize <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="fu">numeric</span>(nh<span class="sc">*</span>np), <span class="at">dim=</span><span class="fu">c</span>(nh,np))</span>
<span id="cb589-9"><a href="statistics.html#cb589-9" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>np){</span>
<span id="cb589-10"><a href="statistics.html#cb589-10" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nh){</span>
<span id="cb589-11"><a href="statistics.html#cb589-11" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">pwr.2p.test</span>(<span class="at">n =</span> <span class="cn">NULL</span>, <span class="at">h =</span> h[j],</span>
<span id="cb589-12"><a href="statistics.html#cb589-12" tabindex="-1"></a>    <span class="co">#result &lt;- pwr.r.test(n = NULL, h = h[j],</span></span>
<span id="cb589-13"><a href="statistics.html#cb589-13" tabindex="-1"></a>    <span class="at">sig.level =</span> .<span class="dv">05</span>, <span class="at">power =</span> p[i],</span>
<span id="cb589-14"><a href="statistics.html#cb589-14" tabindex="-1"></a>    <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb589-15"><a href="statistics.html#cb589-15" tabindex="-1"></a>    samplesize[j,i] <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(result<span class="sc">$</span>n)</span>
<span id="cb589-16"><a href="statistics.html#cb589-16" tabindex="-1"></a>  }</span>
<span id="cb589-17"><a href="statistics.html#cb589-17" tabindex="-1"></a>}</span>
<span id="cb589-18"><a href="statistics.html#cb589-18" tabindex="-1"></a>samplesize</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]
## [1,]  412  583  769  980 1235 1570 2102
## [2,]  103  146  193  245  309  393  526
## [3,]   46   65   86  109  138  175  234
## [4,]   26   37   49   62   78   99  132
## [5,]   17   24   31   40   50   63   85</code></pre>
<div class="sourceCode" id="cb591"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb591-1"><a href="statistics.html#cb591-1" tabindex="-1"></a><span class="co">#graph</span></span>
<span id="cb591-2"><a href="statistics.html#cb591-2" tabindex="-1"></a>xrange <span class="ot">&lt;-</span> <span class="fu">range</span>(h)</span>
<span id="cb591-3"><a href="statistics.html#cb591-3" tabindex="-1"></a>yrange <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">range</span>(samplesize))</span>
<span id="cb591-4"><a href="statistics.html#cb591-4" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(<span class="fu">length</span>(p))</span>
<span id="cb591-5"><a href="statistics.html#cb591-5" tabindex="-1"></a><span class="fu">plot</span>(xrange, yrange, <span class="at">type=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb591-6"><a href="statistics.html#cb591-6" tabindex="-1"></a>  <span class="at">xlab=</span><span class="st">&quot;Effect size (h)&quot;</span>,</span>
<span id="cb591-7"><a href="statistics.html#cb591-7" tabindex="-1"></a>  <span class="at">ylab=</span><span class="st">&quot;Sample Size (n)&quot;</span> )</span>
<span id="cb591-8"><a href="statistics.html#cb591-8" tabindex="-1"></a><span class="co"># add power curves</span></span>
<span id="cb591-9"><a href="statistics.html#cb591-9" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>np){</span>
<span id="cb591-10"><a href="statistics.html#cb591-10" tabindex="-1"></a>  <span class="fu">lines</span>(h, samplesize[,i], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span>colors[i])</span>
<span id="cb591-11"><a href="statistics.html#cb591-11" tabindex="-1"></a>}</span>
<span id="cb591-12"><a href="statistics.html#cb591-12" tabindex="-1"></a><span class="co"># add annotation (grid lines, title, legend) </span></span>
<span id="cb591-13"><a href="statistics.html#cb591-13" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>, <span class="at">h=</span><span class="fu">seq</span>(<span class="dv">0</span>,yrange[<span class="dv">2</span>],<span class="dv">50</span>), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;grey89&quot;</span>)</span>
<span id="cb591-14"><a href="statistics.html#cb591-14" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">v=</span><span class="fu">seq</span>(xrange[<span class="dv">1</span>],xrange[<span class="dv">2</span>],.<span class="dv">02</span>), <span class="at">lty=</span><span class="dv">2</span>,</span>
<span id="cb591-15"><a href="statistics.html#cb591-15" tabindex="-1"></a>   <span class="at">col=</span><span class="st">&quot;grey89&quot;</span>)</span>
<span id="cb591-16"><a href="statistics.html#cb591-16" tabindex="-1"></a><span class="fu">title</span>(<span class="st">&quot;Sample Size Estimation</span><span class="sc">\n</span><span class="st"> Difference in Proportion&quot;</span>)</span>
<span id="cb591-17"><a href="statistics.html#cb591-17" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">title=</span><span class="st">&quot;Power&quot;</span>, <span class="fu">as.character</span>(p),</span>
<span id="cb591-18"><a href="statistics.html#cb591-18" tabindex="-1"></a>   <span class="at">fill=</span>colors)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-10-1.png" width="672" /></p>
<div id="non-inferiority" class="section level4 hasAnchor" number="4.6.1.1">
<h4><span class="header-section-number">4.6.1.1</span> Non-inferiority<a href="statistics.html#non-inferiority" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Non-inferiority trials may offer information in a way that a traditional superiority design do not. The design may be interested in other aspect of the treatment such as cost and lower toxicity <span class="citation">(<a href="#ref-pmid26080342">Kaji and Lewis 2015</a>)</span>. Examples of non-inferiority trial designs include antibiotics versus surgery for
appendicitis <span class="citation">(<a href="#ref-pmid26080338">Salminen et al. 2015</a>)</span>. There are concerns with reporting of
noninferiority trial. Justification for the margin provided in 27.6% <span class="citation">(<a href="#ref-pmid25781447">Gopal et al. 2015</a>)</span>. The following describes a trial design where its expected that drug will result in a certain outcome <em>p1</em> and the control arm <em>p2</em> and the
ratio of subject in treatment to control arm is <em>k</em>. The difference in outcome
is <em>delta</em>. The margin is defined as non-inferior if &lt;0.</p>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb592-1"><a href="statistics.html#cb592-1" tabindex="-1"></a><span class="fu">library</span>(TrialSize)</span>
<span id="cb592-2"><a href="statistics.html#cb592-2" tabindex="-1"></a><span class="fu">TwoSampleProportion.NIS</span>(<span class="at">alpha=</span>.<span class="dv">05</span>, </span>
<span id="cb592-3"><a href="statistics.html#cb592-3" tabindex="-1"></a>                        <span class="at">beta=</span>.<span class="dv">8</span>,</span>
<span id="cb592-4"><a href="statistics.html#cb592-4" tabindex="-1"></a>                        <span class="at">p1=</span>.<span class="dv">6</span>,</span>
<span id="cb592-5"><a href="statistics.html#cb592-5" tabindex="-1"></a>                        <span class="at">p2=</span>.<span class="dv">7</span>,</span>
<span id="cb592-6"><a href="statistics.html#cb592-6" tabindex="-1"></a>                        <span class="at">k=</span><span class="dv">1</span>,</span>
<span id="cb592-7"><a href="statistics.html#cb592-7" tabindex="-1"></a>                        <span class="at">delta =</span> .<span class="dv">1</span>,       </span>
<span id="cb592-8"><a href="statistics.html#cb592-8" tabindex="-1"></a>                        <span class="at">margin=</span><span class="sc">-</span>.<span class="dv">2</span></span>
<span id="cb592-9"><a href="statistics.html#cb592-9" tabindex="-1"></a>                        )</span></code></pre></div>
<pre><code>## [1] 3.225911</code></pre>
</div>
</div>
<div id="logistic-regression-1" class="section level3 hasAnchor" number="4.6.2">
<h3><span class="header-section-number">4.6.2</span> Logistic regression<a href="statistics.html#logistic-regression-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb594"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb594-1"><a href="statistics.html#cb594-1" tabindex="-1"></a><span class="fu">library</span>(powerMediation)</span>
<span id="cb594-2"><a href="statistics.html#cb594-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb594-3"><a href="statistics.html#cb594-3" tabindex="-1"></a></span>
<span id="cb594-4"><a href="statistics.html#cb594-4" tabindex="-1"></a><span class="co">#continuous predictor</span></span>
<span id="cb594-5"><a href="statistics.html#cb594-5" tabindex="-1"></a><span class="co">#p1=event rate</span></span>
<span id="cb594-6"><a href="statistics.html#cb594-6" tabindex="-1"></a><span class="co">#exp(0.405) =1.5</span></span>
<span id="cb594-7"><a href="statistics.html#cb594-7" tabindex="-1"></a></span>
<span id="cb594-8"><a href="statistics.html#cb594-8" tabindex="-1"></a><span class="fu">powerLogisticCon</span>(<span class="at">n=</span><span class="dv">200</span>, <span class="at">p1=</span><span class="fl">0.265</span>, <span class="at">OR=</span><span class="fu">exp</span>(<span class="fl">0.014</span>), <span class="at">alpha=</span><span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 0.03056289</code></pre>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb596-1"><a href="statistics.html#cb596-1" tabindex="-1"></a><span class="co"># creating a data frame using data from </span></span>
<span id="cb596-2"><a href="statistics.html#cb596-2" tabindex="-1"></a>a<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">05.4</span>,<span class="fl">0.05</span>)</span>
<span id="cb596-3"><a href="statistics.html#cb596-3" tabindex="-1"></a>df_power<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="st">`</span><span class="at">ASPECTS</span><span class="st">`</span><span class="ot">=</span> a,</span>
<span id="cb596-4"><a href="statistics.html#cb596-4" tabindex="-1"></a><span class="st">&quot;Power&quot;</span><span class="ot">=</span><span class="fu">powerLogisticCon</span>(<span class="at">n=</span><span class="dv">100</span>, <span class="at">p1=</span>a, <span class="at">OR=</span><span class="fu">exp</span>(.<span class="dv">695</span>), <span class="at">alpha=</span><span class="fl">0.05</span>)</span>
<span id="cb596-5"><a href="statistics.html#cb596-5" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Warning in sqrt(n * beta.star^2 * p1 * (1 - p1)): NaNs produced</code></pre>
<div class="sourceCode" id="cb598"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb598-1"><a href="statistics.html#cb598-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>df_power, <span class="fu">aes</span>(<span class="at">x=</span>ASPECTS, <span class="at">y=</span>Power))<span class="sc">+</span><span class="fu">geom_point</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 88 rows containing missing values (`geom_point()`).</code></pre>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-12-1.png" width="672" /></p>
<p>An alternative library to perform sample size for logistic regression is <em>WebPower</em> library.</p>
<div class="sourceCode" id="cb600"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb600-1"><a href="statistics.html#cb600-1" tabindex="-1"></a><span class="fu">library</span>(WebPower) </span></code></pre></div>
<pre><code>## Loading required package: lme4</code></pre>
<pre><code>## 
## Attaching package: &#39;lme4&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:raster&#39;:
## 
##     getData</code></pre>
<pre><code>## The following object is masked from &#39;package:nlme&#39;:
## 
##     lmList</code></pre>
<pre><code>## The following object is masked from &#39;package:modeltools&#39;:
## 
##     refit</code></pre>
<pre><code>## The following object is masked from &#39;package:generics&#39;:
## 
##     refit</code></pre>
<pre><code>## The following object is masked from &#39;package:MatrixModels&#39;:
## 
##     mkRespMod</code></pre>
<pre><code>## Loading required package: lavaan</code></pre>
<pre><code>## This is lavaan 0.6-15
## lavaan is FREE software! Please report any bugs.</code></pre>
<pre><code>## 
## Attaching package: &#39;lavaan&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:TTR&#39;:
## 
##     growth</code></pre>
<pre><code>## The following object is masked from &#39;package:tm&#39;:
## 
##     inspect</code></pre>
<pre><code>## Loading required package: PearsonDS</code></pre>
<div class="sourceCode" id="cb614"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb614-1"><a href="statistics.html#cb614-1" tabindex="-1"></a><span class="fu">wp.logistic</span>(<span class="at">p0=</span><span class="fl">0.007</span>, <span class="co">#Prob (Y=1|X=0) </span></span>
<span id="cb614-2"><a href="statistics.html#cb614-2" tabindex="-1"></a>            <span class="at">p1=</span><span class="fl">0.012</span>, <span class="co">#Prob (Y=1|X=1)</span></span>
<span id="cb614-3"><a href="statistics.html#cb614-3" tabindex="-1"></a>            <span class="at">alpha=</span><span class="fl">0.05</span>, </span>
<span id="cb614-4"><a href="statistics.html#cb614-4" tabindex="-1"></a>            <span class="at">power=</span><span class="fl">0.80</span>, </span>
<span id="cb614-5"><a href="statistics.html#cb614-5" tabindex="-1"></a>            <span class="at">alternative=</span><span class="st">&quot;two.sided&quot;</span>, </span>
<span id="cb614-6"><a href="statistics.html#cb614-6" tabindex="-1"></a>            <span class="at">family=</span><span class="st">&quot;normal&quot;</span>)</span></code></pre></div>
<pre><code>## Power for logistic regression
## 
##        p0    p1     beta0     beta1      n alpha power
##     0.007 0.012 -4.954821 0.5440445 3336.2  0.05   0.8
## 
## URL: http://psychstat.org/logistic</code></pre>
</div>
<div id="survival-studies" class="section level3 hasAnchor" number="4.6.3">
<h3><span class="header-section-number">4.6.3</span> Survival studies<a href="statistics.html#survival-studies" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Sample size for survival studies can be performed using <em>powerSurvEpi</em> or <em>gsDesign</em>.</p>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb616-1"><a href="statistics.html#cb616-1" tabindex="-1"></a><span class="fu">library</span>(powerSurvEpi)</span>
<span id="cb616-2"><a href="statistics.html#cb616-2" tabindex="-1"></a></span>
<span id="cb616-3"><a href="statistics.html#cb616-3" tabindex="-1"></a><span class="co">#sample size</span></span>
<span id="cb616-4"><a href="statistics.html#cb616-4" tabindex="-1"></a><span class="fu">ssizeEpi.default</span>(<span class="at">power =</span> <span class="fl">0.80</span>, </span>
<span id="cb616-5"><a href="statistics.html#cb616-5" tabindex="-1"></a>                 <span class="at">theta =</span> <span class="dv">2</span>, </span>
<span id="cb616-6"><a href="statistics.html#cb616-6" tabindex="-1"></a>                 <span class="at">p =</span> <span class="fl">0.408</span> , </span>
<span id="cb616-7"><a href="statistics.html#cb616-7" tabindex="-1"></a>                 <span class="at">psi =</span> <span class="fl">0.15</span>,</span>
<span id="cb616-8"><a href="statistics.html#cb616-8" tabindex="-1"></a>                 <span class="at">rho2 =</span> <span class="fl">0.344</span><span class="sc">^</span><span class="dv">2</span>, </span>
<span id="cb616-9"><a href="statistics.html#cb616-9" tabindex="-1"></a>                 <span class="at">alpha =</span> <span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 512</code></pre>
<div class="sourceCode" id="cb618"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb618-1"><a href="statistics.html#cb618-1" tabindex="-1"></a><span class="co">#power</span></span>
<span id="cb618-2"><a href="statistics.html#cb618-2" tabindex="-1"></a><span class="fu">powerEpi.default</span>(<span class="at">n =</span> <span class="dv">2691</span>, </span>
<span id="cb618-3"><a href="statistics.html#cb618-3" tabindex="-1"></a>                 <span class="at">theta =</span> <span class="dv">2</span>, </span>
<span id="cb618-4"><a href="statistics.html#cb618-4" tabindex="-1"></a>                 <span class="at">p =</span> <span class="fl">0.408</span>, </span>
<span id="cb618-5"><a href="statistics.html#cb618-5" tabindex="-1"></a>                 <span class="at">psi =</span> <span class="fl">0.250</span>,</span>
<span id="cb618-6"><a href="statistics.html#cb618-6" tabindex="-1"></a>                 <span class="at">rho2 =</span> <span class="fl">0.344</span><span class="sc">^</span><span class="dv">2</span>, </span>
<span id="cb618-7"><a href="statistics.html#cb618-7" tabindex="-1"></a>                 <span class="at">alpha =</span> <span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb620-1"><a href="statistics.html#cb620-1" tabindex="-1"></a><span class="co">#Amarenco NEJM 2020 #equal sample size k=1</span></span>
<span id="cb620-2"><a href="statistics.html#cb620-2" tabindex="-1"></a><span class="fu">ssizeCT.default</span>(<span class="at">power =</span> <span class="fl">0.8</span>, <span class="at">k =</span> .<span class="dv">8</span>, <span class="at">pE =</span> <span class="fl">0.085</span>, </span>
<span id="cb620-3"><a href="statistics.html#cb620-3" tabindex="-1"></a>                <span class="at">pC =</span> <span class="fl">0.109</span>, </span>
<span id="cb620-4"><a href="statistics.html#cb620-4" tabindex="-1"></a>                <span class="at">RR =</span> <span class="fl">0.78</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>##   nE   nC 
## 2417 3021</code></pre>
</div>
<div id="multiple-regression" class="section level3 hasAnchor" number="4.6.4">
<h3><span class="header-section-number">4.6.4</span> Multiple regression<a href="statistics.html#multiple-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The power for general linear model can be calculated using the <em>pwr.f2.test</em> function.</p>
<div class="sourceCode" id="cb622"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb622-1"><a href="statistics.html#cb622-1" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb622-2"><a href="statistics.html#cb622-2" tabindex="-1"></a><span class="co">#u=degrees of freedom for numerator</span></span>
<span id="cb622-3"><a href="statistics.html#cb622-3" tabindex="-1"></a><span class="co">#v=degrees of freedomfor denominator</span></span>
<span id="cb622-4"><a href="statistics.html#cb622-4" tabindex="-1"></a><span class="co">#f2=effect size</span></span></code></pre></div>
</div>
</div>
<div id="randomised-clinical-trials" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> Randomised clinical trials<a href="statistics.html#randomised-clinical-trials" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A common misconception is that the multiple regression adjust for imbalance in covariates in clinical trial. This issue was observed in the pivotal NINDS alteplase trial. The results of the trial has since been accepted with re-analysis of this trial using covariate adjustment<span class="citation">(<a href="#ref-pmid15345796">Ingall et al. 2004</a>)</span>. There are several methods for covariate adjustment in radomised trials: direct adjustment, standardisation and inverse-probability-of-treatment weighting.</p>
<div id="covariate-adjustment-in-trials" class="section level3 hasAnchor" number="4.7.1">
<h3><span class="header-section-number">4.7.1</span> Covariate adjustment in trials<a href="statistics.html#covariate-adjustment-in-trials" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Specifically, covariate adjustment refers to adjustment of covariates available at the time of randomisation, i.e.prespecified variables and not variables after randomisation such as pneumonia post stroke trials. The advantage of covariate adjustment is that it results in narrower confidence interval as well as increase the power of the trial up to 7% <span class="citation">(<a href="#ref-10.1186/1745-6215-15-139">Kahan 2014</a>)</span>. The increased power is highest when prognostic variables are used but can decrease power when non-prognostic variables are used <span class="citation">(<a href="#ref-10.1186/1745-6215-15-139">Kahan 2014</a>)</span>.</p>
</div>
<div id="subgroup-analysis" class="section level3 hasAnchor" number="4.7.2">
<h3><span class="header-section-number">4.7.2</span> Subgroup analysis<a href="statistics.html#subgroup-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Subgroup analysis can be misleading especially if not specified prior to trial analysis <span class="citation">(<a href="#ref-doi:10.1056/NEJMsr077003">Wang et al. 2007</a>)</span>. Furthermore, increasing the number of subgroup analysis will lead to increasing the chance of false positive result or multiplicity. It is important to differentiate between prespecified and posthoc analyses as posthoc analyses may be biased by examination of the data.</p>
</div>
<div id="p-value-for-interaction" class="section level3 hasAnchor" number="4.7.3">
<h3><span class="header-section-number">4.7.3</span> p value for interaction<a href="statistics.html#p-value-for-interaction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The p value for interaction describe the influence by a baseline variable treatment effect on outcome in clinical trial <span class="citation">(<a href="#ref-doi:10.1056/NEJMsr077003">Wang et al. 2007</a>)</span>. In a hypothetical trial, a significant p value for interaction between males and females for treatment effect on primary outcome indicates heterogenity of treatment effect.</p>
<div class="sourceCode" id="cb623"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb623-1"><a href="statistics.html#cb623-1" tabindex="-1"></a><span class="fu">library</span>(Publish)</span></code></pre></div>
<pre><code>## Warning: package &#39;Publish&#39; was built under R version 4.3.2</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;Publish&#39;:
##   method   from
##   print.ci coin</code></pre>
<div class="sourceCode" id="cb626"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb626-1"><a href="statistics.html#cb626-1" tabindex="-1"></a><span class="fu">library</span>(survival)</span></code></pre></div>
</div>
<div id="interpreting-risk-reduction-in-clinical-trials" class="section level3 hasAnchor" number="4.7.4">
<h3><span class="header-section-number">4.7.4</span> Interpreting risk reduction in clinical trials<a href="statistics.html#interpreting-risk-reduction-in-clinical-trials" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A key issue in interpreting of clinical trials occurs when the relative risk
reduction or relative hazard risk are provided. This issue affect the clinical interpretation of the trial finding and its application in practice. An example is the result of the ACAS asymptomatic carotid artery trial is often quoted as showing 50% risk reduction. In fact, there was 2% annual risk of ipsilateral stroke in the medical and 1% risk in the surgical arm. The absolute risk reduction or ARR was 1% per year. However, the 50% relative risk reduction is often quoted to explain to patients.</p>
</div>
<div id="nnt-from-arr" class="section level3 hasAnchor" number="4.7.5">
<h3><span class="header-section-number">4.7.5</span> NNT from ARR<a href="statistics.html#nnt-from-arr" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this case, the number needed to treat (NNT) is given by <span class="math inline">\(\frac{1}{ARR}\)</span> or <span class="math inline">\(\frac{1}{0.01}=100\)</span> to achieve the trial outcome or 100 patients are needed to be treated to reduce the stroke risk to 1%. The recommendation is that the 95% confidence interval for NNT should be provided.</p>
</div>
<div id="nnt-from-odds-ratio" class="section level3 hasAnchor" number="4.7.6">
<h3><span class="header-section-number">4.7.6</span> NNT from odds ratio<a href="statistics.html#nnt-from-odds-ratio" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Calculation of NNT for odds ratio requires knowledge of the outcome of the placebo group. The NNT is given by <span class="math inline">\(\frac{1}{ACR-\frac{OR*ACR}{1-(ACR+OR*ACR)}}\)</span>. The ACR represents the assumed control risk. The NNT can be calculated from <em>nnt</em> function in <em>meta</em> library.</p>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb627-1"><a href="statistics.html#cb627-1" tabindex="-1"></a><span class="fu">library</span>(meta)</span></code></pre></div>
<pre><code>## Warning: package &#39;meta&#39; was built under R version 4.3.2</code></pre>
<pre><code>## Loading &#39;meta&#39; package (version 7.0-0).
## Type &#39;help(meta)&#39; for a brief overview.
## Readers of &#39;Meta-Analysis with R (Use R!)&#39; should install
## older version of &#39;meta&#39; package: https://tinyurl.com/dt4y5drs</code></pre>
<pre><code>## 
## Attaching package: &#39;meta&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:survMisc&#39;:
## 
##     ci</code></pre>
<pre><code>## The following object is masked from &#39;package:mixmeta&#39;:
## 
##     blup</code></pre>
<pre><code>## The following object is masked from &#39;package:pROC&#39;:
## 
##     ci</code></pre>
<pre><code>## The following object is masked from &#39;package:sp&#39;:
## 
##     bubble</code></pre>
<pre><code>## The following object is masked from &#39;package:mada&#39;:
## 
##     forest</code></pre>
<pre><code>## The following object is masked from &#39;package:mvmeta&#39;:
## 
##     blup</code></pre>
<div class="sourceCode" id="cb637"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb637-1"><a href="statistics.html#cb637-1" tabindex="-1"></a><span class="co">#p.c = baseline risk</span></span>
<span id="cb637-2"><a href="statistics.html#cb637-2" tabindex="-1"></a><span class="fu">nnt</span>(<span class="fl">0.73</span>, <span class="at">p.c =</span> <span class="fl">0.3</span>, <span class="at">sm =</span> <span class="st">&quot;OR&quot;</span>)</span></code></pre></div>
<pre><code>##     OR p.c      NNT
## 1 0.73 0.3 16.20811</code></pre>
</div>
<div id="nnt-from-risk-ratio" class="section level3 hasAnchor" number="4.7.7">
<h3><span class="header-section-number">4.7.7</span> NNT from risk ratio<a href="statistics.html#nnt-from-risk-ratio" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb639"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb639-1"><a href="statistics.html#cb639-1" tabindex="-1"></a><span class="co">#data from EXTEND-IV trial in NEJM 2019</span></span>
<span id="cb639-2"><a href="statistics.html#cb639-2" tabindex="-1"></a><span class="co">#outcome 35.4% in tpa and 29.5% in control</span></span>
<span id="cb639-3"><a href="statistics.html#cb639-3" tabindex="-1"></a><span class="fu">nnt</span>(<span class="fl">1.44</span>, <span class="at">p.c =</span> <span class="fl">0.295</span>, <span class="at">sm =</span> <span class="st">&quot;RR&quot;</span>)</span></code></pre></div>
<pre><code>##     RR   p.c      NNT
## 1 1.44 0.295 -7.70416</code></pre>
</div>
<div id="nnt-from-hazard-ratio" class="section level3 hasAnchor" number="4.7.8">
<h3><span class="header-section-number">4.7.8</span> NNT from hazard ratio<a href="statistics.html#nnt-from-hazard-ratio" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Calculation of NNT for hazard ratio requires knowledge of the outcome of the placebo group and the hazard ratio or <em>HR</em>. The formula using the binomial theorem is <span class="math inline">\(p=1-q\)</span> where q is given by the ratio of outcome and numbers recruited in the placebo group. The formula is taken from <span class="citation">(<a href="#ref-pmid32404155">Ludwig, Darmon, and Guerci 2020</a>)</span> . The NNT is given
<span class="math inline">\(\frac{1}{[p^{HR}-p}\)</span> . We illustrated this using data from metaanalysis on aspirin use in stroke in Lancet 2016. There were 45 events among 16053 patients
in the control group. The HR was 0.44. The NNT from this formula <span class="math inline">\(\frac{1}{.9971968^.44-.9971968}\)</span> was 637.</p>
</div>
<div id="nnt-from-metaananlysis" class="section level3 hasAnchor" number="4.7.9">
<h3><span class="header-section-number">4.7.9</span> NNT from metaananlysis<a href="statistics.html#nnt-from-metaananlysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are concerns with using NNT from the results of metaanalysis as the findings are amalgations of trials with different settings <span class="citation">(<a href="#ref-pmid12614141">Marx 2003</a>)</span> <span class="citation">(<a href="#ref-pmid10356018">Smeeth 1999</a>)</span>. The caution applies when baseline risks or absolute risk differences vary across trials.</p>
</div>
</div>
<div id="diagnostic-test" class="section level2 hasAnchor" number="4.8">
<h2><span class="header-section-number">4.8</span> Diagnostic test<a href="statistics.html#diagnostic-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="sensitivity-specificity" class="section level3 hasAnchor" number="4.8.1">
<h3><span class="header-section-number">4.8.1</span> Sensitivity, specificity<a href="statistics.html#sensitivity-specificity" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The sensitivity of a diagnostic test is the true positive rate and the specificity is the true negative rate. Example of 2 x 2 table is provided here. As an exercise, consider a paper about a diagnostic test for peripheral vertigo reporting 100% sensitivity and 94.4% specificity. There are 114 patients, 72 patients without stroke have vertigo and positive test findings. Among patients with stroke 7 of 42 have positive test findings. The sensitivity is <span class="math inline">\(TP=\frac{TP}{TP+FN}\)</span> and the specificity is the <span class="math inline">\(TN=\frac{TN}{TN+FP}\)</span>.</p>
<div class="sourceCode" id="cb641"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb641-1"><a href="statistics.html#cb641-1" tabindex="-1"></a><span class="co">#              Peripheral Vertigo</span></span>
<span id="cb641-2"><a href="statistics.html#cb641-2" tabindex="-1"></a><span class="co">#            Disease Positive     Disease Negative</span></span>
<span id="cb641-3"><a href="statistics.html#cb641-3" tabindex="-1"></a><span class="co">#$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$</span></span>
<span id="cb641-4"><a href="statistics.html#cb641-4" tabindex="-1"></a><span class="co"># HIT Test#                 #                      $</span></span>
<span id="cb641-5"><a href="statistics.html#cb641-5" tabindex="-1"></a><span class="co"># Positive# True Positive   # False Positive       $  </span></span>
<span id="cb641-6"><a href="statistics.html#cb641-6" tabindex="-1"></a><span class="co">#         #     72          #       7              $</span></span>
<span id="cb641-7"><a href="statistics.html#cb641-7" tabindex="-1"></a><span class="co">#$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$</span></span>
<span id="cb641-8"><a href="statistics.html#cb641-8" tabindex="-1"></a><span class="co"># HIT Test#                 #                      $</span></span>
<span id="cb641-9"><a href="statistics.html#cb641-9" tabindex="-1"></a><span class="co"># Negative# False Negative  # True Negative        $</span></span>
<span id="cb641-10"><a href="statistics.html#cb641-10" tabindex="-1"></a><span class="co">#         #     0           #       35             $ </span></span>
<span id="cb641-11"><a href="statistics.html#cb641-11" tabindex="-1"></a><span class="co">#$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$</span></span>
<span id="cb641-12"><a href="statistics.html#cb641-12" tabindex="-1"></a></span>
<span id="cb641-13"><a href="statistics.html#cb641-13" tabindex="-1"></a><span class="co"># Peripheral Vertigo</span></span>
<span id="cb641-14"><a href="statistics.html#cb641-14" tabindex="-1"></a><span class="co">#Sensitiviy=TP/(TP+FN)=100%</span></span>
<span id="cb641-15"><a href="statistics.html#cb641-15" tabindex="-1"></a><span class="co">#Specificity=TN/(TN+FP)=83%</span></span></code></pre></div>
</div>
<div id="auc" class="section level3 hasAnchor" number="4.8.2">
<h3><span class="header-section-number">4.8.2</span> AUC<a href="statistics.html#auc" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The area under the receiver operating characteristics (ROC) curve or AUC is a measure of the accuracy of the test. It is recommended that ROC curve is used when there are multiple threshold. It should not be used when the test has only one threshold. Some investigators suggest caution regarding the validity of using receiver operating curve with single threshold diagnostic tests <span class="citation">(<a href="#ref-pmid33250548">J 2020</a>)</span>. An AUC of 0.5 is classified as no better than by chance; 0.60.69 provides poor discrimination; 0.70.79 provides acceptable (fair) discrimination, 0.8 to 0.89 provides good (excellent) discrimination, and 0.9 to 1.0 provides outstanding discrimination.</p>
</div>
<div id="likelihood-ratio" class="section level3 hasAnchor" number="4.8.3">
<h3><span class="header-section-number">4.8.3</span> Likelihood ratio<a href="statistics.html#likelihood-ratio" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Positive likelihood ratio (PLR) is the ratio of sensitivity to false positive rate (FPR); the negative (NLR) likelihood ratio is the ratio of 1-sensitivity to specificity. A PLR indicates the likelihood that a positive spot sign (test) would be expected in a patient with ICH (target disorder) compared with the likelihood that the same result would be expected in a patient without ICH. Using the recommendation by Jaeschke et al, a high PLR (&gt;5) and low NLR (&lt;0.2) indicate that the test results would make moderate changes in the likelihood of hematoma growth from baseline risk. PLRs of &gt;10 and NLRs of &lt;0.1 would confer very large changes from baseline risk .</p>
<div id="fagans-normogram" class="section level4 hasAnchor" number="4.8.3.1">
<h4><span class="header-section-number">4.8.3.1</span> Fagans normogram<a href="statistics.html#fagans-normogram" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Fagans normogram can be conceptualised as a sliding ruler to match the disease
prevalence and likelihood ratios to evaluate the impact on the post-test probability <span class="citation">(<a href="#ref-pmid1143310">TJ 1975</a>)</span>. At the current disease prevalence of 23.4% and PLR 4.65, the post-test probability remains low at 0.60.</p>
<div class="sourceCode" id="cb642"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb642-1"><a href="statistics.html#cb642-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb642-2"><a href="statistics.html#cb642-2" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;https://raw.githubusercontent.com/achekroud/nomogrammer/master/nomogrammer.r&quot;</span>)</span>
<span id="cb642-3"><a href="statistics.html#cb642-3" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">nomogrammer</span>(<span class="at">Prevalence =</span> .<span class="dv">234</span>, <span class="at">Plr =</span> <span class="fl">4.85</span>, <span class="at">Nlr =</span> <span class="fl">0.49</span>)</span>
<span id="cb642-4"><a href="statistics.html#cb642-4" tabindex="-1"></a>p<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">&quot;Fagan&#39;s normogram for Spot Sign and ICH growth&quot;</span>)</span>
<span id="cb642-5"><a href="statistics.html#cb642-5" tabindex="-1"></a></span>
<span id="cb642-6"><a href="statistics.html#cb642-6" tabindex="-1"></a><span class="co">#to save the file</span></span>
<span id="cb642-7"><a href="statistics.html#cb642-7" tabindex="-1"></a><span class="co">#ggsave(p,file=&quot;Fagan_SpotSign.png&quot;,width=5.99,height=3.99,units=&quot;in&quot;)</span></span></code></pre></div>
</div>
<div id="likelihood-ratio-graph" class="section level4 hasAnchor" number="4.8.3.2">
<h4><span class="header-section-number">4.8.3.2</span> Likelihood ratio graph<a href="statistics.html#likelihood-ratio-graph" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Likelihood ratio graph is a tool for comparing diagnostic tests <span class="citation">(<a href="#ref-pmid10700737">BJ 2000</a>)</span>.</p>
<div class="sourceCode" id="cb643"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb643-1"><a href="statistics.html#cb643-1" tabindex="-1"></a><span class="co">#plot likelihood ratio graph</span></span>
<span id="cb643-2"><a href="statistics.html#cb643-2" tabindex="-1"></a></span>
<span id="cb643-3"><a href="statistics.html#cb643-3" tabindex="-1"></a>LR_graph<span class="ot">&lt;-</span><span class="cf">function</span> (Read,sheet,Sensitivity, Specificity){</span>
<span id="cb643-4"><a href="statistics.html#cb643-4" tabindex="-1"></a>  </span>
<span id="cb643-5"><a href="statistics.html#cb643-5" tabindex="-1"></a>  Read1<span class="ot">&lt;-</span>readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(Read, <span class="at">sheet =</span> sheet)</span>
<span id="cb643-6"><a href="statistics.html#cb643-6" tabindex="-1"></a>  </span>
<span id="cb643-7"><a href="statistics.html#cb643-7" tabindex="-1"></a>  <span class="co">#binary data</span></span>
<span id="cb643-8"><a href="statistics.html#cb643-8" tabindex="-1"></a>  <span class="co">#A=True pos %B=False positive   %C=False negative   %D=True negative</span></span>
<span id="cb643-9"><a href="statistics.html#cb643-9" tabindex="-1"></a>  </span>
<span id="cb643-10"><a href="statistics.html#cb643-10" tabindex="-1"></a>  A<span class="ot">=</span>Read1<span class="sc">$</span>TP</span>
<span id="cb643-11"><a href="statistics.html#cb643-11" tabindex="-1"></a>  B<span class="ot">=</span>Read1<span class="sc">$</span>FP</span>
<span id="cb643-12"><a href="statistics.html#cb643-12" tabindex="-1"></a>  C<span class="ot">=</span>Read1<span class="sc">$</span>FN</span>
<span id="cb643-13"><a href="statistics.html#cb643-13" tabindex="-1"></a>  D<span class="ot">=</span>Read1<span class="sc">$</span>TN</span>
<span id="cb643-14"><a href="statistics.html#cb643-14" tabindex="-1"></a>  </span>
<span id="cb643-15"><a href="statistics.html#cb643-15" tabindex="-1"></a>  TPR<span class="ot">=</span>A<span class="sc">/</span>(A<span class="sc">+</span>C)</span>
<span id="cb643-16"><a href="statistics.html#cb643-16" tabindex="-1"></a>  FPR<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span>(D<span class="sc">/</span>(D<span class="sc">+</span>B))</span>
<span id="cb643-17"><a href="statistics.html#cb643-17" tabindex="-1"></a>  </span>
<span id="cb643-18"><a href="statistics.html#cb643-18" tabindex="-1"></a>  TPR_DiagnosticTest<span class="ot">=</span>Sensitivity</span>
<span id="cb643-19"><a href="statistics.html#cb643-19" tabindex="-1"></a>  FPR_DiagnosticTest<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span>Specificity</span>
<span id="cb643-20"><a href="statistics.html#cb643-20" tabindex="-1"></a>  </span>
<span id="cb643-21"><a href="statistics.html#cb643-21" tabindex="-1"></a>  <span class="co"># set plot</span></span>
<span id="cb643-22"><a href="statistics.html#cb643-22" tabindex="-1"></a>  </span>
<span id="cb643-23"><a href="statistics.html#cb643-23" tabindex="-1"></a>  X<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span>.<span class="dv">1</span>)</span>
<span id="cb643-24"><a href="statistics.html#cb643-24" tabindex="-1"></a>  Y<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span>.<span class="dv">1</span>)</span>
<span id="cb643-25"><a href="statistics.html#cb643-25" tabindex="-1"></a></span>
<span id="cb643-26"><a href="statistics.html#cb643-26" tabindex="-1"></a>  <span class="fu">plot</span>(X,Y,<span class="at">main=</span><span class="st">&quot;Likelihood Ratio graph&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;1-Specificity&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Sensitivity&quot;</span>,<span class="at">cex=</span>.<span class="dv">25</span>)</span>
<span id="cb643-27"><a href="statistics.html#cb643-27" tabindex="-1"></a>  </span>
<span id="cb643-28"><a href="statistics.html#cb643-28" tabindex="-1"></a>  <span class="co">#pch describe the shape. The value 1 corresponds o</span></span>
<span id="cb643-29"><a href="statistics.html#cb643-29" tabindex="-1"></a>  <span class="fu">points</span>(FPR_DiagnosticTest,TPR_DiagnosticTest,<span class="at">pch=</span><span class="dv">8</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">cex=</span><span class="dv">2</span>)</span>
<span id="cb643-30"><a href="statistics.html#cb643-30" tabindex="-1"></a>  </span>
<span id="cb643-31"><a href="statistics.html#cb643-31" tabindex="-1"></a>  <span class="co">#pch describe the shape. The value 8 corresponds *</span></span>
<span id="cb643-32"><a href="statistics.html#cb643-32" tabindex="-1"></a>  <span class="fu">points</span>(FPR,TPR,<span class="at">pch=</span><span class="dv">1</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">cex=</span><span class="dv">2</span>) <span class="co">#add point</span></span>
<span id="cb643-33"><a href="statistics.html#cb643-33" tabindex="-1"></a>  <span class="co">#abline(coef = c(0,1)) #add diagonal line</span></span>
<span id="cb643-34"><a href="statistics.html#cb643-34" tabindex="-1"></a>  df1<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">c1=</span><span class="fu">c</span>(<span class="dv">0</span>,TPR_DiagnosticTest),<span class="at">c2=</span><span class="fu">c</span>(<span class="dv">0</span>,FPR_DiagnosticTest))</span>
<span id="cb643-35"><a href="statistics.html#cb643-35" tabindex="-1"></a>  reg1<span class="ot">&lt;-</span><span class="fu">lm</span>(c1<span class="sc">~</span>c2,<span class="at">data=</span>df1)</span>
<span id="cb643-36"><a href="statistics.html#cb643-36" tabindex="-1"></a>  df2<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">c1=</span><span class="fu">c</span>(TPR_DiagnosticTest,<span class="dv">1</span>),<span class="at">c2=</span><span class="fu">c</span>(FPR_DiagnosticTest,<span class="dv">1</span>))</span>
<span id="cb643-37"><a href="statistics.html#cb643-37" tabindex="-1"></a>  reg2<span class="ot">&lt;-</span><span class="fu">lm</span>(c1<span class="sc">~</span>c2,<span class="at">data=</span>df2)</span>
<span id="cb643-38"><a href="statistics.html#cb643-38" tabindex="-1"></a>  <span class="fu">abline</span>(reg1)</span>
<span id="cb643-39"><a href="statistics.html#cb643-39" tabindex="-1"></a>  <span class="fu">abline</span>(reg2)</span>
<span id="cb643-40"><a href="statistics.html#cb643-40" tabindex="-1"></a>  <span class="fu">text</span>(<span class="at">x=</span>FPR_DiagnosticTest,<span class="at">y=</span>TPR_DiagnosticTest<span class="fl">+.3</span>,<span class="at">label=</span><span class="st">&quot;Superior&quot;</span>,<span class="at">cex=</span>.<span class="dv">7</span>)</span>
<span id="cb643-41"><a href="statistics.html#cb643-41" tabindex="-1"></a>  <span class="fu">text</span>(<span class="at">x=</span>FPR_DiagnosticTest<span class="fl">+.2</span>,<span class="at">y=</span>TPR_DiagnosticTest<span class="fl">+.2</span>,<span class="at">label=</span><span class="st">&quot;Absence&quot;</span>,<span class="at">cex=</span>.<span class="dv">7</span>)</span>
<span id="cb643-42"><a href="statistics.html#cb643-42" tabindex="-1"></a>  <span class="fu">text</span>(<span class="at">x=</span>.<span class="dv">0125</span>,<span class="at">y=</span>TPR_DiagnosticTest<span class="fl">-.1</span>,<span class="at">label=</span><span class="st">&quot;Presence&quot;</span>,<span class="at">cex=</span>.<span class="dv">7</span>)</span>
<span id="cb643-43"><a href="statistics.html#cb643-43" tabindex="-1"></a>  <span class="fu">text</span>(<span class="at">x=</span>FPR_DiagnosticTest<span class="fl">+.1</span>,<span class="at">y=</span>TPR_DiagnosticTest,<span class="at">label=</span><span class="st">&quot;Inferior&quot;</span>,<span class="at">cex=</span>.<span class="dv">7</span>)</span>
<span id="cb643-44"><a href="statistics.html#cb643-44" tabindex="-1"></a>  <span class="fu">text</span>(<span class="at">x=</span>.<span class="dv">7</span>,<span class="at">y=</span>.<span class="dv">2</span>,<span class="at">label=</span><span class="st">&quot;Reference = Content Expert&quot;</span>,<span class="at">cex=</span>.<span class="dv">7</span>)</span>
<span id="cb643-45"><a href="statistics.html#cb643-45" tabindex="-1"></a>  <span class="fu">text</span>(<span class="at">x=</span>.<span class="dv">7</span>,<span class="at">y=</span>.<span class="dv">15</span>, <span class="at">label=</span><span class="st">&quot;Diagnostic Test software&quot;</span>, <span class="at">cex=</span>.<span class="dv">7</span>)</span>
<span id="cb643-46"><a href="statistics.html#cb643-46" tabindex="-1"></a></span>
<span id="cb643-47"><a href="statistics.html#cb643-47" tabindex="-1"></a>}</span></code></pre></div>
<p>Runnning the function from above</p>
<div class="sourceCode" id="cb644"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb644-1"><a href="statistics.html#cb644-1" tabindex="-1"></a><span class="co">#Sensitivity=0.623</span></span>
<span id="cb644-2"><a href="statistics.html#cb644-2" tabindex="-1"></a><span class="co">#Specificity=1-.927</span></span>
<span id="cb644-3"><a href="statistics.html#cb644-3" tabindex="-1"></a></span>
<span id="cb644-4"><a href="statistics.html#cb644-4" tabindex="-1"></a><span class="fu">LR_graph</span>(<span class="st">&quot;./Data-Use/Diagnostic_test_summary.xlsx&quot;</span>,<span class="dv">1</span>,.<span class="dv">623</span>,.<span class="dv">927</span>)</span></code></pre></div>
<pre><code>## New names:
##  `` -&gt; `...11`</code></pre>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-14-3-3-1-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="metaanalysis" class="section level2 hasAnchor" number="4.9">
<h2><span class="header-section-number">4.9</span> Metaanalysis<a href="statistics.html#metaanalysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>During journal club, junior doctors are often taught about the importance of metaanalysis. It is worth knowing how to perform a metaanalysis in order to critique the study. This is an important issue as the junior doctor is supervised by someone who a content expert but not necessarily a method expert. Metaanalysis can be performed for clinical trials, cohort studies or diagnostic studies. As an example, it is not well known outside of statistics journal that the bivariate analysis is the preferred method to evaluate diagnostic studies <span class="citation">(<a href="#ref-pmid16168343">Reitsma et al. 2005</a>)</span>. By contrast, the majority of metaanalysis of diagnostic studies uses the univariate method of Moses and Littenberg <span class="citation">(<a href="#ref-pmid8210827">Moses, Shapiro, and Littenberg 1993</a>)</span>. This issue will be expanded below.</p>
<div id="quality-of-study" class="section level3 hasAnchor" number="4.9.1">
<h3><span class="header-section-number">4.9.1</span> Quality of study<a href="statistics.html#quality-of-study" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>All studies require evaluation of the quality of the individual studies. This can be done with the QUADAS2 tool, available at
<a href="https://annals.org/aim/fullarticle/474994/quadas-2-revised-tool-quality-assessment-diagnostic-accuracy-studies" class="uri">https://annals.org/aim/fullarticle/474994/quadas-2-revised-tool-quality-assessment-diagnostic-accuracy-studies</a>.</p>
</div>
<div id="prisma" class="section level3 hasAnchor" number="4.9.2">
<h3><span class="header-section-number">4.9.2</span> PRISMA<a href="statistics.html#prisma" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The PRISMA statement is useful for understanding the search strategy and the papers removed and retained in the metaanalysis. An example of generating the statement is provided below in R. The example given here is from a paper on the use of spot sign to predict enlargment of intracerebral hemorrhage <span class="citation">(<a href="#ref-pmid31272327">Phan, Krishnadas, et al. 2019</a>)</span>.</p>
<div class="sourceCode" id="cb646"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb646-1"><a href="statistics.html#cb646-1" tabindex="-1"></a><span class="fu">library</span>(PRISMAstatement)</span>
<span id="cb646-2"><a href="statistics.html#cb646-2" tabindex="-1"></a><span class="co">#example from Spot sign paper. Stroke 2019</span></span>
<span id="cb646-3"><a href="statistics.html#cb646-3" tabindex="-1"></a><span class="fu">prisma</span>(<span class="at">found =</span> <span class="dv">193</span>,</span>
<span id="cb646-4"><a href="statistics.html#cb646-4" tabindex="-1"></a>       <span class="at">found_other =</span> <span class="dv">27</span>,</span>
<span id="cb646-5"><a href="statistics.html#cb646-5" tabindex="-1"></a>       <span class="at">no_dupes =</span> <span class="dv">141</span>, </span>
<span id="cb646-6"><a href="statistics.html#cb646-6" tabindex="-1"></a>       <span class="at">screened =</span> <span class="dv">141</span>, </span>
<span id="cb646-7"><a href="statistics.html#cb646-7" tabindex="-1"></a>       <span class="at">screen_exclusions =</span> <span class="dv">3</span>, </span>
<span id="cb646-8"><a href="statistics.html#cb646-8" tabindex="-1"></a>       <span class="at">full_text =</span> <span class="dv">138</span>,</span>
<span id="cb646-9"><a href="statistics.html#cb646-9" tabindex="-1"></a>       <span class="at">full_text_exclusions =</span> <span class="dv">112</span>, </span>
<span id="cb646-10"><a href="statistics.html#cb646-10" tabindex="-1"></a>       <span class="at">qualitative =</span> <span class="dv">26</span>, </span>
<span id="cb646-11"><a href="statistics.html#cb646-11" tabindex="-1"></a>       <span class="at">quantitative =</span> <span class="dv">26</span>,</span>
<span id="cb646-12"><a href="statistics.html#cb646-12" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">800</span>, <span class="at">height =</span> <span class="dv">800</span>)</span></code></pre></div>
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-0cd9490626465d09cdb7" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-0cd9490626465d09cdb7">{"x":{"diagram":"digraph prisma {\n    node [shape=\"box\", fontsize = 10];\n    graph [splines=ortho, nodesep=1, dpi = 72]\n    a -> nodups;\n    b -> nodups;\n    a [label=\"Records identified through\ndatabase searching\n(n = 193)\"];\n    b [label=\"Additional records identified\nthrough other sources\n(n = 27)\"]\n    nodups -> incex;\n    nodups [label=\"Records after duplicates removed\n(n = 141)\"];\n    incex -> {ex; ft}\n    incex [label=\"Records screened\n(n = 141)\"];\n    ex [label=\"Records excluded\n(n = 3)\"];\n    {rank=same; incex ex}\n    ft -> {qual; ftex};\n    ft [label=\"Full-text articles assessed\nfor eligibility\n(n = 138)\"];\n    {rank=same; ft ftex}\n    ftex [label=\"Full-text articles excluded,\nwith reasons\n(n = 112)\"];\n    qual -> quant\n    qual [label=\"Studies included in qualitative synthesis\n(n = 26)\"];\n    quant [label=\"Studies included in\nquantitative synthesis\n(meta-analysis)\n(n = 26)\"];\n  }","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb647"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb647-1"><a href="statistics.html#cb647-1" tabindex="-1"></a><span class="co">#https://rich-iannone.github.io/DiagrammeR/graphviz_and_mermaid.html#attributes</span></span>
<span id="cb647-2"><a href="statistics.html#cb647-2" tabindex="-1"></a><span class="fu">library</span>(DiagrammeR)</span>
<span id="cb647-3"><a href="statistics.html#cb647-3" tabindex="-1"></a><span class="fu">grViz</span>(<span class="st">&quot;</span></span>
<span id="cb647-4"><a href="statistics.html#cb647-4" tabindex="-1"></a><span class="st">digraph boxes_and_circles {</span></span>
<span id="cb647-5"><a href="statistics.html#cb647-5" tabindex="-1"></a></span>
<span id="cb647-6"><a href="statistics.html#cb647-6" tabindex="-1"></a><span class="st">  # a &#39;graph&#39; statement</span></span>
<span id="cb647-7"><a href="statistics.html#cb647-7" tabindex="-1"></a><span class="st">  graph [overlap = true, fontsize = 10]</span></span>
<span id="cb647-8"><a href="statistics.html#cb647-8" tabindex="-1"></a></span>
<span id="cb647-9"><a href="statistics.html#cb647-9" tabindex="-1"></a><span class="st">  # several &#39;node&#39; statements</span></span>
<span id="cb647-10"><a href="statistics.html#cb647-10" tabindex="-1"></a><span class="st">  node [shape = box,</span></span>
<span id="cb647-11"><a href="statistics.html#cb647-11" tabindex="-1"></a><span class="st">        fontname = Helvetica]</span></span>
<span id="cb647-12"><a href="statistics.html#cb647-12" tabindex="-1"></a><span class="st">  Stroke</span></span>
<span id="cb647-13"><a href="statistics.html#cb647-13" tabindex="-1"></a></span>
<span id="cb647-14"><a href="statistics.html#cb647-14" tabindex="-1"></a><span class="st">  node [shape = oval,</span></span>
<span id="cb647-15"><a href="statistics.html#cb647-15" tabindex="-1"></a><span class="st">        fixedsize = false,</span></span>
<span id="cb647-16"><a href="statistics.html#cb647-16" tabindex="-1"></a><span class="st">        color=red,</span></span>
<span id="cb647-17"><a href="statistics.html#cb647-17" tabindex="-1"></a><span class="st">        width = 0.9] </span></span>
<span id="cb647-18"><a href="statistics.html#cb647-18" tabindex="-1"></a><span class="st">  Hypertension; &#39;No Hypertension&#39;</span></span>
<span id="cb647-19"><a href="statistics.html#cb647-19" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb647-20"><a href="statistics.html#cb647-20" tabindex="-1"></a><span class="st">  node [shape= circle,</span></span>
<span id="cb647-21"><a href="statistics.html#cb647-21" tabindex="-1"></a><span class="st">  fontcolor=red,</span></span>
<span id="cb647-22"><a href="statistics.html#cb647-22" tabindex="-1"></a><span class="st">        color=blue,</span></span>
<span id="cb647-23"><a href="statistics.html#cb647-23" tabindex="-1"></a><span class="st">        fixedsize=false]</span></span>
<span id="cb647-24"><a href="statistics.html#cb647-24" tabindex="-1"></a></span>
<span id="cb647-25"><a href="statistics.html#cb647-25" tabindex="-1"></a><span class="st">  Hypokalemia; &#39;No Hypokalemia&#39;        </span></span>
<span id="cb647-26"><a href="statistics.html#cb647-26" tabindex="-1"></a></span>
<span id="cb647-27"><a href="statistics.html#cb647-27" tabindex="-1"></a><span class="st">  # several &#39;edge&#39; statements</span></span>
<span id="cb647-28"><a href="statistics.html#cb647-28" tabindex="-1"></a><span class="st">  edge [arrowhead=diamond]</span></span>
<span id="cb647-29"><a href="statistics.html#cb647-29" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb647-30"><a href="statistics.html#cb647-30" tabindex="-1"></a><span class="st">  Stroke-&gt;{Hypertension, &#39;No Hypertension&#39;}</span></span>
<span id="cb647-31"><a href="statistics.html#cb647-31" tabindex="-1"></a><span class="st">  Hypertension-&gt;{Hypokalemia, &#39;No Hypokalemia&#39;}</span></span>
<span id="cb647-32"><a href="statistics.html#cb647-32" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb647-33"><a href="statistics.html#cb647-33" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb647-34"><a href="statistics.html#cb647-34" tabindex="-1"></a></span>
<span id="cb647-35"><a href="statistics.html#cb647-35" tabindex="-1"></a><span class="st">&quot;</span>)</span></code></pre></div>
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-2e2934ee2bc0e5cfe747" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-2e2934ee2bc0e5cfe747">{"x":{"diagram":"\ndigraph boxes_and_circles {\n\n  # a \"graph\" statement\n  graph [overlap = true, fontsize = 10]\n\n  # several \"node\" statements\n  node [shape = box,\n        fontname = Helvetica]\n  Stroke\n\n  node [shape = oval,\n        fixedsize = false,\n        color=red,\n        width = 0.9] \n  Hypertension; \"No Hypertension\"\n  \n  node [shape= circle,\n  fontcolor=red,\n        color=blue,\n        fixedsize=false]\n\n  Hypokalemia; \"No Hypokalemia\"        \n\n  # several \"edge\" statements\n  edge [arrowhead=diamond]\n  \n  Stroke->{Hypertension, \"No Hypertension\"}\n  Hypertension->{Hypokalemia, \"No Hypokalemia\"}\n  \n}\n\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb648"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb648-1"><a href="statistics.html#cb648-1" tabindex="-1"></a><span class="do">## alternative</span></span>
<span id="cb648-2"><a href="statistics.html#cb648-2" tabindex="-1"></a></span>
<span id="cb648-3"><a href="statistics.html#cb648-3" tabindex="-1"></a><span class="fu">grViz</span>(<span class="st">&quot;digraph flowchart {</span></span>
<span id="cb648-4"><a href="statistics.html#cb648-4" tabindex="-1"></a><span class="st">      # node definitions with substituted label text</span></span>
<span id="cb648-5"><a href="statistics.html#cb648-5" tabindex="-1"></a><span class="st">      node [fontname = Helvetica, shape = rectangle]        </span></span>
<span id="cb648-6"><a href="statistics.html#cb648-6" tabindex="-1"></a><span class="st">      tab1 [label = &#39;@@1&#39;]</span></span>
<span id="cb648-7"><a href="statistics.html#cb648-7" tabindex="-1"></a><span class="st">      tab2 [label = &#39;@@2&#39;]</span></span>
<span id="cb648-8"><a href="statistics.html#cb648-8" tabindex="-1"></a><span class="st">      tab3 [label = &#39;@@3&#39;]</span></span>
<span id="cb648-9"><a href="statistics.html#cb648-9" tabindex="-1"></a><span class="st">      tab4 [label = &#39;@@4&#39;]</span></span>
<span id="cb648-10"><a href="statistics.html#cb648-10" tabindex="-1"></a><span class="st">      tab5 [label = &#39;@@5&#39;]</span></span>
<span id="cb648-11"><a href="statistics.html#cb648-11" tabindex="-1"></a></span>
<span id="cb648-12"><a href="statistics.html#cb648-12" tabindex="-1"></a><span class="st"> </span></span>
<span id="cb648-13"><a href="statistics.html#cb648-13" tabindex="-1"></a><span class="st"># edge definitions with the node IDs</span></span>
<span id="cb648-14"><a href="statistics.html#cb648-14" tabindex="-1"></a><span class="st">      tab1 -&gt; tab3 </span></span>
<span id="cb648-15"><a href="statistics.html#cb648-15" tabindex="-1"></a><span class="st">      tab1-&gt; tab2 </span></span>
<span id="cb648-16"><a href="statistics.html#cb648-16" tabindex="-1"></a><span class="st">      #tab2-&gt;tab3</span></span>
<span id="cb648-17"><a href="statistics.html#cb648-17" tabindex="-1"></a><span class="st">      tab2 -&gt; tab4 </span></span>
<span id="cb648-18"><a href="statistics.html#cb648-18" tabindex="-1"></a><span class="st">      tab2-&gt; tab5;</span></span>
<span id="cb648-19"><a href="statistics.html#cb648-19" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb648-20"><a href="statistics.html#cb648-20" tabindex="-1"></a></span>
<span id="cb648-21"><a href="statistics.html#cb648-21" tabindex="-1"></a><span class="st">      [1]: &#39;Stroke n=19&#39;</span></span>
<span id="cb648-22"><a href="statistics.html#cb648-22" tabindex="-1"></a><span class="st">      [2]: &#39;Hypertension n=10&#39;</span></span>
<span id="cb648-23"><a href="statistics.html#cb648-23" tabindex="-1"></a><span class="st">      [3]: &#39;No Hypertension n=9&#39;</span></span>
<span id="cb648-24"><a href="statistics.html#cb648-24" tabindex="-1"></a><span class="st">      [4]: &#39;Hypokalemia n=?&#39;</span></span>
<span id="cb648-25"><a href="statistics.html#cb648-25" tabindex="-1"></a><span class="st">      [5]: &#39;No Hypokalemia n=?&#39;</span></span>
<span id="cb648-26"><a href="statistics.html#cb648-26" tabindex="-1"></a><span class="st">      &quot;</span>)</span></code></pre></div>
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-e3248e5e8eb0009f755e" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-e3248e5e8eb0009f755e">{"x":{"diagram":"digraph flowchart {\n      # node definitions with substituted label text\n      node [fontname = Helvetica, shape = rectangle]        \n      tab1 [label = \"Stroke n=19\"]\n      tab2 [label = \"Hypertension n=10\"]\n      tab3 [label = \"No Hypertension n=9\"]\n      tab4 [label = \"Hypokalemia n=?\"]\n      tab5 [label = \"No Hypokalemia n=?\"]\n\n \n# edge definitions with the node IDs\n      tab1 -> tab3 \n      tab1-> tab2 \n      #tab2->tab3\n      tab2 -> tab4 \n      tab2-> tab5;\n      }","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="conversion-of-median-to-mean" class="section level3 hasAnchor" number="4.9.3">
<h3><span class="header-section-number">4.9.3</span> Conversion of median to mean<a href="statistics.html#conversion-of-median-to-mean" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One issue with performing metaanalysis is that one paper may report mean and another report median age. The formula for the mean is given by <span class="math inline">\(\frac{a+2m+b}{4}\)</span> where <em>m</em> is the median, <em>a</em> is the upper and <em>b</em> is the lower range <span class="citation">(<a href="#ref-pmid25524443">Wan 2014</a>)</span>. The variance is given by <span class="math inline">\(S^2=\frac{1}{12}(\frac{(a+2m+b)^2}{4}+{(b-a)^2})\)</span>. This formula requires examination of the data such as the figure to obtain the upper and lower range. These changes are incorporated into <em>meta</em> libray using <em>meatamean</em> function <span class="citation">(<a href="#ref-doi10.1136/ebmental-2019-300117">Balduzzi, Rcker, and Schwarzer 2019</a>)</span>. More recently, investigators suggest to also consider the skewness of the data from the 5 number summary data <span class="citation">(<a href="#ref-pmid37161735">Shi et al. 2023</a>)</span>. The argument <em>method.mean</em> in function <em>metamean</em> is used to specify the method for estimating the mean. In this case we chose the Luo method for illustration Luo <span class="citation">(<a href="#ref-doi:10.1177/0962280216669183">Luo et al. 2018</a>)</span>. See the help page by typing question mark before <em>metamean</em> for more options.</p>
<div class="sourceCode" id="cb649"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb649-1"><a href="statistics.html#cb649-1" tabindex="-1"></a><span class="fu">library</span>(meta)</span>
<span id="cb649-2"><a href="statistics.html#cb649-2" tabindex="-1"></a></span>
<span id="cb649-3"><a href="statistics.html#cb649-3" tabindex="-1"></a><span class="co">#NIHSS data from ANGEL large core trial in NEJM 2023</span></span>
<span id="cb649-4"><a href="statistics.html#cb649-4" tabindex="-1"></a><span class="fu">metamean</span>(<span class="at">q1=</span><span class="dv">4</span>,<span class="at">q3=</span><span class="dv">20</span>,<span class="at">median=</span><span class="dv">16</span>,<span class="at">n=</span><span class="dv">230</span>, <span class="at">method.mean =</span> <span class="st">&quot;Luo&quot;</span>)</span></code></pre></div>
<pre><code>## Number of observations: o = 230
## 
##     mean             95%-CI
##  13.1932 [11.6506; 14.7358]
## 
## Details:
## - Untransformed (raw) means</code></pre>
<p>Here the same data is used for the McGrath method <span class="citation">(<a href="#ref-doi:10.1177/0962280219889080">McGrath et al. 2020</a>)</span>.</p>
<div class="sourceCode" id="cb651"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb651-1"><a href="statistics.html#cb651-1" tabindex="-1"></a><span class="fu">metamean</span>(<span class="at">q1=</span><span class="dv">4</span>,<span class="at">q3=</span><span class="dv">20</span>,<span class="at">median=</span><span class="dv">16</span>,<span class="at">n=</span><span class="dv">230</span>, <span class="at">method.mean =</span> <span class="st">&quot;QE-McGrath&quot;</span>)</span></code></pre></div>
<pre><code>## Number of observations: o = 230
## 
##     mean             95%-CI
##  13.3333 [11.7907; 14.8759]
## 
## Details:
## - Untransformed (raw) means</code></pre>
<p>The conversion from median to mean in <em>metafor</em> is performed using <em>conv.fivenum</em> function <span class="citation">(<a href="#ref-JSSv036i03">Viechtbauer 2010</a>)</span>. There is an update on the <em>metafor</em> page as well as discussion on alternate approach. The default method of this function is to use the methods by Luo <span class="citation">(<a href="#ref-doi:10.1177/0962280216669183">Luo et al. 2018</a>)</span>, Wan <span class="citation">(<a href="#ref-pmid25524443">Wan 2014</a>)</span> and Shi <span class="citation">(<a href="#ref-pmid37161735">Shi et al. 2023</a>)</span></p>
<div class="sourceCode" id="cb653"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb653-1"><a href="statistics.html#cb653-1" tabindex="-1"></a><span class="fu">library</span>(metafor)</span>
<span id="cb653-2"><a href="statistics.html#cb653-2" tabindex="-1"></a><span class="co"># example data frame</span></span>
<span id="cb653-3"><a href="statistics.html#cb653-3" tabindex="-1"></a>EstMean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Paper=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="cn">NA</span>), <span class="at">min=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="cn">NA</span>,<span class="dv">2</span>,<span class="cn">NA</span>), <span class="at">q1=</span><span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="cn">NA</span>),</span>
<span id="cb653-4"><a href="statistics.html#cb653-4" tabindex="-1"></a>                  <span class="at">median=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">6</span>,<span class="cn">NA</span>), <span class="at">q3=</span><span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="dv">10</span>,<span class="dv">10</span>,<span class="cn">NA</span>),</span>
<span id="cb653-5"><a href="statistics.html#cb653-5" tabindex="-1"></a>                  <span class="at">max=</span><span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">14</span>,<span class="cn">NA</span>,<span class="dv">14</span>,<span class="cn">NA</span>),</span>
<span id="cb653-6"><a href="statistics.html#cb653-6" tabindex="-1"></a>                  <span class="at">mean=</span><span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="fl">7.0</span>), <span class="at">sd=</span><span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="fl">4.2</span>),</span>
<span id="cb653-7"><a href="statistics.html#cb653-7" tabindex="-1"></a>                  <span class="at">n=</span><span class="fu">c</span>(<span class="dv">30</span>,<span class="dv">30</span>,<span class="dv">30</span>,<span class="dv">30</span>,<span class="dv">30</span>))</span>
<span id="cb653-8"><a href="statistics.html#cb653-8" tabindex="-1"></a>EstMean</span></code></pre></div>
<pre><code>##   Paper min q1 median q3 max mean  sd  n
## 1     1   1 NA      5 NA  12   NA  NA 30
## 2     2   2 NA      6 NA  14   NA  NA 30
## 3     3  NA  4      6 10  NA   NA  NA 30
## 4     4   2  4      6 10  14   NA  NA 30
## 5    NA  NA NA     NA NA  NA    7 4.2 30</code></pre>
<div class="sourceCode" id="cb655"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb655-1"><a href="statistics.html#cb655-1" tabindex="-1"></a>EstMean <span class="ot">&lt;-</span> <span class="fu">conv.fivenum</span>(<span class="at">min=</span>min, <span class="at">q1=</span>q1, <span class="at">median=</span>median, <span class="at">q3=</span>q3, <span class="at">max=</span>max, <span class="at">n=</span>n, <span class="at">data=</span>EstMean)</span>
<span id="cb655-2"><a href="statistics.html#cb655-2" tabindex="-1"></a></span>
<span id="cb655-3"><a href="statistics.html#cb655-3" tabindex="-1"></a>EstMean</span></code></pre></div>
<pre><code>##   Paper min q1 median q3 max     mean       sd  n
## 1     1   1 NA      5 NA  12 5.356748 2.695707 30
## 2     2   2 NA      6 NA  14 6.475664 2.940771 30
## 3     3  NA  4      6 10  NA 6.713000 4.670521 30
## 4     4   2  4      6 10  14 6.882074 3.546379 30
## 5    NA  NA NA     NA NA  NA 7.000000 4.200000 30</code></pre>
<p>The <em>estmeansd</em> library uses quantile estimation method with <em>qe.mean.sd</em> function when the data available are the median and quartile ranges <span class="citation">(<a href="#ref-doi:10.1177/0962280219889080">McGrath et al. 2020</a>)</span> <span class="citation">(<a href="#ref-pmid36412105">McGrath et al. 2022</a>)</span>.The approach here is to use simulation to estimate the parameters.</p>
<div class="sourceCode" id="cb657"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb657-1"><a href="statistics.html#cb657-1" tabindex="-1"></a><span class="fu">library</span>(estmeansd)</span></code></pre></div>
<pre><code>## Warning: package &#39;estmeansd&#39; was built under R version 4.3.2</code></pre>
<div class="sourceCode" id="cb659"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb659-1"><a href="statistics.html#cb659-1" tabindex="-1"></a><span class="co">#data from ANGEL large core trial in NEJM 2023</span></span>
<span id="cb659-2"><a href="statistics.html#cb659-2" tabindex="-1"></a>res_qe <span class="ot">&lt;-</span> <span class="fu">bc.mean.sd</span>(<span class="at">q1.val =</span> <span class="dv">13</span>, <span class="at">med.val =</span> <span class="dv">16</span>, <span class="at">q3.val =</span> <span class="dv">20</span>, <span class="at">n =</span> <span class="dv">230</span>)</span>
<span id="cb659-3"><a href="statistics.html#cb659-3" tabindex="-1"></a>res_qe </span></code></pre></div>
<pre><code>## $est.mean
## [1] 17.07168
## 
## $est.sd
## [1] 5.672963</code></pre>
<p>The standard error from the mean can be estimated using <em>get_SE</em> function.</p>
<div class="sourceCode" id="cb661"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb661-1"><a href="statistics.html#cb661-1" tabindex="-1"></a><span class="fu">get_SE</span>(res_qe)</span></code></pre></div>
<pre><code>## $est.se
## [1] 0.5051669
## 
## $boot_means
##    [1] 17.32080 16.63567 16.93157 16.22506 16.81751 16.74528 17.43474 16.11106
##    [9] 17.47347 16.43032 16.44389 16.11995 16.72996 16.21527 16.97045 17.36650
##   [17] 16.93584 17.01512 17.64598 16.15726 16.55998 17.00313 15.80268 16.58914
##   [25] 17.48917 17.24221 16.77229 16.07140 16.04065 17.08900 17.51776 16.99848
##   [33] 16.80582 16.42138 16.48949 16.20926 17.01369 17.26644 16.39943 16.21991
##   [41] 16.27875 17.25187 17.55987 15.58216 16.54443 15.61870 16.64487 17.00805
##   [49] 16.42508 17.20625 15.77155 16.97637 16.83431 17.80827 16.82612 16.65967
##   [57] 16.85211 15.74729 15.96911 16.37632 16.65517 16.96014 17.14616 16.41785
##   [65] 16.40626 16.20178 16.27367 16.75516 16.54564 17.38497 16.62009 16.81253
##   [73] 17.13541 16.73494 17.33151 16.45154 16.51921 16.50343 16.12960 16.60396
##   [81] 16.18093 16.43201 17.14915 16.83220 16.64586 16.07443 15.78909 17.07393
##   [89] 16.23504 16.97492 16.66537 16.91315 16.84260 16.30903 17.16021 16.41322
##   [97] 16.89036 16.41005 16.69129 17.24132 17.02483 16.54984 17.27668 16.19821
##  [105] 16.59967 17.40905 16.50958 15.87896 16.84670 16.40646 16.57890 16.13591
##  [113] 17.66015 16.86417 16.33229 16.45668 17.54818 15.84977 15.97001 16.84287
##  [121] 16.47263 16.69285 16.80196 16.68237 14.97224 16.13378 15.80667 17.04423
##  [129] 17.16538 16.05389 16.17857 16.49585 16.86023 15.87037 17.05982 16.69008
##  [137] 17.44114 17.10851 16.60494 16.68109 17.88056 15.98815 17.05229 17.53937
##  [145] 17.08673 17.31375 16.74816 17.06345 16.27700 16.38915 17.42180 16.34431
##  [153] 16.35144 17.30443 16.86197 16.19756 16.26297 15.70390 16.48744 17.52096
##  [161] 15.88988 16.22413 17.52307 16.90889 16.99480 17.75782 17.33927 17.24755
##  [169] 16.30885 15.78247 16.39264 16.43002 17.44886 17.31091 17.25882 16.82647
##  [177] 17.05872 17.07597 16.45283 16.64616 16.78093 16.29680 16.69348 17.34924
##  [185] 16.05006 17.04674 16.91597 17.37912 17.10926 16.28712 16.19510 16.40520
##  [193] 16.50581 16.32661 17.49536 15.78012 16.83333 16.60773 17.38507 16.55612
##  [201] 17.32284 15.81106 16.90375 17.31391 15.94982 16.95401 16.80364 15.81292
##  [209] 16.53285 16.33320 17.01881 17.42728 16.25028 16.46858 16.49107 16.67096
##  [217] 17.58910 16.80771 17.28705 17.33232 17.45333 15.70452 16.63157 16.78871
##  [225] 17.05351 16.73961 16.90675 16.43698 16.90910 16.69251 16.92140 17.77825
##  [233] 16.39586 17.25467 16.61300 16.28133 16.19347 16.95948 16.04262 16.40943
##  [241] 16.85606 17.73207 16.05969 16.56175 16.95998 16.77456 16.53733 17.05043
##  [249] 16.92095 17.63673 16.12897 17.27621 16.98738 16.77801 17.10649 16.57076
##  [257] 17.72980 16.47077 17.56929 16.05106 16.52822 16.17694 16.74069 16.53214
##  [265] 16.40624 16.22842 17.04366 16.92633 16.18737 16.46046 17.60398 17.25585
##  [273] 16.63055 16.15188 16.88281 16.71369 16.24270 17.18643 17.67773 15.87091
##  [281] 16.42196 15.88506 17.03498 16.75611 16.88050 16.36898 16.21923 15.86119
##  [289] 16.95522 16.38514 16.96344 16.78450 16.33910 16.55447 16.05376 16.23442
##  [297] 16.88179 16.89877 16.10907 16.41496 17.60726 16.50519 16.95768 16.27211
##  [305] 16.84034 16.65331 16.72439 16.42965 16.53121 17.40950 16.84293 15.97706
##  [313] 17.29369 16.79389 16.91178 16.80644 16.79246 16.56639 16.93687 15.93549
##  [321] 16.97803 16.53235 17.39980 17.11808 16.96614 16.56736 17.22072 16.13415
##  [329] 17.23012 17.33037 16.17044 16.84768 16.36681 17.43284 16.54669 17.52670
##  [337] 16.66046 17.02428 16.27942 17.66086 16.31591 17.29889 16.69726 17.42116
##  [345] 16.93894 16.42335 16.46556 16.02648 17.32738 16.53211 16.64578 17.13451
##  [353] 16.76469 17.41858 15.90484 16.70750 17.75160 16.94354 15.32914 17.15816
##  [361] 16.63345 16.52527 16.94031 16.54089 16.40911 16.72562 16.40795 16.08741
##  [369] 16.70375 16.99509 16.96411 17.33042 16.40155 16.43432 16.46230 17.06799
##  [377] 16.54744 16.63031 15.87108 16.59283 17.37594 17.03591 16.71549 16.40636
##  [385] 16.61947 17.12760 16.36781 17.41405 17.02543 16.59164 17.16652 16.70825
##  [393] 16.42348 16.33087 15.97193 16.57085 16.47704 17.06115 16.46346 16.37825
##  [401] 16.66852 16.90237 17.43670 17.02540 16.77567 17.12490 15.99466 17.57754
##  [409] 16.86391 16.09653 16.58349 16.88690 16.86661 16.78141 16.36360 17.76195
##  [417] 17.03920 17.26835 16.94910 16.84278 15.95507 17.29961 18.17420 17.06272
##  [425] 16.89956 17.01672 15.86038 17.66528 16.77691 16.48180 16.96160 16.20121
##  [433] 17.27824 18.36727 16.99313 17.28873 16.32290 16.62773 16.49563 17.46167
##  [441] 16.86582 16.69366 16.46467 16.35606 16.32886 15.93923 16.74221 16.89277
##  [449] 16.17542 15.53911 16.66733 17.46548 17.62017 17.04305 16.52943 16.42345
##  [457] 16.82823 17.05646 16.30915 16.90865 17.64410 15.89357 15.64827 17.27918
##  [465] 16.25759 16.84754 16.59172 16.52818 16.79152 17.48837 16.47858 16.35069
##  [473] 16.30569 16.35047 17.73610 16.67548 16.59373 16.54415 16.24393 17.73981
##  [481] 17.09083 16.82437 16.24566 16.31238 17.00293 16.77603 16.87141 16.65573
##  [489] 17.21202 16.89045 16.60988 16.74007 16.40177 16.94051 16.70215 16.03732
##  [497] 16.78091 16.56094 16.96411 16.67807 16.46205 16.95894 16.25541 17.30972
##  [505] 16.73450 16.89718 17.68449 16.80379 16.78249 16.70885 17.23930 15.60452
##  [513] 16.53229 16.94299 16.55256 17.53529 16.71421 16.72136 16.98154 16.76428
##  [521] 16.77496 17.21101 16.35697 17.00819 17.18196 16.52609 16.76834 16.21473
##  [529] 16.87524 16.50914 16.84794 17.20918 17.08759 16.91032 16.61788 17.20873
##  [537] 17.24702 16.26339 16.08962 16.89839 16.85254 17.27665 17.02339 16.80542
##  [545] 16.31260 16.95343 16.92637 15.76584 16.32428 15.52002 16.72758 16.10489
##  [553] 16.45044 17.15246 16.31862 17.54586 15.71766 16.03180 15.91454 16.50847
##  [561] 17.58034 16.44514 16.39053 16.44523 17.74103 16.60574 16.07944 17.24384
##  [569] 16.95394 17.25527 16.85086 16.76437 17.05588 16.89740 16.76604 17.47259
##  [577] 16.19189 16.57155 16.69201 15.58509 17.71348 16.89278 17.13621 16.98097
##  [585] 16.37209 16.63458 16.45756 15.82214 17.21805 15.87205 17.06057 16.51364
##  [593] 16.27850 16.61759 17.07980 17.12253 16.68874 16.46898 15.74514 16.47257
##  [601] 16.31795 17.16294 15.54235 17.07123 17.64895 17.51728 16.96985 17.29238
##  [609] 17.22470 16.64837 16.81209 17.09945 15.79052 16.14030 17.16385 16.97909
##  [617] 16.83372 16.35119 17.26060 17.22305 16.94219 17.00113 16.00311 15.83068
##  [625] 16.35277 16.42369 16.16125 17.56700 17.72774 16.89224 15.78370 17.10190
##  [633] 17.03751 17.38876 16.37537 16.28928 16.35935 17.80802 17.59292 16.55081
##  [641] 16.71701 16.60376 17.37924 16.87200 17.06629 16.81133 16.48532 16.70384
##  [649] 16.37222 16.59232 16.68356 16.87583 15.68926 16.92536 16.68019 16.49383
##  [657] 16.67838 16.81643 16.75565 16.84990 17.12278 16.46088 16.60467 15.56857
##  [665] 15.96341 16.51045 17.49161 16.84776 16.83310 16.45928 17.23271 16.55874
##  [673] 16.83858 16.74439 16.42704 16.62623 16.46970 16.65565 16.64940 16.72787
##  [681] 16.05734 16.95689 17.40792 16.82100 17.95568 16.68546 16.30957 17.38197
##  [689] 16.48733 16.38327 17.57027 16.69437 16.62862 16.45147 16.72926 16.47564
##  [697] 16.57953 16.79304 17.06867 16.77500 16.78006 16.11964 15.66531 15.82804
##  [705] 16.07783 16.04600 17.29471 16.03482 16.52480 16.76726 16.27465 16.30180
##  [713] 17.42910 16.25024 16.85514 16.96097 15.90684 17.45888 17.82760 16.72508
##  [721] 17.66872 17.29185 15.86558 17.43733 17.16304 16.01827 17.68125 17.49691
##  [729] 17.40581 15.98998 16.98909 16.62700 16.80940 15.86383 17.48405 17.03081
##  [737] 16.46182 16.06585 16.28275 16.35536 16.64192 17.25586 17.14385 15.28296
##  [745] 16.88277 17.04900 16.51647 16.80045 17.03180 15.58833 15.83423 16.27429
##  [753] 17.09833 16.14325 17.22260 16.63649 16.50760 16.60789 16.70458 16.50868
##  [761] 17.30587 17.05021 16.21258 16.39001 16.19909 16.50069 17.19249 16.54396
##  [769] 17.56024 17.01114 16.89944 16.12434 16.58944 16.52147 17.00033 16.43708
##  [777] 16.02595 16.07578 16.55887 16.52394 15.85640 17.03190 17.34103 17.41698
##  [785] 16.27320 15.91875 16.48158 17.46042 17.51108 16.35286 16.77062 16.48599
##  [793] 16.72312 17.31181 16.07275 15.72165 17.16926 17.32051 16.89491 16.62822
##  [801] 17.01115 16.37084 16.12324 17.83333 16.05555 15.38466 17.21237 17.30975
##  [809] 16.71356 16.73145 17.56062 16.65791 16.12143 16.79715 16.50287 16.87419
##  [817] 16.96025 16.68269 17.04287 16.75458 16.48178 16.79741 17.45758 16.65515
##  [825] 17.17917 17.40719 16.41046 16.91729 15.70365 17.31044 17.25410 16.78650
##  [833] 16.38805 16.69747 16.43540 17.05249 16.76991 16.90452 16.63552 16.93199
##  [841] 17.15012 16.14041 17.25313 17.71210 17.57161 16.65153 16.24913 16.35281
##  [849] 16.78632 16.40571 16.26677 17.22347 17.27656 17.00094 17.37401 16.28819
##  [857] 15.80487 17.06161 16.91467 17.23262 16.40746 16.82565 16.03394 17.11749
##  [865] 17.21168 16.75113 17.27095 17.23839 17.27505 17.22773 16.84900 16.23501
##  [873] 17.41735 15.79513 17.24155 17.66714 16.61896 16.47522 17.48019 17.25277
##  [881] 16.75882 16.34438 17.32721 16.76092 16.25335 17.10654 17.85040 17.38365
##  [889] 16.74501 17.19499 15.65981 17.10181 16.70042 16.83165 17.24912 16.89086
##  [897] 16.51408 16.57233 16.23706 16.39943 16.82704 17.46186 17.33337 16.81203
##  [905] 16.57303 16.18194 17.01169 16.50243 16.81371 16.49241 17.05909 17.12803
##  [913] 16.48085 17.71828 16.41684 16.61332 17.81266 17.55997 16.10346 16.80757
##  [921] 16.72565 16.85029 17.57266 16.69815 17.77317 16.88347 17.31666 17.38245
##  [929] 16.71139 17.78796 17.46005 16.22178 16.91866 16.24808 16.54747 16.77779
##  [937] 16.30747 16.93671 16.57135 16.64717 16.29048 16.49133 16.08467 16.19816
##  [945] 16.84333 16.01256 16.95237 17.25605 17.30110 16.67069 17.18615 16.81070
##  [953] 17.07441 16.82427 17.75016 17.77161 17.12579 16.15967 16.32598 16.71931
##  [961] 17.36472 16.91306 16.49229 16.37570 17.18497 16.83517 17.41335 16.25491
##  [969] 17.36015 17.37834 18.10737 16.20733 16.36659 16.68521 17.63915 16.65351
##  [977] 16.66799 17.04463 16.16653 16.65916 17.15032 16.80087 16.88071 16.64969
##  [985] 16.94993 15.87733 17.16749 17.45193 16.42774 16.76773 15.93248 17.49813
##  [993] 16.59596 16.95711 16.89192 16.92386 16.81038 17.22405 16.06465 15.77358
## 
## $boot_sds
##    [1] 5.669277 5.508349 5.109292 5.592562 6.218733 5.307864 5.809315 4.899424
##    [9] 7.208243 5.458417 5.734239 4.787992 4.516531 4.370137 5.286856 5.800177
##   [17] 5.012863 6.309766 6.045292 4.921840 4.673309 5.287436 4.765139 5.333925
##   [25] 6.166147 7.541317 5.889731 4.904010 4.612772 6.218395 5.467560 6.223837
##   [33] 5.110560 5.358854 5.606700 4.684122 5.612416 5.286019 5.809526 4.989274
##   [41] 4.965773 5.390094 6.211669 4.988085 5.884405 4.482961 5.509400 5.508933
##   [49] 5.697158 6.150458 5.484107 5.240583 5.781409 5.269203 5.384987 5.139572
##   [57] 5.943782 4.249527 5.080733 5.045971 4.922043 6.608014 5.948594 5.553118
##   [65] 4.976964 5.355675 4.964096 6.008930 5.070808 6.479337 4.972689 5.282599
##   [73] 5.821185 5.946350 5.936063 4.199516 4.827795 5.030317 4.828092 5.089822
##   [81] 4.484215 5.390550 5.421295 5.395197 5.434002 5.001402 5.002902 5.750827
##   [89] 5.242838 5.182797 4.388755 5.821155 4.434183 5.559507 5.128159 5.043826
##   [97] 5.552359 5.036931 5.960320 5.894778 6.012889 5.387769 6.143185 5.525135
##  [105] 5.526565 5.687884 5.401752 4.657631 5.584659 5.431086 4.983146 5.770939
##  [113] 6.389793 4.993723 5.616583 5.541819 5.836037 5.115144 5.328142 5.614901
##  [121] 5.235661 5.175439 5.683657 5.806004 3.830777 4.604799 4.632568 5.194978
##  [129] 6.276799 4.635780 4.910419 4.200274 5.927151 5.262476 5.440839 5.629381
##  [137] 6.151632 5.308700 4.284609 5.644680 7.164149 4.710861 5.635203 6.464585
##  [145] 5.086197 5.722234 5.553721 5.192437 5.178818 4.574973 6.112224 5.277278
##  [153] 4.521001 5.271763 5.571575 5.213318 5.089882 4.710150 5.167669 5.327717
##  [161] 5.131110 4.971960 5.510781 5.199150 5.581366 6.136668 6.100888 5.954844
##  [169] 4.420062 4.675947 5.592506 4.532860 6.757629 5.800709 5.963455 5.769346
##  [177] 6.269866 5.809664 5.200662 5.039870 5.733799 5.072235 4.458281 6.198105
##  [185] 5.729800 5.429180 5.067705 5.838539 5.766541 4.838142 5.299943 4.888502
##  [193] 4.977343 5.155639 5.993686 4.683699 5.345948 5.354408 5.474036 5.141078
##  [201] 5.426939 4.957163 5.290081 6.342756 5.299247 5.230104 5.339983 5.294244
##  [209] 5.480981 4.924739 4.850202 6.206263 4.726634 4.880705 5.603770 5.397005
##  [217] 5.271676 5.825731 5.439690 5.806685 5.629737 4.517182 5.170393 5.527755
##  [225] 4.970875 5.600942 4.828678 4.757029 6.367782 5.643383 5.333641 5.731101
##  [233] 5.375504 5.727543 5.263414 5.331891 4.877895 5.380011 5.278720 5.132609
##  [241] 5.246073 5.914658 4.903399 5.124540 5.493577 5.042939 5.275788 5.729057
##  [249] 5.036021 6.904192 4.350137 6.367434 4.988176 6.164236 5.472143 5.914742
##  [257] 5.764948 5.167117 6.218050 4.759078 4.771939 4.806167 5.866601 5.896364
##  [265] 4.941511 4.669679 5.971075 4.799473 5.631947 4.521371 6.837624 5.758999
##  [273] 5.699130 4.780147 4.899566 4.734375 4.811192 5.860145 5.191585 5.440233
##  [281] 5.391730 5.283298 5.702956 5.509921 5.379408 4.849132 5.293163 5.080530
##  [289] 5.765737 5.520168 5.022043 6.601782 4.804895 5.359011 5.331187 5.624267
##  [297] 5.964134 6.095333 4.878584 5.053382 6.151942 5.293009 5.096226 5.473060
##  [305] 6.292115 5.485447 5.918487 4.719922 4.920197 6.103356 4.522213 4.897352
##  [313] 5.901608 5.450349 5.400803 5.258577 5.667187 5.583343 4.609447 4.676833
##  [321] 4.848359 4.583381 5.296744 5.998544 4.556362 4.600910 6.177752 5.309240
##  [329] 6.265441 5.983669 4.853106 5.155831 5.856315 5.095427 5.026916 6.093716
##  [337] 4.978370 5.587803 5.540588 6.197822 5.028848 6.180398 5.893777 6.281222
##  [345] 6.130393 4.513786 4.579872 4.650598 5.067987 4.967956 5.323755 5.650343
##  [353] 5.849026 5.313498 4.906459 4.447321 5.861254 6.091417 4.123884 6.350824
##  [361] 5.482860 5.161626 4.920577 5.218523 4.882035 5.684609 5.548581 4.424046
##  [369] 5.117988 5.255800 4.603356 5.896842 5.236412 5.419099 4.984052 6.166173
##  [377] 4.776923 4.957308 4.269468 4.954452 5.977942 5.178662 5.485672 4.636163
##  [385] 4.988910 6.224789 4.578611 5.346970 6.201602 5.464458 5.324962 5.623781
##  [393] 4.989653 6.153749 5.100176 5.503797 5.500942 5.284042 5.156966 4.451290
##  [401] 5.256292 5.566409 5.771891 5.136844 5.900659 6.050755 5.169927 6.328945
##  [409] 5.492473 5.405024 5.059255 5.723359 5.265623 6.271261 4.949182 7.129772
##  [417] 5.881810 5.605255 5.309854 5.696762 4.723416 4.854296 6.813987 5.571711
##  [425] 5.203545 4.551869 5.399752 6.829664 6.013998 4.936658 5.778855 5.167203
##  [433] 5.464527 7.403815 5.185640 6.047474 5.283099 4.964649 4.989754 7.124428
##  [441] 5.424114 6.175196 4.385240 5.295086 4.797235 4.799827 6.068061 5.402460
##  [449] 5.521802 5.323645 4.570692 5.180087 6.748420 5.474827 5.070344 5.494117
##  [457] 5.110445 5.106421 5.354015 5.712631 6.631424 4.658070 4.409409 6.629541
##  [465] 4.272344 5.452437 5.461192 5.414471 5.611960 6.624689 5.271773 4.485324
##  [473] 5.212952 5.350564 7.157857 5.090671 5.008218 5.245716 4.583362 7.013320
##  [481] 4.863126 5.253252 5.328005 4.919722 5.923461 6.215878 5.059282 6.334903
##  [489] 5.554206 5.457689 5.188770 5.887731 4.708679 5.503981 5.876050 4.336783
##  [497] 5.135768 5.868140 4.716863 4.978146 5.451158 5.755857 4.689894 5.232387
##  [505] 4.854791 5.365999 6.076017 6.199493 5.712603 5.183190 5.882318 4.640416
##  [513] 5.090225 5.067805 5.378030 5.394058 4.815639 5.383901 5.640261 5.539075
##  [521] 5.774063 5.803984 5.234692 5.036079 5.756800 5.213564 5.759884 4.810051
##  [529] 5.287736 4.377561 5.479318 5.817777 5.607851 5.870763 5.046783 7.079340
##  [537] 5.943646 5.636244 4.405085 5.521177 4.743231 6.151499 5.620904 6.131311
##  [545] 6.212100 6.379826 5.027431 4.299669 6.029650 4.692239 5.501436 5.232692
##  [553] 5.512188 5.169933 4.745413 6.374946 4.483546 4.976842 5.130401 5.171314
##  [561] 5.711356 4.820799 5.565019 4.904573 6.079394 5.639810 5.008685 6.574868
##  [569] 5.077572 5.788692 5.582009 5.831385 6.473742 5.525588 4.674388 6.277478
##  [577] 5.457228 5.134932 5.254777 5.280763 6.370609 4.746569 6.702959 4.441044
##  [585] 5.402938 5.486513 4.774802 5.405532 5.348135 4.387420 5.229502 5.727109
##  [593] 4.848545 5.148096 5.317991 5.866329 5.608382 5.200758 4.730587 5.734057
##  [601] 4.648363 6.028897 4.823451 5.983127 6.173709 5.597542 5.471962 5.994143
##  [609] 5.466635 5.538418 5.766781 4.885262 4.364738 4.229628 5.927275 5.206026
##  [617] 5.235118 5.507960 5.774346 5.677519 5.826407 5.699112 4.434282 4.701402
##  [625] 4.776380 5.746310 5.183075 5.629900 6.689166 5.421475 4.711610 5.465945
##  [633] 5.344789 5.544690 5.824884 4.891975 4.807112 6.173533 6.638182 5.683000
##  [641] 5.470535 5.168283 5.355560 5.657620 6.754150 5.793173 4.391000 5.138299
##  [649] 5.328578 5.226187 5.061057 5.161344 4.326504 6.196131 5.244858 5.402221
##  [657] 5.249255 5.212731 5.661118 5.152801 5.642794 4.671450 4.745872 4.326684
##  [665] 4.369963 4.706802 5.633828 4.764238 5.233685 5.317111 6.181375 5.352984
##  [673] 5.454328 5.739937 4.651983 5.586526 4.788429 6.232803 5.912870 4.882808
##  [681] 4.766566 5.372578 5.688828 5.531410 6.393524 5.659014 4.799702 6.009258
##  [689] 4.976536 5.702702 5.358783 5.650916 5.346163 5.549276 5.177960 6.290433
##  [697] 4.596657 5.463897 5.260796 5.443653 5.047310 5.335428 4.987661 4.858318
##  [705] 4.757633 5.129332 4.739391 4.879813 5.107134 5.176180 4.976160 5.026081
##  [713] 5.940426 5.414094 5.518971 6.019646 5.076985 5.674127 5.770418 5.292967
##  [721] 5.625585 5.759935 5.311945 5.954033 6.555496 4.147820 5.819625 6.090065
##  [729] 6.134194 5.198282 4.992998 5.224920 5.449490 5.070488 6.791194 5.980633
##  [737] 5.526554 4.738035 5.724984 4.955818 4.335746 5.299554 5.572962 3.928956
##  [745] 5.542717 6.781290 5.363506 5.023968 5.456428 4.669658 4.520462 4.698122
##  [753] 5.825826 4.554776 6.239634 4.984078 5.016275 4.842027 5.340701 5.066770
##  [761] 4.740747 5.768880 4.420328 4.866768 5.145507 5.207574 4.857123 5.441289
##  [769] 6.018195 5.663919 6.231833 4.436492 4.799239 5.205218 5.623671 5.579470
##  [777] 5.138087 4.648234 5.583077 5.934273 5.012666 5.175324 5.392028 6.088239
##  [785] 5.566350 4.832211 4.986781 5.028612 6.621569 5.385924 5.070501 4.966112
##  [793] 4.922910 6.751244 5.883182 4.427529 4.812153 5.754551 5.492683 5.665022
##  [801] 6.270733 4.847259 5.361722 6.305133 5.020333 4.132316 5.554914 5.720932
##  [809] 5.113226 5.512151 4.828679 5.748620 4.960810 5.047562 5.138460 5.485067
##  [817] 5.651207 5.541642 5.668446 4.955661 5.478733 5.356003 5.855924 4.676071
##  [825] 5.361941 5.690742 5.058681 6.342585 4.992347 5.856523 5.411070 5.522183
##  [833] 5.441917 4.752670 5.029355 4.836602 5.103580 6.022040 4.911669 5.679807
##  [841] 5.603809 5.268540 5.620898 5.467441 6.263353 5.238356 4.979048 5.298593
##  [849] 5.532087 5.316271 4.806540 5.613797 6.437276 5.100534 5.771849 5.500963
##  [857] 4.644098 6.346342 4.998152 6.258803 4.885733 5.257972 4.907668 5.834090
##  [865] 5.628843 4.607551 4.976500 5.912440 4.987278 6.422970 5.252544 5.063119
##  [873] 5.707828 4.966361 6.139665 6.129768 5.528423 5.364742 5.228927 5.554111
##  [881] 5.333567 4.520847 6.915562 5.534831 4.553030 6.127977 5.732583 5.691569
##  [889] 5.397207 5.370761 4.194879 6.090362 6.023668 4.954548 5.855418 5.740738
##  [897] 5.781743 5.898722 4.965829 4.860532 5.406209 5.850886 6.171433 6.382992
##  [905] 6.008717 5.324333 5.336358 5.311892 5.687700 6.138380 5.833875 4.565804
##  [913] 5.034039 6.078434 5.699993 6.227087 6.614332 6.241631 4.683072 4.769359
##  [921] 5.553602 5.570636 6.113072 5.203345 6.358322 5.233606 5.981362 5.437194
##  [929] 5.373023 6.445970 5.450706 5.173852 5.884422 5.120039 4.137771 6.010202
##  [937] 4.689393 5.282002 5.746122 5.146727 5.150762 5.701440 4.303148 4.384523
##  [945] 5.273475 4.913457 5.955601 5.233602 6.220879 5.392120 5.894625 5.624605
##  [953] 5.506664 5.555204 5.782561 5.597667 5.155400 4.753986 5.034780 5.355396
##  [961] 5.890781 5.648098 5.440233 4.720862 5.398098 5.701697 5.585825 5.559383
##  [969] 5.782810 6.160241 6.700965 5.022354 4.502207 5.252153 6.225580 5.668936
##  [977] 4.842923 4.613594 5.153302 5.286457 4.624214 5.165064 5.177915 5.012724
##  [985] 5.958666 4.974962 5.751360 6.436998 5.150759 5.902501 5.145397 6.304228
##  [993] 5.138148 5.689785 5.837269 5.418062 5.883751 5.743026 4.932924 4.437218</code></pre>
<p>The <em>estmeansd</em> library uses Box-Cox method for estimating mean and sd when the data available are the median, minimum and maximum values.</p>
<div class="sourceCode" id="cb663"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb663-1"><a href="statistics.html#cb663-1" tabindex="-1"></a><span class="fu">library</span>(estmeansd)</span>
<span id="cb663-2"><a href="statistics.html#cb663-2" tabindex="-1"></a></span>
<span id="cb663-3"><a href="statistics.html#cb663-3" tabindex="-1"></a>res_bc <span class="ot">&lt;-</span> <span class="fu">bc.mean.sd</span>(<span class="at">min.val =</span> <span class="dv">13</span>, <span class="at">med.val =</span> <span class="dv">16</span>, <span class="at">max.val =</span> <span class="dv">42</span>, <span class="at">n =</span> <span class="dv">230</span>)</span>
<span id="cb663-4"><a href="statistics.html#cb663-4" tabindex="-1"></a>res_bc </span></code></pre></div>
<pre><code>## $est.mean
## [1] 16.79758
## 
## $est.sd
## [1] 3.55326</code></pre>
<p>Again, the standard error from the mean can be estimated using <em>get_SE</em> function.</p>
<div class="sourceCode" id="cb665"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb665-1"><a href="statistics.html#cb665-1" tabindex="-1"></a><span class="fu">get_SE</span>(res_bc)</span></code></pre></div>
<pre><code>## $est.se
## [1] 0.3205701
## 
## $boot_means
##    [1] 16.53855 17.16172 16.84746 17.26769 16.99600 16.40070 16.68867 17.35319
##    [9] 16.47715 17.00054 16.39592 16.69787 16.44430 16.38637 16.66363 16.75555
##   [17] 16.38342 16.23480 16.87008 16.97730 16.78287 17.20991 16.83006 16.95592
##   [25] 16.86877 16.84598 16.60542 16.58883 16.95352 16.92830 16.93559 16.73365
##   [33] 16.77089 16.67140 16.62247 16.49510 16.67180 16.80927 16.62490 15.93154
##   [41] 16.66524 16.44965 16.62981 16.60464 17.02054 16.82034 16.91287 16.74723
##   [49] 16.66625 17.49421 16.50913 16.87404 16.82580 16.75653 16.48956 17.39532
##   [57] 16.81609 16.78995 16.78702 16.75310 16.30938 16.46533 16.66659 16.92389
##   [65] 17.06997 16.87719 16.92230 16.68844 17.48527 16.32999 16.79631 16.49076
##   [73] 16.19053 16.54338 16.25810 16.68725 16.95426 16.44348 16.79267 16.91964
##   [81] 16.73076 16.78680 16.86212 16.06615 16.72927 17.29613 16.73062 16.74869
##   [89] 16.87979 17.22999 16.93810 16.85754 16.50604 17.26425 17.05474 16.57540
##   [97] 16.57971 16.35133 17.10891 16.45547 16.98462 16.91321 17.20115 16.18121
##  [105] 16.70763 16.65684 16.64388 16.59314 16.66566 16.98533 16.57492 16.68456
##  [113] 16.57619 16.75280 16.26121 16.63337 16.63603 16.61777 16.61831 16.77074
##  [121] 17.01998 16.91911 16.19127 16.89146 16.66941 16.47426 16.52808 16.34024
##  [129] 16.57619 17.01093 16.87493 16.66116 17.24104 16.65463 16.54245 16.89663
##  [137] 16.43957 16.53284 16.41137 16.73323 16.84514 16.97399 16.50004 16.36682
##  [145] 17.58424 16.57811 16.98137 17.13612 17.02551 16.50712 17.07327 16.68845
##  [153] 17.21339 16.45472 16.78635 17.01873 16.86124 17.01979 17.57762 17.38581
##  [161] 16.95522 16.64946 16.53337 16.30763 17.12675 16.61160 16.24340 16.18296
##  [169] 16.31539 17.45131 16.48885 16.44105 16.41080 16.87243 16.80773 16.78233
##  [177] 17.59130 16.80066 16.70148 16.85155 15.99938 16.66576 16.91393 17.10593
##  [185] 16.67805 17.24849 17.08898 16.80091 16.97568 16.87842 16.04852 16.98980
##  [193] 16.66124 17.40186 17.11418 16.82154 16.45975 16.91878 16.90580 16.60889
##  [201] 17.04261 16.97740 16.07934 16.91153 17.16160 17.36845 16.50313 16.44434
##  [209] 15.97912 16.34016 17.04500 16.74651 16.64481 16.60668 17.35666 16.36980
##  [217] 16.72280 16.72994 16.43293 17.06585 16.19975 16.46764 16.43989 16.36782
##  [225] 16.89052 16.66596 16.49836 16.75542 16.27259 16.76577 16.56546 16.86976
##  [233] 17.45279 16.85679 16.36821 16.70041 16.82832 16.82165 16.52397 16.69180
##  [241] 16.85287 17.43722 16.97074 16.58651 16.80781 17.16289 16.39103 16.75512
##  [249] 16.70298 16.12409 16.57071 16.59783 16.72044 16.60326 17.41887 16.78927
##  [257] 16.82112 17.19037 16.90375 16.65312 16.69827 16.88650 16.99641 16.26481
##  [265] 17.61130 16.26185 16.90153 16.52740 16.27028 16.30841 16.13914 16.91849
##  [273] 16.53002 16.63420 17.01184 16.83995 16.35769 17.73087 17.08429 16.17307
##  [281] 16.31304 16.87439 16.57657 17.04146 16.79446 16.61271 17.24376 17.48078
##  [289] 17.21659 16.93817 16.76901 16.98844 16.42593 16.59620 17.08517 15.93534
##  [297] 16.70427 16.50899 17.20000 16.61374 16.45964 16.58178 16.94086 16.50045
##  [305] 16.92374 16.70634 17.32533 16.63394 17.09020 16.88262 16.74967 16.48891
##  [313] 16.70368 17.00154 16.94325 17.55367 16.52266 16.87129 16.56381 16.82900
##  [321] 16.49188 16.50112 16.35215 16.78986 17.05724 17.04876 16.46678 16.75387
##  [329] 16.83788 16.50994 17.22934 16.91485 16.75861 16.70543 16.57665 17.07566
##  [337] 16.33382 16.22257 16.41514 16.55596 16.28800 16.80832 16.45164 16.63319
##  [345] 16.99973 16.76991 16.91269 15.84668 16.63956 17.21127 16.44080 16.62879
##  [353] 16.27920 17.32064 17.17510 16.74287 16.30417 16.22639 16.62527 17.19106
##  [361] 16.77408 16.46416 16.38475 16.85188 16.34296 16.46744 16.66397 16.76002
##  [369] 16.57630 17.14154 17.14472 16.78590 16.81236 17.20877 16.96504 16.60864
##  [377] 16.59647 16.65335 16.43910 16.54059 17.00116 16.85956 16.46515 16.42995
##  [385] 16.80363 16.92683 16.69778 16.54053 16.98770 16.97023 16.85020 16.69776
##  [393] 16.28644 16.89407 16.63712 16.99794 17.37501 16.60677 16.20686 16.87880
##  [401] 16.72866 16.55884 17.41405 16.73812 16.33178 16.70866 16.42742 17.00698
##  [409] 17.12601 17.00999 16.09743 16.45393 16.93042 16.44671 16.56388 16.86672
##  [417] 17.09565 16.68177 16.88781 16.41674 16.91354 16.56384 17.01849 16.91459
##  [425] 16.82336 16.63678 16.79713 16.36969 16.55402 17.24652 16.55832 16.70857
##  [433] 16.45813 16.71766 16.15417 16.87398 17.09179 17.34970 16.03713 16.77874
##  [441] 16.93939 16.41906 17.02958 17.29291 16.83049 16.95867 16.79623 16.56573
##  [449] 16.18661 16.42823 16.57685 16.81509 16.64287 16.33198 17.06193 16.88795
##  [457] 17.20158 16.42243 16.53874 16.29512 16.86825 16.51289 16.25547 17.59550
##  [465] 16.46574 16.98028 16.87928 16.72743 16.93192 16.69974 16.20907 16.35610
##  [473] 16.75804 17.30029 16.27646 16.54585 16.64614 17.08898 16.79712 16.62315
##  [481] 16.80776 16.68444 16.70655 16.42536 16.45076 16.85026 16.76346 16.02125
##  [489] 16.63515 16.72259 16.50896 16.53770 16.89143 16.62332 16.74160 17.08960
##  [497] 16.66772 16.68881 17.19268 16.80055 16.24587 16.69284 16.91328 16.97079
##  [505] 17.23166 16.75629 16.72728 16.84957 17.18293 16.75162 16.53064 16.81658
##  [513] 17.37288 16.95564 16.97942 16.30128 16.95140 16.17717 16.97443 16.74296
##  [521] 16.06306 17.05833 16.70495 17.01067 17.13317 16.26225 16.53278 17.04944
##  [529] 17.16689 16.57463 16.57686 16.91833 17.00159 16.76320 16.45295 17.06668
##  [537] 16.95356 16.62142 16.58989 16.54457 16.75465 16.59303 17.33738 16.98726
##  [545] 16.74079 17.08002 17.52354 17.00695 16.63873 16.86840 17.05941 16.20607
##  [553] 16.77003 17.09665 16.36659 16.29592 17.27293 16.52558 16.56473 16.96997
##  [561] 16.73457 17.09508 17.04982 16.85959 17.12244 16.72838 16.84402 16.63024
##  [569] 17.15018 16.68805 16.40171 16.24654 16.93218 16.51877 16.56053 16.47154
##  [577] 16.76290 16.78370 16.82536 16.91974 16.90697 17.18609 16.88057 16.52285
##  [585] 16.58904 17.07108 16.86712 17.11078 17.03025 17.27089 16.82204 16.55879
##  [593] 16.18616 16.62181 16.18040 17.35674 16.93192 16.75632 16.33962 16.24811
##  [601] 16.53597 17.01370 17.08313 16.65155 16.41650 16.62042 17.63284 16.85070
##  [609] 17.08466 17.15669 16.67650 16.90798 16.61464 16.69729 16.74704 16.99223
##  [617] 16.03040 16.38397 16.69972 16.37385 16.46408 16.78507 16.82286 17.26449
##  [625] 16.52820 16.52097 16.31231 17.00347 16.67405 16.31182 17.24908 16.88176
##  [633] 16.61917 16.54371 16.52864 16.32499 16.82075 17.12744 16.58330 16.83755
##  [641] 16.88958 16.65966 16.49005 16.35749 17.27677 16.89294 16.91755 17.29921
##  [649] 16.99591 16.77837 16.64829 16.41495 16.85533 16.67611 16.53016 17.20072
##  [657] 16.80568 16.58739 16.66256 17.01658 16.81588 16.83454 16.63970 16.64056
##  [665] 16.58912 16.61000 16.71940 16.44156 16.65449 16.39220 16.73003 16.60433
##  [673] 16.30743 16.56417 16.46866 17.41333 16.70161 17.04962 16.64505 16.77791
##  [681] 16.28411 17.45500 16.56972 16.30032 16.78049 16.85370 16.50799 16.49343
##  [689] 16.77566 16.84470 16.79258 17.20513 16.58204 17.01063 16.49107 17.27522
##  [697] 16.65469 16.98143 16.37711 17.03650 16.81945 17.07990 17.12262 17.04473
##  [705] 17.21986 16.71860 16.73482 16.57666 16.21299 16.21796 16.83238 16.40304
##  [713] 17.09325 17.13426 17.51818 16.37279 16.36719 16.56970 16.59251 16.50954
##  [721] 16.13266 16.28158 16.68655 17.09932 16.81514 16.70357 17.13596 17.16315
##  [729] 16.44675 16.87608 17.53992 16.49330 16.61133 16.43561 16.77096 16.62205
##  [737] 17.12499 16.55397 16.70515 16.32328 16.37555 16.36005 16.79047 16.73589
##  [745] 17.17424 16.61543 16.53134 16.67769 16.80384 17.72711 17.09926 16.86718
##  [753] 16.58203 16.95534 16.84390 16.62682 17.43345 16.62394 16.68643 16.62093
##  [761] 16.61046 16.55967 17.32239 16.52509 16.68021 16.43799 16.55776 16.71809
##  [769] 16.90588 16.44841 16.71535 16.68477 16.24259 17.38700 16.60268 16.19083
##  [777] 17.04780 17.32151 17.12372 17.23477 16.14405 16.81900 16.44705 16.78686
##  [785] 16.57265 16.88697 16.93324 16.78947 17.03214 16.74314 16.35234 16.77726
##  [793] 16.74788 16.63040 16.73047 16.80866 16.75775 16.41231 16.52820 16.55294
##  [801] 16.94417 16.61315 16.69209 16.69553 16.73042 16.42600 16.75757 16.77259
##  [809] 16.50340 17.26800 17.56690 17.48551 16.99716 16.38607 16.86259 16.65736
##  [817] 16.01072 16.57075 17.25219 16.27594 16.84225 17.01023 16.85623 17.09193
##  [825] 16.97508 16.67744 16.29909 16.36915 16.70713 16.88203 16.82178 16.67299
##  [833] 16.68475 16.62981 16.79068 17.14429 16.99612 16.85191 16.18978 17.15278
##  [841] 16.86382 16.30639 16.59065 16.77665 16.79838 17.52718 16.80842 16.52150
##  [849] 16.45441 17.31924 16.37601 16.86478 17.00703 16.73604 17.11461 16.55661
##  [857] 16.85795 17.58087 16.40591 16.57667 16.48227 16.14566 16.25445 16.66272
##  [865] 16.86025 16.36558 16.44958 16.74411 17.57601 16.60048 17.04629 16.36936
##  [873] 16.85287 17.02311 16.13828 16.76895 16.22488 17.29386 16.89654 16.44253
##  [881] 16.36088 16.42521 16.25618 16.81951 16.14763 16.59596 16.74590 16.66321
##  [889] 16.29463 16.61829 16.98271 17.00680 16.60846 17.90482 15.97628 16.46964
##  [897] 16.68703 17.12914 16.32559 16.50463 16.20398 16.72405 16.54268 16.54452
##  [905] 16.80625 16.77408 17.35981 17.20988 17.14160 17.01354 16.81230 17.00268
##  [913] 16.90444 16.03129 16.33793 16.60597 16.44810 16.50937 16.49090 17.02632
##  [921] 16.72954 17.19130 16.58994 16.68515 16.78762 16.65335 16.25103 16.61576
##  [929] 16.66212 16.15663 16.54025 16.77494 16.72628 16.34308 16.89130 17.23251
##  [937] 16.55938 17.19952 16.47165 16.59551 16.44614 16.55140 16.53338 16.97669
##  [945] 17.08316 17.06930 16.50562 17.06678 17.04878 17.35234 17.08521 16.98284
##  [953] 16.33376 16.67020 16.62487 16.96920 16.72940 16.89422 16.39369 16.49669
##  [961] 16.33677 16.81421 16.60117 16.67453 16.87237 16.15189 16.39754 16.95095
##  [969] 16.97305 16.93957 16.88274 17.20485 17.12793 16.90659 16.68984 16.56525
##  [977] 16.72233 16.95152 16.65042 16.63612 16.85717 17.26417 17.07524 17.14764
##  [985] 16.78829 16.78500 16.96694 16.78058 16.63431 16.62312 16.89596 15.95290
##  [993] 17.25899 16.37042 16.90438 16.77088 16.83227 16.40774 16.84319 17.30530
## 
## $boot_sds
##    [1] 3.118987 4.163065 3.128556 4.414611 3.148322 3.188415 3.725596 3.815345
##    [9] 3.295001 3.193677 2.932956 3.996721 3.554840 3.276219 3.942116 4.438661
##   [17] 3.146084 3.844850 3.578471 3.285201 3.681074 3.396531 3.939913 3.672212
##   [25] 3.602080 3.460095 3.725530 3.633079 3.637021 3.499506 4.182657 4.447087
##   [33] 3.563430 3.053956 2.790237 3.322588 3.849292 3.934436 3.235606 3.139550
##   [41] 3.177857 3.219842 3.471712 3.209160 3.439551 3.458910 3.799652 3.544368
##   [49] 3.326254 3.311608 3.786553 3.647347 3.886440 3.664727 3.971034 4.292380
##   [57] 3.364573 4.015752 4.242725 3.653404 3.957056 2.961019 4.589478 3.488343
##   [65] 2.923345 3.552948 3.166937 3.659141 3.836929 3.240932 3.437772 4.078031
##   [73] 3.176393 3.277664 3.031664 3.574772 3.245607 3.387335 3.383982 3.792103
##   [81] 3.166707 3.185255 3.506065 3.137258 3.726499 4.921487 4.128464 2.965131
##   [89] 3.334903 3.526653 3.967907 4.227845 2.924715 3.332416 3.447559 3.048612
##   [97] 3.279116 3.148415 3.131302 3.300176 3.773657 3.674933 3.495758 3.242525
##  [105] 3.241785 3.129741 3.479734 3.311229 3.786124 3.026715 3.341887 3.229260
##  [113] 3.394429 3.907436 3.008998 3.513573 4.592018 3.264007 3.749958 3.237355
##  [121] 3.644377 3.703527 3.459729 3.623364 3.700346 3.150374 4.019042 3.225063
##  [129] 3.292281 3.263260 3.361686 3.903848 3.342370 3.103534 3.196258 3.586507
##  [137] 3.614634 3.225977 3.777554 3.155560 3.608171 3.549442 3.900876 3.368888
##  [145] 4.375370 3.371478 3.767805 4.197004 4.800930 3.620741 3.245993 3.322718
##  [153] 3.305684 3.180256 4.377647 3.733152 3.919294 3.356327 4.203464 3.237790
##  [161] 3.706943 3.656021 3.209076 3.299195 3.858353 3.324814 3.357279 3.225331
##  [169] 4.069053 4.248276 3.337441 3.340431 2.932334 3.708356 3.644704 4.146012
##  [177] 3.872917 3.568760 3.662199 3.225777 3.471235 3.841336 3.669270 3.627439
##  [185] 3.863476 3.325282 3.616874 3.412842 3.264246 3.515025 3.482801 3.443151
##  [193] 3.800133 4.130488 3.684752 3.586173 3.825210 3.647537 4.211901 3.338031
##  [201] 3.865687 3.087841 3.522549 3.389937 3.467975 3.774182 3.170123 3.534840
##  [209] 3.145845 3.350964 3.329744 3.720835 3.288948 3.304608 4.157182 4.016206
##  [217] 3.801921 3.463236 3.532969 3.702967 3.357718 3.620354 3.409518 3.074793
##  [225] 3.167737 3.666926 3.371386 3.542923 3.575950 3.759391 3.660935 3.339519
##  [233] 3.565958 3.855118 3.502587 3.063387 3.681780 3.352655 3.738328 3.190810
##  [241] 4.018548 4.202359 4.579168 3.595463 3.253461 3.608764 3.208275 3.279187
##  [249] 3.612703 3.108001 3.812366 3.883920 3.543050 3.216997 4.355952 3.786057
##  [257] 3.831845 3.982452 3.076688 3.326354 3.994550 4.175213 3.993119 2.904822
##  [265] 4.514892 3.336604 3.508754 3.444661 3.215583 3.321991 3.540025 3.275536
##  [273] 2.976101 3.659662 3.491818 3.563882 3.731702 4.444019 3.678138 3.433753
##  [281] 3.436406 4.063923 3.568428 3.948396 3.586255 3.548033 4.475138 4.064073
##  [289] 3.987076 3.778768 2.941198 3.913860 3.422441 3.243213 3.982633 2.606049
##  [297] 3.803300 2.967660 3.450428 3.528557 3.763330 3.762533 3.884074 3.322007
##  [305] 3.591037 3.075114 3.287047 3.024668 2.903103 3.793205 3.736170 2.948312
##  [313] 3.647624 4.016274 3.214999 3.941508 3.190068 3.244006 2.969484 3.224098
##  [321] 3.223736 3.392360 3.022042 3.700285 3.747954 4.529422 3.355396 3.514875
##  [329] 3.584555 3.224535 3.209143 3.537813 3.537726 3.179197 4.054327 4.116803
##  [337] 3.799517 4.109948 3.527053 3.656271 3.157312 3.501181 3.174967 3.365993
##  [345] 3.707243 3.687623 3.578792 3.700536 3.546299 4.037100 3.153064 3.451813
##  [353] 2.857949 3.436809 4.006921 3.133981 4.097774 3.238112 4.472018 3.837248
##  [361] 3.752648 4.031678 3.207097 3.952260 3.841300 3.064667 3.481593 3.632395
##  [369] 3.555463 3.937891 3.757170 3.588698 3.224971 4.411578 3.441140 3.382864
##  [377] 3.412275 3.610479 3.706991 3.605517 3.435322 3.482241 3.776917 2.471138
##  [385] 3.877954 3.746296 4.044918 3.137228 4.296352 3.252496 4.395972 3.845298
##  [393] 2.916160 3.588316 3.299518 4.295507 4.231514 3.211429 3.083544 3.313296
##  [401] 3.338672 2.844508 5.357146 3.369121 3.013823 3.664124 3.601953 3.807833
##  [409] 4.186464 3.899122 3.374402 3.472775 4.124444 2.704622 3.704080 3.088549
##  [417] 3.421998 3.527346 3.420698 3.787314 3.525808 3.094170 3.767541 3.178563
##  [425] 3.329025 3.048923 3.543825 2.771965 3.979808 3.193702 3.529247 3.277842
##  [433] 3.711734 3.290287 2.826598 3.061304 3.545603 3.835289 3.559297 3.446547
##  [441] 3.227768 3.354204 3.573656 4.080881 3.668870 3.232701 3.408280 3.388841
##  [449] 3.000478 4.200759 3.015591 3.204726 3.419986 3.018675 3.749585 3.590599
##  [457] 3.501728 3.694471 3.908108 3.395668 3.653492 4.214351 3.391009 4.192764
##  [465] 3.330914 3.007578 3.174616 3.337904 3.985673 3.597662 3.469156 4.124810
##  [473] 3.440216 3.779942 3.149474 3.206994 3.717717 2.964454 3.758749 3.465989
##  [481] 3.572879 3.048722 3.377147 2.907331 3.546210 3.268712 3.918481 3.709996
##  [489] 3.515939 3.650927 3.165580 3.448082 3.532877 3.148674 3.726987 4.235096
##  [497] 2.973605 3.534796 4.676765 3.680225 3.385101 3.160067 3.420458 3.550816
##  [505] 3.628709 3.573380 3.416261 3.078745 4.538943 3.675143 3.979956 3.612985
##  [513] 3.353724 3.961077 3.167655 3.563828 3.454661 3.716835 4.238612 3.503887
##  [521] 3.539068 4.256376 3.444708 3.909036 3.432825 3.601240 3.232477 4.152649
##  [529] 3.426693 4.080111 3.275983 4.480541 4.023521 4.479208 3.094773 3.814674
##  [537] 3.753848 3.881275 3.501158 3.402910 3.580367 3.404145 3.421320 3.994291
##  [545] 3.488285 3.311375 4.520765 3.393344 3.270052 3.498358 3.893993 3.169597
##  [553] 3.517245 3.626044 3.354067 3.121941 4.054472 3.541987 3.216038 4.390514
##  [561] 3.500757 4.249832 3.517445 4.040855 3.310257 3.613353 3.748514 3.203501
##  [569] 3.095675 3.600397 3.197291 2.964320 3.643485 3.327415 3.474187 3.508507
##  [577] 3.734031 4.040932 3.499595 3.915037 3.349897 3.676118 3.871131 3.738276
##  [585] 3.530261 3.722852 3.215753 3.623688 3.350093 4.174209 4.390585 3.840236
##  [593] 3.205209 3.088567 3.504053 4.119746 3.629258 3.188122 4.029170 3.119552
##  [601] 2.724213 3.283157 3.687499 3.495507 3.545418 3.632420 3.617260 3.089800
##  [609] 3.448851 3.815123 3.864141 3.576108 2.957123 3.822953 3.968441 3.514251
##  [617] 3.443229 3.372122 3.437809 3.328136 3.370528 2.972444 3.362452 3.844060
##  [625] 3.477156 3.105480 3.093476 3.814944 2.732489 3.422670 3.311809 3.628504
##  [633] 3.924907 3.621896 3.433843 3.574093 3.796609 4.143671 3.342434 3.046264
##  [641] 3.915063 3.608841 4.042441 2.992725 4.082711 4.159978 3.473690 3.073568
##  [649] 3.610996 2.801086 4.314819 3.420548 3.599318 3.036653 3.050736 3.452617
##  [657] 3.868433 3.712222 3.687629 3.560925 3.638989 4.137417 3.045407 3.518634
##  [665] 3.268133 3.042585 3.514124 3.026890 3.879301 3.575761 3.673190 3.601999
##  [673] 3.418796 3.201171 3.512070 4.279431 3.578118 3.580666 3.463787 3.392937
##  [681] 2.897410 3.500506 3.454685 3.787164 3.443618 2.892461 3.703412 3.824615
##  [689] 3.781620 4.014250 3.490038 4.467898 3.627221 4.238716 3.395129 3.734122
##  [697] 3.576727 3.011816 3.238168 3.562170 3.340729 3.232838 3.947463 3.564143
##  [705] 3.580127 3.374502 3.051596 3.264161 3.389745 3.469605 3.517966 3.600020
##  [713] 4.568184 4.090798 3.629317 3.418889 3.277099 3.296048 3.381816 3.359149
##  [721] 3.678728 2.781492 3.483793 3.029115 3.852640 3.715701 4.384869 3.350746
##  [729] 4.383594 3.730887 5.010518 3.484131 3.897634 2.952767 3.728422 3.404896
##  [737] 3.920097 3.250025 3.936229 3.327491 3.522542 3.152616 4.077235 3.922923
##  [745] 4.301049 3.056477 3.260847 3.918645 3.725800 4.360867 3.800377 3.295639
##  [753] 3.687896 4.487209 3.683871 3.645308 4.536000 3.181836 3.526228 2.957789
##  [761] 3.054450 3.459777 3.713923 3.624116 3.611734 3.102458 3.188463 3.999205
##  [769] 4.067762 3.187847 3.301334 3.350096 3.389712 3.407689 3.813634 2.901006
##  [777] 3.456077 3.889696 3.410100 4.175085 3.381333 3.813575 3.358913 3.612962
##  [785] 3.478830 3.462849 3.684838 4.037834 4.254413 3.076452 3.248725 4.169198
##  [793] 3.341871 3.452452 3.031142 3.452577 3.244797 3.451686 3.144704 3.086348
##  [801] 3.649428 3.459956 3.164521 3.858200 3.186287 3.543517 3.921093 3.383810
##  [809] 3.497869 4.477916 4.196560 4.048334 3.146904 3.269685 3.222466 4.105588
##  [817] 3.093108 3.592807 4.839527 3.532504 3.758243 3.406233 3.865893 3.184751
##  [825] 3.884920 3.775399 2.626797 3.866526 3.944168 3.277670 3.361363 3.556576
##  [833] 3.815645 3.835566 3.386188 3.693580 3.693809 3.797821 3.060715 4.131278
##  [841] 4.069430 2.808481 3.606162 3.303872 3.279409 4.078712 4.182787 3.830369
##  [849] 3.889372 3.034410 2.912417 3.384432 3.445728 3.811673 3.379953 3.729324
##  [857] 3.838796 4.503273 3.797466 3.145575 2.945436 2.690332 3.464504 3.315750
##  [865] 3.153387 4.106080 3.904416 3.712526 4.784392 2.963245 4.204969 3.672814
##  [873] 2.909335 3.516471 3.519499 3.744623 3.062973 4.063158 3.367640 3.463387
##  [881] 3.067771 3.643033 3.666723 4.165302 3.223407 3.557592 3.375011 3.638411
##  [889] 3.702199 3.907633 3.636880 3.665414 3.170902 3.471467 3.219847 3.852063
##  [897] 3.151140 4.159883 3.528328 3.484913 3.220102 3.396601 3.735399 2.999186
##  [905] 3.688063 3.218958 4.259463 4.774786 3.885768 3.438824 3.491892 3.589522
##  [913] 3.616030 2.736361 3.240731 3.675236 2.868779 3.417071 3.528073 3.506961
##  [921] 4.423738 3.166902 3.673617 4.070319 3.300601 3.280591 3.131195 4.026948
##  [929] 3.373737 3.375605 3.366802 3.441325 2.968311 2.826515 3.314644 3.644018
##  [937] 4.015419 4.639231 3.343865 3.195881 3.268739 3.426043 2.991416 3.963460
##  [945] 3.436009 3.883516 3.237230 3.782727 4.832585 3.353586 3.262508 3.615530
##  [953] 3.385231 3.317174 3.505840 3.721540 4.010973 3.705451 3.865648 3.453823
##  [961] 3.855976 3.891238 2.983689 3.700195 3.011344 3.800488 3.807066 3.037438
##  [969] 3.222418 3.609108 3.437103 3.227223 3.721323 3.546616 3.263066 3.251939
##  [977] 4.111107 3.930736 3.602448 3.750272 3.751193 3.608419 3.439083 4.015285
##  [985] 3.037031 3.811253 3.577906 3.840151 3.728452 3.610627 3.503262 2.758456
##  [993] 3.774201 3.103596 3.693632 3.613589 3.896618 3.506989 3.759905 4.769135</code></pre>
</div>
<div id="inconsistency-i2" class="section level3 hasAnchor" number="4.9.4">
<h3><span class="header-section-number">4.9.4</span> Inconsistency I2<a href="statistics.html#inconsistency-i2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The inconsistency <span class="math inline">\(I^2\)</span> index is the sum of the squared deviations from the overall effect and weighted by the study size. Value &lt;25% is classified as low
and greater than 75% as high heterogeneity. This test can be performed using metafor package <span class="citation">(<a href="#ref-JSSv036i03">Viechtbauer 2010</a>)</span>. The presence of high <span class="math inline">\(I^2\)</span> suggests a need to proceed to meta-regression on the data to understand the source of heterogeneity. The fixed component were the covariates which were being tested for their effect on heterogeneity. The random effect components were the sensitivity and FPR. The <span class="math inline">\(I^2\)</span> value for the TIA clinic study is 34.41%. As such meta-regression is not needed for that study. By contrast, the <span class="math inline">\(I^2\)</span> is much higher for the spot sign study, necessitating metaregression.</p>
<div class="sourceCode" id="cb667"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb667-1"><a href="statistics.html#cb667-1" tabindex="-1"></a><span class="fu">library</span>(PRISMAstatement)</span>
<span id="cb667-2"><a href="statistics.html#cb667-2" tabindex="-1"></a></span>
<span id="cb667-3"><a href="statistics.html#cb667-3" tabindex="-1"></a><span class="co">#example from Spot sign paper. Stroke 2019</span></span>
<span id="cb667-4"><a href="statistics.html#cb667-4" tabindex="-1"></a><span class="fu">prisma</span>(<span class="at">found =</span> <span class="dv">193</span>,</span>
<span id="cb667-5"><a href="statistics.html#cb667-5" tabindex="-1"></a>       <span class="at">found_other =</span> <span class="dv">27</span>,</span>
<span id="cb667-6"><a href="statistics.html#cb667-6" tabindex="-1"></a>       <span class="at">no_dupes =</span> <span class="dv">141</span>, </span>
<span id="cb667-7"><a href="statistics.html#cb667-7" tabindex="-1"></a>       <span class="at">screened =</span> <span class="dv">141</span>, </span>
<span id="cb667-8"><a href="statistics.html#cb667-8" tabindex="-1"></a>       <span class="at">screen_exclusions =</span> <span class="dv">3</span>, </span>
<span id="cb667-9"><a href="statistics.html#cb667-9" tabindex="-1"></a>       <span class="at">full_text =</span> <span class="dv">138</span>,</span>
<span id="cb667-10"><a href="statistics.html#cb667-10" tabindex="-1"></a>       <span class="at">full_text_exclusions =</span> <span class="dv">112</span>, </span>
<span id="cb667-11"><a href="statistics.html#cb667-11" tabindex="-1"></a>       <span class="at">qualitative =</span> <span class="dv">26</span>, </span>
<span id="cb667-12"><a href="statistics.html#cb667-12" tabindex="-1"></a>       <span class="at">quantitative =</span> <span class="dv">26</span>,</span>
<span id="cb667-13"><a href="statistics.html#cb667-13" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">800</span>, <span class="at">height =</span> <span class="dv">800</span>)</span></code></pre></div>
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-62954e69c7decb8afc3d" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-62954e69c7decb8afc3d">{"x":{"diagram":"digraph prisma {\n    node [shape=\"box\", fontsize = 10];\n    graph [splines=ortho, nodesep=1, dpi = 72]\n    a -> nodups;\n    b -> nodups;\n    a [label=\"Records identified through\ndatabase searching\n(n = 193)\"];\n    b [label=\"Additional records identified\nthrough other sources\n(n = 27)\"]\n    nodups -> incex;\n    nodups [label=\"Records after duplicates removed\n(n = 141)\"];\n    incex -> {ex; ft}\n    incex [label=\"Records screened\n(n = 141)\"];\n    ex [label=\"Records excluded\n(n = 3)\"];\n    {rank=same; incex ex}\n    ft -> {qual; ftex};\n    ft [label=\"Full-text articles assessed\nfor eligibility\n(n = 138)\"];\n    {rank=same; ft ftex}\n    ftex [label=\"Full-text articles excluded,\nwith reasons\n(n = 112)\"];\n    qual -> quant\n    qual [label=\"Studies included in qualitative synthesis\n(n = 26)\"];\n    quant [label=\"Studies included in\nquantitative synthesis\n(meta-analysis)\n(n = 26)\"];\n  }","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="metaanalysis-of-proportion" class="section level3 hasAnchor" number="4.9.5">
<h3><span class="header-section-number">4.9.5</span> Metaanalysis of proportion<a href="statistics.html#metaanalysis-of-proportion" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is an example of metaanalysis of stroke recurrence following management in rapid TIA clinic. A variety of different methods for calculating the 95% confidence interval of the binomial distribution. The mean of the binomial distribution is given by p and the variance by <span class="math inline">\(\frac{p \times (1-p)}{n}\)</span>. The term <span class="math inline">\(z\)</span> is given by <span class="math inline">\(1-\frac{\alpha}{2}\)</span> quantile of normal distribution. A standard way of calculating the confidence interval is the Wald method <span class="math inline">\(p\pm z\times \sqrt{\frac{p \times(1-p)}{n}}\)</span>. The Freeman-Tukey double arcsine transformation tries to transform the data to a normal distribution. This approach is useful when occurence of event is rare. The exact or Clopper-Pearson method is suggested as the most conservative of the methods for calculating confidence interval for proportion. It is based on cumulative properties of the binomial distribution. The Wilson method has similarities to the Wald method. It has an extra term <span class="math inline">\(z^2/n\)</span>. There are many different methods for calculating the confidence interval for proportions. Investigators such as Agresti proposed that approximate methods are better than exact method <span class="citation">(<a href="#ref-doi:10.1080/00031305.1998.10480550">Agresti and Coull 1998</a>)</span>. Brown and colleagues proposed the use of the Wilson method <span class="citation">(<a href="#ref-brown2001">Brown, Cai, and DasGupta 2001</a>)</span></p>
<div class="sourceCode" id="cb668"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb668-1"><a href="statistics.html#cb668-1" tabindex="-1"></a><span class="fu">library</span>(metafor) <span class="co">#open software metafor</span></span>
<span id="cb668-2"><a href="statistics.html#cb668-2" tabindex="-1"></a><span class="co">#create data frame dat</span></span>
<span id="cb668-3"><a href="statistics.html#cb668-3" tabindex="-1"></a><span class="co">#xi is numerator</span></span>
<span id="cb668-4"><a href="statistics.html#cb668-4" tabindex="-1"></a><span class="co">#ni is denominator</span></span>
<span id="cb668-5"><a href="statistics.html#cb668-5" tabindex="-1"></a></span>
<span id="cb668-6"><a href="statistics.html#cb668-6" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model=</span><span class="fu">c</span>(<span class="st">&quot;melbourne&quot;</span>,<span class="st">&quot;paris&quot;</span>,<span class="st">&quot;oxford&quot;</span>,<span class="st">&quot;stanford&quot;</span>,<span class="st">&quot;ottawa&quot;</span>,<span class="st">&quot;new zealand&quot;</span>),</span>
<span id="cb668-7"><a href="statistics.html#cb668-7" tabindex="-1"></a><span class="at">xi=</span><span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">7</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">31</span>,<span class="dv">2</span>), </span>
<span id="cb668-8"><a href="statistics.html#cb668-8" tabindex="-1"></a><span class="at">ni=</span><span class="fu">c</span>(<span class="dv">468</span>,<span class="dv">296</span>, <span class="dv">281</span>,<span class="dv">223</span>,<span class="dv">982</span>,<span class="dv">172</span>))</span>
<span id="cb668-9"><a href="statistics.html#cb668-9" tabindex="-1"></a></span>
<span id="cb668-10"><a href="statistics.html#cb668-10" tabindex="-1"></a><span class="co">#calculate new variable pi base on ratio xi/ni</span></span>
<span id="cb668-11"><a href="statistics.html#cb668-11" tabindex="-1"></a>dat<span class="sc">$</span>pi <span class="ot">&lt;-</span> <span class="fu">with</span>(dat, xi<span class="sc">/</span>ni)</span>
<span id="cb668-12"><a href="statistics.html#cb668-12" tabindex="-1"></a></span>
<span id="cb668-13"><a href="statistics.html#cb668-13" tabindex="-1"></a><span class="co">#Freeman-Tukey double arcsine trasformation</span></span>
<span id="cb668-14"><a href="statistics.html#cb668-14" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">escalc</span>(<span class="at">measure=</span><span class="st">&quot;PFT&quot;</span>, <span class="at">xi=</span>xi, <span class="at">ni=</span>ni, <span class="at">data=</span>dat, <span class="at">add=</span><span class="dv">0</span>) </span>
<span id="cb668-15"><a href="statistics.html#cb668-15" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">rma</span>(yi, vi, <span class="at">method=</span><span class="st">&quot;REML&quot;</span>, <span class="at">data=</span>dat, <span class="at">slab=</span><span class="fu">paste</span>(model))</span>
<span id="cb668-16"><a href="statistics.html#cb668-16" tabindex="-1"></a></span>
<span id="cb668-17"><a href="statistics.html#cb668-17" tabindex="-1"></a><span class="co">#create forest plot with labels</span></span>
<span id="cb668-18"><a href="statistics.html#cb668-18" tabindex="-1"></a>metafor<span class="sc">::</span><span class="fu">forest</span>(res, <span class="at">transf=</span>transf.ipft.hm, <span class="at">targs=</span><span class="fu">list</span>(<span class="at">ni=</span>dat<span class="sc">$</span>ni), <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="fl">1.4</span>),<span class="at">refline=</span>res<span class="sc">$</span>beta[<span class="dv">1</span>],</span>
<span id="cb668-19"><a href="statistics.html#cb668-19" tabindex="-1"></a>       <span class="at">cex=</span>.<span class="dv">8</span>, <span class="at">ilab=</span><span class="fu">cbind</span>(dat<span class="sc">$</span>xi, dat<span class="sc">$</span>ni), </span>
<span id="cb668-20"><a href="statistics.html#cb668-20" tabindex="-1"></a>       <span class="co">#position of data on x-axis</span></span>
<span id="cb668-21"><a href="statistics.html#cb668-21" tabindex="-1"></a>       <span class="at">ilab.xpos=</span><span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">6</span>,<span class="sc">-</span>.<span class="dv">4</span>),<span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb668-22"><a href="statistics.html#cb668-22" tabindex="-1"></a></span>
<span id="cb668-23"><a href="statistics.html#cb668-23" tabindex="-1"></a><span class="co">#par function combine multiple plots into one</span></span>
<span id="cb668-24"><a href="statistics.html#cb668-24" tabindex="-1"></a>op <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">cex=</span>.<span class="dv">75</span>, <span class="at">font=</span><span class="dv">2</span>)</span>
<span id="cb668-25"><a href="statistics.html#cb668-25" tabindex="-1"></a><span class="co">#position of column names on x-axis</span></span>
<span id="cb668-26"><a href="statistics.html#cb668-26" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span><span class="fl">1.0</span>, <span class="fl">7.5</span>, <span class="st">&quot;model &quot;</span>,<span class="at">pos=</span><span class="dv">4</span>)</span>
<span id="cb668-27"><a href="statistics.html#cb668-27" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">55</span>,<span class="sc">-</span>.<span class="dv">2</span>), <span class="fl">7.5</span>, <span class="fu">c</span>(<span class="st">&quot;recurrence&quot;</span>, <span class="st">&quot; total subjects&quot;</span>))</span>
<span id="cb668-28"><a href="statistics.html#cb668-28" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">1.4</span>,<span class="fl">7.5</span>, <span class="st">&quot;Proportion [95% CI]&quot;</span>, <span class="at">pos=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-16-1.png" width="672" /></p>
<div class="sourceCode" id="cb669"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb669-1"><a href="statistics.html#cb669-1" tabindex="-1"></a><span class="fu">par</span>(op)</span></code></pre></div>
<p>Exact 95% confidence interval for proportion is provided below using the TIA
data above. This solution was provided on <em>stack overflow</em>. This is performed using the <em>binomial.test</em> function.</p>
<div class="sourceCode" id="cb670"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb670-1"><a href="statistics.html#cb670-1" tabindex="-1"></a><span class="co">#exact confidence interval</span></span>
<span id="cb670-2"><a href="statistics.html#cb670-2" tabindex="-1"></a><span class="fu">sapply</span>(<span class="fu">split</span>(dat, dat<span class="sc">$</span>model), <span class="cf">function</span>(x) <span class="fu">binom.test</span>(x<span class="sc">$</span>xi, x<span class="sc">$</span>ni)<span class="sc">$</span>conf.int)</span></code></pre></div>
<pre><code>##       melbourne new zealand     ottawa      oxford      paris    stanford
## [1,] 0.00603419 0.001411309 0.02154780 0.007875285 0.00955965 0.001087992
## [2,] 0.03057375 0.041370853 0.04451101 0.045893259 0.04811612 0.032020390</code></pre>
<p>The data needs to be transposed using <em>t</em> function. This generates one column
for lower and another for upper CI. Note that sapply returns a matrix or array
and the column names have to be assigned.</p>
<div class="sourceCode" id="cb672"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb672-1"><a href="statistics.html#cb672-1" tabindex="-1"></a><span class="co">#the data</span></span>
<span id="cb672-2"><a href="statistics.html#cb672-2" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">sapply</span>(<span class="fu">split</span>(dat, dat<span class="sc">$</span>model), <span class="cf">function</span>(x) <span class="fu">binom.test</span>(x<span class="sc">$</span>xi, x<span class="sc">$</span>ni)<span class="sc">$</span>conf.int))</span>
<span id="cb672-3"><a href="statistics.html#cb672-3" tabindex="-1"></a>tmp</span></code></pre></div>
<pre><code>##                    [,1]       [,2]
## melbourne   0.006034190 0.03057375
## new zealand 0.001411309 0.04137085
## ottawa      0.021547797 0.04451101
## oxford      0.007875285 0.04589326
## paris       0.009559650 0.04811612
## stanford    0.001087992 0.03202039</code></pre>
<p>The exact confidence is now put back into the dat data frame.</p>
<div class="sourceCode" id="cb674"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb674-1"><a href="statistics.html#cb674-1" tabindex="-1"></a>dat<span class="sc">$</span>ci.lb <span class="ot">&lt;-</span> tmp[,<span class="dv">1</span>] <span class="co">#adding column to data frame dat</span></span>
<span id="cb674-2"><a href="statistics.html#cb674-2" tabindex="-1"></a>dat<span class="sc">$</span>ci.ub <span class="ot">&lt;-</span> tmp[,<span class="dv">2</span>] <span class="co">#adding column to data frame dat</span></span>
<span id="cb674-3"><a href="statistics.html#cb674-3" tabindex="-1"></a></span>
<span id="cb674-4"><a href="statistics.html#cb674-4" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">escalc</span>(<span class="at">measure=</span><span class="st">&quot;PFT&quot;</span>, <span class="at">xi=</span>xi, <span class="at">ni=</span>ni, <span class="at">data=</span>dat, <span class="at">add=</span><span class="dv">0</span>) </span>
<span id="cb674-5"><a href="statistics.html#cb674-5" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">rma.glmm</span>(<span class="at">measure=</span><span class="st">&quot;PLO&quot;</span>, <span class="at">xi=</span>xi, <span class="at">ni=</span>ni, <span class="at">data=</span>dat)</span>
<span id="cb674-6"><a href="statistics.html#cb674-6" tabindex="-1"></a></span>
<span id="cb674-7"><a href="statistics.html#cb674-7" tabindex="-1"></a></span>
<span id="cb674-8"><a href="statistics.html#cb674-8" tabindex="-1"></a><span class="co">#insert the exact confidence interval </span></span>
<span id="cb674-9"><a href="statistics.html#cb674-9" tabindex="-1"></a><span class="fu">with</span>(dat, metafor<span class="sc">::</span><span class="fu">forest</span>(yi, <span class="at">ci.lb=</span>ci.lb, <span class="at">ci.ub=</span>ci.ub, </span>
<span id="cb674-10"><a href="statistics.html#cb674-10" tabindex="-1"></a>  <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span>,<span class="fl">8.5</span>), </span>
<span id="cb674-11"><a href="statistics.html#cb674-11" tabindex="-1"></a>  <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.1</span>,<span class="dv">1</span>), </span>
<span id="cb674-12"><a href="statistics.html#cb674-12" tabindex="-1"></a>  <span class="at">refline=</span><span class="fu">predict</span>(res, <span class="at">transf=</span>transf.ilogit)<span class="sc">$</span>pred,</span>
<span id="cb674-13"><a href="statistics.html#cb674-13" tabindex="-1"></a>  <span class="at">cex=</span>.<span class="dv">8</span>, </span>
<span id="cb674-14"><a href="statistics.html#cb674-14" tabindex="-1"></a>  <span class="at">ilab=</span><span class="fu">cbind</span>(dat<span class="sc">$</span>xi, dat<span class="sc">$</span>ni), </span>
<span id="cb674-15"><a href="statistics.html#cb674-15" tabindex="-1"></a>  <span class="at">ilab.xpos=</span><span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">6</span>,<span class="sc">-</span>.<span class="dv">2</span>),<span class="at">digits=</span><span class="dv">3</span>))</span>
<span id="cb674-16"><a href="statistics.html#cb674-16" tabindex="-1"></a>  </span>
<span id="cb674-17"><a href="statistics.html#cb674-17" tabindex="-1"></a>op <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">cex=</span>.<span class="dv">75</span>, <span class="at">font=</span><span class="dv">2</span>)</span>
<span id="cb674-18"><a href="statistics.html#cb674-18" tabindex="-1"></a><span class="fu">addpoly</span>(res, <span class="at">row=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">transf=</span>transf.ilogit)</span>
<span id="cb674-19"><a href="statistics.html#cb674-19" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span>
<span id="cb674-20"><a href="statistics.html#cb674-20" tabindex="-1"></a><span class="co">#position of column names on x-axis</span></span>
<span id="cb674-21"><a href="statistics.html#cb674-21" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span>.<span class="dv">9</span>, <span class="fl">7.5</span>, <span class="st">&quot;Model&quot;</span>, <span class="at">pos=</span><span class="dv">2</span>)</span>
<span id="cb674-22"><a href="statistics.html#cb674-22" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">55</span>,<span class="sc">-</span>.<span class="dv">2</span>), <span class="fl">7.5</span>, <span class="fu">c</span>(<span class="st">&quot;recurrence&quot;</span>, <span class="st">&quot; total subjects&quot;</span>))</span>
<span id="cb674-23"><a href="statistics.html#cb674-23" tabindex="-1"></a><span class="fu">text</span>( <span class="dv">1</span>,   <span class="fl">7.5</span>, <span class="st">&quot;Proportion [95% CI]&quot;</span>, <span class="at">pos=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/Statistics-16-3-1.png" width="672" /></p>
</div>
<div id="metaanalysis-of-continuous-data" class="section level3 hasAnchor" number="4.9.6">
<h3><span class="header-section-number">4.9.6</span> Metaanalysis of continuous data<a href="statistics.html#metaanalysis-of-continuous-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Metanalysis of continuous outcome data can be performed using standardised mean difference or ratio of means. It is available in the <em>meta</em> library using <em>metacont</em> function <span class="citation">(<a href="#ref-doi10.1136/ebmental-2019-300117">Balduzzi, Rcker, and Schwarzer 2019</a>)</span>.</p>
</div>
<div id="bivariate-metaanalysis" class="section level3 hasAnchor" number="4.9.7">
<h3><span class="header-section-number">4.9.7</span> Bivariate Metaanalysis<a href="statistics.html#bivariate-metaanalysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The univariate method of Moses-Shapiro-Littenberg combines these measures (sensitivity and specificity) into a single measure of accuracy (diagnostic odds ratio)<span class="citation">(<a href="#ref-pmid8210827">Moses, Shapiro, and Littenberg 1993</a>)</span> . This approach has been criticized for losing data on sensitivity and specificity of the test. Similar to the univariate method, the bivariate method employs a random effect to take into account the within study correlation <span class="citation">(<a href="#ref-pmid16168343">Reitsma et al. 2005</a>)</span>. Additionally, the bivariate method also accounts
for the between-study correlation in sensitivity and specificity. Bivariate analysis is performed using <em>mada</em> package. A <a href="bayesian-analysis.html#bayesian-metaanalysis">Bayesian library</a> for bivariate analysis <em>meta4diag</em> is illustrated later.</p>
<p>The example below is taken from a metaanalysis of spot sign as predictor
expansion of intracerebral hemorrhage <span class="citation">(<a href="#ref-pmid31272327">Phan, Krishnadas, et al. 2019</a>)</span>. The data for this
analysis is available in the Data-Use sub-folder.</p>
<div class="sourceCode" id="cb675"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb675-1"><a href="statistics.html#cb675-1" tabindex="-1"></a><span class="fu">library</span>(mada)</span>
<span id="cb675-2"><a href="statistics.html#cb675-2" tabindex="-1"></a><span class="co">#spot sign data</span></span>
<span id="cb675-3"><a href="statistics.html#cb675-3" tabindex="-1"></a>Data<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">&quot;./Data-Use/ss150718.csv&quot;</span>)</span>
<span id="cb675-4"><a href="statistics.html#cb675-4" tabindex="-1"></a></span>
<span id="cb675-5"><a href="statistics.html#cb675-5" tabindex="-1"></a><span class="co">#remove duplicates using subset</span></span>
<span id="cb675-6"><a href="statistics.html#cb675-6" tabindex="-1"></a><span class="co">#another way is to use filter from dplyr</span></span>
<span id="cb675-7"><a href="statistics.html#cb675-7" tabindex="-1"></a>Dat<span class="ot">&lt;-</span><span class="fu">subset</span>(Data, Data<span class="sc">$</span>retain<span class="sc">==</span><span class="st">&quot;yes&quot;</span>) </span>
<span id="cb675-8"><a href="statistics.html#cb675-8" tabindex="-1"></a>(ss<span class="ot">&lt;-</span><span class="fu">reitsma</span>(Dat))</span></code></pre></div>
<pre><code>## Call:  reitsma.default(data = Dat)
## 
## Fixed-effects coefficients:
##               tsens     tfpr
## (Intercept)  0.2548  -1.9989
## 
## 27 studies, 2 fixed and 3 random-effects parameters
##   logLik       AIC       BIC  
##  52.0325  -94.0650  -84.1201</code></pre>
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb677-1"><a href="statistics.html#cb677-1" tabindex="-1"></a><span class="fu">summary</span>(ss)</span></code></pre></div>
<pre><code>## Call:  reitsma.default(data = Dat)
## 
## Bivariate diagnostic random-effects meta-analysis
## Estimation method: REML
## 
## Fixed-effects coefficients
##                   Estimate Std. Error       z Pr(&gt;|z|) 95%ci.lb 95%ci.ub    
## tsens.(Intercept)    0.255      0.152   1.676    0.094   -0.043    0.553   .
## tfpr.(Intercept)    -1.999      0.097 -20.664    0.000   -2.189   -1.809 ***
## sensitivity          0.563          -       -        -    0.489    0.635    
## false pos. rate      0.119          -       -        -    0.101    0.141    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 
## 
## Variance components: between-studies Std. Dev and correlation matrix
##       Std. Dev  tsens  tfpr
## tsens    0.692  1.000     .
## tfpr     0.400 -0.003 1.000
## 
##  logLik     AIC     BIC 
##  52.033 -94.065 -84.120 
## 
## AUC:  0.858
## Partial AUC (restricted to observed FPRs and normalized):  0.547
## 
## I2 estimates 
## Zhou and Dendukuri approach:  10.2 % 
## Holling sample size unadjusted approaches:  64.2 - 79.9 % 
## Holling sample size adjusted approaches:  4.7 - 5 %</code></pre>
<div class="sourceCode" id="cb679"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb679-1"><a href="statistics.html#cb679-1" tabindex="-1"></a><span class="fu">AUC</span>(<span class="fu">reitsma</span>(<span class="at">data =</span> Dat))</span></code></pre></div>
<pre><code>## $AUC
## [1] 0.8576619
## 
## $pAUC
## [1] 0.5474316
## 
## attr(,&quot;sroc.type&quot;)
## [1] &quot;ruttergatsonis&quot;</code></pre>
<div class="sourceCode" id="cb681"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb681-1"><a href="statistics.html#cb681-1" tabindex="-1"></a>sumss<span class="ot">&lt;-</span><span class="fu">SummaryPts</span>(ss,<span class="at">n.iter =</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>) <span class="co">#bivariate pooled LR</span></span>
<span id="cb681-2"><a href="statistics.html#cb681-2" tabindex="-1"></a><span class="fu">summary</span>(sumss)</span></code></pre></div>
<pre><code>##           Mean Median  2.5%  97.5%
## posLR    4.750  4.710 3.810  5.830
## negLR    0.496  0.496 0.409  0.581
## invnegLR 2.030  2.020 1.720  2.440
## DOR      9.730  9.570 6.690 13.900</code></pre>
</div>
<div id="metaanalysis-of-clinical-trial." class="section level3 hasAnchor" number="4.9.8">
<h3><span class="header-section-number">4.9.8</span> Metaanalysis of clinical trial.<a href="statistics.html#metaanalysis-of-clinical-trial." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Fixed effect (Peto or Mantel-Haenszel) approaches assume that the population is the same for all studies and thus each study is the source of error. Random
effect (DerSimonian Laird) assumes an additional source of error between studies.The random effect approach results in more conservate estimate of effect size confidence interval. A criticism of DerSimnonian and Laird approach is that it is prone to type I error especially when the number of number of studies is small (n&lt;20) or moderate heterogeneity. Its estimated that 25% of the significant findings with DerSimonian Laird method may be non-significant with Hartung-Knapp method (BMC Medical Research Methodology 2014, 14:25). The Hartung-Knapp method (Stat Med 2001;20:3875-89) estimate the between studies variance and treat it as fixed. It employs quantile of t-distribution rather than normal distribution. The Hartung-Knapp method is available in meta and metafor package.</p>
<p>The data is from Jama Cardiology on Associations of Omega-3 Fatty Acid Supplement Use With Cardiovascular Disease Risks Meta-analysis of 10 Trials Involving 77917 Individuals <span class="citation">(<a href="#ref-pmid29387889">Aung T 2018</a>)</span>. Subsequently a meta-analysis <span class="citation">(<a href="#ref-pmid31567003">Hu 2019</a>)</span> reported that contrary to the earlier meta-analysis, Omega-3 lowers the risk of cardiovascular diseases with effect related to dose. The analysis using DerSimonian Laird and Hartung Knapp method is illustrated below.</p>
<div class="sourceCode" id="cb683"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb683-1"><a href="statistics.html#cb683-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb683-2"><a href="statistics.html#cb683-2" tabindex="-1"></a><span class="fu">library</span>(metafor)</span>
<span id="cb683-3"><a href="statistics.html#cb683-3" tabindex="-1"></a></span>
<span id="cb683-4"><a href="statistics.html#cb683-4" tabindex="-1"></a><span class="co">#Omega 3 data</span></span>
<span id="cb683-5"><a href="statistics.html#cb683-5" tabindex="-1"></a>Year<span class="ot">=</span><span class="fu">c</span>(<span class="dv">2010</span>,<span class="dv">2014</span>,<span class="dv">2010</span>,<span class="dv">2007</span>,<span class="dv">2010</span>,<span class="dv">2010</span>,<span class="dv">2013</span>,<span class="dv">2008</span>,<span class="dv">2012</span>,<span class="dv">1999</span>)</span>
<span id="cb683-6"><a href="statistics.html#cb683-6" tabindex="-1"></a>Trials<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;DOIT&quot;</span>,<span class="st">&quot;AREDS-2&quot;</span>,<span class="st">&quot;SU.FOL.OM3&quot;</span>,<span class="st">&quot;JELIS&quot;</span>,<span class="st">&quot;Alpha Omega&quot;</span>,<span class="st">&quot;OMEGA&quot;</span>,<span class="st">&quot;R&amp;P&quot;</span>,<span class="st">&quot;GISSI-HF&quot;</span>,<span class="st">&quot;ORIGIN&quot;</span>,<span class="st">&quot;GISSI-P&quot;</span>)</span>
<span id="cb683-7"><a href="statistics.html#cb683-7" tabindex="-1"></a>Treatment<span class="ot">=</span><span class="fu">c</span>(<span class="dv">29</span>,<span class="dv">213</span>,<span class="dv">216</span>,<span class="dv">262</span>,<span class="dv">332</span>,<span class="dv">534</span>,<span class="dv">733</span>,<span class="dv">783</span>,<span class="dv">1276</span>,<span class="dv">1552</span>)</span>
<span id="cb683-8"><a href="statistics.html#cb683-8" tabindex="-1"></a>Treatment.per<span class="ot">=</span><span class="fu">c</span>(<span class="fl">10.3</span>,<span class="fl">9.9</span>,<span class="fl">17.2</span>,<span class="fl">2.8</span>,<span class="fl">13.8</span>,<span class="fl">27.7</span>,<span class="fl">11.7</span>,<span class="fl">22.4</span>,<span class="fl">20.3</span>,<span class="fl">27.4</span>)</span>
<span id="cb683-9"><a href="statistics.html#cb683-9" tabindex="-1"></a>Control<span class="ot">=</span><span class="fu">c</span>(<span class="dv">35</span>,<span class="dv">208</span>,<span class="dv">211</span>,<span class="dv">324</span>,<span class="dv">331</span>,<span class="dv">541</span>,<span class="dv">745</span>,<span class="dv">831</span>,<span class="dv">1295</span>,<span class="dv">1550</span>)</span>
<span id="cb683-10"><a href="statistics.html#cb683-10" tabindex="-1"></a>Control.per<span class="ot">=</span><span class="fu">c</span>(<span class="fl">12.5</span>,<span class="fl">10.1</span>,<span class="fl">16.9</span>,<span class="fl">3.5</span>,<span class="fl">13.6</span>,<span class="fl">28.6</span>, <span class="fl">11.9</span>,<span class="fl">23.9</span>,<span class="fl">20.7</span>,<span class="fl">27.3</span>)</span>
<span id="cb683-11"><a href="statistics.html#cb683-11" tabindex="-1"></a></span>
<span id="cb683-12"><a href="statistics.html#cb683-12" tabindex="-1"></a><span class="co">#combine into data frame</span></span>
<span id="cb683-13"><a href="statistics.html#cb683-13" tabindex="-1"></a>rct<span class="ot">&lt;-</span><span class="fu">data.frame</span>(Year,Trials,Treatment,Treatment.per,Control,Control.per) <span class="sc">%&gt;%</span></span>
<span id="cb683-14"><a href="statistics.html#cb683-14" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Treatment.number=</span><span class="fu">round</span>(Treatment<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span>Treatment.per,<span class="dv">0</span>),</span>
<span id="cb683-15"><a href="statistics.html#cb683-15" tabindex="-1"></a>         <span class="at">Control.number=</span><span class="fu">round</span>(Control<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span>Control.per,<span class="dv">0</span>), <span class="at">group=</span><span class="fu">ifelse</span>(Year<span class="sc">&gt;</span><span class="dv">2010</span>,<span class="st">&quot;wide&quot;</span>,<span class="st">&quot;narrow&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb683-16"><a href="statistics.html#cb683-16" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">ai=</span>Treatment,<span class="at">n1i=</span>Treatment.number,<span class="at">ci=</span>Control,</span>
<span id="cb683-17"><a href="statistics.html#cb683-17" tabindex="-1"></a>         <span class="at">n2i=</span>Control.number,<span class="at">study=</span>Trials) </span>
<span id="cb683-18"><a href="statistics.html#cb683-18" tabindex="-1"></a></span>
<span id="cb683-19"><a href="statistics.html#cb683-19" tabindex="-1"></a></span>
<span id="cb683-20"><a href="statistics.html#cb683-20" tabindex="-1"></a><span class="co">#peto&#39;s fixed effect method</span></span>
<span id="cb683-21"><a href="statistics.html#cb683-21" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">rma.peto</span>(<span class="at">ai=</span>ai, <span class="at">n1i=</span>n1i, <span class="at">ci=</span>ci, <span class="at">n2i=</span>n2i, <span class="at">data=</span>rct)</span>
<span id="cb683-22"><a href="statistics.html#cb683-22" tabindex="-1"></a><span class="fu">print</span>(res, <span class="at">digits=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## 
## Equal-Effects Model (k = 10)
## 
## I^2 (total heterogeneity / total variability):  0.00%
## H^2 (total variability / sampling variability): 0.93
## 
## Test for Heterogeneity: 
## Q(df = 9) = 8.36, p-val = 0.50
## 
## Model Results (log scale):
## 
## estimate    se   zval  pval  ci.lb  ci.ub 
##    -0.04  0.02  -1.72  0.08  -0.08   0.00 
## 
## Model Results (OR scale):
## 
## estimate  ci.lb  ci.ub 
##     0.97   0.93   1.00</code></pre>
<div class="sourceCode" id="cb685"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb685-1"><a href="statistics.html#cb685-1" tabindex="-1"></a>result<span class="ot">&lt;-</span><span class="fu">predict</span>(res, <span class="at">transf=</span>exp, <span class="at">digits=</span><span class="dv">2</span>)</span>
<span id="cb685-2"><a href="statistics.html#cb685-2" tabindex="-1"></a><span class="co">#forest plot</span></span>
<span id="cb685-3"><a href="statistics.html#cb685-3" tabindex="-1"></a>metafor<span class="sc">::</span><span class="fu">forest</span>(res, <span class="at">targs=</span><span class="fu">list</span>(<span class="at">study=</span>rct<span class="sc">$</span>study), </span>
<span id="cb685-4"><a href="statistics.html#cb685-4" tabindex="-1"></a><span class="at">main=</span><span class="st">&quot;RCT of Omega3 fatty acid for cardiovascular disease-Peto&quot;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-17-1-1.png" width="672" /></p>
<p>The funnel plot is used here to illustrate presence or absence publication bias. In this case the funnel plot reflects the same findings as the low <span class="math inline">\(I^2\)</span> value. There is one outlier. We will explore this further with the <em>GOSH</em> plot below.</p>
<div class="sourceCode" id="cb686"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb686-1"><a href="statistics.html#cb686-1" tabindex="-1"></a><span class="co"># funnel plot </span></span>
<span id="cb686-2"><a href="statistics.html#cb686-2" tabindex="-1"></a><span class="fu">funnel</span>(res, <span class="at">refline=</span><span class="dv">0</span>, <span class="at">level=</span><span class="fu">c</span>(<span class="dv">90</span>, <span class="dv">95</span>, <span class="dv">99</span>), </span>
<span id="cb686-3"><a href="statistics.html#cb686-3" tabindex="-1"></a>       <span class="at">shade=</span><span class="fu">c</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;gray&quot;</span>, <span class="st">&quot;darkgray&quot;</span>))</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-17-2-1.png" width="672" /></p>
<p>Random effect (DerSimonian Laird) assumes an additional source of error between studies when calculating odds ratio.</p>
<div class="sourceCode" id="cb687"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb687-1"><a href="statistics.html#cb687-1" tabindex="-1"></a><span class="co">#DL</span></span>
<span id="cb687-2"><a href="statistics.html#cb687-2" tabindex="-1"></a>datO3 <span class="ot">&lt;-</span> <span class="fu">escalc</span>(<span class="at">measure =</span> <span class="st">&quot;OR&quot;</span>,<span class="at">ai=</span>ai, <span class="at">n1i=</span>n1i, <span class="at">ci=</span>ci, <span class="at">n2i=</span>n2i,<span class="at">data=</span>rct)</span>
<span id="cb687-3"><a href="statistics.html#cb687-3" tabindex="-1"></a>res.DL<span class="ot">&lt;-</span><span class="fu">rma</span>(yi,vi, <span class="at">method =</span> <span class="st">&quot;DL&quot;</span>,<span class="at">data=</span>datO3)</span>
<span id="cb687-4"><a href="statistics.html#cb687-4" tabindex="-1"></a>metafor<span class="sc">::</span><span class="fu">forest</span>(res.DL,<span class="at">main=</span><span class="st">&quot;RCT of Omega3 fatty acid for cardiovascular disease-DL&quot;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-17-3-1.png" width="672" /></p>
<p>DerSimonian Laird method may not be appropriate for metaanalysis with small
number of studies . The recommendation is to use the Hartung Knapp random effect method. This analysis show that inspite of the small sample size the significant findings remain.</p>
<div class="sourceCode" id="cb688"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb688-1"><a href="statistics.html#cb688-1" tabindex="-1"></a><span class="co">#Hartung-ignore error message</span></span>
<span id="cb688-2"><a href="statistics.html#cb688-2" tabindex="-1"></a>res.HK<span class="ot">&lt;-</span><span class="fu">rma.uni</span>(yi,<span class="at">vi=</span><span class="dv">1</span><span class="sc">/</span>vi,<span class="at">method=</span><span class="st">&quot;FE&quot;</span>,<span class="at">knha=</span><span class="cn">TRUE</span>,<span class="at">data=</span>datO3)</span>
<span id="cb688-3"><a href="statistics.html#cb688-3" tabindex="-1"></a>metafor<span class="sc">::</span><span class="fu">forest</span>(res.HK,<span class="at">main=</span><span class="st">&quot;RCT of Omega3 fatty acid for cardiovascular disease-HK&quot;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-17-4-1.png" width="672" /></p>
<p>Subgroup analysis is one way of exploring the data for group effect. Metaregression is illustrated later.</p>
<div class="sourceCode" id="cb689"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb689-1"><a href="statistics.html#cb689-1" tabindex="-1"></a><span class="co">#datO3$group&lt;-rct3$group</span></span>
<span id="cb689-2"><a href="statistics.html#cb689-2" tabindex="-1"></a><span class="co">#plot subgroups</span></span>
<span id="cb689-3"><a href="statistics.html#cb689-3" tabindex="-1"></a>res.group <span class="ot">&lt;-</span> <span class="fu">rma</span>(yi, vi, <span class="at">mods =</span> <span class="sc">~</span> group, <span class="at">data=</span>datO3)</span>
<span id="cb689-4"><a href="statistics.html#cb689-4" tabindex="-1"></a>res.wide<span class="ot">&lt;-</span> <span class="fu">rma</span>(yi, vi, <span class="at">subset=</span>(group<span class="sc">==</span><span class="st">&quot;wide&quot;</span>), <span class="at">data=</span>datO3)</span>
<span id="cb689-5"><a href="statistics.html#cb689-5" tabindex="-1"></a>res.wide</span>
<span id="cb689-6"><a href="statistics.html#cb689-6" tabindex="-1"></a>res.narrow<span class="ot">&lt;-</span> <span class="fu">rma</span>(yi, vi, <span class="at">subset=</span>(group<span class="sc">==</span><span class="st">&quot;narrow&quot;</span>), <span class="at">data=</span>datO3)</span>
<span id="cb689-7"><a href="statistics.html#cb689-7" tabindex="-1"></a>res.narrow</span>
<span id="cb689-8"><a href="statistics.html#cb689-8" tabindex="-1"></a><span class="co">#https://stackoverflow.com/questions/39392706/using-the-r-forestplot-package-</span></span>
<span id="cb689-9"><a href="statistics.html#cb689-9" tabindex="-1"></a><span class="co">#is-there-a-way-to-assign-variable-colors-to-boxe</span></span>
<span id="cb689-10"><a href="statistics.html#cb689-10" tabindex="-1"></a></span>
<span id="cb689-11"><a href="statistics.html#cb689-11" tabindex="-1"></a><span class="co">#confidence interval</span></span>
<span id="cb689-12"><a href="statistics.html#cb689-12" tabindex="-1"></a>rmeta_conf <span class="ot">&lt;-</span> </span>
<span id="cb689-13"><a href="statistics.html#cb689-13" tabindex="-1"></a>  <span class="fu">structure</span>(<span class="fu">list</span>(</span>
<span id="cb689-14"><a href="statistics.html#cb689-14" tabindex="-1"></a>    <span class="at">mean  =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.0676</span>), <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.0266</span>),  <span class="cn">NA</span>, <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.0352</span>)), </span>
<span id="cb689-15"><a href="statistics.html#cb689-15" tabindex="-1"></a>    <span class="at">lower =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.1873</span>), <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.0715</span>),  <span class="cn">NA</span>, <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.0753</span>)),</span>
<span id="cb689-16"><a href="statistics.html#cb689-16" tabindex="-1"></a>    <span class="at">upper =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fu">exp</span>(<span class="fl">0.0520</span>), <span class="fu">exp</span>(<span class="fl">0.0183</span>),  <span class="cn">NA</span>, <span class="fu">exp</span>(<span class="fl">0.0049</span>))),</span>
<span id="cb689-17"><a href="statistics.html#cb689-17" tabindex="-1"></a>    <span class="at">.Names =</span> <span class="fu">c</span>(<span class="st">&quot;mean&quot;</span>, <span class="st">&quot;lower&quot;</span>, <span class="st">&quot;upper&quot;</span>), </span>
<span id="cb689-18"><a href="statistics.html#cb689-18" tabindex="-1"></a>    <span class="at">row.names =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="sc">-</span>6L), </span>
<span id="cb689-19"><a href="statistics.html#cb689-19" tabindex="-1"></a>    <span class="at">class =</span> <span class="st">&quot;data.frame&quot;</span>)</span>
<span id="cb689-20"><a href="statistics.html#cb689-20" tabindex="-1"></a></span>
<span id="cb689-21"><a href="statistics.html#cb689-21" tabindex="-1"></a><span class="co">#table data</span></span>
<span id="cb689-22"><a href="statistics.html#cb689-22" tabindex="-1"></a>tabletext<span class="ot">&lt;-</span><span class="fu">cbind</span>(<span class="fu">c</span>(<span class="st">&quot;&quot;</span>,<span class="st">&quot;Trials&quot;</span>,<span class="st">&quot;wide&quot;</span>,<span class="st">&quot;narrow&quot;</span>,<span class="cn">NA</span>,<span class="st">&quot;Summary&quot;</span>),</span>
<span id="cb689-23"><a href="statistics.html#cb689-23" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;Events&quot;</span>,<span class="st">&quot;(Drugs)&quot;</span>,<span class="fu">sum</span>(<span class="fu">filter</span>(datO3,group<span class="sc">==</span><span class="st">&quot;wide&quot;</span>)<span class="sc">$</span>ai),</span>
<span id="cb689-24"><a href="statistics.html#cb689-24" tabindex="-1"></a>      <span class="fu">sum</span>(<span class="fu">filter</span>(datO3,group<span class="sc">==</span><span class="st">&quot;narrow&quot;</span>)<span class="sc">$</span>ai),<span class="cn">NA</span>,<span class="cn">NA</span>),</span>
<span id="cb689-25"><a href="statistics.html#cb689-25" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;Events&quot;</span>,<span class="st">&quot;(Control)&quot;</span>,<span class="fu">sum</span>(<span class="fu">filter</span>(datO3,group<span class="sc">==</span><span class="st">&quot;wide&quot;</span>)<span class="sc">$</span>ci),</span>
<span id="cb689-26"><a href="statistics.html#cb689-26" tabindex="-1"></a>      <span class="fu">sum</span>(<span class="fu">filter</span>(datO3,group<span class="sc">==</span><span class="st">&quot;narrow&quot;</span>)<span class="sc">$</span>ci),<span class="cn">NA</span>,<span class="cn">NA</span>),     </span>
<span id="cb689-27"><a href="statistics.html#cb689-27" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;&quot;</span>,<span class="st">&quot;OR&quot;</span>,<span class="st">&quot;0.934&quot;</span>,<span class="st">&quot;0.974&quot;</span>,<span class="cn">NA</span>,<span class="st">&quot;0.965&quot;</span>)</span>
<span id="cb689-28"><a href="statistics.html#cb689-28" tabindex="-1"></a>                 )</span>
<span id="cb689-29"><a href="statistics.html#cb689-29" tabindex="-1"></a><span class="co">#use forestplot as another library to perform forest plot</span></span>
<span id="cb689-30"><a href="statistics.html#cb689-30" tabindex="-1"></a><span class="fu">library</span>(forestplot)</span>
<span id="cb689-31"><a href="statistics.html#cb689-31" tabindex="-1"></a> <span class="fu">forestplot</span>(tabletext, </span>
<span id="cb689-32"><a href="statistics.html#cb689-32" tabindex="-1"></a>       rmeta_conf,<span class="at">new_page =</span> <span class="cn">TRUE</span>,</span>
<span id="cb689-33"><a href="statistics.html#cb689-33" tabindex="-1"></a>       <span class="at">is.summary=</span><span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">TRUE</span>,<span class="fu">rep</span>(<span class="cn">FALSE</span>,<span class="dv">8</span>),<span class="cn">TRUE</span>),</span>
<span id="cb689-34"><a href="statistics.html#cb689-34" tabindex="-1"></a>       <span class="at">clip=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">2.5</span>), </span>
<span id="cb689-35"><a href="statistics.html#cb689-35" tabindex="-1"></a>       <span class="at">xlog=</span><span class="cn">TRUE</span>, </span>
<span id="cb689-36"><a href="statistics.html#cb689-36" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">fpColors</span>(<span class="at">box=</span><span class="st">&quot;royalblue&quot;</span>,<span class="at">line=</span><span class="st">&quot;darkblue&quot;</span>, <span class="at">summary=</span><span class="st">&quot;royalblue&quot;</span>))</span></code></pre></div>
<p>Baujat plot is another method in addition to funnel plot explore heterogeneity</p>
<div class="sourceCode" id="cb690"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb690-1"><a href="statistics.html#cb690-1" tabindex="-1"></a><span class="co"># adjust margins so the space is better used</span></span>
<span id="cb690-2"><a href="statistics.html#cb690-2" tabindex="-1"></a></span>
<span id="cb690-3"><a href="statistics.html#cb690-3" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb690-4"><a href="statistics.html#cb690-4" tabindex="-1"></a><span class="co"># create Baujat plot to explore source of heterogeneity</span></span>
<span id="cb690-5"><a href="statistics.html#cb690-5" tabindex="-1"></a><span class="fu">baujat</span>(res.DL, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.2</span>))</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-17-6-1.png" width="672" /></p>
<p>GOSH plot explores study heterogeneity using output of fixed effect model for
all possible subsets</p>
<div class="sourceCode" id="cb691"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb691-1"><a href="statistics.html#cb691-1" tabindex="-1"></a><span class="do">## fit FE model to all possible subsets</span></span>
<span id="cb691-2"><a href="statistics.html#cb691-2" tabindex="-1"></a><span class="co"># uses output from DL analysis</span></span>
<span id="cb691-3"><a href="statistics.html#cb691-3" tabindex="-1"></a></span>
<span id="cb691-4"><a href="statistics.html#cb691-4" tabindex="-1"></a>sav <span class="ot">&lt;-</span> <span class="fu">gosh</span>(res.DL)</span></code></pre></div>
<pre><code>## Fitting 1023 models (based on all possible subsets).</code></pre>
<div class="sourceCode" id="cb693"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb693-1"><a href="statistics.html#cb693-1" tabindex="-1"></a><span class="do">### create GOSH plot</span></span>
<span id="cb693-2"><a href="statistics.html#cb693-2" tabindex="-1"></a><span class="do">### red points for subsets that include and blue points</span></span>
<span id="cb693-3"><a href="statistics.html#cb693-3" tabindex="-1"></a><span class="do">### for subsets that exclude study 16 (the ISIS-4 trial)</span></span>
<span id="cb693-4"><a href="statistics.html#cb693-4" tabindex="-1"></a></span>
<span id="cb693-5"><a href="statistics.html#cb693-5" tabindex="-1"></a><span class="fu">plot</span>(sav, <span class="at">out=</span><span class="fu">dim</span>(rct)[<span class="dv">1</span>], <span class="at">breaks=</span><span class="dv">100</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-17-7-1.png" width="672" /></p>
</div>
<div id="metaregression" class="section level3 hasAnchor" number="4.9.9">
<h3><span class="header-section-number">4.9.9</span> Metaregression<a href="statistics.html#metaregression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb694"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb694-1"><a href="statistics.html#cb694-1" tabindex="-1"></a><span class="co">#separate metaregression for tsens and tfpr</span></span>
<span id="cb694-2"><a href="statistics.html#cb694-2" tabindex="-1"></a></span>
<span id="cb694-3"><a href="statistics.html#cb694-3" tabindex="-1"></a><span class="co">#tsens - setting single or multicentre for spot sign metaanalysis</span></span>
<span id="cb694-4"><a href="statistics.html#cb694-4" tabindex="-1"></a>dat1<span class="ot">&lt;-</span><span class="fu">subset</span>(Dat, Dat<span class="sc">$</span>result_id<span class="sc">==</span><span class="dv">1</span> )</span>
<span id="cb694-5"><a href="statistics.html#cb694-5" tabindex="-1"></a>(metass<span class="ot">&lt;-</span><span class="fu">reitsma</span>(dat1, <span class="at">formula =</span> <span class="fu">cbind</span>(tsens,tfpr)<span class="sc">~</span>PubYear<span class="sc">+</span>Study.type<span class="sc">+</span>Setting<span class="sc">+</span>Quality.assessment)) </span></code></pre></div>
<pre><code>## Call:  reitsma.default(data = dat1, formula = cbind(tsens, tfpr) ~ PubYear + 
##     Study.type + Setting + Quality.assessment)
## 
## Fixed-effects coefficients:
##                        tsens       tfpr
## (Intercept)         298.7348  -164.8603
## PubYear              -0.1484     0.0828
## Study.typeRetro       0.3554    -0.1489
## SettingSingle         0.2283    -0.1301
## Quality.assessment   -0.0040    -0.0834
## 
## 26 studies, 10 fixed and 3 random-effects parameters
##   logLik       AIC       BIC  
##  48.5386  -71.0771  -45.7109</code></pre>
<div class="sourceCode" id="cb696"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb696-1"><a href="statistics.html#cb696-1" tabindex="-1"></a><span class="fu">summary</span>(metass)</span></code></pre></div>
<pre><code>## Call:  reitsma.default(data = dat1, formula = cbind(tsens, tfpr) ~ PubYear + 
##     Study.type + Setting + Quality.assessment)
## 
## Bivariate diagnostic random-effects meta-regression
## Estimation method: REML
## 
## Fixed-effects coefficients
##                          Estimate Std. Error      z Pr(&gt;|z|) 95%ci.lb 95%ci.ub   
## tsens.(Intercept)         298.735    143.547  2.081    0.037   17.387  580.083  *
## tsens.PubYear              -0.148      0.071 -2.078    0.038   -0.288   -0.008  *
## tsens.Study.typeRetro       0.355      0.310  1.146    0.252   -0.253    0.963   
## tsens.SettingSingle         0.228      0.495  0.462    0.644   -0.741    1.198   
## tsens.Quality.assessment   -0.004      0.050 -0.081    0.936   -0.102    0.094   
## tfpr.(Intercept)         -164.860     80.574 -2.046    0.041 -322.783   -6.938  *
## tfpr.PubYear                0.083      0.040  2.066    0.039    0.004    0.161  *
## tfpr.Study.typeRetro       -0.149      0.172 -0.865    0.387   -0.486    0.188   
## tfpr.SettingSingle         -0.130      0.276 -0.471    0.638   -0.672    0.412   
## tfpr.Quality.assessment    -0.083      0.026 -3.190    0.001   -0.135   -0.032 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 
## 
## Variance components: between-studies Std. Dev and correlation matrix
##       Std. Dev tsens  tfpr
## tsens    0.657 1.000     .
## tfpr     0.297 0.312 1.000
## 
##  logLik     AIC     BIC 
##  48.539 -71.077 -45.711 
## 
## 
## I2 estimates 
## Zhou and Dendukuri approach:  0 % 
## Holling sample size unadjusted approaches:  66.8 - 80.5 % 
## Holling sample size adjusted approaches:  5.4 - 5.8 %</code></pre>
<div class="sourceCode" id="cb698"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb698-1"><a href="statistics.html#cb698-1" tabindex="-1"></a><span class="co">#tfpr - setting single or multicentre for spot sign metaanalysis</span></span>
<span id="cb698-2"><a href="statistics.html#cb698-2" tabindex="-1"></a>dat1<span class="ot">&lt;-</span><span class="fu">subset</span>(Dat, Dat<span class="sc">$</span>result_id<span class="sc">==</span><span class="dv">1</span> )</span>
<span id="cb698-3"><a href="statistics.html#cb698-3" tabindex="-1"></a>(metassfull<span class="ot">&lt;-</span><span class="fu">reitsma</span>(dat1, <span class="at">formula =</span> <span class="fu">cbind</span>(tsens,tfpr)<span class="sc">~</span></span>
<span id="cb698-4"><a href="statistics.html#cb698-4" tabindex="-1"></a>        PubYear<span class="sc">+</span>clinical<span class="sc">+</span>Study.type<span class="sc">+</span>CTA6hrs<span class="sc">+</span>Setting<span class="sc">+</span>Quality.assessment)) </span></code></pre></div>
<pre><code>## Call:  reitsma.default(data = dat1, formula = cbind(tsens, tfpr) ~ PubYear + 
##     clinical + Study.type + CTA6hrs + Setting + Quality.assessment)
## 
## Fixed-effects coefficients:
##                        tsens       tfpr
## (Intercept)         297.5416  -144.2754
## PubYear              -0.1480     0.0724
## clinical             -0.4703    -0.1810
## Study.typeRetro       0.4884    -0.0989
## CTA6hrsyes           -0.2141    -0.2342
## SettingSingle         0.2568    -0.1435
## Quality.assessment    0.0130    -0.0738
## 
## 26 studies, 14 fixed and 3 random-effects parameters
##   logLik       AIC       BIC  
##  48.4477  -62.8955  -29.7243</code></pre>
<div class="sourceCode" id="cb700"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb700-1"><a href="statistics.html#cb700-1" tabindex="-1"></a><span class="fu">summary</span>(metassfull)</span></code></pre></div>
<pre><code>## Call:  reitsma.default(data = dat1, formula = cbind(tsens, tfpr) ~ PubYear + 
##     clinical + Study.type + CTA6hrs + Setting + Quality.assessment)
## 
## Bivariate diagnostic random-effects meta-regression
## Estimation method: REML
## 
## Fixed-effects coefficients
##                          Estimate Std. Error      z Pr(&gt;|z|) 95%ci.lb 95%ci.ub   
## tsens.(Intercept)         297.542    150.543  1.976    0.048    2.482  592.601  *
## tsens.PubYear              -0.148      0.075 -1.977    0.048   -0.295   -0.001  *
## tsens.clinical             -0.470      0.333 -1.411    0.158   -1.124    0.183   
## tsens.Study.typeRetro       0.488      0.321  1.523    0.128   -0.140    1.117   
## tsens.CTA6hrsyes           -0.214      0.322 -0.665    0.506   -0.845    0.417   
## tsens.SettingSingle         0.257      0.495  0.519    0.604   -0.714    1.228   
## tsens.Quality.assessment    0.013      0.051  0.255    0.799   -0.087    0.113   
## tfpr.(Intercept)         -144.275     82.720 -1.744    0.081 -306.403   17.852  .
## tfpr.PubYear                0.072      0.041  1.761    0.078   -0.008    0.153  .
## tfpr.clinical              -0.181      0.187 -0.969    0.333   -0.547    0.185   
## tfpr.Study.typeRetro       -0.099      0.177 -0.558    0.577   -0.446    0.249   
## tfpr.CTA6hrsyes            -0.234      0.177 -1.322    0.186   -0.581    0.113   
## tfpr.SettingSingle         -0.144      0.274 -0.524    0.600   -0.680    0.393   
## tfpr.Quality.assessment    -0.074      0.027 -2.774    0.006   -0.126   -0.022 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 
## 
## Variance components: between-studies Std. Dev and correlation matrix
##       Std. Dev tsens  tfpr
## tsens    0.650 1.000     .
## tfpr     0.285 0.188 1.000
## 
##  logLik     AIC     BIC 
##  48.448 -62.895 -29.724 
## 
## 
## I2 estimates 
## Zhou and Dendukuri approach:  0 % 
## Holling sample size unadjusted approaches:  66.8 - 80.5 % 
## Holling sample size adjusted approaches:  5.4 - 5.8 %</code></pre>
<p>Plot year against tsens from metaregression</p>
<div class="sourceCode" id="cb702"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb702-1"><a href="statistics.html#cb702-1" tabindex="-1"></a><span class="co">#using output from spot sign</span></span>
<span id="cb702-2"><a href="statistics.html#cb702-2" tabindex="-1"></a></span>
<span id="cb702-3"><a href="statistics.html#cb702-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb702-4"><a href="statistics.html#cb702-4" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb702-5"><a href="statistics.html#cb702-5" tabindex="-1"></a>ssr<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(ss<span class="sc">$</span>residuals)</span>
<span id="cb702-6"><a href="statistics.html#cb702-6" tabindex="-1"></a><span class="co">#convert character to year</span></span>
<span id="cb702-7"><a href="statistics.html#cb702-7" tabindex="-1"></a>ssr<span class="sc">$</span>Year<span class="ot">&lt;-</span><span class="fu">as.Date</span>(<span class="fu">as.character</span>(Dat<span class="sc">$</span>PubYear),<span class="st">&quot;%Y&quot;</span>)</span>
<span id="cb702-8"><a href="statistics.html#cb702-8" tabindex="-1"></a>ssr<span class="sc">$</span>Quality<span class="ot">&lt;-</span>Dat<span class="sc">$</span>Quality.assessment</span>
<span id="cb702-9"><a href="statistics.html#cb702-9" tabindex="-1"></a><span class="fu">ggplot</span>(ssr, <span class="fu">aes</span>(<span class="at">x=</span>ssr<span class="sc">$</span>Year,<span class="at">y=</span>ssr<span class="sc">$</span>tsens))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb702-10"><a href="statistics.html#cb702-10" tabindex="-1"></a>  <span class="fu">scale_x_date</span>()<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>)<span class="sc">+</span></span>
<span id="cb702-11"><a href="statistics.html#cb702-11" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Relationship between transformed sensitivity and Publication Year&quot;</span>)<span class="sc">+</span></span>
<span id="cb702-12"><a href="statistics.html#cb702-12" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Year&quot;</span>,<span class="at">y=</span><span class="st">&quot;transformed sensitivity&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-17-9-1.png" width="672" /></p>
<div id="summary-positive-and-negative-likelihood-ratio" class="section level4 hasAnchor" number="4.9.9.1">
<h4><span class="header-section-number">4.9.9.1</span> summary Positive and Negative Likelihood Ratio<a href="statistics.html#summary-positive-and-negative-likelihood-ratio" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Positive likelihood ratio (PLR) is the ratio of sensitivity to false positive
rate (FPR); the negative (NLR) likelihood ratio is the ratio of 1-sensitivity
to specificity. A PLR indicates the likelihood that a positive spot sign (test) would be expected in a patient with target disorder compared with the
likelihood that the same result would be expected in a patient without target disorder. Using the recommendation by Jaeschke et al<span class="citation">(<a href="#ref-pmid8309035">Jaeschke, Guyatt, and Sackett 1994</a>)</span> a
high PLR (&gt;5) and low NLR (&lt;0.2) indicate that the test results would make moderate changes in the likelihood of hematoma growth from baseline risk.
PLRs of &gt;10 and NLRs of &lt;0.1 would confer very large changes from baseline risk. The pooled likelihood ratios were used to calculate post-test odds according to Bayes Theorem and post-test probabilities of outcome after a positive test
result for a range of possible values of baseline risk.</p>
<p>Data from likelihood ratio can be used to create Fagans normogram.</p>
<div class="sourceCode" id="cb704"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb704-1"><a href="statistics.html#cb704-1" tabindex="-1"></a><span class="co">#The code for this is available at</span></span>
<span id="cb704-2"><a href="statistics.html#cb704-2" tabindex="-1"></a><span class="co">#&quot;https://raw.githubusercontent.com/achekroud/nomogrammer/master/nomogrammer.r&quot;</span></span>
<span id="cb704-3"><a href="statistics.html#cb704-3" tabindex="-1"></a><span class="fu">library</span>(nomogrammer)</span>
<span id="cb704-4"><a href="statistics.html#cb704-4" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">nomogrammer</span>(<span class="at">Prevalence =</span> .<span class="dv">234</span>, <span class="at">Plr =</span> <span class="fl">4.85</span>, <span class="at">Nlr =</span> <span class="fl">0.49</span>)</span>
<span id="cb704-5"><a href="statistics.html#cb704-5" tabindex="-1"></a>p<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">&quot;Fagan&#39;s normogram for Spot Sign and ICH growth&quot;</span>)</span>
<span id="cb704-6"><a href="statistics.html#cb704-6" tabindex="-1"></a><span class="co">#ggsave(p,file=&quot;Fagan_SpotSign.png&quot;,width=5.99,height=3.99,units=&quot;in&quot;)</span></span></code></pre></div>
</div>
</div>
</div>
<div id="data-simulation" class="section level2 hasAnchor" number="4.10">
<h2><span class="header-section-number">4.10</span> Data simulation<a href="statistics.html#data-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Data simulation is an important aspects of data science. The example below is taken from our experience trying to simulate data from recent clot retrieval trials in stroke <span class="citation">(<a href="#ref-pmid25517348">Berkhemer et al. 2015</a>)</span> <span class="citation">(<a href="#ref-pmid25671797">Campbell et al. 2015</a>)</span>. Simulation is performed using <em>simstudy</em> library.</p>
<div class="sourceCode" id="cb705"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb705-1"><a href="statistics.html#cb705-1" tabindex="-1"></a><span class="fu">library</span> (simstudy)</span>
<span id="cb705-2"><a href="statistics.html#cb705-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb705-3"><a href="statistics.html#cb705-3" tabindex="-1"></a></span>
<span id="cb705-4"><a href="statistics.html#cb705-4" tabindex="-1"></a><span class="co">#T is Trial</span></span>
<span id="cb705-5"><a href="statistics.html#cb705-5" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">&quot;T&quot;</span>, <span class="at">dist =</span> <span class="st">&quot;binary&quot;</span>, <span class="at">formula =</span> <span class="fl">0.5</span>)</span>
<span id="cb705-6"><a href="statistics.html#cb705-6" tabindex="-1"></a></span>
<span id="cb705-7"><a href="statistics.html#cb705-7" tabindex="-1"></a><span class="co">#early neurological improvement (ENI) .37 in TPA and .8 in ECR</span></span>
<span id="cb705-8"><a href="statistics.html#cb705-8" tabindex="-1"></a><span class="co">#baseline NIHSS 13 in TPA and 17 in ECR</span></span>
<span id="cb705-9"><a href="statistics.html#cb705-9" tabindex="-1"></a></span>
<span id="cb705-10"><a href="statistics.html#cb705-10" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def, <span class="at">varname =</span> <span class="st">&quot;ENI&quot;</span>, <span class="at">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="at">formula =</span> .<span class="dv">8</span><span class="fl">-.53</span><span class="sc">*</span>T, <span class="at">variance =</span> .<span class="dv">1</span>)</span>
<span id="cb705-11"><a href="statistics.html#cb705-11" tabindex="-1"></a></span>
<span id="cb705-12"><a href="statistics.html#cb705-12" tabindex="-1"></a><span class="co">#baseline NIHSS 13 in TPA and 17 in ECR</span></span>
<span id="cb705-13"><a href="statistics.html#cb705-13" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def, <span class="at">varname =</span> <span class="st">&quot;Y1&quot;</span>, <span class="at">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="at">formula=</span><span class="dv">13</span>, <span class="at">variance =</span> <span class="dv">1</span>)</span>
<span id="cb705-14"><a href="statistics.html#cb705-14" tabindex="-1"></a></span>
<span id="cb705-15"><a href="statistics.html#cb705-15" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def, <span class="at">varname =</span> <span class="st">&quot;Y2&quot;</span>, <span class="at">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="at">formula =</span> <span class="st">&quot;Y1*ENI - 5 * T &gt;5&quot;</span>,<span class="at">variance =</span> <span class="dv">1</span>)</span>
<span id="cb705-16"><a href="statistics.html#cb705-16" tabindex="-1"></a></span>
<span id="cb705-17"><a href="statistics.html#cb705-17" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def, <span class="at">varname =</span> <span class="st">&quot;Y3&quot;</span>, <span class="at">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="at">formula =</span> <span class="st">&quot;Y2- 4*T&gt;2&quot;</span>,<span class="at">variance =</span> <span class="dv">1</span>)</span>
<span id="cb705-18"><a href="statistics.html#cb705-18" tabindex="-1"></a></span>
<span id="cb705-19"><a href="statistics.html#cb705-19" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def, <span class="at">varname =</span> <span class="st">&quot;Y4&quot;</span>, <span class="at">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="at">formula =</span> <span class="st">&quot;Y3- 2*T&gt;0&quot;</span>, <span class="at">variance =</span> <span class="dv">1</span>)</span>
<span id="cb705-20"><a href="statistics.html#cb705-20" tabindex="-1"></a></span>
<span id="cb705-21"><a href="statistics.html#cb705-21" tabindex="-1"></a><span class="co">#male</span></span>
<span id="cb705-22"><a href="statistics.html#cb705-22" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def,<span class="at">varname =</span> <span class="st">&quot;Male&quot;</span>, <span class="at">dist =</span> <span class="st">&quot;binary&quot;</span>, <span class="at">formula =</span> <span class="fl">0.49</span><span class="sc">*</span>T)</span>
<span id="cb705-23"><a href="statistics.html#cb705-23" tabindex="-1"></a></span>
<span id="cb705-24"><a href="statistics.html#cb705-24" tabindex="-1"></a><span class="co">#diabetes .23 in TPA and .06 in ECR</span></span>
<span id="cb705-25"><a href="statistics.html#cb705-25" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def,<span class="at">varname =</span> <span class="st">&quot;Diabetes&quot;</span>, <span class="at">dist =</span> <span class="st">&quot;binary&quot;</span>, <span class="at">formula =</span> .<span class="dv">23</span><span class="fl">-.17</span><span class="sc">*</span>T)</span>
<span id="cb705-26"><a href="statistics.html#cb705-26" tabindex="-1"></a></span>
<span id="cb705-27"><a href="statistics.html#cb705-27" tabindex="-1"></a><span class="co">#HT .66 TPA vs .6 ECR</span></span>
<span id="cb705-28"><a href="statistics.html#cb705-28" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defData</span>(def,<span class="at">varname =</span> <span class="st">&quot;HT&quot;</span>, <span class="at">dist =</span> <span class="st">&quot;binary&quot;</span>, <span class="at">formula =</span> .<span class="dv">66</span><span class="fl">-.06</span><span class="sc">*</span>T)</span>
<span id="cb705-29"><a href="statistics.html#cb705-29" tabindex="-1"></a></span>
<span id="cb705-30"><a href="statistics.html#cb705-30" tabindex="-1"></a><span class="co">#generate data frame</span></span>
<span id="cb705-31"><a href="statistics.html#cb705-31" tabindex="-1"></a>dtTrial <span class="ot">&lt;-</span> <span class="fu">genData</span>(<span class="dv">500</span>, def)</span>
<span id="cb705-32"><a href="statistics.html#cb705-32" tabindex="-1"></a></span>
<span id="cb705-33"><a href="statistics.html#cb705-33" tabindex="-1"></a><span class="co">#define parameter for mRS</span></span>
<span id="cb705-34"><a href="statistics.html#cb705-34" tabindex="-1"></a></span>
<span id="cb705-35"><a href="statistics.html#cb705-35" tabindex="-1"></a></span>
<span id="cb705-36"><a href="statistics.html#cb705-36" tabindex="-1"></a><span class="co">#Add conditional column with field name &quot;mRS&quot;</span></span>
<span id="cb705-37"><a href="statistics.html#cb705-37" tabindex="-1"></a></span>
<span id="cb705-38"><a href="statistics.html#cb705-38" tabindex="-1"></a></span>
<span id="cb705-39"><a href="statistics.html#cb705-39" tabindex="-1"></a></span>
<span id="cb705-40"><a href="statistics.html#cb705-40" tabindex="-1"></a>dtTime <span class="ot">&lt;-</span> <span class="fu">addPeriods</span>(dtTrial, <span class="at">nPeriods =</span> <span class="dv">4</span>, <span class="at">idvars =</span> <span class="st">&quot;id&quot;</span>, </span>
<span id="cb705-41"><a href="statistics.html#cb705-41" tabindex="-1"></a>            <span class="at">timevars =</span> <span class="fu">c</span>(<span class="st">&quot;Y1&quot;</span>, <span class="st">&quot;Y2&quot;</span>, <span class="st">&quot;Y3&quot;</span>,<span class="st">&quot;Y4&quot;</span>), <span class="at">timevarName =</span> <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb705-42"><a href="statistics.html#cb705-42" tabindex="-1"></a>dtTime</span></code></pre></div>
<pre><code>##        id period T         ENI Male Diabetes HT          Y timeID
##    1:   1      0 0 -0.07917888    0        0  1 13.1982656      1
##    2:   1      1 0 -0.07917888    0        0  1 -0.6170137      2
##    3:   1      2 0 -0.07917888    0        0  1  1.9725600      3
##    4:   1      3 0 -0.07917888    0        0  1 -0.5244530      4
##    5:   2      0 0  0.63132133    1        0  1 12.6286712      5
##   ---                                                            
## 1996: 499      3 0  0.14824903    0        0  1  0.5098237   1996
## 1997: 500      0 0  0.80704138    1        0  1 12.3427561   1997
## 1998: 500      1 0  0.80704138    1        0  1  1.3319651   1998
## 1999: 500      2 0  0.80704138    1        0  1 -2.4721920   1999
## 2000: 500      3 0  0.80704138    1        0  1 -1.7111199   2000</code></pre>
<div class="sourceCode" id="cb707"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb707-1"><a href="statistics.html#cb707-1" tabindex="-1"></a><span class="co">#check  that 2 groups are similar at start but not at finish</span></span>
<span id="cb707-2"><a href="statistics.html#cb707-2" tabindex="-1"></a><span class="fu">t.test</span>(Y1<span class="sc">~</span>T,<span class="at">data=</span>dtTrial)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Y1 by T
## t = 0.54733, df = 497.91, p-value = 0.5844
## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
## 95 percent confidence interval:
##  -0.1230718  0.2181206
## sample estimates:
## mean in group 0 mean in group 1 
##        12.96705        12.91953</code></pre>
<div class="sourceCode" id="cb709"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb709-1"><a href="statistics.html#cb709-1" tabindex="-1"></a><span class="fu">t.test</span>(Y4<span class="sc">~</span>T,<span class="at">data=</span>dtTrial)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Y4 by T
## t = 6.275, df = 484.36, p-value = 7.765e-10
## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
## 95 percent confidence interval:
##  0.4187510 0.8005452
## sample estimates:
## mean in group 0 mean in group 1 
##      0.58561980     -0.02402832</code></pre>
<div class="sourceCode" id="cb711"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb711-1"><a href="statistics.html#cb711-1" tabindex="-1"></a><span class="fu">t.test</span>(Male<span class="sc">~</span>T,<span class="at">data=</span>dtTrial)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Male by T
## t = 0.53764, df = 497.21, p-value = 0.5911
## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
## 95 percent confidence interval:
##  -0.06394389  0.11212316
## sample estimates:
## mean in group 0 mean in group 1 
##       0.5142857       0.4901961</code></pre>
<div class="sourceCode" id="cb713"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb713-1"><a href="statistics.html#cb713-1" tabindex="-1"></a><span class="co">#putting the 4 time periods together - long format</span></span>
<span id="cb713-2"><a href="statistics.html#cb713-2" tabindex="-1"></a>dtTime <span class="ot">&lt;-</span> <span class="fu">addPeriods</span>(dtTrial, <span class="at">nPeriods =</span> <span class="dv">3</span>, <span class="at">idvars =</span> <span class="st">&quot;id&quot;</span>, <span class="at">timevars =</span> <span class="fu">c</span>(<span class="st">&quot;Y1&quot;</span>, <span class="st">&quot;Y2&quot;</span>, <span class="st">&quot;Y3&quot;</span>,<span class="st">&quot;Y4&quot;</span>), <span class="at">timevarName =</span> <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb713-3"><a href="statistics.html#cb713-3" tabindex="-1"></a></span>
<span id="cb713-4"><a href="statistics.html#cb713-4" tabindex="-1"></a><span class="co">#summarise data using group_by</span></span>
<span id="cb713-5"><a href="statistics.html#cb713-5" tabindex="-1"></a>dtTime2<span class="ot">&lt;-</span>dtTime <span class="sc">%&gt;%</span></span>
<span id="cb713-6"><a href="statistics.html#cb713-6" tabindex="-1"></a>  <span class="fu">group_by</span>(period, T) <span class="sc">%&gt;%</span></span>
<span id="cb713-7"><a href="statistics.html#cb713-7" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">meanY=</span><span class="fu">mean</span>(Y),</span>
<span id="cb713-8"><a href="statistics.html#cb713-8" tabindex="-1"></a>            <span class="at">sdY=</span><span class="fu">sd</span>(Y),</span>
<span id="cb713-9"><a href="statistics.html#cb713-9" tabindex="-1"></a>            <span class="at">upperY=</span>meanY<span class="sc">+</span>sdY,</span>
<span id="cb713-10"><a href="statistics.html#cb713-10" tabindex="-1"></a>            <span class="at">lowerY=</span>meanY<span class="sc">-</span>sdY)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;period&#39;. You can override using the `.groups`
## argument.</code></pre>
<div class="sourceCode" id="cb715"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb715-1"><a href="statistics.html#cb715-1" tabindex="-1"></a><span class="co">#write.csv(dtTime, file=&quot;./Data-Use/dtTime_simulated.csv&quot;)</span></span>
<span id="cb715-2"><a href="statistics.html#cb715-2" tabindex="-1"></a><span class="co">#write.csv(dtTrial,          file=&quot;./Data-Use/dtTrial_simulated.csv&quot;)</span></span></code></pre></div>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-doi:10.1080/00031305.1998.10480550" class="csl-entry">
Agresti, Alan, and Brent A. Coull. 1998. <span>Approximate Is Better Than <span>Exact</span> for Interval Estimation of Binomial Proportions.</span> <em>The American Statistician</em> 52 (2): 11926. <a href="https://doi.org/10.1080/00031305.1998.10480550">https://doi.org/10.1080/00031305.1998.10480550</a>.
</div>
<div id="ref-pmid29387889" class="csl-entry">
Aung T, Kromhout D, Halsey J. 2018. <span>Associations of Omega-3 Fatty Acid Supplement Use with Cardiovascular Disease Risks: Meta-Analysis of 10 Trials Involving 77 917 Individuals.</span> <em>Jama Cardiol</em>, March. <a href="https://doi.org/doi: 10.1001/jamacardio.2017.5205">https://doi.org/doi: 10.1001/jamacardio.2017.5205</a>.
</div>
<div id="ref-doi10.1136/ebmental-2019-300117" class="csl-entry">
Balduzzi, Sara, Gerta Rcker, and Guido Schwarzer. 2019. <span>How to Perform a Meta-Analysis with <span>R</span>: A Practical Tutorial.</span> <em>Evidence-Based Mental Health</em>, no. 22: 15360.
</div>
<div id="ref-pmid25517348" class="csl-entry">
Berkhemer, O. A., P. S. Fransen, D. Beumer, L. A. van den Berg, H. F. Lingsma, A. J. Yoo, W. J. Schonewille, et al. 2015. <span><span class="nocase"><span>A</span> randomized trial of intraarterial treatment for acute ischemic stroke</span>.</span> <em>N. Engl. J. Med.</em> 372 (1): 1120.
</div>
<div id="ref-pmid10700737" class="csl-entry">
BJ, Biggerstaff. 2000. <span>Comparing Diagnostic Tests: A Simple Graphic Using Likelihood Ratios.</span> <em>Stat Med</em> 19 (March): 64963. <a href="https://doi.org/10.1002/(sici)1097-0258(20000315)19:5&lt;649::aid-sim371&gt;3.0.co;2-h">https://doi.org/10.1002/(sici)1097-0258(20000315)19:5&lt;649::aid-sim371&gt;3.0.co;2-h</a>.
</div>
<div id="ref-brown2001" class="csl-entry">
Brown, Lawrence D., T. Tony Cai, and Anirban DasGupta. 2001. <span>Interval Estimation for a Binomial Proportion.</span> <em>Statist. Sci.</em> 16 (2): 10133. <a href="https://doi.org/10.1214/ss/1009213286">https://doi.org/10.1214/ss/1009213286</a>.
</div>
<div id="ref-pmid25671797" class="csl-entry">
Campbell, B. C., P. J. Mitchell, T. J. Kleinig, H. M. Dewey, L. Churilov, N. Yassi, B. Yan, et al. 2015. <span><span class="nocase"><span>E</span>ndovascular therapy for ischemic stroke with perfusion-imaging selection</span>.</span> <em>N. Engl. J. Med.</em> 372 (11): 100918.
</div>
<div id="ref-COHEN1977179" class="csl-entry">
Cohen, Jacob. 1977. <span>CHAPTER 6 - Differences Between Proportions.</span> In <em>Statistical Power Analysis for the Behavioral Sciences</em>, edited by Jacob Cohen, 179213. Academic Press. https://doi.org/<a href="https://doi.org/10.1016/B978-0-12-179060-8.50011-6">https://doi.org/10.1016/B978-0-12-179060-8.50011-6</a>.
</div>
<div id="ref-pmid1738016" class="csl-entry">
Diamond, G. A. 1992. <span><span class="nocase"><span>W</span>hat price perfection? <span>C</span>alibration and discrimination of clinical prediction models</span>.</span> <em>J Clin Epidemiol</em> 45 (1): 8589.
</div>
<div id="ref-pmid25781447" class="csl-entry">
Gopal, A. D., N. R. Desai, T. Tse, and J. S. Ross. 2015. <span><span class="nocase"><span>R</span>eporting of noninferiority trials in <span>C</span>linical<span>T</span>rials.gov and corresponding publications</span>.</span> <em>JAMA</em> 313 (11): 116365.
</div>
<div id="ref-pmid10474158" class="csl-entry">
Graf E, Sauerbrei W, Schmoor C. 1999. <span>Assessment and Comparison of Prognostic Classification Schemes for Survival Data.</span> <em>Stat Med</em> 18 (September): 252945. <a href="https://doi.org/10.1002/(sici)1097-0258(19990915/30)18:17/18&lt;2529::aid-sim274&gt;3.0.co;2-5">https://doi.org/10.1002/(sici)1097-0258(19990915/30)18:17/18&lt;2529::aid-sim274&gt;3.0.co;2-5</a>.
</div>
<div id="ref-10.1093/biomet/81.3.515" class="csl-entry">
Grambsch, P. M., and T. M. Therneau. 1994. <span><span class="nocase">Proportional hazards tests and diagnostics based on weighted residuals</span>.</span> <em>Biometrika</em> 81 (3): 51526. <a href="https://doi.org/10.1093/biomet/81.3.515">https://doi.org/10.1093/biomet/81.3.515</a>.
</div>
<div id="ref-pmid7069920" class="csl-entry">
Harrell FE Jr, Pryor DB, Califf RM. 1982. <span>Evaluating the Yield of Medical Tests.</span> <em>JAMA</em> 247 (May): 254346.
</div>
<div id="ref-pmid31567003" class="csl-entry">
Hu, Hu, Y. 2019. <span>Marine Omega3 Supplementation and Cardiovascular Disease: An Updated Metaanalysis of 13 Randomized Controlled Trials Involving 127 477 Participants.</span> <em>JAHA</em>, September. https://doi.org/<a href="https://doi.org/10.1161/JAHA.119.013543">https://doi.org/10.1161/JAHA.119.013543</a>.
</div>
<div id="ref-pmid15345796" class="csl-entry">
Ingall, Timothy John, William Michael OFallon, Kjell Asplund, Lewis Robert Goldfrank, Vicki S. Hertzberg, Thomas Arthur Louis, and Teresa J. Hengy Christianson. 2004. <span>Findings from the Reanalysis of the NINDS Tissue Plasminogen Activator for Acute Ischemic Stroke Treatment Trial.</span> <em>Stroke</em> 35 (10): 241824. <a href="https://doi.org/10.1161/01.STR.0000140891.70547.56">https://doi.org/10.1161/01.STR.0000140891.70547.56</a>.
</div>
<div id="ref-pmid33250548" class="csl-entry">
J, Muschelli. 2020. <span>ROC and AUC with a Binary Predictor: A Potentially Misleading Metric.</span> <em>J Classif</em> 37 (October): 696708. <a href="https://doi.org/10.1007/s00357-019-09345-1">https://doi.org/10.1007/s00357-019-09345-1</a>.
</div>
<div id="ref-pmid8309035" class="csl-entry">
Jaeschke, R., G. H. Guyatt, and D. L. Sackett. 1994. <span><span class="nocase"><span>U</span>sers guides to the medical literature. <span>I</span><span>I</span><span>I</span>. <span>H</span>ow to use an article about a diagnostic test. <span>B</span>. <span>W</span>hat are the results and will they help me in caring for my patients? <span>T</span>he <span>E</span>vidence-<span>B</span>ased <span>M</span>edicine <span>W</span>orking <span>G</span>roup</span>.</span> <em>JAMA</em> 271 (9): 7037.
</div>
<div id="ref-10.1186/1745-6215-15-139" class="csl-entry">
Kahan, Jairath, B. C. 2014. <span>The Risks and Rewards of Covariate Adjustment in Randomized Trials: An Assessment of 12 Outcomes from 8 Studies.</span> <em>Trials</em> 15: 139. <a href="https://doi.org/10.1186/1745-6215-15-139">https://doi.org/10.1186/1745-6215-15-139</a>.
</div>
<div id="ref-pmid26080342" class="csl-entry">
Kaji, A. H., and R. J. Lewis. 2015. <span><span class="nocase"><span>N</span>oninferiority <span>T</span>rials: <span>I</span>s a <span>N</span>ew <span>T</span>reatment <span>A</span>lmost as <span>E</span>ffective as <span>A</span>nother?</span></span> <em>JAMA</em> 313 (23): 237172.
</div>
<div id="ref-LONGATO2020103496" class="csl-entry">
Longato, Enrico, Martina Vettoretti, and Barbara Di Camillo. 2020. <span>A Practical Perspective on the Concordance Index for the Evaluation and Selection of Prognostic Time-to-Event Models.</span> <em>Journal of Biomedical Informatics</em> 108: 103496. https://doi.org/<a href="https://doi.org/10.1016/j.jbi.2020.103496">https://doi.org/10.1016/j.jbi.2020.103496</a>.
</div>
<div id="ref-pmid32404155" class="csl-entry">
Ludwig, L., P. Darmon, and B Guerci. 2020. <span><span class="nocase">Computing and interpreting the Number Needed to Treat for Cardiovascular Outcomes Trials:Perspective on GLP-1 RA and SGLT-2i therapies</span>.</span> <em>Cardiovasc Diabetol</em>, May. <a href="https://doi.org/10.1186/s12933-020-01034-3">https://doi.org/10.1186/s12933-020-01034-3</a>.
</div>
<div id="ref-doi:10.1177/0962280216669183" class="csl-entry">
Luo, Dehui, Xiang Wan, Jiming Liu, and Tiejun Tong. 2018. <span>Optimally Estimating the Sample Mean from the Sample Size, Median, Mid-Range, and/or Mid-Quartile Range.</span> <em>Statistical Methods in Medical Research</em> 27 (6): 1785805. <a href="https://doi.org/10.1177/0962280216669183">https://doi.org/10.1177/0962280216669183</a>.
</div>
<div id="ref-pmid12614141" class="csl-entry">
Marx, Heiner C, Arthur. Bucher. 2003. <span>Numbers Needed to Treat Derived from Meta-Analysis: A Word of Caution.</span> <em>BMJ Evidence-Based Medicine</em> 8 (2): 3637. <a href="https://doi.org/10.1136/ebm.8.2.36">https://doi.org/10.1136/ebm.8.2.36</a>.
</div>
<div id="ref-pmid29912013" class="csl-entry">
Mathur MB, Riddell CA, Ding P. 2018. <span>Web Site and r Package for Computing e-Values.</span> <em>Epidemiology</em>, e4547. <a href="https://doi.org/10.1097/EDE.0000000000000864">https://doi.org/10.1097/EDE.0000000000000864</a>.
</div>
<div id="ref-pmid36412105" class="csl-entry">
McGrath, Sean, Stephan Katzenschlager, Alexander J. Zimmer, Alexander Seitel, Russell J. Steele, and Andrea Benedetti. 2022. <span>Standard Error Estimation in Meta-Analysis of Studies Reporting Medians.</span> <em>Statistical Methods in Medical Research</em> 32: 37388. <a href="https://doi.org/10.1177/09622802221139233">https://doi.org/10.1177/09622802221139233</a>.
</div>
<div id="ref-doi:10.1177/0962280219889080" class="csl-entry">
McGrath, Sean, XiaoFei Zhao, Russell Steele, Brett D. Thombs, Andrea Benedetti, the DEPRESsion Screening Data (DEPRESSD) Collaboration, Brooke Levis, et al. 2020. <span>Estimating the Sample Mean and Standard Deviation from Commonly Reported Quantiles in Meta-Analysis.</span> <em>Statistical Methods in Medical Research</em> 29 (9): 252037. <a href="https://doi.org/10.1177/0962280219889080">https://doi.org/10.1177/0962280219889080</a>.
</div>
<div id="ref-pmid8210827" class="csl-entry">
Moses, L. E., D. Shapiro, and B. Littenberg. 1993. <span><span class="nocase"><span>C</span>ombining independent studies of a diagnostic test into a summary <span>R</span><span>O</span><span>C</span> curve: data-analytic approaches and some additional considerations</span>.</span> <em>Stat Med</em> 12 (14): 12931316.
</div>
<div id="ref-pmid28579970" class="csl-entry">
Phan, T. G., B. B. Clissold, H. Ma, J. V. Ly, and V. Srikanth. 2017. <span><span class="nocase"><span>P</span>redicting <span>D</span>isability after <span>I</span>schemic <span>S</span>troke <span>B</span>ased on <span>C</span>omorbidity <span>I</span>ndex and <span>S</span>troke <span>S</span>everity-<span>F</span>rom the <span>V</span>irtual <span>I</span>nternational <span>S</span>troke <span>T</span>rials <span>A</span>rchive-<span>A</span>cute <span>C</span>ollaboration</span>.</span> <em>Front Neurol</em> 8: 192.
</div>
<div id="ref-pmid26796056" class="csl-entry">
Phan, T. G., B. Clissold, J. Ly, H. Ma, C. Moran, V. Srikanth, K. R. Lees, et al. 2016. <span><span class="nocase"><span>S</span>troke <span>S</span>everity and <span>C</span>omorbidity <span>I</span>ndex for <span>P</span>rediction of <span>M</span>ortality after <span>I</span>schemic <span>S</span>troke from the <span>V</span>irtual <span>I</span>nternational <span>S</span>troke <span>T</span>rials <span>A</span>rchive-<span>A</span>cute <span>C</span>ollaboration</span>.</span> <em>J Stroke Cerebrovasc Dis</em> 25 (4): 83542.
</div>
<div id="ref-pmid16931782" class="csl-entry">
Phan, T. G., G. A. Donnan, S. M. Davis, and G. Byrnes. 2006. <span><span class="nocase"><span>P</span>roof-of-principle phase <span>I</span><span>I</span> <span>M</span><span>R</span><span>I</span> studies in stroke: sample size estimates from dichotomous and continuous data</span>.</span> <em>Stroke</em> 37 (10): 252125.
</div>
<div id="ref-pmid16504541" class="csl-entry">
Phan, T. G., G. A. Donnan, M. Koga, L. A. Mitchell, M. Molan, G. Fitt, W. Chong, M. Holt, and D. C. Reutens. 2006. <span><span class="nocase"><span>T</span>he <span>A</span><span>S</span><span>P</span><span>E</span><span>C</span><span>T</span><span>S</span> template is weighted in favor of the striatocapsular region</span>.</span> <em>Neuroimage</em> 31 (2): 47781.
</div>
<div id="ref-pmid31272327" class="csl-entry">
Phan, T. G., N. Krishnadas, V. W. Y. Lai, M. Batt, L. A. Slater, R. V. Chandra, V. Srikanth, and H. Ma. 2019. <span><span class="nocase"><span>M</span>eta-<span>A</span>nalysis of <span>A</span>ccuracy of the <span>S</span>pot <span>S</span>ign for <span>P</span>redicting <span>H</span>ematoma <span>G</span>rowth and <span>C</span>linical <span>O</span>utcomes</span>.</span> <em>Stroke</em> 50 (8): 203036.
</div>
<div id="ref-pmid16168343" class="csl-entry">
Reitsma, J. B., A. S. Glas, A. W. Rutjes, R. J. Scholten, P. M. Bossuyt, and A. H. Zwinderman. 2005. <span><span class="nocase"><span>B</span>ivariate analysis of sensitivity and specificity produces informative summary measures in diagnostic reviews</span>.</span> <em>J Clin Epidemiol</em> 58 (10): 98290.
</div>
<div id="ref-pmid26080338" class="csl-entry">
Salminen, P., H. Paajanen, T. Rautio, P. Nordstrom, M. Aarnio, T. Rantanen, R. Tuominen, et al. 2015. <span><span class="nocase"><span>A</span>ntibiotic <span>T</span>herapy vs <span>A</span>ppendectomy for <span>T</span>reatment of <span>U</span>ncomplicated <span>A</span>cute <span>A</span>ppendicitis: <span>T</span>he <span>A</span><span>P</span><span>P</span><span>A</span><span>C</span> <span>R</span>andomized <span>C</span>linical <span>T</span>rial</span>.</span> <em>JAMA</em> 313 (23): 234048.
</div>
<div id="ref-pmid37161735" class="csl-entry">
Shi, Jiandong, Dehui Luo, Xiang Wan, Yue Liu, Jiming Liu, Zhaoxiang Bian, and Tiejun Tong. 2023. <span>Detecting the Skewness of Data from the Five-Number Summary and Its Application in Meta-Analysis.</span> <em>Statistical Methods in Medical Research</em> 32 (7): 133860. <a href="https://doi.org/10.1177/09622802231172043">https://doi.org/10.1177/09622802231172043</a>.
</div>
<div id="ref-doi10.1001/jamaneurol.2020.0678" class="csl-entry">
Signori, Alessio, Fabio Pellegrini, Francesca Bovis, Luca Carmisciano, Carl de Moor, and Maria Pia Sormani. 2020. <span><span class="nocase">Comparison of Placebos and Propensity Score Adjustment in Multiple Sclerosis Nonrandomized Studies</span>.</span> <em>JAMA Neurology</em>, April. <a href="https://doi.org/10.1001/jamaneurol.2020.0678">https://doi.org/10.1001/jamaneurol.2020.0678</a>.
</div>
<div id="ref-pmid10356018" class="csl-entry">
Smeeth, A. Ebrahim, L. Haines. 1999. <span><span class="nocase">Numbers needed to treat derived from meta-analysessometimes informative, usually misleading</span>.</span> <em>BMJ</em> 318: 154851. <a href="https://doi.org/10.1136/bmj.318.7197.1548">https://doi.org/10.1136/bmj.318.7197.1548</a>.
</div>
<div id="ref-pmid32167523" class="csl-entry">
Stensrud, M. J., and M. A. Hernan. 2020. <span><span class="nocase"><span>W</span>hy <span>T</span>est for <span>P</span>roportional <span>H</span>azards?</span></span> <em>JAMA</em>, March.
</div>
<div id="ref-pmid1143310" class="csl-entry">
TJ, Fagan. 1975. <span>Nomogram for Bayess Theorem.</span> <em>N Engl J Med</em> 293 (July): 257. <a href="https://doi.org/10.1056/NEJM197507312930513">https://doi.org/10.1056/NEJM197507312930513</a>.
</div>
<div id="ref-pmid28693043" class="csl-entry">
VanderWeele TJ, Ding P. 2017. <span>Sensitivity Analysis in Observational Research: Introducing the e-Value.</span> <em>Ann Intern Med</em> 167 (August): 26874. <a href="https://doi.org/10.7326/M16-2607">https://doi.org/10.7326/M16-2607</a>.
</div>
<div id="ref-JSSv036i03" class="csl-entry">
Viechtbauer, Wolfgang. 2010. <span>Conducting Meta-Analyses in r with the Metafor Package.</span> <em>Journal of Statistical Software</em> 36 (3): 148. <a href="https://doi.org/10.18637/jss.v036.i03">https://doi.org/10.18637/jss.v036.i03</a>.
</div>
<div id="ref-pmid25524443" class="csl-entry">
Wan, Wang, X. 2014. <span>Estimating the Sample Mean and Standard Deviation from the Sample Size, Median, Range and/or Interquartile Range.</span> <em>BMC Med Res Methodol</em>, December. https://doi.org/<a href="https://doi.org/10.1186/1471-2288-14-135">https://doi.org/10.1186/1471-2288-14-135</a>.
</div>
<div id="ref-doi:10.1056/NEJMsr077003" class="csl-entry">
Wang, Rui, Stephen W. Lagakos, James H. Ware, David J. Hunter, and Jeffrey M. Drazen. 2007. <span>Statistics in Medicine  Reporting of Subgroup Analyses in Clinical Trials.</span> <em>New England Journal of Medicine</em> 357 (21): 218994. <a href="https://doi.org/10.1056/NEJMsr077003">https://doi.org/10.1056/NEJMsr077003</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-wrangling.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multivariate-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/03-Statistics.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Applications-of-R-in-Healthcare.pdf", "Applications-of-R-in-Healthcare.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
