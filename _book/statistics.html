<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Statistics | Applications of R in Healthcare</title>
  <meta name="description" content="This is a book describing the use of R in Healthcare. It is aimed at beginners of R language. The majority of the examples are taken from works in Neurology. Where possible data from other disease such as heart disease, cancer and vaccine are used. The ideas and principles can be applied to other aspects of Healthcare. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Statistics | Applications of R in Healthcare" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a book describing the use of R in Healthcare. It is aimed at beginners of R language. The majority of the examples are taken from works in Neurology. Where possible data from other disease such as heart disease, cancer and vaccine are used. The ideas and principles can be applied to other aspects of Healthcare. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="GNtem2/HealthcareRbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Statistics | Applications of R in Healthcare" />
  
  <meta name="twitter:description" content="This is a book describing the use of R in Healthcare. It is aimed at beginners of R language. The majority of the examples are taken from works in Neurology. Where possible data from other disease such as heart disease, cancer and vaccine are used. The ideas and principles can be applied to other aspects of Healthcare. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Thanh Phan" />


<meta name="date" content="2023-03-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-wrangling.html"/>
<link rel="next" href="multivariate-analysis-1.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applications-of-R-in-Healthcare</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preamble</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#plot-using-base-r"><i class="fa fa-check"></i><b>2.1</b> Plot using base R</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#ggplot2"><i class="fa fa-check"></i><b>2.2</b> ggplot2</a><ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#histogram"><i class="fa fa-check"></i><b>2.2.1</b> Histogram</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#bar-plot"><i class="fa fa-check"></i><b>2.2.2</b> Bar plot</a></li>
<li class="chapter" data-level="2.2.3" data-path="intro.html"><a href="intro.html#pie-chart"><i class="fa fa-check"></i><b>2.2.3</b> Pie chart</a></li>
<li class="chapter" data-level="2.2.4" data-path="intro.html"><a href="intro.html#scatter-plot"><i class="fa fa-check"></i><b>2.2.4</b> Scatter plot</a></li>
<li class="chapter" data-level="2.2.5" data-path="intro.html"><a href="intro.html#arrange-plot-in-grids"><i class="fa fa-check"></i><b>2.2.5</b> arrange plot in grids</a></li>
<li class="chapter" data-level="2.2.6" data-path="intro.html"><a href="intro.html#line-plot"><i class="fa fa-check"></i><b>2.2.6</b> Line plot</a></li>
<li class="chapter" data-level="2.2.7" data-path="intro.html"><a href="intro.html#facet-wrap"><i class="fa fa-check"></i><b>2.2.7</b> Facet wrap</a></li>
<li class="chapter" data-level="2.2.8" data-path="intro.html"><a href="intro.html#polygons"><i class="fa fa-check"></i><b>2.2.8</b> Polygons</a></li>
<li class="chapter" data-level="2.2.9" data-path="intro.html"><a href="intro.html#gantt-chart"><i class="fa fa-check"></i><b>2.2.9</b> Gantt chart</a></li>
<li class="chapter" data-level="2.2.10" data-path="intro.html"><a href="intro.html#heatmap"><i class="fa fa-check"></i><b>2.2.10</b> Heatmap</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#ggplot2-extra"><i class="fa fa-check"></i><b>2.3</b> ggplot2 extra</a><ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#alluvial-and-sankey-diagram"><i class="fa fa-check"></i><b>2.3.1</b> Alluvial and Sankey diagram</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro.html"><a href="intro.html#survival-plot"><i class="fa fa-check"></i><b>2.3.2</b> Survival plot</a></li>
<li class="chapter" data-level="2.3.3" data-path="intro.html"><a href="intro.html#ggraph-and-tidygraph"><i class="fa fa-check"></i><b>2.3.3</b> ggraph and tidygraph</a></li>
<li class="chapter" data-level="2.3.4" data-path="intro.html"><a href="intro.html#ggparty-decision-tree"><i class="fa fa-check"></i><b>2.3.4</b> ggparty-decision tree</a></li>
<li class="chapter" data-level="2.3.5" data-path="intro.html"><a href="intro.html#ggroc--roc-curve"><i class="fa fa-check"></i><b>2.3.5</b> ggROC- ROC curve</a></li>
<li class="chapter" data-level="2.3.6" data-path="intro.html"><a href="intro.html#map"><i class="fa fa-check"></i><b>2.3.6</b> Map</a></li>
<li class="chapter" data-level="2.3.7" data-path="intro.html"><a href="intro.html#ggwordcloud"><i class="fa fa-check"></i><b>2.3.7</b> ggwordcloud</a></li>
<li class="chapter" data-level="2.3.8" data-path="intro.html"><a href="intro.html#gganimate"><i class="fa fa-check"></i><b>2.3.8</b> gganimate</a></li>
<li class="chapter" data-level="2.3.9" data-path="intro.html"><a href="intro.html#ggneuro"><i class="fa fa-check"></i><b>2.3.9</b> ggneuro</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#plotly"><i class="fa fa-check"></i><b>2.4</b> plotly</a><ul>
<li class="chapter" data-level="2.4.1" data-path="intro.html"><a href="intro.html#scatter-plot-1"><i class="fa fa-check"></i><b>2.4.1</b> Scatter plot</a></li>
<li class="chapter" data-level="2.4.2" data-path="intro.html"><a href="intro.html#bar-plot-1"><i class="fa fa-check"></i><b>2.4.2</b> Bar plot</a></li>
<li class="chapter" data-level="2.4.3" data-path="intro.html"><a href="intro.html#heatmap-1"><i class="fa fa-check"></i><b>2.4.3</b> Heatmap</a></li>
<li class="chapter" data-level="2.4.4" data-path="intro.html"><a href="intro.html#map-1"><i class="fa fa-check"></i><b>2.4.4</b> map</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>3</b> Data Wrangling</a><ul>
<li class="chapter" data-level="3.1" data-path="data-wrangling.html"><a href="data-wrangling.html#data"><i class="fa fa-check"></i><b>3.1</b> Data</a><ul>
<li class="chapter" data-level="3.1.1" data-path="data-wrangling.html"><a href="data-wrangling.html#vector-arrays-matrix"><i class="fa fa-check"></i><b>3.1.1</b> Vector, Arrays, Matrix</a></li>
<li class="chapter" data-level="3.1.2" data-path="data-wrangling.html"><a href="data-wrangling.html#apply-lapply-sapply"><i class="fa fa-check"></i><b>3.1.2</b> apply, lapply, sapply</a></li>
<li class="chapter" data-level="3.1.3" data-path="data-wrangling.html"><a href="data-wrangling.html#simple-function"><i class="fa fa-check"></i><b>3.1.3</b> Simple function</a></li>
<li class="chapter" data-level="3.1.4" data-path="data-wrangling.html"><a href="data-wrangling.html#for-loop"><i class="fa fa-check"></i><b>3.1.4</b> for loop</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-wrangling.html"><a href="data-wrangling.html#data-storage"><i class="fa fa-check"></i><b>3.2</b> Data storage</a><ul>
<li class="chapter" data-level="3.2.1" data-path="data-wrangling.html"><a href="data-wrangling.html#data-frame"><i class="fa fa-check"></i><b>3.2.1</b> Data frame</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-wrangling.html"><a href="data-wrangling.html#excel-data"><i class="fa fa-check"></i><b>3.2.2</b> Excel data</a></li>
<li class="chapter" data-level="3.2.3" data-path="data-wrangling.html"><a href="data-wrangling.html#foreign-data"><i class="fa fa-check"></i><b>3.2.3</b> Foreign data</a></li>
<li class="chapter" data-level="3.2.4" data-path="data-wrangling.html"><a href="data-wrangling.html#json-format"><i class="fa fa-check"></i><b>3.2.4</b> json format</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-wrangling.html"><a href="data-wrangling.html#tidy-data"><i class="fa fa-check"></i><b>3.3</b> Tidy data</a><ul>
<li class="chapter" data-level="3.3.1" data-path="data-wrangling.html"><a href="data-wrangling.html#factors"><i class="fa fa-check"></i><b>3.3.1</b> Factors</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-wrangling.html"><a href="data-wrangling.html#multiple-files"><i class="fa fa-check"></i><b>3.3.2</b> Multiple files</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-wrangling.html"><a href="data-wrangling.html#pivot"><i class="fa fa-check"></i><b>3.3.3</b> Pivot</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-wrangling.html"><a href="data-wrangling.html#regular-expressions"><i class="fa fa-check"></i><b>3.4</b> Regular Expressions</a><ul>
<li class="chapter" data-level="3.4.1" data-path="data-wrangling.html"><a href="data-wrangling.html#base-r"><i class="fa fa-check"></i><b>3.4.1</b> base R</a></li>
<li class="chapter" data-level="3.4.2" data-path="data-wrangling.html"><a href="data-wrangling.html#stringr"><i class="fa fa-check"></i><b>3.4.2</b> stringr</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="data-wrangling.html"><a href="data-wrangling.html#pdf-to-xcel"><i class="fa fa-check"></i><b>3.5</b> PDF to xcel</a><ul>
<li class="chapter" data-level="3.5.1" data-path="data-wrangling.html"><a href="data-wrangling.html#scanned-text-or-picture"><i class="fa fa-check"></i><b>3.5.1</b> Scanned text or picture</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="data-wrangling.html"><a href="data-wrangling.html#web-scraping"><i class="fa fa-check"></i><b>3.6</b> Web scraping</a></li>
<li class="chapter" data-level="3.7" data-path="data-wrangling.html"><a href="data-wrangling.html#manipulating-medical-images"><i class="fa fa-check"></i><b>3.7</b> Manipulating Medical Images</a><ul>
<li class="chapter" data-level="3.7.1" data-path="data-wrangling.html"><a href="data-wrangling.html#dicom-and-nifti-format"><i class="fa fa-check"></i><b>3.7.1</b> DICOM and nifti format</a></li>
<li class="chapter" data-level="3.7.2" data-path="data-wrangling.html"><a href="data-wrangling.html#manipulating-array-of-medical-images"><i class="fa fa-check"></i><b>3.7.2</b> Manipulating array of medical images</a></li>
<li class="chapter" data-level="3.7.3" data-path="data-wrangling.html"><a href="data-wrangling.html#combining-arrays"><i class="fa fa-check"></i><b>3.7.3</b> Combining arrays</a></li>
<li class="chapter" data-level="3.7.4" data-path="data-wrangling.html"><a href="data-wrangling.html#math-operation"><i class="fa fa-check"></i><b>3.7.4</b> Math operation</a></li>
<li class="chapter" data-level="3.7.5" data-path="data-wrangling.html"><a href="data-wrangling.html#multivariate-analysis"><i class="fa fa-check"></i><b>3.7.5</b> Multivariate analysis</a></li>
<li class="chapter" data-level="3.7.6" data-path="data-wrangling.html"><a href="data-wrangling.html#tar-file"><i class="fa fa-check"></i><b>3.7.6</b> tar file</a></li>
<li class="chapter" data-level="3.7.7" data-path="data-wrangling.html"><a href="data-wrangling.html#image-registration"><i class="fa fa-check"></i><b>3.7.7</b> Image registration</a></li>
<li class="chapter" data-level="3.7.8" data-path="data-wrangling.html"><a href="data-wrangling.html#rescaling"><i class="fa fa-check"></i><b>3.7.8</b> Rescaling</a></li>
<li class="chapter" data-level="3.7.9" data-path="data-wrangling.html"><a href="data-wrangling.html#labelling-aal-atlas"><i class="fa fa-check"></i><b>3.7.9</b> Labelling AAL atlas</a></li>
<li class="chapter" data-level="3.7.10" data-path="data-wrangling.html"><a href="data-wrangling.html#add-text"><i class="fa fa-check"></i><b>3.7.10</b> add text</a></li>
<li class="chapter" data-level="3.7.11" data-path="data-wrangling.html"><a href="data-wrangling.html#add-text-1"><i class="fa fa-check"></i><b>3.7.11</b> add text</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>4</b> Statistics</a><ul>
<li class="chapter" data-level="4.1" data-path="statistics.html"><a href="statistics.html#univariable-analyses"><i class="fa fa-check"></i><b>4.1</b> Univariable analyses</a><ul>
<li class="chapter" data-level="4.1.1" data-path="statistics.html"><a href="statistics.html#parametric-tests"><i class="fa fa-check"></i><b>4.1.1</b> Parametric tests</a></li>
<li class="chapter" data-level="4.1.2" data-path="statistics.html"><a href="statistics.html#non-parametric-tests"><i class="fa fa-check"></i><b>4.1.2</b> Non-parametric tests</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="statistics.html"><a href="statistics.html#regression"><i class="fa fa-check"></i><b>4.2</b> Regression</a><ul>
<li class="chapter" data-level="4.2.1" data-path="statistics.html"><a href="statistics.html#brief-review-of-matrix"><i class="fa fa-check"></i><b>4.2.1</b> Brief review of matrix</a></li>
<li class="chapter" data-level="4.2.2" data-path="statistics.html"><a href="statistics.html#linear-least-square-regression"><i class="fa fa-check"></i><b>4.2.2</b> Linear (least square) regression</a></li>
<li class="chapter" data-level="4.2.3" data-path="statistics.html"><a href="statistics.html#logistic-regression"><i class="fa fa-check"></i><b>4.2.3</b> Logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="statistics.html"><a href="statistics.html#special-types-of-regression"><i class="fa fa-check"></i><b>4.3</b> Special types of regression</a><ul>
<li class="chapter" data-level="4.3.1" data-path="statistics.html"><a href="statistics.html#ordinal-regression"><i class="fa fa-check"></i><b>4.3.1</b> Ordinal regression</a></li>
<li class="chapter" data-level="4.3.2" data-path="statistics.html"><a href="statistics.html#survival-analysis"><i class="fa fa-check"></i><b>4.3.2</b> Survival analysis</a></li>
<li class="chapter" data-level="4.3.3" data-path="statistics.html"><a href="statistics.html#quantile-regression"><i class="fa fa-check"></i><b>4.3.3</b> Quantile regression</a></li>
<li class="chapter" data-level="4.3.4" data-path="statistics.html"><a href="statistics.html#poisson-regression"><i class="fa fa-check"></i><b>4.3.4</b> Poisson regression</a></li>
<li class="chapter" data-level="4.3.5" data-path="statistics.html"><a href="statistics.html#conditional-logistic-regression"><i class="fa fa-check"></i><b>4.3.5</b> Conditional logistic regression</a></li>
<li class="chapter" data-level="4.3.6" data-path="statistics.html"><a href="statistics.html#multinomial-modelling"><i class="fa fa-check"></i><b>4.3.6</b> Multinomial modelling</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="statistics.html"><a href="statistics.html#sample-size-estimation"><i class="fa fa-check"></i><b>4.4</b> Sample size estimation</a><ul>
<li class="chapter" data-level="4.4.1" data-path="statistics.html"><a href="statistics.html#proportion"><i class="fa fa-check"></i><b>4.4.1</b> Proportion</a></li>
<li class="chapter" data-level="4.4.2" data-path="statistics.html"><a href="statistics.html#logistic-regression-1"><i class="fa fa-check"></i><b>4.4.2</b> Logistic regression</a></li>
<li class="chapter" data-level="4.4.3" data-path="statistics.html"><a href="statistics.html#survival-studies"><i class="fa fa-check"></i><b>4.4.3</b> Survival studies</a></li>
<li class="chapter" data-level="4.4.4" data-path="statistics.html"><a href="statistics.html#multiple-regression"><i class="fa fa-check"></i><b>4.4.4</b> Multiple regression</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="statistics.html"><a href="statistics.html#interpreting-clinical-trials"><i class="fa fa-check"></i><b>4.5</b> Interpreting clinical trials</a><ul>
<li class="chapter" data-level="4.5.1" data-path="statistics.html"><a href="statistics.html#nnt-from-arr"><i class="fa fa-check"></i><b>4.5.1</b> NNT from ARR</a></li>
<li class="chapter" data-level="4.5.2" data-path="statistics.html"><a href="statistics.html#nnt-from-odds-ratio"><i class="fa fa-check"></i><b>4.5.2</b> NNT from odds ratio</a></li>
<li class="chapter" data-level="4.5.3" data-path="statistics.html"><a href="statistics.html#nnt-from-hazard-ratio"><i class="fa fa-check"></i><b>4.5.3</b> NNT from hazard ratio</a></li>
<li class="chapter" data-level="4.5.4" data-path="statistics.html"><a href="statistics.html#nnt-from-metaananlysis"><i class="fa fa-check"></i><b>4.5.4</b> NNT from metaananlysis</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="statistics.html"><a href="statistics.html#metaanalysis"><i class="fa fa-check"></i><b>4.6</b> Metaanalysis</a><ul>
<li class="chapter" data-level="4.6.1" data-path="statistics.html"><a href="statistics.html#prisma"><i class="fa fa-check"></i><b>4.6.1</b> PRISMA</a></li>
<li class="chapter" data-level="4.6.2" data-path="statistics.html"><a href="statistics.html#conversion-of-mean-and-median"><i class="fa fa-check"></i><b>4.6.2</b> Conversion of mean and median</a></li>
<li class="chapter" data-level="4.6.3" data-path="statistics.html"><a href="statistics.html#inconsistency-i2"><i class="fa fa-check"></i><b>4.6.3</b> Inconsistency I2</a></li>
<li class="chapter" data-level="4.6.4" data-path="statistics.html"><a href="statistics.html#metaanalysis-of-proportion"><i class="fa fa-check"></i><b>4.6.4</b> Metaanalysis of proportion</a></li>
<li class="chapter" data-level="4.6.5" data-path="statistics.html"><a href="statistics.html#bivariate-metaanalysis"><i class="fa fa-check"></i><b>4.6.5</b> Bivariate Metaanalysis</a></li>
<li class="chapter" data-level="4.6.6" data-path="statistics.html"><a href="statistics.html#metaanalysis-of-clinical-trial."><i class="fa fa-check"></i><b>4.6.6</b> Metaanalysis of clinical trial.</a></li>
<li class="chapter" data-level="4.6.7" data-path="statistics.html"><a href="statistics.html#metaregression"><i class="fa fa-check"></i><b>4.6.7</b> Metaregression</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="statistics.html"><a href="statistics.html#data-simulation"><i class="fa fa-check"></i><b>4.7</b> Data simulation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multivariate-analysis-1.html"><a href="multivariate-analysis-1.html"><i class="fa fa-check"></i><b>5</b> Multivariate Analysis</a><ul>
<li class="chapter" data-level="5.1" data-path="multivariate-analysis-1.html"><a href="multivariate-analysis-1.html#multivariate-regression"><i class="fa fa-check"></i><b>5.1</b> Multivariate regression</a><ul>
<li class="chapter" data-level="5.1.1" data-path="multivariate-analysis-1.html"><a href="multivariate-analysis-1.html#penalised-regression"><i class="fa fa-check"></i><b>5.1.1</b> Penalised regression</a></li>
<li class="chapter" data-level="5.1.2" data-path="multivariate-analysis-1.html"><a href="multivariate-analysis-1.html#mars"><i class="fa fa-check"></i><b>5.1.2</b> MARS</a></li>
<li class="chapter" data-level="5.1.3" data-path="multivariate-analysis-1.html"><a href="multivariate-analysis-1.html#mixed-modelling"><i class="fa fa-check"></i><b>5.1.3</b> Mixed modelling</a></li>
<li class="chapter" data-level="5.1.4" data-path="multivariate-analysis-1.html"><a href="multivariate-analysis-1.html#trajectory-modelling"><i class="fa fa-check"></i><b>5.1.4</b> Trajectory modelling</a></li>
<li class="chapter" data-level="5.1.5" data-path="multivariate-analysis-1.html"><a href="multivariate-analysis-1.html#generalized-estimating-equation-gee"><i class="fa fa-check"></i><b>5.1.5</b> Generalized estimating equation (GEE)</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="multivariate-analysis-1.html"><a href="multivariate-analysis-1.html#principal-component-analysis"><i class="fa fa-check"></i><b>5.2</b> Principal component analysis</a></li>
<li class="chapter" data-level="5.3" data-path="multivariate-analysis-1.html"><a href="multivariate-analysis-1.html#independent-component-analysis"><i class="fa fa-check"></i><b>5.3</b> Independent component analysis</a></li>
<li class="chapter" data-level="5.4" data-path="multivariate-analysis-1.html"><a href="multivariate-analysis-1.html#partial-least-squares"><i class="fa fa-check"></i><b>5.4</b> Partial least squares</a></li>
<li class="chapter" data-level="5.5" data-path="multivariate-analysis-1.html"><a href="multivariate-analysis-1.html#causal-inference"><i class="fa fa-check"></i><b>5.5</b> Causal inference</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="machine-learning.html"><a href="machine-learning.html"><i class="fa fa-check"></i><b>6</b> Machine learning</a><ul>
<li class="chapter" data-level="6.1" data-path="machine-learning.html"><a href="machine-learning.html#decision-tree-analysis"><i class="fa fa-check"></i><b>6.1</b> Decision tree analysis</a><ul>
<li class="chapter" data-level="6.1.1" data-path="machine-learning.html"><a href="machine-learning.html#information-theory-driven"><i class="fa fa-check"></i><b>6.1.1</b> Information theory driven</a></li>
<li class="chapter" data-level="6.1.2" data-path="machine-learning.html"><a href="machine-learning.html#conditional-decision-tree"><i class="fa fa-check"></i><b>6.1.2</b> Conditional decision tree</a></li>
<li class="chapter" data-level="6.1.3" data-path="machine-learning.html"><a href="machine-learning.html#criticisms-of-decision-tree"><i class="fa fa-check"></i><b>6.1.3</b> criticisms of decision tree</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="machine-learning.html"><a href="machine-learning.html#random-forest"><i class="fa fa-check"></i><b>6.2</b> Random Forest</a></li>
<li class="chapter" data-level="6.3" data-path="machine-learning.html"><a href="machine-learning.html#gradient-boost-machine"><i class="fa fa-check"></i><b>6.3</b> Gradient Boost Machine</a><ul>
<li class="chapter" data-level="6.3.1" data-path="machine-learning.html"><a href="machine-learning.html#extreme-gradient-boost-machine"><i class="fa fa-check"></i><b>6.3.1</b> Extreme gradient boost machine</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="machine-learning.html"><a href="machine-learning.html#knn"><i class="fa fa-check"></i><b>6.4</b> KNN</a></li>
<li class="chapter" data-level="6.5" data-path="machine-learning.html"><a href="machine-learning.html#support-vector-machine"><i class="fa fa-check"></i><b>6.5</b> Support vector machine</a><ul>
<li class="chapter" data-level="6.5.1" data-path="machine-learning.html"><a href="machine-learning.html#survival-analysis-using-random-forest"><i class="fa fa-check"></i><b>6.5.1</b> Survival analysis using random forest</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="machine-learning.html"><a href="machine-learning.html#non-negative-matrix-factorisation"><i class="fa fa-check"></i><b>6.6</b> Non-negative matrix factorisation</a></li>
<li class="chapter" data-level="6.7" data-path="machine-learning.html"><a href="machine-learning.html#formal-concept-analysis"><i class="fa fa-check"></i><b>6.7</b> Formal concept analysis</a></li>
<li class="chapter" data-level="6.8" data-path="machine-learning.html"><a href="machine-learning.html#evolutionary-algorithm"><i class="fa fa-check"></i><b>6.8</b> Evolutionary Algorithm</a><ul>
<li class="chapter" data-level="6.8.1" data-path="machine-learning.html"><a href="machine-learning.html#simulated-annealing"><i class="fa fa-check"></i><b>6.8.1</b> Simulated Annealing</a></li>
<li class="chapter" data-level="6.8.2" data-path="machine-learning.html"><a href="machine-learning.html#genetic-algorithm"><i class="fa fa-check"></i><b>6.8.2</b> Genetic Algorithm</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="machine-learning.html"><a href="machine-learning.html#manifold-learning"><i class="fa fa-check"></i><b>6.9</b> Manifold learning</a><ul>
<li class="chapter" data-level="6.9.1" data-path="machine-learning.html"><a href="machine-learning.html#t-stochastic-neighbourhood-embedding"><i class="fa fa-check"></i><b>6.9.1</b> T-Stochastic Neighbourhood Embedding</a></li>
<li class="chapter" data-level="6.9.2" data-path="machine-learning.html"><a href="machine-learning.html#self-organising-map"><i class="fa fa-check"></i><b>6.9.2</b> Self organising map</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="machine-learning.html"><a href="machine-learning.html#deep-learning"><i class="fa fa-check"></i><b>6.10</b> Deep learning</a><ul>
<li class="chapter" data-level="6.10.1" data-path="machine-learning.html"><a href="machine-learning.html#multiplayer-perceptron"><i class="fa fa-check"></i><b>6.10.1</b> Multiplayer Perceptron</a></li>
<li class="chapter" data-level="6.10.2" data-path="machine-learning.html"><a href="machine-learning.html#cnn"><i class="fa fa-check"></i><b>6.10.2</b> CNN</a></li>
<li class="chapter" data-level="6.10.3" data-path="machine-learning.html"><a href="machine-learning.html#rnn"><i class="fa fa-check"></i><b>6.10.3</b> RNN</a></li>
<li class="chapter" data-level="6.10.4" data-path="machine-learning.html"><a href="machine-learning.html#reinforcement-learning"><i class="fa fa-check"></i><b>6.10.4</b> Reinforcement learning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html"><i class="fa fa-check"></i><b>7</b> Machine Learning Part 2</a><ul>
<li class="chapter" data-level="7.1" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#bag-of-words"><i class="fa fa-check"></i><b>7.1</b> Bag of words</a><ul>
<li class="chapter" data-level="7.1.1" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#tfidf"><i class="fa fa-check"></i><b>7.1.1</b> TFIDF</a></li>
<li class="chapter" data-level="7.1.2" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#extracting-data-from-web"><i class="fa fa-check"></i><b>7.1.2</b> Extracting data from web</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#wordcloud"><i class="fa fa-check"></i><b>7.2</b> Wordcloud</a></li>
<li class="chapter" data-level="7.3" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#bigram-analysis"><i class="fa fa-check"></i><b>7.3</b> Bigram analysis</a></li>
<li class="chapter" data-level="7.4" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#trigram"><i class="fa fa-check"></i><b>7.4</b> Trigram</a></li>
<li class="chapter" data-level="7.5" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#topic-modeling-or-thematic-analysis"><i class="fa fa-check"></i><b>7.5</b> Topic modeling or thematic analysis</a><ul>
<li class="chapter" data-level="7.5.1" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#probabilistic-topic-model"><i class="fa fa-check"></i><b>7.5.1</b> Probabilistic topic model</a></li>
<li class="chapter" data-level="7.5.2" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#nmf"><i class="fa fa-check"></i><b>7.5.2</b> NMF</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html"><i class="fa fa-check"></i><b>8</b> Bayesian Analysis</a><ul>
<li class="chapter" data-level="8.1" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#baysian-belief"><i class="fa fa-check"></i><b>8.1</b> Baysian belief</a><ul>
<li class="chapter" data-level="8.1.1" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#conditional-probability"><i class="fa fa-check"></i><b>8.1.1</b> Conditional probability</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#markov-model"><i class="fa fa-check"></i><b>8.2</b> Markov model</a></li>
<li class="chapter" data-level="8.3" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#inla-stan-and-bugs"><i class="fa fa-check"></i><b>8.3</b> INLA, Stan and BUGS</a><ul>
<li class="chapter" data-level="8.3.1" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#linear-regression"><i class="fa fa-check"></i><b>8.3.1</b> Linear regression</a></li>
<li class="chapter" data-level="8.3.2" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#logistic-regression-2"><i class="fa fa-check"></i><b>8.3.2</b> Logistic regression</a></li>
<li class="chapter" data-level="8.3.3" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#mixed-model"><i class="fa fa-check"></i><b>8.3.3</b> Mixed model</a></li>
<li class="chapter" data-level="8.3.4" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#bayesian-metaanalysis"><i class="fa fa-check"></i><b>8.3.4</b> Bayesian Metaanalysis</a></li>
<li class="chapter" data-level="8.3.5" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#cost"><i class="fa fa-check"></i><b>8.3.5</b> Cost</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="operational-research.html"><a href="operational-research.html"><i class="fa fa-check"></i><b>9</b> Operational Research</a><ul>
<li class="chapter" data-level="9.1" data-path="operational-research.html"><a href="operational-research.html#queueing-theory"><i class="fa fa-check"></i><b>9.1</b> Queueing theory</a></li>
<li class="chapter" data-level="9.2" data-path="operational-research.html"><a href="operational-research.html#discrete-event-simulations"><i class="fa fa-check"></i><b>9.2</b> Discrete Event Simulations</a><ul>
<li class="chapter" data-level="9.2.1" data-path="operational-research.html"><a href="operational-research.html#simulate-capacity-of-system"><i class="fa fa-check"></i><b>9.2.1</b> Simulate capacity of system</a></li>
<li class="chapter" data-level="9.2.2" data-path="operational-research.html"><a href="operational-research.html#queuing-network"><i class="fa fa-check"></i><b>9.2.2</b> Queuing network</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="operational-research.html"><a href="operational-research.html#linear-programming"><i class="fa fa-check"></i><b>9.3</b> Linear Programming</a></li>
<li class="chapter" data-level="9.4" data-path="operational-research.html"><a href="operational-research.html#forecasting"><i class="fa fa-check"></i><b>9.4</b> Forecasting</a><ul>
<li class="chapter" data-level="9.4.1" data-path="operational-research.html"><a href="operational-research.html#bed-requirement"><i class="fa fa-check"></i><b>9.4.1</b> Bed requirement</a></li>
<li class="chapter" data-level="9.4.2" data-path="operational-research.html"><a href="operational-research.html#length-of-stay"><i class="fa fa-check"></i><b>9.4.2</b> Length of stay</a></li>
<li class="chapter" data-level="9.4.3" data-path="operational-research.html"><a href="operational-research.html#customer-churns"><i class="fa fa-check"></i><b>9.4.3</b> Customer churns</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="operational-research.html"><a href="operational-research.html#process-mapping"><i class="fa fa-check"></i><b>9.5</b> Process mapping</a></li>
<li class="chapter" data-level="9.6" data-path="operational-research.html"><a href="operational-research.html#supply-chains"><i class="fa fa-check"></i><b>9.6</b> Supply chains</a></li>
<li class="chapter" data-level="9.7" data-path="operational-research.html"><a href="operational-research.html#health-economics"><i class="fa fa-check"></i><b>9.7</b> Health economics</a><ul>
<li class="chapter" data-level="9.7.1" data-path="operational-research.html"><a href="operational-research.html#cost-1"><i class="fa fa-check"></i><b>9.7.1</b> Cost</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="graph-theory.html"><a href="graph-theory.html"><i class="fa fa-check"></i><b>10</b> Graph Theory</a><ul>
<li class="chapter" data-level="10.1" data-path="graph-theory.html"><a href="graph-theory.html#special-graphs"><i class="fa fa-check"></i><b>10.1</b> Special graphs</a><ul>
<li class="chapter" data-level="10.1.1" data-path="graph-theory.html"><a href="graph-theory.html#laplacian-matrix"><i class="fa fa-check"></i><b>10.1.1</b> Laplacian matrix</a></li>
<li class="chapter" data-level="10.1.2" data-path="graph-theory.html"><a href="graph-theory.html#bimodal-bipartite-graph"><i class="fa fa-check"></i><b>10.1.2</b> Bimodal (bipartite) graph</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="graph-theory.html"><a href="graph-theory.html#centrality-measures"><i class="fa fa-check"></i><b>10.2</b> Centrality Measures</a><ul>
<li class="chapter" data-level="10.2.1" data-path="graph-theory.html"><a href="graph-theory.html#local-centrality-measures"><i class="fa fa-check"></i><b>10.2.1</b> Local centrality measures</a></li>
<li class="chapter" data-level="10.2.2" data-path="graph-theory.html"><a href="graph-theory.html#global-centrality-measures"><i class="fa fa-check"></i><b>10.2.2</b> Global centrality measures</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="graph-theory.html"><a href="graph-theory.html#community"><i class="fa fa-check"></i><b>10.3</b> Community</a></li>
<li class="chapter" data-level="10.4" data-path="graph-theory.html"><a href="graph-theory.html#visualising-graph"><i class="fa fa-check"></i><b>10.4</b> Visualising graph</a><ul>
<li class="chapter" data-level="10.4.1" data-path="graph-theory.html"><a href="graph-theory.html#visnetwork"><i class="fa fa-check"></i><b>10.4.1</b> Visnetwork</a></li>
<li class="chapter" data-level="10.4.2" data-path="graph-theory.html"><a href="graph-theory.html#large-graph"><i class="fa fa-check"></i><b>10.4.2</b> Large graph</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="graph-theory.html"><a href="graph-theory.html#social-media-and-network-analysis"><i class="fa fa-check"></i><b>10.5</b> Social Media and Network Analysis</a><ul>
<li class="chapter" data-level="10.5.1" data-path="graph-theory.html"><a href="graph-theory.html#twitter"><i class="fa fa-check"></i><b>10.5.1</b> Twitter</a></li>
<li class="chapter" data-level="10.5.2" data-path="graph-theory.html"><a href="graph-theory.html#youtube"><i class="fa fa-check"></i><b>10.5.2</b> Youtube</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html"><i class="fa fa-check"></i><b>11</b> Geospatial analysis</a><ul>
<li class="chapter" data-level="11.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#geocoding"><i class="fa fa-check"></i><b>11.1</b> Geocoding</a><ul>
<li class="chapter" data-level="11.1.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#openstreetmap"><i class="fa fa-check"></i><b>11.1.1</b> OpenStreetMap</a></li>
<li class="chapter" data-level="11.1.2" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#google-maps-api"><i class="fa fa-check"></i><b>11.1.2</b> Google Maps API</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#sp-and-sf-objects"><i class="fa fa-check"></i><b>11.2</b> Sp and sf objects</a></li>
<li class="chapter" data-level="11.3" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#thematic-map-1"><i class="fa fa-check"></i><b>11.3</b> Thematic map</a><ul>
<li class="chapter" data-level="11.3.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#calculate-distance-to-hospital-openstreetmap"><i class="fa fa-check"></i><b>11.3.1</b> Calculate distance to Hospital-OpenStreetMap</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#spatial-regression"><i class="fa fa-check"></i><b>11.4</b> Spatial regression</a><ul>
<li class="chapter" data-level="11.4.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#new-york-covid-19-mortality"><i class="fa fa-check"></i><b>11.4.1</b> New York COVID-19 mortality</a></li>
<li class="chapter" data-level="11.4.2" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#danish-stroke-registry"><i class="fa fa-check"></i><b>11.4.2</b> Danish Stroke Registry</a></li>
<li class="chapter" data-level="11.4.3" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#inla"><i class="fa fa-check"></i><b>11.4.3</b> INLA</a></li>
<li class="chapter" data-level="11.4.4" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#stan"><i class="fa fa-check"></i><b>11.4.4</b> Stan</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#machine-learning-1"><i class="fa fa-check"></i><b>11.5</b> Machine learning</a></li>
<li class="chapter" data-level="11.6" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#spatio-temporal-regression"><i class="fa fa-check"></i><b>11.6</b> Spatio-temporal regression</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="app.html"><a href="app.html"><i class="fa fa-check"></i><b>12</b> App</a><ul>
<li class="chapter" data-level="12.1" data-path="app.html"><a href="app.html#brief-introduction-to-shiny-app"><i class="fa fa-check"></i><b>12.1</b> Brief introduction to Shiny app</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>13</b> Appendix</a><ul>
<li class="chapter" data-level="13.1" data-path="appendix.html"><a href="appendix.html#brief-introduction-to-matrix"><i class="fa fa-check"></i><b>13.1</b> Brief introduction to Matrix</a></li>
<li class="chapter" data-level="13.2" data-path="appendix.html"><a href="appendix.html#regression-1"><i class="fa fa-check"></i><b>13.2</b> Regression</a><ul>
<li class="chapter" data-level="13.2.1" data-path="appendix.html"><a href="appendix.html#linear-regression-1"><i class="fa fa-check"></i><b>13.2.1</b> Linear regression</a></li>
<li class="chapter" data-level="13.2.2" data-path="appendix.html"><a href="appendix.html#logistic-regression-3"><i class="fa fa-check"></i><b>13.2.2</b> Logistic regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applications of R in Healthcare</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="statistics" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Statistics</h1>
<p>This section is not intended as a textbook on statistics. Rather it demonstrates regression approaches that can be used including sample size estimation, R codes provided.</p>
<div id="univariable-analyses" class="section level2">
<h2><span class="header-section-number">4.1</span> Univariable analyses</h2>
<div id="parametric-tests" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Parametric tests</h3>
<p>T-test is the workhorse for comparing if 2 datasets are have the same distribution. Performing t-test in R requires data from 2 columns: one
containing the variables for comparison and one to label the group. There are different forms of t-test depending on whether the two samples are paired or unpaired. In general, the analysis takes the form of <span class="math inline">\(t=\frac{\mu_1 - \mu_2}{variance}\)</span>. It is recommended to check the distribution of the data by using histogram. For this exercise, we will use the simulated data from ECR trials. The grouping variable is the trial assignment.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="statistics.html#cb1-1"></a><span class="co">#comparison of early neurological recovery (ENI) by tral (T)</span></span>
<span id="cb1-2"><a href="statistics.html#cb1-2"></a>dtTrial&lt;-<span class="kw">read.csv</span>(<span class="st">&quot;./Data-Use/dtTrial_simulated.csv&quot;</span>)</span>
<span id="cb1-3"><a href="statistics.html#cb1-3"></a><span class="kw">t.test</span>(dtTrial<span class="op">$</span>ENI<span class="op">~</span>dtTrial<span class="op">$</span>T)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  dtTrial$ENI by dtTrial$T
## t = 0.17454, df = 487.36, p-value = 0.8615
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.04569535  0.05460540
## sample estimates:
## mean in group 0 mean in group 1 
##       0.3084644       0.3040094</code></pre>
</div>
<div id="non-parametric-tests" class="section level3">
<h3><span class="header-section-number">4.1.2</span> Non-parametric tests</h3>
<p>Chi-squared and Fisher-exact tests can be done by using the <em>table</em> function for setting up the count data into 2 x 2 contingency table or confusion matrix. The formula for the Chi-squared test takes on a familiar form <span class="math inline">\(\chi^2=\frac{(observed-expected)^2}{expected}\)</span>. In this example we will use the data above.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="statistics.html#cb3-1"></a><span class="kw">table</span>(dtTrial<span class="op">$</span>HT,dtTrial<span class="op">$</span>T)</span></code></pre></div>
<pre><code>##    
##       0   1
##   0 112 101
##   1 144 143</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="statistics.html#cb5-1"></a><span class="kw">chisq.test</span>(dtTrial<span class="op">$</span>HT,dtTrial<span class="op">$</span>T)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  dtTrial$HT and dtTrial$T
## X-squared = 0.19553, df = 1, p-value = 0.6584</code></pre>
<p>The Wilcoxon rank sum test is performed with continuous data organised in the
same way as the t-test. There are several different approaches to performing Wilcoxon rank sum test. The <em>coin</em> package allows handling of ties.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="statistics.html#cb7-1"></a><span class="kw">library</span>(coin)</span></code></pre></div>
<pre><code>## Loading required package: survival</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="statistics.html#cb9-1"></a><span class="kw">wilcox.test</span>(ENI<span class="op">~</span>T, <span class="dt">data=</span>dtTrial)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon rank sum test with continuity correction
## 
## data:  ENI by T
## W = 31159, p-value = 0.9642
## alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<div id="regression" class="section level2">
<h2><span class="header-section-number">4.2</span> Regression</h2>
<p>There are many different form of regression methods. A key principle is that the predictors are independent of each others. This issue will be expand on in the later in the section on collinearity. Special methods are required when the predictors are collinear.</p>
<div id="brief-review-of-matrix" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Brief review of matrix</h3>
<p>A vector is has length one. A matrix is an ordered array in 2 dimensions. A
tensor is an ordered array in 3 dimensions.</p>
<p>A matrix in which the columns are linearly related are said to be rank
deficient. The rank of a given matrix is an expression of the number of linearly independent columns of that matrix. Given that row rank and column rank are equivalent, rank deficiency of a matrix is expressed as the difference between
the lesser of the number of rows and columns, and the rank of the matrix.
A matrix with rank of 1 is likely to be linearly related.</p>
</div>
<div id="linear-least-square-regression" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Linear (least square) regression</h3>
<p>Least square regression uses the geometric properties of Euclidean geometry to identify the line of best. The sum of squares <span class="math inline">\(SSE\)</span> is <span class="math inline">\(\sum(observed-expected)^2\)</span>. The <span class="math inline">\(R^2\)</span> is a measure of the fit of the model. It
is given by <span class="math inline">\(1-\frac{SS_(res)}{SS_(total)}\)</span>. Low <span class="math inline">\(R^2\)</span> indicates a poorly fitted model and high <span class="math inline">\(R^2\)</span> indicates excellent fitting. The assumption here is that
the outcome variable is a continuous variable.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="statistics.html#cb11-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb11-2"><a href="statistics.html#cb11-2"></a><span class="kw">load</span>(<span class="st">&quot;./Data-Use/world_stroke.Rda&quot;</span>)</span>
<span id="cb11-3"><a href="statistics.html#cb11-3"></a></span>
<span id="cb11-4"><a href="statistics.html#cb11-4"></a><span class="kw">ggplot</span>(world_sfdf, <span class="kw">aes</span>(<span class="dt">x=</span>LifeExpectancy,<span class="dt">y=</span>MeanLifetimeRisk))<span class="op">+</span></span>
<span id="cb11-5"><a href="statistics.html#cb11-5"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>, <span class="kw">aes</span>(<span class="dt">Group=</span>Income, <span class="dt">linetype=</span>Income))<span class="op">+</span><span class="kw">geom_point</span>()<span class="op">+</span><span class="kw">xlab</span>(<span class="st">&quot;Life Expectancy&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-3-1.png" width="672" /></p>
</div>
<div id="logistic-regression" class="section level3">
<h3><span class="header-section-number">4.2.3</span> Logistic regression</h3>
<p>For outcome that are binary in nature such as yes or no, then least square regression is not appropriate. There are no close form solution for this
analysis and a numerical approach using maximum likelihood approach is needed. When examining the results of logistic regression one is often enchanted by the large odds ratio. It is important to look at the metrics of model calibration
(discussed below). A clue to a poorly calibrated model is the observation that
the width of the confidence interval for odds ratio is wide.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="statistics.html#cb13-1"></a><span class="co">#glm</span></span>
<span id="cb13-2"><a href="statistics.html#cb13-2"></a><span class="kw">data</span>(<span class="st">&quot;BreastCancer&quot;</span>,<span class="dt">package =</span> <span class="st">&quot;mlbench&quot;</span>)</span>
<span id="cb13-3"><a href="statistics.html#cb13-3"></a></span>
<span id="cb13-4"><a href="statistics.html#cb13-4"></a><span class="co">#remove id column and column with NA to feed into iml later</span></span>
<span id="cb13-5"><a href="statistics.html#cb13-5"></a>BreastCancer2&lt;-<span class="kw">lapply</span>(BreastCancer[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">7</span>)], as.numeric)</span>
<span id="cb13-6"><a href="statistics.html#cb13-6"></a>BreastCancer2&lt;-<span class="kw">as.data.frame</span>(BreastCancer2)</span>
<span id="cb13-7"><a href="statistics.html#cb13-7"></a></span>
<span id="cb13-8"><a href="statistics.html#cb13-8"></a>DCa&lt;-<span class="kw">glm</span>(Class<span class="op">~</span>., <span class="dt">data=</span>BreastCancer2)</span>
<span id="cb13-9"><a href="statistics.html#cb13-9"></a></span>
<span id="cb13-10"><a href="statistics.html#cb13-10"></a><span class="kw">summary</span>(DCa)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = Class ~ ., data = BreastCancer2)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -0.93481  -0.11410  -0.02074   0.08470   0.88988  
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     0.723054   0.018613  38.847  &lt; 2e-16 ***
## Cl.thickness    0.042754   0.003992  10.709  &lt; 2e-16 ***
## Cell.size       0.019263   0.007293   2.641  0.00845 ** 
## Cell.shape      0.032217   0.007016   4.592 5.22e-06 ***
## Marg.adhesion   0.021463   0.004386   4.893 1.24e-06 ***
## Epith.c.size    0.011637   0.005965   1.951  0.05148 .  
## Bl.cromatin     0.035266   0.005650   6.241 7.57e-10 ***
## Normal.nucleoli 0.016928   0.004247   3.986 7.44e-05 ***
## Mitoses         0.001086   0.006048   0.180  0.85757    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for gaussian family taken to be 0.0481263)
## 
##     Null deviance: 157.908  on 698  degrees of freedom
## Residual deviance:  33.207  on 690  degrees of freedom
## AIC: -126.1
## 
## Number of Fisher Scoring iterations: 2</code></pre>
<div id="discrimination-and-calibration" class="section level4">
<h4><span class="header-section-number">4.2.3.1</span> Discrimination and Calibration</h4>
<p>A high _<span class="math inline">\(R^2\)</span> suggests that the linear regression model is well calibrated. This metric is often not displayed but should be sought when interpreting the data.</p>
<p>The areas under the receiver operating characteristic curve (AUC) is used to assess how well the models discriminate between those who have the disease and those who do not have the disease of interest. An AUC of 0.5 is classified as no better than by chance; 0.8 to 0.89 provides good (excellent) discrimination, and 0.9 to 1.0 provides outstanding discrimination. This rule of thumb about interpreting AUC when reading the literature is language the authors used to describe the AUC. This test of discrimination is not synonymous with
calibration. It is possible to have a model with high discrimination but poor calibration <span class="citation">(Diamond <a href="#ref-pmid1738016" role="doc-biblioref">1992</a>)</span>.</p>
<p>Calibration of logistic regression model is performed using the HosmerLemeshow goodness-of-t test and the Nagelkerke generalized R2. A model is well
calibrated when the HosmerLemeshow goodness-of-t test shows no difference between observed and expected outcome or P value approaching 1. A high
generalized <span class="math inline">\(R^2\)</span> value suggests a well-calibrated regression model. Running regression through the <em>rms</em> or <em>PredictABEL</em> library provide these results. The generalized <span class="math inline">\(R^2\)</span> can be obtained manually from base R by running an intercept only model and again with covariates. It is given by <span class="math inline">\(1-\frac{L1}{L0}\)</span>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="statistics.html#cb15-1"></a><span class="co">#lrm on logistic regression analysis for Breast Cancer</span></span>
<span id="cb15-2"><a href="statistics.html#cb15-2"></a><span class="kw">library</span>(rms)</span></code></pre></div>
<pre><code>## Loading required package: Hmisc</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## Loading required package: Formula</code></pre>
<pre><code>## 
## Attaching package: &#39;Hmisc&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     format.pval, units</code></pre>
<pre><code>## Loading required package: SparseM</code></pre>
<pre><code>## 
## Attaching package: &#39;SparseM&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     backsolve</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="statistics.html#cb24-1"></a>DCa_rms&lt;-<span class="kw">lrm</span>(Class<span class="op">~</span>., <span class="dt">data=</span>BreastCancer2)</span>
<span id="cb24-2"><a href="statistics.html#cb24-2"></a>DCa_rms</span></code></pre></div>
<pre><code>## Logistic Regression Model
##  
##  lrm(formula = Class ~ ., data = BreastCancer2)
##  
##                         Model Likelihood    Discrimination    Rank Discrim.    
##                               Ratio Test           Indexes          Indexes    
##  Obs           699    LR chi2     759.86    R2       0.915    C       0.993    
##   1            458    d.f.             8    g        6.187    Dxy     0.986    
##   2            241    Pr(&gt; chi2) &lt;0.0001    gr     486.483    gamma   0.986    
##  max |deriv| 8e-10                          gp       0.444    tau-a   0.446    
##                                             Brier    0.028                     
##  
##                  Coef    S.E.   Wald Z Pr(&gt;|Z|)
##  Intercept       -9.9477 1.0317 -9.64  &lt;0.0001 
##  Cl.thickness     0.5776 0.1190  4.85  &lt;0.0001 
##  Cell.size       -0.0115 0.1759 -0.07  0.9479  
##  Cell.shape       0.5679 0.1913  2.97  0.0030  
##  Marg.adhesion    0.3137 0.1004  3.13  0.0018  
##  Epith.c.size     0.1306 0.1406  0.93  0.3529  
##  Bl.cromatin      0.5800 0.1456  3.98  &lt;0.0001 
##  Normal.nucleoli  0.1232 0.0987  1.25  0.2120  
##  Mitoses          0.6092 0.3226  1.89  0.0590  
## </code></pre>
</div>
<div id="measuring-improvement-in-regression-models" class="section level4">
<h4><span class="header-section-number">4.2.3.2</span> Measuring Improvement in Regression Models</h4>
<p>The net reclassification improvement (NRI) and integrated discrimination improvement (IDI) have been proposed as more sensitive metrics of improvement in model discrimination.The NRI can be considered as a percentage reclassication
for the risk categories and the IDI is the mean difference in predicted probabilities between 2 models (constructed from cases with disease and without disease). The NRI and IDI scores are expressed as fractions and can be converted to percentage by multiplying 100.The continuous NRI and IDI can be performed
using <em>PredictABEL</em> <span class="citation">(Phan et al. <a href="#ref-pmid28579970" role="doc-biblioref">2017</a>)</span><span class="citation">(Phan et al. <a href="#ref-pmid26796056" role="doc-biblioref">2016</a>)</span>.</p>
</div>
<div id="shapley-value" class="section level4">
<h4><span class="header-section-number">4.2.3.3</span> Shapley value</h4>
<p>We can use ideas from game theory relating to fair distribution of prot in coalition games; the coalition (co-operative) game in this case can be
interpreted as contribution of the covariates to the model. The Shapley value regression method calculates the marginal contribution of each covariate as the average of all permutations of the coalition of the covariates containing the covariate of interest minus the coalition without the covariate of interest. The advantage of this approach is that it can handle multicollinearity (relatedness) among the covariates.</p>
<p>The feature importance is used to assess the impact of the features on the
models decision</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="statistics.html#cb26-1"></a><span class="co">#this section takes the output from logistic regression above.</span></span>
<span id="cb26-2"><a href="statistics.html#cb26-2"></a><span class="kw">library</span>(iml)</span>
<span id="cb26-3"><a href="statistics.html#cb26-3"></a>X =<span class="st"> </span>BreastCancer2[<span class="kw">which</span>(<span class="kw">names</span>(BreastCancer2) <span class="op">!=</span><span class="st"> &quot;Class&quot;</span>)]</span>
<span id="cb26-4"><a href="statistics.html#cb26-4"></a>predictor =<span class="st"> </span>Predictor<span class="op">$</span><span class="kw">new</span>(DCa, <span class="dt">data =</span> X, <span class="dt">y =</span> BreastCancer2<span class="op">$</span>Class)</span>
<span id="cb26-5"><a href="statistics.html#cb26-5"></a>imp =<span class="st"> </span>FeatureImp<span class="op">$</span><span class="kw">new</span>(predictor, <span class="dt">loss =</span> <span class="st">&quot;mae&quot;</span>)</span>
<span id="cb26-6"><a href="statistics.html#cb26-6"></a><span class="kw">plot</span>(imp)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-5-1.png" width="672" /></p>
<p>From the logistic regression above cell thickness and cromatin have the highest coefficient and lowest p value. This is the same as feature importance. By contrast the Shapley values show that cell shape and marg adhesion make the largest impact on the model when considering the contribution to the model after considering all the contribution by different coalitions.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="statistics.html#cb27-1"></a><span class="co">#explain with game theory</span></span>
<span id="cb27-2"><a href="statistics.html#cb27-2"></a>shapley &lt;-<span class="st"> </span>Shapley<span class="op">$</span><span class="kw">new</span>(predictor, <span class="dt">x.interest =</span> X[<span class="dv">1</span>, ])</span>
<span id="cb27-3"><a href="statistics.html#cb27-3"></a>shapley<span class="op">$</span><span class="kw">plot</span>()</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-5-1-1.png" width="672" /></p>
</div>
<div id="ice" class="section level4">
<h4><span class="header-section-number">4.2.3.4</span> ICE</h4>
<p>The individual conditional expectation (ICE) curves is the plot of the
expectation fof the predictive value for each observation at the unique value
for the feature.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="statistics.html#cb28-1"></a><span class="co">#feature is the covariate of interest</span></span>
<span id="cb28-2"><a href="statistics.html#cb28-2"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb28-3"><a href="statistics.html#cb28-3"></a>eff_thick &lt;-<span class="st"> </span>FeatureEffect<span class="op">$</span><span class="kw">new</span>(predictor, </span>
<span id="cb28-4"><a href="statistics.html#cb28-4"></a>                         <span class="dt">feature =</span> <span class="st">&quot;Cl.thickness&quot;</span>, </span>
<span id="cb28-5"><a href="statistics.html#cb28-5"></a>                         <span class="dt">method =</span> <span class="st">&quot;ice&quot;</span>,</span>
<span id="cb28-6"><a href="statistics.html#cb28-6"></a>                         <span class="dt">center.at =</span> <span class="dv">0</span>)</span>
<span id="cb28-7"><a href="statistics.html#cb28-7"></a></span>
<span id="cb28-8"><a href="statistics.html#cb28-8"></a><span class="kw">plot</span>(eff_thick)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-5-2-1.png" width="672" /></p>
<div id="interaction" class="section level5">
<h5><span class="header-section-number">4.2.3.4.1</span> Interaction</h5>
<p>Interactions is plotted here using lollipop bar. The <em>ggalt</em> library can be used to create this type of plot with <em>geom_lollipop</em>. The strength of interaction is measured using Friedmans H-statistics. The H-statistics ranges from 0 to 1 with
1 indicating the overall interaction strength. In the case with Breast Cancer data, the interaction strength is low.</p>
<p>When describing interaction terms it is recommended that the results be
expressed as  coefficients rather than as odds ratio.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="statistics.html#cb29-1"></a><span class="co">#plot interactions</span></span>
<span id="cb29-2"><a href="statistics.html#cb29-2"></a>interact &lt;-<span class="st"> </span>Interaction<span class="op">$</span><span class="kw">new</span>(predictor)</span>
<span id="cb29-3"><a href="statistics.html#cb29-3"></a><span class="kw">plot</span>(interact)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-5-3-1.png" width="672" /></p>
</div>
</div>
<div id="propensity-matching" class="section level4">
<h4><span class="header-section-number">4.2.3.5</span> Propensity matching</h4>
<p>A common misconception is that the multiple regression adjust for imbalance in covariates. This issue was observed in the pivotal NINDS alteplase trial. The results of the trial has since been accepted with re-analysis of this trial.</p>
<p>Propensity matching is an important technique to adjust for imbalance in covariates between 2 arms. There are concerns with mis-use of this technique
such as difference in placebo arms from multiple sclerosis trials <span class="citation">(Signori et al. <a href="#ref-10.1001/jamaneurol.2020.0678" role="doc-biblioref">2020</a>)</span>. It is proposed that this technique should be
used only if all the confounders are measurable. This situation may not be satisfied if the data were accrued at different period, in different continent etc.</p>
</div>
</div>
</div>
<div id="special-types-of-regression" class="section level2">
<h2><span class="header-section-number">4.3</span> Special types of regression</h2>
<div id="ordinal-regression" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Ordinal regression</h3>
<p>Ordinal regression is appropriate when the outcome variable is in the form of ordered categorical values. For example, the Rankin scale of disability is
bounded between the values of 0 and 6. This type of analysis uses the
proportional odds model and the requirement for this model is stringent. When examining results of ordinal regression check that the authors provide this metric, the Brant test. The Brant test assesses the parallel regression assumption. Ordinal regression is performed using <em>polr</em> function in <em>MASS</em> library. The Brant test is available in the <em>Brant</em> library.</p>
</div>
<div id="survival-analysis" class="section level3">
<h3><span class="header-section-number">4.3.2</span> Survival analysis</h3>
<p>Survival analysis is useful when dealing with time to event data. The Cox model assesses the hazard of outcome between two groups. The assumption of this model
is that the hazard between each arm is proportional <span class="citation">(Stensrud and Hernan <a href="#ref-pmid32167523" role="doc-biblioref">2020</a>)</span>. The proportional hazard model can be tested <span class="citation">(Grambsch and Therneau <a href="#ref-10.1093/biomet/81.3.515" role="doc-biblioref">1994</a>)</span>. In the section on clinical trial we illustrate how the results can be converted to numbers needed to treat.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="statistics.html#cb30-1"></a><span class="kw">library</span>(survival)</span>
<span id="cb30-2"><a href="statistics.html#cb30-2"></a><span class="kw">library</span>(survminer)</span></code></pre></div>
<pre><code>## Loading required package: ggpubr</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="statistics.html#cb32-1"></a><span class="co">#data from survival package on NCCTG lung cancer trial</span></span>
<span id="cb32-2"><a href="statistics.html#cb32-2"></a><span class="co">#https://stat.ethz.ch/R-manual/R-devel/library/survival/html/lung.html</span></span>
<span id="cb32-3"><a href="statistics.html#cb32-3"></a><span class="kw">data</span>(cancer, <span class="dt">package=</span><span class="st">&quot;survival&quot;</span>)</span>
<span id="cb32-4"><a href="statistics.html#cb32-4"></a></span>
<span id="cb32-5"><a href="statistics.html#cb32-5"></a><span class="co">#time in days</span></span>
<span id="cb32-6"><a href="statistics.html#cb32-6"></a><span class="co">#status censored=1, dead=2</span></span>
<span id="cb32-7"><a href="statistics.html#cb32-7"></a><span class="co">#sex:Male=1 Female=2</span></span>
<span id="cb32-8"><a href="statistics.html#cb32-8"></a></span>
<span id="cb32-9"><a href="statistics.html#cb32-9"></a>sfit&lt;-<span class="st"> </span><span class="kw">coxph</span>(<span class="kw">Surv</span>(time, status) <span class="op">~</span><span class="st"> </span>age<span class="op">+</span>sex<span class="op">+</span>ph.ecog, <span class="dt">data =</span> cancer)</span>
<span id="cb32-10"><a href="statistics.html#cb32-10"></a><span class="kw">summary</span>(sfit)</span></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(time, status) ~ age + sex + ph.ecog, data = cancer)
## 
##   n= 227, number of events= 164 
##    (1 observation deleted due to missingness)
## 
##              coef exp(coef)  se(coef)      z Pr(&gt;|z|)    
## age      0.011067  1.011128  0.009267  1.194 0.232416    
## sex     -0.552612  0.575445  0.167739 -3.294 0.000986 ***
## ph.ecog  0.463728  1.589991  0.113577  4.083 4.45e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##         exp(coef) exp(-coef) lower .95 upper .95
## age        1.0111     0.9890    0.9929    1.0297
## sex        0.5754     1.7378    0.4142    0.7994
## ph.ecog    1.5900     0.6289    1.2727    1.9864
## 
## Concordance= 0.637  (se = 0.025 )
## Likelihood ratio test= 30.5  on 3 df,   p=1e-06
## Wald test            = 29.93  on 3 df,   p=1e-06
## Score (logrank) test = 30.5  on 3 df,   p=1e-06</code></pre>
<p>Test proportional hazard assumption. The finding below shows that the covariates do not violate proportional hazard assumption.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="statistics.html#cb34-1"></a><span class="kw">cox.zph</span>(sfit)</span></code></pre></div>
<pre><code>##         chisq df    p
## age     0.188  1 0.66
## sex     2.305  1 0.13
## ph.ecog 2.054  1 0.15
## GLOBAL  4.464  3 0.22</code></pre>
<p>Plot fit of survival model</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="statistics.html#cb36-1"></a><span class="kw">ggcoxdiagnostics</span>(sfit, <span class="dt">type =</span> <span class="st">&quot;deviance&quot;</span>, </span>
<span id="cb36-2"><a href="statistics.html#cb36-2"></a> <span class="dt">ox.scale =</span> <span class="st">&quot;linear.predictions&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-6-2-1.png" width="672" /></p>
<p>Forest plot of outcome from survival analysis</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="statistics.html#cb38-1"></a><span class="kw">ggforest</span>(sfit)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-6-3-1.png" width="672" /></p>
</div>
<div id="quantile-regression" class="section level3">
<h3><span class="header-section-number">4.3.3</span> Quantile regression</h3>
<p>Least spare regression is appropriate when the data is homoscedascity or the
error term remain constant. This can be seen as the data varies around the
fitted line. Homoscedascity implies that the data is homogenous. Quantile regression is appropriate when the distribution of the data is non-normal and it is more appropriate to look at the conditional median of the dependent variable. There are several libraries for this task <em>quantreg</em> and Bayesian libraries. In the example below, the life time risk of stroke is regressed against life expectancy using lest square and quantile regression.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="statistics.html#cb39-1"></a><span class="kw">library</span>(quantreg)</span>
<span id="cb39-2"><a href="statistics.html#cb39-2"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb39-3"><a href="statistics.html#cb39-3"></a></span>
<span id="cb39-4"><a href="statistics.html#cb39-4"></a><span class="kw">load</span>(<span class="st">&quot;./Data-Use/world_stroke.Rda&quot;</span>)</span>
<span id="cb39-5"><a href="statistics.html#cb39-5"></a></span>
<span id="cb39-6"><a href="statistics.html#cb39-6"></a><span class="co">#quantile regression</span></span>
<span id="cb39-7"><a href="statistics.html#cb39-7"></a>rqfit &lt;-<span class="st"> </span><span class="kw">rq</span>( MeanLifetimeRisk<span class="op">~</span><span class="st"> </span>LifeExpectancy, <span class="dt">data =</span> world_sfdf)</span>
<span id="cb39-8"><a href="statistics.html#cb39-8"></a>rqfit_sum&lt;-<span class="kw">summary</span>(rqfit)</span>
<span id="cb39-9"><a href="statistics.html#cb39-9"></a></span>
<span id="cb39-10"><a href="statistics.html#cb39-10"></a><span class="co">#least square regression</span></span>
<span id="cb39-11"><a href="statistics.html#cb39-11"></a>lsfit&lt;-<span class="kw">lm</span>(MeanLifetimeRisk<span class="op">~</span>LifeExpectancy,<span class="dt">data=</span>world_sfdf)</span>
<span id="cb39-12"><a href="statistics.html#cb39-12"></a>lsfit_sum&lt;-<span class="kw">summary</span>(lsfit) </span>
<span id="cb39-13"><a href="statistics.html#cb39-13"></a></span>
<span id="cb39-14"><a href="statistics.html#cb39-14"></a><span class="co">#plot</span></span>
<span id="cb39-15"><a href="statistics.html#cb39-15"></a><span class="kw">ggplot</span>(world_sfdf,  <span class="kw">aes</span>(<span class="dt">x=</span>LifeExpectancy,<span class="dt">y=</span>MeanLifetimeRisk))<span class="op">+</span></span>
<span id="cb39-16"><a href="statistics.html#cb39-16"></a><span class="st">  </span><span class="co">#add fitted line for least square</span></span>
<span id="cb39-17"><a href="statistics.html#cb39-17"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span>lsfit_sum<span class="op">$</span>coefficients[<span class="dv">1</span>], <span class="dt">slope=</span>lsfit_sum<span class="op">$</span>coefficients[<span class="dv">2</span>],<span class="dt">color=</span><span class="st">&quot;red&quot;</span>)<span class="op">+</span></span>
<span id="cb39-18"><a href="statistics.html#cb39-18"></a><span class="st">  </span><span class="co">#add fitted line for quantile regression</span></span>
<span id="cb39-19"><a href="statistics.html#cb39-19"></a><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span><span class="kw">xlab</span>(<span class="st">&quot;Life Expectancy&quot;</span>)<span class="op">+</span></span>
<span id="cb39-20"><a href="statistics.html#cb39-20"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span>rqfit_sum<span class="op">$</span>coefficients[<span class="dv">1</span>], <span class="dt">slope=</span>rqfit_sum<span class="op">$</span>coefficients[<span class="dv">2</span>],<span class="dt">color=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-7-1.png" width="672" /></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="statistics.html#cb40-1"></a><span class="co">#annotate least square and quantile at position x, y</span></span>
<span id="cb40-2"><a href="statistics.html#cb40-2"></a><span class="co">#annotate(&quot;text&quot;,x=60, y=27, label=paste0(&quot;least square =&quot;,                        round(lsfit_sum$coefficients[1],2) ,&quot;+&quot;, round(lsfit_sum$coefficients[2],2),&quot;x &quot;,&quot;Life Expectancy&quot;),color=&quot;red&quot;)+ annotate(&quot;text&quot;,x=75, y=12,label=paste0(&quot;quantile =&quot;,round(rqfit_sum$coefficients[1],2), &quot; + &quot;, round(rqfit_sum$coefficients[2],2),&quot; x &quot;,&quot;Life Expectancy&quot;),color=&quot;blue&quot;)</span></span></code></pre></div>
<div id="non-negative-regression" class="section level5">
<h5><span class="header-section-number">4.3.3.0.1</span> Non-negative regression</h5>
<p>In certain situations, it is necessary to constrain the analysis so that the regression coefifcients are non-negative. For example, when regressing brain regions against infarct volume, there is no reason believe that a negative coefficient attributable to a brain region is possible. Non-negative regression can be performed in R using <em>nnls</em>.</p>
</div>
</div>
<div id="poisson-regression" class="section level3">
<h3><span class="header-section-number">4.3.4</span> Poisson regression</h3>
<p>Poisson regression is used when dealing with number of event over time or
distance such as number of new admissions or new cases of hepatitis or TIA over time. An assumption of the Poisson distribution is that the mean &amp; lambda; and variance  are the same.</p>
<p>A special case of Poisson regression is the negative binomial regression. This latter method is used when the variance is greater than the mean pf the data or over-dispersed data. Negative binomial regression can be applied to number of failure event over time. Here failure has a lose definition and can be stroke recurrence after TIA or cirrhosis after hepatitis C infection.</p>
<p>Zero-inflated data occurs when there is an abundance of zeroes in the data (true and excess zeroes).</p>
</div>
<div id="conditional-logistic-regression" class="section level3">
<h3><span class="header-section-number">4.3.5</span> Conditional logistic regression</h3>
<p>Conditional logistical regression model should be used when the aim is to
compare pair of objects from the same patient. Examples include left and right arms or left and right carotid arteries. This method is available from <em>clogit</em> in <em>survival</em>.</p>
</div>
<div id="multinomial-modelling" class="section level3">
<h3><span class="header-section-number">4.3.6</span> Multinomial modelling</h3>
<p>Multinomial modelling is used when the outcome categorical variables are not ordered. This situation can occur when analysis involves choice outcome (choices of fruit: apple, orange or pear). In this case, the log odds of each of the categorical outcomes are analysed as a linear combination of the predictor variables. The <em>nnet</em> library have functions for performing this analysis.</p>
</div>
</div>
<div id="sample-size-estimation" class="section level2">
<h2><span class="header-section-number">4.4</span> Sample size estimation</h2>
<p>Clinicians are often frustrated about sample size and power estimation for a study, grant or clinical trial. This aspect is scrutinised by ethics committee
and in peer review process for journals. Luckily, R provides several packages
for sample size amd power estimation: <em>pwr</em> library. Cohen has written reference textbook on this subject <span class="citation">(Cohen <a href="#ref-COHEN1977179" role="doc-biblioref">1977</a>)</span>.</p>
<div id="proportion" class="section level3">
<h3><span class="header-section-number">4.4.1</span> Proportion</h3>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="statistics.html#cb41-1"></a><span class="kw">library</span>(pwr)</span>
<span id="cb41-2"><a href="statistics.html#cb41-2"></a><span class="co">#ttest-d is effect size </span></span>
<span id="cb41-3"><a href="statistics.html#cb41-3"></a><span class="co">#d = )mean group1 -mean group2)/variance</span></span>
<span id="cb41-4"><a href="statistics.html#cb41-4"></a><span class="kw">pwr.t.test</span>(<span class="dt">n=</span><span class="dv">300</span>,<span class="dt">d=</span><span class="fl">0.2</span>,<span class="dt">sig.level=</span>.<span class="dv">05</span>,<span class="dt">alternative=</span><span class="st">&quot;greater&quot;</span>) </span></code></pre></div>
<pre><code>## 
##      Two-sample t test power calculation 
## 
##               n = 300
##               d = 0.2
##       sig.level = 0.05
##           power = 0.7886842
##     alternative = greater
## 
## NOTE: n is number in *each* group</code></pre>
<p>We provided an example below for generating power of clinical trial. Examples
are taken from a paper on sample size estimation for phase II trials <span class="citation">(Phan et al. <a href="#ref-pmid16931782" role="doc-biblioref">2006</a>)</span>.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="statistics.html#cb43-1"></a><span class="kw">library</span>(pwr)</span>
<span id="cb43-2"><a href="statistics.html#cb43-2"></a><span class="co">#h is effect size. effect size of 0.5 is very large </span></span>
<span id="cb43-3"><a href="statistics.html#cb43-3"></a><span class="co">#sample size</span></span>
<span id="cb43-4"><a href="statistics.html#cb43-4"></a><span class="kw">pwr.2p.test</span>(<span class="dt">h=</span><span class="fl">0.5</span>,<span class="dt">n=</span><span class="dv">50</span>,<span class="dt">sig.level=</span><span class="fl">0.05</span>,<span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<pre><code>## 
##      Difference of proportion power calculation for binomial distribution (arcsine transformation) 
## 
##               h = 0.5
##               n = 50
##       sig.level = 0.05
##           power = 0.705418
##     alternative = two.sided
## 
## NOTE: same sample sizes</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="statistics.html#cb45-1"></a><span class="co">#medium effect size</span></span>
<span id="cb45-2"><a href="statistics.html#cb45-2"></a><span class="kw">pwr.2p.test</span>(<span class="dt">h=</span><span class="fl">0.1</span>,<span class="dt">n=</span><span class="dv">50</span>,<span class="dt">sig.level=</span><span class="fl">0.05</span>,<span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<pre><code>## 
##      Difference of proportion power calculation for binomial distribution (arcsine transformation) 
## 
##               h = 0.1
##               n = 50
##       sig.level = 0.05
##           power = 0.07909753
##     alternative = two.sided
## 
## NOTE: same sample sizes</code></pre>
<p>The output of the sample size calculation can be put into a table or plot.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="statistics.html#cb47-1"></a><span class="kw">library</span>(pwr)</span>
<span id="cb47-2"><a href="statistics.html#cb47-2"></a><span class="co">#pwr.2p.test(h=0.3,n=80,sig.level=0.05,alternative=&quot;two.sided&quot;)</span></span>
<span id="cb47-3"><a href="statistics.html#cb47-3"></a>h &lt;-<span class="st"> </span><span class="kw">seq</span>(.<span class="dv">1</span>,.<span class="dv">5</span>,.<span class="dv">1</span>) <span class="co">#from 0.1 to 0.3 by 0.05</span></span>
<span id="cb47-4"><a href="statistics.html#cb47-4"></a>nh &lt;-<span class="st"> </span><span class="kw">length</span>(h) <span class="co">#5</span></span>
<span id="cb47-5"><a href="statistics.html#cb47-5"></a>p &lt;-<span class="st"> </span><span class="kw">seq</span>(.<span class="dv">3</span>,.<span class="dv">9</span>,.<span class="dv">1</span>)<span class="co"># power from 0.5 to 0.9 by 0.1</span></span>
<span id="cb47-6"><a href="statistics.html#cb47-6"></a>np &lt;-<span class="st"> </span><span class="kw">length</span>(p) <span class="co">#9</span></span>
<span id="cb47-7"><a href="statistics.html#cb47-7"></a><span class="co"># create an empty array 9 x 5</span></span>
<span id="cb47-8"><a href="statistics.html#cb47-8"></a>samplesize &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="kw">numeric</span>(nh<span class="op">*</span>np), <span class="dt">dim=</span><span class="kw">c</span>(nh,np))</span>
<span id="cb47-9"><a href="statistics.html#cb47-9"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>np){</span>
<span id="cb47-10"><a href="statistics.html#cb47-10"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nh){</span>
<span id="cb47-11"><a href="statistics.html#cb47-11"></a>    result &lt;-<span class="st"> </span><span class="kw">pwr.2p.test</span>(<span class="dt">n =</span> <span class="ot">NULL</span>, <span class="dt">h =</span> h[j],</span>
<span id="cb47-12"><a href="statistics.html#cb47-12"></a>    <span class="co">#result &lt;- pwr.r.test(n = NULL, h = h[j],</span></span>
<span id="cb47-13"><a href="statistics.html#cb47-13"></a>    <span class="dt">sig.level =</span> <span class="fl">.05</span>, <span class="dt">power =</span> p[i],</span>
<span id="cb47-14"><a href="statistics.html#cb47-14"></a>    <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb47-15"><a href="statistics.html#cb47-15"></a>    samplesize[j,i] &lt;-<span class="st"> </span><span class="kw">ceiling</span>(result<span class="op">$</span>n)</span>
<span id="cb47-16"><a href="statistics.html#cb47-16"></a>  }</span>
<span id="cb47-17"><a href="statistics.html#cb47-17"></a>}</span>
<span id="cb47-18"><a href="statistics.html#cb47-18"></a>samplesize</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]
## [1,]  412  583  769  980 1235 1570 2102
## [2,]  103  146  193  245  309  393  526
## [3,]   46   65   86  109  138  175  234
## [4,]   26   37   49   62   78   99  132
## [5,]   17   24   31   40   50   63   85</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="statistics.html#cb49-1"></a><span class="co">#graph</span></span>
<span id="cb49-2"><a href="statistics.html#cb49-2"></a>xrange &lt;-<span class="st"> </span><span class="kw">range</span>(h)</span>
<span id="cb49-3"><a href="statistics.html#cb49-3"></a>yrange &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">range</span>(samplesize))</span>
<span id="cb49-4"><a href="statistics.html#cb49-4"></a>colors &lt;-<span class="st"> </span><span class="kw">rainbow</span>(<span class="kw">length</span>(p))</span>
<span id="cb49-5"><a href="statistics.html#cb49-5"></a><span class="kw">plot</span>(xrange, yrange, <span class="dt">type=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb49-6"><a href="statistics.html#cb49-6"></a>  <span class="dt">xlab=</span><span class="st">&quot;Effect size (h)&quot;</span>,</span>
<span id="cb49-7"><a href="statistics.html#cb49-7"></a>  <span class="dt">ylab=</span><span class="st">&quot;Sample Size (n)&quot;</span> )</span>
<span id="cb49-8"><a href="statistics.html#cb49-8"></a><span class="co"># add power curves</span></span>
<span id="cb49-9"><a href="statistics.html#cb49-9"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>np){</span>
<span id="cb49-10"><a href="statistics.html#cb49-10"></a>  <span class="kw">lines</span>(h, samplesize[,i], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span>colors[i])</span>
<span id="cb49-11"><a href="statistics.html#cb49-11"></a>}</span>
<span id="cb49-12"><a href="statistics.html#cb49-12"></a><span class="co"># add annotation (grid lines, title, legend) </span></span>
<span id="cb49-13"><a href="statistics.html#cb49-13"></a><span class="kw">abline</span>(<span class="dt">v=</span><span class="dv">0</span>, <span class="dt">h=</span><span class="kw">seq</span>(<span class="dv">0</span>,yrange[<span class="dv">2</span>],<span class="dv">50</span>), <span class="dt">lty=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&quot;grey89&quot;</span>)</span>
<span id="cb49-14"><a href="statistics.html#cb49-14"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>, <span class="dt">v=</span><span class="kw">seq</span>(xrange[<span class="dv">1</span>],xrange[<span class="dv">2</span>],.<span class="dv">02</span>), <span class="dt">lty=</span><span class="dv">2</span>,</span>
<span id="cb49-15"><a href="statistics.html#cb49-15"></a>   <span class="dt">col=</span><span class="st">&quot;grey89&quot;</span>)</span>
<span id="cb49-16"><a href="statistics.html#cb49-16"></a><span class="kw">title</span>(<span class="st">&quot;Sample Size Estimation</span><span class="ch">\n</span><span class="st"> Difference in Proportion&quot;</span>)</span>
<span id="cb49-17"><a href="statistics.html#cb49-17"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">title=</span><span class="st">&quot;Power&quot;</span>, <span class="kw">as.character</span>(p),</span>
<span id="cb49-18"><a href="statistics.html#cb49-18"></a>   <span class="dt">fill=</span>colors)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-10-1.png" width="672" /></p>
<div id="non-inferiority" class="section level4">
<h4><span class="header-section-number">4.4.1.1</span> Non-inferiority</h4>
<p>Non-inferiority trials may offer information in a way that a traditional superiority design do not. The design may be interested in other aspect of the treatment such as cost and lower toxicity <span class="citation">(Kaji and Lewis <a href="#ref-pmid26080342" role="doc-biblioref">2015</a>)</span>. Examples of non-inferiority trial designs include antibiotics versus surgery for
appendicitis <span class="citation">(Salminen et al. <a href="#ref-pmid26080338" role="doc-biblioref">2015</a>)</span>. There are concerns with reporting of
noninferiority trial. Justification for the margin provided in 27.6% <span class="citation">(Gopal et al. <a href="#ref-pmid25781447" role="doc-biblioref">2015</a>)</span>. The following describes a trial design where its expected that drug will result in a certain outcome <em>p1</em> and the control arm <em>p2</em> and the
ratio of subject in treatment to control arm is <em>k</em>. The difference in outcome
is <em>delta</em>. The margin is defined as non-inferior if &lt;0.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="statistics.html#cb50-1"></a><span class="kw">library</span>(TrialSize)</span>
<span id="cb50-2"><a href="statistics.html#cb50-2"></a><span class="kw">TwoSampleProportion.NIS</span>(<span class="dt">alpha=</span>.<span class="dv">05</span>, </span>
<span id="cb50-3"><a href="statistics.html#cb50-3"></a>                        <span class="dt">beta=</span>.<span class="dv">8</span>,</span>
<span id="cb50-4"><a href="statistics.html#cb50-4"></a>                        <span class="dt">p1=</span>.<span class="dv">6</span>,</span>
<span id="cb50-5"><a href="statistics.html#cb50-5"></a>                        <span class="dt">p2=</span>.<span class="dv">7</span>,</span>
<span id="cb50-6"><a href="statistics.html#cb50-6"></a>                        <span class="dt">k=</span><span class="dv">1</span>,</span>
<span id="cb50-7"><a href="statistics.html#cb50-7"></a>                        <span class="dt">delta =</span> <span class="fl">.1</span>,       </span>
<span id="cb50-8"><a href="statistics.html#cb50-8"></a>                        <span class="dt">margin=</span><span class="op">-</span>.<span class="dv">2</span></span>
<span id="cb50-9"><a href="statistics.html#cb50-9"></a>                        )</span></code></pre></div>
<pre><code>## [1] 3.225911</code></pre>
</div>
</div>
<div id="logistic-regression-1" class="section level3">
<h3><span class="header-section-number">4.4.2</span> Logistic regression</h3>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="statistics.html#cb52-1"></a><span class="kw">library</span>(powerMediation)</span>
<span id="cb52-2"><a href="statistics.html#cb52-2"></a><span class="co">#continuous predictor</span></span>
<span id="cb52-3"><a href="statistics.html#cb52-3"></a><span class="co">#p1=event rate</span></span>
<span id="cb52-4"><a href="statistics.html#cb52-4"></a><span class="kw">powerLogisticCon</span>(<span class="dt">n=</span><span class="dv">317</span>, <span class="dt">p1=</span><span class="fl">0.5</span>, <span class="dt">OR=</span><span class="kw">exp</span>(<span class="fl">0.405</span>), <span class="dt">alpha=</span><span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 0.9500611</code></pre>
</div>
<div id="survival-studies" class="section level3">
<h3><span class="header-section-number">4.4.3</span> Survival studies</h3>
<p>Sample size for survival studies can be performed using <em>powerSurvEpi</em> or <em>gsDesign</em>.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="statistics.html#cb54-1"></a><span class="kw">library</span>(powerSurvEpi)</span>
<span id="cb54-2"><a href="statistics.html#cb54-2"></a></span>
<span id="cb54-3"><a href="statistics.html#cb54-3"></a><span class="co">#sample size</span></span>
<span id="cb54-4"><a href="statistics.html#cb54-4"></a><span class="kw">ssizeEpi.default</span>(<span class="dt">power =</span> <span class="fl">0.80</span>, </span>
<span id="cb54-5"><a href="statistics.html#cb54-5"></a>                 <span class="dt">theta =</span> <span class="dv">2</span>, </span>
<span id="cb54-6"><a href="statistics.html#cb54-6"></a>                 <span class="dt">p =</span> <span class="fl">0.408</span> , </span>
<span id="cb54-7"><a href="statistics.html#cb54-7"></a>                 <span class="dt">psi =</span> <span class="fl">0.15</span>,</span>
<span id="cb54-8"><a href="statistics.html#cb54-8"></a>                 <span class="dt">rho2 =</span> <span class="fl">0.344</span><span class="op">^</span><span class="dv">2</span>, </span>
<span id="cb54-9"><a href="statistics.html#cb54-9"></a>                 <span class="dt">alpha =</span> <span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 512</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="statistics.html#cb56-1"></a><span class="co">#power</span></span>
<span id="cb56-2"><a href="statistics.html#cb56-2"></a><span class="kw">powerEpi.default</span>(<span class="dt">n =</span> <span class="dv">2691</span>, </span>
<span id="cb56-3"><a href="statistics.html#cb56-3"></a>                 <span class="dt">theta =</span> <span class="dv">2</span>, </span>
<span id="cb56-4"><a href="statistics.html#cb56-4"></a>                 <span class="dt">p =</span> <span class="fl">0.408</span>, </span>
<span id="cb56-5"><a href="statistics.html#cb56-5"></a>                 <span class="dt">psi =</span> <span class="fl">0.250</span>,</span>
<span id="cb56-6"><a href="statistics.html#cb56-6"></a>                 <span class="dt">rho2 =</span> <span class="fl">0.344</span><span class="op">^</span><span class="dv">2</span>, </span>
<span id="cb56-7"><a href="statistics.html#cb56-7"></a>                 <span class="dt">alpha =</span> <span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="statistics.html#cb58-1"></a><span class="co">#Amarenco NEJM 2020 #equal sample size k=1</span></span>
<span id="cb58-2"><a href="statistics.html#cb58-2"></a><span class="kw">ssizeCT.default</span>(<span class="dt">power =</span> <span class="fl">0.8</span>, <span class="dt">k =</span> <span class="fl">.8</span>, <span class="dt">pE =</span> <span class="fl">0.085</span>, </span>
<span id="cb58-3"><a href="statistics.html#cb58-3"></a>                <span class="dt">pC =</span> <span class="fl">0.109</span>, </span>
<span id="cb58-4"><a href="statistics.html#cb58-4"></a>                <span class="dt">RR =</span> <span class="fl">0.78</span>, <span class="dt">alpha =</span> <span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>##   nE   nC 
## 2417 3021</code></pre>
</div>
<div id="multiple-regression" class="section level3">
<h3><span class="header-section-number">4.4.4</span> Multiple regression</h3>
<p>The power for general linear model can be calculated using the <em>pwr.f2.test</em> function.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="statistics.html#cb60-1"></a><span class="kw">library</span>(pwr)</span>
<span id="cb60-2"><a href="statistics.html#cb60-2"></a><span class="co">#u=degrees of freedom for numerator</span></span>
<span id="cb60-3"><a href="statistics.html#cb60-3"></a><span class="co">#v=degrees of freedomfor denominator</span></span>
<span id="cb60-4"><a href="statistics.html#cb60-4"></a><span class="co">#f2=effect size</span></span></code></pre></div>
</div>
</div>
<div id="interpreting-clinical-trials" class="section level2">
<h2><span class="header-section-number">4.5</span> Interpreting clinical trials</h2>
<p>A key issue in interpreting of clinical trials is that the relative risk
reduction or relative hazard risk are provided. An example is the result of the ACAS asymptomatic carotid artery trial is often quoted as showing 50% risk reduction. In fact, there was 2% annual risk of ipsilateral stroke in the
medical and 1% risk in the surgical arm. The absolute risk reduction or ARR was
1% per year. However, the 50% relative risk reduction is often quoted to explain to patients.</p>
<div id="nnt-from-arr" class="section level3">
<h3><span class="header-section-number">4.5.1</span> NNT from ARR</h3>
<p>In this case, the number needed to treat (NNT) is given by <span class="math inline">\(\frac{1}{ARR}\)</span> or <span class="math inline">\(\frac{1}{0.01}=100\)</span> to achieve the trial outcome or 100 patients are needed to be treated to reduce the stroke risk to 1%. The recommendation is that the 95% confidence interval for NNT should be provided.</p>
</div>
<div id="nnt-from-odds-ratio" class="section level3">
<h3><span class="header-section-number">4.5.2</span> NNT from odds ratio</h3>
<p>Calculation of NNT for odds ratio requires knowledge of the outcome of the placebo group. The NNT is given by <span class="math inline">\(\frac{1}{ACR-\frac{OR*ACR}{1-(ACR+OR*ACR)}}\)</span>. The ACR represents the assumed control risk. The NNT can be calculated from <em>nnt</em> function in <em>meta</em> library.</p>
</div>
<div id="nnt-from-hazard-ratio" class="section level3">
<h3><span class="header-section-number">4.5.3</span> NNT from hazard ratio</h3>
<p>Calculation of NNT for hazard ratio requires knowledge of the outcome of the placebo group and the hazard ratio or <em>HR</em>. The formula using the binomial theorem is <span class="math inline">\(p=1-q\)</span> where q is given by the ratio of outcome and numbers recruited in the placebo group. The formula is taken from <span class="citation">(Ludwig, Darmon, and Guerci <a href="#ref-pmid32404155" role="doc-biblioref">2020</a>)</span> . The NNT is given
<span class="math inline">\(\frac{1}{[p^{HR}-p}\)</span> . We illustrated this using data from metaanalysis on aspirin use in stroke in Lancet 2016. There were 45 events among 16053 patients
in the control group. The HR was 0.44. The NNT from this formula <span class="math inline">\(\frac{1}{.9971968^.44-.9971968}\)</span> was 637.</p>
</div>
<div id="nnt-from-metaananlysis" class="section level3">
<h3><span class="header-section-number">4.5.4</span> NNT from metaananlysis</h3>
<p>There are concerns with using NNT from the results of metaanalysis as the findings are amalgations of trials with different settings <span class="citation">(Marx and Bucher <a href="#ref-pmid12614141" role="doc-biblioref">2003</a>)</span><span class="citation">(Smeeth <a href="#ref-pmid10356018" role="doc-biblioref">1999</a>)</span>. The caution applies when baseline risks or absolute risk differences vary across trials.</p>
</div>
</div>
<div id="metaanalysis" class="section level2">
<h2><span class="header-section-number">4.6</span> Metaanalysis</h2>
<p>During journal club, junior doctors are often taught about the importance of metaanalysis. It is worth knowing how to perform a metaanalysis in order to critique the study. It is not well known outside of statistics journal
that the bivariate analysis is the preferred method to evaluate
diagnostic studies <span class="citation">(Reitsma et al. <a href="#ref-pmid16168343" role="doc-biblioref">2005</a>)</span>. By contrast, the majority of metaanalysis of diagnostic studies uses the univariate method of Moses and Littenberg <span class="citation">(Moses, Shapiro, and Littenberg <a href="#ref-pmid8210827" role="doc-biblioref">1993</a>)</span>. This issue will be expanded below.</p>
<div id="prisma" class="section level3">
<h3><span class="header-section-number">4.6.1</span> PRISMA</h3>
<p>The PRISMA statement is useful for understanding the search strategy and the papers removed and retained in the metaanalysis. An example of generating the statement is provided below in R. The example given here is from a paper on the use of spot sign to predict enlargment of intracerebral hemorrhage <span class="citation">(Phan et al. <a href="#ref-pmid31272327" role="doc-biblioref">2019</a>)</span>.</p>
</div>
<div id="conversion-of-mean-and-median" class="section level3">
<h3><span class="header-section-number">4.6.2</span> Conversion of mean and median</h3>
<p>One issue with performing metaanalysis is that one paper may report mean and another report median age. This calculation is provided in BMC Medical Research Methodology 2005, 5:13 <a href="doi:10.1186/1471-2288-5-13" class="uri">doi:10.1186/1471-2288-5-13</a>. The formula for the mean is given by <span class="math inline">\(\frac{a+2m+b}{4}\)</span> where <em>m</em> is the median, <em>a</em> is the upper and <em>b</em> is the lower range. The variance is given by <span class="math inline">\(S^2=\frac{1}{12}(\frac{(a+2m+b)^2}{4}+{(b-a)^2})\)</span>. This formula requires examination of the data such as the figure to obtain the upper and lower range.</p>
</div>
<div id="inconsistency-i2" class="section level3">
<h3><span class="header-section-number">4.6.3</span> Inconsistency I2</h3>
<p>The inconsistency <span class="math inline">\(I^2\)</span> index is the sum of the squared deviations from the overall effect and weighted by the study size. Value &lt;25% is classified as low
and greater than 75% as high heterogeneity. This test can be performed using metafor package . The presence of high <span class="math inline">\(I^2\)</span> suggests a need to proceed to meta-regression on the data to understand the source of heterogeneity. The fixed component were the covariates which were being tested for their effect on heterogeneity. The random effect components were the sensitivity and FPR. The <span class="math inline">\(I^2\)</span> value for the TIA clinic study is 34.41%. As such meta-regression is not needed for that study. By contrast, the <span class="math inline">\(I^2\)</span> is much higher for the spot sign study, necessitating metaregression.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="statistics.html#cb61-1"></a><span class="kw">library</span>(PRISMAstatement)</span>
<span id="cb61-2"><a href="statistics.html#cb61-2"></a><span class="co">#example from Spot sign paper. Stroke 2019</span></span>
<span id="cb61-3"><a href="statistics.html#cb61-3"></a><span class="kw">prisma</span>(<span class="dt">found =</span> <span class="dv">193</span>,</span>
<span id="cb61-4"><a href="statistics.html#cb61-4"></a>       <span class="dt">found_other =</span> <span class="dv">27</span>,</span>
<span id="cb61-5"><a href="statistics.html#cb61-5"></a>       <span class="dt">no_dupes =</span> <span class="dv">141</span>, </span>
<span id="cb61-6"><a href="statistics.html#cb61-6"></a>       <span class="dt">screened =</span> <span class="dv">141</span>, </span>
<span id="cb61-7"><a href="statistics.html#cb61-7"></a>       <span class="dt">screen_exclusions =</span> <span class="dv">3</span>, </span>
<span id="cb61-8"><a href="statistics.html#cb61-8"></a>       <span class="dt">full_text =</span> <span class="dv">138</span>,</span>
<span id="cb61-9"><a href="statistics.html#cb61-9"></a>       <span class="dt">full_text_exclusions =</span> <span class="dv">112</span>, </span>
<span id="cb61-10"><a href="statistics.html#cb61-10"></a>       <span class="dt">qualitative =</span> <span class="dv">26</span>, </span>
<span id="cb61-11"><a href="statistics.html#cb61-11"></a>       <span class="dt">quantitative =</span> <span class="dv">26</span>,</span>
<span id="cb61-12"><a href="statistics.html#cb61-12"></a>       <span class="dt">width =</span> <span class="dv">800</span>, <span class="dt">height =</span> <span class="dv">800</span>)</span></code></pre></div>
<div id="htmlwidget-e255f7c9917b8ad0d6d8" style="width:672px;height:480px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-e255f7c9917b8ad0d6d8">{"x":{"diagram":"digraph prisma {\n    node [shape=\"box\", fontsize = 10];\n    graph [splines=ortho, nodesep=1, dpi = 72]\n    a -> nodups;\n    b -> nodups;\n    a [label=\"Records identified through\ndatabase searching\n(n = 193)\"];\n    b [label=\"Additional records identified\nthrough other sources\n(n = 27)\"]\n    nodups -> incex;\n    nodups [label=\"Records after duplicates removed\n(n = 141)\"];\n    incex -> {ex; ft}\n    incex [label=\"Records screened\n(n = 141)\"];\n    ex [label=\"Records excluded\n(n = 3)\"];\n    {rank=same; incex ex}\n    ft -> {qual; ftex};\n    ft [label=\"Full-text articles assessed\nfor eligibility\n(n = 138)\"];\n    {rank=same; ft ftex}\n    ftex [label=\"Full-text articles excluded,\nwith reasons\n(n = 112)\"];\n    qual -> quant\n    qual [label=\"Studies included in qualitative synthesis\n(n = 26)\"];\n    quant [label=\"Studies included in\nquantitative synthesis\n(meta-analysis)\n(n = 26)\"];\n  }","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="metaanalysis-of-proportion" class="section level3">
<h3><span class="header-section-number">4.6.4</span> Metaanalysis of proportion</h3>
<p>This is an example of metaanalysis of stroke recurrence following management in rapid TIA clinic. A variety of different methods for calculating the 95% confidence interval of the binomial distribution. The mean of the binomial distribution is given by p and the variance by <span class="math inline">\(\frac{p \times (1-p)}{n}\)</span>. The term <span class="math inline">\(z\)</span> is given by <span class="math inline">\(1-\frac{\alpha}{2}\)</span> quantile of normal distribution. A standard way of calculating the confidence interval is the Wald method <span class="math inline">\(p\pm z\times \sqrt{\frac{p \times(1-p)}{n}}\)</span>. The Freeman-Tukey double arcsine transformation tries to transform the data to a normal distribution. This
approach is useful for handling when occurence of event is rare. The exact or Clopper-Pearson method is suggested as the most conservative of the methods for calculating confidence interval for proportion. It is based on cumulative properties of the binomial distribution. The Wilson method has similarities to
the Wald method. It has an extra term <span class="math inline">\(z^2/n\)</span>. There are many different methods for calculating the confidence interval for proportions. Investigators such as Agresti proposed that approximate methods are better than exact method <span class="citation">(Agresti and Coull <a href="#ref-doi:10.1080/00031305.1998.10480550" role="doc-biblioref">1998</a>)</span>. Brown and colleagues proposed the use of the Wilson method <span class="citation">(Brown, Cai, and DasGupta <a href="#ref-brown2001" role="doc-biblioref">2001</a>)</span></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="statistics.html#cb62-1"></a><span class="kw">library</span>(metafor) <span class="co">#open software metafor</span></span></code></pre></div>
<pre><code>## 
## Loading the &#39;metafor&#39; package (version 3.0-2). For an
## introduction to the package please type: help(metafor)</code></pre>
<pre><code>## 
## Attaching package: &#39;metafor&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:rms&#39;:
## 
##     vif</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="statistics.html#cb66-1"></a><span class="co">#create data frame dat</span></span>
<span id="cb66-2"><a href="statistics.html#cb66-2"></a><span class="co">#xi is numerator</span></span>
<span id="cb66-3"><a href="statistics.html#cb66-3"></a><span class="co">#ni is denominator</span></span>
<span id="cb66-4"><a href="statistics.html#cb66-4"></a></span>
<span id="cb66-5"><a href="statistics.html#cb66-5"></a>dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">model=</span><span class="kw">c</span>(<span class="st">&quot;melbourne&quot;</span>,<span class="st">&quot;paris&quot;</span>,<span class="st">&quot;oxford&quot;</span>,<span class="st">&quot;stanford&quot;</span>,<span class="st">&quot;ottawa&quot;</span>,<span class="st">&quot;new zealand&quot;</span>),</span>
<span id="cb66-6"><a href="statistics.html#cb66-6"></a><span class="dt">xi=</span><span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">7</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">31</span>,<span class="dv">2</span>), </span>
<span id="cb66-7"><a href="statistics.html#cb66-7"></a><span class="dt">ni=</span><span class="kw">c</span>(<span class="dv">468</span>,<span class="dv">296</span>, <span class="dv">281</span>,<span class="dv">223</span>,<span class="dv">982</span>,<span class="dv">172</span>))</span>
<span id="cb66-8"><a href="statistics.html#cb66-8"></a></span>
<span id="cb66-9"><a href="statistics.html#cb66-9"></a><span class="co">#calculate new variable pi base on ratio xi/ni</span></span>
<span id="cb66-10"><a href="statistics.html#cb66-10"></a>dat<span class="op">$</span>pi &lt;-<span class="st"> </span><span class="kw">with</span>(dat, xi<span class="op">/</span>ni)</span>
<span id="cb66-11"><a href="statistics.html#cb66-11"></a></span>
<span id="cb66-12"><a href="statistics.html#cb66-12"></a><span class="co">#Freeman-Tukey double arcsine trasformation</span></span>
<span id="cb66-13"><a href="statistics.html#cb66-13"></a>dat &lt;-<span class="st"> </span><span class="kw">escalc</span>(<span class="dt">measure=</span><span class="st">&quot;PFT&quot;</span>, <span class="dt">xi=</span>xi, <span class="dt">ni=</span>ni, <span class="dt">data=</span>dat, <span class="dt">add=</span><span class="dv">0</span>) </span>
<span id="cb66-14"><a href="statistics.html#cb66-14"></a>res &lt;-<span class="st"> </span><span class="kw">rma</span>(yi, vi, <span class="dt">method=</span><span class="st">&quot;REML&quot;</span>, <span class="dt">data=</span>dat, <span class="dt">slab=</span><span class="kw">paste</span>(model))</span>
<span id="cb66-15"><a href="statistics.html#cb66-15"></a></span>
<span id="cb66-16"><a href="statistics.html#cb66-16"></a><span class="co">#create forest plot with labels</span></span>
<span id="cb66-17"><a href="statistics.html#cb66-17"></a>metafor<span class="op">::</span><span class="kw">forest</span>(res, <span class="dt">transf=</span>transf.ipft.hm, <span class="dt">targs=</span><span class="kw">list</span>(<span class="dt">ni=</span>dat<span class="op">$</span>ni), <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="fl">1.4</span>),<span class="dt">refline=</span>res<span class="op">$</span>beta[<span class="dv">1</span>],</span>
<span id="cb66-18"><a href="statistics.html#cb66-18"></a>       <span class="dt">cex=</span>.<span class="dv">8</span>, <span class="dt">ilab=</span><span class="kw">cbind</span>(dat<span class="op">$</span>xi, dat<span class="op">$</span>ni), </span>
<span id="cb66-19"><a href="statistics.html#cb66-19"></a>       <span class="co">#position of data on x-axis</span></span>
<span id="cb66-20"><a href="statistics.html#cb66-20"></a>       <span class="dt">ilab.xpos=</span><span class="kw">c</span>(<span class="op">-</span>.<span class="dv">6</span>,<span class="op">-</span>.<span class="dv">4</span>),<span class="dt">digits=</span><span class="dv">3</span>)</span>
<span id="cb66-21"><a href="statistics.html#cb66-21"></a></span>
<span id="cb66-22"><a href="statistics.html#cb66-22"></a><span class="co">#par function combine multiple plots into one</span></span>
<span id="cb66-23"><a href="statistics.html#cb66-23"></a>op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">cex=</span>.<span class="dv">75</span>, <span class="dt">font=</span><span class="dv">2</span>)</span>
<span id="cb66-24"><a href="statistics.html#cb66-24"></a><span class="co">#position of column names on x-axis</span></span>
<span id="cb66-25"><a href="statistics.html#cb66-25"></a><span class="kw">text</span>(<span class="op">-</span><span class="fl">1.0</span>, <span class="fl">7.5</span>, <span class="st">&quot;model &quot;</span>,<span class="dt">pos=</span><span class="dv">4</span>)</span>
<span id="cb66-26"><a href="statistics.html#cb66-26"></a><span class="kw">text</span>(<span class="kw">c</span>(<span class="op">-</span>.<span class="dv">55</span>,<span class="op">-</span>.<span class="dv">2</span>), <span class="fl">7.5</span>, <span class="kw">c</span>(<span class="st">&quot;recurrence&quot;</span>, <span class="st">&quot; total subjects&quot;</span>))</span>
<span id="cb66-27"><a href="statistics.html#cb66-27"></a><span class="kw">text</span>(<span class="fl">1.4</span>,<span class="fl">7.5</span>, <span class="st">&quot;Proportion [95% CI]&quot;</span>, <span class="dt">pos=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-16-1.png" width="672" /></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="statistics.html#cb67-1"></a><span class="kw">par</span>(op)</span></code></pre></div>
<p>Exact 95% confidence interval for proportion is provided below using the TIA
data above. This solution was provided on <em>stack overflow</em>. This is performed using the <em>binomial.test</em> function.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="statistics.html#cb68-1"></a><span class="co">#exact confidence interval</span></span>
<span id="cb68-2"><a href="statistics.html#cb68-2"></a><span class="kw">sapply</span>(<span class="kw">split</span>(dat, dat<span class="op">$</span>model), <span class="cf">function</span>(x) <span class="kw">binom.test</span>(x<span class="op">$</span>xi, x<span class="op">$</span>ni)<span class="op">$</span>conf.int)</span></code></pre></div>
<pre><code>##       melbourne new zealand     ottawa      oxford      paris    stanford
## [1,] 0.00603419 0.001411309 0.02154780 0.007875285 0.00955965 0.001087992
## [2,] 0.03057375 0.041370853 0.04451101 0.045893259 0.04811612 0.032020390</code></pre>
<p>The data needs to be transposed using <em>t</em> function. This generates one column
for lower and another for upper CI. Note that sapply returns a matrix or array
and the column names have to be assigned.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="statistics.html#cb70-1"></a><span class="co">#the data</span></span>
<span id="cb70-2"><a href="statistics.html#cb70-2"></a>tmp &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">sapply</span>(<span class="kw">split</span>(dat, dat<span class="op">$</span>model), <span class="cf">function</span>(x) <span class="kw">binom.test</span>(x<span class="op">$</span>xi, x<span class="op">$</span>ni)<span class="op">$</span>conf.int))</span>
<span id="cb70-3"><a href="statistics.html#cb70-3"></a>tmp</span></code></pre></div>
<pre><code>##                    [,1]       [,2]
## melbourne   0.006034190 0.03057375
## new zealand 0.001411309 0.04137085
## ottawa      0.021547797 0.04451101
## oxford      0.007875285 0.04589326
## paris       0.009559650 0.04811612
## stanford    0.001087992 0.03202039</code></pre>
<p>The exact confidence is now put back into the dat data frame.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="statistics.html#cb72-1"></a>dat<span class="op">$</span>ci.lb &lt;-<span class="st"> </span>tmp[,<span class="dv">1</span>] <span class="co">#adding column to data frame dat</span></span>
<span id="cb72-2"><a href="statistics.html#cb72-2"></a>dat<span class="op">$</span>ci.ub &lt;-<span class="st"> </span>tmp[,<span class="dv">2</span>] <span class="co">#adding column to data frame dat</span></span>
<span id="cb72-3"><a href="statistics.html#cb72-3"></a></span>
<span id="cb72-4"><a href="statistics.html#cb72-4"></a>dat &lt;-<span class="st"> </span><span class="kw">escalc</span>(<span class="dt">measure=</span><span class="st">&quot;PFT&quot;</span>, <span class="dt">xi=</span>xi, <span class="dt">ni=</span>ni, <span class="dt">data=</span>dat, <span class="dt">add=</span><span class="dv">0</span>) </span>
<span id="cb72-5"><a href="statistics.html#cb72-5"></a>res &lt;-<span class="st"> </span><span class="kw">rma.glmm</span>(<span class="dt">measure=</span><span class="st">&quot;PLO&quot;</span>, <span class="dt">xi=</span>xi, <span class="dt">ni=</span>ni, <span class="dt">data=</span>dat)</span></code></pre></div>
<pre><code>## Registered S3 methods overwritten by &#39;lme4&#39;:
##   method                          from
##   cooks.distance.influence.merMod car 
##   influence.merMod                car 
##   dfbeta.influence.merMod         car 
##   dfbetas.influence.merMod        car</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="statistics.html#cb74-1"></a><span class="co">#insert the exact confidence interval </span></span>
<span id="cb74-2"><a href="statistics.html#cb74-2"></a><span class="kw">with</span>(dat, metafor<span class="op">::</span><span class="kw">forest</span>(yi, <span class="dt">ci.lb=</span>ci.lb, <span class="dt">ci.ub=</span>ci.ub, </span>
<span id="cb74-3"><a href="statistics.html#cb74-3"></a>  <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">1.5</span>,<span class="fl">8.5</span>), </span>
<span id="cb74-4"><a href="statistics.html#cb74-4"></a>  <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">1.1</span>,<span class="dv">1</span>), </span>
<span id="cb74-5"><a href="statistics.html#cb74-5"></a>  <span class="dt">refline=</span><span class="kw">predict</span>(res, <span class="dt">transf=</span>transf.ilogit)<span class="op">$</span>pred,</span>
<span id="cb74-6"><a href="statistics.html#cb74-6"></a>  <span class="dt">cex=</span>.<span class="dv">8</span>, </span>
<span id="cb74-7"><a href="statistics.html#cb74-7"></a>  <span class="dt">ilab=</span><span class="kw">cbind</span>(dat<span class="op">$</span>xi, dat<span class="op">$</span>ni), </span>
<span id="cb74-8"><a href="statistics.html#cb74-8"></a>  <span class="dt">ilab.xpos=</span><span class="kw">c</span>(<span class="op">-</span>.<span class="dv">6</span>,<span class="op">-</span>.<span class="dv">2</span>),<span class="dt">digits=</span><span class="dv">3</span>))</span>
<span id="cb74-9"><a href="statistics.html#cb74-9"></a>  </span>
<span id="cb74-10"><a href="statistics.html#cb74-10"></a>op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">cex=</span>.<span class="dv">75</span>, <span class="dt">font=</span><span class="dv">2</span>)</span>
<span id="cb74-11"><a href="statistics.html#cb74-11"></a><span class="kw">addpoly</span>(res, <span class="dt">row=</span><span class="op">-</span><span class="dv">1</span>, <span class="dt">transf=</span>transf.ilogit)</span>
<span id="cb74-12"><a href="statistics.html#cb74-12"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>)</span>
<span id="cb74-13"><a href="statistics.html#cb74-13"></a><span class="co">#position of column names on x-axis</span></span>
<span id="cb74-14"><a href="statistics.html#cb74-14"></a><span class="kw">text</span>(<span class="op">-</span>.<span class="dv">9</span>, <span class="fl">7.5</span>, <span class="st">&quot;Model&quot;</span>, <span class="dt">pos=</span><span class="dv">2</span>)</span>
<span id="cb74-15"><a href="statistics.html#cb74-15"></a><span class="kw">text</span>(<span class="kw">c</span>(<span class="op">-</span>.<span class="dv">55</span>,<span class="op">-</span>.<span class="dv">2</span>), <span class="fl">7.5</span>, <span class="kw">c</span>(<span class="st">&quot;recurrence&quot;</span>, <span class="st">&quot; total subjects&quot;</span>))</span>
<span id="cb74-16"><a href="statistics.html#cb74-16"></a><span class="kw">text</span>( <span class="dv">1</span>,   <span class="fl">7.5</span>, <span class="st">&quot;Proportion [95% CI]&quot;</span>, <span class="dt">pos=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/Statistics-16-3-1.png" width="672" /></p>
</div>
<div id="bivariate-metaanalysis" class="section level3">
<h3><span class="header-section-number">4.6.5</span> Bivariate Metaanalysis</h3>
<p>The univariate method of Moses-Shapiro-Littenberg combines these measures (sensitivity and specificity) into a single measure of accuracy (diagnostic odds ratio)<span class="citation">(Moses, Shapiro, and Littenberg <a href="#ref-pmid8210827" role="doc-biblioref">1993</a>)</span> . This approach has been criticized for losing data on sensitivity and specificity of the test. Similar to the univariate method, the bivariate method employs a random effect to take into account the within study correlation <span class="citation">(Reitsma et al. <a href="#ref-pmid16168343" role="doc-biblioref">2005</a>)</span>. Additionally, the bivariate method also accounts
for the between-study correlation in sensitivity and specificity. Bivariate analysis is performed using <em>mada</em> package. A Bayesian library for bivariate analysis <em>meta4diag</em> is illustrated later.</p>
<p>The example below is taken from a metaanalysis of spot sign as predictor
expansion of intracerebral hemorrhage <span class="citation">(Phan et al. <a href="#ref-pmid31272327" role="doc-biblioref">2019</a>)</span>. The data for this
analysis is available in the Data-Use sub-folder.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="statistics.html#cb75-1"></a><span class="kw">library</span>(mada)</span></code></pre></div>
<pre><code>## Loading required package: ellipse</code></pre>
<pre><code>## 
## Attaching package: &#39;ellipse&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:graphics&#39;:
## 
##     pairs</code></pre>
<pre><code>## Loading required package: mvmeta</code></pre>
<pre><code>## This is mvmeta 1.0.3. For an overview type: help(&#39;mvmeta-package&#39;).</code></pre>
<pre><code>## 
## Attaching package: &#39;mvmeta&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:metafor&#39;:
## 
##     blup</code></pre>
<pre><code>## The following object is masked from &#39;package:checkmate&#39;:
## 
##     qtest</code></pre>
<pre><code>## 
## Attaching package: &#39;mada&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:metafor&#39;:
## 
##     forest</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="statistics.html#cb86-1"></a><span class="co">#spot sign data</span></span>
<span id="cb86-2"><a href="statistics.html#cb86-2"></a>Data&lt;-<span class="kw">read.csv</span>(<span class="st">&quot;./Data-Use/ss150718.csv&quot;</span>)</span>
<span id="cb86-3"><a href="statistics.html#cb86-3"></a></span>
<span id="cb86-4"><a href="statistics.html#cb86-4"></a><span class="co">#remove duplicates using subset</span></span>
<span id="cb86-5"><a href="statistics.html#cb86-5"></a><span class="co">#another way is to use filter from dplyr</span></span>
<span id="cb86-6"><a href="statistics.html#cb86-6"></a>Dat&lt;-<span class="kw">subset</span>(Data, Data<span class="op">$</span>retain<span class="op">==</span><span class="st">&quot;yes&quot;</span>) </span>
<span id="cb86-7"><a href="statistics.html#cb86-7"></a>(ss&lt;-<span class="kw">reitsma</span>(Dat))</span></code></pre></div>
<pre><code>## Call:  reitsma.default(data = Dat)
## 
## Fixed-effects coefficients:
##               tsens     tfpr
## (Intercept)  0.2548  -1.9989
## 
## 27 studies, 2 fixed and 3 random-effects parameters
##   logLik       AIC       BIC  
##  52.0325  -94.0650  -84.1201</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="statistics.html#cb88-1"></a><span class="kw">summary</span>(ss)</span></code></pre></div>
<pre><code>## Call:  reitsma.default(data = Dat)
## 
## Bivariate diagnostic random-effects meta-analysis
## Estimation method: REML
## 
## Fixed-effects coefficients
##                   Estimate Std. Error       z Pr(&gt;|z|) 95%ci.lb 95%ci.ub    
## tsens.(Intercept)    0.255      0.152   1.676    0.094   -0.043    0.553   .
## tfpr.(Intercept)    -1.999      0.097 -20.664    0.000   -2.189   -1.809 ***
## sensitivity          0.563          -       -        -    0.489    0.635    
## false pos. rate      0.119          -       -        -    0.101    0.141    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 
## 
## Variance components: between-studies Std. Dev and correlation matrix
##       Std. Dev  tsens  tfpr
## tsens    0.692  1.000     .
## tfpr     0.400 -0.003 1.000
## 
##  logLik     AIC     BIC 
##  52.033 -94.065 -84.120 
## 
## AUC:  0.858
## Partial AUC (restricted to observed FPRs and normalized):  0.547
## 
## HSROC parameters 
##       Theta      Lambda        beta sigma2theta sigma2alpha 
##      -1.217       2.823      -0.548       0.138       0.556</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="statistics.html#cb90-1"></a><span class="kw">AUC</span>(<span class="kw">reitsma</span>(<span class="dt">data =</span> Dat))</span></code></pre></div>
<pre><code>## $AUC
## [1] 0.8576619
## 
## $pAUC
## [1] 0.5474316
## 
## attr(,&quot;sroc.type&quot;)
## [1] &quot;ruttergatsonis&quot;</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="statistics.html#cb92-1"></a>sumss&lt;-<span class="kw">SummaryPts</span>(ss,<span class="dt">n.iter =</span> <span class="dv">10</span><span class="op">^</span><span class="dv">3</span>) <span class="co">#bivariate pooled LR</span></span>
<span id="cb92-2"><a href="statistics.html#cb92-2"></a><span class="kw">summary</span>(sumss)</span></code></pre></div>
<pre><code>##           Mean Median  2.5%  97.5%
## posLR    4.740  4.730 3.760  5.820
## negLR    0.496  0.494 0.417  0.578
## invnegLR 2.030  2.020 1.730  2.400
## DOR      9.690  9.570 6.670 13.600</code></pre>
</div>
<div id="metaanalysis-of-clinical-trial." class="section level3">
<h3><span class="header-section-number">4.6.6</span> Metaanalysis of clinical trial.</h3>
<p>Fixed effect (Peto or Mantel-Haenszel) approaches assume that the population is the same for all studies and thus each study is the source of error. Random
effect (DerSimonian Laird) assumes an additional source of error between studies.The random effect approach results in more conservate estimate of effect size confidence interval. A criticism of DerSimnonian and Laird approach is that it is prone to type I error especially when the number of number of studies is small (n&lt;20) or moderate heterogeneity. Its estimated that 25% of the
significant findings with DerSimonian Laird method may be non-significant with Hartung-Knapp method (BMC Medical Research Methodology 2014, 14:25). The Hartung-Knapp method (Stat Med 2001;20:3875-89) estimate the between studies variance and treat it as fixed. It employs quantile of t-distribution rather
than normal distribution. The Hartung-Knapp method is available in meta and metafor package.</p>
<p>The data is from Jama Cardiology 2020 on Associations of Omega-3 Fatty Acid Supplement Use With Cardiovascular Disease Risks Meta-analysis of 10 Trials Involving 77917 Individuals. Subsequently a meta-analysis in J Am Heart Assoc. 2019;8:e013543. DOI: 10.1161/JAHA.119.013543 reported that contrary to the
earlier meta-analysis, Omega-3 lowers the risk of cardiovascular diseases with effect related to dose. The analysis using DerSimonian Laird and Hartung Knapp method is illustrated below.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="statistics.html#cb94-1"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## -- Attaching packages --------------------------------------- tidyverse 1.3.0 --</code></pre>
<pre><code>## v tidyr   1.1.4     v forcats 0.5.0
## v readr   1.4.0</code></pre>
<pre><code>## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x rlang::%@%()            masks purrr::%@%()
## x crayon::%+%()           masks ggplot2::%+%()
## x rlang:::=()             masks data.table:::=()
## x rlang::as_function()    masks purrr::as_function()
## x dplyr::between()        masks data.table::between()
## x rlang::chr()            masks crayon::chr()
## x readr::col_factor()     masks scales::col_factor()
## x dplyr::collapse()       masks nlme::collapse()
## x dplyr::combine()        masks gridExtra::combine()
## x dplyr::count()          masks matrixStats::count()
## x vctrs::data_frame()     masks dplyr::data_frame(), tibble::data_frame()
## x dplyr::dim_desc()       masks pillar::dim_desc()
## x scales::discard()       masks purrr::discard()
## x tidyr::expand()         masks Matrix::expand()
## x tidyr::extract()        masks magrittr::extract()
## x dplyr::filter()         masks stats::filter()
## x dplyr::first()          masks data.table::first()
## x rlang::flatten()        masks purrr::flatten()
## x rlang::flatten_chr()    masks purrr::flatten_chr()
## x rlang::flatten_dbl()    masks purrr::flatten_dbl()
## x rlang::flatten_int()    masks purrr::flatten_int()
## x rlang::flatten_lgl()    masks purrr::flatten_lgl()
## x rlang::flatten_raw()    masks purrr::flatten_raw()
## x rlang::has_name()       masks tibble::has_name(), assertthat::has_name()
## x rlang::invoke()         masks purrr::invoke()
## x dplyr::lag()            masks stats::lag()
## x dplyr::last()           masks data.table::last()
## x latticeExtra::layer()   masks ggplot2::layer()
## x Metrics::ll()           masks rlang::ll()
## x rlang::local_options()  masks withr::local_options()
## x purrr::map()            masks listenv::map()
## x tidyr::pack()           masks Matrix::pack()
## x dplyr::select()         masks MASS::select()
## x rlang::set_names()      masks magrittr::set_names(), purrr::set_names()
## x readr::spec()           masks mada::spec()
## x rlang::splice()         masks purrr::splice()
## x dplyr::src()            masks Hmisc::src()
## x cli::style_bold()       masks pillar::style_bold()
## x dplyr::summarize()      masks Hmisc::summarize()
## x data.table::transpose() masks purrr::transpose()
## x xfun::tree()            masks cli::tree()
## x tidyr::unpack()         masks Matrix::unpack()
## x rlang::with_options()   masks withr::with_options()</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="statistics.html#cb98-1"></a><span class="kw">library</span>(metafor)</span>
<span id="cb98-2"><a href="statistics.html#cb98-2"></a></span>
<span id="cb98-3"><a href="statistics.html#cb98-3"></a><span class="co">#Omega 3 data</span></span>
<span id="cb98-4"><a href="statistics.html#cb98-4"></a>Year=<span class="kw">c</span>(<span class="dv">2010</span>,<span class="dv">2014</span>,<span class="dv">2010</span>,<span class="dv">2007</span>,<span class="dv">2010</span>,<span class="dv">2010</span>,<span class="dv">2013</span>,<span class="dv">2008</span>,<span class="dv">2012</span>,<span class="dv">1999</span>)</span>
<span id="cb98-5"><a href="statistics.html#cb98-5"></a>Trials=<span class="kw">c</span>(<span class="st">&quot;DOIT&quot;</span>,<span class="st">&quot;AREDS-2&quot;</span>,<span class="st">&quot;SU.FOL.OM3&quot;</span>,<span class="st">&quot;JELIS&quot;</span>,<span class="st">&quot;Alpha Omega&quot;</span>,<span class="st">&quot;OMEGA&quot;</span>,<span class="st">&quot;R&amp;P&quot;</span>,<span class="st">&quot;GISSI-HF&quot;</span>,<span class="st">&quot;ORIGIN&quot;</span>,<span class="st">&quot;GISSI-P&quot;</span>)</span>
<span id="cb98-6"><a href="statistics.html#cb98-6"></a>Treatment=<span class="kw">c</span>(<span class="dv">29</span>,<span class="dv">213</span>,<span class="dv">216</span>,<span class="dv">262</span>,<span class="dv">332</span>,<span class="dv">534</span>,<span class="dv">733</span>,<span class="dv">783</span>,<span class="dv">1276</span>,<span class="dv">1552</span>)</span>
<span id="cb98-7"><a href="statistics.html#cb98-7"></a>Treatment.per=<span class="kw">c</span>(<span class="fl">10.3</span>,<span class="fl">9.9</span>,<span class="fl">17.2</span>,<span class="fl">2.8</span>,<span class="fl">13.8</span>,<span class="fl">27.7</span>,<span class="fl">11.7</span>,<span class="fl">22.4</span>,<span class="fl">20.3</span>,<span class="fl">27.4</span>)</span>
<span id="cb98-8"><a href="statistics.html#cb98-8"></a>Control=<span class="kw">c</span>(<span class="dv">35</span>,<span class="dv">208</span>,<span class="dv">211</span>,<span class="dv">324</span>,<span class="dv">331</span>,<span class="dv">541</span>,<span class="dv">745</span>,<span class="dv">831</span>,<span class="dv">1295</span>,<span class="dv">1550</span>)</span>
<span id="cb98-9"><a href="statistics.html#cb98-9"></a>Control.per=<span class="kw">c</span>(<span class="fl">12.5</span>,<span class="fl">10.1</span>,<span class="fl">16.9</span>,<span class="fl">3.5</span>,<span class="fl">13.6</span>,<span class="fl">28.6</span>, <span class="fl">11.9</span>,<span class="fl">23.9</span>,<span class="fl">20.7</span>,<span class="fl">27.3</span>)</span>
<span id="cb98-10"><a href="statistics.html#cb98-10"></a></span>
<span id="cb98-11"><a href="statistics.html#cb98-11"></a><span class="co">#combine into data frame</span></span>
<span id="cb98-12"><a href="statistics.html#cb98-12"></a>rct&lt;-<span class="kw">data.frame</span>(Year,Trials,Treatment,Treatment.per,Control,Control.per) <span class="op">%&gt;%</span></span>
<span id="cb98-13"><a href="statistics.html#cb98-13"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Treatment.number=</span><span class="kw">round</span>(Treatment<span class="op">*</span><span class="dv">100</span><span class="op">/</span>Treatment.per,<span class="dv">0</span>),</span>
<span id="cb98-14"><a href="statistics.html#cb98-14"></a>         <span class="dt">Control.number=</span><span class="kw">round</span>(Control<span class="op">*</span><span class="dv">100</span><span class="op">/</span>Control.per,<span class="dv">0</span>)) <span class="op">%&gt;%</span></span>
<span id="cb98-15"><a href="statistics.html#cb98-15"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">ai=</span>Treatment,<span class="dt">n1i=</span>Treatment.number,<span class="dt">ci=</span>Control,</span>
<span id="cb98-16"><a href="statistics.html#cb98-16"></a>         <span class="dt">n2i=</span>Control.number,<span class="dt">study=</span>Trials,<span class="dt">year=</span>Year)</span>
<span id="cb98-17"><a href="statistics.html#cb98-17"></a></span>
<span id="cb98-18"><a href="statistics.html#cb98-18"></a></span>
<span id="cb98-19"><a href="statistics.html#cb98-19"></a><span class="co">#peto&#39;s fixed effect method</span></span>
<span id="cb98-20"><a href="statistics.html#cb98-20"></a>res &lt;-<span class="st"> </span><span class="kw">rma.peto</span>(<span class="dt">ai=</span>ai, <span class="dt">n1i=</span>n1i, <span class="dt">ci=</span>ci, <span class="dt">n2i=</span>n2i, <span class="dt">data=</span>rct)</span>
<span id="cb98-21"><a href="statistics.html#cb98-21"></a><span class="kw">print</span>(res, <span class="dt">digits=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## 
## Fixed-Effects Model (k = 10)
## 
## I^2 (total heterogeneity / total variability):  0.00%
## H^2 (total variability / sampling variability): 0.93
## 
## Test for Heterogeneity: 
## Q(df = 9) = 8.36, p-val = 0.50
## 
## Model Results (log scale):
## 
## estimate    se   zval  pval  ci.lb  ci.ub 
##    -0.04  0.02  -1.72  0.08  -0.08   0.00 
## 
## Model Results (OR scale):
## 
## estimate  ci.lb  ci.ub 
##     0.97   0.93   1.00</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="statistics.html#cb100-1"></a>result&lt;-<span class="kw">predict</span>(res, <span class="dt">transf=</span>exp, <span class="dt">digits=</span><span class="dv">2</span>)</span>
<span id="cb100-2"><a href="statistics.html#cb100-2"></a><span class="co">#forest plot</span></span>
<span id="cb100-3"><a href="statistics.html#cb100-3"></a>metafor<span class="op">::</span><span class="kw">forest</span>(res, <span class="dt">targs=</span><span class="kw">list</span>(<span class="dt">study=</span>rct<span class="op">$</span>study), </span>
<span id="cb100-4"><a href="statistics.html#cb100-4"></a><span class="dt">main=</span><span class="st">&quot;RCT of Omega3 fatty acid for cardiovascular disease-Peto&quot;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-17-1-1.png" width="672" /></p>
<p>The funnel plot is used here to illustrate presence or absence publication bias. In this case the funnel plot reflects the same findings as the low <span class="math inline">\(I^2\)</span> value. There is one outlier. We will explore this further with the <em>GOSH</em> plot below.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="statistics.html#cb101-1"></a><span class="co"># funnel plot </span></span>
<span id="cb101-2"><a href="statistics.html#cb101-2"></a><span class="kw">funnel</span>(res, <span class="dt">refline=</span><span class="dv">0</span>, <span class="dt">level=</span><span class="kw">c</span>(<span class="dv">90</span>, <span class="dv">95</span>, <span class="dv">99</span>), </span>
<span id="cb101-3"><a href="statistics.html#cb101-3"></a>       <span class="dt">shade=</span><span class="kw">c</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;gray&quot;</span>, <span class="st">&quot;darkgray&quot;</span>))</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-17-2-1.png" width="672" /></p>
<p>Random effect (DerSimonian Laird) assumes an additional source of error between studies when calculating odds ratio.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="statistics.html#cb102-1"></a><span class="co">#DL</span></span>
<span id="cb102-2"><a href="statistics.html#cb102-2"></a>datO3 &lt;-<span class="st"> </span><span class="kw">escalc</span>(<span class="dt">measure =</span> <span class="st">&quot;OR&quot;</span>,<span class="dt">ai=</span>ai, <span class="dt">n1i=</span>n1i, <span class="dt">ci=</span>ci, <span class="dt">n2i=</span>n2i,<span class="dt">data=</span>rct)</span>
<span id="cb102-3"><a href="statistics.html#cb102-3"></a>res.DL&lt;-<span class="kw">rma</span>(yi,vi, <span class="dt">method =</span> <span class="st">&quot;DL&quot;</span>,<span class="dt">data=</span>datO3)</span>
<span id="cb102-4"><a href="statistics.html#cb102-4"></a>metafor<span class="op">::</span><span class="kw">forest</span>(res.DL,<span class="dt">main=</span><span class="st">&quot;RCT of Omega3 fatty acid for cardiovascular disease-DL&quot;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-17-3-1.png" width="672" /></p>
<p>DerSimonian Laird method may not be appropriate for metaanalysis with small
number of studies . The recommendation is to use the Hartung Knapp random effect method. This analysis show that inspite of the small sample size the significant findings remain.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="statistics.html#cb103-1"></a><span class="co">#Hartung-ignore error message</span></span>
<span id="cb103-2"><a href="statistics.html#cb103-2"></a>res.HK&lt;-<span class="kw">rma.uni</span>(yi,<span class="dt">vi=</span><span class="dv">1</span><span class="op">/</span>vi,<span class="dt">method=</span><span class="st">&quot;FE&quot;</span>,<span class="dt">knha=</span><span class="ot">TRUE</span>,<span class="dt">data=</span>datO3)</span>
<span id="cb103-3"><a href="statistics.html#cb103-3"></a>metafor<span class="op">::</span><span class="kw">forest</span>(res.HK,<span class="dt">main=</span><span class="st">&quot;RCT of Omega3 fatty acid for cardiovascular disease-HK&quot;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-17-4-1.png" width="672" /></p>
<p>Subgroup analysis is one way of exploring the data for group effect. Metaregression is illustrated later.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="statistics.html#cb104-1"></a><span class="co">#create subgroups for Omega 3 trial based on year of publication</span></span>
<span id="cb104-2"><a href="statistics.html#cb104-2"></a>rct1&lt;-rct[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,]</span>
<span id="cb104-3"><a href="statistics.html#cb104-3"></a>rct2&lt;-rct[<span class="dv">6</span><span class="op">:</span><span class="dv">10</span>,]</span>
<span id="cb104-4"><a href="statistics.html#cb104-4"></a>rct1<span class="op">$</span>group[rct1<span class="op">$</span>year<span class="op">&gt;=</span><span class="dv">1999</span>]&lt;-<span class="st">&quot;wide&quot;</span></span>
<span id="cb104-5"><a href="statistics.html#cb104-5"></a>rct2<span class="op">$</span>group[rct2<span class="op">$</span>year<span class="op">&gt;=</span><span class="dv">1999</span>]&lt;-<span class="st">&quot;narrow&quot;</span></span>
<span id="cb104-6"><a href="statistics.html#cb104-6"></a>rct3&lt;-<span class="kw">rbind</span>(rct1,rct2)</span>
<span id="cb104-7"><a href="statistics.html#cb104-7"></a></span>
<span id="cb104-8"><a href="statistics.html#cb104-8"></a>datO3<span class="op">$</span>group&lt;-rct3<span class="op">$</span>group</span>
<span id="cb104-9"><a href="statistics.html#cb104-9"></a><span class="co">#plot subgroups</span></span>
<span id="cb104-10"><a href="statistics.html#cb104-10"></a>res.group &lt;-<span class="st"> </span><span class="kw">rma</span>(yi, vi, <span class="dt">mods =</span> <span class="op">~</span><span class="st"> </span>group, <span class="dt">data=</span>datO3)</span>
<span id="cb104-11"><a href="statistics.html#cb104-11"></a>res.wide&lt;-<span class="st"> </span><span class="kw">rma</span>(yi, vi, <span class="dt">subset=</span>(group<span class="op">==</span><span class="st">&quot;wide&quot;</span>), <span class="dt">data=</span>datO3)</span>
<span id="cb104-12"><a href="statistics.html#cb104-12"></a>res.wide</span></code></pre></div>
<pre><code>## 
## Random-Effects Model (k = 5; tau^2 estimator: REML)
## 
## tau^2 (estimated amount of total heterogeneity): 0.0069 (SE = 0.0127)
## tau (square root of estimated tau^2 value):      0.0831
## I^2 (total heterogeneity / total variability):   38.46%
## H^2 (total variability / sampling variability):  1.62
## 
## Test for Heterogeneity:
## Q(df = 4) = 5.9601, p-val = 0.2022
## 
## Model Results:
## 
## estimate      se     zval    pval    ci.lb   ci.ub 
##  -0.0676  0.0611  -1.1077  0.2680  -0.1873  0.0520    
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="statistics.html#cb106-1"></a>res.narrow&lt;-<span class="st"> </span><span class="kw">rma</span>(yi, vi, <span class="dt">subset=</span>(group<span class="op">==</span><span class="st">&quot;narrow&quot;</span>), <span class="dt">data=</span>datO3)</span>
<span id="cb106-2"><a href="statistics.html#cb106-2"></a>res.narrow</span></code></pre></div>
<pre><code>## 
## Random-Effects Model (k = 5; tau^2 estimator: REML)
## 
## tau^2 (estimated amount of total heterogeneity): 0 (SE = 0.0018)
## tau (square root of estimated tau^2 value):      0
## I^2 (total heterogeneity / total variability):   0.00%
## H^2 (total variability / sampling variability):  1.00
## 
## Test for Heterogeneity:
## Q(df = 4) = 1.6888, p-val = 0.7928
## 
## Model Results:
## 
## estimate      se     zval    pval    ci.lb   ci.ub 
##  -0.0266  0.0229  -1.1609  0.2457  -0.0715  0.0183    
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="statistics.html#cb108-1"></a><span class="co">#https://stackoverflow.com/questions/39392706/using-the-r-forestplot-package-</span></span>
<span id="cb108-2"><a href="statistics.html#cb108-2"></a><span class="co">#is-there-a-way-to-assign-variable-colors-to-boxe</span></span>
<span id="cb108-3"><a href="statistics.html#cb108-3"></a></span>
<span id="cb108-4"><a href="statistics.html#cb108-4"></a><span class="co">#confidence interval</span></span>
<span id="cb108-5"><a href="statistics.html#cb108-5"></a>rmeta_conf &lt;-<span class="st"> </span></span>
<span id="cb108-6"><a href="statistics.html#cb108-6"></a><span class="st">  </span><span class="kw">structure</span>(<span class="kw">list</span>(</span>
<span id="cb108-7"><a href="statistics.html#cb108-7"></a>    <span class="dt">mean  =</span> <span class="kw">c</span>(<span class="ot">NA</span>, <span class="ot">NA</span>, <span class="kw">exp</span>(<span class="op">-</span><span class="fl">0.0676</span>), <span class="kw">exp</span>(<span class="op">-</span><span class="fl">0.0266</span>),  <span class="ot">NA</span>, <span class="kw">exp</span>(<span class="op">-</span><span class="fl">0.0352</span>)), </span>
<span id="cb108-8"><a href="statistics.html#cb108-8"></a>    <span class="dt">lower =</span> <span class="kw">c</span>(<span class="ot">NA</span>, <span class="ot">NA</span>, <span class="kw">exp</span>(<span class="op">-</span><span class="fl">0.1873</span>), <span class="kw">exp</span>(<span class="op">-</span><span class="fl">0.0715</span>),  <span class="ot">NA</span>, <span class="kw">exp</span>(<span class="op">-</span><span class="fl">0.0753</span>)),</span>
<span id="cb108-9"><a href="statistics.html#cb108-9"></a>    <span class="dt">upper =</span> <span class="kw">c</span>(<span class="ot">NA</span>, <span class="ot">NA</span>, <span class="kw">exp</span>(<span class="fl">0.0520</span>), <span class="kw">exp</span>(<span class="fl">0.0183</span>),  <span class="ot">NA</span>, <span class="kw">exp</span>(<span class="fl">0.0049</span>))),</span>
<span id="cb108-10"><a href="statistics.html#cb108-10"></a>    <span class="dt">.Names =</span> <span class="kw">c</span>(<span class="st">&quot;mean&quot;</span>, <span class="st">&quot;lower&quot;</span>, <span class="st">&quot;upper&quot;</span>), </span>
<span id="cb108-11"><a href="statistics.html#cb108-11"></a>    <span class="dt">row.names =</span> <span class="kw">c</span>(<span class="ot">NA</span>, <span class="op">-</span>6L), </span>
<span id="cb108-12"><a href="statistics.html#cb108-12"></a>    <span class="dt">class =</span> <span class="st">&quot;data.frame&quot;</span>)</span>
<span id="cb108-13"><a href="statistics.html#cb108-13"></a></span>
<span id="cb108-14"><a href="statistics.html#cb108-14"></a><span class="co">#table data</span></span>
<span id="cb108-15"><a href="statistics.html#cb108-15"></a>tabletext&lt;-<span class="kw">cbind</span>(<span class="kw">c</span>(<span class="st">&quot;&quot;</span>,<span class="st">&quot;Trials&quot;</span>,<span class="st">&quot;wide&quot;</span>,<span class="st">&quot;narrow&quot;</span>,<span class="ot">NA</span>,<span class="st">&quot;Summary&quot;</span>),</span>
<span id="cb108-16"><a href="statistics.html#cb108-16"></a>    <span class="kw">c</span>(<span class="st">&quot;Events&quot;</span>,<span class="st">&quot;(Drugs)&quot;</span>,<span class="kw">sum</span>(<span class="kw">filter</span>(datO3,group<span class="op">==</span><span class="st">&quot;wide&quot;</span>)<span class="op">$</span>ai),</span>
<span id="cb108-17"><a href="statistics.html#cb108-17"></a>      <span class="kw">sum</span>(<span class="kw">filter</span>(datO3,group<span class="op">==</span><span class="st">&quot;narrow&quot;</span>)<span class="op">$</span>ai),<span class="ot">NA</span>,<span class="ot">NA</span>),</span>
<span id="cb108-18"><a href="statistics.html#cb108-18"></a>    <span class="kw">c</span>(<span class="st">&quot;Events&quot;</span>,<span class="st">&quot;(Control)&quot;</span>,<span class="kw">sum</span>(<span class="kw">filter</span>(datO3,group<span class="op">==</span><span class="st">&quot;wide&quot;</span>)<span class="op">$</span>ci),</span>
<span id="cb108-19"><a href="statistics.html#cb108-19"></a>      <span class="kw">sum</span>(<span class="kw">filter</span>(datO3,group<span class="op">==</span><span class="st">&quot;narrow&quot;</span>)<span class="op">$</span>ci),<span class="ot">NA</span>,<span class="ot">NA</span>),     </span>
<span id="cb108-20"><a href="statistics.html#cb108-20"></a>    <span class="kw">c</span>(<span class="st">&quot;&quot;</span>,<span class="st">&quot;OR&quot;</span>,<span class="st">&quot;0.934&quot;</span>,<span class="st">&quot;0.974&quot;</span>,<span class="ot">NA</span>,<span class="st">&quot;0.965&quot;</span>)</span>
<span id="cb108-21"><a href="statistics.html#cb108-21"></a>                 )</span>
<span id="cb108-22"><a href="statistics.html#cb108-22"></a><span class="co">#use forestplot as another library to perform forest plot</span></span>
<span id="cb108-23"><a href="statistics.html#cb108-23"></a><span class="kw">library</span>(forestplot)</span>
<span id="cb108-24"><a href="statistics.html#cb108-24"></a> <span class="kw">forestplot</span>(tabletext, </span>
<span id="cb108-25"><a href="statistics.html#cb108-25"></a>       rmeta_conf,<span class="dt">new_page =</span> <span class="ot">TRUE</span>,</span>
<span id="cb108-26"><a href="statistics.html#cb108-26"></a>       <span class="dt">is.summary=</span><span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">TRUE</span>,<span class="kw">rep</span>(<span class="ot">FALSE</span>,<span class="dv">8</span>),<span class="ot">TRUE</span>),</span>
<span id="cb108-27"><a href="statistics.html#cb108-27"></a>       <span class="dt">clip=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">2.5</span>), </span>
<span id="cb108-28"><a href="statistics.html#cb108-28"></a>       <span class="dt">xlog=</span><span class="ot">TRUE</span>, </span>
<span id="cb108-29"><a href="statistics.html#cb108-29"></a>       <span class="dt">col=</span><span class="kw">fpColors</span>(<span class="dt">box=</span><span class="st">&quot;royalblue&quot;</span>,<span class="dt">line=</span><span class="st">&quot;darkblue&quot;</span>, <span class="dt">summary=</span><span class="st">&quot;royalblue&quot;</span>))</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-17-5-1.png" width="672" /></p>
<p>Baujat plot is another method in addition to funnel plot explore heterogeneity</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="statistics.html#cb109-1"></a><span class="co"># adjust margins so the space is better used</span></span>
<span id="cb109-2"><a href="statistics.html#cb109-2"></a></span>
<span id="cb109-3"><a href="statistics.html#cb109-3"></a><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb109-4"><a href="statistics.html#cb109-4"></a><span class="co"># create Baujat plot to explore source of heterogeneity</span></span>
<span id="cb109-5"><a href="statistics.html#cb109-5"></a><span class="kw">baujat</span>(res.DL, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">20</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.2</span>))</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-17-6-1.png" width="672" /></p>
<p>GOSH plot explores study heterogeneity using output of fixed effect model for
all possible subsets</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="statistics.html#cb110-1"></a><span class="co">## fit FE model to all possible subsets</span></span>
<span id="cb110-2"><a href="statistics.html#cb110-2"></a><span class="co"># uses output from DL analysis</span></span>
<span id="cb110-3"><a href="statistics.html#cb110-3"></a></span>
<span id="cb110-4"><a href="statistics.html#cb110-4"></a>sav &lt;-<span class="st"> </span><span class="kw">gosh</span>(res.DL)</span></code></pre></div>
<pre><code>## Fitting 1023 models (based on all possible subsets).</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="statistics.html#cb112-1"></a><span class="co">### create GOSH plot</span></span>
<span id="cb112-2"><a href="statistics.html#cb112-2"></a><span class="co">### red points for subsets that include and blue points</span></span>
<span id="cb112-3"><a href="statistics.html#cb112-3"></a><span class="co">### for subsets that exclude study 16 (the ISIS-4 trial)</span></span>
<span id="cb112-4"><a href="statistics.html#cb112-4"></a></span>
<span id="cb112-5"><a href="statistics.html#cb112-5"></a><span class="kw">plot</span>(sav, <span class="dt">out=</span><span class="kw">dim</span>(rct)[<span class="dv">1</span>], <span class="dt">breaks=</span><span class="dv">100</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-17-7-1.png" width="672" /></p>
</div>
<div id="metaregression" class="section level3">
<h3><span class="header-section-number">4.6.7</span> Metaregression</h3>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="statistics.html#cb113-1"></a><span class="co">#separate metaregression for tsens and tfpr</span></span>
<span id="cb113-2"><a href="statistics.html#cb113-2"></a></span>
<span id="cb113-3"><a href="statistics.html#cb113-3"></a><span class="co">#tsens - setting single or multicentre for spot sign metaanalysis</span></span>
<span id="cb113-4"><a href="statistics.html#cb113-4"></a>dat1&lt;-<span class="kw">subset</span>(Dat, Dat<span class="op">$</span>result_id<span class="op">==</span><span class="dv">1</span> )</span>
<span id="cb113-5"><a href="statistics.html#cb113-5"></a>(metass&lt;-<span class="kw">reitsma</span>(dat1, <span class="dt">formula =</span> <span class="kw">cbind</span>(tsens,tfpr)<span class="op">~</span>PubYear<span class="op">+</span>Study.type<span class="op">+</span>Setting<span class="op">+</span>Quality.assessment)) </span></code></pre></div>
<pre><code>## Call:  reitsma.default(data = dat1, formula = cbind(tsens, tfpr) ~ PubYear + 
##     Study.type + Setting + Quality.assessment)
## 
## Fixed-effects coefficients:
##                        tsens       tfpr
## (Intercept)         298.7349  -164.8604
## PubYear              -0.1484     0.0828
## Study.typeRetro       0.3554    -0.1489
## SettingSingle         0.2283    -0.1301
## Quality.assessment   -0.0040    -0.0834
## 
## 26 studies, 10 fixed and 3 random-effects parameters
##   logLik       AIC       BIC  
##  48.5386  -71.0771  -45.7109</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="statistics.html#cb115-1"></a><span class="kw">summary</span>(metass)</span></code></pre></div>
<pre><code>## Call:  reitsma.default(data = dat1, formula = cbind(tsens, tfpr) ~ PubYear + 
##     Study.type + Setting + Quality.assessment)
## 
## Bivariate diagnostic random-effects meta-regression
## Estimation method: REML
## 
## Fixed-effects coefficients
##                          Estimate Std. Error      z Pr(&gt;|z|) 95%ci.lb 95%ci.ub
## tsens.(Intercept)         298.735    143.547  2.081    0.037   17.388  580.082
## tsens.PubYear              -0.148      0.071 -2.078    0.038   -0.288   -0.008
## tsens.Study.typeRetro       0.355      0.310  1.146    0.252   -0.253    0.963
## tsens.SettingSingle         0.228      0.495  0.462    0.644   -0.741    1.198
## tsens.Quality.assessment   -0.004      0.050 -0.081    0.936   -0.102    0.094
## tfpr.(Intercept)         -164.860     80.574 -2.046    0.041 -322.783   -6.938
## tfpr.PubYear                0.083      0.040  2.066    0.039    0.004    0.161
## tfpr.Study.typeRetro       -0.149      0.172 -0.865    0.387   -0.486    0.188
## tfpr.SettingSingle         -0.130      0.276 -0.471    0.638   -0.672    0.412
## tfpr.Quality.assessment    -0.083      0.026 -3.190    0.001   -0.135   -0.032
##                            
## tsens.(Intercept)         *
## tsens.PubYear             *
## tsens.Study.typeRetro      
## tsens.SettingSingle        
## tsens.Quality.assessment   
## tfpr.(Intercept)          *
## tfpr.PubYear              *
## tfpr.Study.typeRetro       
## tfpr.SettingSingle         
## tfpr.Quality.assessment  **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 
## 
## Variance components: between-studies Std. Dev and correlation matrix
##       Std. Dev tsens  tfpr
## tsens    0.657 1.000     .
## tfpr     0.297 0.312 1.000
## 
##  logLik     AIC     BIC 
##  48.539 -71.077 -45.711</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="statistics.html#cb117-1"></a><span class="co">#tfpr - setting single or multicentre for spot sign metaanalysis</span></span>
<span id="cb117-2"><a href="statistics.html#cb117-2"></a>dat1&lt;-<span class="kw">subset</span>(Dat, Dat<span class="op">$</span>result_id<span class="op">==</span><span class="dv">1</span> )</span>
<span id="cb117-3"><a href="statistics.html#cb117-3"></a>(metassfull&lt;-<span class="kw">reitsma</span>(dat1, <span class="dt">formula =</span> <span class="kw">cbind</span>(tsens,tfpr)<span class="op">~</span></span>
<span id="cb117-4"><a href="statistics.html#cb117-4"></a><span class="st">        </span>PubYear<span class="op">+</span>clinical<span class="op">+</span>Study.type<span class="op">+</span>CTA6hrs<span class="op">+</span>Setting<span class="op">+</span>Quality.assessment)) </span></code></pre></div>
<pre><code>## Call:  reitsma.default(data = dat1, formula = cbind(tsens, tfpr) ~ PubYear + 
##     clinical + Study.type + CTA6hrs + Setting + Quality.assessment)
## 
## Fixed-effects coefficients:
##                        tsens       tfpr
## (Intercept)         297.5416  -144.2754
## PubYear              -0.1480     0.0724
## clinical             -0.4703    -0.1810
## Study.typeRetro       0.4884    -0.0989
## CTA6hrsyes           -0.2141    -0.2342
## SettingSingle         0.2568    -0.1435
## Quality.assessment    0.0130    -0.0738
## 
## 26 studies, 14 fixed and 3 random-effects parameters
##   logLik       AIC       BIC  
##  48.4477  -62.8955  -29.7243</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="statistics.html#cb119-1"></a><span class="kw">summary</span>(metassfull)</span></code></pre></div>
<pre><code>## Call:  reitsma.default(data = dat1, formula = cbind(tsens, tfpr) ~ PubYear + 
##     clinical + Study.type + CTA6hrs + Setting + Quality.assessment)
## 
## Bivariate diagnostic random-effects meta-regression
## Estimation method: REML
## 
## Fixed-effects coefficients
##                          Estimate Std. Error      z Pr(&gt;|z|) 95%ci.lb 95%ci.ub
## tsens.(Intercept)         297.542    150.543  1.976    0.048    2.482  592.601
## tsens.PubYear              -0.148      0.075 -1.977    0.048   -0.295   -0.001
## tsens.clinical             -0.470      0.333 -1.411    0.158   -1.124    0.183
## tsens.Study.typeRetro       0.488      0.321  1.523    0.128   -0.140    1.117
## tsens.CTA6hrsyes           -0.214      0.322 -0.665    0.506   -0.845    0.417
## tsens.SettingSingle         0.257      0.495  0.519    0.604   -0.714    1.228
## tsens.Quality.assessment    0.013      0.051  0.255    0.799   -0.087    0.113
## tfpr.(Intercept)         -144.275     82.720 -1.744    0.081 -306.403   17.852
## tfpr.PubYear                0.072      0.041  1.761    0.078   -0.008    0.153
## tfpr.clinical              -0.181      0.187 -0.969    0.333   -0.547    0.185
## tfpr.Study.typeRetro       -0.099      0.177 -0.558    0.577   -0.446    0.249
## tfpr.CTA6hrsyes            -0.234      0.177 -1.322    0.186   -0.581    0.113
## tfpr.SettingSingle         -0.144      0.274 -0.524    0.600   -0.680    0.393
## tfpr.Quality.assessment    -0.074      0.027 -2.774    0.006   -0.126   -0.022
##                            
## tsens.(Intercept)         *
## tsens.PubYear             *
## tsens.clinical             
## tsens.Study.typeRetro      
## tsens.CTA6hrsyes           
## tsens.SettingSingle        
## tsens.Quality.assessment   
## tfpr.(Intercept)          .
## tfpr.PubYear              .
## tfpr.clinical              
## tfpr.Study.typeRetro       
## tfpr.CTA6hrsyes            
## tfpr.SettingSingle         
## tfpr.Quality.assessment  **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 
## 
## Variance components: between-studies Std. Dev and correlation matrix
##       Std. Dev tsens  tfpr
## tsens    0.650 1.000     .
## tfpr     0.285 0.188 1.000
## 
##  logLik     AIC     BIC 
##  48.448 -62.895 -29.724</code></pre>
<p>Plot year against tsens from metaregression</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="statistics.html#cb121-1"></a><span class="co">#using output from spot sign</span></span>
<span id="cb121-2"><a href="statistics.html#cb121-2"></a></span>
<span id="cb121-3"><a href="statistics.html#cb121-3"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb121-4"><a href="statistics.html#cb121-4"></a><span class="kw">library</span>(lubridate)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;lubridate&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:data.table&#39;:
## 
##     hour, isoweek, mday, minute, month, quarter, second, wday, week,
##     yday, year</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     date, intersect, setdiff, union</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="statistics.html#cb125-1"></a>ssr&lt;-<span class="kw">as.data.frame</span>(ss<span class="op">$</span>residuals)</span>
<span id="cb125-2"><a href="statistics.html#cb125-2"></a><span class="co">#convert character to year</span></span>
<span id="cb125-3"><a href="statistics.html#cb125-3"></a>ssr<span class="op">$</span>Year&lt;-<span class="kw">as.Date</span>(<span class="kw">as.character</span>(Dat<span class="op">$</span>PubYear),<span class="st">&quot;%Y&quot;</span>)</span>
<span id="cb125-4"><a href="statistics.html#cb125-4"></a>ssr<span class="op">$</span>Quality&lt;-Dat<span class="op">$</span>Quality.assessment</span>
<span id="cb125-5"><a href="statistics.html#cb125-5"></a><span class="kw">ggplot</span>(ssr, <span class="kw">aes</span>(<span class="dt">x=</span>ssr<span class="op">$</span>Year,<span class="dt">y=</span>ssr<span class="op">$</span>tsens))<span class="op">+</span><span class="kw">geom_point</span>()<span class="op">+</span></span>
<span id="cb125-6"><a href="statistics.html#cb125-6"></a><span class="st">  </span><span class="kw">scale_x_date</span>()<span class="op">+</span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>)<span class="op">+</span></span>
<span id="cb125-7"><a href="statistics.html#cb125-7"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Relationship between transformed sensitivity and Publication Year&quot;</span>)<span class="op">+</span></span>
<span id="cb125-8"><a href="statistics.html#cb125-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Year&quot;</span>,<span class="dt">y=</span><span class="st">&quot;transformed sensitivity&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/03-Statistics-17-9-1.png" width="672" /></p>
<div id="summary-positive-and-negative-likelihood-ratio" class="section level4">
<h4><span class="header-section-number">4.6.7.1</span> summary Positive and Negative Likelihood Ratio</h4>
<p>Positive likelihood ratio (PLR) is the ratio of sensitivity to false positive
rate (FPR); the negative (NLR) likelihood ratio is the ratio of 1-sensitivity
to specificity. A PLR indicates the likelihood that a positive spot sign (test) would be expected in a patient with target disorder compared with the
likelihood that the same result would be expected in a patient without target disorder. Using the recommendation by Jaeschke et al<span class="citation">(Jaeschke, Guyatt, and Sackett <a href="#ref-pmid8309035" role="doc-biblioref">1994</a>)</span> a
high PLR (&gt;5) and low NLR (&lt;0.2) indicate that the test results would make moderate changes in the likelihood of hematoma growth from baseline risk.
PLRs of &gt;10 and NLRs of &lt;0.1 would confer very large changes from baseline risk. The pooled likelihood ratios were used to calculate post-test odds according to Bayes Theorem and post-test probabilities of outcome after a positive test
result for a range of possible values of baseline risk.</p>
<p>Data from likelihood ratio can be used to create Fagans normogram.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="statistics.html#cb127-1"></a><span class="co">#The code for this is available at</span></span>
<span id="cb127-2"><a href="statistics.html#cb127-2"></a><span class="co">#&quot;https://raw.githubusercontent.com/achekroud/nomogrammer/master/nomogrammer.r&quot;</span></span>
<span id="cb127-3"><a href="statistics.html#cb127-3"></a><span class="kw">library</span>(nomogrammer)</span>
<span id="cb127-4"><a href="statistics.html#cb127-4"></a>p&lt;-<span class="kw">nomogrammer</span>(<span class="dt">Prevalence =</span> <span class="fl">.234</span>, <span class="dt">Plr =</span> <span class="fl">4.85</span>, <span class="dt">Nlr =</span> <span class="fl">0.49</span>)</span>
<span id="cb127-5"><a href="statistics.html#cb127-5"></a>p<span class="op">+</span><span class="kw">ggtitle</span>(<span class="st">&quot;Fagan&#39;s normogram for Spot Sign and ICH growth&quot;</span>)</span>
<span id="cb127-6"><a href="statistics.html#cb127-6"></a><span class="co">#ggsave(p,file=&quot;Fagan_SpotSign.png&quot;,width=5.99,height=3.99,units=&quot;in&quot;)</span></span></code></pre></div>
</div>
</div>
</div>
<div id="data-simulation" class="section level2">
<h2><span class="header-section-number">4.7</span> Data simulation</h2>
<p>Data simulation is an important aspects of data science. The example below is taken from our experience trying to simulate data from recent clot retrieval trials in stroke <span class="citation">(Berkhemer et al. <a href="#ref-pmid25517348" role="doc-biblioref">2015</a>)</span> <span class="citation">(Campbell et al. <a href="#ref-pmid25671797" role="doc-biblioref">2015</a>)</span>. Simulation is performed using <em>simstudy</em> library.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="statistics.html#cb128-1"></a><span class="kw">library</span> (simstudy)</span>
<span id="cb128-2"><a href="statistics.html#cb128-2"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb128-3"><a href="statistics.html#cb128-3"></a></span>
<span id="cb128-4"><a href="statistics.html#cb128-4"></a><span class="co">#T is Trial</span></span>
<span id="cb128-5"><a href="statistics.html#cb128-5"></a>def &lt;-<span class="st"> </span><span class="kw">defData</span>(<span class="dt">varname =</span> <span class="st">&quot;T&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;binary&quot;</span>, <span class="dt">formula =</span> <span class="fl">0.5</span>)</span>
<span id="cb128-6"><a href="statistics.html#cb128-6"></a></span>
<span id="cb128-7"><a href="statistics.html#cb128-7"></a><span class="co">#early neurological improvement (ENI) .37 in TPA and .8 in ECR</span></span>
<span id="cb128-8"><a href="statistics.html#cb128-8"></a><span class="co">#baseline NIHSS 13 in TPA and 17 in ECR</span></span>
<span id="cb128-9"><a href="statistics.html#cb128-9"></a></span>
<span id="cb128-10"><a href="statistics.html#cb128-10"></a>def &lt;-<span class="st"> </span><span class="kw">defData</span>(def, <span class="dt">varname =</span> <span class="st">&quot;ENI&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="dt">formula =</span> <span class="fl">.8-.53</span><span class="op">*</span>T, <span class="dt">variance =</span> <span class="fl">.1</span>)</span>
<span id="cb128-11"><a href="statistics.html#cb128-11"></a></span>
<span id="cb128-12"><a href="statistics.html#cb128-12"></a><span class="co">#baseline NIHSS 13 in TPA and 17 in ECR</span></span>
<span id="cb128-13"><a href="statistics.html#cb128-13"></a>def &lt;-<span class="st"> </span><span class="kw">defData</span>(def, <span class="dt">varname =</span> <span class="st">&quot;Y1&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="dt">formula=</span><span class="dv">13</span>, <span class="dt">variance =</span> <span class="dv">1</span>)</span>
<span id="cb128-14"><a href="statistics.html#cb128-14"></a></span>
<span id="cb128-15"><a href="statistics.html#cb128-15"></a>def &lt;-<span class="st"> </span><span class="kw">defData</span>(def, <span class="dt">varname =</span> <span class="st">&quot;Y2&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;Y1*ENI - 5 * T &gt;5&quot;</span>,<span class="dt">variance =</span> <span class="dv">1</span>)</span>
<span id="cb128-16"><a href="statistics.html#cb128-16"></a></span>
<span id="cb128-17"><a href="statistics.html#cb128-17"></a>def &lt;-<span class="st"> </span><span class="kw">defData</span>(def, <span class="dt">varname =</span> <span class="st">&quot;Y3&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;Y2- 4*T&gt;2&quot;</span>,<span class="dt">variance =</span> <span class="dv">1</span>)</span>
<span id="cb128-18"><a href="statistics.html#cb128-18"></a></span>
<span id="cb128-19"><a href="statistics.html#cb128-19"></a>def &lt;-<span class="st"> </span><span class="kw">defData</span>(def, <span class="dt">varname =</span> <span class="st">&quot;Y4&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;Y3- 2*T&gt;0&quot;</span>, <span class="dt">variance =</span> <span class="dv">1</span>)</span>
<span id="cb128-20"><a href="statistics.html#cb128-20"></a></span>
<span id="cb128-21"><a href="statistics.html#cb128-21"></a><span class="co">#male</span></span>
<span id="cb128-22"><a href="statistics.html#cb128-22"></a>def &lt;-<span class="st"> </span><span class="kw">defData</span>(def,<span class="dt">varname =</span> <span class="st">&quot;Male&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;binary&quot;</span>, <span class="dt">formula =</span> <span class="fl">0.49</span><span class="op">*</span>T)</span>
<span id="cb128-23"><a href="statistics.html#cb128-23"></a></span>
<span id="cb128-24"><a href="statistics.html#cb128-24"></a><span class="co">#diabetes .23 in TPA and .06 in ECR</span></span>
<span id="cb128-25"><a href="statistics.html#cb128-25"></a>def &lt;-<span class="st"> </span><span class="kw">defData</span>(def,<span class="dt">varname =</span> <span class="st">&quot;Diabetes&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;binary&quot;</span>, <span class="dt">formula =</span> <span class="fl">.23-.17</span><span class="op">*</span>T)</span>
<span id="cb128-26"><a href="statistics.html#cb128-26"></a></span>
<span id="cb128-27"><a href="statistics.html#cb128-27"></a><span class="co">#HT .66 TPA vs .6 ECR</span></span>
<span id="cb128-28"><a href="statistics.html#cb128-28"></a>def &lt;-<span class="st"> </span><span class="kw">defData</span>(def,<span class="dt">varname =</span> <span class="st">&quot;HT&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;binary&quot;</span>, <span class="dt">formula =</span> <span class="fl">.66-.06</span><span class="op">*</span>T)</span>
<span id="cb128-29"><a href="statistics.html#cb128-29"></a></span>
<span id="cb128-30"><a href="statistics.html#cb128-30"></a><span class="co">#generate data frame</span></span>
<span id="cb128-31"><a href="statistics.html#cb128-31"></a>dtTrial &lt;-<span class="st"> </span><span class="kw">genData</span>(<span class="dv">500</span>, def)</span>
<span id="cb128-32"><a href="statistics.html#cb128-32"></a></span>
<span id="cb128-33"><a href="statistics.html#cb128-33"></a><span class="co">#define parameter for mRS</span></span>
<span id="cb128-34"><a href="statistics.html#cb128-34"></a></span>
<span id="cb128-35"><a href="statistics.html#cb128-35"></a></span>
<span id="cb128-36"><a href="statistics.html#cb128-36"></a><span class="co">#Add conditional column with field name &quot;mRS&quot;</span></span>
<span id="cb128-37"><a href="statistics.html#cb128-37"></a></span>
<span id="cb128-38"><a href="statistics.html#cb128-38"></a></span>
<span id="cb128-39"><a href="statistics.html#cb128-39"></a></span>
<span id="cb128-40"><a href="statistics.html#cb128-40"></a>dtTime &lt;-<span class="st"> </span><span class="kw">addPeriods</span>(dtTrial, <span class="dt">nPeriods =</span> <span class="dv">4</span>, <span class="dt">idvars =</span> <span class="st">&quot;id&quot;</span>, </span>
<span id="cb128-41"><a href="statistics.html#cb128-41"></a>            <span class="dt">timevars =</span> <span class="kw">c</span>(<span class="st">&quot;Y1&quot;</span>, <span class="st">&quot;Y2&quot;</span>, <span class="st">&quot;Y3&quot;</span>,<span class="st">&quot;Y4&quot;</span>), <span class="dt">timevarName =</span> <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb128-42"><a href="statistics.html#cb128-42"></a>dtTime</span></code></pre></div>
<pre><code>##        id period T       ENI Male Diabetes HT           Y timeID
##    1:   1      0 1 0.6017526    0        0  1 14.31091839      1
##    2:   1      1 1 0.6017526    0        0  1  0.08152786      2
##    3:   1      2 1 0.6017526    0        0  1 -1.27018699      3
##    4:   1      3 1 0.6017526    0        0  1 -0.55572373      4
##    5:   2      0 1 0.5118815    0        0  1 11.87925263      5
##   ---                                                           
## 1996: 499      3 1 0.2823072    0        0  1 -1.19467728   1996
## 1997: 500      0 1 0.7297245    0        0  1 11.49851782   1997
## 1998: 500      1 1 0.7297245    0        0  1 -0.03751836   1998
## 1999: 500      2 1 0.7297245    0        0  1  0.81286696   1999
## 2000: 500      3 1 0.7297245    0        0  1  1.29598022   2000</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="statistics.html#cb130-1"></a><span class="co">#check  that 2 groups are similar at start but not at finish</span></span>
<span id="cb130-2"><a href="statistics.html#cb130-2"></a><span class="kw">t.test</span>(Y1<span class="op">~</span>T,<span class="dt">data=</span>dtTrial)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Y1 by T
## t = -2.1652, df = 495.12, p-value = 0.03085
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.37274078 -0.01808835
## sample estimates:
## mean in group 0 mean in group 1 
##        12.86309        13.05850</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="statistics.html#cb132-1"></a><span class="kw">t.test</span>(Y4<span class="op">~</span>T,<span class="dt">data=</span>dtTrial)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Y4 by T
## t = 5.1116, df = 489.5, p-value = 4.59e-07
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  0.2929921 0.6588770
## sample estimates:
## mean in group 0 mean in group 1 
##      0.41510471     -0.06082983</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="statistics.html#cb134-1"></a><span class="kw">t.test</span>(Male<span class="op">~</span>T,<span class="dt">data=</span>dtTrial)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Male by T
## t = -1.2975, df = 495.25, p-value = 0.195
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.14585658  0.02983094
## sample estimates:
## mean in group 0 mean in group 1 
##       0.4458333       0.5038462</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="statistics.html#cb136-1"></a><span class="co">#putting the 4 time periods together - long format</span></span>
<span id="cb136-2"><a href="statistics.html#cb136-2"></a>dtTime &lt;-<span class="st"> </span><span class="kw">addPeriods</span>(dtTrial, <span class="dt">nPeriods =</span> <span class="dv">3</span>, <span class="dt">idvars =</span> <span class="st">&quot;id&quot;</span>, <span class="dt">timevars =</span> <span class="kw">c</span>(<span class="st">&quot;Y1&quot;</span>, <span class="st">&quot;Y2&quot;</span>, <span class="st">&quot;Y3&quot;</span>,<span class="st">&quot;Y4&quot;</span>), <span class="dt">timevarName =</span> <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb136-3"><a href="statistics.html#cb136-3"></a></span>
<span id="cb136-4"><a href="statistics.html#cb136-4"></a><span class="co">#summarise data using group_by</span></span>
<span id="cb136-5"><a href="statistics.html#cb136-5"></a>dtTime2&lt;-dtTime <span class="op">%&gt;%</span></span>
<span id="cb136-6"><a href="statistics.html#cb136-6"></a><span class="st">  </span><span class="kw">group_by</span>(period, T) <span class="op">%&gt;%</span></span>
<span id="cb136-7"><a href="statistics.html#cb136-7"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">meanY=</span><span class="kw">mean</span>(Y),</span>
<span id="cb136-8"><a href="statistics.html#cb136-8"></a>            <span class="dt">sdY=</span><span class="kw">sd</span>(Y),</span>
<span id="cb136-9"><a href="statistics.html#cb136-9"></a>            <span class="dt">upperY=</span>meanY<span class="op">+</span>sdY,</span>
<span id="cb136-10"><a href="statistics.html#cb136-10"></a>            <span class="dt">lowerY=</span>meanY<span class="op">-</span>sdY)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;period&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="statistics.html#cb138-1"></a><span class="co">#write.csv(dtTime, file=&quot;./Data-Use/dtTime_simulated.csv&quot;)</span></span>
<span id="cb138-2"><a href="statistics.html#cb138-2"></a><span class="co">#write.csv(dtTrial,          file=&quot;./Data-Use/dtTrial_simulated.csv&quot;)</span></span></code></pre></div>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-doi:10.1080/00031305.1998.10480550">
<p>Agresti, Alan, and Brent A. Coull. 1998. Approximate Is Better Than Exact for Interval Estimation of Binomial Proportions. <em>The American Statistician</em> 52 (2): 11926. <a href="https://doi.org/10.1080/00031305.1998.10480550">https://doi.org/10.1080/00031305.1998.10480550</a>.</p>
</div>
<div id="ref-pmid25517348">
<p>Berkhemer, O. A., P. S. Fransen, D. Beumer, L. A. van den Berg, H. F. Lingsma, A. J. Yoo, W. J. Schonewille, et al. 2015. A randomized trial of intraarterial treatment for acute ischemic stroke. <em>N. Engl. J. Med.</em> 372 (1): 1120.</p>
</div>
<div id="ref-brown2001">
<p>Brown, Lawrence D., T. Tony Cai, and Anirban DasGupta. 2001. Interval Estimation for a Binomial Proportion. <em>Statist. Sci.</em> 16 (2): 10133. <a href="https://doi.org/10.1214/ss/1009213286">https://doi.org/10.1214/ss/1009213286</a>.</p>
</div>
<div id="ref-pmid25671797">
<p>Campbell, B. C., P. J. Mitchell, T. J. Kleinig, H. M. Dewey, L. Churilov, N. Yassi, B. Yan, et al. 2015. Endovascular therapy for ischemic stroke with perfusion-imaging selection. <em>N. Engl. J. Med.</em> 372 (11): 100918.</p>
</div>
<div id="ref-COHEN1977179">
<p>Cohen, Jacob. 1977. CHAPTER 6 - Differences Between Proportions. In <em>Statistical Power Analysis for the Behavioral Sciences</em>, edited by Jacob Cohen, 179213. Academic Press. <a href="https://doi.org/https://doi.org/10.1016/B978-0-12-179060-8.50011-6">https://doi.org/https://doi.org/10.1016/B978-0-12-179060-8.50011-6</a>.</p>
</div>
<div id="ref-pmid1738016">
<p>Diamond, G. A. 1992. What price perfection? Calibration and discrimination of clinical prediction models. <em>J Clin Epidemiol</em> 45 (1): 8589.</p>
</div>
<div id="ref-pmid25781447">
<p>Gopal, A. D., N. R. Desai, T. Tse, and J. S. Ross. 2015. Reporting of noninferiority trials in ClinicalTrials.gov and corresponding publications. <em>JAMA</em> 313 (11): 11635.</p>
</div>
<div id="ref-10.1093/biomet/81.3.515">
<p>Grambsch, P. M., and T. M. Therneau. 1994. Proportional hazards tests and diagnostics based on weighted residuals. <em>Biometrika</em> 81 (3): 51526. <a href="https://doi.org/10.1093/biomet/81.3.515">https://doi.org/10.1093/biomet/81.3.515</a>.</p>
</div>
<div id="ref-pmid8309035">
<p>Jaeschke, R., G. H. Guyatt, and D. L. Sackett. 1994. Users guides to the medical literature. III. How to use an article about a diagnostic test. B. What are the results and will they help me in caring for my patients? The Evidence-Based Medicine Working Group. <em>JAMA</em> 271 (9): 7037.</p>
</div>
<div id="ref-pmid26080342">
<p>Kaji, A. H., and R. J. Lewis. 2015. Noninferiority Trials: Is a New Treatment Almost as Effective as Another? <em>JAMA</em> 313 (23): 23712.</p>
</div>
<div id="ref-pmid32404155">
<p>Ludwig, L., P. Darmon, and B Guerci. 2020. Computing and interpreting the Number Needed to Treat for Cardiovascular Outcomes Trials:Perspective on GLP-1 RA and SGLT-2i therapies. <em>Cardiovasc Diabetol</em>, May. <a href="https://doi.org/10.1186/s12933-020-01034-3">https://doi.org/10.1186/s12933-020-01034-3</a>.</p>
</div>
<div id="ref-pmid12614141">
<p>Marx, Arthur, and Heiner C Bucher. 2003. Numbers Needed to Treat Derived from Meta-Analysis: A Word of Caution. <em>BMJ Evidence-Based Medicine</em> 8 (2): 3637. <a href="https://doi.org/10.1136/ebm.8.2.36">https://doi.org/10.1136/ebm.8.2.36</a>.</p>
</div>
<div id="ref-pmid8210827">
<p>Moses, L. E., D. Shapiro, and B. Littenberg. 1993. Combining independent studies of a diagnostic test into a summary ROC curve: data-analytic approaches and some additional considerations. <em>Stat Med</em> 12 (14): 12931316.</p>
</div>
<div id="ref-pmid28579970">
<p>Phan, T. G., B. B. Clissold, H. Ma, J. V. Ly, and V. Srikanth. 2017. Predicting Disability after Ischemic Stroke Based on Comorbidity Index and Stroke Severity-From the Virtual International Stroke Trials Archive-Acute Collaboration. <em>Front Neurol</em> 8: 192.</p>
</div>
<div id="ref-pmid26796056">
<p>Phan, T. G., B. Clissold, J. Ly, H. Ma, C. Moran, V. Srikanth, K. R. Lees, et al. 2016. Stroke Severity and Comorbidity Index for Prediction of Mortality after Ischemic Stroke from the Virtual International Stroke Trials Archive-Acute Collaboration. <em>J Stroke Cerebrovasc Dis</em> 25 (4): 83542.</p>
</div>
<div id="ref-pmid16931782">
<p>Phan, T. G., G. A. Donnan, S. M. Davis, and G. Byrnes. 2006. Proof-of-principle phase II MRI studies in stroke: sample size estimates from dichotomous and continuous data. <em>Stroke</em> 37 (10): 25215.</p>
</div>
<div id="ref-pmid31272327">
<p>Phan, T. G., N. Krishnadas, V. W. Y. Lai, M. Batt, L. A. Slater, R. V. Chandra, V. Srikanth, and H. Ma. 2019. Meta-Analysis of Accuracy of the Spot Sign for Predicting Hematoma Growth and Clinical Outcomes. <em>Stroke</em> 50 (8): 20306.</p>
</div>
<div id="ref-pmid16168343">
<p>Reitsma, J. B., A. S. Glas, A. W. Rutjes, R. J. Scholten, P. M. Bossuyt, and A. H. Zwinderman. 2005. Bivariate analysis of sensitivity and specificity produces informative summary measures in diagnostic reviews. <em>J Clin Epidemiol</em> 58 (10): 98290.</p>
</div>
<div id="ref-pmid26080338">
<p>Salminen, P., H. Paajanen, T. Rautio, P. Nordstr?m, M. Aarnio, T. Rantanen, R. Tuominen, et al. 2015. Antibiotic Therapy vs Appendectomy for Treatment of Uncomplicated Acute Appendicitis: The APPAC Randomized Clinical Trial. <em>JAMA</em> 313 (23): 23408.</p>
</div>
<div id="ref-10.1001/jamaneurol.2020.0678">
<p>Signori, Alessio, Fabio Pellegrini, Francesca Bovis, Luca Carmisciano, Carl de Moor, and Maria Pia Sormani. 2020. Comparison of Placebos and Propensity Score Adjustment in Multiple Sclerosis Nonrandomized Studies. <em>JAMA Neurology</em>, April. <a href="https://doi.org/10.1001/jamaneurol.2020.0678">https://doi.org/10.1001/jamaneurol.2020.0678</a>.</p>
</div>
<div id="ref-pmid10356018">
<p>Smeeth, A. Ebrahim, L. Haines. 1999. Numbers needed to treat derived from meta-analysessometimes informative, usually misleading. <em>BMJ</em> 318: 154851. <a href="https://doi.org/10.1136/bmj.318.7197.1548">https://doi.org/10.1136/bmj.318.7197.1548</a>.</p>
</div>
<div id="ref-pmid32167523">
<p>Stensrud, M. J., and M. A. Hernan. 2020. Why Test for Proportional Hazards? <em>JAMA</em>, March.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-wrangling.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multivariate-analysis-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/03-Statistics.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Applications-of-R-in-Healthcare.pdf", "Applications-of-R-in-Healthcare.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
