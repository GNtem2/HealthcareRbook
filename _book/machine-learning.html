<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Machine learning | Applications of R in Healthcare</title>
  <meta name="description" content="This is a book describing the use of R in Healthcare. It is aimed at beginners of R language. The majority of the examples are taken from works in Neurology. Where possible data from other disease such as heart disease, cancer and vaccine are used. The ideas and principles can be applied to other aspects of Healthcare. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Machine learning | Applications of R in Healthcare" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a book describing the use of R in Healthcare. It is aimed at beginners of R language. The majority of the examples are taken from works in Neurology. Where possible data from other disease such as heart disease, cancer and vaccine are used. The ideas and principles can be applied to other aspects of Healthcare. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="GNtem2/HealthcareRbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Machine learning | Applications of R in Healthcare" />
  
  <meta name="twitter:description" content="This is a book describing the use of R in Healthcare. It is aimed at beginners of R language. The majority of the examples are taken from works in Neurology. Where possible data from other disease such as heart disease, cancer and vaccine are used. The ideas and principles can be applied to other aspects of Healthcare. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Thanh Phan" />


<meta name="date" content="2024-02-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multivariate-analysis.html"/>
<link rel="next" href="machine-learning-part-2.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.10/grViz.js"></script>
<script src="libs/plotly-binding-4.10.2/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applications-of-R-in-Healthcare</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preamble</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#plot-using-base-r"><i class="fa fa-check"></i><b>2.1</b> Plot using base R</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#ggplot2"><i class="fa fa-check"></i><b>2.2</b> ggplot2</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#histogram"><i class="fa fa-check"></i><b>2.2.1</b> Histogram</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#bar-plot"><i class="fa fa-check"></i><b>2.2.2</b> Bar plot</a></li>
<li class="chapter" data-level="2.2.3" data-path="intro.html"><a href="intro.html#pie-chart"><i class="fa fa-check"></i><b>2.2.3</b> Pie chart</a></li>
<li class="chapter" data-level="2.2.4" data-path="intro.html"><a href="intro.html#scatter-plot"><i class="fa fa-check"></i><b>2.2.4</b> Scatter plot</a></li>
<li class="chapter" data-level="2.2.5" data-path="intro.html"><a href="intro.html#arrange-plot-in-grids"><i class="fa fa-check"></i><b>2.2.5</b> arrange plot in grids</a></li>
<li class="chapter" data-level="2.2.6" data-path="intro.html"><a href="intro.html#line-plot"><i class="fa fa-check"></i><b>2.2.6</b> Line plot</a></li>
<li class="chapter" data-level="2.2.7" data-path="intro.html"><a href="intro.html#facet-wrap"><i class="fa fa-check"></i><b>2.2.7</b> Facet wrap</a></li>
<li class="chapter" data-level="2.2.8" data-path="intro.html"><a href="intro.html#polygons"><i class="fa fa-check"></i><b>2.2.8</b> Polygons</a></li>
<li class="chapter" data-level="2.2.9" data-path="intro.html"><a href="intro.html#gantt-chart"><i class="fa fa-check"></i><b>2.2.9</b> Gantt chart</a></li>
<li class="chapter" data-level="2.2.10" data-path="intro.html"><a href="intro.html#heatmap"><i class="fa fa-check"></i><b>2.2.10</b> Heatmap</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#ggplot2-extra"><i class="fa fa-check"></i><b>2.3</b> ggplot2 extra</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#alluvial-and-sankey-diagram"><i class="fa fa-check"></i><b>2.3.1</b> Alluvial and Sankey diagram</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro.html"><a href="intro.html#survival-plot"><i class="fa fa-check"></i><b>2.3.2</b> Survival plot</a></li>
<li class="chapter" data-level="2.3.3" data-path="intro.html"><a href="intro.html#ggraph-and-tidygraph"><i class="fa fa-check"></i><b>2.3.3</b> ggraph and tidygraph</a></li>
<li class="chapter" data-level="2.3.4" data-path="intro.html"><a href="intro.html#ggparty-decision-tree"><i class="fa fa-check"></i><b>2.3.4</b> ggparty-decision tree</a></li>
<li class="chapter" data-level="2.3.5" data-path="intro.html"><a href="intro.html#map"><i class="fa fa-check"></i><b>2.3.5</b> Map</a></li>
<li class="chapter" data-level="2.3.6" data-path="intro.html"><a href="intro.html#ggwordcloud"><i class="fa fa-check"></i><b>2.3.6</b> ggwordcloud</a></li>
<li class="chapter" data-level="2.3.7" data-path="intro.html"><a href="intro.html#gganimate"><i class="fa fa-check"></i><b>2.3.7</b> gganimate</a></li>
<li class="chapter" data-level="2.3.8" data-path="intro.html"><a href="intro.html#ggneuro"><i class="fa fa-check"></i><b>2.3.8</b> ggneuro</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#plotly"><i class="fa fa-check"></i><b>2.4</b> plotly</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="intro.html"><a href="intro.html#scatter-plot-with-plotly"><i class="fa fa-check"></i><b>2.4.1</b> Scatter plot with plotly</a></li>
<li class="chapter" data-level="2.4.2" data-path="intro.html"><a href="intro.html#bar-plot-with-plotly"><i class="fa fa-check"></i><b>2.4.2</b> Bar plot with plotly</a></li>
<li class="chapter" data-level="2.4.3" data-path="intro.html"><a href="intro.html#heatmap-1"><i class="fa fa-check"></i><b>2.4.3</b> Heatmap</a></li>
<li class="chapter" data-level="2.4.4" data-path="intro.html"><a href="intro.html#map-1"><i class="fa fa-check"></i><b>2.4.4</b> map</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>3</b> Data Wrangling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-wrangling.html"><a href="data-wrangling.html#data"><i class="fa fa-check"></i><b>3.1</b> Data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="data-wrangling.html"><a href="data-wrangling.html#vector-arrays-matrix"><i class="fa fa-check"></i><b>3.1.1</b> Vector, Arrays, Matrix</a></li>
<li class="chapter" data-level="3.1.2" data-path="data-wrangling.html"><a href="data-wrangling.html#operators"><i class="fa fa-check"></i><b>3.1.2</b> Operators</a></li>
<li class="chapter" data-level="3.1.3" data-path="data-wrangling.html"><a href="data-wrangling.html#simple-function"><i class="fa fa-check"></i><b>3.1.3</b> Simple function</a></li>
<li class="chapter" data-level="3.1.4" data-path="data-wrangling.html"><a href="data-wrangling.html#for-loop"><i class="fa fa-check"></i><b>3.1.4</b> for loop</a></li>
<li class="chapter" data-level="3.1.5" data-path="data-wrangling.html"><a href="data-wrangling.html#apply-lapply-sapply"><i class="fa fa-check"></i><b>3.1.5</b> apply, lapply, sapply</a></li>
<li class="chapter" data-level="3.1.6" data-path="data-wrangling.html"><a href="data-wrangling.html#functional"><i class="fa fa-check"></i><b>3.1.6</b> Functional</a></li>
<li class="chapter" data-level="3.1.7" data-path="data-wrangling.html"><a href="data-wrangling.html#iteration"><i class="fa fa-check"></i><b>3.1.7</b> Iteration</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-wrangling.html"><a href="data-wrangling.html#data-storage"><i class="fa fa-check"></i><b>3.2</b> Data storage</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-wrangling.html"><a href="data-wrangling.html#data-frame"><i class="fa fa-check"></i><b>3.2.1</b> Data frame</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-wrangling.html"><a href="data-wrangling.html#excel-data"><i class="fa fa-check"></i><b>3.2.2</b> Excel data</a></li>
<li class="chapter" data-level="3.2.3" data-path="data-wrangling.html"><a href="data-wrangling.html#foreign-data"><i class="fa fa-check"></i><b>3.2.3</b> Foreign data</a></li>
<li class="chapter" data-level="3.2.4" data-path="data-wrangling.html"><a href="data-wrangling.html#json-format"><i class="fa fa-check"></i><b>3.2.4</b> json format</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-wrangling.html"><a href="data-wrangling.html#tidy-data"><i class="fa fa-check"></i><b>3.3</b> Tidy data</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-wrangling.html"><a href="data-wrangling.html#factors"><i class="fa fa-check"></i><b>3.3.1</b> Factors</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-wrangling.html"><a href="data-wrangling.html#multiple-files"><i class="fa fa-check"></i><b>3.3.2</b> Multiple files</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-wrangling.html"><a href="data-wrangling.html#tidy-evaluation"><i class="fa fa-check"></i><b>3.3.3</b> Tidy evaluation</a></li>
<li class="chapter" data-level="3.3.4" data-path="data-wrangling.html"><a href="data-wrangling.html#pivot-wide-and-long"><i class="fa fa-check"></i><b>3.3.4</b> Pivot wide and long</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-wrangling.html"><a href="data-wrangling.html#regular-expressions"><i class="fa fa-check"></i><b>3.4</b> Regular Expressions</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="data-wrangling.html"><a href="data-wrangling.html#base-r"><i class="fa fa-check"></i><b>3.4.1</b> base R</a></li>
<li class="chapter" data-level="3.4.2" data-path="data-wrangling.html"><a href="data-wrangling.html#stringr"><i class="fa fa-check"></i><b>3.4.2</b> stringr</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="data-wrangling.html"><a href="data-wrangling.html#pdf-to-xcel"><i class="fa fa-check"></i><b>3.5</b> PDF to xcel</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="data-wrangling.html"><a href="data-wrangling.html#scanned-text-or-picture"><i class="fa fa-check"></i><b>3.5.1</b> Scanned text or picture</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="data-wrangling.html"><a href="data-wrangling.html#web-scraping"><i class="fa fa-check"></i><b>3.6</b> Web scraping</a></li>
<li class="chapter" data-level="3.7" data-path="data-wrangling.html"><a href="data-wrangling.html#medical-images"><i class="fa fa-check"></i><b>3.7</b> Medical Images</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="data-wrangling.html"><a href="data-wrangling.html#dicom-and-nifti-format"><i class="fa fa-check"></i><b>3.7.1</b> DICOM and nifti format</a></li>
<li class="chapter" data-level="3.7.2" data-path="data-wrangling.html"><a href="data-wrangling.html#manipulating-array-of-medical-images"><i class="fa fa-check"></i><b>3.7.2</b> Manipulating array of medical images</a></li>
<li class="chapter" data-level="3.7.3" data-path="data-wrangling.html"><a href="data-wrangling.html#combining-arrays"><i class="fa fa-check"></i><b>3.7.3</b> Combining arrays</a></li>
<li class="chapter" data-level="3.7.4" data-path="data-wrangling.html"><a href="data-wrangling.html#math-operation-on-multidimensional-array"><i class="fa fa-check"></i><b>3.7.4</b> Math operation on multidimensional array</a></li>
<li class="chapter" data-level="3.7.5" data-path="data-wrangling.html"><a href="data-wrangling.html#math-operation-on-list"><i class="fa fa-check"></i><b>3.7.5</b> Math operation on list</a></li>
<li class="chapter" data-level="3.7.6" data-path="data-wrangling.html"><a href="data-wrangling.html#vectorising-nifti-object"><i class="fa fa-check"></i><b>3.7.6</b> Vectorising nifti object</a></li>
<li class="chapter" data-level="3.7.7" data-path="data-wrangling.html"><a href="data-wrangling.html#tar-file"><i class="fa fa-check"></i><b>3.7.7</b> tar file</a></li>
<li class="chapter" data-level="3.7.8" data-path="data-wrangling.html"><a href="data-wrangling.html#image-registration"><i class="fa fa-check"></i><b>3.7.8</b> Image registration</a></li>
<li class="chapter" data-level="3.7.9" data-path="data-wrangling.html"><a href="data-wrangling.html#rescaling"><i class="fa fa-check"></i><b>3.7.9</b> Rescaling</a></li>
<li class="chapter" data-level="3.7.10" data-path="data-wrangling.html"><a href="data-wrangling.html#mni-template"><i class="fa fa-check"></i><b>3.7.10</b> MNI template</a></li>
<li class="chapter" data-level="3.7.11" data-path="data-wrangling.html"><a href="data-wrangling.html#atlases"><i class="fa fa-check"></i><b>3.7.11</b> Atlases</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="data-wrangling.html"><a href="data-wrangling.html#ecg-signal-processing"><i class="fa fa-check"></i><b>3.8</b> ECG Signal processing</a></li>
<li class="chapter" data-level="3.9" data-path="data-wrangling.html"><a href="data-wrangling.html#eeg-signal-processing"><i class="fa fa-check"></i><b>3.9</b> EEG signal processing</a></li>
<li class="chapter" data-level="3.10" data-path="data-wrangling.html"><a href="data-wrangling.html#python"><i class="fa fa-check"></i><b>3.10</b> Python</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="data-wrangling.html"><a href="data-wrangling.html#reticulate"><i class="fa fa-check"></i><b>3.10.1</b> Reticulate</a></li>
<li class="chapter" data-level="3.10.2" data-path="data-wrangling.html"><a href="data-wrangling.html#minconda"><i class="fa fa-check"></i><b>3.10.2</b> Minconda</a></li>
<li class="chapter" data-level="3.10.3" data-path="data-wrangling.html"><a href="data-wrangling.html#python-environment"><i class="fa fa-check"></i><b>3.10.3</b> Python environment</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="data-wrangling.html"><a href="data-wrangling.html#matlab"><i class="fa fa-check"></i><b>3.11</b> Matlab</a></li>
<li class="chapter" data-level="3.12" data-path="data-wrangling.html"><a href="data-wrangling.html#stata"><i class="fa fa-check"></i><b>3.12</b> Stata</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>4</b> Statistics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="statistics.html"><a href="statistics.html#univariable-analyses"><i class="fa fa-check"></i><b>4.1</b> Univariable analyses</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="statistics.html"><a href="statistics.html#parametric-tests"><i class="fa fa-check"></i><b>4.1.1</b> Parametric tests</a></li>
<li class="chapter" data-level="4.1.2" data-path="statistics.html"><a href="statistics.html#non-parametric-tests"><i class="fa fa-check"></i><b>4.1.2</b> Non-parametric tests</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="statistics.html"><a href="statistics.html#regression"><i class="fa fa-check"></i><b>4.2</b> Regression</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="statistics.html"><a href="statistics.html#brief-review-of-matrix"><i class="fa fa-check"></i><b>4.2.1</b> Brief review of matrix</a></li>
<li class="chapter" data-level="4.2.2" data-path="statistics.html"><a href="statistics.html#linear-least-square-regression"><i class="fa fa-check"></i><b>4.2.2</b> Linear (least square) regression</a></li>
<li class="chapter" data-level="4.2.3" data-path="statistics.html"><a href="statistics.html#logistic-regression"><i class="fa fa-check"></i><b>4.2.3</b> Logistic regression</a></li>
<li class="chapter" data-level="4.2.4" data-path="statistics.html"><a href="statistics.html#discrimination-and-calibration"><i class="fa fa-check"></i><b>4.2.4</b> Discrimination and Calibration</a></li>
<li class="chapter" data-level="4.2.5" data-path="statistics.html"><a href="statistics.html#interaction"><i class="fa fa-check"></i><b>4.2.5</b> Interaction</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="statistics.html"><a href="statistics.html#confounder"><i class="fa fa-check"></i><b>4.3</b> Confounder</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="statistics.html"><a href="statistics.html#confounder-weighted-model"><i class="fa fa-check"></i><b>4.3.1</b> Confounder weighted model</a></li>
<li class="chapter" data-level="4.3.2" data-path="statistics.html"><a href="statistics.html#propensity-matching"><i class="fa fa-check"></i><b>4.3.2</b> Propensity matching</a></li>
<li class="chapter" data-level="4.3.3" data-path="statistics.html"><a href="statistics.html#e-values"><i class="fa fa-check"></i><b>4.3.3</b> E-values</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="statistics.html"><a href="statistics.html#causal-inference"><i class="fa fa-check"></i><b>4.4</b> Causal inference</a></li>
<li class="chapter" data-level="4.5" data-path="statistics.html"><a href="statistics.html#special-types-of-regression"><i class="fa fa-check"></i><b>4.5</b> Special types of regression</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="statistics.html"><a href="statistics.html#ordinal-regression"><i class="fa fa-check"></i><b>4.5.1</b> Ordinal regression</a></li>
<li class="chapter" data-level="4.5.2" data-path="statistics.html"><a href="statistics.html#survival-analysis"><i class="fa fa-check"></i><b>4.5.2</b> Survival analysis</a></li>
<li class="chapter" data-level="4.5.3" data-path="statistics.html"><a href="statistics.html#quantile-regression"><i class="fa fa-check"></i><b>4.5.3</b> Quantile regression</a></li>
<li class="chapter" data-level="4.5.4" data-path="statistics.html"><a href="statistics.html#non-negative-regression"><i class="fa fa-check"></i><b>4.5.4</b> Non-negative regression</a></li>
<li class="chapter" data-level="4.5.5" data-path="statistics.html"><a href="statistics.html#poisson-regression"><i class="fa fa-check"></i><b>4.5.5</b> Poisson regression</a></li>
<li class="chapter" data-level="4.5.6" data-path="statistics.html"><a href="statistics.html#conditional-logistic-regression"><i class="fa fa-check"></i><b>4.5.6</b> Conditional logistic regression</a></li>
<li class="chapter" data-level="4.5.7" data-path="statistics.html"><a href="statistics.html#multinomial-modelling"><i class="fa fa-check"></i><b>4.5.7</b> Multinomial modelling</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="statistics.html"><a href="statistics.html#sample-size-estimation"><i class="fa fa-check"></i><b>4.6</b> Sample size estimation</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="statistics.html"><a href="statistics.html#proportion"><i class="fa fa-check"></i><b>4.6.1</b> Proportion</a></li>
<li class="chapter" data-level="4.6.2" data-path="statistics.html"><a href="statistics.html#logistic-regression-1"><i class="fa fa-check"></i><b>4.6.2</b> Logistic regression</a></li>
<li class="chapter" data-level="4.6.3" data-path="statistics.html"><a href="statistics.html#survival-studies"><i class="fa fa-check"></i><b>4.6.3</b> Survival studies</a></li>
<li class="chapter" data-level="4.6.4" data-path="statistics.html"><a href="statistics.html#multiple-regression"><i class="fa fa-check"></i><b>4.6.4</b> Multiple regression</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="statistics.html"><a href="statistics.html#randomised-clinical-trials"><i class="fa fa-check"></i><b>4.7</b> Randomised clinical trials</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="statistics.html"><a href="statistics.html#covariate-adjustment-in-trials"><i class="fa fa-check"></i><b>4.7.1</b> Covariate adjustment in trials</a></li>
<li class="chapter" data-level="4.7.2" data-path="statistics.html"><a href="statistics.html#subgroup-analysis"><i class="fa fa-check"></i><b>4.7.2</b> Subgroup analysis</a></li>
<li class="chapter" data-level="4.7.3" data-path="statistics.html"><a href="statistics.html#p-value-for-interaction"><i class="fa fa-check"></i><b>4.7.3</b> p value for interaction</a></li>
<li class="chapter" data-level="4.7.4" data-path="statistics.html"><a href="statistics.html#interpreting-risk-reduction-in-clinical-trials"><i class="fa fa-check"></i><b>4.7.4</b> Interpreting risk reduction in clinical trials</a></li>
<li class="chapter" data-level="4.7.5" data-path="statistics.html"><a href="statistics.html#nnt-from-arr"><i class="fa fa-check"></i><b>4.7.5</b> NNT from ARR</a></li>
<li class="chapter" data-level="4.7.6" data-path="statistics.html"><a href="statistics.html#nnt-from-odds-ratio"><i class="fa fa-check"></i><b>4.7.6</b> NNT from odds ratio</a></li>
<li class="chapter" data-level="4.7.7" data-path="statistics.html"><a href="statistics.html#nnt-from-risk-ratio"><i class="fa fa-check"></i><b>4.7.7</b> NNT from risk ratio</a></li>
<li class="chapter" data-level="4.7.8" data-path="statistics.html"><a href="statistics.html#nnt-from-hazard-ratio"><i class="fa fa-check"></i><b>4.7.8</b> NNT from hazard ratio</a></li>
<li class="chapter" data-level="4.7.9" data-path="statistics.html"><a href="statistics.html#nnt-from-metaananlysis"><i class="fa fa-check"></i><b>4.7.9</b> NNT from metaananlysis</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="statistics.html"><a href="statistics.html#diagnostic-test"><i class="fa fa-check"></i><b>4.8</b> Diagnostic test</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="statistics.html"><a href="statistics.html#sensitivity-specificity"><i class="fa fa-check"></i><b>4.8.1</b> Sensitivity, specificity</a></li>
<li class="chapter" data-level="4.8.2" data-path="statistics.html"><a href="statistics.html#auc"><i class="fa fa-check"></i><b>4.8.2</b> AUC</a></li>
<li class="chapter" data-level="4.8.3" data-path="statistics.html"><a href="statistics.html#likelihood-ratio"><i class="fa fa-check"></i><b>4.8.3</b> Likelihood ratio</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="statistics.html"><a href="statistics.html#metaanalysis"><i class="fa fa-check"></i><b>4.9</b> Metaanalysis</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="statistics.html"><a href="statistics.html#quality-of-study"><i class="fa fa-check"></i><b>4.9.1</b> Quality of study</a></li>
<li class="chapter" data-level="4.9.2" data-path="statistics.html"><a href="statistics.html#prisma"><i class="fa fa-check"></i><b>4.9.2</b> PRISMA</a></li>
<li class="chapter" data-level="4.9.3" data-path="statistics.html"><a href="statistics.html#conversion-of-median-to-mean"><i class="fa fa-check"></i><b>4.9.3</b> Conversion of median to mean</a></li>
<li class="chapter" data-level="4.9.4" data-path="statistics.html"><a href="statistics.html#inconsistency-i2"><i class="fa fa-check"></i><b>4.9.4</b> Inconsistency I2</a></li>
<li class="chapter" data-level="4.9.5" data-path="statistics.html"><a href="statistics.html#metaanalysis-of-proportion"><i class="fa fa-check"></i><b>4.9.5</b> Metaanalysis of proportion</a></li>
<li class="chapter" data-level="4.9.6" data-path="statistics.html"><a href="statistics.html#metaanalysis-of-continuous-data"><i class="fa fa-check"></i><b>4.9.6</b> Metaanalysis of continuous data</a></li>
<li class="chapter" data-level="4.9.7" data-path="statistics.html"><a href="statistics.html#bivariate-metaanalysis"><i class="fa fa-check"></i><b>4.9.7</b> Bivariate Metaanalysis</a></li>
<li class="chapter" data-level="4.9.8" data-path="statistics.html"><a href="statistics.html#metaanalysis-of-clinical-trial."><i class="fa fa-check"></i><b>4.9.8</b> Metaanalysis of clinical trial.</a></li>
<li class="chapter" data-level="4.9.9" data-path="statistics.html"><a href="statistics.html#metaregression"><i class="fa fa-check"></i><b>4.9.9</b> Metaregression</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="statistics.html"><a href="statistics.html#data-simulation"><i class="fa fa-check"></i><b>4.10</b> Data simulation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html"><i class="fa fa-check"></i><b>5</b> Multivariate Analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#multivariate-regression"><i class="fa fa-check"></i><b>5.1</b> Multivariate regression</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#penalised-regression"><i class="fa fa-check"></i><b>5.1.1</b> Penalised regression</a></li>
<li class="chapter" data-level="5.1.2" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#mars"><i class="fa fa-check"></i><b>5.1.2</b> MARS</a></li>
<li class="chapter" data-level="5.1.3" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#mixed-modelling"><i class="fa fa-check"></i><b>5.1.3</b> Mixed modelling</a></li>
<li class="chapter" data-level="5.1.4" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#trajectory-modelling"><i class="fa fa-check"></i><b>5.1.4</b> Trajectory modelling</a></li>
<li class="chapter" data-level="5.1.5" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#generalized-estimating-equation-gee"><i class="fa fa-check"></i><b>5.1.5</b> Generalized estimating equation (GEE)</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#principal-component-analysis"><i class="fa fa-check"></i><b>5.2</b> Principal component analysis</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#pca-with-mri"><i class="fa fa-check"></i><b>5.2.1</b> PCA with MRI</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#independent-component-analysis"><i class="fa fa-check"></i><b>5.3</b> Independent component analysis</a></li>
<li class="chapter" data-level="5.4" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#partial-least-squares"><i class="fa fa-check"></i><b>5.4</b> Partial least squares</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="machine-learning.html"><a href="machine-learning.html"><i class="fa fa-check"></i><b>6</b> Machine learning</a>
<ul>
<li class="chapter" data-level="6.1" data-path="machine-learning.html"><a href="machine-learning.html#decision-tree-analysis"><i class="fa fa-check"></i><b>6.1</b> Decision tree analysis</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="machine-learning.html"><a href="machine-learning.html#information-theory-driven"><i class="fa fa-check"></i><b>6.1.1</b> Information theory driven</a></li>
<li class="chapter" data-level="6.1.2" data-path="machine-learning.html"><a href="machine-learning.html#conditional-decision-tree"><i class="fa fa-check"></i><b>6.1.2</b> Conditional decision tree</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="machine-learning.html"><a href="machine-learning.html#ensemble-tree-methods"><i class="fa fa-check"></i><b>6.2</b> Ensemble tree methods</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="machine-learning.html"><a href="machine-learning.html#bagging-trees"><i class="fa fa-check"></i><b>6.2.1</b> Bagging trees</a></li>
<li class="chapter" data-level="6.2.2" data-path="machine-learning.html"><a href="machine-learning.html#boosting-trees"><i class="fa fa-check"></i><b>6.2.2</b> Boosting trees</a></li>
<li class="chapter" data-level="6.2.3" data-path="machine-learning.html"><a href="machine-learning.html#bayesian-trees-method"><i class="fa fa-check"></i><b>6.2.3</b> Bayesian trees method</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="machine-learning.html"><a href="machine-learning.html#knn"><i class="fa fa-check"></i><b>6.3</b> KNN</a></li>
<li class="chapter" data-level="6.4" data-path="machine-learning.html"><a href="machine-learning.html#support-vector-machine"><i class="fa fa-check"></i><b>6.4</b> Support vector machine</a></li>
<li class="chapter" data-level="6.5" data-path="machine-learning.html"><a href="machine-learning.html#non-negative-matrix-factorisation"><i class="fa fa-check"></i><b>6.5</b> Non-negative matrix factorisation</a></li>
<li class="chapter" data-level="6.6" data-path="machine-learning.html"><a href="machine-learning.html#formal-concept-analysis"><i class="fa fa-check"></i><b>6.6</b> Formal concept analysis</a></li>
<li class="chapter" data-level="6.7" data-path="machine-learning.html"><a href="machine-learning.html#evolutionary-algorithm"><i class="fa fa-check"></i><b>6.7</b> Evolutionary Algorithm</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="machine-learning.html"><a href="machine-learning.html#simulated-annealing"><i class="fa fa-check"></i><b>6.7.1</b> Simulated Annealing</a></li>
<li class="chapter" data-level="6.7.2" data-path="machine-learning.html"><a href="machine-learning.html#genetic-algorithm"><i class="fa fa-check"></i><b>6.7.2</b> Genetic Algorithm</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="machine-learning.html"><a href="machine-learning.html#manifold-learning"><i class="fa fa-check"></i><b>6.8</b> Manifold learning</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="machine-learning.html"><a href="machine-learning.html#t-stochastic-neighbourhood-embedding"><i class="fa fa-check"></i><b>6.8.1</b> T-Stochastic Neighbourhood Embedding</a></li>
<li class="chapter" data-level="6.8.2" data-path="machine-learning.html"><a href="machine-learning.html#self-organising-map"><i class="fa fa-check"></i><b>6.8.2</b> Self organising map</a></li>
<li class="chapter" data-level="6.8.3" data-path="machine-learning.html"><a href="machine-learning.html#multidimensional-scaling"><i class="fa fa-check"></i><b>6.8.3</b> Multidimensional scaling</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="machine-learning.html"><a href="machine-learning.html#deep-learning"><i class="fa fa-check"></i><b>6.9</b> Deep learning</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="machine-learning.html"><a href="machine-learning.html#deep-neural-network"><i class="fa fa-check"></i><b>6.9.1</b> Deep neural network</a></li>
<li class="chapter" data-level="6.9.2" data-path="machine-learning.html"><a href="machine-learning.html#tabnet"><i class="fa fa-check"></i><b>6.9.2</b> Tabnet</a></li>
<li class="chapter" data-level="6.9.3" data-path="machine-learning.html"><a href="machine-learning.html#cnn"><i class="fa fa-check"></i><b>6.9.3</b> CNN</a></li>
<li class="chapter" data-level="6.9.4" data-path="machine-learning.html"><a href="machine-learning.html#rnn"><i class="fa fa-check"></i><b>6.9.4</b> RNN</a></li>
<li class="chapter" data-level="6.9.5" data-path="machine-learning.html"><a href="machine-learning.html#reinforcement-learning"><i class="fa fa-check"></i><b>6.9.5</b> Reinforcement learning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html"><i class="fa fa-check"></i><b>7</b> Machine Learning Part 2</a>
<ul>
<li class="chapter" data-level="7.1" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#bag-of-words"><i class="fa fa-check"></i><b>7.1</b> Bag of words</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#tfidf"><i class="fa fa-check"></i><b>7.1.1</b> TFIDF</a></li>
<li class="chapter" data-level="7.1.2" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#extracting-data-from-web"><i class="fa fa-check"></i><b>7.1.2</b> Extracting data from web</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#wordcloud"><i class="fa fa-check"></i><b>7.2</b> Wordcloud</a></li>
<li class="chapter" data-level="7.3" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#bigram-analysis"><i class="fa fa-check"></i><b>7.3</b> Bigram analysis</a></li>
<li class="chapter" data-level="7.4" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#trigram"><i class="fa fa-check"></i><b>7.4</b> Trigram</a></li>
<li class="chapter" data-level="7.5" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#topic-modeling-or-thematic-analysis"><i class="fa fa-check"></i><b>7.5</b> Topic modeling or thematic analysis</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#probabilistic-topic-model"><i class="fa fa-check"></i><b>7.5.1</b> Probabilistic topic model</a></li>
<li class="chapter" data-level="7.5.2" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#nmf"><i class="fa fa-check"></i><b>7.5.2</b> NMF</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html"><i class="fa fa-check"></i><b>8</b> Bayesian Analysis</a>
<ul>
<li class="chapter" data-level="8.1" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#baysian-belief"><i class="fa fa-check"></i><b>8.1</b> Baysian belief</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#conditional-probability"><i class="fa fa-check"></i><b>8.1.1</b> Conditional probability</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#markov-model"><i class="fa fa-check"></i><b>8.2</b> Markov model</a></li>
<li class="chapter" data-level="8.3" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#inla-stan-and-bugs"><i class="fa fa-check"></i><b>8.3</b> INLA, Stan and BUGS</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#linear-regression"><i class="fa fa-check"></i><b>8.3.1</b> Linear regression</a></li>
<li class="chapter" data-level="8.3.2" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#logistic-regression-2"><i class="fa fa-check"></i><b>8.3.2</b> Logistic regression</a></li>
<li class="chapter" data-level="8.3.3" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#mixed-model"><i class="fa fa-check"></i><b>8.3.3</b> Mixed model</a></li>
<li class="chapter" data-level="8.3.4" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#bayesian-metaanalysis"><i class="fa fa-check"></i><b>8.3.4</b> Bayesian Metaanalysis</a></li>
<li class="chapter" data-level="8.3.5" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#cost"><i class="fa fa-check"></i><b>8.3.5</b> Cost</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="operational-research.html"><a href="operational-research.html"><i class="fa fa-check"></i><b>9</b> Operational Research</a>
<ul>
<li class="chapter" data-level="9.1" data-path="operational-research.html"><a href="operational-research.html#queueing-theory"><i class="fa fa-check"></i><b>9.1</b> Queueing theory</a></li>
<li class="chapter" data-level="9.2" data-path="operational-research.html"><a href="operational-research.html#discrete-event-simulations"><i class="fa fa-check"></i><b>9.2</b> Discrete Event Simulations</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="operational-research.html"><a href="operational-research.html#simulate-capacity-of-system"><i class="fa fa-check"></i><b>9.2.1</b> Simulate capacity of system</a></li>
<li class="chapter" data-level="9.2.2" data-path="operational-research.html"><a href="operational-research.html#queuing-network"><i class="fa fa-check"></i><b>9.2.2</b> Queuing network</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="operational-research.html"><a href="operational-research.html#linear-programming"><i class="fa fa-check"></i><b>9.3</b> Linear Programming</a></li>
<li class="chapter" data-level="9.4" data-path="operational-research.html"><a href="operational-research.html#forecasting"><i class="fa fa-check"></i><b>9.4</b> Forecasting</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="operational-research.html"><a href="operational-research.html#bed-requirement"><i class="fa fa-check"></i><b>9.4.1</b> Bed requirement</a></li>
<li class="chapter" data-level="9.4.2" data-path="operational-research.html"><a href="operational-research.html#length-of-stay"><i class="fa fa-check"></i><b>9.4.2</b> Length of stay</a></li>
<li class="chapter" data-level="9.4.3" data-path="operational-research.html"><a href="operational-research.html#customer-churns"><i class="fa fa-check"></i><b>9.4.3</b> Customer churns</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="operational-research.html"><a href="operational-research.html#process-mapping"><i class="fa fa-check"></i><b>9.5</b> Process mapping</a></li>
<li class="chapter" data-level="9.6" data-path="operational-research.html"><a href="operational-research.html#supply-chains"><i class="fa fa-check"></i><b>9.6</b> Supply chains</a></li>
<li class="chapter" data-level="9.7" data-path="operational-research.html"><a href="operational-research.html#health-economics"><i class="fa fa-check"></i><b>9.7</b> Health economics</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="operational-research.html"><a href="operational-research.html#cost-1"><i class="fa fa-check"></i><b>9.7.1</b> Cost</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="graph-theory.html"><a href="graph-theory.html"><i class="fa fa-check"></i><b>10</b> Graph Theory</a>
<ul>
<li class="chapter" data-level="10.1" data-path="graph-theory.html"><a href="graph-theory.html#special-graphs"><i class="fa fa-check"></i><b>10.1</b> Special graphs</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="graph-theory.html"><a href="graph-theory.html#laplacian-matrix"><i class="fa fa-check"></i><b>10.1.1</b> Laplacian matrix</a></li>
<li class="chapter" data-level="10.1.2" data-path="graph-theory.html"><a href="graph-theory.html#bimodal-bipartite-graph"><i class="fa fa-check"></i><b>10.1.2</b> Bimodal (bipartite) graph</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="graph-theory.html"><a href="graph-theory.html#centrality-measures"><i class="fa fa-check"></i><b>10.2</b> Centrality Measures</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="graph-theory.html"><a href="graph-theory.html#local-centrality-measures"><i class="fa fa-check"></i><b>10.2.1</b> Local centrality measures</a></li>
<li class="chapter" data-level="10.2.2" data-path="graph-theory.html"><a href="graph-theory.html#global-centrality-measures"><i class="fa fa-check"></i><b>10.2.2</b> Global centrality measures</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="graph-theory.html"><a href="graph-theory.html#community"><i class="fa fa-check"></i><b>10.3</b> Community</a></li>
<li class="chapter" data-level="10.4" data-path="graph-theory.html"><a href="graph-theory.html#visualising-graph"><i class="fa fa-check"></i><b>10.4</b> Visualising graph</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="graph-theory.html"><a href="graph-theory.html#visnetwork"><i class="fa fa-check"></i><b>10.4.1</b> Visnetwork</a></li>
<li class="chapter" data-level="10.4.2" data-path="graph-theory.html"><a href="graph-theory.html#large-graph"><i class="fa fa-check"></i><b>10.4.2</b> Large graph</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="graph-theory.html"><a href="graph-theory.html#social-media-and-network-analysis"><i class="fa fa-check"></i><b>10.5</b> Social Media and Network Analysis</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="graph-theory.html"><a href="graph-theory.html#twitter"><i class="fa fa-check"></i><b>10.5.1</b> Twitter</a></li>
<li class="chapter" data-level="10.5.2" data-path="graph-theory.html"><a href="graph-theory.html#youtube"><i class="fa fa-check"></i><b>10.5.2</b> Youtube</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html"><i class="fa fa-check"></i><b>11</b> Geospatial analysis</a>
<ul>
<li class="chapter" data-level="11.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#geocoding"><i class="fa fa-check"></i><b>11.1</b> Geocoding</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#openstreetmap"><i class="fa fa-check"></i><b>11.1.1</b> OpenStreetMap</a></li>
<li class="chapter" data-level="11.1.2" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#google-maps-api"><i class="fa fa-check"></i><b>11.1.2</b> Google Maps API</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#sp-and-sf-objects"><i class="fa fa-check"></i><b>11.2</b> Sp and sf objects</a></li>
<li class="chapter" data-level="11.3" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#thematic-map-1"><i class="fa fa-check"></i><b>11.3</b> Thematic map</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#calculate-distance-to-hospital-openstreetmap"><i class="fa fa-check"></i><b>11.3.1</b> Calculate distance to Hospital-OpenStreetMap</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#spatial-regression"><i class="fa fa-check"></i><b>11.4</b> Spatial regression</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#new-york-covid-19-mortality"><i class="fa fa-check"></i><b>11.4.1</b> New York COVID-19 mortality</a></li>
<li class="chapter" data-level="11.4.2" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#danish-stroke-registry"><i class="fa fa-check"></i><b>11.4.2</b> Danish Stroke Registry</a></li>
<li class="chapter" data-level="11.4.3" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#inla"><i class="fa fa-check"></i><b>11.4.3</b> INLA</a></li>
<li class="chapter" data-level="11.4.4" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#stan"><i class="fa fa-check"></i><b>11.4.4</b> Stan</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#machine-learning-in-spatial-analysis"><i class="fa fa-check"></i><b>11.5</b> Machine learning in spatial analysis</a></li>
<li class="chapter" data-level="11.6" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#spatio-temporal-regression"><i class="fa fa-check"></i><b>11.6</b> Spatio-temporal regression</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="app.html"><a href="app.html"><i class="fa fa-check"></i><b>12</b> App</a>
<ul>
<li class="chapter" data-level="12.1" data-path="app.html"><a href="app.html#brief-introduction-to-shiny-app"><i class="fa fa-check"></i><b>12.1</b> Brief introduction to Shiny app</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>13</b> Appendix</a>
<ul>
<li class="chapter" data-level="13.1" data-path="appendix.html"><a href="appendix.html#brief-introduction-to-matrix"><i class="fa fa-check"></i><b>13.1</b> Brief introduction to Matrix</a></li>
<li class="chapter" data-level="13.2" data-path="appendix.html"><a href="appendix.html#regression-1"><i class="fa fa-check"></i><b>13.2</b> Regression</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="appendix.html"><a href="appendix.html#linear-regression-1"><i class="fa fa-check"></i><b>13.2.1</b> Linear regression</a></li>
<li class="chapter" data-level="13.2.2" data-path="appendix.html"><a href="appendix.html#logistic-regression-3"><i class="fa fa-check"></i><b>13.2.2</b> Logistic regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applications of R in Healthcare</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="machine-learning" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Machine learning<a href="machine-learning.html#machine-learning" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>A key aspect of machine learning is cross validation to evaluate the model. It repeatedly evaluate the model based on different subsets of the model and using different parameters to select the optimal parameters. The models are compared against subset of the data. The <em>caret</em> library is an excellent tool for performing model selection.</p>
<div id="decision-tree-analysis" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Decision tree analysis<a href="machine-learning.html#decision-tree-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Decision tree method generates a logical flow diagram that resembles a tree.
This triangulated diagram, with repeated partitioning of the original data into smaller groups (nodes) on a yes or no basis, resembles clinical reasoning. By
way of contrast, regression methods generate significant predictors but its not clear how those predictors enter the sequential nature of clinical reasoning. Regression models assume that all of the variables are required at once to formulate an accurate prediction. This would make some of the elements of any model from regression analysis superfluous.</p>
<p>There are several different approaches to performing decision tree analyses. The most famous method CART is implemented in R as <em>rpart</em>. The second approaches
uses chi-square test to partition the tree, available from the <em>party</em> library. Decision tree may also reveal complex intreactions (relationship) among the predictors in a way that regression analyses do not easily reveal.</p>
<div id="information-theory-driven" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Information theory driven<a href="machine-learning.html#information-theory-driven" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The tree is grown using a divide and conquer strategy, with repeated partitioning of the original data into smaller groups (nodes) on a yes or no basis. The method uses a splitting rule built around the notion of purity. A node in the tree is defined as pure when all the elements belong to one class. When there is impurity in the node, a split occurs to maximize reduction in impurity. In some cases, the split may be biased toward attributes that
contain many different ordinal levels or scales. Thus, the selection of an attribute as the root node may vary according to the splitting rule and the scaling of the attribute. The decision tree package rpart does tolerate certain degree of missing number because the data are split using the available data for that attribute to calculate the Gini index (rather than the entire cohort). One major advantage of <em>rpart</em> is the presentation of the classification rules in
the easily interpretable form of a tree. The hierarchical nature of the decision tree is similar to many decision processes <span class="citation">(<a href="#ref-pmid29559951">Phan et al. 2018</a>)</span>. A criticism of decision tree is that its prone to overfitting and or preference for variable with many levels. Decision tree do not handle collinearity issues well.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="machine-learning.html#cb1-1" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb1-2"><a href="machine-learning.html#cb1-2" tabindex="-1"></a><span class="fu">library</span>(rattle)</span></code></pre></div>
<pre><code>## Loading required package: tibble</code></pre>
<pre><code>## Loading required package: bitops</code></pre>
<pre><code>## Rattle: A free graphical interface for data science with R.
## Version 5.5.1 Copyright (c) 2006-2021 Togaware Pty Ltd.
## Type &#39;rattle()&#39; to shake, rattle, and roll your data.</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="machine-learning.html#cb5-1" tabindex="-1"></a><span class="fu">library</span>(rpart.plot)</span>
<span id="cb5-2"><a href="machine-learning.html#cb5-2" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Leukemia&quot;</span>, <span class="at">package =</span> <span class="st">&quot;Stat2Data&quot;</span>)</span>
<span id="cb5-3"><a href="machine-learning.html#cb5-3" tabindex="-1"></a><span class="fu">colnames</span>(Leukemia)</span></code></pre></div>
<pre><code>## [1] &quot;Age&quot;    &quot;Smear&quot;  &quot;Infil&quot;  &quot;Index&quot;  &quot;Blasts&quot; &quot;Temp&quot;   &quot;Resp&quot;   &quot;Time&quot;  
## [9] &quot;Status&quot;</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="machine-learning.html#cb7-1" tabindex="-1"></a><span class="co">#decision tree model for AML treatment</span></span>
<span id="cb7-2"><a href="machine-learning.html#cb7-2" tabindex="-1"></a>treLeukemia<span class="ot">&lt;-</span><span class="fu">rpart</span>(Status<span class="sc">~</span>., <span class="at">data=</span>Leukemia)</span>
<span id="cb7-3"><a href="machine-learning.html#cb7-3" tabindex="-1"></a><span class="fu">fancyRpartPlot</span>(treLeukemia)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-1-1.png" width="672" /></p>
</div>
<div id="conditional-decision-tree" class="section level3 hasAnchor" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> Conditional decision tree<a href="machine-learning.html#conditional-decision-tree" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The conditional decision tree approach has been proposed to be superior to CART method because that method uses information criterion for partitioning and which can lead to overtting.The scenario of overtting describes model which works
well on training data but less so with new data.The conditional approach by <em>party</em> is less prone to overtting as it includes signicance testing <span class="citation">(<a href="#ref-pmid30761063">Phan et al. 2019</a>)</span>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="machine-learning.html#cb8-1" tabindex="-1"></a><span class="fu">library</span>(party)</span></code></pre></div>
<pre><code>## Loading required package: grid</code></pre>
<pre><code>## Loading required package: mvtnorm</code></pre>
<pre><code>## Loading required package: modeltools</code></pre>
<pre><code>## Loading required package: stats4</code></pre>
<pre><code>## Loading required package: strucchange</code></pre>
<pre><code>## Loading required package: zoo</code></pre>
<pre><code>## 
## Attaching package: &#39;zoo&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     as.Date, as.Date.numeric</code></pre>
<pre><code>## Loading required package: sandwich</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="machine-learning.html#cb18-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;aSAH&quot;</span>, <span class="at">package =</span> <span class="st">&quot;pROC&quot;</span>)</span>
<span id="cb18-2"><a href="machine-learning.html#cb18-2" tabindex="-1"></a><span class="fu">colnames</span>(aSAH)</span></code></pre></div>
<pre><code>## [1] &quot;gos6&quot;    &quot;outcome&quot; &quot;gender&quot;  &quot;age&quot;     &quot;wfns&quot;    &quot;s100b&quot;   &quot;ndka&quot;</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="machine-learning.html#cb20-1" tabindex="-1"></a><span class="co">#decision tree model</span></span>
<span id="cb20-2"><a href="machine-learning.html#cb20-2" tabindex="-1"></a>treeSAH<span class="ot">&lt;-</span><span class="fu">ctree</span>(outcome<span class="sc">~</span>., <span class="at">data=</span>aSAH, <span class="at">control =</span> <span class="fu">ctree_control</span>(<span class="at">mincriterion=</span><span class="fl">0.95</span>, <span class="at">minsplit=</span><span class="dv">50</span>))</span>
<span id="cb20-3"><a href="machine-learning.html#cb20-3" tabindex="-1"></a><span class="fu">plot</span>(treeSAH,<span class="at">type =</span> <span class="st">&quot;simple&quot;</span>,<span class="at">main =</span> <span class="st">&quot;Conditional Inference for aSAH&quot;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-2-1.png" width="672" /></p>
</div>
</div>
<div id="ensemble-tree-methods" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Ensemble tree methods<a href="machine-learning.html#ensemble-tree-methods" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="bagging-trees" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Bagging trees<a href="machine-learning.html#bagging-trees" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Both gradient boost machine and random forest are examples of tree-based method with the former based on boosting of the residuals of the model and the latter based on bagging with random selection (rows and columns) of multiple subsets of the data. As such random forest regression ensembles the model from multiple decision trees. The trees are created by obtaining multiple subset of the data without replacement (random selection of data by rows and columns). Decision tree comes at certain disadvantage such as overfitting. Random forest avoids the problems of single decision tree analyses by aggregating the results of multiple trees obtained by performing analysis on random subsets of the original data. This method is different from the bootstrapping procedure in which the data is subsetted with replacement. Theoretically, decision tree can look very similar as the data structure is not significantly changed. There is a theoretical risk of overfitting with random forest and underfitting with boosting tree methods.</p>
<div id="random-forest" class="section level4 hasAnchor" number="6.2.1.1">
<h4><span class="header-section-number">6.2.1.1</span> Random Forest<a href="machine-learning.html#random-forest" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Random forest is available as <em>randomForest</em> or <em>ranger</em> or via <em>caret</em>.
A major drawback to random forest is that the hierarchical nature of the trees
is lost. As such this method is seen as a black box tool and is less commonly embraced in the medical literature. One way us to use an interpretable machine learning tool <em>iml</em> <span class="citation">(<a href="#ref-10.21105/joss.00786">Molnar, Bischl, and Casalicchio 2018</a>)</span> (Shapley values) tool to aid interpretation of the model. This method uses ideas from coalition game theory
to fairly distribute the contribution of the coalition of covariates to the
random forest model.</p>
<p>The machine learning models are tuned using <em>caret</em> library.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="machine-learning.html#cb21-1" tabindex="-1"></a><span class="co">#https://topepo.github.io/caret/index.html</span></span>
<span id="cb21-2"><a href="machine-learning.html#cb21-2" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code></pre></div>
<pre><code>## Loading required package: ggplot2</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="machine-learning.html#cb24-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;BreastCancer&quot;</span>,<span class="at">package =</span> <span class="st">&quot;mlbench&quot;</span>)</span>
<span id="cb24-2"><a href="machine-learning.html#cb24-2" tabindex="-1"></a><span class="co">#The Breast Cancer data contains NA as well as factors</span></span>
<span id="cb24-3"><a href="machine-learning.html#cb24-3" tabindex="-1"></a><span class="co">#note Class is benign or malignant of class factor</span></span>
<span id="cb24-4"><a href="machine-learning.html#cb24-4" tabindex="-1"></a><span class="co">#column Bare.nuclei removed due to NA</span></span>
<span id="cb24-5"><a href="machine-learning.html#cb24-5" tabindex="-1"></a>BreastCancer<span class="ot">&lt;-</span>BreastCancer[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>)]</span>
<span id="cb24-6"><a href="machine-learning.html#cb24-6" tabindex="-1"></a></span>
<span id="cb24-7"><a href="machine-learning.html#cb24-7" tabindex="-1"></a><span class="co">#split data using caTools. </span></span>
<span id="cb24-8"><a href="machine-learning.html#cb24-8" tabindex="-1"></a><span class="co">#The next example will use createDataPartition from caret</span></span>
<span id="cb24-9"><a href="machine-learning.html#cb24-9" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb24-10"><a href="machine-learning.html#cb24-10" tabindex="-1"></a>split <span class="ot">=</span> caTools<span class="sc">::</span><span class="fu">sample.split</span>(BreastCancer<span class="sc">$</span>Class, <span class="at">SplitRatio =</span> <span class="fl">0.75</span>)</span>
<span id="cb24-11"><a href="machine-learning.html#cb24-11" tabindex="-1"></a>Train <span class="ot">=</span> <span class="fu">subset</span>(BreastCancer, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-12"><a href="machine-learning.html#cb24-12" tabindex="-1"></a>Test <span class="ot">=</span> <span class="fu">subset</span>(BreastCancer, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb24-13"><a href="machine-learning.html#cb24-13" tabindex="-1"></a></span>
<span id="cb24-14"><a href="machine-learning.html#cb24-14" tabindex="-1"></a></span>
<span id="cb24-15"><a href="machine-learning.html#cb24-15" tabindex="-1"></a><span class="co"># specify that resampling method is </span></span>
<span id="cb24-16"><a href="machine-learning.html#cb24-16" tabindex="-1"></a>rf_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="do">## 10-fold CV</span></span>
<span id="cb24-17"><a href="machine-learning.html#cb24-17" tabindex="-1"></a>                           <span class="at">method =</span> <span class="st">&quot;cv&quot;</span>,</span>
<span id="cb24-18"><a href="machine-learning.html#cb24-18" tabindex="-1"></a>                           <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb24-19"><a href="machine-learning.html#cb24-19" tabindex="-1"></a></span>
<span id="cb24-20"><a href="machine-learning.html#cb24-20" tabindex="-1"></a><span class="co">#scaling data is performed here under preProcess</span></span>
<span id="cb24-21"><a href="machine-learning.html#cb24-21" tabindex="-1"></a><span class="co">#note that ranger handles the outcome variable as factor</span></span>
<span id="cb24-22"><a href="machine-learning.html#cb24-22" tabindex="-1"></a>rf <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(Class <span class="sc">~</span> ., </span>
<span id="cb24-23"><a href="machine-learning.html#cb24-23" tabindex="-1"></a>                    <span class="at">data =</span> Train, </span>
<span id="cb24-24"><a href="machine-learning.html#cb24-24" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">&quot;ranger&quot;</span>,</span>
<span id="cb24-25"><a href="machine-learning.html#cb24-25" tabindex="-1"></a>                 <span class="at">trControl=</span>rf_control,</span>
<span id="cb24-26"><a href="machine-learning.html#cb24-26" tabindex="-1"></a>                 <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">&quot;center&quot;</span>, <span class="st">&quot;scale&quot;</span>),</span>
<span id="cb24-27"><a href="machine-learning.html#cb24-27" tabindex="-1"></a>                 <span class="at">tuneLength =</span> <span class="dv">10</span>, <span class="at">verbose=</span>F)</span>
<span id="cb24-28"><a href="machine-learning.html#cb24-28" tabindex="-1"></a></span>
<span id="cb24-29"><a href="machine-learning.html#cb24-29" tabindex="-1"></a></span>
<span id="cb24-30"><a href="machine-learning.html#cb24-30" tabindex="-1"></a><span class="fu">summary</span>(rf)</span></code></pre></div>
<pre><code>##                           Length Class         Mode     
## predictions               525    factor        numeric  
## num.trees                   1    -none-        numeric  
## num.independent.variables   1    -none-        numeric  
## mtry                        1    -none-        numeric  
## min.node.size               1    -none-        numeric  
## prediction.error            1    -none-        numeric  
## forest                      9    ranger.forest list     
## confusion.matrix            4    table         numeric  
## splitrule                   1    -none-        character
## num.random.splits           1    -none-        numeric  
## treetype                    1    -none-        character
## call                        9    -none-        call     
## importance.mode             1    -none-        character
## num.samples                 1    -none-        numeric  
## replace                     1    -none-        logical  
## xNames                     71    -none-        character
## problemType                 1    -none-        character
## tuneValue                   3    data.frame    list     
## obsLevels                   2    -none-        character
## param                       1    -none-        list</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="machine-learning.html#cb26-1" tabindex="-1"></a>pred_rf<span class="ot">&lt;-</span><span class="fu">predict</span>(rf,BreastCancer)</span>
<span id="cb26-2"><a href="machine-learning.html#cb26-2" tabindex="-1"></a><span class="fu">confusionMatrix</span>(pred_rf, BreastCancer<span class="sc">$</span>Class)</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##            Reference
## Prediction  benign malignant
##   benign       455         6
##   malignant      3       235
##                                           
##                Accuracy : 0.9871          
##                  95% CI : (0.9757, 0.9941)
##     No Information Rate : 0.6552          
##     P-Value [Acc &gt; NIR] : &lt;2e-16          
##                                           
##                   Kappa : 0.9714          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.505           
##                                           
##             Sensitivity : 0.9934          
##             Specificity : 0.9751          
##          Pos Pred Value : 0.9870          
##          Neg Pred Value : 0.9874          
##              Prevalence : 0.6552          
##          Detection Rate : 0.6509          
##    Detection Prevalence : 0.6595          
##       Balanced Accuracy : 0.9843          
##                                           
##        &#39;Positive&#39; Class : benign          
## </code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="machine-learning.html#cb28-1" tabindex="-1"></a>roc_rf<span class="ot">&lt;-</span>pROC<span class="sc">::</span><span class="fu">roc</span>(BreastCancer<span class="sc">$</span>Class, <span class="fu">as.numeric</span>(pred_rf))</span></code></pre></div>
<pre><code>## Setting levels: control = benign, case = malignant</code></pre>
<pre><code>## Setting direction: controls &lt; cases</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="machine-learning.html#cb31-1" tabindex="-1"></a>roc_rf</span></code></pre></div>
<pre><code>## 
## Call:
## roc.default(response = BreastCancer$Class, predictor = as.numeric(pred_rf))
## 
## Data: as.numeric(pred_rf) in 458 controls (BreastCancer$Class benign) &lt; 241 cases (BreastCancer$Class malignant).
## Area under the curve: 0.9843</code></pre>
</div>
<div id="random-survival-forest-with-rfsrc" class="section level4 hasAnchor" number="6.2.1.2">
<h4><span class="header-section-number">6.2.1.2</span> Random survival forest with rfsrc<a href="machine-learning.html#random-survival-forest-with-rfsrc" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Random survival forest example is provided below using <em>rfsrc</em> library. The <em>survex</em> library is used for explanation on the model. This library is also available as a learner in the <em>mlr3verse</em>.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="machine-learning.html#cb33-1" tabindex="-1"></a><span class="fu">library</span>(survival)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;survival&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:caret&#39;:
## 
##     cluster</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="machine-learning.html#cb36-1" tabindex="-1"></a><span class="fu">library</span>(survminer)</span></code></pre></div>
<pre><code>## Loading required package: ggpubr</code></pre>
<pre><code>## 
## Attaching package: &#39;survminer&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:survival&#39;:
## 
##     myeloma</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="machine-learning.html#cb40-1" tabindex="-1"></a><span class="fu">library</span>(randomForestSRC)</span></code></pre></div>
<pre><code>## 
##  randomForestSRC 3.2.2 
##  
##  Type rfsrc.news() to see new features, changes, and bug fixes. 
## </code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="machine-learning.html#cb42-1" tabindex="-1"></a><span class="fu">library</span>(survex)</span>
<span id="cb42-2"><a href="machine-learning.html#cb42-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:survex&#39;:
## 
##     explain</code></pre>
<pre><code>## The following object is masked from &#39;package:party&#39;:
## 
##     where</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="machine-learning.html#cb48-1" tabindex="-1"></a><span class="co">#data from survival package on NCCTG lung cancer trial</span></span>
<span id="cb48-2"><a href="machine-learning.html#cb48-2" tabindex="-1"></a><span class="co">#https://stat.ethz.ch/R-manual/R-devel/library/survival/html/lung.html</span></span>
<span id="cb48-3"><a href="machine-learning.html#cb48-3" tabindex="-1"></a><span class="fu">data</span>(cancer, <span class="at">package=</span><span class="st">&quot;survival&quot;</span>)</span>
<span id="cb48-4"><a href="machine-learning.html#cb48-4" tabindex="-1"></a></span>
<span id="cb48-5"><a href="machine-learning.html#cb48-5" tabindex="-1"></a><span class="co">#time in days</span></span>
<span id="cb48-6"><a href="machine-learning.html#cb48-6" tabindex="-1"></a><span class="co">#status censored=1, dead=2</span></span>
<span id="cb48-7"><a href="machine-learning.html#cb48-7" tabindex="-1"></a><span class="co">#sex:Male=1 Female=2</span></span>
<span id="cb48-8"><a href="machine-learning.html#cb48-8" tabindex="-1"></a></span>
<span id="cb48-9"><a href="machine-learning.html#cb48-9" tabindex="-1"></a>cancer2<span class="ot">&lt;-</span> cancer <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb48-10"><a href="machine-learning.html#cb48-10" tabindex="-1"></a>  <span class="at">status=</span><span class="fu">ifelse</span>(status<span class="sc">==</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-11"><a href="machine-learning.html#cb48-11" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Dead=</span>status, <span class="at">Days=</span>time)</span>
<span id="cb48-12"><a href="machine-learning.html#cb48-12" tabindex="-1"></a></span>
<span id="cb48-13"><a href="machine-learning.html#cb48-13" tabindex="-1"></a>time<span class="ot">=</span>cancer2<span class="sc">$</span>Days</span>
<span id="cb48-14"><a href="machine-learning.html#cb48-14" tabindex="-1"></a>status<span class="ot">=</span>cancer2<span class="sc">$</span>Dead</span>
<span id="cb48-15"><a href="machine-learning.html#cb48-15" tabindex="-1"></a></span>
<span id="cb48-16"><a href="machine-learning.html#cb48-16" tabindex="-1"></a>RF<span class="ot">&lt;-</span> <span class="fu">rfsrc</span>(<span class="fu">Surv</span>(Days, Dead) <span class="sc">~</span> age<span class="sc">+</span>sex<span class="sc">+</span>ph.ecog<span class="sc">+</span>ph.karno<span class="sc">+</span>wt.loss, <span class="at">data =</span> cancer2)</span>
<span id="cb48-17"><a href="machine-learning.html#cb48-17" tabindex="-1"></a></span>
<span id="cb48-18"><a href="machine-learning.html#cb48-18" tabindex="-1"></a><span class="co">#specify library to avoid confusion with dplyr</span></span>
<span id="cb48-19"><a href="machine-learning.html#cb48-19" tabindex="-1"></a>explainer<span class="ot">&lt;-</span>survex<span class="sc">::</span><span class="fu">explain</span>(RF)</span></code></pre></div>
<pre><code>## Preparation of a new explainer is initiated 
##   -&gt; model label       :  rfsrc ( [33m default [39m ) 
##   -&gt; data              :  213  rows  5  cols (  extracted from the model  ) 
##   -&gt; target variable   :  213  values ( 151 events and 62 censored , censoring rate = 0.291 ) (  extracted from the model  ) 
##   -&gt; times             :  50 unique time points , min = 5 , mean = 304.1224 , median = 263.16 , max = 835.44 
##   -&gt; times             :  (  generated from y as 50 time points being consecutive quantiles (0.00, 0.02, ..., 0.98)  ) 
##   -&gt; predict function  :  sum over the predict_cumulative_hazard_function will be used ( [33m default [39m ) 
##   -&gt; predict survival function  :  stepfun based on predict.rfsrc()$survival will be used ( [33m default [39m ) 
##   -&gt; predict cumulative hazard function  :  stepfun based on predict.rfsrc()$chf will be used ( [33m default [39m ) 
##   -&gt; model_info        :  package randomForestSRC , ver. 3.2.2 , task survival ( [33m default [39m ) 
##   A new explainer has been created!</code></pre>
<p>Plot a single tree from the random survival forest model.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="machine-learning.html#cb50-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">get.tree</span>(RF,<span class="dv">4</span>))</span></code></pre></div>
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-adab98bc85b0eae9c471" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-adab98bc85b0eae9c471">{"x":{"diagram":"digraph {\n\n\n\n\n  \"1\" [label = \"ph.karno\", color = \"black\", fontcolor = \"black\", penwidth = \"3\", style = \"\", shape = \"\", fontname = \"\", tooltip = \"\", fillcolor = \"\"] \n  \"2\" [label = \"age\", color = \"black\", fontcolor = \"black\", penwidth = \"3\", style = \"\", shape = \"\", fontname = \"\", tooltip = \"\", fillcolor = \"\"] \n  \"3\" [label = \"n=1\n105\", color = \"black\", fontcolor = \"black\", penwidth = \"3\", style = \"filled,rounded\", shape = \"box\", fontname = \"helvetica\", tooltip = \"- split: <=40.0000000149012\n- split.pretty: <=40\", fillcolor = \"GreenYellow\"] \n  \"4\" [label = \"ph.ecog\", color = \"black\", fontcolor = \"black\", penwidth = \"3\", style = \"\", shape = \"\", fontname = \"\", tooltip = \"\", fillcolor = \"\"] \n  \"5\" [label = \"sex\", color = \"black\", fontcolor = \"black\", penwidth = \"3\", style = \"\", shape = \"\", fontname = \"\", tooltip = \"\", fillcolor = \"\"] \n  \"6\" [label = \"n=28\n112.34\", color = \"black\", fontcolor = \"black\", penwidth = \"3\", style = \"filled,rounded\", shape = \"box\", fontname = \"helvetica\", tooltip = \"- split: <=1.00000001490116\n- split.pretty: <=1\", fillcolor = \"GreenYellow\"] \n  \"7\" [label = \"n=19\n50.95\", color = \"black\", fontcolor = \"black\", penwidth = \"3\", style = \"filled,rounded\", shape = \"box\", fontname = \"helvetica\", tooltip = \"- split: >1.00000001490116\n- split.pretty: \", fillcolor = \"GreenYellow\"] \n  \"8\" [label = \"n=26\n142.69\", color = \"black\", fontcolor = \"black\", penwidth = \"3\", style = \"filled,rounded\", shape = \"box\", fontname = \"helvetica\", tooltip = \"- split: >1.00000001490116\n- split.pretty: \", fillcolor = \"GreenYellow\"] \n  \"9\" [label = \"sex\", color = \"black\", fontcolor = \"black\", penwidth = \"3\", style = \"\", shape = \"\", fontname = \"\", tooltip = \"\", fillcolor = \"\"] \n  \"10\" [label = \"wt.loss\", color = \"black\", fontcolor = \"black\", penwidth = \"3\", style = \"\", shape = \"\", fontname = \"\", tooltip = \"\", fillcolor = \"\"] \n  \"11\" [label = \"wt.loss\", color = \"black\", fontcolor = \"black\", penwidth = \"3\", style = \"\", shape = \"\", fontname = \"\", tooltip = \"\", fillcolor = \"\"] \n  \"12\" [label = \"n=5\n19.5\", color = \"black\", fontcolor = \"black\", penwidth = \"3\", style = \"filled,rounded\", shape = \"box\", fontname = \"helvetica\", tooltip = \"- split: <=-0.999999985098839\n- split.pretty: <=-1\", fillcolor = \"GreenYellow\"] \n  \"13\" [label = \"n=29\n88.81\", color = \"black\", fontcolor = \"black\", penwidth = \"3\", style = \"filled,rounded\", shape = \"box\", fontname = \"helvetica\", tooltip = \"- split: >-0.999999985098839\n- split.pretty: \", fillcolor = \"GreenYellow\"] \n  \"14\" [label = \"n=4\n122.75\", color = \"black\", fontcolor = \"black\", penwidth = \"3\", style = \"filled,rounded\", shape = \"box\", fontname = \"helvetica\", tooltip = \"- split: >17.0000000149012\n- split.pretty: \", fillcolor = \"GreenYellow\"] \n  \"15\" [label = \"n=23\n41.82\", color = \"black\", fontcolor = \"black\", penwidth = \"3\", style = \"filled,rounded\", shape = \"box\", fontname = \"helvetica\", tooltip = \"- split: >1.00000001490116\n- split.pretty: \", fillcolor = \"GreenYellow\"] \n\"1\"->\"2\" [color = \"black\", label = \"<=80\", fontcolor = \"black\", fontcolor = \"black\"] \n\"1\"->\"9\" [color = \"black\", color = \"black\", fontcolor = \"black\", fontcolor = \"black\"] \n\"2\"->\"3\" [color = \"grey35\", label = \"<=40\", fontcolor = \"black\", arrowhead = \"vee\", penwidth = \"3\"] \n\"2\"->\"4\" [color = \"black\", color = \"black\", fontcolor = \"black\", fontcolor = \"black\"] \n\"9\"->\"10\" [color = \"black\", label = \"<=1\", fontcolor = \"black\", fontcolor = \"black\"] \n\"9\"->\"15\" [color = \"grey35\", color = \"grey35\", fontcolor = \"black\", arrowhead = \"vee\", penwidth = \"3\"] \n\"4\"->\"5\" [color = \"black\", label = \"<=1\", fontcolor = \"black\", fontcolor = \"black\"] \n\"4\"->\"8\" [color = \"grey35\", color = \"grey35\", fontcolor = \"black\", arrowhead = \"vee\", penwidth = \"3\"] \n\"10\"->\"11\" [color = \"black\", label = \"<=17\", fontcolor = \"black\", fontcolor = \"black\"] \n\"10\"->\"14\" [color = \"grey35\", color = \"grey35\", fontcolor = \"black\", arrowhead = \"vee\", penwidth = \"3\"] \n\"5\"->\"6\" [color = \"grey35\", label = \"<=1\", fontcolor = \"black\", arrowhead = \"vee\", penwidth = \"3\"] \n\"5\"->\"7\" [color = \"grey35\", color = \"grey35\", fontcolor = \"black\", arrowhead = \"vee\", penwidth = \"3\"] \n\"11\"->\"12\" [color = \"grey35\", label = \"<=-1\", fontcolor = \"black\", arrowhead = \"vee\", penwidth = \"3\"] \n\"11\"->\"13\" [color = \"grey35\", color = \"grey35\", fontcolor = \"black\", arrowhead = \"vee\", penwidth = \"3\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<p>Dynamic AUC</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="machine-learning.html#cb51-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> explainer<span class="sc">$</span>y</span>
<span id="cb51-2"><a href="machine-learning.html#cb51-2" tabindex="-1"></a>times <span class="ot">&lt;-</span> explainer<span class="sc">$</span>times</span>
<span id="cb51-3"><a href="machine-learning.html#cb51-3" tabindex="-1"></a></span>
<span id="cb51-4"><a href="machine-learning.html#cb51-4" tabindex="-1"></a>surv <span class="ot">&lt;-</span> explainer<span class="sc">$</span><span class="fu">predict_survival_function</span>(RF, explainer<span class="sc">$</span>data, times)</span>
<span id="cb51-5"><a href="machine-learning.html#cb51-5" tabindex="-1"></a></span>
<span id="cb51-6"><a href="machine-learning.html#cb51-6" tabindex="-1"></a><span class="fu">cd_auc</span>(y, <span class="at">surv =</span> surv, <span class="at">times =</span> times)</span></code></pre></div>
<pre><code>##  [1] 1.0000000 0.9307568 0.9112200 0.9096154 0.8829532 0.8786292 0.8560335
##  [8] 0.8517304 0.8459069 0.8241969 0.8231190 0.8146465 0.7873396 0.7604641
## [15] 0.7722174 0.7696099 0.7667343 0.7605675 0.7514324 0.7500935 0.7638787
## [22] 0.7621149 0.7673878 0.7606034 0.7352058 0.7093474 0.7040276 0.7113576
## [29] 0.7135705 0.7084011 0.7085640 0.7135241 0.7028266 0.6921722 0.6955375
## [36] 0.7029153 0.6907407 0.6919927 0.7015251 0.7019995 0.7273598 0.7425582
## [43] 0.7499178 0.7495446 0.7548334 0.7822465 0.8160264 0.8361538 0.8801743
## [50] 0.9048077</code></pre>
<p>Plot variable importance for random survival forest using permutation of features and measure impact on Brier score.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="machine-learning.html#cb53-1" tabindex="-1"></a>ModelRF<span class="ot">&lt;-</span>survex<span class="sc">::</span><span class="fu">model_parts</span>(explainer)</span>
<span id="cb53-2"><a href="machine-learning.html#cb53-2" tabindex="-1"></a></span>
<span id="cb53-3"><a href="machine-learning.html#cb53-3" tabindex="-1"></a></span>
<span id="cb53-4"><a href="machine-learning.html#cb53-4" tabindex="-1"></a><span class="fu">plot</span>(ModelRF)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-3-4-1.png" width="672" /></p>
<p>Plot partial dependence</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="machine-learning.html#cb54-1" tabindex="-1"></a>Model_PD<span class="ot">&lt;-</span><span class="fu">model_profile</span>(explainer)</span>
<span id="cb54-2"><a href="machine-learning.html#cb54-2" tabindex="-1"></a><span class="fu">plot</span>(Model_PD)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-3-5-1.png" width="672" /></p>
</div>
<div id="random-survival-forest-with-ranger" class="section level4 hasAnchor" number="6.2.1.3">
<h4><span class="header-section-number">6.2.1.3</span> Random survival forest with ranger<a href="machine-learning.html#random-survival-forest-with-ranger" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Random forest can be used for performing survival analysis using <em>ranger</em>, <em>randomforestSRC</em>. The example below is an example using the lung cancer trial.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="machine-learning.html#cb55-1" tabindex="-1"></a><span class="co">#data from survival package on NCCTG lung cancer trial</span></span>
<span id="cb55-2"><a href="machine-learning.html#cb55-2" tabindex="-1"></a><span class="co">#https://stat.ethz.ch/R-manual/R-devel/library/survival/html/lung.html</span></span>
<span id="cb55-3"><a href="machine-learning.html#cb55-3" tabindex="-1"></a><span class="fu">data</span>(cancer, <span class="at">package=</span><span class="st">&quot;survival&quot;</span>)</span>
<span id="cb55-4"><a href="machine-learning.html#cb55-4" tabindex="-1"></a></span>
<span id="cb55-5"><a href="machine-learning.html#cb55-5" tabindex="-1"></a><span class="co">#time in days</span></span>
<span id="cb55-6"><a href="machine-learning.html#cb55-6" tabindex="-1"></a><span class="co">#status censored=1, dead=2</span></span>
<span id="cb55-7"><a href="machine-learning.html#cb55-7" tabindex="-1"></a><span class="co">#sex:Male=1 Female=2</span></span>
<span id="cb55-8"><a href="machine-learning.html#cb55-8" tabindex="-1"></a></span>
<span id="cb55-9"><a href="machine-learning.html#cb55-9" tabindex="-1"></a><span class="fu">library</span>(ranger)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;ranger&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:rattle&#39;:
## 
##     importance</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="machine-learning.html#cb58-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>##  Attaching core tidyverse packages  tidyverse 2.0.0 
##  forcats   1.0.0      readr     2.1.4
##  lubridate 1.9.2      stringr   1.5.0
##  purrr     1.0.1      tidyr     1.3.0</code></pre>
<pre><code>##  Conflicts  tidyverse_conflicts() 
##  stringr::boundary() masks strucchange::boundary()
##  dplyr::explain()    masks survex::explain()
##  dplyr::filter()     masks stats::filter()
##  dplyr::lag()        masks stats::lag()
##  purrr::lift()       masks caret::lift()
##  purrr::partial()    masks randomForestSRC::partial()
##  dplyr::where()      masks party::where()
##  Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="machine-learning.html#cb61-1" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb61-2"><a href="machine-learning.html#cb61-2" tabindex="-1"></a></span>
<span id="cb61-3"><a href="machine-learning.html#cb61-3" tabindex="-1"></a>cancer2<span class="ot">&lt;-</span>cancer <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(time, status, age,sex, ph.ecog) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>()  </span>
<span id="cb61-4"><a href="machine-learning.html#cb61-4" tabindex="-1"></a></span>
<span id="cb61-5"><a href="machine-learning.html#cb61-5" tabindex="-1"></a>survival_formula<span class="ot">&lt;-</span><span class="fu">formula</span>(<span class="fu">paste</span>(<span class="st">&#39;Surv(&#39;</span>, <span class="st">&#39;time&#39;</span>, <span class="st">&#39;,&#39;</span>, <span class="st">&#39;status&#39;</span>, <span class="st">&#39;) ~ &#39;</span>,<span class="st">&#39;age+sex+ph.ecog&#39;</span>))</span>
<span id="cb61-6"><a href="machine-learning.html#cb61-6" tabindex="-1"></a>  </span>
<span id="cb61-7"><a href="machine-learning.html#cb61-7" tabindex="-1"></a>survival_forest <span class="ot">&lt;-</span> <span class="fu">ranger</span>(survival_formula,</span>
<span id="cb61-8"><a href="machine-learning.html#cb61-8" tabindex="-1"></a>                         <span class="at">data =</span> cancer2,  </span>
<span id="cb61-9"><a href="machine-learning.html#cb61-9" tabindex="-1"></a>                         <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb61-10"><a href="machine-learning.html#cb61-10" tabindex="-1"></a>                         <span class="at">importance =</span> <span class="st">&#39;permutation&#39;</span>,</span>
<span id="cb61-11"><a href="machine-learning.html#cb61-11" tabindex="-1"></a>                         <span class="at">mtry =</span> <span class="dv">2</span>,</span>
<span id="cb61-12"><a href="machine-learning.html#cb61-12" tabindex="-1"></a>                         <span class="at">verbose =</span> <span class="cn">TRUE</span>,</span>
<span id="cb61-13"><a href="machine-learning.html#cb61-13" tabindex="-1"></a>                         <span class="at">num.trees =</span> <span class="dv">200</span>,</span>
<span id="cb61-14"><a href="machine-learning.html#cb61-14" tabindex="-1"></a>                         <span class="at">write.forest=</span><span class="cn">TRUE</span>)</span>
<span id="cb61-15"><a href="machine-learning.html#cb61-15" tabindex="-1"></a></span>
<span id="cb61-16"><a href="machine-learning.html#cb61-16" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;error:&quot;</span>); <span class="fu">print</span>(survival_forest<span class="sc">$</span>prediction.error)</span></code></pre></div>
<pre><code>## [1] &quot;error:&quot;</code></pre>
<pre><code>## [1] 0.391924</code></pre>
<p>Print variable importance</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="machine-learning.html#cb64-1" tabindex="-1"></a><span class="fu">sort</span>(survival_forest<span class="sc">$</span>variable.importance)</span></code></pre></div>
<pre><code>##         age         sex     ph.ecog 
## 0.008386083 0.030801816 0.065970251</code></pre>
<p>Probability of survival</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="machine-learning.html#cb66-1" tabindex="-1"></a><span class="fu">plot</span>(survival_forest<span class="sc">$</span>unique.death.times, survival_forest<span class="sc">$</span>survival[<span class="dv">1</span>,], <span class="at">type=</span><span class="st">&#39;l&#39;</span>, <span class="at">col=</span><span class="st">&#39;orange&#39;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="dv">1</span>))</span>
<span id="cb66-2"><a href="machine-learning.html#cb66-2" tabindex="-1"></a><span class="fu">lines</span>(survival_forest<span class="sc">$</span>unique.death.times, survival_forest<span class="sc">$</span>survival[<span class="dv">56</span>,], <span class="at">col=</span><span class="st">&#39;blue&#39;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-3-8-1.png" width="672" /></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="machine-learning.html#cb67-1" tabindex="-1"></a><span class="fu">plot</span>(survival_forest<span class="sc">$</span>unique.death.times, survival_forest<span class="sc">$</span>survival[<span class="dv">1</span>,], <span class="at">type=</span><span class="st">&#39;l&#39;</span>, <span class="at">col=</span><span class="st">&#39;orange&#39;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="dv">1</span>))</span>
<span id="cb67-2"><a href="machine-learning.html#cb67-2" tabindex="-1"></a><span class="cf">for</span> (x <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">100</span>)) {</span>
<span id="cb67-3"><a href="machine-learning.html#cb67-3" tabindex="-1"></a>  <span class="fu">lines</span>(survival_forest<span class="sc">$</span>unique.death.times, survival_forest<span class="sc">$</span>survival[x,], <span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span>
<span id="cb67-4"><a href="machine-learning.html#cb67-4" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-3-9-1.png" width="672" /></p>
</div>
</div>
<div id="boosting-trees" class="section level3 hasAnchor" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> Boosting trees<a href="machine-learning.html#boosting-trees" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="gradient-boost-machine" class="section level4 hasAnchor" number="6.2.2.1">
<h4><span class="header-section-number">6.2.2.1</span> Gradient Boost Machine<a href="machine-learning.html#gradient-boost-machine" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Gradient boost machine is available as <em>gradient boost machine_gbm</em>.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="machine-learning.html#cb68-1" tabindex="-1"></a><span class="co">#the breast cancer data from random forest is used here</span></span>
<span id="cb68-2"><a href="machine-learning.html#cb68-2" tabindex="-1"></a></span>
<span id="cb68-3"><a href="machine-learning.html#cb68-3" tabindex="-1"></a><span class="co"># specify that the resampling method is </span></span>
<span id="cb68-4"><a href="machine-learning.html#cb68-4" tabindex="-1"></a>gbm_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="do">## 10-fold CV</span></span>
<span id="cb68-5"><a href="machine-learning.html#cb68-5" tabindex="-1"></a>                           <span class="at">method =</span> <span class="st">&quot;repeatedcv&quot;</span>,</span>
<span id="cb68-6"><a href="machine-learning.html#cb68-6" tabindex="-1"></a>                           <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb68-7"><a href="machine-learning.html#cb68-7" tabindex="-1"></a></span>
<span id="cb68-8"><a href="machine-learning.html#cb68-8" tabindex="-1"></a><span class="co">#scaling data is performed here under preProcess</span></span>
<span id="cb68-9"><a href="machine-learning.html#cb68-9" tabindex="-1"></a><span class="co">#note that ranger handles the outcome variable as factor</span></span>
<span id="cb68-10"><a href="machine-learning.html#cb68-10" tabindex="-1"></a>gbm <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(Class <span class="sc">~</span> ., </span>
<span id="cb68-11"><a href="machine-learning.html#cb68-11" tabindex="-1"></a>                    <span class="at">data =</span> Train, </span>
<span id="cb68-12"><a href="machine-learning.html#cb68-12" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">&quot;gbm&quot;</span>,</span>
<span id="cb68-13"><a href="machine-learning.html#cb68-13" tabindex="-1"></a>                 <span class="at">trControl=</span>gbm_control,</span>
<span id="cb68-14"><a href="machine-learning.html#cb68-14" tabindex="-1"></a>                 <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">&quot;center&quot;</span>, <span class="st">&quot;scale&quot;</span>),</span>
<span id="cb68-15"><a href="machine-learning.html#cb68-15" tabindex="-1"></a>                 <span class="at">tuneLength =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1522             nan     0.1000    0.0657
##      2        1.0452             nan     0.1000    0.0520
##      3        0.9465             nan     0.1000    0.0486
##      4        0.8699             nan     0.1000    0.0376
##      5        0.8031             nan     0.1000    0.0314
##      6        0.7480             nan     0.1000    0.0279
##      7        0.6949             nan     0.1000    0.0264
##      8        0.6500             nan     0.1000    0.0206
##      9        0.6110             nan     0.1000    0.0178
##     10        0.5772             nan     0.1000    0.0173
##     20        0.3674             nan     0.1000    0.0043
##     40        0.2328             nan     0.1000   -0.0004
##     60        0.1811             nan     0.1000   -0.0003
##     80        0.1553             nan     0.1000   -0.0002
##    100        0.1395             nan     0.1000   -0.0000
##    120        0.1248             nan     0.1000   -0.0004
##    140        0.1138             nan     0.1000    0.0003
##    160        0.1063             nan     0.1000   -0.0006
##    180        0.1042             nan     0.1000   -0.0003
##    200        0.0970             nan     0.1000   -0.0013
##    220        0.0955             nan     0.1000   -0.0010
##    240        0.0905             nan     0.1000   -0.0000
##    260        0.0870             nan     0.1000   -0.0001
##    280        0.0838             nan     0.1000    0.0003
##    300        0.0798             nan     0.1000   -0.0006
##    320        0.0756             nan     0.1000   -0.0002
##    340        0.0742             nan     0.1000   -0.0009
##    360        0.0718             nan     0.1000   -0.0008
##    380        0.0701             nan     0.1000   -0.0005
##    400        0.0692             nan     0.1000   -0.0012
##    420        0.0675             nan     0.1000   -0.0006
##    440        0.0662             nan     0.1000   -0.0006
##    460        0.0648             nan     0.1000   -0.0010
##    480        0.0633             nan     0.1000   -0.0004
##    500        0.0621             nan     0.1000   -0.0006
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1503             nan     0.1000    0.0720
##      2        1.0312             nan     0.1000    0.0637
##      3        0.9344             nan     0.1000    0.0459
##      4        0.8459             nan     0.1000    0.0426
##      5        0.7714             nan     0.1000    0.0350
##      6        0.7103             nan     0.1000    0.0297
##      7        0.6549             nan     0.1000    0.0252
##      8        0.6086             nan     0.1000    0.0224
##      9        0.5655             nan     0.1000    0.0203
##     10        0.5309             nan     0.1000    0.0142
##     20        0.3027             nan     0.1000    0.0035
##     40        0.1678             nan     0.1000    0.0004
##     60        0.1251             nan     0.1000   -0.0007
##     80        0.1006             nan     0.1000   -0.0000
##    100        0.0839             nan     0.1000   -0.0003
##    120        0.0722             nan     0.1000   -0.0004
##    140        0.0644             nan     0.1000   -0.0007
##    160        0.0563             nan     0.1000    0.0002
##    180        0.0519             nan     0.1000   -0.0002
##    200        0.0462             nan     0.1000   -0.0006
##    220        0.0417             nan     0.1000   -0.0006
##    240        0.0373             nan     0.1000   -0.0001
##    260        0.0346             nan     0.1000   -0.0006
##    280        0.0306             nan     0.1000   -0.0003
##    300        0.0281             nan     0.1000   -0.0002
##    320        0.0247             nan     0.1000   -0.0002
##    340        0.0232             nan     0.1000   -0.0002
##    360        0.0220             nan     0.1000   -0.0002
##    380        0.0202             nan     0.1000   -0.0002
##    400        0.0186             nan     0.1000   -0.0002
##    420        0.0169             nan     0.1000   -0.0002
##    440        0.0157             nan     0.1000   -0.0001
##    460        0.0148             nan     0.1000   -0.0002
##    480        0.0137             nan     0.1000   -0.0001
##    500        0.0124             nan     0.1000   -0.0001
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1380             nan     0.1000    0.0744
##      2        1.0108             nan     0.1000    0.0622
##      3        0.9064             nan     0.1000    0.0503
##      4        0.8191             nan     0.1000    0.0399
##      5        0.7521             nan     0.1000    0.0326
##      6        0.6867             nan     0.1000    0.0318
##      7        0.6333             nan     0.1000    0.0260
##      8        0.5844             nan     0.1000    0.0241
##      9        0.5419             nan     0.1000    0.0179
##     10        0.5079             nan     0.1000    0.0152
##     20        0.2765             nan     0.1000    0.0045
##     40        0.1446             nan     0.1000   -0.0006
##     60        0.0992             nan     0.1000   -0.0004
##     80        0.0768             nan     0.1000   -0.0003
##    100        0.0569             nan     0.1000   -0.0006
##    120        0.0445             nan     0.1000   -0.0003
##    140        0.0362             nan     0.1000   -0.0001
##    160        0.0296             nan     0.1000   -0.0004
##    180        0.0250             nan     0.1000   -0.0003
##    200        0.0216             nan     0.1000   -0.0003
##    220        0.0186             nan     0.1000   -0.0002
##    240        0.0160             nan     0.1000   -0.0002
##    260        0.0137             nan     0.1000   -0.0002
##    280        0.0120             nan     0.1000   -0.0001
##    300        0.0104             nan     0.1000   -0.0002
##    320        0.0088             nan     0.1000    0.0000
##    340        0.0076             nan     0.1000   -0.0001
##    360        0.0066             nan     0.1000   -0.0001
##    380        0.0054             nan     0.1000   -0.0000
##    400        0.0048             nan     0.1000   -0.0000
##    420        0.0042             nan     0.1000   -0.0001
##    440        0.0035             nan     0.1000   -0.0001
##    460        0.0030             nan     0.1000   -0.0000
##    480        0.0026             nan     0.1000   -0.0000
##    500        0.0023             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1380             nan     0.1000    0.0745
##      2        1.0151             nan     0.1000    0.0609
##      3        0.9111             nan     0.1000    0.0507
##      4        0.8246             nan     0.1000    0.0388
##      5        0.7497             nan     0.1000    0.0348
##      6        0.6838             nan     0.1000    0.0318
##      7        0.6301             nan     0.1000    0.0260
##      8        0.5768             nan     0.1000    0.0258
##      9        0.5342             nan     0.1000    0.0171
##     10        0.4962             nan     0.1000    0.0160
##     20        0.2672             nan     0.1000    0.0028
##     40        0.1320             nan     0.1000   -0.0007
##     60        0.0829             nan     0.1000   -0.0009
##     80        0.0599             nan     0.1000   -0.0007
##    100        0.0443             nan     0.1000   -0.0002
##    120        0.0336             nan     0.1000   -0.0005
##    140        0.0261             nan     0.1000   -0.0002
##    160        0.0201             nan     0.1000   -0.0002
##    180        0.0165             nan     0.1000   -0.0002
##    200        0.0123             nan     0.1000   -0.0000
##    220        0.0096             nan     0.1000   -0.0001
##    240        0.0078             nan     0.1000   -0.0000
##    260        0.0061             nan     0.1000   -0.0000
##    280        0.0050             nan     0.1000   -0.0000
##    300        0.0040             nan     0.1000   -0.0000
##    320        0.0032             nan     0.1000   -0.0000
##    340        0.0025             nan     0.1000   -0.0000
##    360        0.0019             nan     0.1000   -0.0000
##    380        0.0016             nan     0.1000   -0.0000
##    400        0.0013             nan     0.1000   -0.0000
##    420        0.0010             nan     0.1000   -0.0000
##    440        0.0009             nan     0.1000   -0.0000
##    460        0.0008             nan     0.1000   -0.0000
##    480        0.0007             nan     0.1000   -0.0000
##    500        0.0005             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1362             nan     0.1000    0.0781
##      2        1.0087             nan     0.1000    0.0624
##      3        0.8981             nan     0.1000    0.0531
##      4        0.8123             nan     0.1000    0.0414
##      5        0.7390             nan     0.1000    0.0332
##      6        0.6771             nan     0.1000    0.0292
##      7        0.6219             nan     0.1000    0.0254
##      8        0.5681             nan     0.1000    0.0241
##      9        0.5241             nan     0.1000    0.0211
##     10        0.4851             nan     0.1000    0.0180
##     20        0.2645             nan     0.1000    0.0039
##     40        0.1160             nan     0.1000   -0.0017
##     60        0.0678             nan     0.1000    0.0004
##     80        0.0452             nan     0.1000   -0.0000
##    100        0.0320             nan     0.1000   -0.0005
##    120        0.0241             nan     0.1000   -0.0002
##    140        0.0187             nan     0.1000   -0.0002
##    160        0.0139             nan     0.1000   -0.0001
##    180        0.0105             nan     0.1000   -0.0000
##    200        0.0078             nan     0.1000   -0.0001
##    220        0.0063             nan     0.1000   -0.0001
##    240        0.0045             nan     0.1000   -0.0000
##    260        0.0034             nan     0.1000   -0.0000
##    280        0.0027             nan     0.1000   -0.0000
##    300        0.0022             nan     0.1000   -0.0001
##    320        0.0019             nan     0.1000   -0.0000
##    340        0.0014             nan     0.1000   -0.0000
##    360        0.0011             nan     0.1000   -0.0000
##    380        0.0008             nan     0.1000   -0.0000
##    400        0.0006             nan     0.1000   -0.0000
##    420        0.0005             nan     0.1000   -0.0000
##    440        0.0004             nan     0.1000   -0.0000
##    460        0.0003             nan     0.1000   -0.0000
##    480        0.0002             nan     0.1000   -0.0000
##    500        0.0002             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1368             nan     0.1000    0.0740
##      2        1.0143             nan     0.1000    0.0581
##      3        0.9146             nan     0.1000    0.0474
##      4        0.8273             nan     0.1000    0.0431
##      5        0.7535             nan     0.1000    0.0343
##      6        0.6916             nan     0.1000    0.0293
##      7        0.6344             nan     0.1000    0.0249
##      8        0.5814             nan     0.1000    0.0239
##      9        0.5391             nan     0.1000    0.0180
##     10        0.5006             nan     0.1000    0.0150
##     20        0.2654             nan     0.1000    0.0034
##     40        0.1111             nan     0.1000   -0.0015
##     60        0.0611             nan     0.1000   -0.0007
##     80        0.0404             nan     0.1000    0.0000
##    100        0.0252             nan     0.1000   -0.0001
##    120        0.0189             nan     0.1000   -0.0006
##    140        0.0139             nan     0.1000   -0.0002
##    160        0.0103             nan     0.1000   -0.0001
##    180        0.0071             nan     0.1000   -0.0001
##    200        0.0053             nan     0.1000   -0.0000
##    220        0.0039             nan     0.1000   -0.0000
##    240        0.0027             nan     0.1000    0.0000
##    260        0.0020             nan     0.1000   -0.0000
##    280        0.0015             nan     0.1000   -0.0000
##    300        0.0010             nan     0.1000   -0.0000
##    320        0.0007             nan     0.1000   -0.0000
##    340        0.0005             nan     0.1000   -0.0000
##    360        0.0004             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000    0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1362             nan     0.1000    0.0753
##      2        1.0097             nan     0.1000    0.0619
##      3        0.9048             nan     0.1000    0.0515
##      4        0.8157             nan     0.1000    0.0408
##      5        0.7377             nan     0.1000    0.0370
##      6        0.6757             nan     0.1000    0.0299
##      7        0.6180             nan     0.1000    0.0273
##      8        0.5687             nan     0.1000    0.0226
##      9        0.5281             nan     0.1000    0.0168
##     10        0.4904             nan     0.1000    0.0161
##     20        0.2650             nan     0.1000    0.0044
##     40        0.1114             nan     0.1000   -0.0012
##     60        0.0652             nan     0.1000   -0.0011
##     80        0.0388             nan     0.1000   -0.0002
##    100        0.0227             nan     0.1000   -0.0003
##    120        0.0159             nan     0.1000   -0.0003
##    140        0.0118             nan     0.1000   -0.0003
##    160        0.0084             nan     0.1000   -0.0001
##    180        0.0062             nan     0.1000   -0.0000
##    200        0.0046             nan     0.1000   -0.0001
##    220        0.0032             nan     0.1000   -0.0001
##    240        0.0023             nan     0.1000   -0.0000
##    260        0.0017             nan     0.1000   -0.0000
##    280        0.0010             nan     0.1000   -0.0000
##    300        0.0008             nan     0.1000   -0.0000
##    320        0.0006             nan     0.1000   -0.0000
##    340        0.0004             nan     0.1000   -0.0000
##    360        0.0003             nan     0.1000   -0.0000
##    380        0.0002             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0001             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1338             nan     0.1000    0.0751
##      2        1.0053             nan     0.1000    0.0581
##      3        0.9014             nan     0.1000    0.0491
##      4        0.8204             nan     0.1000    0.0394
##      5        0.7485             nan     0.1000    0.0339
##      6        0.6793             nan     0.1000    0.0328
##      7        0.6213             nan     0.1000    0.0279
##      8        0.5710             nan     0.1000    0.0228
##      9        0.5266             nan     0.1000    0.0200
##     10        0.4876             nan     0.1000    0.0182
##     20        0.2600             nan     0.1000    0.0037
##     40        0.1073             nan     0.1000    0.0005
##     60        0.0607             nan     0.1000   -0.0004
##     80        0.0374             nan     0.1000   -0.0009
##    100        0.0245             nan     0.1000   -0.0000
##    120        0.0169             nan     0.1000   -0.0003
##    140        0.0099             nan     0.1000   -0.0002
##    160        0.0069             nan     0.1000    0.0000
##    180        0.0048             nan     0.1000   -0.0000
##    200        0.0038             nan     0.1000   -0.0001
##    220        0.0027             nan     0.1000    0.0000
##    240        0.0017             nan     0.1000   -0.0000
##    260        0.0012             nan     0.1000   -0.0000
##    280        0.0009             nan     0.1000   -0.0000
##    300        0.0007             nan     0.1000   -0.0000
##    320        0.0005             nan     0.1000   -0.0000
##    340        0.0004             nan     0.1000   -0.0000
##    360        0.0004             nan     0.1000   -0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1314             nan     0.1000    0.0719
##      2        1.0112             nan     0.1000    0.0607
##      3        0.9147             nan     0.1000    0.0448
##      4        0.8263             nan     0.1000    0.0416
##      5        0.7520             nan     0.1000    0.0375
##      6        0.6875             nan     0.1000    0.0291
##      7        0.6299             nan     0.1000    0.0272
##      8        0.5805             nan     0.1000    0.0224
##      9        0.5349             nan     0.1000    0.0193
##     10        0.4987             nan     0.1000    0.0153
##     20        0.2555             nan     0.1000    0.0051
##     40        0.0999             nan     0.1000    0.0014
##     60        0.0533             nan     0.1000   -0.0008
##     80        0.0325             nan     0.1000   -0.0004
##    100        0.0219             nan     0.1000   -0.0001
##    120        0.0159             nan     0.1000    0.0000
##    140        0.0099             nan     0.1000   -0.0003
##    160        0.0079             nan     0.1000   -0.0003
##    180        0.0054             nan     0.1000   -0.0002
##    200        0.0033             nan     0.1000   -0.0000
##    220        0.0022             nan     0.1000   -0.0000
##    240        0.0018             nan     0.1000   -0.0001
##    260        0.0013             nan     0.1000   -0.0000
##    280        0.0010             nan     0.1000    0.0000
##    300        0.0007             nan     0.1000   -0.0000
##    320        0.0006             nan     0.1000   -0.0000
##    340        0.0004             nan     0.1000   -0.0000
##    360        0.0003             nan     0.1000   -0.0000
##    380        0.0002             nan     0.1000   -0.0000
##    400        0.0001             nan     0.1000   -0.0000
##    420        0.0001             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1379             nan     0.1000    0.0704
##      2        1.0121             nan     0.1000    0.0599
##      3        0.9038             nan     0.1000    0.0500
##      4        0.8196             nan     0.1000    0.0421
##      5        0.7441             nan     0.1000    0.0339
##      6        0.6851             nan     0.1000    0.0267
##      7        0.6277             nan     0.1000    0.0271
##      8        0.5790             nan     0.1000    0.0206
##      9        0.5351             nan     0.1000    0.0204
##     10        0.4976             nan     0.1000    0.0161
##     20        0.2644             nan     0.1000    0.0048
##     40        0.1094             nan     0.1000    0.0002
##     60        0.0598             nan     0.1000   -0.0009
##     80        0.0374             nan     0.1000    0.0001
##    100        0.0245             nan     0.1000   -0.0002
##    120        0.0168             nan     0.1000   -0.0003
##    140        0.0118             nan     0.1000   -0.0003
##    160        0.0087             nan     0.1000   -0.0002
##    180        0.0062             nan     0.1000    0.0000
##    200        0.0043             nan     0.1000   -0.0000
##    220        0.0030             nan     0.1000   -0.0000
##    240        0.0021             nan     0.1000    0.0000
##    260        0.0016             nan     0.1000   -0.0000
##    280        0.0012             nan     0.1000   -0.0000
##    300        0.0008             nan     0.1000   -0.0000
##    320        0.0007             nan     0.1000   -0.0000
##    340        0.0005             nan     0.1000   -0.0000
##    360        0.0004             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1483             nan     0.1000    0.0660
##      2        1.0427             nan     0.1000    0.0513
##      3        0.9512             nan     0.1000    0.0461
##      4        0.8777             nan     0.1000    0.0373
##      5        0.8136             nan     0.1000    0.0320
##      6        0.7544             nan     0.1000    0.0285
##      7        0.7039             nan     0.1000    0.0226
##      8        0.6653             nan     0.1000    0.0171
##      9        0.6268             nan     0.1000    0.0173
##     10        0.5916             nan     0.1000    0.0158
##     20        0.3829             nan     0.1000    0.0056
##     40        0.2474             nan     0.1000    0.0008
##     60        0.2045             nan     0.1000    0.0008
##     80        0.1797             nan     0.1000   -0.0003
##    100        0.1651             nan     0.1000   -0.0008
##    120        0.1514             nan     0.1000   -0.0006
##    140        0.1451             nan     0.1000   -0.0007
##    160        0.1360             nan     0.1000   -0.0004
##    180        0.1307             nan     0.1000   -0.0002
##    200        0.1278             nan     0.1000   -0.0006
##    220        0.1229             nan     0.1000   -0.0018
##    240        0.1167             nan     0.1000   -0.0009
##    260        0.1144             nan     0.1000   -0.0021
##    280        0.1119             nan     0.1000   -0.0006
##    300        0.1065             nan     0.1000   -0.0010
##    320        0.1034             nan     0.1000   -0.0010
##    340        0.0993             nan     0.1000   -0.0008
##    360        0.0994             nan     0.1000   -0.0019
##    380        0.0979             nan     0.1000   -0.0005
##    400        0.0972             nan     0.1000   -0.0005
##    420        0.0957             nan     0.1000   -0.0008
##    440        0.0936             nan     0.1000   -0.0011
##    460        0.0926             nan     0.1000   -0.0005
##    480        0.0923             nan     0.1000   -0.0004
##    500        0.0918             nan     0.1000   -0.0006
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1342             nan     0.1000    0.0714
##      2        1.0162             nan     0.1000    0.0592
##      3        0.9188             nan     0.1000    0.0460
##      4        0.8413             nan     0.1000    0.0370
##      5        0.7696             nan     0.1000    0.0350
##      6        0.7082             nan     0.1000    0.0279
##      7        0.6599             nan     0.1000    0.0223
##      8        0.6125             nan     0.1000    0.0225
##      9        0.5724             nan     0.1000    0.0190
##     10        0.5379             nan     0.1000    0.0143
##     20        0.3182             nan     0.1000    0.0055
##     40        0.1896             nan     0.1000   -0.0005
##     60        0.1514             nan     0.1000   -0.0008
##     80        0.1264             nan     0.1000   -0.0013
##    100        0.1106             nan     0.1000   -0.0003
##    120        0.0989             nan     0.1000   -0.0006
##    140        0.0863             nan     0.1000   -0.0004
##    160        0.0755             nan     0.1000   -0.0004
##    180        0.0664             nan     0.1000   -0.0003
##    200        0.0601             nan     0.1000   -0.0004
##    220        0.0549             nan     0.1000   -0.0003
##    240        0.0501             nan     0.1000   -0.0004
##    260        0.0459             nan     0.1000   -0.0005
##    280        0.0414             nan     0.1000   -0.0003
##    300        0.0383             nan     0.1000   -0.0004
##    320        0.0353             nan     0.1000   -0.0003
##    340        0.0323             nan     0.1000   -0.0002
##    360        0.0296             nan     0.1000   -0.0002
##    380        0.0279             nan     0.1000   -0.0002
##    400        0.0265             nan     0.1000   -0.0002
##    420        0.0241             nan     0.1000   -0.0001
##    440        0.0222             nan     0.1000   -0.0001
##    460        0.0201             nan     0.1000   -0.0002
##    480        0.0185             nan     0.1000   -0.0002
##    500        0.0164             nan     0.1000   -0.0001
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1377             nan     0.1000    0.0749
##      2        1.0149             nan     0.1000    0.0601
##      3        0.9131             nan     0.1000    0.0486
##      4        0.8280             nan     0.1000    0.0357
##      5        0.7546             nan     0.1000    0.0372
##      6        0.6949             nan     0.1000    0.0270
##      7        0.6405             nan     0.1000    0.0255
##      8        0.5907             nan     0.1000    0.0226
##      9        0.5499             nan     0.1000    0.0184
##     10        0.5107             nan     0.1000    0.0177
##     20        0.2912             nan     0.1000    0.0062
##     40        0.1619             nan     0.1000   -0.0012
##     60        0.1097             nan     0.1000    0.0009
##     80        0.0842             nan     0.1000   -0.0006
##    100        0.0684             nan     0.1000   -0.0010
##    120        0.0564             nan     0.1000   -0.0008
##    140        0.0471             nan     0.1000   -0.0003
##    160        0.0407             nan     0.1000   -0.0004
##    180        0.0319             nan     0.1000   -0.0001
##    200        0.0251             nan     0.1000   -0.0001
##    220        0.0206             nan     0.1000   -0.0001
##    240        0.0177             nan     0.1000   -0.0002
##    260        0.0156             nan     0.1000   -0.0001
##    280        0.0134             nan     0.1000   -0.0001
##    300        0.0115             nan     0.1000   -0.0001
##    320        0.0101             nan     0.1000   -0.0001
##    340        0.0088             nan     0.1000   -0.0001
##    360        0.0076             nan     0.1000   -0.0001
##    380        0.0065             nan     0.1000   -0.0001
##    400        0.0056             nan     0.1000   -0.0000
##    420        0.0048             nan     0.1000   -0.0000
##    440        0.0042             nan     0.1000   -0.0000
##    460        0.0037             nan     0.1000   -0.0000
##    480        0.0032             nan     0.1000   -0.0000
##    500        0.0028             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1268             nan     0.1000    0.0769
##      2        1.0068             nan     0.1000    0.0570
##      3        0.9047             nan     0.1000    0.0476
##      4        0.8201             nan     0.1000    0.0398
##      5        0.7439             nan     0.1000    0.0367
##      6        0.6816             nan     0.1000    0.0286
##      7        0.6296             nan     0.1000    0.0219
##      8        0.5793             nan     0.1000    0.0221
##      9        0.5404             nan     0.1000    0.0165
##     10        0.5041             nan     0.1000    0.0171
##     20        0.2851             nan     0.1000    0.0053
##     40        0.1446             nan     0.1000    0.0006
##     60        0.0930             nan     0.1000    0.0005
##     80        0.0681             nan     0.1000   -0.0009
##    100        0.0512             nan     0.1000   -0.0005
##    120        0.0398             nan     0.1000   -0.0002
##    140        0.0323             nan     0.1000   -0.0002
##    160        0.0259             nan     0.1000   -0.0000
##    180        0.0222             nan     0.1000   -0.0004
##    200        0.0176             nan     0.1000   -0.0001
##    220        0.0151             nan     0.1000   -0.0002
##    240        0.0125             nan     0.1000   -0.0000
##    260        0.0107             nan     0.1000   -0.0001
##    280        0.0081             nan     0.1000   -0.0000
##    300        0.0063             nan     0.1000   -0.0000
##    320        0.0052             nan     0.1000   -0.0001
##    340        0.0042             nan     0.1000   -0.0000
##    360        0.0035             nan     0.1000   -0.0000
##    380        0.0029             nan     0.1000   -0.0000
##    400        0.0025             nan     0.1000   -0.0001
##    420        0.0020             nan     0.1000   -0.0000
##    440        0.0016             nan     0.1000   -0.0000
##    460        0.0013             nan     0.1000   -0.0000
##    480        0.0011             nan     0.1000   -0.0000
##    500        0.0009             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1352             nan     0.1000    0.0716
##      2        1.0122             nan     0.1000    0.0583
##      3        0.9094             nan     0.1000    0.0471
##      4        0.8230             nan     0.1000    0.0373
##      5        0.7545             nan     0.1000    0.0325
##      6        0.6911             nan     0.1000    0.0294
##      7        0.6316             nan     0.1000    0.0252
##      8        0.5823             nan     0.1000    0.0214
##      9        0.5387             nan     0.1000    0.0202
##     10        0.5056             nan     0.1000    0.0130
##     20        0.2824             nan     0.1000    0.0043
##     40        0.1389             nan     0.1000   -0.0007
##     60        0.0873             nan     0.1000   -0.0008
##     80        0.0552             nan     0.1000   -0.0003
##    100        0.0419             nan     0.1000   -0.0006
##    120        0.0289             nan     0.1000   -0.0005
##    140        0.0218             nan     0.1000   -0.0002
##    160        0.0169             nan     0.1000   -0.0001
##    180        0.0129             nan     0.1000   -0.0002
##    200        0.0104             nan     0.1000   -0.0002
##    220        0.0080             nan     0.1000   -0.0001
##    240        0.0059             nan     0.1000   -0.0001
##    260        0.0045             nan     0.1000   -0.0001
##    280        0.0036             nan     0.1000    0.0000
##    300        0.0029             nan     0.1000   -0.0000
##    320        0.0020             nan     0.1000   -0.0000
##    340        0.0016             nan     0.1000   -0.0000
##    360        0.0013             nan     0.1000   -0.0000
##    380        0.0010             nan     0.1000   -0.0000
##    400        0.0008             nan     0.1000    0.0000
##    420        0.0006             nan     0.1000   -0.0000
##    440        0.0005             nan     0.1000   -0.0000
##    460        0.0004             nan     0.1000   -0.0000
##    480        0.0003             nan     0.1000    0.0000
##    500        0.0003             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1333             nan     0.1000    0.0751
##      2        1.0092             nan     0.1000    0.0595
##      3        0.9123             nan     0.1000    0.0440
##      4        0.8287             nan     0.1000    0.0417
##      5        0.7558             nan     0.1000    0.0347
##      6        0.6900             nan     0.1000    0.0303
##      7        0.6355             nan     0.1000    0.0240
##      8        0.5864             nan     0.1000    0.0234
##      9        0.5414             nan     0.1000    0.0224
##     10        0.5033             nan     0.1000    0.0157
##     20        0.2783             nan     0.1000    0.0038
##     40        0.1241             nan     0.1000    0.0006
##     60        0.0721             nan     0.1000   -0.0009
##     80        0.0503             nan     0.1000   -0.0013
##    100        0.0384             nan     0.1000   -0.0006
##    120        0.0283             nan     0.1000   -0.0006
##    140        0.0206             nan     0.1000   -0.0002
##    160        0.0140             nan     0.1000   -0.0002
##    180        0.0105             nan     0.1000   -0.0002
##    200        0.0077             nan     0.1000   -0.0001
##    220        0.0060             nan     0.1000   -0.0002
##    240        0.0044             nan     0.1000   -0.0001
##    260        0.0032             nan     0.1000   -0.0000
##    280        0.0026             nan     0.1000   -0.0000
##    300        0.0018             nan     0.1000   -0.0000
##    320        0.0015             nan     0.1000   -0.0000
##    340        0.0011             nan     0.1000   -0.0000
##    360        0.0008             nan     0.1000   -0.0000
##    380        0.0006             nan     0.1000   -0.0000
##    400        0.0004             nan     0.1000   -0.0000
##    420        0.0004             nan     0.1000   -0.0000
##    440        0.0003             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0002             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1362             nan     0.1000    0.0723
##      2        1.0098             nan     0.1000    0.0587
##      3        0.9041             nan     0.1000    0.0466
##      4        0.8182             nan     0.1000    0.0382
##      5        0.7424             nan     0.1000    0.0329
##      6        0.6810             nan     0.1000    0.0280
##      7        0.6232             nan     0.1000    0.0262
##      8        0.5743             nan     0.1000    0.0235
##      9        0.5331             nan     0.1000    0.0177
##     10        0.4973             nan     0.1000    0.0146
##     20        0.2697             nan     0.1000    0.0046
##     40        0.1188             nan     0.1000   -0.0001
##     60        0.0684             nan     0.1000   -0.0007
##     80        0.0465             nan     0.1000   -0.0004
##    100        0.0302             nan     0.1000   -0.0011
##    120        0.0219             nan     0.1000   -0.0004
##    140        0.0152             nan     0.1000   -0.0000
##    160        0.0094             nan     0.1000   -0.0000
##    180        0.0073             nan     0.1000   -0.0001
##    200        0.0050             nan     0.1000   -0.0001
##    220        0.0039             nan     0.1000   -0.0001
##    240        0.0030             nan     0.1000   -0.0001
##    260        0.0023             nan     0.1000   -0.0000
##    280        0.0019             nan     0.1000   -0.0001
##    300        0.0013             nan     0.1000   -0.0000
##    320        0.0010             nan     0.1000    0.0000
##    340        0.0007             nan     0.1000   -0.0000
##    360        0.0005             nan     0.1000   -0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000    0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1354             nan     0.1000    0.0743
##      2        1.0105             nan     0.1000    0.0568
##      3        0.9111             nan     0.1000    0.0497
##      4        0.8276             nan     0.1000    0.0390
##      5        0.7478             nan     0.1000    0.0355
##      6        0.6883             nan     0.1000    0.0266
##      7        0.6312             nan     0.1000    0.0261
##      8        0.5831             nan     0.1000    0.0207
##      9        0.5384             nan     0.1000    0.0191
##     10        0.4979             nan     0.1000    0.0182
##     20        0.2739             nan     0.1000    0.0052
##     40        0.1147             nan     0.1000   -0.0002
##     60        0.0631             nan     0.1000   -0.0010
##     80        0.0405             nan     0.1000   -0.0006
##    100        0.0281             nan     0.1000   -0.0005
##    120        0.0199             nan     0.1000   -0.0002
##    140        0.0140             nan     0.1000   -0.0001
##    160        0.0092             nan     0.1000   -0.0002
##    180        0.0076             nan     0.1000   -0.0001
##    200        0.0055             nan     0.1000   -0.0001
##    220        0.0037             nan     0.1000   -0.0001
##    240        0.0031             nan     0.1000   -0.0001
##    260        0.0022             nan     0.1000   -0.0001
##    280        0.0015             nan     0.1000   -0.0000
##    300        0.0011             nan     0.1000   -0.0000
##    320        0.0008             nan     0.1000   -0.0000
##    340        0.0005             nan     0.1000   -0.0000
##    360        0.0005             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000    0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1390             nan     0.1000    0.0741
##      2        1.0180             nan     0.1000    0.0554
##      3        0.9125             nan     0.1000    0.0502
##      4        0.8252             nan     0.1000    0.0412
##      5        0.7554             nan     0.1000    0.0328
##      6        0.6921             nan     0.1000    0.0283
##      7        0.6320             nan     0.1000    0.0265
##      8        0.5874             nan     0.1000    0.0192
##      9        0.5427             nan     0.1000    0.0184
##     10        0.4980             nan     0.1000    0.0204
##     20        0.2686             nan     0.1000    0.0047
##     40        0.1162             nan     0.1000    0.0004
##     60        0.0619             nan     0.1000   -0.0006
##     80        0.0402             nan     0.1000   -0.0001
##    100        0.0251             nan     0.1000   -0.0005
##    120        0.0171             nan     0.1000   -0.0002
##    140        0.0119             nan     0.1000   -0.0001
##    160        0.0089             nan     0.1000   -0.0002
##    180        0.0062             nan     0.1000   -0.0001
##    200        0.0047             nan     0.1000   -0.0001
##    220        0.0039             nan     0.1000   -0.0001
##    240        0.0030             nan     0.1000   -0.0000
##    260        0.0022             nan     0.1000   -0.0000
##    280        0.0016             nan     0.1000   -0.0000
##    300        0.0011             nan     0.1000   -0.0000
##    320        0.0008             nan     0.1000   -0.0000
##    340        0.0005             nan     0.1000   -0.0000
##    360        0.0005             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1418             nan     0.1000    0.0772
##      2        1.0167             nan     0.1000    0.0577
##      3        0.9129             nan     0.1000    0.0548
##      4        0.8249             nan     0.1000    0.0420
##      5        0.7461             nan     0.1000    0.0346
##      6        0.6801             nan     0.1000    0.0313
##      7        0.6274             nan     0.1000    0.0240
##      8        0.5797             nan     0.1000    0.0199
##      9        0.5373             nan     0.1000    0.0196
##     10        0.4990             nan     0.1000    0.0156
##     20        0.2792             nan     0.1000    0.0049
##     40        0.1227             nan     0.1000   -0.0002
##     60        0.0641             nan     0.1000   -0.0010
##     80        0.0406             nan     0.1000   -0.0008
##    100        0.0251             nan     0.1000   -0.0006
##    120        0.0175             nan     0.1000   -0.0001
##    140        0.0115             nan     0.1000   -0.0001
##    160        0.0081             nan     0.1000   -0.0001
##    180        0.0068             nan     0.1000   -0.0002
##    200        0.0052             nan     0.1000   -0.0002
##    220        0.0039             nan     0.1000   -0.0000
##    240        0.0031             nan     0.1000   -0.0000
##    260        0.0021             nan     0.1000   -0.0000
##    280        0.0015             nan     0.1000   -0.0000
##    300        0.0012             nan     0.1000   -0.0000
##    320        0.0009             nan     0.1000   -0.0000
##    340        0.0009             nan     0.1000   -0.0000
##    360        0.0009             nan     0.1000   -0.0000
##    380        0.0006             nan     0.1000   -0.0000
##    400        0.0005             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000    0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1613             nan     0.1000    0.0631
##      2        1.0553             nan     0.1000    0.0510
##      3        0.9610             nan     0.1000    0.0491
##      4        0.8846             nan     0.1000    0.0379
##      5        0.8118             nan     0.1000    0.0345
##      6        0.7602             nan     0.1000    0.0245
##      7        0.7073             nan     0.1000    0.0259
##      8        0.6631             nan     0.1000    0.0225
##      9        0.6241             nan     0.1000    0.0169
##     10        0.5903             nan     0.1000    0.0164
##     20        0.3859             nan     0.1000    0.0043
##     40        0.2497             nan     0.1000    0.0005
##     60        0.2098             nan     0.1000   -0.0008
##     80        0.1830             nan     0.1000   -0.0007
##    100        0.1686             nan     0.1000    0.0005
##    120        0.1521             nan     0.1000   -0.0010
##    140        0.1449             nan     0.1000   -0.0005
##    160        0.1401             nan     0.1000   -0.0011
##    180        0.1351             nan     0.1000   -0.0015
##    200        0.1268             nan     0.1000   -0.0006
##    220        0.1199             nan     0.1000   -0.0009
##    240        0.1158             nan     0.1000   -0.0002
##    260        0.1141             nan     0.1000   -0.0010
##    280        0.1134             nan     0.1000   -0.0014
##    300        0.1097             nan     0.1000   -0.0008
##    320        0.1084             nan     0.1000   -0.0013
##    340        0.1054             nan     0.1000   -0.0008
##    360        0.1041             nan     0.1000   -0.0016
##    380        0.1037             nan     0.1000   -0.0007
##    400        0.0989             nan     0.1000   -0.0002
##    420        0.0985             nan     0.1000   -0.0004
##    440        0.0962             nan     0.1000   -0.0007
##    460        0.0965             nan     0.1000   -0.0014
##    480        0.0955             nan     0.1000   -0.0010
##    500        0.0944             nan     0.1000   -0.0005
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1341             nan     0.1000    0.0735
##      2        1.0147             nan     0.1000    0.0594
##      3        0.9153             nan     0.1000    0.0488
##      4        0.8325             nan     0.1000    0.0409
##      5        0.7605             nan     0.1000    0.0346
##      6        0.6995             nan     0.1000    0.0300
##      7        0.6503             nan     0.1000    0.0233
##      8        0.6041             nan     0.1000    0.0213
##      9        0.5624             nan     0.1000    0.0186
##     10        0.5236             nan     0.1000    0.0182
##     20        0.3140             nan     0.1000    0.0027
##     40        0.1830             nan     0.1000   -0.0013
##     60        0.1434             nan     0.1000    0.0002
##     80        0.1211             nan     0.1000   -0.0006
##    100        0.1018             nan     0.1000   -0.0007
##    120        0.0883             nan     0.1000   -0.0012
##    140        0.0757             nan     0.1000   -0.0011
##    160        0.0666             nan     0.1000   -0.0011
##    180        0.0591             nan     0.1000   -0.0001
##    200        0.0528             nan     0.1000   -0.0004
##    220        0.0466             nan     0.1000   -0.0004
##    240        0.0430             nan     0.1000   -0.0002
##    260        0.0387             nan     0.1000    0.0000
##    280        0.0352             nan     0.1000   -0.0005
##    300        0.0315             nan     0.1000   -0.0003
##    320        0.0282             nan     0.1000   -0.0004
##    340        0.0253             nan     0.1000   -0.0001
##    360        0.0235             nan     0.1000   -0.0002
##    380        0.0212             nan     0.1000   -0.0001
##    400        0.0190             nan     0.1000   -0.0000
##    420        0.0171             nan     0.1000   -0.0001
##    440        0.0162             nan     0.1000   -0.0001
##    460        0.0152             nan     0.1000   -0.0002
##    480        0.0143             nan     0.1000   -0.0002
##    500        0.0133             nan     0.1000   -0.0001
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1365             nan     0.1000    0.0771
##      2        1.0120             nan     0.1000    0.0640
##      3        0.9064             nan     0.1000    0.0484
##      4        0.8233             nan     0.1000    0.0408
##      5        0.7522             nan     0.1000    0.0344
##      6        0.6931             nan     0.1000    0.0284
##      7        0.6385             nan     0.1000    0.0260
##      8        0.5885             nan     0.1000    0.0225
##      9        0.5415             nan     0.1000    0.0205
##     10        0.5010             nan     0.1000    0.0176
##     20        0.2841             nan     0.1000    0.0055
##     40        0.1578             nan     0.1000   -0.0015
##     60        0.1146             nan     0.1000   -0.0010
##     80        0.0890             nan     0.1000    0.0001
##    100        0.0688             nan     0.1000   -0.0005
##    120        0.0555             nan     0.1000   -0.0006
##    140        0.0441             nan     0.1000    0.0000
##    160        0.0351             nan     0.1000   -0.0003
##    180        0.0279             nan     0.1000   -0.0002
##    200        0.0236             nan     0.1000   -0.0002
##    220        0.0208             nan     0.1000   -0.0002
##    240        0.0175             nan     0.1000   -0.0001
##    260        0.0150             nan     0.1000   -0.0002
##    280        0.0130             nan     0.1000   -0.0002
##    300        0.0107             nan     0.1000   -0.0001
##    320        0.0093             nan     0.1000   -0.0002
##    340        0.0081             nan     0.1000   -0.0000
##    360        0.0071             nan     0.1000   -0.0000
##    380        0.0061             nan     0.1000   -0.0001
##    400        0.0051             nan     0.1000   -0.0001
##    420        0.0044             nan     0.1000   -0.0000
##    440        0.0037             nan     0.1000   -0.0001
##    460        0.0032             nan     0.1000   -0.0001
##    480        0.0028             nan     0.1000   -0.0000
##    500        0.0023             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1443             nan     0.1000    0.0686
##      2        1.0194             nan     0.1000    0.0593
##      3        0.9210             nan     0.1000    0.0477
##      4        0.8396             nan     0.1000    0.0388
##      5        0.7628             nan     0.1000    0.0363
##      6        0.6994             nan     0.1000    0.0309
##      7        0.6436             nan     0.1000    0.0246
##      8        0.5874             nan     0.1000    0.0243
##      9        0.5467             nan     0.1000    0.0193
##     10        0.5093             nan     0.1000    0.0171
##     20        0.2871             nan     0.1000    0.0045
##     40        0.1422             nan     0.1000    0.0013
##     60        0.0895             nan     0.1000   -0.0008
##     80        0.0663             nan     0.1000   -0.0008
##    100        0.0490             nan     0.1000   -0.0002
##    120        0.0392             nan     0.1000   -0.0004
##    140        0.0319             nan     0.1000   -0.0004
##    160        0.0252             nan     0.1000   -0.0005
##    180        0.0190             nan     0.1000   -0.0003
##    200        0.0148             nan     0.1000   -0.0002
##    220        0.0117             nan     0.1000   -0.0001
##    240        0.0097             nan     0.1000   -0.0002
##    260        0.0074             nan     0.1000   -0.0001
##    280        0.0060             nan     0.1000   -0.0001
##    300        0.0048             nan     0.1000   -0.0000
##    320        0.0041             nan     0.1000   -0.0000
##    340        0.0032             nan     0.1000   -0.0000
##    360        0.0026             nan     0.1000   -0.0000
##    380        0.0022             nan     0.1000   -0.0000
##    400        0.0019             nan     0.1000   -0.0000
##    420        0.0015             nan     0.1000   -0.0000
##    440        0.0013             nan     0.1000   -0.0000
##    460        0.0011             nan     0.1000   -0.0000
##    480        0.0009             nan     0.1000   -0.0000
##    500        0.0007             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1342             nan     0.1000    0.0735
##      2        1.0106             nan     0.1000    0.0598
##      3        0.9114             nan     0.1000    0.0471
##      4        0.8277             nan     0.1000    0.0376
##      5        0.7512             nan     0.1000    0.0386
##      6        0.6900             nan     0.1000    0.0307
##      7        0.6335             nan     0.1000    0.0289
##      8        0.5867             nan     0.1000    0.0204
##      9        0.5398             nan     0.1000    0.0214
##     10        0.5033             nan     0.1000    0.0162
##     20        0.2769             nan     0.1000    0.0036
##     40        0.1218             nan     0.1000   -0.0012
##     60        0.0752             nan     0.1000   -0.0007
##     80        0.0535             nan     0.1000   -0.0010
##    100        0.0382             nan     0.1000   -0.0008
##    120        0.0290             nan     0.1000   -0.0004
##    140        0.0206             nan     0.1000   -0.0002
##    160        0.0168             nan     0.1000   -0.0003
##    180        0.0120             nan     0.1000   -0.0001
##    200        0.0086             nan     0.1000   -0.0000
##    220        0.0067             nan     0.1000   -0.0001
##    240        0.0050             nan     0.1000   -0.0000
##    260        0.0040             nan     0.1000   -0.0000
##    280        0.0031             nan     0.1000   -0.0001
##    300        0.0023             nan     0.1000   -0.0000
##    320        0.0017             nan     0.1000   -0.0000
##    340        0.0013             nan     0.1000   -0.0000
##    360        0.0010             nan     0.1000   -0.0000
##    380        0.0007             nan     0.1000   -0.0000
##    400        0.0005             nan     0.1000   -0.0000
##    420        0.0005             nan     0.1000   -0.0000
##    440        0.0004             nan     0.1000   -0.0000
##    460        0.0003             nan     0.1000   -0.0000
##    480        0.0002             nan     0.1000   -0.0000
##    500        0.0002             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1350             nan     0.1000    0.0694
##      2        1.0050             nan     0.1000    0.0577
##      3        0.8994             nan     0.1000    0.0495
##      4        0.8119             nan     0.1000    0.0426
##      5        0.7381             nan     0.1000    0.0333
##      6        0.6721             nan     0.1000    0.0318
##      7        0.6145             nan     0.1000    0.0228
##      8        0.5624             nan     0.1000    0.0232
##      9        0.5172             nan     0.1000    0.0190
##     10        0.4836             nan     0.1000    0.0127
##     20        0.2649             nan     0.1000    0.0023
##     40        0.1197             nan     0.1000   -0.0006
##     60        0.0728             nan     0.1000   -0.0016
##     80        0.0462             nan     0.1000   -0.0005
##    100        0.0326             nan     0.1000   -0.0001
##    120        0.0211             nan     0.1000   -0.0001
##    140        0.0155             nan     0.1000   -0.0001
##    160        0.0109             nan     0.1000   -0.0001
##    180        0.0082             nan     0.1000   -0.0001
##    200        0.0060             nan     0.1000   -0.0001
##    220        0.0044             nan     0.1000   -0.0000
##    240        0.0033             nan     0.1000   -0.0000
##    260        0.0024             nan     0.1000   -0.0000
##    280        0.0018             nan     0.1000   -0.0001
##    300        0.0014             nan     0.1000   -0.0000
##    320        0.0010             nan     0.1000   -0.0000
##    340        0.0008             nan     0.1000   -0.0000
##    360        0.0006             nan     0.1000   -0.0000
##    380        0.0005             nan     0.1000   -0.0000
##    400        0.0004             nan     0.1000   -0.0000
##    420        0.0004             nan     0.1000   -0.0000
##    440        0.0003             nan     0.1000   -0.0000
##    460        0.0003             nan     0.1000   -0.0000
##    480        0.0003             nan     0.1000   -0.0000
##    500        0.0002             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1292             nan     0.1000    0.0731
##      2        1.0025             nan     0.1000    0.0615
##      3        0.9037             nan     0.1000    0.0462
##      4        0.8177             nan     0.1000    0.0404
##      5        0.7445             nan     0.1000    0.0367
##      6        0.6832             nan     0.1000    0.0286
##      7        0.6326             nan     0.1000    0.0208
##      8        0.5858             nan     0.1000    0.0205
##      9        0.5412             nan     0.1000    0.0186
##     10        0.5031             nan     0.1000    0.0146
##     20        0.2703             nan     0.1000    0.0038
##     40        0.1143             nan     0.1000   -0.0011
##     60        0.0623             nan     0.1000   -0.0003
##     80        0.0390             nan     0.1000   -0.0003
##    100        0.0260             nan     0.1000   -0.0004
##    120        0.0172             nan     0.1000   -0.0003
##    140        0.0120             nan     0.1000   -0.0000
##    160        0.0086             nan     0.1000   -0.0001
##    180        0.0055             nan     0.1000   -0.0000
##    200        0.0043             nan     0.1000   -0.0001
##    220        0.0031             nan     0.1000   -0.0000
##    240        0.0025             nan     0.1000   -0.0001
##    260        0.0015             nan     0.1000   -0.0000
##    280        0.0012             nan     0.1000   -0.0000
##    300        0.0009             nan     0.1000   -0.0000
##    320        0.0007             nan     0.1000   -0.0000
##    340        0.0006             nan     0.1000   -0.0000
##    360        0.0005             nan     0.1000   -0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000    0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1288             nan     0.1000    0.0711
##      2        1.0064             nan     0.1000    0.0595
##      3        0.9036             nan     0.1000    0.0466
##      4        0.8216             nan     0.1000    0.0395
##      5        0.7497             nan     0.1000    0.0338
##      6        0.6853             nan     0.1000    0.0298
##      7        0.6338             nan     0.1000    0.0237
##      8        0.5863             nan     0.1000    0.0214
##      9        0.5397             nan     0.1000    0.0209
##     10        0.5025             nan     0.1000    0.0160
##     20        0.2693             nan     0.1000    0.0062
##     40        0.1143             nan     0.1000    0.0008
##     60        0.0619             nan     0.1000   -0.0014
##     80        0.0368             nan     0.1000   -0.0005
##    100        0.0252             nan     0.1000   -0.0001
##    120        0.0171             nan     0.1000   -0.0003
##    140        0.0129             nan     0.1000   -0.0004
##    160        0.0089             nan     0.1000    0.0000
##    180        0.0064             nan     0.1000   -0.0001
##    200        0.0049             nan     0.1000   -0.0001
##    220        0.0039             nan     0.1000    0.0000
##    240        0.0027             nan     0.1000   -0.0000
##    260        0.0021             nan     0.1000   -0.0000
##    280        0.0017             nan     0.1000   -0.0001
##    300        0.0012             nan     0.1000   -0.0000
##    320        0.0008             nan     0.1000    0.0000
##    340        0.0007             nan     0.1000   -0.0000
##    360        0.0005             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000    0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1356             nan     0.1000    0.0751
##      2        1.0164             nan     0.1000    0.0600
##      3        0.9132             nan     0.1000    0.0486
##      4        0.8236             nan     0.1000    0.0396
##      5        0.7520             nan     0.1000    0.0330
##      6        0.6900             nan     0.1000    0.0283
##      7        0.6317             nan     0.1000    0.0274
##      8        0.5851             nan     0.1000    0.0220
##      9        0.5400             nan     0.1000    0.0186
##     10        0.4985             nan     0.1000    0.0174
##     20        0.2714             nan     0.1000    0.0051
##     40        0.1090             nan     0.1000   -0.0012
##     60        0.0593             nan     0.1000   -0.0007
##     80        0.0396             nan     0.1000   -0.0001
##    100        0.0256             nan     0.1000    0.0001
##    120        0.0192             nan     0.1000   -0.0003
##    140        0.0143             nan     0.1000   -0.0002
##    160        0.0103             nan     0.1000   -0.0002
##    180        0.0074             nan     0.1000   -0.0003
##    200        0.0045             nan     0.1000   -0.0001
##    220        0.0029             nan     0.1000   -0.0001
##    240        0.0022             nan     0.1000   -0.0000
##    260        0.0014             nan     0.1000   -0.0000
##    280        0.0010             nan     0.1000   -0.0000
##    300        0.0008             nan     0.1000   -0.0000
##    320        0.0007             nan     0.1000   -0.0000
##    340        0.0006             nan     0.1000   -0.0000
##    360        0.0004             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1309             nan     0.1000    0.0724
##      2        1.0101             nan     0.1000    0.0554
##      3        0.9109             nan     0.1000    0.0475
##      4        0.8252             nan     0.1000    0.0398
##      5        0.7524             nan     0.1000    0.0328
##      6        0.6917             nan     0.1000    0.0266
##      7        0.6385             nan     0.1000    0.0237
##      8        0.5857             nan     0.1000    0.0225
##      9        0.5416             nan     0.1000    0.0199
##     10        0.5062             nan     0.1000    0.0146
##     20        0.2705             nan     0.1000    0.0051
##     40        0.1151             nan     0.1000    0.0000
##     60        0.0600             nan     0.1000   -0.0006
##     80        0.0352             nan     0.1000   -0.0003
##    100        0.0216             nan     0.1000   -0.0003
##    120        0.0140             nan     0.1000   -0.0001
##    140        0.0099             nan     0.1000   -0.0002
##    160        0.0067             nan     0.1000   -0.0000
##    180        0.0058             nan     0.1000   -0.0002
##    200        0.0035             nan     0.1000   -0.0000
##    220        0.0025             nan     0.1000   -0.0000
##    240        0.0021             nan     0.1000   -0.0001
##    260        0.0015             nan     0.1000    0.0000
##    280        0.0013             nan     0.1000   -0.0000
##    300        0.0011             nan     0.1000   -0.0000
##    320        0.0007             nan     0.1000   -0.0000
##    340        0.0005             nan     0.1000   -0.0000
##    360        0.0004             nan     0.1000    0.0000
##    380        0.0003             nan     0.1000    0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0001             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000    0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1529             nan     0.1000    0.0627
##      2        1.0422             nan     0.1000    0.0535
##      3        0.9454             nan     0.1000    0.0485
##      4        0.8647             nan     0.1000    0.0404
##      5        0.7992             nan     0.1000    0.0333
##      6        0.7419             nan     0.1000    0.0277
##      7        0.6939             nan     0.1000    0.0234
##      8        0.6501             nan     0.1000    0.0194
##      9        0.6073             nan     0.1000    0.0196
##     10        0.5718             nan     0.1000    0.0159
##     20        0.3737             nan     0.1000    0.0059
##     40        0.2386             nan     0.1000   -0.0002
##     60        0.1871             nan     0.1000    0.0011
##     80        0.1652             nan     0.1000   -0.0006
##    100        0.1487             nan     0.1000   -0.0011
##    120        0.1391             nan     0.1000   -0.0023
##    140        0.1302             nan     0.1000   -0.0004
##    160        0.1236             nan     0.1000    0.0001
##    180        0.1141             nan     0.1000   -0.0001
##    200        0.1080             nan     0.1000   -0.0010
##    220        0.1053             nan     0.1000   -0.0009
##    240        0.0989             nan     0.1000   -0.0007
##    260        0.0958             nan     0.1000   -0.0008
##    280        0.0936             nan     0.1000   -0.0005
##    300        0.0901             nan     0.1000   -0.0005
##    320        0.0882             nan     0.1000   -0.0003
##    340        0.0873             nan     0.1000   -0.0010
##    360        0.0851             nan     0.1000   -0.0006
##    380        0.0834             nan     0.1000   -0.0007
##    400        0.0812             nan     0.1000   -0.0009
##    420        0.0776             nan     0.1000   -0.0010
##    440        0.0764             nan     0.1000   -0.0011
##    460        0.0758             nan     0.1000   -0.0003
##    480        0.0747             nan     0.1000   -0.0005
##    500        0.0737             nan     0.1000   -0.0002
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1456             nan     0.1000    0.0697
##      2        1.0206             nan     0.1000    0.0677
##      3        0.9204             nan     0.1000    0.0506
##      4        0.8354             nan     0.1000    0.0393
##      5        0.7583             nan     0.1000    0.0349
##      6        0.6986             nan     0.1000    0.0282
##      7        0.6396             nan     0.1000    0.0269
##      8        0.5938             nan     0.1000    0.0225
##      9        0.5520             nan     0.1000    0.0188
##     10        0.5137             nan     0.1000    0.0158
##     20        0.2921             nan     0.1000    0.0064
##     40        0.1787             nan     0.1000   -0.0003
##     60        0.1342             nan     0.1000   -0.0001
##     80        0.1113             nan     0.1000   -0.0004
##    100        0.0922             nan     0.1000   -0.0005
##    120        0.0789             nan     0.1000   -0.0002
##    140        0.0658             nan     0.1000   -0.0010
##    160        0.0585             nan     0.1000   -0.0008
##    180        0.0517             nan     0.1000   -0.0008
##    200        0.0460             nan     0.1000   -0.0005
##    220        0.0401             nan     0.1000   -0.0002
##    240        0.0358             nan     0.1000   -0.0001
##    260        0.0340             nan     0.1000   -0.0007
##    280        0.0308             nan     0.1000   -0.0001
##    300        0.0277             nan     0.1000   -0.0003
##    320        0.0253             nan     0.1000   -0.0003
##    340        0.0230             nan     0.1000   -0.0001
##    360        0.0211             nan     0.1000   -0.0001
##    380        0.0193             nan     0.1000   -0.0003
##    400        0.0178             nan     0.1000   -0.0002
##    420        0.0159             nan     0.1000   -0.0003
##    440        0.0147             nan     0.1000   -0.0000
##    460        0.0133             nan     0.1000   -0.0001
##    480        0.0123             nan     0.1000   -0.0001
##    500        0.0109             nan     0.1000   -0.0001
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1408             nan     0.1000    0.0641
##      2        1.0134             nan     0.1000    0.0611
##      3        0.9112             nan     0.1000    0.0464
##      4        0.8236             nan     0.1000    0.0396
##      5        0.7548             nan     0.1000    0.0329
##      6        0.6971             nan     0.1000    0.0272
##      7        0.6442             nan     0.1000    0.0242
##      8        0.5944             nan     0.1000    0.0237
##      9        0.5523             nan     0.1000    0.0188
##     10        0.5140             nan     0.1000    0.0177
##     20        0.2908             nan     0.1000    0.0052
##     40        0.1461             nan     0.1000    0.0002
##     60        0.1002             nan     0.1000   -0.0002
##     80        0.0739             nan     0.1000   -0.0006
##    100        0.0591             nan     0.1000   -0.0002
##    120        0.0462             nan     0.1000   -0.0001
##    140        0.0369             nan     0.1000   -0.0004
##    160        0.0310             nan     0.1000   -0.0003
##    180        0.0269             nan     0.1000   -0.0005
##    200        0.0222             nan     0.1000   -0.0001
##    220        0.0182             nan     0.1000    0.0001
##    240        0.0154             nan     0.1000   -0.0001
##    260        0.0131             nan     0.1000   -0.0001
##    280        0.0113             nan     0.1000   -0.0000
##    300        0.0099             nan     0.1000   -0.0001
##    320        0.0084             nan     0.1000   -0.0001
##    340        0.0072             nan     0.1000   -0.0000
##    360        0.0061             nan     0.1000   -0.0000
##    380        0.0055             nan     0.1000   -0.0000
##    400        0.0047             nan     0.1000   -0.0000
##    420        0.0038             nan     0.1000   -0.0000
##    440        0.0033             nan     0.1000   -0.0000
##    460        0.0028             nan     0.1000   -0.0000
##    480        0.0024             nan     0.1000    0.0000
##    500        0.0021             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1331             nan     0.1000    0.0773
##      2        1.0115             nan     0.1000    0.0621
##      3        0.9083             nan     0.1000    0.0462
##      4        0.8296             nan     0.1000    0.0383
##      5        0.7528             nan     0.1000    0.0336
##      6        0.6912             nan     0.1000    0.0256
##      7        0.6359             nan     0.1000    0.0249
##      8        0.5833             nan     0.1000    0.0243
##      9        0.5405             nan     0.1000    0.0164
##     10        0.5022             nan     0.1000    0.0183
##     20        0.2835             nan     0.1000    0.0053
##     40        0.1367             nan     0.1000    0.0016
##     60        0.0891             nan     0.1000    0.0002
##     80        0.0588             nan     0.1000   -0.0009
##    100        0.0448             nan     0.1000   -0.0006
##    120        0.0343             nan     0.1000   -0.0002
##    140        0.0282             nan     0.1000   -0.0004
##    160        0.0208             nan     0.1000   -0.0002
##    180        0.0172             nan     0.1000   -0.0002
##    200        0.0130             nan     0.1000   -0.0001
##    220        0.0101             nan     0.1000   -0.0001
##    240        0.0078             nan     0.1000   -0.0001
##    260        0.0065             nan     0.1000   -0.0001
##    280        0.0051             nan     0.1000   -0.0000
##    300        0.0042             nan     0.1000   -0.0000
##    320        0.0033             nan     0.1000   -0.0000
##    340        0.0026             nan     0.1000    0.0000
##    360        0.0021             nan     0.1000   -0.0000
##    380        0.0016             nan     0.1000   -0.0000
##    400        0.0014             nan     0.1000   -0.0000
##    420        0.0011             nan     0.1000   -0.0000
##    440        0.0009             nan     0.1000   -0.0000
##    460        0.0007             nan     0.1000   -0.0000
##    480        0.0006             nan     0.1000   -0.0000
##    500        0.0005             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1344             nan     0.1000    0.0733
##      2        1.0068             nan     0.1000    0.0618
##      3        0.9022             nan     0.1000    0.0507
##      4        0.8127             nan     0.1000    0.0401
##      5        0.7384             nan     0.1000    0.0358
##      6        0.6715             nan     0.1000    0.0304
##      7        0.6126             nan     0.1000    0.0273
##      8        0.5668             nan     0.1000    0.0195
##      9        0.5265             nan     0.1000    0.0174
##     10        0.4867             nan     0.1000    0.0187
##     20        0.2667             nan     0.1000    0.0062
##     40        0.1212             nan     0.1000    0.0011
##     60        0.0713             nan     0.1000   -0.0002
##     80        0.0442             nan     0.1000    0.0000
##    100        0.0327             nan     0.1000   -0.0005
##    120        0.0237             nan     0.1000   -0.0004
##    140        0.0175             nan     0.1000   -0.0001
##    160        0.0124             nan     0.1000    0.0000
##    180        0.0089             nan     0.1000   -0.0001
##    200        0.0066             nan     0.1000   -0.0001
##    220        0.0047             nan     0.1000   -0.0001
##    240        0.0037             nan     0.1000   -0.0001
##    260        0.0028             nan     0.1000   -0.0001
##    280        0.0022             nan     0.1000   -0.0000
##    300        0.0017             nan     0.1000   -0.0000
##    320        0.0013             nan     0.1000   -0.0000
##    340        0.0010             nan     0.1000   -0.0000
##    360        0.0008             nan     0.1000   -0.0000
##    380        0.0006             nan     0.1000   -0.0000
##    400        0.0004             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0003             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0002             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1342             nan     0.1000    0.0749
##      2        1.0105             nan     0.1000    0.0593
##      3        0.9092             nan     0.1000    0.0485
##      4        0.8211             nan     0.1000    0.0415
##      5        0.7409             nan     0.1000    0.0383
##      6        0.6751             nan     0.1000    0.0316
##      7        0.6194             nan     0.1000    0.0272
##      8        0.5717             nan     0.1000    0.0219
##      9        0.5267             nan     0.1000    0.0203
##     10        0.4913             nan     0.1000    0.0170
##     20        0.2586             nan     0.1000    0.0041
##     40        0.1213             nan     0.1000   -0.0010
##     60        0.0718             nan     0.1000   -0.0004
##     80        0.0437             nan     0.1000   -0.0002
##    100        0.0291             nan     0.1000   -0.0004
##    120        0.0209             nan     0.1000   -0.0006
##    140        0.0146             nan     0.1000   -0.0002
##    160        0.0101             nan     0.1000   -0.0003
##    180        0.0074             nan     0.1000   -0.0001
##    200        0.0054             nan     0.1000   -0.0001
##    220        0.0042             nan     0.1000   -0.0001
##    240        0.0032             nan     0.1000   -0.0000
##    260        0.0025             nan     0.1000   -0.0000
##    280        0.0018             nan     0.1000   -0.0000
##    300        0.0013             nan     0.1000   -0.0000
##    320        0.0010             nan     0.1000   -0.0000
##    340        0.0009             nan     0.1000   -0.0000
##    360        0.0007             nan     0.1000   -0.0000
##    380        0.0006             nan     0.1000   -0.0000
##    400        0.0005             nan     0.1000   -0.0000
##    420        0.0004             nan     0.1000   -0.0000
##    440        0.0003             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1331             nan     0.1000    0.0715
##      2        1.0134             nan     0.1000    0.0589
##      3        0.9158             nan     0.1000    0.0442
##      4        0.8229             nan     0.1000    0.0400
##      5        0.7494             nan     0.1000    0.0337
##      6        0.6853             nan     0.1000    0.0291
##      7        0.6320             nan     0.1000    0.0247
##      8        0.5837             nan     0.1000    0.0216
##      9        0.5405             nan     0.1000    0.0201
##     10        0.4996             nan     0.1000    0.0179
##     20        0.2679             nan     0.1000    0.0055
##     40        0.1203             nan     0.1000    0.0003
##     60        0.0684             nan     0.1000   -0.0005
##     80        0.0435             nan     0.1000   -0.0002
##    100        0.0299             nan     0.1000   -0.0007
##    120        0.0185             nan     0.1000   -0.0003
##    140        0.0138             nan     0.1000   -0.0005
##    160        0.0090             nan     0.1000   -0.0001
##    180        0.0068             nan     0.1000   -0.0002
##    200        0.0048             nan     0.1000   -0.0001
##    220        0.0038             nan     0.1000    0.0000
##    240        0.0029             nan     0.1000    0.0000
##    260        0.0021             nan     0.1000   -0.0000
##    280        0.0015             nan     0.1000   -0.0000
##    300        0.0012             nan     0.1000   -0.0000
##    320        0.0011             nan     0.1000   -0.0000
##    340        0.0008             nan     0.1000   -0.0000
##    360        0.0006             nan     0.1000    0.0000
##    380        0.0005             nan     0.1000   -0.0000
##    400        0.0005             nan     0.1000   -0.0000
##    420        0.0005             nan     0.1000   -0.0000
##    440        0.0004             nan     0.1000   -0.0000
##    460        0.0003             nan     0.1000   -0.0000
##    480        0.0002             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1238             nan     0.1000    0.0828
##      2        0.9996             nan     0.1000    0.0619
##      3        0.8962             nan     0.1000    0.0476
##      4        0.8064             nan     0.1000    0.0428
##      5        0.7354             nan     0.1000    0.0337
##      6        0.6674             nan     0.1000    0.0312
##      7        0.6102             nan     0.1000    0.0249
##      8        0.5662             nan     0.1000    0.0185
##      9        0.5241             nan     0.1000    0.0197
##     10        0.4847             nan     0.1000    0.0179
##     20        0.2566             nan     0.1000    0.0053
##     40        0.0967             nan     0.1000    0.0008
##     60        0.0487             nan     0.1000   -0.0002
##     80        0.0289             nan     0.1000   -0.0000
##    100        0.0194             nan     0.1000   -0.0001
##    120        0.0137             nan     0.1000   -0.0003
##    140        0.0093             nan     0.1000   -0.0001
##    160        0.0072             nan     0.1000   -0.0002
##    180        0.0047             nan     0.1000   -0.0001
##    200        0.0033             nan     0.1000   -0.0000
##    220        0.0024             nan     0.1000   -0.0000
##    240        0.0020             nan     0.1000   -0.0001
##    260        0.0013             nan     0.1000   -0.0000
##    280        0.0009             nan     0.1000   -0.0000
##    300        0.0007             nan     0.1000   -0.0000
##    320        0.0006             nan     0.1000    0.0000
##    340        0.0004             nan     0.1000   -0.0000
##    360        0.0003             nan     0.1000    0.0000
##    380        0.0002             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1292             nan     0.1000    0.0808
##      2        1.0022             nan     0.1000    0.0586
##      3        0.9062             nan     0.1000    0.0442
##      4        0.8209             nan     0.1000    0.0405
##      5        0.7437             nan     0.1000    0.0388
##      6        0.6800             nan     0.1000    0.0301
##      7        0.6251             nan     0.1000    0.0254
##      8        0.5803             nan     0.1000    0.0193
##      9        0.5320             nan     0.1000    0.0234
##     10        0.4928             nan     0.1000    0.0161
##     20        0.2588             nan     0.1000    0.0049
##     40        0.0983             nan     0.1000    0.0008
##     60        0.0515             nan     0.1000   -0.0008
##     80        0.0317             nan     0.1000   -0.0004
##    100        0.0227             nan     0.1000   -0.0002
##    120        0.0144             nan     0.1000   -0.0001
##    140        0.0129             nan     0.1000   -0.0005
##    160        0.0086             nan     0.1000    0.0000
##    180        0.0061             nan     0.1000    0.0000
##    200        0.0044             nan     0.1000   -0.0001
##    220        0.0034             nan     0.1000   -0.0001
##    240        0.0024             nan     0.1000   -0.0000
##    260        0.0016             nan     0.1000   -0.0000
##    280        0.0013             nan     0.1000   -0.0001
##    300        0.0011             nan     0.1000   -0.0000
##    320        0.0007             nan     0.1000   -0.0000
##    340        0.0005             nan     0.1000   -0.0000
##    360        0.0003             nan     0.1000   -0.0000
##    380        0.0002             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0001             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1386             nan     0.1000    0.0720
##      2        1.0105             nan     0.1000    0.0640
##      3        0.9081             nan     0.1000    0.0487
##      4        0.8222             nan     0.1000    0.0398
##      5        0.7427             nan     0.1000    0.0354
##      6        0.6802             nan     0.1000    0.0302
##      7        0.6262             nan     0.1000    0.0249
##      8        0.5728             nan     0.1000    0.0250
##      9        0.5276             nan     0.1000    0.0188
##     10        0.4918             nan     0.1000    0.0158
##     20        0.2586             nan     0.1000    0.0053
##     40        0.1033             nan     0.1000   -0.0004
##     60        0.0529             nan     0.1000   -0.0008
##     80        0.0337             nan     0.1000   -0.0003
##    100        0.0212             nan     0.1000   -0.0004
##    120        0.0146             nan     0.1000   -0.0004
##    140        0.0097             nan     0.1000   -0.0003
##    160        0.0075             nan     0.1000   -0.0002
##    180        0.0056             nan     0.1000   -0.0000
##    200        0.0039             nan     0.1000   -0.0001
##    220        0.0026             nan     0.1000   -0.0001
##    240        0.0021             nan     0.1000   -0.0001
##    260        0.0017             nan     0.1000   -0.0001
##    280        0.0013             nan     0.1000   -0.0000
##    300        0.0008             nan     0.1000   -0.0000
##    320        0.0006             nan     0.1000   -0.0000
##    340        0.0005             nan     0.1000   -0.0000
##    360        0.0004             nan     0.1000   -0.0000
##    380        0.0002             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000    0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1522             nan     0.1000    0.0678
##      2        1.0417             nan     0.1000    0.0503
##      3        0.9464             nan     0.1000    0.0455
##      4        0.8631             nan     0.1000    0.0418
##      5        0.7950             nan     0.1000    0.0337
##      6        0.7381             nan     0.1000    0.0270
##      7        0.6856             nan     0.1000    0.0255
##      8        0.6401             nan     0.1000    0.0194
##      9        0.6049             nan     0.1000    0.0181
##     10        0.5647             nan     0.1000    0.0180
##     20        0.3614             nan     0.1000    0.0060
##     40        0.2264             nan     0.1000    0.0012
##     60        0.1873             nan     0.1000   -0.0009
##     80        0.1633             nan     0.1000   -0.0006
##    100        0.1459             nan     0.1000   -0.0008
##    120        0.1334             nan     0.1000    0.0001
##    140        0.1258             nan     0.1000   -0.0010
##    160        0.1195             nan     0.1000   -0.0008
##    180        0.1112             nan     0.1000    0.0000
##    200        0.1075             nan     0.1000   -0.0007
##    220        0.1029             nan     0.1000   -0.0007
##    240        0.0995             nan     0.1000   -0.0005
##    260        0.0976             nan     0.1000   -0.0003
##    280        0.0956             nan     0.1000   -0.0001
##    300        0.0930             nan     0.1000   -0.0007
##    320        0.0899             nan     0.1000   -0.0009
##    340        0.0885             nan     0.1000   -0.0006
##    360        0.0869             nan     0.1000   -0.0007
##    380        0.0855             nan     0.1000   -0.0007
##    400        0.0840             nan     0.1000   -0.0007
##    420        0.0822             nan     0.1000   -0.0007
##    440        0.0819             nan     0.1000   -0.0003
##    460        0.0801             nan     0.1000   -0.0005
##    480        0.0786             nan     0.1000   -0.0004
##    500        0.0783             nan     0.1000   -0.0011
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1353             nan     0.1000    0.0730
##      2        1.0175             nan     0.1000    0.0620
##      3        0.9192             nan     0.1000    0.0481
##      4        0.8336             nan     0.1000    0.0414
##      5        0.7661             nan     0.1000    0.0334
##      6        0.7064             nan     0.1000    0.0265
##      7        0.6485             nan     0.1000    0.0275
##      8        0.5948             nan     0.1000    0.0240
##      9        0.5526             nan     0.1000    0.0195
##     10        0.5175             nan     0.1000    0.0160
##     20        0.2955             nan     0.1000    0.0056
##     40        0.1693             nan     0.1000   -0.0016
##     60        0.1321             nan     0.1000   -0.0006
##     80        0.1114             nan     0.1000   -0.0005
##    100        0.0958             nan     0.1000   -0.0009
##    120        0.0828             nan     0.1000   -0.0003
##    140        0.0743             nan     0.1000   -0.0006
##    160        0.0657             nan     0.1000   -0.0007
##    180        0.0613             nan     0.1000   -0.0009
##    200        0.0539             nan     0.1000   -0.0006
##    220        0.0472             nan     0.1000   -0.0001
##    240        0.0436             nan     0.1000   -0.0002
##    260        0.0402             nan     0.1000   -0.0004
##    280        0.0352             nan     0.1000   -0.0002
##    300        0.0326             nan     0.1000   -0.0002
##    320        0.0297             nan     0.1000   -0.0003
##    340        0.0272             nan     0.1000   -0.0001
##    360        0.0248             nan     0.1000   -0.0001
##    380        0.0222             nan     0.1000   -0.0002
##    400        0.0199             nan     0.1000   -0.0002
##    420        0.0183             nan     0.1000   -0.0001
##    440        0.0169             nan     0.1000   -0.0001
##    460        0.0152             nan     0.1000   -0.0001
##    480        0.0135             nan     0.1000   -0.0001
##    500        0.0122             nan     0.1000   -0.0001
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1341             nan     0.1000    0.0725
##      2        1.0093             nan     0.1000    0.0586
##      3        0.9047             nan     0.1000    0.0492
##      4        0.8189             nan     0.1000    0.0427
##      5        0.7440             nan     0.1000    0.0363
##      6        0.6800             nan     0.1000    0.0322
##      7        0.6238             nan     0.1000    0.0265
##      8        0.5767             nan     0.1000    0.0221
##      9        0.5332             nan     0.1000    0.0190
##     10        0.4980             nan     0.1000    0.0158
##     20        0.2783             nan     0.1000    0.0054
##     40        0.1453             nan     0.1000   -0.0000
##     60        0.1008             nan     0.1000    0.0000
##     80        0.0788             nan     0.1000   -0.0006
##    100        0.0632             nan     0.1000   -0.0007
##    120        0.0501             nan     0.1000   -0.0009
##    140        0.0399             nan     0.1000   -0.0003
##    160        0.0311             nan     0.1000   -0.0004
##    180        0.0270             nan     0.1000   -0.0001
##    200        0.0227             nan     0.1000   -0.0002
##    220        0.0180             nan     0.1000   -0.0002
##    240        0.0147             nan     0.1000   -0.0001
##    260        0.0127             nan     0.1000   -0.0002
##    280        0.0109             nan     0.1000   -0.0001
##    300        0.0091             nan     0.1000   -0.0001
##    320        0.0079             nan     0.1000   -0.0001
##    340        0.0069             nan     0.1000   -0.0000
##    360        0.0060             nan     0.1000   -0.0000
##    380        0.0050             nan     0.1000   -0.0001
##    400        0.0044             nan     0.1000   -0.0000
##    420        0.0037             nan     0.1000   -0.0000
##    440        0.0032             nan     0.1000   -0.0000
##    460        0.0029             nan     0.1000   -0.0000
##    480        0.0024             nan     0.1000   -0.0000
##    500        0.0021             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1324             nan     0.1000    0.0750
##      2        1.0074             nan     0.1000    0.0583
##      3        0.9005             nan     0.1000    0.0509
##      4        0.8152             nan     0.1000    0.0404
##      5        0.7381             nan     0.1000    0.0361
##      6        0.6761             nan     0.1000    0.0296
##      7        0.6224             nan     0.1000    0.0244
##      8        0.5741             nan     0.1000    0.0213
##      9        0.5342             nan     0.1000    0.0161
##     10        0.4949             nan     0.1000    0.0177
##     20        0.2735             nan     0.1000    0.0043
##     40        0.1340             nan     0.1000    0.0008
##     60        0.0867             nan     0.1000   -0.0010
##     80        0.0622             nan     0.1000   -0.0007
##    100        0.0479             nan     0.1000   -0.0005
##    120        0.0372             nan     0.1000   -0.0001
##    140        0.0283             nan     0.1000   -0.0003
##    160        0.0229             nan     0.1000   -0.0005
##    180        0.0184             nan     0.1000   -0.0003
##    200        0.0144             nan     0.1000   -0.0002
##    220        0.0113             nan     0.1000   -0.0000
##    240        0.0095             nan     0.1000   -0.0001
##    260        0.0077             nan     0.1000   -0.0001
##    280        0.0063             nan     0.1000   -0.0001
##    300        0.0052             nan     0.1000   -0.0000
##    320        0.0041             nan     0.1000   -0.0001
##    340        0.0032             nan     0.1000   -0.0001
##    360        0.0027             nan     0.1000   -0.0000
##    380        0.0022             nan     0.1000   -0.0001
##    400        0.0018             nan     0.1000   -0.0000
##    420        0.0014             nan     0.1000   -0.0000
##    440        0.0011             nan     0.1000   -0.0000
##    460        0.0009             nan     0.1000   -0.0000
##    480        0.0008             nan     0.1000   -0.0000
##    500        0.0006             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1259             nan     0.1000    0.0782
##      2        1.0025             nan     0.1000    0.0620
##      3        0.9038             nan     0.1000    0.0460
##      4        0.8143             nan     0.1000    0.0411
##      5        0.7391             nan     0.1000    0.0344
##      6        0.6779             nan     0.1000    0.0279
##      7        0.6214             nan     0.1000    0.0275
##      8        0.5703             nan     0.1000    0.0241
##      9        0.5216             nan     0.1000    0.0215
##     10        0.4854             nan     0.1000    0.0177
##     20        0.2617             nan     0.1000    0.0048
##     40        0.1137             nan     0.1000   -0.0002
##     60        0.0720             nan     0.1000   -0.0001
##     80        0.0473             nan     0.1000   -0.0006
##    100        0.0343             nan     0.1000   -0.0001
##    120        0.0248             nan     0.1000    0.0000
##    140        0.0187             nan     0.1000   -0.0004
##    160        0.0129             nan     0.1000   -0.0001
##    180        0.0104             nan     0.1000   -0.0003
##    200        0.0075             nan     0.1000   -0.0000
##    220        0.0060             nan     0.1000   -0.0001
##    240        0.0042             nan     0.1000   -0.0000
##    260        0.0031             nan     0.1000   -0.0000
##    280        0.0023             nan     0.1000   -0.0000
##    300        0.0018             nan     0.1000   -0.0000
##    320        0.0014             nan     0.1000   -0.0000
##    340        0.0011             nan     0.1000   -0.0000
##    360        0.0008             nan     0.1000   -0.0000
##    380        0.0006             nan     0.1000   -0.0000
##    400        0.0005             nan     0.1000   -0.0000
##    420        0.0004             nan     0.1000   -0.0000
##    440        0.0003             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0002             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1276             nan     0.1000    0.0761
##      2        1.0000             nan     0.1000    0.0627
##      3        0.8967             nan     0.1000    0.0480
##      4        0.8121             nan     0.1000    0.0376
##      5        0.7377             nan     0.1000    0.0352
##      6        0.6741             nan     0.1000    0.0317
##      7        0.6170             nan     0.1000    0.0264
##      8        0.5700             nan     0.1000    0.0211
##      9        0.5272             nan     0.1000    0.0200
##     10        0.4892             nan     0.1000    0.0171
##     20        0.2586             nan     0.1000    0.0059
##     40        0.1141             nan     0.1000   -0.0008
##     60        0.0654             nan     0.1000   -0.0001
##     80        0.0413             nan     0.1000   -0.0005
##    100        0.0271             nan     0.1000   -0.0003
##    120        0.0205             nan     0.1000   -0.0001
##    140        0.0151             nan     0.1000   -0.0000
##    160        0.0102             nan     0.1000   -0.0001
##    180        0.0073             nan     0.1000    0.0000
##    200        0.0055             nan     0.1000   -0.0001
##    220        0.0041             nan     0.1000   -0.0000
##    240        0.0030             nan     0.1000   -0.0000
##    260        0.0023             nan     0.1000   -0.0000
##    280        0.0018             nan     0.1000   -0.0000
##    300        0.0015             nan     0.1000    0.0000
##    320        0.0013             nan     0.1000   -0.0000
##    340        0.0009             nan     0.1000   -0.0000
##    360        0.0008             nan     0.1000   -0.0000
##    380        0.0006             nan     0.1000   -0.0000
##    400        0.0005             nan     0.1000    0.0000
##    420        0.0004             nan     0.1000   -0.0000
##    440        0.0003             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0002             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1260             nan     0.1000    0.0743
##      2        1.0022             nan     0.1000    0.0590
##      3        0.9013             nan     0.1000    0.0481
##      4        0.8139             nan     0.1000    0.0436
##      5        0.7402             nan     0.1000    0.0350
##      6        0.6766             nan     0.1000    0.0292
##      7        0.6185             nan     0.1000    0.0263
##      8        0.5691             nan     0.1000    0.0197
##      9        0.5295             nan     0.1000    0.0153
##     10        0.4912             nan     0.1000    0.0148
##     20        0.2662             nan     0.1000    0.0053
##     40        0.1215             nan     0.1000    0.0013
##     60        0.0663             nan     0.1000   -0.0015
##     80        0.0424             nan     0.1000   -0.0001
##    100        0.0271             nan     0.1000   -0.0005
##    120        0.0185             nan     0.1000   -0.0004
##    140        0.0123             nan     0.1000   -0.0001
##    160        0.0091             nan     0.1000   -0.0001
##    180        0.0069             nan     0.1000   -0.0001
##    200        0.0053             nan     0.1000   -0.0001
##    220        0.0043             nan     0.1000   -0.0001
##    240        0.0033             nan     0.1000   -0.0000
##    260        0.0026             nan     0.1000   -0.0000
##    280        0.0023             nan     0.1000   -0.0000
##    300        0.0016             nan     0.1000   -0.0000
##    320        0.0011             nan     0.1000   -0.0000
##    340        0.0010             nan     0.1000    0.0000
##    360        0.0008             nan     0.1000   -0.0000
##    380        0.0005             nan     0.1000   -0.0000
##    400        0.0004             nan     0.1000   -0.0000
##    420        0.0005             nan     0.1000   -0.0000
##    440        0.0003             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0002             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1304             nan     0.1000    0.0793
##      2        1.0040             nan     0.1000    0.0661
##      3        0.8991             nan     0.1000    0.0527
##      4        0.8117             nan     0.1000    0.0407
##      5        0.7399             nan     0.1000    0.0341
##      6        0.6753             nan     0.1000    0.0288
##      7        0.6158             nan     0.1000    0.0276
##      8        0.5681             nan     0.1000    0.0199
##      9        0.5283             nan     0.1000    0.0182
##     10        0.4889             nan     0.1000    0.0193
##     20        0.2578             nan     0.1000    0.0055
##     40        0.1026             nan     0.1000   -0.0002
##     60        0.0584             nan     0.1000   -0.0008
##     80        0.0358             nan     0.1000   -0.0006
##    100        0.0233             nan     0.1000   -0.0002
##    120        0.0155             nan     0.1000   -0.0002
##    140        0.0104             nan     0.1000   -0.0003
##    160        0.0077             nan     0.1000   -0.0002
##    180        0.0057             nan     0.1000   -0.0001
##    200        0.0043             nan     0.1000   -0.0002
##    220        0.0033             nan     0.1000   -0.0000
##    240        0.0021             nan     0.1000    0.0000
##    260        0.0015             nan     0.1000   -0.0000
##    280        0.0011             nan     0.1000   -0.0000
##    300        0.0008             nan     0.1000   -0.0000
##    320        0.0007             nan     0.1000   -0.0000
##    340        0.0004             nan     0.1000   -0.0000
##    360        0.0003             nan     0.1000   -0.0000
##    380        0.0002             nan     0.1000   -0.0000
##    400        0.0001             nan     0.1000   -0.0000
##    420        0.0001             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1289             nan     0.1000    0.0775
##      2        1.0045             nan     0.1000    0.0552
##      3        0.9004             nan     0.1000    0.0528
##      4        0.8131             nan     0.1000    0.0418
##      5        0.7422             nan     0.1000    0.0344
##      6        0.6785             nan     0.1000    0.0289
##      7        0.6192             nan     0.1000    0.0294
##      8        0.5730             nan     0.1000    0.0206
##      9        0.5294             nan     0.1000    0.0202
##     10        0.4906             nan     0.1000    0.0161
##     20        0.2536             nan     0.1000    0.0053
##     40        0.1083             nan     0.1000   -0.0015
##     60        0.0616             nan     0.1000   -0.0004
##     80        0.0422             nan     0.1000   -0.0006
##    100        0.0263             nan     0.1000    0.0002
##    120        0.0192             nan     0.1000    0.0002
##    140        0.0136             nan     0.1000   -0.0002
##    160        0.0106             nan     0.1000   -0.0004
##    180        0.0076             nan     0.1000   -0.0002
##    200        0.0051             nan     0.1000   -0.0001
##    220        0.0038             nan     0.1000    0.0000
##    240        0.0028             nan     0.1000   -0.0001
##    260        0.0023             nan     0.1000   -0.0001
##    280        0.0015             nan     0.1000   -0.0000
##    300        0.0014             nan     0.1000   -0.0000
##    320        0.0012             nan     0.1000   -0.0000
##    340        0.0011             nan     0.1000   -0.0000
##    360        0.0008             nan     0.1000   -0.0000
##    380        0.0006             nan     0.1000   -0.0000
##    400        0.0005             nan     0.1000   -0.0000
##    420        0.0004             nan     0.1000   -0.0000
##    440        0.0005             nan     0.1000    0.0000
##    460        0.0003             nan     0.1000    0.0000
##    480        0.0002             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1356             nan     0.1000    0.0688
##      2        1.0110             nan     0.1000    0.0564
##      3        0.9145             nan     0.1000    0.0428
##      4        0.8241             nan     0.1000    0.0403
##      5        0.7496             nan     0.1000    0.0358
##      6        0.6851             nan     0.1000    0.0302
##      7        0.6268             nan     0.1000    0.0273
##      8        0.5772             nan     0.1000    0.0225
##      9        0.5356             nan     0.1000    0.0173
##     10        0.4986             nan     0.1000    0.0163
##     20        0.2640             nan     0.1000    0.0062
##     40        0.1149             nan     0.1000    0.0002
##     60        0.0587             nan     0.1000   -0.0001
##     80        0.0399             nan     0.1000   -0.0008
##    100        0.0267             nan     0.1000   -0.0005
##    120        0.0190             nan     0.1000   -0.0001
##    140        0.0137             nan     0.1000   -0.0003
##    160        0.0095             nan     0.1000   -0.0000
##    180        0.0078             nan     0.1000    0.0000
##    200        0.0056             nan     0.1000   -0.0001
##    220        0.0041             nan     0.1000   -0.0000
##    240        0.0032             nan     0.1000   -0.0001
##    260        0.0025             nan     0.1000   -0.0001
##    280        0.0021             nan     0.1000   -0.0001
##    300        0.0014             nan     0.1000   -0.0000
##    320        0.0009             nan     0.1000   -0.0000
##    340        0.0008             nan     0.1000   -0.0000
##    360        0.0005             nan     0.1000   -0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1439             nan     0.1000    0.0628
##      2        1.0362             nan     0.1000    0.0525
##      3        0.9414             nan     0.1000    0.0446
##      4        0.8649             nan     0.1000    0.0371
##      5        0.8013             nan     0.1000    0.0324
##      6        0.7436             nan     0.1000    0.0276
##      7        0.6945             nan     0.1000    0.0243
##      8        0.6499             nan     0.1000    0.0201
##      9        0.6103             nan     0.1000    0.0187
##     10        0.5753             nan     0.1000    0.0170
##     20        0.3754             nan     0.1000    0.0059
##     40        0.2446             nan     0.1000    0.0015
##     60        0.2035             nan     0.1000    0.0006
##     80        0.1753             nan     0.1000   -0.0002
##    100        0.1601             nan     0.1000   -0.0008
##    120        0.1478             nan     0.1000   -0.0002
##    140        0.1379             nan     0.1000   -0.0015
##    160        0.1278             nan     0.1000   -0.0008
##    180        0.1220             nan     0.1000   -0.0006
##    200        0.1184             nan     0.1000   -0.0010
##    220        0.1142             nan     0.1000   -0.0007
##    240        0.1094             nan     0.1000   -0.0005
##    260        0.1068             nan     0.1000   -0.0003
##    280        0.1045             nan     0.1000   -0.0010
##    300        0.1012             nan     0.1000   -0.0006
##    320        0.1000             nan     0.1000   -0.0012
##    340        0.0976             nan     0.1000   -0.0003
##    360        0.0962             nan     0.1000   -0.0007
##    380        0.0936             nan     0.1000   -0.0012
##    400        0.0925             nan     0.1000   -0.0006
##    420        0.0908             nan     0.1000   -0.0009
##    440        0.0887             nan     0.1000   -0.0011
##    460        0.0868             nan     0.1000   -0.0004
##    480        0.0872             nan     0.1000   -0.0002
##    500        0.0860             nan     0.1000   -0.0008
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1368             nan     0.1000    0.0781
##      2        1.0196             nan     0.1000    0.0561
##      3        0.9214             nan     0.1000    0.0442
##      4        0.8391             nan     0.1000    0.0420
##      5        0.7680             nan     0.1000    0.0325
##      6        0.7099             nan     0.1000    0.0291
##      7        0.6545             nan     0.1000    0.0233
##      8        0.6047             nan     0.1000    0.0238
##      9        0.5672             nan     0.1000    0.0174
##     10        0.5289             nan     0.1000    0.0168
##     20        0.3168             nan     0.1000    0.0059
##     40        0.1817             nan     0.1000    0.0001
##     60        0.1395             nan     0.1000   -0.0013
##     80        0.1077             nan     0.1000    0.0003
##    100        0.0910             nan     0.1000   -0.0006
##    120        0.0808             nan     0.1000   -0.0002
##    140        0.0728             nan     0.1000   -0.0004
##    160        0.0634             nan     0.1000   -0.0009
##    180        0.0563             nan     0.1000   -0.0006
##    200        0.0489             nan     0.1000   -0.0004
##    220        0.0447             nan     0.1000   -0.0004
##    240        0.0407             nan     0.1000   -0.0003
##    260        0.0367             nan     0.1000   -0.0003
##    280        0.0339             nan     0.1000   -0.0007
##    300        0.0312             nan     0.1000   -0.0000
##    320        0.0281             nan     0.1000   -0.0001
##    340        0.0261             nan     0.1000   -0.0002
##    360        0.0236             nan     0.1000   -0.0002
##    380        0.0215             nan     0.1000   -0.0003
##    400        0.0201             nan     0.1000   -0.0002
##    420        0.0184             nan     0.1000   -0.0004
##    440        0.0170             nan     0.1000   -0.0001
##    460        0.0161             nan     0.1000   -0.0001
##    480        0.0148             nan     0.1000   -0.0002
##    500        0.0136             nan     0.1000   -0.0002
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1336             nan     0.1000    0.0742
##      2        1.0140             nan     0.1000    0.0601
##      3        0.9102             nan     0.1000    0.0511
##      4        0.8274             nan     0.1000    0.0371
##      5        0.7544             nan     0.1000    0.0369
##      6        0.6897             nan     0.1000    0.0314
##      7        0.6370             nan     0.1000    0.0251
##      8        0.5884             nan     0.1000    0.0234
##      9        0.5453             nan     0.1000    0.0215
##     10        0.5089             nan     0.1000    0.0153
##     20        0.2903             nan     0.1000    0.0059
##     40        0.1557             nan     0.1000    0.0001
##     60        0.1081             nan     0.1000   -0.0001
##     80        0.0854             nan     0.1000   -0.0004
##    100        0.0676             nan     0.1000   -0.0008
##    120        0.0549             nan     0.1000   -0.0004
##    140        0.0464             nan     0.1000   -0.0003
##    160        0.0369             nan     0.1000   -0.0003
##    180        0.0317             nan     0.1000   -0.0003
##    200        0.0268             nan     0.1000   -0.0004
##    220        0.0226             nan     0.1000   -0.0005
##    240        0.0187             nan     0.1000   -0.0001
##    260        0.0158             nan     0.1000   -0.0000
##    280        0.0141             nan     0.1000   -0.0002
##    300        0.0122             nan     0.1000   -0.0002
##    320        0.0104             nan     0.1000   -0.0003
##    340        0.0089             nan     0.1000   -0.0001
##    360        0.0077             nan     0.1000   -0.0000
##    380        0.0068             nan     0.1000   -0.0000
##    400        0.0060             nan     0.1000   -0.0001
##    420        0.0051             nan     0.1000   -0.0001
##    440        0.0042             nan     0.1000   -0.0000
##    460        0.0037             nan     0.1000   -0.0000
##    480        0.0031             nan     0.1000   -0.0000
##    500        0.0026             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1381             nan     0.1000    0.0713
##      2        1.0158             nan     0.1000    0.0565
##      3        0.9123             nan     0.1000    0.0473
##      4        0.8283             nan     0.1000    0.0401
##      5        0.7559             nan     0.1000    0.0323
##      6        0.6946             nan     0.1000    0.0296
##      7        0.6408             nan     0.1000    0.0248
##      8        0.5922             nan     0.1000    0.0211
##      9        0.5514             nan     0.1000    0.0165
##     10        0.5135             nan     0.1000    0.0166
##     20        0.2820             nan     0.1000    0.0049
##     40        0.1424             nan     0.1000    0.0009
##     60        0.0906             nan     0.1000    0.0001
##     80        0.0651             nan     0.1000   -0.0002
##    100        0.0470             nan     0.1000   -0.0007
##    120        0.0371             nan     0.1000   -0.0005
##    140        0.0285             nan     0.1000   -0.0002
##    160        0.0226             nan     0.1000   -0.0002
##    180        0.0183             nan     0.1000   -0.0001
##    200        0.0147             nan     0.1000   -0.0001
##    220        0.0125             nan     0.1000   -0.0002
##    240        0.0100             nan     0.1000    0.0000
##    260        0.0081             nan     0.1000   -0.0001
##    280        0.0067             nan     0.1000   -0.0000
##    300        0.0055             nan     0.1000   -0.0001
##    320        0.0045             nan     0.1000   -0.0001
##    340        0.0036             nan     0.1000   -0.0000
##    360        0.0029             nan     0.1000   -0.0000
##    380        0.0023             nan     0.1000   -0.0000
##    400        0.0019             nan     0.1000   -0.0000
##    420        0.0014             nan     0.1000   -0.0000
##    440        0.0012             nan     0.1000   -0.0000
##    460        0.0009             nan     0.1000   -0.0000
##    480        0.0008             nan     0.1000   -0.0000
##    500        0.0006             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1299             nan     0.1000    0.0747
##      2        1.0100             nan     0.1000    0.0587
##      3        0.9072             nan     0.1000    0.0512
##      4        0.8194             nan     0.1000    0.0396
##      5        0.7458             nan     0.1000    0.0340
##      6        0.6783             nan     0.1000    0.0320
##      7        0.6198             nan     0.1000    0.0267
##      8        0.5760             nan     0.1000    0.0177
##      9        0.5306             nan     0.1000    0.0228
##     10        0.4917             nan     0.1000    0.0173
##     20        0.2727             nan     0.1000    0.0040
##     40        0.1270             nan     0.1000   -0.0003
##     60        0.0778             nan     0.1000   -0.0005
##     80        0.0526             nan     0.1000   -0.0016
##    100        0.0381             nan     0.1000   -0.0005
##    120        0.0295             nan     0.1000   -0.0004
##    140        0.0222             nan     0.1000   -0.0004
##    160        0.0172             nan     0.1000   -0.0003
##    180        0.0136             nan     0.1000   -0.0002
##    200        0.0105             nan     0.1000   -0.0000
##    220        0.0080             nan     0.1000   -0.0001
##    240        0.0066             nan     0.1000   -0.0000
##    260        0.0050             nan     0.1000   -0.0001
##    280        0.0041             nan     0.1000   -0.0001
##    300        0.0030             nan     0.1000   -0.0000
##    320        0.0023             nan     0.1000   -0.0000
##    340        0.0018             nan     0.1000   -0.0000
##    360        0.0014             nan     0.1000   -0.0000
##    380        0.0011             nan     0.1000   -0.0000
##    400        0.0008             nan     0.1000   -0.0000
##    420        0.0007             nan     0.1000   -0.0000
##    440        0.0005             nan     0.1000   -0.0000
##    460        0.0004             nan     0.1000   -0.0000
##    480        0.0003             nan     0.1000   -0.0000
##    500        0.0002             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1304             nan     0.1000    0.0740
##      2        1.0050             nan     0.1000    0.0534
##      3        0.9058             nan     0.1000    0.0466
##      4        0.8176             nan     0.1000    0.0410
##      5        0.7434             nan     0.1000    0.0367
##      6        0.6801             nan     0.1000    0.0268
##      7        0.6200             nan     0.1000    0.0255
##      8        0.5742             nan     0.1000    0.0209
##      9        0.5338             nan     0.1000    0.0168
##     10        0.4955             nan     0.1000    0.0161
##     20        0.2681             nan     0.1000    0.0050
##     40        0.1229             nan     0.1000    0.0005
##     60        0.0730             nan     0.1000    0.0002
##     80        0.0468             nan     0.1000   -0.0003
##    100        0.0317             nan     0.1000   -0.0004
##    120        0.0224             nan     0.1000   -0.0005
##    140        0.0163             nan     0.1000   -0.0001
##    160        0.0116             nan     0.1000   -0.0001
##    180        0.0091             nan     0.1000   -0.0002
##    200        0.0070             nan     0.1000   -0.0002
##    220        0.0059             nan     0.1000   -0.0000
##    240        0.0044             nan     0.1000   -0.0001
##    260        0.0030             nan     0.1000    0.0000
##    280        0.0022             nan     0.1000   -0.0000
##    300        0.0017             nan     0.1000   -0.0000
##    320        0.0012             nan     0.1000   -0.0000
##    340        0.0010             nan     0.1000   -0.0000
##    360        0.0008             nan     0.1000   -0.0000
##    380        0.0006             nan     0.1000   -0.0000
##    400        0.0005             nan     0.1000   -0.0000
##    420        0.0004             nan     0.1000   -0.0000
##    440        0.0003             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0002             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1298             nan     0.1000    0.0723
##      2        1.0059             nan     0.1000    0.0560
##      3        0.9021             nan     0.1000    0.0467
##      4        0.8181             nan     0.1000    0.0404
##      5        0.7409             nan     0.1000    0.0361
##      6        0.6805             nan     0.1000    0.0302
##      7        0.6287             nan     0.1000    0.0248
##      8        0.5798             nan     0.1000    0.0220
##      9        0.5379             nan     0.1000    0.0196
##     10        0.5015             nan     0.1000    0.0146
##     20        0.2709             nan     0.1000    0.0050
##     40        0.1164             nan     0.1000   -0.0013
##     60        0.0680             nan     0.1000   -0.0005
##     80        0.0423             nan     0.1000   -0.0007
##    100        0.0308             nan     0.1000   -0.0007
##    120        0.0203             nan     0.1000   -0.0002
##    140        0.0148             nan     0.1000   -0.0001
##    160        0.0116             nan     0.1000   -0.0003
##    180        0.0075             nan     0.1000   -0.0000
##    200        0.0062             nan     0.1000   -0.0002
##    220        0.0052             nan     0.1000   -0.0000
##    240        0.0037             nan     0.1000   -0.0000
##    260        0.0026             nan     0.1000   -0.0001
##    280        0.0021             nan     0.1000   -0.0000
##    300        0.0015             nan     0.1000   -0.0000
##    320        0.0011             nan     0.1000   -0.0000
##    340        0.0008             nan     0.1000   -0.0000
##    360        0.0006             nan     0.1000   -0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1336             nan     0.1000    0.0754
##      2        1.0054             nan     0.1000    0.0583
##      3        0.9056             nan     0.1000    0.0482
##      4        0.8212             nan     0.1000    0.0364
##      5        0.7457             nan     0.1000    0.0358
##      6        0.6833             nan     0.1000    0.0270
##      7        0.6284             nan     0.1000    0.0252
##      8        0.5812             nan     0.1000    0.0228
##      9        0.5378             nan     0.1000    0.0191
##     10        0.4989             nan     0.1000    0.0163
##     20        0.2683             nan     0.1000    0.0066
##     40        0.1162             nan     0.1000   -0.0001
##     60        0.0628             nan     0.1000   -0.0009
##     80        0.0370             nan     0.1000   -0.0005
##    100        0.0257             nan     0.1000   -0.0005
##    120        0.0179             nan     0.1000   -0.0004
##    140        0.0138             nan     0.1000   -0.0004
##    160        0.0095             nan     0.1000   -0.0002
##    180        0.0077             nan     0.1000   -0.0002
##    200        0.0062             nan     0.1000    0.0001
##    220        0.0047             nan     0.1000   -0.0001
##    240        0.0042             nan     0.1000   -0.0002
##    260        0.0030             nan     0.1000   -0.0000
##    280        0.0028             nan     0.1000   -0.0001
##    300        0.0026             nan     0.1000   -0.0002
##    320        0.0017             nan     0.1000   -0.0000
##    340        0.0014             nan     0.1000   -0.0001
##    360        0.0010             nan     0.1000   -0.0000
##    380        0.0007             nan     0.1000   -0.0000
##    400        0.0008             nan     0.1000   -0.0000
##    420        0.0008             nan     0.1000   -0.0000
##    440        0.0005             nan     0.1000   -0.0000
##    460        0.0004             nan     0.1000   -0.0000
##    480        0.0005             nan     0.1000   -0.0000
##    500        0.0004             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1365             nan     0.1000    0.0680
##      2        1.0047             nan     0.1000    0.0644
##      3        0.9008             nan     0.1000    0.0501
##      4        0.8158             nan     0.1000    0.0429
##      5        0.7441             nan     0.1000    0.0355
##      6        0.6784             nan     0.1000    0.0295
##      7        0.6200             nan     0.1000    0.0282
##      8        0.5706             nan     0.1000    0.0216
##      9        0.5297             nan     0.1000    0.0183
##     10        0.4921             nan     0.1000    0.0168
##     20        0.2710             nan     0.1000    0.0040
##     40        0.1081             nan     0.1000   -0.0007
##     60        0.0632             nan     0.1000   -0.0005
##     80        0.0391             nan     0.1000   -0.0007
##    100        0.0273             nan     0.1000   -0.0002
##    120        0.0191             nan     0.1000   -0.0002
##    140        0.0123             nan     0.1000   -0.0002
##    160        0.0090             nan     0.1000   -0.0001
##    180        0.0072             nan     0.1000    0.0000
##    200        0.0049             nan     0.1000   -0.0001
##    220        0.0033             nan     0.1000   -0.0000
##    240        0.0024             nan     0.1000   -0.0001
##    260        0.0019             nan     0.1000   -0.0001
##    280        0.0014             nan     0.1000   -0.0000
##    300        0.0011             nan     0.1000   -0.0000
##    320        0.0008             nan     0.1000   -0.0000
##    340        0.0005             nan     0.1000   -0.0000
##    360        0.0004             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000    0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1341             nan     0.1000    0.0790
##      2        1.0139             nan     0.1000    0.0541
##      3        0.9144             nan     0.1000    0.0455
##      4        0.8284             nan     0.1000    0.0395
##      5        0.7531             nan     0.1000    0.0327
##      6        0.6886             nan     0.1000    0.0293
##      7        0.6337             nan     0.1000    0.0246
##      8        0.5828             nan     0.1000    0.0231
##      9        0.5426             nan     0.1000    0.0178
##     10        0.5051             nan     0.1000    0.0153
##     20        0.2743             nan     0.1000    0.0057
##     40        0.1147             nan     0.1000   -0.0004
##     60        0.0622             nan     0.1000   -0.0008
##     80        0.0377             nan     0.1000   -0.0005
##    100        0.0271             nan     0.1000   -0.0005
##    120        0.0172             nan     0.1000   -0.0003
##    140        0.0106             nan     0.1000    0.0000
##    160        0.0072             nan     0.1000   -0.0000
##    180        0.0053             nan     0.1000   -0.0001
##    200        0.0038             nan     0.1000   -0.0000
##    220        0.0026             nan     0.1000   -0.0000
##    240        0.0017             nan     0.1000   -0.0000
##    260        0.0015             nan     0.1000   -0.0000
##    280        0.0011             nan     0.1000   -0.0000
##    300        0.0009             nan     0.1000   -0.0000
##    320        0.0007             nan     0.1000   -0.0000
##    340        0.0005             nan     0.1000    0.0000
##    360        0.0004             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1541             nan     0.1000    0.0701
##      2        1.0366             nan     0.1000    0.0537
##      3        0.9429             nan     0.1000    0.0447
##      4        0.8686             nan     0.1000    0.0360
##      5        0.8031             nan     0.1000    0.0308
##      6        0.7428             nan     0.1000    0.0276
##      7        0.6927             nan     0.1000    0.0250
##      8        0.6555             nan     0.1000    0.0159
##      9        0.6149             nan     0.1000    0.0175
##     10        0.5782             nan     0.1000    0.0173
##     20        0.3729             nan     0.1000    0.0042
##     40        0.2388             nan     0.1000    0.0012
##     60        0.1871             nan     0.1000    0.0007
##     80        0.1567             nan     0.1000   -0.0003
##    100        0.1379             nan     0.1000    0.0000
##    120        0.1253             nan     0.1000   -0.0007
##    140        0.1141             nan     0.1000   -0.0005
##    160        0.1083             nan     0.1000   -0.0003
##    180        0.1024             nan     0.1000   -0.0009
##    200        0.0952             nan     0.1000   -0.0005
##    220        0.0904             nan     0.1000   -0.0002
##    240        0.0883             nan     0.1000   -0.0004
##    260        0.0875             nan     0.1000   -0.0006
##    280        0.0851             nan     0.1000   -0.0008
##    300        0.0802             nan     0.1000   -0.0012
##    320        0.0769             nan     0.1000   -0.0008
##    340        0.0754             nan     0.1000   -0.0015
##    360        0.0724             nan     0.1000   -0.0000
##    380        0.0701             nan     0.1000   -0.0004
##    400        0.0684             nan     0.1000   -0.0004
##    420        0.0665             nan     0.1000   -0.0004
##    440        0.0658             nan     0.1000   -0.0002
##    460        0.0639             nan     0.1000   -0.0005
##    480        0.0620             nan     0.1000   -0.0001
##    500        0.0606             nan     0.1000   -0.0007
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1377             nan     0.1000    0.0701
##      2        1.0237             nan     0.1000    0.0559
##      3        0.9250             nan     0.1000    0.0485
##      4        0.8476             nan     0.1000    0.0372
##      5        0.7783             nan     0.1000    0.0346
##      6        0.7205             nan     0.1000    0.0265
##      7        0.6672             nan     0.1000    0.0261
##      8        0.6152             nan     0.1000    0.0238
##      9        0.5692             nan     0.1000    0.0209
##     10        0.5321             nan     0.1000    0.0170
##     20        0.3164             nan     0.1000    0.0027
##     40        0.1731             nan     0.1000    0.0003
##     60        0.1319             nan     0.1000   -0.0006
##     80        0.1063             nan     0.1000   -0.0003
##    100        0.0872             nan     0.1000    0.0001
##    120        0.0742             nan     0.1000   -0.0004
##    140        0.0671             nan     0.1000   -0.0001
##    160        0.0592             nan     0.1000   -0.0004
##    180        0.0519             nan     0.1000   -0.0004
##    200        0.0450             nan     0.1000   -0.0002
##    220        0.0391             nan     0.1000   -0.0008
##    240        0.0347             nan     0.1000   -0.0002
##    260        0.0306             nan     0.1000   -0.0003
##    280        0.0268             nan     0.1000   -0.0002
##    300        0.0243             nan     0.1000   -0.0003
##    320        0.0218             nan     0.1000   -0.0002
##    340        0.0200             nan     0.1000   -0.0003
##    360        0.0184             nan     0.1000   -0.0001
##    380        0.0161             nan     0.1000   -0.0003
##    400        0.0148             nan     0.1000   -0.0002
##    420        0.0141             nan     0.1000   -0.0003
##    440        0.0129             nan     0.1000   -0.0001
##    460        0.0116             nan     0.1000   -0.0001
##    480        0.0104             nan     0.1000   -0.0001
##    500        0.0095             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1367             nan     0.1000    0.0773
##      2        1.0090             nan     0.1000    0.0615
##      3        0.9080             nan     0.1000    0.0490
##      4        0.8262             nan     0.1000    0.0391
##      5        0.7475             nan     0.1000    0.0355
##      6        0.6878             nan     0.1000    0.0277
##      7        0.6326             nan     0.1000    0.0255
##      8        0.5823             nan     0.1000    0.0229
##      9        0.5410             nan     0.1000    0.0190
##     10        0.5049             nan     0.1000    0.0148
##     20        0.2832             nan     0.1000    0.0076
##     40        0.1466             nan     0.1000    0.0001
##     60        0.0996             nan     0.1000   -0.0008
##     80        0.0749             nan     0.1000   -0.0002
##    100        0.0580             nan     0.1000   -0.0001
##    120        0.0473             nan     0.1000   -0.0006
##    140        0.0392             nan     0.1000   -0.0002
##    160        0.0323             nan     0.1000   -0.0001
##    180        0.0264             nan     0.1000   -0.0003
##    200        0.0217             nan     0.1000   -0.0002
##    220        0.0177             nan     0.1000   -0.0001
##    240        0.0147             nan     0.1000   -0.0002
##    260        0.0121             nan     0.1000   -0.0001
##    280        0.0102             nan     0.1000   -0.0001
##    300        0.0088             nan     0.1000   -0.0001
##    320        0.0079             nan     0.1000   -0.0001
##    340        0.0068             nan     0.1000   -0.0001
##    360        0.0059             nan     0.1000   -0.0001
##    380        0.0052             nan     0.1000   -0.0001
##    400        0.0044             nan     0.1000   -0.0000
##    420        0.0036             nan     0.1000   -0.0000
##    440        0.0029             nan     0.1000   -0.0000
##    460        0.0025             nan     0.1000   -0.0000
##    480        0.0021             nan     0.1000   -0.0000
##    500        0.0017             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1415             nan     0.1000    0.0712
##      2        1.0170             nan     0.1000    0.0584
##      3        0.9133             nan     0.1000    0.0477
##      4        0.8278             nan     0.1000    0.0435
##      5        0.7548             nan     0.1000    0.0353
##      6        0.6904             nan     0.1000    0.0281
##      7        0.6323             nan     0.1000    0.0262
##      8        0.5851             nan     0.1000    0.0234
##      9        0.5439             nan     0.1000    0.0186
##     10        0.5059             nan     0.1000    0.0164
##     20        0.2762             nan     0.1000    0.0045
##     40        0.1312             nan     0.1000    0.0003
##     60        0.0857             nan     0.1000   -0.0008
##     80        0.0619             nan     0.1000   -0.0006
##    100        0.0445             nan     0.1000   -0.0004
##    120        0.0321             nan     0.1000   -0.0000
##    140        0.0241             nan     0.1000   -0.0002
##    160        0.0191             nan     0.1000   -0.0002
##    180        0.0154             nan     0.1000   -0.0002
##    200        0.0126             nan     0.1000   -0.0002
##    220        0.0099             nan     0.1000   -0.0002
##    240        0.0078             nan     0.1000   -0.0001
##    260        0.0063             nan     0.1000   -0.0001
##    280        0.0052             nan     0.1000   -0.0001
##    300        0.0044             nan     0.1000   -0.0001
##    320        0.0035             nan     0.1000   -0.0000
##    340        0.0029             nan     0.1000   -0.0000
##    360        0.0023             nan     0.1000   -0.0000
##    380        0.0018             nan     0.1000   -0.0000
##    400        0.0015             nan     0.1000   -0.0000
##    420        0.0012             nan     0.1000   -0.0000
##    440        0.0009             nan     0.1000   -0.0000
##    460        0.0008             nan     0.1000   -0.0000
##    480        0.0006             nan     0.1000   -0.0000
##    500        0.0005             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1311             nan     0.1000    0.0731
##      2        1.0055             nan     0.1000    0.0606
##      3        0.8984             nan     0.1000    0.0490
##      4        0.8133             nan     0.1000    0.0394
##      5        0.7441             nan     0.1000    0.0330
##      6        0.6847             nan     0.1000    0.0275
##      7        0.6309             nan     0.1000    0.0259
##      8        0.5832             nan     0.1000    0.0223
##      9        0.5365             nan     0.1000    0.0211
##     10        0.4969             nan     0.1000    0.0171
##     20        0.2702             nan     0.1000    0.0053
##     40        0.1174             nan     0.1000   -0.0006
##     60        0.0693             nan     0.1000   -0.0001
##     80        0.0443             nan     0.1000    0.0001
##    100        0.0318             nan     0.1000   -0.0003
##    120        0.0230             nan     0.1000   -0.0002
##    140        0.0172             nan     0.1000   -0.0001
##    160        0.0123             nan     0.1000   -0.0001
##    180        0.0099             nan     0.1000   -0.0003
##    200        0.0073             nan     0.1000   -0.0001
##    220        0.0053             nan     0.1000   -0.0001
##    240        0.0040             nan     0.1000   -0.0000
##    260        0.0032             nan     0.1000   -0.0000
##    280        0.0025             nan     0.1000   -0.0000
##    300        0.0020             nan     0.1000   -0.0000
##    320        0.0014             nan     0.1000   -0.0000
##    340        0.0010             nan     0.1000   -0.0000
##    360        0.0008             nan     0.1000   -0.0000
##    380        0.0006             nan     0.1000   -0.0000
##    400        0.0005             nan     0.1000   -0.0000
##    420        0.0004             nan     0.1000   -0.0000
##    440        0.0003             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0002             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1415             nan     0.1000    0.0616
##      2        1.0165             nan     0.1000    0.0583
##      3        0.9169             nan     0.1000    0.0478
##      4        0.8295             nan     0.1000    0.0430
##      5        0.7522             nan     0.1000    0.0355
##      6        0.6870             nan     0.1000    0.0312
##      7        0.6320             nan     0.1000    0.0238
##      8        0.5833             nan     0.1000    0.0227
##      9        0.5402             nan     0.1000    0.0203
##     10        0.4976             nan     0.1000    0.0181
##     20        0.2580             nan     0.1000    0.0054
##     40        0.1060             nan     0.1000    0.0005
##     60        0.0593             nan     0.1000   -0.0008
##     80        0.0379             nan     0.1000   -0.0002
##    100        0.0258             nan     0.1000   -0.0003
##    120        0.0179             nan     0.1000   -0.0001
##    140        0.0119             nan     0.1000   -0.0001
##    160        0.0083             nan     0.1000   -0.0001
##    180        0.0056             nan     0.1000   -0.0000
##    200        0.0044             nan     0.1000   -0.0001
##    220        0.0032             nan     0.1000   -0.0001
##    240        0.0024             nan     0.1000   -0.0000
##    260        0.0017             nan     0.1000    0.0000
##    280        0.0013             nan     0.1000   -0.0000
##    300        0.0010             nan     0.1000   -0.0000
##    320        0.0007             nan     0.1000   -0.0000
##    340        0.0006             nan     0.1000   -0.0000
##    360        0.0004             nan     0.1000   -0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000    0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1389             nan     0.1000    0.0709
##      2        1.0121             nan     0.1000    0.0599
##      3        0.9074             nan     0.1000    0.0502
##      4        0.8216             nan     0.1000    0.0402
##      5        0.7502             nan     0.1000    0.0318
##      6        0.6878             nan     0.1000    0.0294
##      7        0.6314             nan     0.1000    0.0247
##      8        0.5847             nan     0.1000    0.0201
##      9        0.5357             nan     0.1000    0.0213
##     10        0.4972             nan     0.1000    0.0175
##     20        0.2655             nan     0.1000    0.0057
##     40        0.1135             nan     0.1000    0.0002
##     60        0.0609             nan     0.1000   -0.0003
##     80        0.0368             nan     0.1000    0.0000
##    100        0.0250             nan     0.1000    0.0000
##    120        0.0165             nan     0.1000   -0.0002
##    140        0.0108             nan     0.1000   -0.0002
##    160        0.0083             nan     0.1000   -0.0001
##    180        0.0059             nan     0.1000   -0.0001
##    200        0.0042             nan     0.1000    0.0000
##    220        0.0029             nan     0.1000   -0.0001
##    240        0.0021             nan     0.1000   -0.0000
##    260        0.0017             nan     0.1000   -0.0000
##    280        0.0014             nan     0.1000   -0.0000
##    300        0.0010             nan     0.1000    0.0000
##    320        0.0008             nan     0.1000   -0.0000
##    340        0.0006             nan     0.1000    0.0000
##    360        0.0005             nan     0.1000   -0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000    0.0000
##    480        0.0001             nan     0.1000    0.0000
##    500        0.0001             nan     0.1000    0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1272             nan     0.1000    0.0776
##      2        1.0056             nan     0.1000    0.0574
##      3        0.9048             nan     0.1000    0.0446
##      4        0.8199             nan     0.1000    0.0422
##      5        0.7485             nan     0.1000    0.0347
##      6        0.6868             nan     0.1000    0.0265
##      7        0.6313             nan     0.1000    0.0260
##      8        0.5848             nan     0.1000    0.0201
##      9        0.5417             nan     0.1000    0.0193
##     10        0.5048             nan     0.1000    0.0146
##     20        0.2634             nan     0.1000    0.0058
##     40        0.1083             nan     0.1000   -0.0002
##     60        0.0532             nan     0.1000   -0.0001
##     80        0.0332             nan     0.1000   -0.0006
##    100        0.0237             nan     0.1000   -0.0005
##    120        0.0165             nan     0.1000   -0.0000
##    140        0.0121             nan     0.1000   -0.0001
##    160        0.0085             nan     0.1000   -0.0003
##    180        0.0061             nan     0.1000   -0.0001
##    200        0.0042             nan     0.1000   -0.0001
##    220        0.0031             nan     0.1000   -0.0000
##    240        0.0019             nan     0.1000   -0.0000
##    260        0.0014             nan     0.1000   -0.0000
##    280        0.0009             nan     0.1000   -0.0000
##    300        0.0007             nan     0.1000   -0.0000
##    320        0.0005             nan     0.1000   -0.0000
##    340        0.0004             nan     0.1000   -0.0000
##    360        0.0003             nan     0.1000   -0.0000
##    380        0.0002             nan     0.1000   -0.0000
##    400        0.0001             nan     0.1000   -0.0000
##    420        0.0001             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0000             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1307             nan     0.1000    0.0759
##      2        1.0111             nan     0.1000    0.0623
##      3        0.9089             nan     0.1000    0.0512
##      4        0.8201             nan     0.1000    0.0438
##      5        0.7432             nan     0.1000    0.0354
##      6        0.6809             nan     0.1000    0.0281
##      7        0.6275             nan     0.1000    0.0218
##      8        0.5808             nan     0.1000    0.0210
##      9        0.5356             nan     0.1000    0.0211
##     10        0.4953             nan     0.1000    0.0188
##     20        0.2613             nan     0.1000    0.0032
##     40        0.1067             nan     0.1000    0.0003
##     60        0.0561             nan     0.1000    0.0008
##     80        0.0322             nan     0.1000    0.0003
##    100        0.0226             nan     0.1000   -0.0004
##    120        0.0150             nan     0.1000   -0.0003
##    140        0.0096             nan     0.1000   -0.0002
##    160        0.0068             nan     0.1000   -0.0000
##    180        0.0046             nan     0.1000   -0.0001
##    200        0.0032             nan     0.1000   -0.0001
##    220        0.0024             nan     0.1000   -0.0001
##    240        0.0019             nan     0.1000   -0.0001
##    260        0.0013             nan     0.1000   -0.0000
##    280        0.0011             nan     0.1000   -0.0000
##    300        0.0008             nan     0.1000   -0.0000
##    320        0.0006             nan     0.1000   -0.0000
##    340        0.0004             nan     0.1000   -0.0000
##    360        0.0003             nan     0.1000   -0.0000
##    380        0.0002             nan     0.1000    0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0001             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000    0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1387             nan     0.1000    0.0768
##      2        1.0158             nan     0.1000    0.0572
##      3        0.9154             nan     0.1000    0.0463
##      4        0.8269             nan     0.1000    0.0429
##      5        0.7474             nan     0.1000    0.0373
##      6        0.6857             nan     0.1000    0.0266
##      7        0.6315             nan     0.1000    0.0233
##      8        0.5814             nan     0.1000    0.0214
##      9        0.5406             nan     0.1000    0.0184
##     10        0.5029             nan     0.1000    0.0158
##     20        0.2681             nan     0.1000    0.0035
##     40        0.1060             nan     0.1000   -0.0004
##     60        0.0518             nan     0.1000   -0.0003
##     80        0.0290             nan     0.1000   -0.0004
##    100        0.0200             nan     0.1000   -0.0003
##    120        0.0136             nan     0.1000   -0.0003
##    140        0.0106             nan     0.1000   -0.0002
##    160        0.0067             nan     0.1000   -0.0000
##    180        0.0043             nan     0.1000   -0.0001
##    200        0.0032             nan     0.1000   -0.0001
##    220        0.0021             nan     0.1000   -0.0000
##    240        0.0015             nan     0.1000   -0.0000
##    260        0.0011             nan     0.1000   -0.0000
##    280        0.0008             nan     0.1000   -0.0000
##    300        0.0006             nan     0.1000   -0.0000
##    320        0.0004             nan     0.1000   -0.0000
##    340        0.0003             nan     0.1000    0.0000
##    360        0.0003             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1465             nan     0.1000    0.0655
##      2        1.0386             nan     0.1000    0.0534
##      3        0.9470             nan     0.1000    0.0428
##      4        0.8707             nan     0.1000    0.0344
##      5        0.8022             nan     0.1000    0.0328
##      6        0.7459             nan     0.1000    0.0293
##      7        0.6991             nan     0.1000    0.0204
##      8        0.6544             nan     0.1000    0.0202
##      9        0.6085             nan     0.1000    0.0193
##     10        0.5731             nan     0.1000    0.0168
##     20        0.3679             nan     0.1000    0.0059
##     40        0.2498             nan     0.1000   -0.0004
##     60        0.1936             nan     0.1000   -0.0014
##     80        0.1705             nan     0.1000    0.0002
##    100        0.1564             nan     0.1000   -0.0016
##    120        0.1442             nan     0.1000   -0.0016
##    140        0.1354             nan     0.1000   -0.0010
##    160        0.1302             nan     0.1000   -0.0017
##    180        0.1284             nan     0.1000   -0.0009
##    200        0.1220             nan     0.1000   -0.0009
##    220        0.1185             nan     0.1000   -0.0017
##    240        0.1156             nan     0.1000   -0.0012
##    260        0.1135             nan     0.1000   -0.0009
##    280        0.1122             nan     0.1000   -0.0007
##    300        0.1071             nan     0.1000   -0.0003
##    320        0.1058             nan     0.1000   -0.0011
##    340        0.1047             nan     0.1000   -0.0004
##    360        0.1024             nan     0.1000   -0.0005
##    380        0.1001             nan     0.1000   -0.0007
##    400        0.0997             nan     0.1000   -0.0008
##    420        0.0969             nan     0.1000   -0.0006
##    440        0.0958             nan     0.1000   -0.0003
##    460        0.0955             nan     0.1000   -0.0008
##    480        0.0953             nan     0.1000   -0.0005
##    500        0.0941             nan     0.1000   -0.0012
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1383             nan     0.1000    0.0719
##      2        1.0233             nan     0.1000    0.0560
##      3        0.9258             nan     0.1000    0.0472
##      4        0.8407             nan     0.1000    0.0403
##      5        0.7715             nan     0.1000    0.0339
##      6        0.7066             nan     0.1000    0.0301
##      7        0.6541             nan     0.1000    0.0259
##      8        0.6047             nan     0.1000    0.0231
##      9        0.5600             nan     0.1000    0.0209
##     10        0.5232             nan     0.1000    0.0175
##     20        0.3084             nan     0.1000    0.0056
##     40        0.1879             nan     0.1000    0.0002
##     60        0.1427             nan     0.1000    0.0001
##     80        0.1177             nan     0.1000   -0.0005
##    100        0.1042             nan     0.1000   -0.0013
##    120        0.0935             nan     0.1000   -0.0012
##    140        0.0813             nan     0.1000   -0.0013
##    160        0.0736             nan     0.1000    0.0002
##    180        0.0633             nan     0.1000   -0.0002
##    200        0.0549             nan     0.1000   -0.0007
##    220        0.0498             nan     0.1000   -0.0006
##    240        0.0460             nan     0.1000   -0.0004
##    260        0.0425             nan     0.1000   -0.0005
##    280        0.0385             nan     0.1000   -0.0002
##    300        0.0346             nan     0.1000   -0.0006
##    320        0.0304             nan     0.1000   -0.0002
##    340        0.0280             nan     0.1000   -0.0002
##    360        0.0258             nan     0.1000   -0.0002
##    380        0.0230             nan     0.1000   -0.0001
##    400        0.0221             nan     0.1000   -0.0001
##    420        0.0203             nan     0.1000   -0.0002
##    440        0.0188             nan     0.1000   -0.0001
##    460        0.0176             nan     0.1000   -0.0001
##    480        0.0166             nan     0.1000   -0.0002
##    500        0.0154             nan     0.1000   -0.0003
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1330             nan     0.1000    0.0730
##      2        1.0129             nan     0.1000    0.0563
##      3        0.9141             nan     0.1000    0.0455
##      4        0.8308             nan     0.1000    0.0389
##      5        0.7536             nan     0.1000    0.0381
##      6        0.6910             nan     0.1000    0.0285
##      7        0.6324             nan     0.1000    0.0279
##      8        0.5817             nan     0.1000    0.0247
##      9        0.5357             nan     0.1000    0.0205
##     10        0.5025             nan     0.1000    0.0148
##     20        0.2862             nan     0.1000    0.0049
##     40        0.1491             nan     0.1000   -0.0001
##     60        0.1035             nan     0.1000   -0.0004
##     80        0.0809             nan     0.1000   -0.0007
##    100        0.0679             nan     0.1000   -0.0009
##    120        0.0513             nan     0.1000   -0.0004
##    140        0.0426             nan     0.1000   -0.0007
##    160        0.0352             nan     0.1000   -0.0003
##    180        0.0286             nan     0.1000   -0.0003
##    200        0.0237             nan     0.1000   -0.0002
##    220        0.0203             nan     0.1000   -0.0002
##    240        0.0173             nan     0.1000   -0.0000
##    260        0.0159             nan     0.1000    0.0000
##    280        0.0136             nan     0.1000   -0.0001
##    300        0.0114             nan     0.1000   -0.0001
##    320        0.0100             nan     0.1000   -0.0001
##    340        0.0086             nan     0.1000   -0.0001
##    360        0.0074             nan     0.1000   -0.0001
##    380        0.0063             nan     0.1000   -0.0001
##    400        0.0056             nan     0.1000   -0.0001
##    420        0.0048             nan     0.1000   -0.0001
##    440        0.0041             nan     0.1000   -0.0000
##    460        0.0036             nan     0.1000   -0.0000
##    480        0.0031             nan     0.1000   -0.0000
##    500        0.0028             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1427             nan     0.1000    0.0749
##      2        1.0182             nan     0.1000    0.0586
##      3        0.9185             nan     0.1000    0.0493
##      4        0.8359             nan     0.1000    0.0375
##      5        0.7577             nan     0.1000    0.0371
##      6        0.6942             nan     0.1000    0.0309
##      7        0.6411             nan     0.1000    0.0227
##      8        0.5923             nan     0.1000    0.0220
##      9        0.5520             nan     0.1000    0.0169
##     10        0.5097             nan     0.1000    0.0177
##     20        0.2837             nan     0.1000    0.0051
##     40        0.1424             nan     0.1000    0.0004
##     60        0.0915             nan     0.1000   -0.0005
##     80        0.0665             nan     0.1000   -0.0008
##    100        0.0495             nan     0.1000   -0.0004
##    120        0.0384             nan     0.1000   -0.0004
##    140        0.0281             nan     0.1000   -0.0001
##    160        0.0218             nan     0.1000   -0.0002
##    180        0.0170             nan     0.1000   -0.0001
##    200        0.0134             nan     0.1000   -0.0002
##    220        0.0113             nan     0.1000   -0.0002
##    240        0.0088             nan     0.1000   -0.0002
##    260        0.0071             nan     0.1000   -0.0001
##    280        0.0057             nan     0.1000   -0.0001
##    300        0.0045             nan     0.1000   -0.0000
##    320        0.0037             nan     0.1000   -0.0000
##    340        0.0029             nan     0.1000   -0.0000
##    360        0.0024             nan     0.1000   -0.0000
##    380        0.0019             nan     0.1000   -0.0000
##    400        0.0017             nan     0.1000   -0.0000
##    420        0.0013             nan     0.1000   -0.0000
##    440        0.0011             nan     0.1000   -0.0000
##    460        0.0008             nan     0.1000   -0.0000
##    480        0.0007             nan     0.1000   -0.0000
##    500        0.0006             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1334             nan     0.1000    0.0794
##      2        1.0111             nan     0.1000    0.0582
##      3        0.9049             nan     0.1000    0.0492
##      4        0.8172             nan     0.1000    0.0394
##      5        0.7420             nan     0.1000    0.0365
##      6        0.6830             nan     0.1000    0.0260
##      7        0.6211             nan     0.1000    0.0280
##      8        0.5729             nan     0.1000    0.0223
##      9        0.5292             nan     0.1000    0.0191
##     10        0.4908             nan     0.1000    0.0164
##     20        0.2612             nan     0.1000    0.0064
##     40        0.1273             nan     0.1000   -0.0008
##     60        0.0740             nan     0.1000    0.0002
##     80        0.0498             nan     0.1000   -0.0008
##    100        0.0339             nan     0.1000   -0.0002
##    120        0.0225             nan     0.1000    0.0000
##    140        0.0165             nan     0.1000   -0.0001
##    160        0.0124             nan     0.1000   -0.0002
##    180        0.0091             nan     0.1000   -0.0002
##    200        0.0070             nan     0.1000   -0.0001
##    220        0.0052             nan     0.1000   -0.0001
##    240        0.0043             nan     0.1000   -0.0001
##    260        0.0033             nan     0.1000   -0.0001
##    280        0.0026             nan     0.1000   -0.0001
##    300        0.0021             nan     0.1000   -0.0000
##    320        0.0015             nan     0.1000   -0.0000
##    340        0.0011             nan     0.1000   -0.0000
##    360        0.0009             nan     0.1000    0.0000
##    380        0.0008             nan     0.1000    0.0000
##    400        0.0006             nan     0.1000   -0.0000
##    420        0.0004             nan     0.1000   -0.0000
##    440        0.0003             nan     0.1000   -0.0000
##    460        0.0003             nan     0.1000   -0.0000
##    480        0.0002             nan     0.1000   -0.0000
##    500        0.0002             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1248             nan     0.1000    0.0775
##      2        1.0020             nan     0.1000    0.0586
##      3        0.8990             nan     0.1000    0.0477
##      4        0.8099             nan     0.1000    0.0435
##      5        0.7371             nan     0.1000    0.0343
##      6        0.6758             nan     0.1000    0.0305
##      7        0.6179             nan     0.1000    0.0268
##      8        0.5670             nan     0.1000    0.0235
##      9        0.5227             nan     0.1000    0.0184
##     10        0.4856             nan     0.1000    0.0161
##     20        0.2601             nan     0.1000    0.0042
##     40        0.1128             nan     0.1000   -0.0004
##     60        0.0642             nan     0.1000   -0.0002
##     80        0.0417             nan     0.1000   -0.0002
##    100        0.0286             nan     0.1000   -0.0002
##    120        0.0196             nan     0.1000   -0.0003
##    140        0.0142             nan     0.1000   -0.0003
##    160        0.0098             nan     0.1000   -0.0000
##    180        0.0074             nan     0.1000    0.0000
##    200        0.0055             nan     0.1000   -0.0001
##    220        0.0041             nan     0.1000   -0.0001
##    240        0.0030             nan     0.1000    0.0000
##    260        0.0022             nan     0.1000   -0.0001
##    280        0.0017             nan     0.1000    0.0000
##    300        0.0012             nan     0.1000   -0.0000
##    320        0.0011             nan     0.1000   -0.0000
##    340        0.0007             nan     0.1000    0.0000
##    360        0.0005             nan     0.1000   -0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1349             nan     0.1000    0.0731
##      2        1.0166             nan     0.1000    0.0585
##      3        0.9210             nan     0.1000    0.0474
##      4        0.8317             nan     0.1000    0.0455
##      5        0.7565             nan     0.1000    0.0332
##      6        0.6954             nan     0.1000    0.0273
##      7        0.6350             nan     0.1000    0.0277
##      8        0.5868             nan     0.1000    0.0226
##      9        0.5399             nan     0.1000    0.0213
##     10        0.5002             nan     0.1000    0.0180
##     20        0.2673             nan     0.1000    0.0049
##     40        0.1078             nan     0.1000    0.0000
##     60        0.0588             nan     0.1000   -0.0007
##     80        0.0389             nan     0.1000   -0.0005
##    100        0.0264             nan     0.1000   -0.0001
##    120        0.0166             nan     0.1000    0.0001
##    140        0.0119             nan     0.1000   -0.0001
##    160        0.0078             nan     0.1000   -0.0000
##    180        0.0056             nan     0.1000   -0.0001
##    200        0.0043             nan     0.1000   -0.0000
##    220        0.0033             nan     0.1000   -0.0000
##    240        0.0024             nan     0.1000   -0.0001
##    260        0.0020             nan     0.1000   -0.0000
##    280        0.0016             nan     0.1000   -0.0000
##    300        0.0011             nan     0.1000   -0.0000
##    320        0.0009             nan     0.1000   -0.0000
##    340        0.0007             nan     0.1000   -0.0000
##    360        0.0006             nan     0.1000   -0.0000
##    380        0.0005             nan     0.1000   -0.0000
##    400        0.0004             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0003             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0002             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1362             nan     0.1000    0.0673
##      2        1.0171             nan     0.1000    0.0571
##      3        0.9143             nan     0.1000    0.0484
##      4        0.8277             nan     0.1000    0.0392
##      5        0.7516             nan     0.1000    0.0350
##      6        0.6888             nan     0.1000    0.0268
##      7        0.6286             nan     0.1000    0.0273
##      8        0.5822             nan     0.1000    0.0206
##      9        0.5341             nan     0.1000    0.0223
##     10        0.4953             nan     0.1000    0.0157
##     20        0.2710             nan     0.1000    0.0059
##     40        0.1102             nan     0.1000    0.0001
##     60        0.0576             nan     0.1000   -0.0005
##     80        0.0407             nan     0.1000   -0.0015
##    100        0.0272             nan     0.1000   -0.0005
##    120        0.0193             nan     0.1000   -0.0003
##    140        0.0133             nan     0.1000   -0.0004
##    160        0.0092             nan     0.1000   -0.0001
##    180        0.0061             nan     0.1000   -0.0001
##    200        0.0045             nan     0.1000   -0.0001
##    220        0.0032             nan     0.1000   -0.0000
##    240        0.0023             nan     0.1000   -0.0001
##    260        0.0017             nan     0.1000   -0.0001
##    280        0.0014             nan     0.1000   -0.0000
##    300        0.0008             nan     0.1000   -0.0000
##    320        0.0006             nan     0.1000   -0.0000
##    340        0.0004             nan     0.1000    0.0000
##    360        0.0003             nan     0.1000   -0.0000
##    380        0.0002             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0001             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1367             nan     0.1000    0.0799
##      2        1.0113             nan     0.1000    0.0588
##      3        0.9111             nan     0.1000    0.0477
##      4        0.8227             nan     0.1000    0.0429
##      5        0.7496             nan     0.1000    0.0316
##      6        0.6814             nan     0.1000    0.0321
##      7        0.6282             nan     0.1000    0.0239
##      8        0.5802             nan     0.1000    0.0230
##      9        0.5375             nan     0.1000    0.0189
##     10        0.5015             nan     0.1000    0.0153
##     20        0.2652             nan     0.1000    0.0052
##     40        0.1092             nan     0.1000   -0.0000
##     60        0.0577             nan     0.1000   -0.0006
##     80        0.0335             nan     0.1000    0.0000
##    100        0.0228             nan     0.1000    0.0001
##    120        0.0156             nan     0.1000   -0.0001
##    140        0.0105             nan     0.1000   -0.0001
##    160        0.0066             nan     0.1000   -0.0001
##    180        0.0048             nan     0.1000   -0.0001
##    200        0.0041             nan     0.1000   -0.0001
##    220        0.0030             nan     0.1000   -0.0001
##    240        0.0023             nan     0.1000   -0.0001
##    260        0.0017             nan     0.1000   -0.0000
##    280        0.0012             nan     0.1000   -0.0000
##    300        0.0009             nan     0.1000   -0.0000
##    320        0.0006             nan     0.1000   -0.0000
##    340        0.0004             nan     0.1000   -0.0000
##    360        0.0003             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1337             nan     0.1000    0.0727
##      2        1.0061             nan     0.1000    0.0577
##      3        0.9016             nan     0.1000    0.0474
##      4        0.8122             nan     0.1000    0.0436
##      5        0.7370             nan     0.1000    0.0352
##      6        0.6708             nan     0.1000    0.0299
##      7        0.6119             nan     0.1000    0.0245
##      8        0.5633             nan     0.1000    0.0215
##      9        0.5190             nan     0.1000    0.0180
##     10        0.4801             nan     0.1000    0.0183
##     20        0.2560             nan     0.1000    0.0046
##     40        0.1069             nan     0.1000   -0.0007
##     60        0.0629             nan     0.1000   -0.0002
##     80        0.0389             nan     0.1000   -0.0007
##    100        0.0265             nan     0.1000   -0.0008
##    120        0.0177             nan     0.1000   -0.0005
##    140        0.0122             nan     0.1000   -0.0001
##    160        0.0080             nan     0.1000   -0.0001
##    180        0.0051             nan     0.1000   -0.0001
##    200        0.0037             nan     0.1000   -0.0000
##    220        0.0031             nan     0.1000   -0.0001
##    240        0.0024             nan     0.1000   -0.0001
##    260        0.0018             nan     0.1000    0.0000
##    280        0.0012             nan     0.1000    0.0000
##    300        0.0009             nan     0.1000   -0.0000
##    320        0.0006             nan     0.1000   -0.0000
##    340        0.0005             nan     0.1000    0.0000
##    360        0.0004             nan     0.1000    0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1471             nan     0.1000    0.0669
##      2        1.0395             nan     0.1000    0.0476
##      3        0.9467             nan     0.1000    0.0480
##      4        0.8642             nan     0.1000    0.0397
##      5        0.7925             nan     0.1000    0.0339
##      6        0.7360             nan     0.1000    0.0312
##      7        0.6830             nan     0.1000    0.0254
##      8        0.6341             nan     0.1000    0.0209
##      9        0.5967             nan     0.1000    0.0193
##     10        0.5578             nan     0.1000    0.0167
##     20        0.3582             nan     0.1000    0.0047
##     40        0.2303             nan     0.1000    0.0005
##     60        0.1875             nan     0.1000    0.0003
##     80        0.1639             nan     0.1000   -0.0007
##    100        0.1466             nan     0.1000   -0.0007
##    120        0.1341             nan     0.1000   -0.0008
##    140        0.1249             nan     0.1000   -0.0003
##    160        0.1199             nan     0.1000   -0.0005
##    180        0.1150             nan     0.1000   -0.0010
##    200        0.1091             nan     0.1000   -0.0008
##    220        0.1049             nan     0.1000   -0.0011
##    240        0.1010             nan     0.1000   -0.0008
##    260        0.1004             nan     0.1000   -0.0004
##    280        0.0988             nan     0.1000   -0.0011
##    300        0.0939             nan     0.1000   -0.0003
##    320        0.0912             nan     0.1000   -0.0009
##    340        0.0888             nan     0.1000   -0.0006
##    360        0.0868             nan     0.1000   -0.0009
##    380        0.0869             nan     0.1000   -0.0010
##    400        0.0843             nan     0.1000   -0.0006
##    420        0.0850             nan     0.1000   -0.0011
##    440        0.0841             nan     0.1000   -0.0003
##    460        0.0827             nan     0.1000   -0.0003
##    480        0.0812             nan     0.1000   -0.0012
##    500        0.0807             nan     0.1000   -0.0004
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1395             nan     0.1000    0.0737
##      2        1.0166             nan     0.1000    0.0593
##      3        0.9162             nan     0.1000    0.0493
##      4        0.8289             nan     0.1000    0.0428
##      5        0.7546             nan     0.1000    0.0350
##      6        0.6894             nan     0.1000    0.0320
##      7        0.6372             nan     0.1000    0.0238
##      8        0.5902             nan     0.1000    0.0213
##      9        0.5541             nan     0.1000    0.0165
##     10        0.5144             nan     0.1000    0.0178
##     20        0.3018             nan     0.1000    0.0016
##     40        0.1804             nan     0.1000   -0.0006
##     60        0.1397             nan     0.1000   -0.0016
##     80        0.1143             nan     0.1000   -0.0006
##    100        0.0981             nan     0.1000   -0.0016
##    120        0.0838             nan     0.1000   -0.0003
##    140        0.0732             nan     0.1000   -0.0011
##    160        0.0629             nan     0.1000   -0.0008
##    180        0.0565             nan     0.1000   -0.0005
##    200        0.0511             nan     0.1000   -0.0004
##    220        0.0456             nan     0.1000   -0.0006
##    240        0.0416             nan     0.1000   -0.0004
##    260        0.0374             nan     0.1000   -0.0004
##    280        0.0338             nan     0.1000   -0.0005
##    300        0.0309             nan     0.1000   -0.0000
##    320        0.0290             nan     0.1000   -0.0003
##    340        0.0269             nan     0.1000   -0.0001
##    360        0.0244             nan     0.1000   -0.0003
##    380        0.0232             nan     0.1000   -0.0002
##    400        0.0216             nan     0.1000   -0.0001
##    420        0.0200             nan     0.1000    0.0001
##    440        0.0181             nan     0.1000   -0.0002
##    460        0.0167             nan     0.1000   -0.0001
##    480        0.0157             nan     0.1000   -0.0001
##    500        0.0145             nan     0.1000   -0.0001
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1362             nan     0.1000    0.0736
##      2        1.0107             nan     0.1000    0.0609
##      3        0.9082             nan     0.1000    0.0485
##      4        0.8214             nan     0.1000    0.0417
##      5        0.7484             nan     0.1000    0.0362
##      6        0.6836             nan     0.1000    0.0311
##      7        0.6293             nan     0.1000    0.0275
##      8        0.5800             nan     0.1000    0.0227
##      9        0.5361             nan     0.1000    0.0213
##     10        0.4959             nan     0.1000    0.0176
##     20        0.2752             nan     0.1000    0.0051
##     40        0.1543             nan     0.1000   -0.0014
##     60        0.1074             nan     0.1000   -0.0006
##     80        0.0817             nan     0.1000    0.0001
##    100        0.0646             nan     0.1000   -0.0006
##    120        0.0532             nan     0.1000   -0.0001
##    140        0.0453             nan     0.1000   -0.0004
##    160        0.0369             nan     0.1000   -0.0002
##    180        0.0302             nan     0.1000   -0.0004
##    200        0.0255             nan     0.1000   -0.0002
##    220        0.0216             nan     0.1000   -0.0003
##    240        0.0184             nan     0.1000   -0.0003
##    260        0.0150             nan     0.1000   -0.0002
##    280        0.0126             nan     0.1000   -0.0001
##    300        0.0109             nan     0.1000   -0.0001
##    320        0.0094             nan     0.1000   -0.0001
##    340        0.0080             nan     0.1000   -0.0001
##    360        0.0068             nan     0.1000   -0.0001
##    380        0.0060             nan     0.1000   -0.0000
##    400        0.0053             nan     0.1000   -0.0000
##    420        0.0044             nan     0.1000   -0.0000
##    440        0.0038             nan     0.1000   -0.0000
##    460        0.0034             nan     0.1000   -0.0000
##    480        0.0029             nan     0.1000   -0.0000
##    500        0.0025             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1332             nan     0.1000    0.0718
##      2        1.0043             nan     0.1000    0.0626
##      3        0.9047             nan     0.1000    0.0474
##      4        0.8178             nan     0.1000    0.0411
##      5        0.7488             nan     0.1000    0.0337
##      6        0.6847             nan     0.1000    0.0306
##      7        0.6287             nan     0.1000    0.0268
##      8        0.5792             nan     0.1000    0.0215
##      9        0.5335             nan     0.1000    0.0220
##     10        0.4962             nan     0.1000    0.0150
##     20        0.2747             nan     0.1000    0.0062
##     40        0.1322             nan     0.1000   -0.0001
##     60        0.0865             nan     0.1000   -0.0011
##     80        0.0620             nan     0.1000   -0.0007
##    100        0.0446             nan     0.1000   -0.0004
##    120        0.0349             nan     0.1000   -0.0004
##    140        0.0266             nan     0.1000   -0.0003
##    160        0.0213             nan     0.1000   -0.0002
##    180        0.0173             nan     0.1000   -0.0002
##    200        0.0130             nan     0.1000   -0.0003
##    220        0.0110             nan     0.1000   -0.0001
##    240        0.0090             nan     0.1000   -0.0001
##    260        0.0074             nan     0.1000   -0.0002
##    280        0.0061             nan     0.1000   -0.0001
##    300        0.0046             nan     0.1000   -0.0001
##    320        0.0039             nan     0.1000   -0.0001
##    340        0.0031             nan     0.1000   -0.0000
##    360        0.0026             nan     0.1000   -0.0000
##    380        0.0021             nan     0.1000   -0.0000
##    400        0.0017             nan     0.1000   -0.0000
##    420        0.0014             nan     0.1000   -0.0000
##    440        0.0011             nan     0.1000   -0.0000
##    460        0.0009             nan     0.1000   -0.0000
##    480        0.0008             nan     0.1000   -0.0000
##    500        0.0006             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1326             nan     0.1000    0.0707
##      2        1.0062             nan     0.1000    0.0624
##      3        0.9061             nan     0.1000    0.0471
##      4        0.8203             nan     0.1000    0.0399
##      5        0.7461             nan     0.1000    0.0339
##      6        0.6796             nan     0.1000    0.0333
##      7        0.6202             nan     0.1000    0.0298
##      8        0.5715             nan     0.1000    0.0222
##      9        0.5285             nan     0.1000    0.0181
##     10        0.4913             nan     0.1000    0.0169
##     20        0.2669             nan     0.1000    0.0052
##     40        0.1270             nan     0.1000   -0.0008
##     60        0.0764             nan     0.1000   -0.0008
##     80        0.0498             nan     0.1000   -0.0003
##    100        0.0355             nan     0.1000   -0.0001
##    120        0.0248             nan     0.1000   -0.0002
##    140        0.0187             nan     0.1000   -0.0002
##    160        0.0151             nan     0.1000   -0.0002
##    180        0.0105             nan     0.1000   -0.0001
##    200        0.0083             nan     0.1000   -0.0001
##    220        0.0066             nan     0.1000   -0.0001
##    240        0.0054             nan     0.1000   -0.0001
##    260        0.0042             nan     0.1000   -0.0000
##    280        0.0031             nan     0.1000   -0.0000
##    300        0.0025             nan     0.1000    0.0000
##    320        0.0021             nan     0.1000   -0.0000
##    340        0.0016             nan     0.1000   -0.0000
##    360        0.0013             nan     0.1000   -0.0000
##    380        0.0010             nan     0.1000   -0.0000
##    400        0.0009             nan     0.1000   -0.0000
##    420        0.0007             nan     0.1000    0.0000
##    440        0.0006             nan     0.1000   -0.0000
##    460        0.0005             nan     0.1000   -0.0000
##    480        0.0005             nan     0.1000   -0.0000
##    500        0.0003             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1308             nan     0.1000    0.0746
##      2        1.0121             nan     0.1000    0.0532
##      3        0.9105             nan     0.1000    0.0506
##      4        0.8204             nan     0.1000    0.0444
##      5        0.7404             nan     0.1000    0.0397
##      6        0.6794             nan     0.1000    0.0267
##      7        0.6229             nan     0.1000    0.0229
##      8        0.5729             nan     0.1000    0.0216
##      9        0.5323             nan     0.1000    0.0187
##     10        0.4943             nan     0.1000    0.0150
##     20        0.2627             nan     0.1000    0.0059
##     40        0.1123             nan     0.1000    0.0013
##     60        0.0746             nan     0.1000   -0.0015
##     80        0.0492             nan     0.1000   -0.0002
##    100        0.0319             nan     0.1000   -0.0005
##    120        0.0250             nan     0.1000   -0.0004
##    140        0.0171             nan     0.1000   -0.0002
##    160        0.0126             nan     0.1000   -0.0002
##    180        0.0084             nan     0.1000   -0.0001
##    200        0.0062             nan     0.1000   -0.0000
##    220        0.0047             nan     0.1000   -0.0001
##    240        0.0035             nan     0.1000   -0.0000
##    260        0.0028             nan     0.1000   -0.0000
##    280        0.0021             nan     0.1000   -0.0000
##    300        0.0016             nan     0.1000   -0.0000
##    320        0.0013             nan     0.1000   -0.0000
##    340        0.0009             nan     0.1000   -0.0000
##    360        0.0007             nan     0.1000    0.0000
##    380        0.0007             nan     0.1000   -0.0000
##    400        0.0004             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000    0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1283             nan     0.1000    0.0768
##      2        1.0007             nan     0.1000    0.0611
##      3        0.9009             nan     0.1000    0.0493
##      4        0.8158             nan     0.1000    0.0419
##      5        0.7425             nan     0.1000    0.0344
##      6        0.6781             nan     0.1000    0.0315
##      7        0.6212             nan     0.1000    0.0268
##      8        0.5726             nan     0.1000    0.0226
##      9        0.5323             nan     0.1000    0.0173
##     10        0.4942             nan     0.1000    0.0152
##     20        0.2605             nan     0.1000    0.0042
##     40        0.1140             nan     0.1000    0.0004
##     60        0.0620             nan     0.1000   -0.0010
##     80        0.0379             nan     0.1000   -0.0004
##    100        0.0253             nan     0.1000   -0.0002
##    120        0.0171             nan     0.1000   -0.0003
##    140        0.0121             nan     0.1000   -0.0004
##    160        0.0084             nan     0.1000   -0.0001
##    180        0.0059             nan     0.1000   -0.0001
##    200        0.0043             nan     0.1000   -0.0001
##    220        0.0038             nan     0.1000   -0.0001
##    240        0.0031             nan     0.1000    0.0000
##    260        0.0020             nan     0.1000   -0.0001
##    280        0.0013             nan     0.1000    0.0000
##    300        0.0011             nan     0.1000   -0.0000
##    320        0.0008             nan     0.1000   -0.0000
##    340        0.0007             nan     0.1000   -0.0000
##    360        0.0005             nan     0.1000   -0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1352             nan     0.1000    0.0764
##      2        1.0084             nan     0.1000    0.0584
##      3        0.9052             nan     0.1000    0.0501
##      4        0.8148             nan     0.1000    0.0448
##      5        0.7366             nan     0.1000    0.0350
##      6        0.6703             nan     0.1000    0.0299
##      7        0.6150             nan     0.1000    0.0229
##      8        0.5660             nan     0.1000    0.0225
##      9        0.5247             nan     0.1000    0.0174
##     10        0.4907             nan     0.1000    0.0152
##     20        0.2597             nan     0.1000    0.0039
##     40        0.1129             nan     0.1000   -0.0004
##     60        0.0620             nan     0.1000   -0.0005
##     80        0.0398             nan     0.1000   -0.0002
##    100        0.0262             nan     0.1000   -0.0002
##    120        0.0177             nan     0.1000   -0.0002
##    140        0.0122             nan     0.1000   -0.0004
##    160        0.0079             nan     0.1000   -0.0003
##    180        0.0059             nan     0.1000   -0.0000
##    200        0.0041             nan     0.1000   -0.0001
##    220        0.0028             nan     0.1000   -0.0000
##    240        0.0019             nan     0.1000   -0.0000
##    260        0.0015             nan     0.1000   -0.0000
##    280        0.0011             nan     0.1000   -0.0000
##    300        0.0008             nan     0.1000   -0.0000
##    320        0.0006             nan     0.1000    0.0000
##    340        0.0004             nan     0.1000   -0.0000
##    360        0.0003             nan     0.1000   -0.0000
##    380        0.0002             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0001             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0000             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1319             nan     0.1000    0.0768
##      2        1.0097             nan     0.1000    0.0575
##      3        0.9010             nan     0.1000    0.0520
##      4        0.8182             nan     0.1000    0.0368
##      5        0.7401             nan     0.1000    0.0372
##      6        0.6727             nan     0.1000    0.0305
##      7        0.6163             nan     0.1000    0.0268
##      8        0.5656             nan     0.1000    0.0237
##      9        0.5228             nan     0.1000    0.0191
##     10        0.4806             nan     0.1000    0.0177
##     20        0.2537             nan     0.1000    0.0066
##     40        0.1029             nan     0.1000   -0.0006
##     60        0.0591             nan     0.1000   -0.0008
##     80        0.0360             nan     0.1000   -0.0005
##    100        0.0251             nan     0.1000   -0.0004
##    120        0.0177             nan     0.1000   -0.0001
##    140        0.0131             nan     0.1000   -0.0004
##    160        0.0095             nan     0.1000   -0.0000
##    180        0.0068             nan     0.1000   -0.0002
##    200        0.0054             nan     0.1000   -0.0000
##    220        0.0045             nan     0.1000   -0.0000
##    240        0.0031             nan     0.1000   -0.0000
##    260        0.0024             nan     0.1000   -0.0000
##    280        0.0016             nan     0.1000   -0.0000
##    300        0.0012             nan     0.1000   -0.0000
##    320        0.0009             nan     0.1000   -0.0000
##    340        0.0007             nan     0.1000   -0.0000
##    360        0.0006             nan     0.1000   -0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1361             nan     0.1000    0.0664
##      2        1.0081             nan     0.1000    0.0651
##      3        0.9089             nan     0.1000    0.0453
##      4        0.8242             nan     0.1000    0.0398
##      5        0.7505             nan     0.1000    0.0360
##      6        0.6855             nan     0.1000    0.0304
##      7        0.6271             nan     0.1000    0.0261
##      8        0.5758             nan     0.1000    0.0234
##      9        0.5285             nan     0.1000    0.0218
##     10        0.4886             nan     0.1000    0.0177
##     20        0.2665             nan     0.1000    0.0035
##     40        0.1112             nan     0.1000    0.0006
##     60        0.0654             nan     0.1000   -0.0002
##     80        0.0423             nan     0.1000   -0.0003
##    100        0.0278             nan     0.1000   -0.0008
##    120        0.0200             nan     0.1000   -0.0002
##    140        0.0135             nan     0.1000   -0.0004
##    160        0.0098             nan     0.1000   -0.0003
##    180        0.0081             nan     0.1000   -0.0002
##    200        0.0055             nan     0.1000   -0.0001
##    220        0.0039             nan     0.1000   -0.0001
##    240        0.0028             nan     0.1000   -0.0001
##    260        0.0022             nan     0.1000   -0.0001
##    280        0.0015             nan     0.1000   -0.0000
##    300        0.0012             nan     0.1000   -0.0000
##    320        0.0009             nan     0.1000   -0.0000
##    340        0.0007             nan     0.1000   -0.0000
##    360        0.0006             nan     0.1000   -0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0004             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1486             nan     0.1000    0.0693
##      2        1.0371             nan     0.1000    0.0560
##      3        0.9406             nan     0.1000    0.0438
##      4        0.8594             nan     0.1000    0.0364
##      5        0.7884             nan     0.1000    0.0352
##      6        0.7323             nan     0.1000    0.0272
##      7        0.6816             nan     0.1000    0.0256
##      8        0.6412             nan     0.1000    0.0166
##      9        0.6004             nan     0.1000    0.0184
##     10        0.5655             nan     0.1000    0.0174
##     20        0.3605             nan     0.1000    0.0051
##     40        0.2243             nan     0.1000   -0.0003
##     60        0.1808             nan     0.1000   -0.0010
##     80        0.1563             nan     0.1000   -0.0013
##    100        0.1349             nan     0.1000   -0.0002
##    120        0.1245             nan     0.1000   -0.0007
##    140        0.1107             nan     0.1000    0.0003
##    160        0.1032             nan     0.1000   -0.0005
##    180        0.0980             nan     0.1000   -0.0017
##    200        0.0934             nan     0.1000   -0.0008
##    220        0.0906             nan     0.1000    0.0001
##    240        0.0872             nan     0.1000   -0.0005
##    260        0.0837             nan     0.1000   -0.0011
##    280        0.0809             nan     0.1000   -0.0003
##    300        0.0775             nan     0.1000    0.0002
##    320        0.0746             nan     0.1000   -0.0002
##    340        0.0730             nan     0.1000   -0.0007
##    360        0.0715             nan     0.1000   -0.0005
##    380        0.0686             nan     0.1000   -0.0005
##    400        0.0677             nan     0.1000   -0.0004
##    420        0.0662             nan     0.1000   -0.0005
##    440        0.0656             nan     0.1000   -0.0004
##    460        0.0640             nan     0.1000   -0.0008
##    480        0.0640             nan     0.1000   -0.0005
##    500        0.0624             nan     0.1000   -0.0006
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1349             nan     0.1000    0.0777
##      2        1.0132             nan     0.1000    0.0609
##      3        0.9132             nan     0.1000    0.0517
##      4        0.8321             nan     0.1000    0.0363
##      5        0.7590             nan     0.1000    0.0348
##      6        0.6956             nan     0.1000    0.0303
##      7        0.6448             nan     0.1000    0.0252
##      8        0.5950             nan     0.1000    0.0228
##      9        0.5534             nan     0.1000    0.0191
##     10        0.5143             nan     0.1000    0.0172
##     20        0.2924             nan     0.1000    0.0059
##     40        0.1708             nan     0.1000   -0.0005
##     60        0.1252             nan     0.1000   -0.0010
##     80        0.0978             nan     0.1000   -0.0009
##    100        0.0808             nan     0.1000   -0.0002
##    120        0.0700             nan     0.1000   -0.0004
##    140        0.0605             nan     0.1000   -0.0001
##    160        0.0513             nan     0.1000   -0.0005
##    180        0.0461             nan     0.1000   -0.0005
##    200        0.0397             nan     0.1000   -0.0002
##    220        0.0359             nan     0.1000   -0.0004
##    240        0.0316             nan     0.1000   -0.0001
##    260        0.0287             nan     0.1000   -0.0002
##    280        0.0260             nan     0.1000   -0.0002
##    300        0.0235             nan     0.1000   -0.0001
##    320        0.0221             nan     0.1000   -0.0002
##    340        0.0203             nan     0.1000   -0.0004
##    360        0.0177             nan     0.1000   -0.0001
##    380        0.0161             nan     0.1000   -0.0002
##    400        0.0142             nan     0.1000   -0.0001
##    420        0.0128             nan     0.1000   -0.0002
##    440        0.0118             nan     0.1000   -0.0000
##    460        0.0105             nan     0.1000   -0.0001
##    480        0.0093             nan     0.1000   -0.0001
##    500        0.0087             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1351             nan     0.1000    0.0762
##      2        1.0134             nan     0.1000    0.0566
##      3        0.9129             nan     0.1000    0.0478
##      4        0.8316             nan     0.1000    0.0415
##      5        0.7607             nan     0.1000    0.0349
##      6        0.6939             nan     0.1000    0.0330
##      7        0.6405             nan     0.1000    0.0233
##      8        0.5900             nan     0.1000    0.0245
##      9        0.5457             nan     0.1000    0.0215
##     10        0.5070             nan     0.1000    0.0177
##     20        0.2781             nan     0.1000    0.0050
##     40        0.1420             nan     0.1000    0.0008
##     60        0.0982             nan     0.1000   -0.0009
##     80        0.0759             nan     0.1000   -0.0006
##    100        0.0561             nan     0.1000   -0.0002
##    120        0.0433             nan     0.1000   -0.0003
##    140        0.0334             nan     0.1000   -0.0006
##    160        0.0274             nan     0.1000   -0.0001
##    180        0.0228             nan     0.1000   -0.0001
##    200        0.0188             nan     0.1000   -0.0000
##    220        0.0159             nan     0.1000   -0.0002
##    240        0.0130             nan     0.1000    0.0000
##    260        0.0110             nan     0.1000   -0.0001
##    280        0.0095             nan     0.1000   -0.0002
##    300        0.0080             nan     0.1000   -0.0001
##    320        0.0070             nan     0.1000   -0.0001
##    340        0.0061             nan     0.1000   -0.0001
##    360        0.0051             nan     0.1000    0.0000
##    380        0.0042             nan     0.1000   -0.0000
##    400        0.0035             nan     0.1000   -0.0001
##    420        0.0029             nan     0.1000   -0.0000
##    440        0.0024             nan     0.1000   -0.0000
##    460        0.0020             nan     0.1000   -0.0000
##    480        0.0016             nan     0.1000   -0.0000
##    500        0.0014             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1318             nan     0.1000    0.0754
##      2        1.0063             nan     0.1000    0.0592
##      3        0.9009             nan     0.1000    0.0511
##      4        0.8209             nan     0.1000    0.0364
##      5        0.7440             nan     0.1000    0.0350
##      6        0.6802             nan     0.1000    0.0292
##      7        0.6276             nan     0.1000    0.0232
##      8        0.5778             nan     0.1000    0.0223
##      9        0.5346             nan     0.1000    0.0211
##     10        0.4963             nan     0.1000    0.0193
##     20        0.2649             nan     0.1000    0.0055
##     40        0.1214             nan     0.1000   -0.0004
##     60        0.0760             nan     0.1000   -0.0006
##     80        0.0575             nan     0.1000   -0.0008
##    100        0.0426             nan     0.1000   -0.0007
##    120        0.0300             nan     0.1000   -0.0004
##    140        0.0227             nan     0.1000   -0.0003
##    160        0.0177             nan     0.1000   -0.0001
##    180        0.0132             nan     0.1000   -0.0001
##    200        0.0103             nan     0.1000   -0.0001
##    220        0.0080             nan     0.1000   -0.0000
##    240        0.0065             nan     0.1000   -0.0001
##    260        0.0052             nan     0.1000   -0.0001
##    280        0.0042             nan     0.1000   -0.0001
##    300        0.0033             nan     0.1000   -0.0000
##    320        0.0024             nan     0.1000   -0.0000
##    340        0.0021             nan     0.1000   -0.0000
##    360        0.0018             nan     0.1000   -0.0000
##    380        0.0016             nan     0.1000   -0.0001
##    400        0.0013             nan     0.1000   -0.0000
##    420        0.0010             nan     0.1000    0.0000
##    440        0.0008             nan     0.1000   -0.0000
##    460        0.0006             nan     0.1000   -0.0000
##    480        0.0005             nan     0.1000   -0.0000
##    500        0.0004             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1364             nan     0.1000    0.0751
##      2        1.0112             nan     0.1000    0.0606
##      3        0.9097             nan     0.1000    0.0465
##      4        0.8215             nan     0.1000    0.0454
##      5        0.7483             nan     0.1000    0.0345
##      6        0.6827             nan     0.1000    0.0306
##      7        0.6260             nan     0.1000    0.0263
##      8        0.5801             nan     0.1000    0.0206
##      9        0.5385             nan     0.1000    0.0189
##     10        0.4989             nan     0.1000    0.0172
##     20        0.2594             nan     0.1000    0.0059
##     40        0.1147             nan     0.1000    0.0008
##     60        0.0709             nan     0.1000   -0.0014
##     80        0.0460             nan     0.1000   -0.0006
##    100        0.0315             nan     0.1000   -0.0003
##    120        0.0214             nan     0.1000   -0.0002
##    140        0.0160             nan     0.1000   -0.0003
##    160        0.0114             nan     0.1000   -0.0003
##    180        0.0091             nan     0.1000   -0.0002
##    200        0.0067             nan     0.1000    0.0000
##    220        0.0049             nan     0.1000   -0.0001
##    240        0.0037             nan     0.1000   -0.0001
##    260        0.0028             nan     0.1000   -0.0001
##    280        0.0020             nan     0.1000   -0.0000
##    300        0.0014             nan     0.1000   -0.0000
##    320        0.0011             nan     0.1000   -0.0000
##    340        0.0009             nan     0.1000   -0.0000
##    360        0.0007             nan     0.1000   -0.0000
##    380        0.0005             nan     0.1000   -0.0000
##    400        0.0004             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0003             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000    0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1330             nan     0.1000    0.0734
##      2        1.0096             nan     0.1000    0.0591
##      3        0.9074             nan     0.1000    0.0469
##      4        0.8220             nan     0.1000    0.0383
##      5        0.7435             nan     0.1000    0.0371
##      6        0.6788             nan     0.1000    0.0277
##      7        0.6284             nan     0.1000    0.0221
##      8        0.5749             nan     0.1000    0.0237
##      9        0.5341             nan     0.1000    0.0186
##     10        0.4962             nan     0.1000    0.0163
##     20        0.2647             nan     0.1000    0.0054
##     40        0.1160             nan     0.1000    0.0003
##     60        0.0678             nan     0.1000   -0.0004
##     80        0.0453             nan     0.1000   -0.0005
##    100        0.0302             nan     0.1000   -0.0003
##    120        0.0192             nan     0.1000   -0.0004
##    140        0.0121             nan     0.1000   -0.0002
##    160        0.0081             nan     0.1000   -0.0000
##    180        0.0058             nan     0.1000   -0.0001
##    200        0.0041             nan     0.1000   -0.0000
##    220        0.0028             nan     0.1000   -0.0001
##    240        0.0021             nan     0.1000   -0.0001
##    260        0.0015             nan     0.1000   -0.0000
##    280        0.0011             nan     0.1000   -0.0000
##    300        0.0008             nan     0.1000   -0.0000
##    320        0.0006             nan     0.1000   -0.0000
##    340        0.0005             nan     0.1000   -0.0000
##    360        0.0004             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1286             nan     0.1000    0.0762
##      2        1.0057             nan     0.1000    0.0573
##      3        0.9064             nan     0.1000    0.0462
##      4        0.8172             nan     0.1000    0.0419
##      5        0.7359             nan     0.1000    0.0343
##      6        0.6717             nan     0.1000    0.0288
##      7        0.6160             nan     0.1000    0.0274
##      8        0.5663             nan     0.1000    0.0222
##      9        0.5248             nan     0.1000    0.0180
##     10        0.4818             nan     0.1000    0.0205
##     20        0.2629             nan     0.1000    0.0039
##     40        0.1285             nan     0.1000   -0.0005
##     60        0.0668             nan     0.1000   -0.0005
##     80        0.0357             nan     0.1000   -0.0002
##    100        0.0240             nan     0.1000   -0.0004
##    120        0.0180             nan     0.1000   -0.0003
##    140        0.0120             nan     0.1000   -0.0002
##    160        0.0087             nan     0.1000   -0.0002
##    180        0.0054             nan     0.1000    0.0000
##    200        0.0037             nan     0.1000   -0.0000
##    220        0.0023             nan     0.1000   -0.0000
##    240        0.0017             nan     0.1000   -0.0000
##    260        0.0013             nan     0.1000   -0.0000
##    280        0.0011             nan     0.1000   -0.0000
##    300        0.0008             nan     0.1000   -0.0000
##    320        0.0006             nan     0.1000   -0.0000
##    340        0.0004             nan     0.1000   -0.0000
##    360        0.0003             nan     0.1000   -0.0000
##    380        0.0002             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0001             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0000             nan     0.1000    0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1362             nan     0.1000    0.0808
##      2        1.0087             nan     0.1000    0.0627
##      3        0.9071             nan     0.1000    0.0496
##      4        0.8222             nan     0.1000    0.0395
##      5        0.7433             nan     0.1000    0.0381
##      6        0.6755             nan     0.1000    0.0337
##      7        0.6213             nan     0.1000    0.0239
##      8        0.5722             nan     0.1000    0.0228
##      9        0.5321             nan     0.1000    0.0158
##     10        0.4904             nan     0.1000    0.0189
##     20        0.2564             nan     0.1000    0.0045
##     40        0.0965             nan     0.1000   -0.0001
##     60        0.0489             nan     0.1000   -0.0003
##     80        0.0306             nan     0.1000   -0.0005
##    100        0.0174             nan     0.1000   -0.0001
##    120        0.0129             nan     0.1000   -0.0003
##    140        0.0081             nan     0.1000   -0.0001
##    160        0.0053             nan     0.1000   -0.0001
##    180        0.0037             nan     0.1000   -0.0001
##    200        0.0027             nan     0.1000   -0.0001
##    220        0.0022             nan     0.1000   -0.0001
##    240        0.0019             nan     0.1000   -0.0001
##    260        0.0014             nan     0.1000   -0.0000
##    280        0.0009             nan     0.1000   -0.0000
##    300        0.0006             nan     0.1000   -0.0000
##    320        0.0006             nan     0.1000   -0.0000
##    340        0.0005             nan     0.1000   -0.0000
##    360        0.0003             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000    0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000    0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1323             nan     0.1000    0.0686
##      2        1.0041             nan     0.1000    0.0634
##      3        0.9018             nan     0.1000    0.0488
##      4        0.8174             nan     0.1000    0.0390
##      5        0.7427             nan     0.1000    0.0371
##      6        0.6804             nan     0.1000    0.0292
##      7        0.6201             nan     0.1000    0.0280
##      8        0.5749             nan     0.1000    0.0218
##      9        0.5313             nan     0.1000    0.0205
##     10        0.4973             nan     0.1000    0.0148
##     20        0.2640             nan     0.1000    0.0067
##     40        0.1056             nan     0.1000    0.0006
##     60        0.0576             nan     0.1000   -0.0006
##     80        0.0341             nan     0.1000   -0.0007
##    100        0.0230             nan     0.1000   -0.0004
##    120        0.0153             nan     0.1000   -0.0003
##    140        0.0107             nan     0.1000   -0.0003
##    160        0.0075             nan     0.1000   -0.0002
##    180        0.0065             nan     0.1000   -0.0002
##    200        0.0044             nan     0.1000   -0.0001
##    220        0.0036             nan     0.1000   -0.0002
##    240        0.0022             nan     0.1000   -0.0000
##    260        0.0017             nan     0.1000   -0.0001
##    280        0.0015             nan     0.1000   -0.0001
##    300        0.0009             nan     0.1000   -0.0000
##    320        0.0008             nan     0.1000   -0.0000
##    340        0.0006             nan     0.1000   -0.0000
##    360        0.0003             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000    0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0003             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1306             nan     0.1000    0.0777
##      2        1.0014             nan     0.1000    0.0570
##      3        0.9031             nan     0.1000    0.0472
##      4        0.8138             nan     0.1000    0.0431
##      5        0.7376             nan     0.1000    0.0373
##      6        0.6702             nan     0.1000    0.0295
##      7        0.6145             nan     0.1000    0.0252
##      8        0.5651             nan     0.1000    0.0225
##      9        0.5198             nan     0.1000    0.0198
##     10        0.4833             nan     0.1000    0.0155
##     20        0.2539             nan     0.1000    0.0061
##     40        0.1016             nan     0.1000   -0.0001
##     60        0.0497             nan     0.1000   -0.0006
##     80        0.0287             nan     0.1000   -0.0000
##    100        0.0167             nan     0.1000   -0.0003
##    120        0.0102             nan     0.1000   -0.0002
##    140        0.0076             nan     0.1000   -0.0003
##    160        0.0046             nan     0.1000    0.0000
##    180        0.0036             nan     0.1000   -0.0001
##    200        0.0024             nan     0.1000   -0.0000
##    220        0.0021             nan     0.1000   -0.0001
##    240        0.0018             nan     0.1000   -0.0000
##    260        0.0014             nan     0.1000   -0.0000
##    280        0.0012             nan     0.1000   -0.0001
##    300        0.0008             nan     0.1000   -0.0000
##    320        0.0007             nan     0.1000   -0.0000
##    340        0.0005             nan     0.1000   -0.0000
##    360        0.0006             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0001             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000    0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1327             nan     0.1000    0.0755
##      2        1.0042             nan     0.1000    0.0633
##      3        0.9032             nan     0.1000    0.0484
##      4        0.8145             nan     0.1000    0.0408
##      5        0.7413             nan     0.1000    0.0335
##      6        0.6778             nan     0.1000    0.0302
##      7        0.6235             nan     0.1000    0.0242
##      8        0.5730             nan     0.1000    0.0226
##      9        0.5296             nan     0.1000    0.0196
##     10        0.4911             nan     0.1000    0.0161
##     20        0.2733             nan     0.1000    0.0062
##     40        0.1181             nan     0.1000    0.0005
##     60        0.0695             nan     0.1000   -0.0006
##     80        0.0437             nan     0.1000   -0.0004
##    100        0.0306             nan     0.1000   -0.0004
##    120        0.0222             nan     0.1000   -0.0004
##    140        0.0152             nan     0.1000   -0.0003
##    160        0.0111             nan     0.1000   -0.0001
##    180        0.0080             nan     0.1000   -0.0001
##    200        0.0056             nan     0.1000   -0.0001
##    220        0.0040             nan     0.1000   -0.0000
##    240        0.0028             nan     0.1000   -0.0000
##    260        0.0021             nan     0.1000   -0.0000
##    280        0.0016             nan     0.1000   -0.0000
##    300        0.0012             nan     0.1000   -0.0000
##    320        0.0009             nan     0.1000   -0.0000
##    340        0.0007             nan     0.1000   -0.0000
##    360        0.0006             nan     0.1000   -0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="machine-learning.html#cb70-1" tabindex="-1"></a><span class="fu">summary</span>(gbm)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-4-1.png" width="672" /></p>
<pre><code>##                                 var      rel.inf
## Cell.size.L             Cell.size.L 3.691085e+01
## Cell.shape.L           Cell.shape.L 3.352600e+01
## Cl.thickness.L       Cl.thickness.L 4.965665e+00
## Marg.adhesion.L     Marg.adhesion.L 2.933673e+00
## Epith.c.size.Q       Epith.c.size.Q 2.113795e+00
## Cell.size^8             Cell.size^8 1.847047e+00
## Epith.c.size.L       Epith.c.size.L 1.683156e+00
## Cell.shape^8           Cell.shape^8 1.229586e+00
## Cell.size^4             Cell.size^4 1.143472e+00
## Marg.adhesion^9     Marg.adhesion^9 1.056156e+00
## Marg.adhesion^5     Marg.adhesion^5 9.743726e-01
## Cell.size^5             Cell.size^5 7.047590e-01
## Epith.c.size^8       Epith.c.size^8 6.461022e-01
## Cell.size^7             Cell.size^7 6.118808e-01
## Cell.size.Q             Cell.size.Q 6.079505e-01
## Cl.thickness^9       Cl.thickness^9 5.640595e-01
## Cell.shape^9           Cell.shape^9 4.917112e-01
## Bl.cromatin5           Bl.cromatin5 4.778087e-01
## Bl.cromatin4           Bl.cromatin4 4.620270e-01
## Cell.size^9             Cell.size^9 4.150179e-01
## Marg.adhesion.C     Marg.adhesion.C 3.930988e-01
## Cl.thickness^7       Cl.thickness^7 3.905901e-01
## Marg.adhesion^8     Marg.adhesion^8 3.898080e-01
## Epith.c.size^9       Epith.c.size^9 3.869839e-01
## Cl.thickness^6       Cl.thickness^6 3.857848e-01
## Cell.shape^7           Cell.shape^7 3.399454e-01
## Cl.thickness^4       Cl.thickness^4 3.041098e-01
## Cell.size^6             Cell.size^6 2.973393e-01
## Cell.shape^4           Cell.shape^4 2.903475e-01
## Marg.adhesion^7     Marg.adhesion^7 2.897045e-01
## Cell.shape.Q           Cell.shape.Q 2.866104e-01
## Marg.adhesion^4     Marg.adhesion^4 2.855576e-01
## Epith.c.size^6       Epith.c.size^6 2.762241e-01
## Cell.shape.C           Cell.shape.C 2.617251e-01
## Cl.thickness.Q       Cl.thickness.Q 2.533263e-01
## Cl.thickness^8       Cl.thickness^8 2.287122e-01
## Marg.adhesion.Q     Marg.adhesion.Q 2.209701e-01
## Cell.size.C             Cell.size.C 2.027992e-01
## Epith.c.size^7       Epith.c.size^7 1.962867e-01
## Bl.cromatin3           Bl.cromatin3 1.347193e-01
## Epith.c.size^5       Epith.c.size^5 1.027456e-01
## Cell.shape^6           Cell.shape^6 9.135224e-02
## Epith.c.size.C       Epith.c.size.C 7.799872e-02
## Mitoses2                   Mitoses2 7.275433e-02
## Normal.nucleoli4   Normal.nucleoli4 6.369412e-02
## Cl.thickness^5       Cl.thickness^5 6.250742e-02
## Cell.shape^5           Cell.shape^5 5.888088e-02
## Cl.thickness.C       Cl.thickness.C 5.784223e-02
## Normal.nucleoli10 Normal.nucleoli10 5.642045e-02
## Epith.c.size^4       Epith.c.size^4 5.230402e-02
## Normal.nucleoli8   Normal.nucleoli8 4.854562e-02
## Marg.adhesion^6     Marg.adhesion^6 3.690114e-02
## Bl.cromatin7           Bl.cromatin7 3.293722e-02
## Normal.nucleoli3   Normal.nucleoli3 4.768045e-03
## Normal.nucleoli2   Normal.nucleoli2 5.727921e-04
## Bl.cromatin8           Bl.cromatin8 4.571245e-05
## Bl.cromatin2           Bl.cromatin2 1.529291e-06
## Bl.cromatin6           Bl.cromatin6 0.000000e+00
## Bl.cromatin9           Bl.cromatin9 0.000000e+00
## Bl.cromatin10         Bl.cromatin10 0.000000e+00
## Normal.nucleoli5   Normal.nucleoli5 0.000000e+00
## Normal.nucleoli6   Normal.nucleoli6 0.000000e+00
## Normal.nucleoli7   Normal.nucleoli7 0.000000e+00
## Normal.nucleoli9   Normal.nucleoli9 0.000000e+00
## Mitoses3                   Mitoses3 0.000000e+00
## Mitoses4                   Mitoses4 0.000000e+00
## Mitoses5                   Mitoses5 0.000000e+00
## Mitoses6                   Mitoses6 0.000000e+00
## Mitoses7                   Mitoses7 0.000000e+00
## Mitoses8                   Mitoses8 0.000000e+00
## Mitoses10                 Mitoses10 0.000000e+00</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="machine-learning.html#cb72-1" tabindex="-1"></a>pred_gbm<span class="ot">&lt;-</span><span class="fu">predict</span>(gbm,BreastCancer)</span>
<span id="cb72-2"><a href="machine-learning.html#cb72-2" tabindex="-1"></a><span class="fu">confusionMatrix</span>(pred_gbm, BreastCancer<span class="sc">$</span>Class)</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##            Reference
## Prediction  benign malignant
##   benign       456        11
##   malignant      2       230
##                                           
##                Accuracy : 0.9814          
##                  95% CI : (0.9684, 0.9901)
##     No Information Rate : 0.6552          
##     P-Value [Acc &gt; NIR] : &lt;2e-16          
##                                           
##                   Kappa : 0.9585          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.0265          
##                                           
##             Sensitivity : 0.9956          
##             Specificity : 0.9544          
##          Pos Pred Value : 0.9764          
##          Neg Pred Value : 0.9914          
##              Prevalence : 0.6552          
##          Detection Rate : 0.6524          
##    Detection Prevalence : 0.6681          
##       Balanced Accuracy : 0.9750          
##                                           
##        &#39;Positive&#39; Class : benign          
## </code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="machine-learning.html#cb74-1" tabindex="-1"></a>roc_gbm<span class="ot">&lt;-</span>pROC<span class="sc">::</span><span class="fu">roc</span>(BreastCancer<span class="sc">$</span>Class, <span class="fu">as.numeric</span>(pred_gbm))</span></code></pre></div>
<pre><code>## Setting levels: control = benign, case = malignant</code></pre>
<pre><code>## Setting direction: controls &lt; cases</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="machine-learning.html#cb77-1" tabindex="-1"></a>roc_gbm</span></code></pre></div>
<pre><code>## 
## Call:
## roc.default(response = BreastCancer$Class, predictor = as.numeric(pred_gbm))
## 
## Data: as.numeric(pred_gbm) in 458 controls (BreastCancer$Class benign) &lt; 241 cases (BreastCancer$Class malignant).
## Area under the curve: 0.975</code></pre>
</div>
<div id="extreme-gradient-boost-machine" class="section level4 hasAnchor" number="6.2.2.2">
<h4><span class="header-section-number">6.2.2.2</span> Extreme gradient boost machine<a href="machine-learning.html#extreme-gradient-boost-machine" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In the examples above, the outcome variable is treated as a factor. Extreme gradient boost machine <em>xgboost</em> requires conversion to numeric variable.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="machine-learning.html#cb79-1" tabindex="-1"></a><span class="fu">library</span>(xgboost)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;xgboost&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     slice</code></pre>
<pre><code>## The following object is masked from &#39;package:rattle&#39;:
## 
##     xgboost</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="machine-learning.html#cb83-1" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb83-2"><a href="machine-learning.html#cb83-2" tabindex="-1"></a></span>
<span id="cb83-3"><a href="machine-learning.html#cb83-3" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;BreastCancer&quot;</span>,<span class="at">package =</span> <span class="st">&quot;mlbench&quot;</span>)</span>
<span id="cb83-4"><a href="machine-learning.html#cb83-4" tabindex="-1"></a><span class="co">#predict breast cancer</span></span>
<span id="cb83-5"><a href="machine-learning.html#cb83-5" tabindex="-1"></a></span>
<span id="cb83-6"><a href="machine-learning.html#cb83-6" tabindex="-1"></a>BreastCancer<span class="sc">$</span>Class<span class="ot">&lt;-</span><span class="fu">as.character</span>(BreastCancer<span class="sc">$</span>Class)</span>
<span id="cb83-7"><a href="machine-learning.html#cb83-7" tabindex="-1"></a>BreastCancer<span class="sc">$</span>Class[BreastCancer<span class="sc">$</span>Class<span class="sc">==</span><span class="st">&quot;benign&quot;</span>]<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb83-8"><a href="machine-learning.html#cb83-8" tabindex="-1"></a>BreastCancer<span class="sc">$</span>Class[BreastCancer<span class="sc">$</span>Class<span class="sc">==</span><span class="st">&quot;malignant&quot;</span>]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb83-9"><a href="machine-learning.html#cb83-9" tabindex="-1"></a>BreastCancer<span class="sc">$</span>Class<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(BreastCancer<span class="sc">$</span>Class)</span>
<span id="cb83-10"><a href="machine-learning.html#cb83-10" tabindex="-1"></a></span>
<span id="cb83-11"><a href="machine-learning.html#cb83-11" tabindex="-1"></a><span class="co">#remove ID column</span></span>
<span id="cb83-12"><a href="machine-learning.html#cb83-12" tabindex="-1"></a><span class="co">#remove column a=with NA </span></span>
<span id="cb83-13"><a href="machine-learning.html#cb83-13" tabindex="-1"></a><span class="co">#remaining 9 columns</span></span>
<span id="cb83-14"><a href="machine-learning.html#cb83-14" tabindex="-1"></a><span class="co">#convert multiple columns to numeric</span></span>
<span id="cb83-15"><a href="machine-learning.html#cb83-15" tabindex="-1"></a><span class="co">#lapply output a list</span></span>
<span id="cb83-16"><a href="machine-learning.html#cb83-16" tabindex="-1"></a>BreastCancer2<span class="ot">&lt;-</span><span class="fu">lapply</span>(BreastCancer[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>)], as.numeric)</span>
<span id="cb83-17"><a href="machine-learning.html#cb83-17" tabindex="-1"></a>BreastCancer2<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(BreastCancer2)</span>
<span id="cb83-18"><a href="machine-learning.html#cb83-18" tabindex="-1"></a></span>
<span id="cb83-19"><a href="machine-learning.html#cb83-19" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb83-20"><a href="machine-learning.html#cb83-20" tabindex="-1"></a>parts <span class="ot">=</span> <span class="fu">createDataPartition</span>(BreastCancer2<span class="sc">$</span>Class, <span class="at">p =</span> <span class="fl">0.75</span>, <span class="at">list=</span>F)</span>
<span id="cb83-21"><a href="machine-learning.html#cb83-21" tabindex="-1"></a>train <span class="ot">=</span> BreastCancer2[parts, ]</span>
<span id="cb83-22"><a href="machine-learning.html#cb83-22" tabindex="-1"></a>test <span class="ot">=</span> BreastCancer2[<span class="sc">-</span>parts, ]</span>
<span id="cb83-23"><a href="machine-learning.html#cb83-23" tabindex="-1"></a></span>
<span id="cb83-24"><a href="machine-learning.html#cb83-24" tabindex="-1"></a>X_train <span class="ot">=</span> <span class="fu">data.matrix</span>(train[,<span class="sc">-</span><span class="dv">9</span>])          <span class="co"># independent variables for train</span></span>
<span id="cb83-25"><a href="machine-learning.html#cb83-25" tabindex="-1"></a>y_train <span class="ot">=</span> train[,<span class="dv">9</span>]                        <span class="co"># dependent variables for train</span></span>
<span id="cb83-26"><a href="machine-learning.html#cb83-26" tabindex="-1"></a>X_test <span class="ot">=</span> <span class="fu">data.matrix</span>(test[,<span class="sc">-</span><span class="dv">9</span>])            <span class="co"># independent variables for test</span></span>
<span id="cb83-27"><a href="machine-learning.html#cb83-27" tabindex="-1"></a>y_test <span class="ot">=</span> test[,<span class="dv">9</span>]                          <span class="co"># dependent variables for test</span></span>
<span id="cb83-28"><a href="machine-learning.html#cb83-28" tabindex="-1"></a></span>
<span id="cb83-29"><a href="machine-learning.html#cb83-29" tabindex="-1"></a><span class="co"># convert the train and test data into xgboost matrix type.</span></span>
<span id="cb83-30"><a href="machine-learning.html#cb83-30" tabindex="-1"></a>xgboost_train <span class="ot">=</span> <span class="fu">xgb.DMatrix</span>(<span class="at">data=</span>X_train, <span class="at">label=</span><span class="fu">as.matrix</span>(y_train))</span>
<span id="cb83-31"><a href="machine-learning.html#cb83-31" tabindex="-1"></a>xgboost_test <span class="ot">=</span> <span class="fu">xgb.DMatrix</span>(<span class="at">data=</span>X_test, <span class="at">label=</span><span class="fu">as.matrix</span>(y_test))</span>
<span id="cb83-32"><a href="machine-learning.html#cb83-32" tabindex="-1"></a></span>
<span id="cb83-33"><a href="machine-learning.html#cb83-33" tabindex="-1"></a><span class="co"># train a model using our training data</span></span>
<span id="cb83-34"><a href="machine-learning.html#cb83-34" tabindex="-1"></a><span class="co"># nthread is the number of CPU threads we use</span></span>
<span id="cb83-35"><a href="machine-learning.html#cb83-35" tabindex="-1"></a><span class="co"># nrounds is the number of passes on the data</span></span>
<span id="cb83-36"><a href="machine-learning.html#cb83-36" tabindex="-1"></a></span>
<span id="cb83-37"><a href="machine-learning.html#cb83-37" tabindex="-1"></a><span class="co">#the function xgboost exist in xgboost and rattle</span></span>
<span id="cb83-38"><a href="machine-learning.html#cb83-38" tabindex="-1"></a>model <span class="ot">&lt;-</span> xgboost<span class="sc">::</span><span class="fu">xgboost</span>(<span class="at">data =</span> xgboost_train, <span class="at">max.depth =</span> <span class="dv">2</span>, <span class="at">eta =</span> <span class="dv">1</span>, <span class="at">nthread =</span> <span class="dv">2</span>, <span class="at">nrounds =</span> <span class="dv">2</span>, <span class="at">objective =</span> <span class="st">&quot;binary:logistic&quot;</span>, <span class="at">verbose =</span> <span class="dv">2</span>)                           </span></code></pre></div>
<pre><code>## [1]  train-logloss:0.221760 
## [2]  train-logloss:0.129150</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="machine-learning.html#cb85-1" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>##                Length Class              Mode       
## handle            1   xgb.Booster.handle externalptr
## raw            5890   -none-             raw        
## niter             1   -none-             numeric    
## evaluation_log    2   data.table         list       
## call             17   -none-             call       
## params            5   -none-             list       
## callbacks         2   -none-             list       
## feature_names     8   -none-             character  
## nfeatures         1   -none-             numeric</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="machine-learning.html#cb87-1" tabindex="-1"></a><span class="co">#use model to make predictions on test data</span></span>
<span id="cb87-2"><a href="machine-learning.html#cb87-2" tabindex="-1"></a>pred_test <span class="ot">=</span> <span class="fu">predict</span>(model, xgboost_test)</span>
<span id="cb87-3"><a href="machine-learning.html#cb87-3" tabindex="-1"></a>pred_test</span></code></pre></div>
<pre><code>##   [1] 0.04247886 0.04247886 0.93661994 0.04247886 0.04247886 0.93661994
##   [7] 0.04247886 0.04247886 0.50793731 0.84730983 0.04247886 0.04247886
##  [13] 0.04247886 0.93661994 0.13179043 0.61858213 0.04247886 0.93661994
##  [19] 0.04247886 0.90757442 0.04247886 0.93661994 0.50793731 0.10175808
##  [25] 0.04247886 0.13179043 0.04247886 0.04247886 0.04247886 0.04247886
##  [31] 0.04247886 0.04247886 0.04247886 0.93661994 0.90757442 0.90757442
##  [37] 0.93661994 0.90757442 0.04247886 0.61858213 0.04247886 0.04247886
##  [43] 0.04247886 0.04247886 0.04247886 0.93661994 0.04247886 0.61858213
##  [49] 0.04247886 0.04247886 0.93661994 0.61858213 0.93661994 0.04247886
##  [55] 0.93661994 0.04247886 0.04247886 0.04247886 0.04247886 0.93661994
##  [61] 0.93661994 0.04247886 0.93661994 0.93661994 0.04247886 0.93661994
##  [67] 0.13179043 0.04247886 0.93661994 0.61858213 0.04247886 0.93661994
##  [73] 0.04247886 0.04247886 0.04247886 0.04247886 0.93661994 0.93661994
##  [79] 0.04247886 0.28787071 0.84532809 0.04247886 0.04247886 0.04247886
##  [85] 0.04247886 0.93661994 0.93661994 0.93661994 0.04247886 0.84730983
##  [91] 0.04247886 0.61858213 0.84730983 0.04247886 0.93661994 0.93661994
##  [97] 0.93661994 0.61858213 0.04247886 0.04247886 0.04247886 0.04247886
## [103] 0.84730983 0.93661994 0.04247886 0.04247886 0.04247886 0.04247886
## [109] 0.04247886 0.93661994 0.10175808 0.04247886 0.10175808 0.61858213
## [115] 0.90757442 0.04247886 0.04247886 0.04247886 0.04247886 0.93661994
## [121] 0.04247886 0.04247886 0.04247886 0.04247886 0.04247886 0.93661994
## [127] 0.04247886 0.93661994 0.04247886 0.04247886 0.04247886 0.04247886
## [133] 0.04247886 0.04247886 0.93661994 0.04247886 0.04247886 0.93661994
## [139] 0.04247886 0.04247886 0.04247886 0.93661994 0.93661994 0.13179043
## [145] 0.04247886 0.04247886 0.04247886 0.04247886 0.93661994 0.04247886
## [151] 0.04247886 0.04247886 0.93661994 0.04247886 0.93661994 0.93661994
## [157] 0.04247886 0.93661994 0.93661994 0.10175808 0.04247886 0.04247886
## [163] 0.04247886 0.04247886 0.04247886 0.61858213 0.04247886 0.93661994
## [169] 0.04247886 0.10175808 0.04247886 0.93661994 0.04247886 0.93661994</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="machine-learning.html#cb89-1" tabindex="-1"></a><span class="co">#classify 1 if prediction &gt;.5</span></span>
<span id="cb89-2"><a href="machine-learning.html#cb89-2" tabindex="-1"></a>prediction <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(pred_test <span class="sc">&gt;</span> <span class="fl">0.5</span>)</span>
<span id="cb89-3"><a href="machine-learning.html#cb89-3" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(prediction))</span></code></pre></div>
<pre><code>## [1] 0 0 1 0 0 1</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="machine-learning.html#cb91-1" tabindex="-1"></a>err <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(pred_test <span class="sc">&gt;</span> <span class="fl">0.5</span>) <span class="sc">!=</span> y_test)</span>
<span id="cb91-2"><a href="machine-learning.html#cb91-2" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;test-error=&quot;</span>, err))</span></code></pre></div>
<pre><code>## [1] &quot;test-error= 0.0632183908045977&quot;</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="machine-learning.html#cb93-1" tabindex="-1"></a><span class="co">#plot of the first 2 trees</span></span>
<span id="cb93-2"><a href="machine-learning.html#cb93-2" tabindex="-1"></a><span class="fu">xgb.plot.tree</span>(<span class="at">model =</span> model, <span class="at">trees =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span></code></pre></div>
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-d8261ae57dcb32e0c2b4" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-d8261ae57dcb32e0c2b4">{"x":{"diagram":"digraph {\n\ngraph [layout = \"dot\",\n       rankdir = \"LR\"]\n\nnode [color = \"DimGray\",\n      style = \"filled\",\n      fontname = \"Helvetica\"]\n\nedge [color = \"DimGray\",\n     arrowsize = \"1.5\",\n     arrowhead = \"vee\",\n     fontname = \"Helvetica\"]\n\n  \"1\" [label = \"Tree 1\nBl.cromatin\nCover: 64.5307846\nGain: 55.5894661\", shape = \"rectangle\", fontcolor = \"black\", fillcolor = \"Beige\"] \n  \"2\" [label = \"Cl.thickness\nCover: 42.5443878\nGain: 13.7194939\", shape = \"rectangle\", fontcolor = \"black\", fillcolor = \"Beige\"] \n  \"3\" [label = \"Epith.c.size\nCover: 21.9863949\nGain: 1.98490334\", shape = \"rectangle\", fontcolor = \"black\", fillcolor = \"Beige\"] \n  \"4\" [label = \"Leaf\nCover: 38.4290581\nValue: -1.17784131\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n  \"5\" [label = \"Leaf\nCover: 4.11532879\nValue: 0.622996688\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n  \"6\" [label = \"Leaf\nCover: 2.42281723\nValue: 0.0522798002\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n  \"7\" [label = \"Leaf\nCover: 19.5635796\nValue: 1.03175199\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n\"1\"->\"2\" [label = \"< 3.5\", style = \"bold\"] \n\"2\"->\"4\" [label = \"< 6.5\", style = \"bold\"] \n\"3\"->\"6\" [label = \"< 2.5\", style = \"bold\"] \n\"1\"->\"3\" [style = \"bold\", style = \"solid\"] \n\"2\"->\"5\" [style = \"solid\", style = \"solid\"] \n\"3\"->\"7\" [style = \"solid\", style = \"solid\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="bayesian-trees-method" class="section level3 hasAnchor" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> Bayesian trees method<a href="machine-learning.html#bayesian-trees-method" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="bart" class="section level4 hasAnchor" number="6.2.3.1">
<h4><span class="header-section-number">6.2.3.1</span> BART<a href="machine-learning.html#bart" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>BART or Bayesian additive regression trees is a non-parametric method that uses a sum of Bayesian trees to estimate an unknown function. Every tree acts as a weak learner in this ensemle method. It can also be used in causal inference. It uses tuning parameters derived from Bayesian priors. Each predicted value has a posterior distribution. BART uses a regularization prior that forces each tree to be able to explain only a limited subset of the relationships between the covariates and the predictor variable. In some instances, BART outperform xgboost.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="machine-learning.html#cb94-1" tabindex="-1"></a><span class="fu">library</span>(BART)</span></code></pre></div>
<pre><code>## Loading required package: nlme</code></pre>
<pre><code>## 
## Attaching package: &#39;nlme&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     collapse</code></pre>
<pre><code>## Loading required package: nnet</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="machine-learning.html#cb99-1" tabindex="-1"></a><span class="fu">data</span>(Melanoma, <span class="at">package =</span> <span class="st">&quot;MASS&quot;</span>)</span>
<span id="cb99-2"><a href="machine-learning.html#cb99-2" tabindex="-1"></a></span>
<span id="cb99-3"><a href="machine-learning.html#cb99-3" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">length</span>(Melanoma<span class="sc">$</span>status)</span>
<span id="cb99-4"><a href="machine-learning.html#cb99-4" tabindex="-1"></a></span>
<span id="cb99-5"><a href="machine-learning.html#cb99-5" tabindex="-1"></a><span class="co">#table(Melanoma$ph.karno, cancer$pat.karno)</span></span>
<span id="cb99-6"><a href="machine-learning.html#cb99-6" tabindex="-1"></a></span>
<span id="cb99-7"><a href="machine-learning.html#cb99-7" tabindex="-1"></a><span class="do">## if physician&#39;s KPS unavailable, then use the patient&#39;s</span></span>
<span id="cb99-8"><a href="machine-learning.html#cb99-8" tabindex="-1"></a><span class="co">#h &lt;- which(is.na(cancer$ph.karno))</span></span>
<span id="cb99-9"><a href="machine-learning.html#cb99-9" tabindex="-1"></a><span class="co">#cancer$ph.karno[h] &lt;- cancer$pat.karno[h]</span></span>
<span id="cb99-10"><a href="machine-learning.html#cb99-10" tabindex="-1"></a></span>
<span id="cb99-11"><a href="machine-learning.html#cb99-11" tabindex="-1"></a>times <span class="ot">&lt;-</span> Melanoma<span class="sc">$</span>time</span>
<span id="cb99-12"><a href="machine-learning.html#cb99-12" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(times<span class="sc">/</span><span class="dv">7</span>)  <span class="do">## weeks</span></span>
<span id="cb99-13"><a href="machine-learning.html#cb99-13" tabindex="-1"></a></span>
<span id="cb99-14"><a href="machine-learning.html#cb99-14" tabindex="-1"></a><span class="co">#1 died from melanoma, 2 alive, 3 dead from other causes.</span></span>
<span id="cb99-15"><a href="machine-learning.html#cb99-15" tabindex="-1"></a><span class="do">##delta: 0=censored, 1=dead</span></span>
<span id="cb99-16"><a href="machine-learning.html#cb99-16" tabindex="-1"></a>delta<span class="ot">=</span><span class="fu">ifelse</span>(Melanoma<span class="sc">$</span>status<span class="sc">==</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb99-17"><a href="machine-learning.html#cb99-17" tabindex="-1"></a></span>
<span id="cb99-18"><a href="machine-learning.html#cb99-18" tabindex="-1"></a><span class="do">## matrix of observed covariates</span></span>
<span id="cb99-19"><a href="machine-learning.html#cb99-19" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Melanoma<span class="sc">$</span>sex, Melanoma<span class="sc">$</span>age, Melanoma<span class="sc">$</span>thickness)</span>
<span id="cb99-20"><a href="machine-learning.html#cb99-20" tabindex="-1"></a></span>
<span id="cb99-21"><a href="machine-learning.html#cb99-21" tabindex="-1"></a><span class="co">#provide column names</span></span>
<span id="cb99-22"><a href="machine-learning.html#cb99-22" tabindex="-1"></a><span class="fu">dimnames</span>(x.train)[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;M(1):F(0)&#39;</span>,<span class="st">&#39;age&#39;</span>, <span class="st">&#39;thickness&#39;</span>)</span>
<span id="cb99-23"><a href="machine-learning.html#cb99-23" tabindex="-1"></a></span>
<span id="cb99-24"><a href="machine-learning.html#cb99-24" tabindex="-1"></a><span class="fu">table</span>(x.train[ , <span class="dv">1</span>])</span></code></pre></div>
<pre><code>## 
##   0   1 
## 126  79</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="machine-learning.html#cb101-1" tabindex="-1"></a><span class="fu">summary</span>(x.train[ , <span class="dv">2</span>])</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    4.00   42.00   54.00   52.46   65.00   95.00</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="machine-learning.html#cb103-1" tabindex="-1"></a><span class="fu">table</span>(x.train[ , <span class="dv">3</span>])</span></code></pre></div>
<pre><code>## 
##   0.1  0.16  0.24  0.32  0.48  0.58  0.64  0.65  0.81  0.97  1.03  1.13  1.29 
##     1     7     1     6     4     1     4    10    11    11     1     4    16 
##  1.34  1.37  1.45  1.53  1.62  1.76  1.78  1.94   2.1  2.24  2.26  2.34  2.42 
##     2     1     3     1    12     1     2    10     3     1     5     1     1 
##  2.58  2.74   2.9  3.06  3.22  3.54  3.56  3.87  4.04  4.09  4.19  4.51  4.82 
##     9     1     3     2    10     8     1     6     1     1     2     1     1 
##  4.83  4.84  5.16  5.48  5.64   5.8  6.12  6.44  6.76  7.06  7.09  7.41  7.73 
##     2     5     3     2     1     2     2     1     1     2     2     1     2 
##  7.89  8.06  8.38  8.54  9.66 12.08 12.24 12.56 12.88 13.85 14.66 17.42 
##     1     1     1     1     1     1     1     1     2     1     1     1</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="machine-learning.html#cb105-1" tabindex="-1"></a><span class="do">##test BART with token run to ensure installation works</span></span>
<span id="cb105-2"><a href="machine-learning.html#cb105-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">99</span>)</span>
<span id="cb105-3"><a href="machine-learning.html#cb105-3" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">surv.bart</span>(<span class="at">x.train=</span>x.train, <span class="at">times=</span>times, <span class="at">delta=</span>delta,</span>
<span id="cb105-4"><a href="machine-learning.html#cb105-4" tabindex="-1"></a>                  <span class="at">nskip=</span><span class="dv">1</span>, <span class="at">ndpost=</span><span class="dv">1</span>, <span class="at">keepevery=</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## *****Calling gbart: type=2
## *****Data:
## data:n,p,np: 17042, 4, 0
## y1,yn: 1.000000, 0.000000
## x1,x[n*p]: 2.000000, 2.900000
## *****Number of Trees: 50
## *****Number of Cut Points: 100 ... 63
## *****burn,nd,thin: 1,1,1
## *****Prior:beta,alpha,tau,nu,lambda,offset: 2,0.95,0.212132,3,1,-2.6383
## *****Dirichlet:sparse,theta,omega,a,b,rho,augment: 0,0,1,0.5,1,3,0
## *****printevery: 100
## 
## MCMC
## done 0 (out of 2)
## time: 0s
## trcnt,tecnt: 1,0</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="machine-learning.html#cb107-1" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">surv.bart</span>(<span class="at">x.train=</span>x.train, <span class="at">times=</span>times, <span class="at">delta=</span>delta,</span>
<span id="cb107-2"><a href="machine-learning.html#cb107-2" tabindex="-1"></a>                      <span class="at">seed=</span><span class="dv">99</span>)</span></code></pre></div>
<pre><code>## *****Calling gbart: type=2
## *****Data:
## data:n,p,np: 17042, 4, 0
## y1,yn: 1.000000, 0.000000
## x1,x[n*p]: 2.000000, 2.900000
## *****Number of Trees: 50
## *****Number of Cut Points: 100 ... 63
## *****burn,nd,thin: 250,10000,10
## *****Prior:beta,alpha,tau,nu,lambda,offset: 2,0.95,0.212132,3,1,-2.6383
## *****Dirichlet:sparse,theta,omega,a,b,rho,augment: 0,0,1,0.5,1,3,0
## *****printevery: 100
## 
## MCMC
## done 0 (out of 10250)
## done 100 (out of 10250)
## done 200 (out of 10250)
## done 300 (out of 10250)
## done 400 (out of 10250)
## done 500 (out of 10250)
## done 600 (out of 10250)
## done 700 (out of 10250)
## done 800 (out of 10250)
## done 900 (out of 10250)
## done 1000 (out of 10250)
## done 1100 (out of 10250)
## done 1200 (out of 10250)
## done 1300 (out of 10250)
## done 1400 (out of 10250)
## done 1500 (out of 10250)
## done 1600 (out of 10250)
## done 1700 (out of 10250)
## done 1800 (out of 10250)
## done 1900 (out of 10250)
## done 2000 (out of 10250)
## done 2100 (out of 10250)
## done 2200 (out of 10250)
## done 2300 (out of 10250)
## done 2400 (out of 10250)
## done 2500 (out of 10250)
## done 2600 (out of 10250)
## done 2700 (out of 10250)
## done 2800 (out of 10250)
## done 2900 (out of 10250)
## done 3000 (out of 10250)
## done 3100 (out of 10250)
## done 3200 (out of 10250)
## done 3300 (out of 10250)
## done 3400 (out of 10250)
## done 3500 (out of 10250)
## done 3600 (out of 10250)
## done 3700 (out of 10250)
## done 3800 (out of 10250)
## done 3900 (out of 10250)
## done 4000 (out of 10250)
## done 4100 (out of 10250)
## done 4200 (out of 10250)
## done 4300 (out of 10250)
## done 4400 (out of 10250)
## done 4500 (out of 10250)
## done 4600 (out of 10250)
## done 4700 (out of 10250)
## done 4800 (out of 10250)
## done 4900 (out of 10250)
## done 5000 (out of 10250)
## done 5100 (out of 10250)
## done 5200 (out of 10250)
## done 5300 (out of 10250)
## done 5400 (out of 10250)
## done 5500 (out of 10250)
## done 5600 (out of 10250)
## done 5700 (out of 10250)
## done 5800 (out of 10250)
## done 5900 (out of 10250)
## done 6000 (out of 10250)
## done 6100 (out of 10250)
## done 6200 (out of 10250)
## done 6300 (out of 10250)
## done 6400 (out of 10250)
## done 6500 (out of 10250)
## done 6600 (out of 10250)
## done 6700 (out of 10250)
## done 6800 (out of 10250)
## done 6900 (out of 10250)
## done 7000 (out of 10250)
## done 7100 (out of 10250)
## done 7200 (out of 10250)
## done 7300 (out of 10250)
## done 7400 (out of 10250)
## done 7500 (out of 10250)
## done 7600 (out of 10250)
## done 7700 (out of 10250)
## done 7800 (out of 10250)
## done 7900 (out of 10250)
## done 8000 (out of 10250)
## done 8100 (out of 10250)
## done 8200 (out of 10250)
## done 8300 (out of 10250)
## done 8400 (out of 10250)
## done 8500 (out of 10250)
## done 8600 (out of 10250)
## done 8700 (out of 10250)
## done 8800 (out of 10250)
## done 8900 (out of 10250)
## done 9000 (out of 10250)
## done 9100 (out of 10250)
## done 9200 (out of 10250)
## done 9300 (out of 10250)
## done 9400 (out of 10250)
## done 9500 (out of 10250)
## done 9600 (out of 10250)
## done 9700 (out of 10250)
## done 9800 (out of 10250)
## done 9900 (out of 10250)
## done 10000 (out of 10250)
## done 10100 (out of 10250)
## done 10200 (out of 10250)
## time: 84s
## trcnt,tecnt: 1000,0</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="machine-learning.html#cb109-1" tabindex="-1"></a>pre <span class="ot">&lt;-</span> <span class="fu">surv.pre.bart</span>(<span class="at">times=</span>times, <span class="at">delta=</span>delta, <span class="at">x.train=</span>x.train,</span>
<span id="cb109-2"><a href="machine-learning.html#cb109-2" tabindex="-1"></a>                     <span class="at">x.test=</span>x.train)</span>
<span id="cb109-3"><a href="machine-learning.html#cb109-3" tabindex="-1"></a></span>
<span id="cb109-4"><a href="machine-learning.html#cb109-4" tabindex="-1"></a>K <span class="ot">&lt;-</span> pre<span class="sc">$</span>K</span>
<span id="cb109-5"><a href="machine-learning.html#cb109-5" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">nrow</span>(post<span class="sc">$</span>yhat.train)</span>
<span id="cb109-6"><a href="machine-learning.html#cb109-6" tabindex="-1"></a></span>
<span id="cb109-7"><a href="machine-learning.html#cb109-7" tabindex="-1"></a>pre<span class="sc">$</span>tx.test <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pre<span class="sc">$</span>tx.test, pre<span class="sc">$</span>tx.test)</span>
<span id="cb109-8"><a href="machine-learning.html#cb109-8" tabindex="-1"></a>pre<span class="sc">$</span>tx.test[ , <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, N<span class="sc">*</span>K), <span class="fu">rep</span>(<span class="dv">2</span>, N<span class="sc">*</span>K))</span>
<span id="cb109-9"><a href="machine-learning.html#cb109-9" tabindex="-1"></a><span class="do">## sex pushed to col 2, since time is always in col 1</span></span>
<span id="cb109-10"><a href="machine-learning.html#cb109-10" tabindex="-1"></a></span>
<span id="cb109-11"><a href="machine-learning.html#cb109-11" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(post, <span class="at">newdata=</span>pre<span class="sc">$</span>tx.test)</span></code></pre></div>
<pre><code>## *****In main of C++ for bart prediction
## tc (threadcount): 1
## number of bart draws: 1000
## number of trees in bart sum: 50
## number of x columns: 4
## from x,np,p: 4, 67240
## ***using serial code</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="machine-learning.html#cb111-1" tabindex="-1"></a>pd <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span>M, <span class="at">ncol=</span><span class="dv">2</span><span class="sc">*</span>K)</span>
<span id="cb111-2"><a href="machine-learning.html#cb111-2" tabindex="-1"></a></span>
<span id="cb111-3"><a href="machine-learning.html#cb111-3" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K) {</span>
<span id="cb111-4"><a href="machine-learning.html#cb111-4" tabindex="-1"></a>  h <span class="ot">&lt;-</span> <span class="fu">seq</span>(j, N<span class="sc">*</span>K, <span class="at">by=</span>K)</span>
<span id="cb111-5"><a href="machine-learning.html#cb111-5" tabindex="-1"></a>  pd[ , j] <span class="ot">&lt;-</span> <span class="fu">apply</span>(pred<span class="sc">$</span>surv.test[ , h], <span class="dv">1</span>, mean)</span>
<span id="cb111-6"><a href="machine-learning.html#cb111-6" tabindex="-1"></a>  pd[ , j<span class="sc">+</span>K] <span class="ot">&lt;-</span> <span class="fu">apply</span>(pred<span class="sc">$</span>surv.test[ , h<span class="sc">+</span>N<span class="sc">*</span>K], <span class="dv">1</span>, mean)</span>
<span id="cb111-7"><a href="machine-learning.html#cb111-7" tabindex="-1"></a>}</span>
<span id="cb111-8"><a href="machine-learning.html#cb111-8" tabindex="-1"></a></span>
<span id="cb111-9"><a href="machine-learning.html#cb111-9" tabindex="-1"></a>pd.mu  <span class="ot">&lt;-</span> <span class="fu">apply</span>(pd, <span class="dv">2</span>, mean)</span>
<span id="cb111-10"><a href="machine-learning.html#cb111-10" tabindex="-1"></a>pd<span class="fl">.025</span> <span class="ot">&lt;-</span> <span class="fu">apply</span>(pd, <span class="dv">2</span>, quantile, <span class="at">probs=</span><span class="fl">0.025</span>)</span>
<span id="cb111-11"><a href="machine-learning.html#cb111-11" tabindex="-1"></a>pd<span class="fl">.975</span> <span class="ot">&lt;-</span> <span class="fu">apply</span>(pd, <span class="dv">2</span>, quantile, <span class="at">probs=</span><span class="fl">0.975</span>)</span>
<span id="cb111-12"><a href="machine-learning.html#cb111-12" tabindex="-1"></a></span>
<span id="cb111-13"><a href="machine-learning.html#cb111-13" tabindex="-1"></a>males <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>K</span>
<span id="cb111-14"><a href="machine-learning.html#cb111-14" tabindex="-1"></a>females <span class="ot">&lt;-</span> males<span class="sc">+</span>K</span>
<span id="cb111-15"><a href="machine-learning.html#cb111-15" tabindex="-1"></a></span>
<span id="cb111-16"><a href="machine-learning.html#cb111-16" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">c</span>(<span class="dv">0</span>, pre<span class="sc">$</span>times), <span class="fu">c</span>(<span class="dv">1</span>, pd.mu[males]), <span class="at">type=</span><span class="st">&#39;s&#39;</span>, <span class="at">col=</span><span class="st">&#39;blue&#39;</span>,</span>
<span id="cb111-17"><a href="machine-learning.html#cb111-17" tabindex="-1"></a>     <span class="at">ylim=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">ylab=</span><span class="st">&#39;S(t, x)&#39;</span>, <span class="at">xlab=</span><span class="st">&#39;t (weeks)&#39;</span>,</span>
<span id="cb111-18"><a href="machine-learning.html#cb111-18" tabindex="-1"></a>     <span class="at">main=</span><span class="fu">paste</span>(<span class="st">&#39;Melanoma ex. (MASS:: Melanoma)&#39;</span>,</span>
<span id="cb111-19"><a href="machine-learning.html#cb111-19" tabindex="-1"></a>                <span class="st">&quot;Friedman&#39;s partial dependence function&quot;</span>,</span>
<span id="cb111-20"><a href="machine-learning.html#cb111-20" tabindex="-1"></a>                <span class="st">&#39;Male (blue) vs. Female (red)&#39;</span>, <span class="at">sep=</span><span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>))</span>
<span id="cb111-21"><a href="machine-learning.html#cb111-21" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">0</span>, pre<span class="sc">$</span>times), <span class="fu">c</span>(<span class="dv">1</span>, pd<span class="fl">.025</span>[males]), <span class="at">col=</span><span class="st">&#39;blue&#39;</span>, <span class="at">type=</span><span class="st">&#39;s&#39;</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb111-22"><a href="machine-learning.html#cb111-22" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">0</span>, pre<span class="sc">$</span>times), <span class="fu">c</span>(<span class="dv">1</span>, pd<span class="fl">.975</span>[males]), <span class="at">col=</span><span class="st">&#39;blue&#39;</span>, <span class="at">type=</span><span class="st">&#39;s&#39;</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb111-23"><a href="machine-learning.html#cb111-23" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">0</span>, pre<span class="sc">$</span>times), <span class="fu">c</span>(<span class="dv">1</span>, pd.mu[females]), <span class="at">col=</span><span class="st">&#39;red&#39;</span>, <span class="at">type=</span><span class="st">&#39;s&#39;</span>)</span>
<span id="cb111-24"><a href="machine-learning.html#cb111-24" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">0</span>, pre<span class="sc">$</span>times), <span class="fu">c</span>(<span class="dv">1</span>, pd<span class="fl">.025</span>[females]), <span class="at">col=</span><span class="st">&#39;red&#39;</span>, <span class="at">type=</span><span class="st">&#39;s&#39;</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb111-25"><a href="machine-learning.html#cb111-25" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">0</span>, pre<span class="sc">$</span>times), <span class="fu">c</span>(<span class="dv">1</span>, pd<span class="fl">.975</span>[females]), <span class="at">col=</span><span class="st">&#39;red&#39;</span>, <span class="at">type=</span><span class="st">&#39;s&#39;</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-4-2-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="knn" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> KNN<a href="machine-learning.html#knn" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>K nearest neighbour (KNN) uses feature similarity based on measure of distance between data points to make prediction. The K in KNN refers to the number of neighbours to define the case for similarity. K nearest neighbour is available from the <em>caret</em> library.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="machine-learning.html#cb112-1" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb112-2"><a href="machine-learning.html#cb112-2" tabindex="-1"></a></span>
<span id="cb112-3"><a href="machine-learning.html#cb112-3" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;BreastCancer&quot;</span>,<span class="at">package =</span> <span class="st">&quot;mlbench&quot;</span>)</span>
<span id="cb112-4"><a href="machine-learning.html#cb112-4" tabindex="-1"></a><span class="fu">colnames</span>(BreastCancer)</span></code></pre></div>
<pre><code>##  [1] &quot;Id&quot;              &quot;Cl.thickness&quot;    &quot;Cell.size&quot;       &quot;Cell.shape&quot;     
##  [5] &quot;Marg.adhesion&quot;   &quot;Epith.c.size&quot;    &quot;Bare.nuclei&quot;     &quot;Bl.cromatin&quot;    
##  [9] &quot;Normal.nucleoli&quot; &quot;Mitoses&quot;         &quot;Class&quot;</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="machine-learning.html#cb114-1" tabindex="-1"></a><span class="co">#note Class is benign or malignant of class factor</span></span>
<span id="cb114-2"><a href="machine-learning.html#cb114-2" tabindex="-1"></a><span class="co">#column Bare.nuclei removed due to NA</span></span>
<span id="cb114-3"><a href="machine-learning.html#cb114-3" tabindex="-1"></a>BreastCancer<span class="ot">&lt;-</span>BreastCancer[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>)]</span>
<span id="cb114-4"><a href="machine-learning.html#cb114-4" tabindex="-1"></a></span>
<span id="cb114-5"><a href="machine-learning.html#cb114-5" tabindex="-1"></a><span class="co">#split data</span></span>
<span id="cb114-6"><a href="machine-learning.html#cb114-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb114-7"><a href="machine-learning.html#cb114-7" tabindex="-1"></a>split <span class="ot">=</span> caTools<span class="sc">::</span><span class="fu">sample.split</span>(BreastCancer<span class="sc">$</span>Class, <span class="at">SplitRatio =</span> <span class="fl">0.75</span>)</span>
<span id="cb114-8"><a href="machine-learning.html#cb114-8" tabindex="-1"></a>Train <span class="ot">=</span> <span class="fu">subset</span>(BreastCancer, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb114-9"><a href="machine-learning.html#cb114-9" tabindex="-1"></a>Test <span class="ot">=</span> <span class="fu">subset</span>(BreastCancer, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb114-10"><a href="machine-learning.html#cb114-10" tabindex="-1"></a></span>
<span id="cb114-11"><a href="machine-learning.html#cb114-11" tabindex="-1"></a><span class="co">#grid of values to test in cross-validation.</span></span>
<span id="cb114-12"><a href="machine-learning.html#cb114-12" tabindex="-1"></a>knn_Grid <span class="ot">&lt;-</span>  <span class="fu">expand.grid</span>(<span class="at">k =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>))</span>
<span id="cb114-13"><a href="machine-learning.html#cb114-13" tabindex="-1"></a></span>
<span id="cb114-14"><a href="machine-learning.html#cb114-14" tabindex="-1"></a>knn_Control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;cv&quot;</span>,</span>
<span id="cb114-15"><a href="machine-learning.html#cb114-15" tabindex="-1"></a>                           <span class="at">number =</span> <span class="dv">10</span>, </span>
<span id="cb114-16"><a href="machine-learning.html#cb114-16" tabindex="-1"></a>                           <span class="co"># repeats = 10, # uncomment for repeatedcv </span></span>
<span id="cb114-17"><a href="machine-learning.html#cb114-17" tabindex="-1"></a>                           <span class="do">## Estimate class probabilities</span></span>
<span id="cb114-18"><a href="machine-learning.html#cb114-18" tabindex="-1"></a>                           <span class="at">classProbs =</span> <span class="cn">TRUE</span>,</span>
<span id="cb114-19"><a href="machine-learning.html#cb114-19" tabindex="-1"></a>                           <span class="do">## Evaluate performance using </span></span>
<span id="cb114-20"><a href="machine-learning.html#cb114-20" tabindex="-1"></a>                           <span class="do">## the following function</span></span>
<span id="cb114-21"><a href="machine-learning.html#cb114-21" tabindex="-1"></a>                           <span class="at">summaryFunction =</span> twoClassSummary)</span>
<span id="cb114-22"><a href="machine-learning.html#cb114-22" tabindex="-1"></a></span>
<span id="cb114-23"><a href="machine-learning.html#cb114-23" tabindex="-1"></a><span class="co">#scaling data is performed here under preProcess</span></span>
<span id="cb114-24"><a href="machine-learning.html#cb114-24" tabindex="-1"></a></span>
<span id="cb114-25"><a href="machine-learning.html#cb114-25" tabindex="-1"></a>knn <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(Class <span class="sc">~</span> ., </span>
<span id="cb114-26"><a href="machine-learning.html#cb114-26" tabindex="-1"></a>                    <span class="at">data =</span> Train, </span>
<span id="cb114-27"><a href="machine-learning.html#cb114-27" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">&quot;knn&quot;</span>,</span>
<span id="cb114-28"><a href="machine-learning.html#cb114-28" tabindex="-1"></a>                 <span class="at">trControl=</span>knn_Control,</span>
<span id="cb114-29"><a href="machine-learning.html#cb114-29" tabindex="-1"></a>                 <span class="at">tuneGrid=</span>knn_Grid,</span>
<span id="cb114-30"><a href="machine-learning.html#cb114-30" tabindex="-1"></a>                 <span class="co">#optimise with roc metric</span></span>
<span id="cb114-31"><a href="machine-learning.html#cb114-31" tabindex="-1"></a>                 <span class="at">metric=</span><span class="st">&quot;ROC&quot;</span>)</span>
<span id="cb114-32"><a href="machine-learning.html#cb114-32" tabindex="-1"></a></span>
<span id="cb114-33"><a href="machine-learning.html#cb114-33" tabindex="-1"></a></span>
<span id="cb114-34"><a href="machine-learning.html#cb114-34" tabindex="-1"></a><span class="fu">summary</span>(knn)</span></code></pre></div>
<pre><code>##             Length Class      Mode     
## learn        2     -none-     list     
## k            1     -none-     numeric  
## theDots      0     -none-     list     
## xNames      71     -none-     character
## problemType  1     -none-     character
## tuneValue    1     data.frame list     
## obsLevels    2     -none-     character
## param        0     -none-     list</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="machine-learning.html#cb116-1" tabindex="-1"></a>pred_knn<span class="ot">&lt;-</span><span class="fu">predict</span>(knn,Test)</span>
<span id="cb116-2"><a href="machine-learning.html#cb116-2" tabindex="-1"></a><span class="fu">confusionMatrix</span>(pred_knn, Test<span class="sc">$</span>Class)</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##            Reference
## Prediction  benign malignant
##   benign       114        25
##   malignant      0        35
##                                           
##                Accuracy : 0.8563          
##                  95% CI : (0.7952, 0.9048)
##     No Information Rate : 0.6552          
##     P-Value [Acc &gt; NIR] : 1.883e-09       
##                                           
##                   Kappa : 0.6472          
##                                           
##  Mcnemar&#39;s Test P-Value : 1.587e-06       
##                                           
##             Sensitivity : 1.0000          
##             Specificity : 0.5833          
##          Pos Pred Value : 0.8201          
##          Neg Pred Value : 1.0000          
##              Prevalence : 0.6552          
##          Detection Rate : 0.6552          
##    Detection Prevalence : 0.7989          
##       Balanced Accuracy : 0.7917          
##                                           
##        &#39;Positive&#39; Class : benign          
## </code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="machine-learning.html#cb118-1" tabindex="-1"></a>roc_knn<span class="ot">&lt;-</span>pROC<span class="sc">::</span><span class="fu">roc</span>(Test<span class="sc">$</span>Class, <span class="fu">as.numeric</span>(pred_knn))</span></code></pre></div>
<pre><code>## Setting levels: control = benign, case = malignant</code></pre>
<pre><code>## Setting direction: controls &lt; cases</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="machine-learning.html#cb121-1" tabindex="-1"></a>roc_knn</span></code></pre></div>
<pre><code>## 
## Call:
## roc.default(response = Test$Class, predictor = as.numeric(pred_knn))
## 
## Data: as.numeric(pred_knn) in 114 controls (Test$Class benign) &lt; 60 cases (Test$Class malignant).
## Area under the curve: 0.7917</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="machine-learning.html#cb123-1" tabindex="-1"></a><span class="co">#https://plotly.com/r/knn-classification/</span></span>
<span id="cb123-2"><a href="machine-learning.html#cb123-2" tabindex="-1"></a></span>
<span id="cb123-3"><a href="machine-learning.html#cb123-3" tabindex="-1"></a>pdb <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Test[,<span class="sc">-</span><span class="dv">9</span>], Test[,<span class="dv">9</span>])</span>
<span id="cb123-4"><a href="machine-learning.html#cb123-4" tabindex="-1"></a>pdb <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pdb, pred_knn)</span>
<span id="cb123-5"><a href="machine-learning.html#cb123-5" tabindex="-1"></a></span>
<span id="cb123-6"><a href="machine-learning.html#cb123-6" tabindex="-1"></a>fig <span class="ot">&lt;-</span> plotly<span class="sc">::</span><span class="fu">plot_ly</span>(<span class="at">data =</span> pdb,</span>
<span id="cb123-7"><a href="machine-learning.html#cb123-7" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">~</span><span class="fu">as.numeric</span>(Test<span class="sc">$</span>Cl.thickness), </span>
<span id="cb123-8"><a href="machine-learning.html#cb123-8" tabindex="-1"></a>    <span class="at">y =</span> <span class="sc">~</span><span class="fu">as.numeric</span>(Test<span class="sc">$</span>Epith.c.size), </span>
<span id="cb123-9"><a href="machine-learning.html#cb123-9" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&#39;scatter&#39;</span>, <span class="at">mode =</span> <span class="st">&#39;markers&#39;</span>,<span class="at">color =</span> <span class="sc">~</span>pred_knn, <span class="at">colors =</span> <span class="st">&#39;RdBu&#39;</span>, </span>
<span id="cb123-10"><a href="machine-learning.html#cb123-10" tabindex="-1"></a>    <span class="at">symbol =</span> <span class="sc">~</span>Test<span class="sc">$</span>Class, <span class="at">split =</span> <span class="sc">~</span>Test<span class="sc">$</span>Class, </span>
<span id="cb123-11"><a href="machine-learning.html#cb123-11" tabindex="-1"></a>    <span class="at">symbols =</span> <span class="fu">c</span>(<span class="st">&#39;square-dot&#39;</span>,<span class="st">&#39;circle-dot&#39;</span>), </span>
<span id="cb123-12"><a href="machine-learning.html#cb123-12" tabindex="-1"></a>    <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;black&#39;</span>, <span class="at">width =</span> <span class="dv">1</span>)))</span>
<span id="cb123-13"><a href="machine-learning.html#cb123-13" tabindex="-1"></a></span>
<span id="cb123-14"><a href="machine-learning.html#cb123-14" tabindex="-1"></a>fig</span></code></pre></div>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-933430e44e0b4dbf05e8" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-933430e44e0b4dbf05e8">{"x":{"visdat":{"1fc8223cb68":["function () ","plotlyVisDat"]},"cur_data":"1fc8223cb68","attrs":{"1fc8223cb68":{"x":{},"y":{},"mode":"markers","marker":{"size":12,"line":{"color":"black","width":1}},"color":{},"symbol":{},"split":{},"colors":"RdBu","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"symbols":["square-dot","circle-dot"],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"as.numeric(Test$Cl.thickness)"},"yaxis":{"domain":[0,1],"automargin":true,"title":"as.numeric(Test$Epith.c.size)"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[5,6,4,2,2,3,2,1,2,4,1,4,1,3,2,1,1,1,1,3,1,2,1,4,1,1,3,1,6,2,3,5,5,6,3,3,1,5,4,3,3,1,4,1,3,5,1,5,2,1,1,5,2,5,3,3,3,1,5,3,3,5,5,1,5,3,5,6,1,1,3,1,4,1,4,4,3,1,1,4,4,3,5,5,4,3,5,5,3,1,1,5,5,4,5,1,4,5,1,3,2,2,6,3,1,3,4,1,1,2,1,3,3,2],"y":[7,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,10,2,3,2,2,2,2,1,2,1,2,2,2,2,2,1,2,2,2,2,2,2,7,5,2,2,2,3,2,2,1,2,2,3,2,2,2,1,2,2,2,2,2,2,3,2,2,2,2,1,1,2,1,1,2,2,1,1,3,3,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,3,2],"mode":"markers","marker":{"color":"rgba(239,138,98,1)","symbol":"square-dot","size":12,"line":{"color":"black","width":1}},"type":"scatter","name":"benign<br />benign<br />benign","textfont":{"color":"rgba(239,138,98,1)"},"error_y":{"color":"rgba(239,138,98,1)"},"error_x":{"color":"rgba(239,138,98,1)"},"line":{"color":"rgba(239,138,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[5,10,8,6,10,10,3,1,4,8,5,8,3,7,1,10,10,10,3,4,5,7,10,3,7],"y":[2,3,5,5,3,3,5,8,1,2,4,3,3,3,4,2,2,2,5,3,3,2,2,3,4],"mode":"markers","marker":{"color":"rgba(239,138,98,1)","symbol":"circle-dot","size":12,"line":{"color":"black","width":1}},"type":"scatter","name":"benign<br />malignant<br />malignant","textfont":{"color":"rgba(239,138,98,1)"},"error_y":{"color":"rgba(239,138,98,1)"},"error_x":{"color":"rgba(239,138,98,1)"},"line":{"color":"rgba(239,138,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[8,10,10,5,9,5,6,5,1,10,9,10,8,10,10,6,8,10,8,10,10,8,10,8,10,10,10,8,6,7,10,10,10,5,8],"y":[7,8,10,8,6,8,8,8,5,6,5,7,4,7,5,8,5,10,4,4,5,8,3,3,3,4,5,7,3,4,6,3,3,5,6],"mode":"markers","marker":{"color":"rgba(247,247,247,1)","symbol":"circle-dot","size":12,"line":{"color":"black","width":1}},"type":"scatter","name":"malignant<br />malignant<br />malignant","textfont":{"color":"rgba(247,247,247,1)"},"error_y":{"color":"rgba(247,247,247,1)"},"error_x":{"color":"rgba(247,247,247,1)"},"line":{"color":"rgba(247,247,247,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="support-vector-machine" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Support vector machine<a href="machine-learning.html#support-vector-machine" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In brief, support vector machine regression (SVR) can be seen as a way to
enhance data which may not be easily separated in its native space. It
manipulates data from low dimension to higher dimension in feature space and
which can reveal relationship not discernible in low dimensional space. It does this around the hyperparameter controlling the margin of the data from a fitted line in a way not dissimilar from fitting a regression line based on minimising least squares. The default setting is radial basis function.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="machine-learning.html#cb124-1" tabindex="-1"></a><span class="fu">library</span>(e1071)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;e1071&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:randomForestSRC&#39;:
## 
##     impute, tune</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="machine-learning.html#cb127-1" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb127-2"><a href="machine-learning.html#cb127-2" tabindex="-1"></a></span>
<span id="cb127-3"><a href="machine-learning.html#cb127-3" tabindex="-1"></a><span class="co"># The Breast cancer data is used again from knn</span></span>
<span id="cb127-4"><a href="machine-learning.html#cb127-4" tabindex="-1"></a></span>
<span id="cb127-5"><a href="machine-learning.html#cb127-5" tabindex="-1"></a>trctrl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;repeatedcv&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>, <span class="at">repeats =</span> <span class="dv">3</span>)</span>
<span id="cb127-6"><a href="machine-learning.html#cb127-6" tabindex="-1"></a></span>
<span id="cb127-7"><a href="machine-learning.html#cb127-7" tabindex="-1"></a><span class="co">#scaling data is performed here under preProcess</span></span>
<span id="cb127-8"><a href="machine-learning.html#cb127-8" tabindex="-1"></a></span>
<span id="cb127-9"><a href="machine-learning.html#cb127-9" tabindex="-1"></a>svm_Linear <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(Class <span class="sc">~</span> ., </span>
<span id="cb127-10"><a href="machine-learning.html#cb127-10" tabindex="-1"></a>                    <span class="at">data =</span> Train, </span>
<span id="cb127-11"><a href="machine-learning.html#cb127-11" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">&quot;svmLinear&quot;</span>,</span>
<span id="cb127-12"><a href="machine-learning.html#cb127-12" tabindex="-1"></a>                 <span class="at">trControl=</span>trctrl,</span>
<span id="cb127-13"><a href="machine-learning.html#cb127-13" tabindex="-1"></a>                 <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">&quot;center&quot;</span>, <span class="st">&quot;scale&quot;</span>),</span>
<span id="cb127-14"><a href="machine-learning.html#cb127-14" tabindex="-1"></a>                 <span class="at">tuneLength =</span> <span class="dv">10</span>)</span>
<span id="cb127-15"><a href="machine-learning.html#cb127-15" tabindex="-1"></a></span>
<span id="cb127-16"><a href="machine-learning.html#cb127-16" tabindex="-1"></a></span>
<span id="cb127-17"><a href="machine-learning.html#cb127-17" tabindex="-1"></a><span class="fu">summary</span>(svm_Linear)</span></code></pre></div>
<pre><code>## Length  Class   Mode 
##      1   ksvm     S4</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="machine-learning.html#cb129-1" tabindex="-1"></a>pred<span class="ot">&lt;-</span><span class="fu">predict</span>(svm_Linear,BreastCancer)</span>
<span id="cb129-2"><a href="machine-learning.html#cb129-2" tabindex="-1"></a><span class="fu">confusionMatrix</span>(pred, BreastCancer<span class="sc">$</span>Class)</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##            Reference
## Prediction  benign malignant
##   benign       455        13
##   malignant      3       228
##                                           
##                Accuracy : 0.9771          
##                  95% CI : (0.9631, 0.9869)
##     No Information Rate : 0.6552          
##     P-Value [Acc &gt; NIR] : &lt; 2e-16         
##                                           
##                   Kappa : 0.9488          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.02445         
##                                           
##             Sensitivity : 0.9934          
##             Specificity : 0.9461          
##          Pos Pred Value : 0.9722          
##          Neg Pred Value : 0.9870          
##              Prevalence : 0.6552          
##          Detection Rate : 0.6509          
##    Detection Prevalence : 0.6695          
##       Balanced Accuracy : 0.9698          
##                                           
##        &#39;Positive&#39; Class : benign          
## </code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="machine-learning.html#cb131-1" tabindex="-1"></a>roc_svm<span class="ot">&lt;-</span>pROC<span class="sc">::</span><span class="fu">roc</span>(BreastCancer<span class="sc">$</span>Class, <span class="fu">as.numeric</span>(pred))</span></code></pre></div>
<pre><code>## Setting levels: control = benign, case = malignant</code></pre>
<pre><code>## Setting direction: controls &lt; cases</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="machine-learning.html#cb134-1" tabindex="-1"></a>roc_svm</span></code></pre></div>
<pre><code>## 
## Call:
## roc.default(response = BreastCancer$Class, predictor = as.numeric(pred))
## 
## Data: as.numeric(pred) in 458 controls (BreastCancer$Class benign) &lt; 241 cases (BreastCancer$Class malignant).
## Area under the curve: 0.9698</code></pre>
</div>
<div id="non-negative-matrix-factorisation" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Non-negative matrix factorisation<a href="machine-learning.html#non-negative-matrix-factorisation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Non-negative matrix factorisation is an unsupervised machine learning method, which seeks to explain the observed clinical features using smaller number of basis components (hidden variables). A matrix V of dimension m x n is factorise
to 2 matrices W and H. W has dimensions m x k an H has dimensions n x k. For
topic modeling in the chapter of text mining, V matrix is the document term matrix. Each row of H is the word embedding and the columns pf W represent the weight.</p>
<p>The interpretation of NMF components is similar to, but often more natural than, related methods such as factor analysis and principal component analysis. The non-negativity constraint in NMF leads to a simple parts-based interpretation and has been successfully used in facial recognition, metagene pattern
discovery, and market research. For a clinical example, the matrix for NMF decomposition consists of rows of hospitals and their service availability.</p>
<p>The example below used the recommended procedure to estimate the factorization rank, based on stability of the cophenetic correlation coefficient and the residual error, prior to performing the NMF analysis. The data were permuted and the factorization rank computed. These data were used as reference for selecting factorization rank to minimize the chance of overfitting.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="machine-learning.html#cb136-1" tabindex="-1"></a><span class="co">#BiocManager::install(&quot;Biobase&quot;)</span></span>
<span id="cb136-2"><a href="machine-learning.html#cb136-2" tabindex="-1"></a><span class="fu">library</span>(NMF,<span class="at">quietly =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Registered S3 methods overwritten by &#39;registry&#39;:
##   method               from 
##   print.registry_field proxy
##   print.registry_entry proxy</code></pre>
<pre><code>## NMF - BioConductor layer [OK] | Shared memory capabilities [NO: windows] | Cores 2/2</code></pre>
<pre><code>## 
## Attaching package: &#39;NMF&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:nlme&#39;:
## 
##     coef&lt;-</code></pre>
<pre><code>## The following object is masked from &#39;package:party&#39;:
## 
##     fit</code></pre>
<pre><code>## The following object is masked from &#39;package:modeltools&#39;:
## 
##     fit</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="machine-learning.html#cb143-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb143-2"><a href="machine-learning.html#cb143-2" tabindex="-1"></a>edge<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./Data-Use/Hosp_Network_geocoded.csv&quot;</span>)</span>
<span id="cb143-3"><a href="machine-learning.html#cb143-3" tabindex="-1"></a>df<span class="ot">&lt;-</span>edge[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="fu">dim</span>(edge)[<span class="dv">2</span>])]</span>
<span id="cb143-4"><a href="machine-learning.html#cb143-4" tabindex="-1"></a><span class="fu">row.names</span>(df)<span class="ot">&lt;-</span>edge[,<span class="dv">1</span>] <span class="co">#bipartite matrix</span></span>
<span id="cb143-5"><a href="machine-learning.html#cb143-5" tabindex="-1"></a><span class="co">#select columns#remove distance data</span></span>
<span id="cb143-6"><a href="machine-learning.html#cb143-6" tabindex="-1"></a>df_se<span class="ot">&lt;-</span>edge[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">16</span>)]</span>
<span id="cb143-7"><a href="machine-learning.html#cb143-7" tabindex="-1"></a><span class="fu">row.names</span>(df_se)<span class="ot">&lt;-</span>edge[,<span class="dv">1</span>] <span class="co">#bipartite matrix</span></span>
<span id="cb143-8"><a href="machine-learning.html#cb143-8" tabindex="-1"></a><span class="co">#south eastern hospitals</span></span>
<span id="cb143-9"><a href="machine-learning.html#cb143-9" tabindex="-1"></a><span class="co">#select rows</span></span>
<span id="cb143-10"><a href="machine-learning.html#cb143-10" tabindex="-1"></a>df_se<span class="ot">&lt;-</span>df_se[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">19</span>,<span class="dv">20</span>,<span class="dv">24</span>,<span class="dv">31</span>,<span class="dv">33</span>,<span class="dv">34</span>,<span class="dv">35</span>),]</span>
<span id="cb143-11"><a href="machine-learning.html#cb143-11" tabindex="-1"></a></span>
<span id="cb143-12"><a href="machine-learning.html#cb143-12" tabindex="-1"></a></span>
<span id="cb143-13"><a href="machine-learning.html#cb143-13" tabindex="-1"></a><span class="co">#estimate factorisation rank-prevent overfitting</span></span>
<span id="cb143-14"><a href="machine-learning.html#cb143-14" tabindex="-1"></a>estim.r <span class="ot">&lt;-</span> <span class="fu">nmf</span>(df_se, <span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">nrun =</span> <span class="dv">10</span>, <span class="at">seed =</span> <span class="dv">123456</span>)</span>
<span id="cb143-15"><a href="machine-learning.html#cb143-15" tabindex="-1"></a><span class="fu">plot</span>(estim.r)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-7-1.png" width="672" /></p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="machine-learning.html#cb144-1" tabindex="-1"></a><span class="fu">consensusmap</span>(estim.r)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-7-2.png" width="672" /></p>
<p>The optimal number of rank for this data is likely to be 4.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="machine-learning.html#cb145-1" tabindex="-1"></a><span class="co">#Using the data above we can use which argument to find the order</span></span>
<span id="cb145-2"><a href="machine-learning.html#cb145-2" tabindex="-1"></a><span class="co">#since the starting point is 2 we just need to add 1</span></span>
<span id="cb145-3"><a href="machine-learning.html#cb145-3" tabindex="-1"></a>Rank<span class="ot">=</span><span class="fu">which</span>(estim.r<span class="sc">$</span>measures<span class="sc">$</span>cophenetic<span class="sc">==</span><span class="fu">max</span>(estim.r<span class="sc">$</span>measures<span class="sc">$</span>cophenetic))<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb145-4"><a href="machine-learning.html#cb145-4" tabindex="-1"></a></span>
<span id="cb145-5"><a href="machine-learning.html#cb145-5" tabindex="-1"></a>model<span class="ot">&lt;-</span><span class="fu">nmf</span>(df_se, Rank,<span class="at">nrun=</span><span class="dv">100</span>)</span>
<span id="cb145-6"><a href="machine-learning.html#cb145-6" tabindex="-1"></a>pmodel<span class="ot">&lt;-</span><span class="fu">predict</span>(model,<span class="at">prob=</span><span class="cn">TRUE</span>)</span>
<span id="cb145-7"><a href="machine-learning.html#cb145-7" tabindex="-1"></a><span class="fu">coefmap</span>(model)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-7-1-1.png" width="672" /></p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="machine-learning.html#cb146-1" tabindex="-1"></a><span class="fu">basismap</span>(model)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-7-1-2.png" width="672" /></p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="machine-learning.html#cb147-1" tabindex="-1"></a><span class="fu">consensusmap</span>(model)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-7-1-3.png" width="672" /></p>
</div>
<div id="formal-concept-analysis" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Formal concept analysis<a href="machine-learning.html#formal-concept-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This is an unsupervised machine learning method which takes an input matrix of objects and attributes (binary values) and seeks to find the hierarchy of relations. Each concept shares a set of attributes with other objects and each sub-concept shares a smaller set of attributes with a subset of the objects. A Hasse diagram is used to display the hierarchy of relations.</p>
<p>First we will illustrate with a simple relationship among fruit. Note in this example there is no close set for apple and pear, as both share the attribute of green color. There is a close set for the tropical fruit mango and and banana.</p>
<p>There are several libraries for FCA. Here we will use <em>multiplex</em>. The <em>fcaR</em> library can also handle fuzzy data.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="machine-learning.html#cb148-1" tabindex="-1"></a><span class="co">#BiocManager::install(&quot;Rgraphviz&quot;)</span></span>
<span id="cb148-2"><a href="machine-learning.html#cb148-2" tabindex="-1"></a></span>
<span id="cb148-3"><a href="machine-learning.html#cb148-3" tabindex="-1"></a><span class="fu">library</span>(multiplex) <span class="co">#Algebraic Tools for the Analysis of Multiple Social Networks</span></span>
<span id="cb148-4"><a href="machine-learning.html#cb148-4" tabindex="-1"></a><span class="fu">library</span>(Rgraphviz) <span class="co">#plot hasse diagram</span></span></code></pre></div>
<pre><code>## Loading required package: graph</code></pre>
<pre><code>## 
## Attaching package: &#39;graph&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:stringr&#39;:
## 
##     boundary</code></pre>
<pre><code>## The following object is masked from &#39;package:party&#39;:
## 
##     nodes</code></pre>
<pre><code>## The following object is masked from &#39;package:strucchange&#39;:
## 
##     boundary</code></pre>
<pre><code>## 
## Attaching package: &#39;Rgraphviz&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:NMF&#39;:
## 
##     name</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="machine-learning.html#cb156-1" tabindex="-1"></a>fr<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">Fruit=</span><span class="fu">c</span>(<span class="st">&quot;Apple&quot;</span>, <span class="st">&quot;Banana&quot;</span>,<span class="st">&quot;Pear&quot;</span>, <span class="st">&quot;Mango&quot;</span>),</span>
<span id="cb156-2"><a href="machine-learning.html#cb156-2" tabindex="-1"></a>                 <span class="at">round=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb156-3"><a href="machine-learning.html#cb156-3" tabindex="-1"></a>                 <span class="at">cylindrical=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb156-4"><a href="machine-learning.html#cb156-4" tabindex="-1"></a>                 <span class="at">yellow=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb156-5"><a href="machine-learning.html#cb156-5" tabindex="-1"></a>                 <span class="at">red=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb156-6"><a href="machine-learning.html#cb156-6" tabindex="-1"></a>                 <span class="at">green=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="co">#color when ripe</span></span>
<span id="cb156-7"><a href="machine-learning.html#cb156-7" tabindex="-1"></a>                 <span class="at">tropical=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb156-8"><a href="machine-learning.html#cb156-8" tabindex="-1"></a>               <span class="at">large_seed=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb156-9"><a href="machine-learning.html#cb156-9" tabindex="-1"></a>)</span>
<span id="cb156-10"><a href="machine-learning.html#cb156-10" tabindex="-1"></a></span>
<span id="cb156-11"><a href="machine-learning.html#cb156-11" tabindex="-1"></a>df<span class="ot">&lt;-</span>fr[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="fu">dim</span>(fr)[<span class="dv">2</span>])]</span>
<span id="cb156-12"><a href="machine-learning.html#cb156-12" tabindex="-1"></a><span class="fu">row.names</span>(df)<span class="ot">&lt;-</span>fr[,<span class="dv">1</span>] <span class="co">#bipartite matrix</span></span>
<span id="cb156-13"><a href="machine-learning.html#cb156-13" tabindex="-1"></a></span>
<span id="cb156-14"><a href="machine-learning.html#cb156-14" tabindex="-1"></a><span class="co">#perform Galois derivations between partially ordered subsets</span></span>
<span id="cb156-15"><a href="machine-learning.html#cb156-15" tabindex="-1"></a><span class="co">#galois(df_se&#39;,labeling = &quot;full&quot;)</span></span>
<span id="cb156-16"><a href="machine-learning.html#cb156-16" tabindex="-1"></a>gf <span class="ot">&lt;-</span> <span class="fu">galois</span>(df, <span class="at">labeling =</span> <span class="st">&quot;reduced&quot;</span>)</span>
<span id="cb156-17"><a href="machine-learning.html#cb156-17" tabindex="-1"></a></span>
<span id="cb156-18"><a href="machine-learning.html#cb156-18" tabindex="-1"></a><span class="co">#partial ordering of concept</span></span>
<span id="cb156-19"><a href="machine-learning.html#cb156-19" tabindex="-1"></a>po<span class="ot">&lt;-</span><span class="fu">partial.order</span>(gf,<span class="at">type=</span><span class="st">&quot;galois&quot;</span>)</span>
<span id="cb156-20"><a href="machine-learning.html#cb156-20" tabindex="-1"></a><span class="fu">diagram</span>(po, <span class="at">main=</span><span class="st">&quot;Hasse diagram of partial order - Fruit&quot;</span>) </span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-8-1.png" width="672" /></p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="machine-learning.html#cb157-1" tabindex="-1"></a><span class="co">#lattice  diagram with reduced context</span></span>
<span id="cb157-2"><a href="machine-learning.html#cb157-2" tabindex="-1"></a><span class="fu">diagram.levels</span>(po)</span></code></pre></div>
<pre><code>## $`4`
## [1] &quot;{round} {Apple}&quot;        &quot;{cylindrical} {Banana}&quot; &quot;{large_seed} {Mango}&quot;  
## 
## $`3`
## [1] &quot;{tropical, yellow} {}&quot; &quot;{green} {Pear}&quot;       
## 
## $`2`
## [1] &quot;{red} {}&quot;
## 
## $`5`
## [1] &quot;7&quot;
## 
## $`1`
## [1] &quot;8&quot;</code></pre>
<p>Next we illustrate FCA in network of hospitals in South-Eastern Melbourne. The objects are the hospitals and the attributes are the services available in those hospitals.</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="machine-learning.html#cb159-1" tabindex="-1"></a><span class="co">#library(multiplex) #Algebraic Tools for the Analysis of Multiple Social Networks</span></span>
<span id="cb159-2"><a href="machine-learning.html#cb159-2" tabindex="-1"></a><span class="co">#library(Rgraphviz) #plot hasse diagram</span></span>
<span id="cb159-3"><a href="machine-learning.html#cb159-3" tabindex="-1"></a></span>
<span id="cb159-4"><a href="machine-learning.html#cb159-4" tabindex="-1"></a><span class="co">#install BiocManager::install(&quot;Rgraphviz&quot;)</span></span>
<span id="cb159-5"><a href="machine-learning.html#cb159-5" tabindex="-1"></a></span>
<span id="cb159-6"><a href="machine-learning.html#cb159-6" tabindex="-1"></a>edge<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./Data-Use/Hosp_Network_geocoded.csv&quot;</span>)</span>
<span id="cb159-7"><a href="machine-learning.html#cb159-7" tabindex="-1"></a>df<span class="ot">&lt;-</span>edge[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="fu">dim</span>(edge)[<span class="dv">2</span>])]</span>
<span id="cb159-8"><a href="machine-learning.html#cb159-8" tabindex="-1"></a><span class="fu">row.names</span>(df)<span class="ot">&lt;-</span>edge[,<span class="dv">1</span>] <span class="co">#bipartite matrix</span></span>
<span id="cb159-9"><a href="machine-learning.html#cb159-9" tabindex="-1"></a></span>
<span id="cb159-10"><a href="machine-learning.html#cb159-10" tabindex="-1"></a><span class="co">#select columns#remove distance data</span></span>
<span id="cb159-11"><a href="machine-learning.html#cb159-11" tabindex="-1"></a>df_se<span class="ot">&lt;-</span>edge[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">16</span>)]</span>
<span id="cb159-12"><a href="machine-learning.html#cb159-12" tabindex="-1"></a><span class="fu">row.names</span>(df_se)<span class="ot">&lt;-</span>edge[,<span class="dv">1</span>] <span class="co">#bipartite matrix</span></span>
<span id="cb159-13"><a href="machine-learning.html#cb159-13" tabindex="-1"></a></span>
<span id="cb159-14"><a href="machine-learning.html#cb159-14" tabindex="-1"></a><span class="co">#south eastern hospitals</span></span>
<span id="cb159-15"><a href="machine-learning.html#cb159-15" tabindex="-1"></a><span class="co">#select rows</span></span>
<span id="cb159-16"><a href="machine-learning.html#cb159-16" tabindex="-1"></a>df_se<span class="ot">&lt;-</span>df_se[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">19</span>,<span class="dv">20</span>,<span class="dv">24</span>,<span class="dv">31</span>,<span class="dv">33</span>,<span class="dv">34</span>,<span class="dv">35</span>),]</span>
<span id="cb159-17"><a href="machine-learning.html#cb159-17" tabindex="-1"></a></span>
<span id="cb159-18"><a href="machine-learning.html#cb159-18" tabindex="-1"></a><span class="co">#perform Galois derivations between partially ordered subsets</span></span>
<span id="cb159-19"><a href="machine-learning.html#cb159-19" tabindex="-1"></a><span class="co">#galois(df_se&#39;,labeling = &quot;full&quot;)</span></span>
<span id="cb159-20"><a href="machine-learning.html#cb159-20" tabindex="-1"></a>gf <span class="ot">&lt;-</span> <span class="fu">galois</span>(df_se, <span class="at">labeling =</span> <span class="st">&quot;reduced&quot;</span>)</span>
<span id="cb159-21"><a href="machine-learning.html#cb159-21" tabindex="-1"></a><span class="co">#partial ordering of concept</span></span>
<span id="cb159-22"><a href="machine-learning.html#cb159-22" tabindex="-1"></a>po<span class="ot">&lt;-</span><span class="fu">partial.order</span>(gf,<span class="at">type=</span><span class="st">&quot;galois&quot;</span>)</span>
<span id="cb159-23"><a href="machine-learning.html#cb159-23" tabindex="-1"></a><span class="fu">diagram</span>(po, <span class="at">main=</span><span class="st">&quot;Hasse diagram of partial order with reduced context&quot;</span>) </span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-8-1-1.png" width="672" /></p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="machine-learning.html#cb160-1" tabindex="-1"></a><span class="co">#lattice  diagram with reduced context</span></span>
<span id="cb160-2"><a href="machine-learning.html#cb160-2" tabindex="-1"></a><span class="fu">diagram.levels</span>(po)</span></code></pre></div>
<pre><code>## $`9`
## [1] &quot;{designated, ECR} {mmc}&quot;
## 
## $`4`
## [1] &quot;{link_rmh} {}&quot; &quot;18&quot;            &quot;25&quot;            &quot;27&quot;           
## [5] &quot;28&quot;            &quot;31&quot;           
## 
## $`1`
## [1] &quot;{CT, link_mmc} {}&quot;
## 
## $`3`
## [1] &quot;{X99min_rmh} {dandenongvalley, knoxprivate, seprivate}&quot;
## [2] &quot;{TPA} {}&quot;                                              
## [3] &quot;{CTA} {}&quot;                                              
## [4] &quot;{stroke_unit} {}&quot;                                      
## [5] &quot;23&quot;                                                    
## 
## $`2`
## [1] &quot;{X99min_mmc} {}&quot; &quot;{public} {}&quot;    
## 
## $`7`
## [1] &quot;{CTP} {ddh}&quot;    &quot;{} {frankston}&quot; &quot;{} {latrobe}&quot;  
## 
## $`6`
## [1] &quot;{MRI} {}&quot;        &quot;{} {marroondah}&quot; &quot;19&quot;              &quot;{} {casey}&quot;     
## [5] &quot;{} {bairnsdale}&quot; &quot;{} {sale}&quot;      
## 
## $`5`
## [1] &quot;{VST} {}&quot;     &quot;{} {hampton}&quot; &quot;22&quot;           &quot;24&quot;           &quot;30&quot;          
## 
## $`8`
## [1] &quot;{neurosx} {cabrini}&quot; &quot;{} {bhh}&quot;            &quot;{} {warragul}&quot;      
## 
## $`10`
## [1] &quot;14&quot;</code></pre>
</div>
<div id="evolutionary-algorithm" class="section level2 hasAnchor" number="6.7">
<h2><span class="header-section-number">6.7</span> Evolutionary Algorithm<a href="machine-learning.html#evolutionary-algorithm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Evolutionary algorithm are search method which take the source of inspiration
from nature such as evolution and survival of the fittest. These are seen as heuristic based method. The results from evolutionary algorithm shouldnt be compared unless all conditions set are the same. In essence the findings are similar under the same conditions.</p>
<div id="simulated-annealing" class="section level3 hasAnchor" number="6.7.1">
<h3><span class="header-section-number">6.7.1</span> Simulated Annealing<a href="machine-learning.html#simulated-annealing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This method uses idea in metallurgy whereby metal is heated and then cooled to alter its property.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="machine-learning.html#cb162-1" tabindex="-1"></a><span class="co">#SA section is set not to run as the analysis takes a long time.</span></span>
<span id="cb162-2"><a href="machine-learning.html#cb162-2" tabindex="-1"></a><span class="co"># a saved run is provided below</span></span>
<span id="cb162-3"><a href="machine-learning.html#cb162-3" tabindex="-1"></a></span>
<span id="cb162-4"><a href="machine-learning.html#cb162-4" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;BreastCancer&quot;</span>,<span class="at">package =</span> <span class="st">&quot;mlbench&quot;</span>)</span>
<span id="cb162-5"><a href="machine-learning.html#cb162-5" tabindex="-1"></a><span class="fu">colnames</span>(BreastCancer)</span>
<span id="cb162-6"><a href="machine-learning.html#cb162-6" tabindex="-1"></a></span>
<span id="cb162-7"><a href="machine-learning.html#cb162-7" tabindex="-1"></a><span class="co">#check for duplicates</span></span>
<span id="cb162-8"><a href="machine-learning.html#cb162-8" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">duplicated</span>(BreastCancer))</span>
<span id="cb162-9"><a href="machine-learning.html#cb162-9" tabindex="-1"></a></span>
<span id="cb162-10"><a href="machine-learning.html#cb162-10" tabindex="-1"></a><span class="co">#remove duplicates</span></span>
<span id="cb162-11"><a href="machine-learning.html#cb162-11" tabindex="-1"></a><span class="co">#keep Id to avoid creation of new duplicates</span></span>
<span id="cb162-12"><a href="machine-learning.html#cb162-12" tabindex="-1"></a>BreastCancer1<span class="ot">&lt;-</span><span class="fu">unique</span>(BreastCancer) <span class="co">#reduce 699 to 691 rows</span></span>
<span id="cb162-13"><a href="machine-learning.html#cb162-13" tabindex="-1"></a></span>
<span id="cb162-14"><a href="machine-learning.html#cb162-14" tabindex="-1"></a><span class="co">#convert multiple columns to numeric</span></span>
<span id="cb162-15"><a href="machine-learning.html#cb162-15" tabindex="-1"></a><span class="co">#lapply output a list</span></span>
<span id="cb162-16"><a href="machine-learning.html#cb162-16" tabindex="-1"></a>BreastCancer2<span class="ot">&lt;-</span><span class="fu">lapply</span>(BreastCancer1[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">11</span>)], as.numeric) <span class="co">#list</span></span>
<span id="cb162-17"><a href="machine-learning.html#cb162-17" tabindex="-1"></a>BreastCancer2<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(BreastCancer2)</span>
<span id="cb162-18"><a href="machine-learning.html#cb162-18" tabindex="-1"></a>BreastCancer2<span class="sc">$</span>Class<span class="ot">&lt;-</span>BreastCancer1<span class="sc">$</span>Class</span>
<span id="cb162-19"><a href="machine-learning.html#cb162-19" tabindex="-1"></a></span>
<span id="cb162-20"><a href="machine-learning.html#cb162-20" tabindex="-1"></a>x<span class="ot">=</span>BreastCancer2[,<span class="sc">-</span><span class="dv">10</span>]</span>
<span id="cb162-21"><a href="machine-learning.html#cb162-21" tabindex="-1"></a>y<span class="ot">=</span>BreastCancer2<span class="sc">$</span>Class</span>
<span id="cb162-22"><a href="machine-learning.html#cb162-22" tabindex="-1"></a></span>
<span id="cb162-23"><a href="machine-learning.html#cb162-23" tabindex="-1"></a></span>
<span id="cb162-24"><a href="machine-learning.html#cb162-24" tabindex="-1"></a>sa_ctrl <span class="ot">&lt;-</span> <span class="fu">safsControl</span>(<span class="at">functions =</span> rfSA,</span>
<span id="cb162-25"><a href="machine-learning.html#cb162-25" tabindex="-1"></a>                       <span class="at">method =</span> <span class="st">&quot;repeatedcv&quot;</span>,</span>
<span id="cb162-26"><a href="machine-learning.html#cb162-26" tabindex="-1"></a>                       <span class="at">repeats =</span> <span class="dv">3</span>, <span class="co">#default is 5</span></span>
<span id="cb162-27"><a href="machine-learning.html#cb162-27" tabindex="-1"></a>                       <span class="at">improve =</span> <span class="dv">50</span>)</span>
<span id="cb162-28"><a href="machine-learning.html#cb162-28" tabindex="-1"></a></span>
<span id="cb162-29"><a href="machine-learning.html#cb162-29" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb162-30"><a href="machine-learning.html#cb162-30" tabindex="-1"></a>glm_sa <span class="ot">&lt;-</span> <span class="fu">safs</span>(<span class="at">x =</span> x, <span class="at">y =</span> y,</span>
<span id="cb162-31"><a href="machine-learning.html#cb162-31" tabindex="-1"></a>              <span class="at">iters =</span> <span class="dv">5</span>, <span class="co">#default is 250</span></span>
<span id="cb162-32"><a href="machine-learning.html#cb162-32" tabindex="-1"></a>              <span class="at">safsControl =</span> sa_ctrl, <span class="at">method=</span><span class="st">&quot;glm&quot;</span>)</span>
<span id="cb162-33"><a href="machine-learning.html#cb162-33" tabindex="-1"></a></span>
<span id="cb162-34"><a href="machine-learning.html#cb162-34" tabindex="-1"></a><span class="co">#save(glm_sa,file=&quot;Logistic_SimulatedAnnealing.Rda&quot;)</span></span>
<span id="cb162-35"><a href="machine-learning.html#cb162-35" tabindex="-1"></a></span>
<span id="cb162-36"><a href="machine-learning.html#cb162-36" tabindex="-1"></a><span class="do">#############################################</span></span>
<span id="cb162-37"><a href="machine-learning.html#cb162-37" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb162-38"><a href="machine-learning.html#cb162-38" tabindex="-1"></a><span class="co">#Simulated Annealing Feature Selection</span></span>
<span id="cb162-39"><a href="machine-learning.html#cb162-39" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb162-40"><a href="machine-learning.html#cb162-40" tabindex="-1"></a><span class="co">#691 samples</span></span>
<span id="cb162-41"><a href="machine-learning.html#cb162-41" tabindex="-1"></a><span class="co">#9 predictors</span></span>
<span id="cb162-42"><a href="machine-learning.html#cb162-42" tabindex="-1"></a><span class="co">#2 classes: &#39;benign&#39;, &#39;malignant&#39; </span></span>
<span id="cb162-43"><a href="machine-learning.html#cb162-43" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb162-44"><a href="machine-learning.html#cb162-44" tabindex="-1"></a><span class="co">#Maximum search iterations: 5 </span></span>
<span id="cb162-45"><a href="machine-learning.html#cb162-45" tabindex="-1"></a><span class="co">#Restart after 50 iterations without improvement (0 restarts on average)</span></span>
<span id="cb162-46"><a href="machine-learning.html#cb162-46" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb162-47"><a href="machine-learning.html#cb162-47" tabindex="-1"></a><span class="co">#Internal performance values: Accuracy, Kappa</span></span>
<span id="cb162-48"><a href="machine-learning.html#cb162-48" tabindex="-1"></a><span class="co">#Subset selection driven to maximize internal Accuracy </span></span>
<span id="cb162-49"><a href="machine-learning.html#cb162-49" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb162-50"><a href="machine-learning.html#cb162-50" tabindex="-1"></a><span class="co">#External performance values: Accuracy, Kappa</span></span>
<span id="cb162-51"><a href="machine-learning.html#cb162-51" tabindex="-1"></a><span class="co">#Best iteration chose by maximizing external Accuracy </span></span>
<span id="cb162-52"><a href="machine-learning.html#cb162-52" tabindex="-1"></a><span class="co">#External resampling method: Cross-Validated (10 fold, repeated 3 times) </span></span>
<span id="cb162-53"><a href="machine-learning.html#cb162-53" tabindex="-1"></a></span>
<span id="cb162-54"><a href="machine-learning.html#cb162-54" tabindex="-1"></a><span class="co">#During resampling:</span></span>
<span id="cb162-55"><a href="machine-learning.html#cb162-55" tabindex="-1"></a><span class="co">#  * the top 5 selected variables (out of a possible 9):</span></span>
<span id="cb162-56"><a href="machine-learning.html#cb162-56" tabindex="-1"></a><span class="co">#    Bl.cromatin (56.7%), Id (46.7%), Cl.thickness (43.3%), Epith.c.size (43.3%), #Marg.adhesion (43.3%)</span></span>
<span id="cb162-57"><a href="machine-learning.html#cb162-57" tabindex="-1"></a><span class="co">#  * on average, 3.5 variables were selected (min = 2, max = 5)</span></span>
<span id="cb162-58"><a href="machine-learning.html#cb162-58" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb162-59"><a href="machine-learning.html#cb162-59" tabindex="-1"></a><span class="co">#In the final search using the entire training set:</span></span>
<span id="cb162-60"><a href="machine-learning.html#cb162-60" tabindex="-1"></a><span class="co">#   * 2 features selected at iteration 5 including:</span></span>
<span id="cb162-61"><a href="machine-learning.html#cb162-61" tabindex="-1"></a><span class="co">#     Cl.thickness, Cell.size  </span></span>
<span id="cb162-62"><a href="machine-learning.html#cb162-62" tabindex="-1"></a><span class="co">#   * external performance at this iteration is</span></span>
<span id="cb162-63"><a href="machine-learning.html#cb162-63" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb162-64"><a href="machine-learning.html#cb162-64" tabindex="-1"></a><span class="co">#   Accuracy       Kappa </span></span>
<span id="cb162-65"><a href="machine-learning.html#cb162-65" tabindex="-1"></a><span class="co">#     0.9314      0.8479 </span></span></code></pre></div>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="machine-learning.html#cb163-1" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;./Logistic_SimulatedAnnealing.Rda&quot;</span>)</span>
<span id="cb163-2"><a href="machine-learning.html#cb163-2" tabindex="-1"></a></span>
<span id="cb163-3"><a href="machine-learning.html#cb163-3" tabindex="-1"></a><span class="co">#plot output of simulated annealing</span></span>
<span id="cb163-4"><a href="machine-learning.html#cb163-4" tabindex="-1"></a><span class="fu">plot</span>(glm_sa)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-9-1-1.png" width="672" /></p>
</div>
<div id="genetic-algorithm" class="section level3 hasAnchor" number="6.7.2">
<h3><span class="header-section-number">6.7.2</span> Genetic Algorithm<a href="machine-learning.html#genetic-algorithm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Genetic algorithm is a machine learning tool based on ideas from Darwins
concept of natural selection. It is based on mutation, crossover and selection. Genetic algorithm can be used in any situation. The issue is in finding the fitness function to evaluate the output. Since it does not depend on gradient descent algorithm, it is less likely to be stuck in local minima compared to
other machine learning methods. Genetic algorithm is available in R as part of <em>caret</em> and <em>GA</em> libraries. Genetic algorithm can be used to optimise feature selection for regression modelling at the expense of much longer running time.</p>
<p>One potential issue with using cross-validation in genetic algorithm for feature selection is that it would be not right to use it again when feeding this data into another machine learning method.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="machine-learning.html#cb164-1" tabindex="-1"></a><span class="co">#GA</span></span>
<span id="cb164-2"><a href="machine-learning.html#cb164-2" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb164-3"><a href="machine-learning.html#cb164-3" tabindex="-1"></a></span>
<span id="cb164-4"><a href="machine-learning.html#cb164-4" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;BreastCancer&quot;</span>,<span class="at">package =</span> <span class="st">&quot;mlbench&quot;</span>)</span>
<span id="cb164-5"><a href="machine-learning.html#cb164-5" tabindex="-1"></a><span class="fu">colnames</span>(BreastCancer)</span>
<span id="cb164-6"><a href="machine-learning.html#cb164-6" tabindex="-1"></a></span>
<span id="cb164-7"><a href="machine-learning.html#cb164-7" tabindex="-1"></a><span class="co">#check for duplicates</span></span>
<span id="cb164-8"><a href="machine-learning.html#cb164-8" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">duplicated</span>(BreastCancer))</span>
<span id="cb164-9"><a href="machine-learning.html#cb164-9" tabindex="-1"></a></span>
<span id="cb164-10"><a href="machine-learning.html#cb164-10" tabindex="-1"></a><span class="co">#remove duplicates</span></span>
<span id="cb164-11"><a href="machine-learning.html#cb164-11" tabindex="-1"></a><span class="co">#keep Id to avoid creation of new duplicates</span></span>
<span id="cb164-12"><a href="machine-learning.html#cb164-12" tabindex="-1"></a>BreastCancer1<span class="ot">&lt;-</span><span class="fu">unique</span>(BreastCancer) <span class="co">#reduce 699 to 691 rows</span></span>
<span id="cb164-13"><a href="machine-learning.html#cb164-13" tabindex="-1"></a></span>
<span id="cb164-14"><a href="machine-learning.html#cb164-14" tabindex="-1"></a><span class="co">#convert multiple columns to numeric</span></span>
<span id="cb164-15"><a href="machine-learning.html#cb164-15" tabindex="-1"></a><span class="co">#lapply output a list</span></span>
<span id="cb164-16"><a href="machine-learning.html#cb164-16" tabindex="-1"></a>BreastCancer2<span class="ot">&lt;-</span><span class="fu">lapply</span>(BreastCancer1[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">11</span>)], as.numeric) <span class="co">#list</span></span>
<span id="cb164-17"><a href="machine-learning.html#cb164-17" tabindex="-1"></a>BreastCancer2<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(BreastCancer2)</span>
<span id="cb164-18"><a href="machine-learning.html#cb164-18" tabindex="-1"></a>BreastCancer2<span class="sc">$</span>Class<span class="ot">&lt;-</span>BreastCancer1<span class="sc">$</span>Class</span>
<span id="cb164-19"><a href="machine-learning.html#cb164-19" tabindex="-1"></a></span>
<span id="cb164-20"><a href="machine-learning.html#cb164-20" tabindex="-1"></a></span>
<span id="cb164-21"><a href="machine-learning.html#cb164-21" tabindex="-1"></a><span class="co">#check for NA</span></span>
<span id="cb164-22"><a href="machine-learning.html#cb164-22" tabindex="-1"></a><span class="fu">anyNA</span>(BreastCancer2)</span>
<span id="cb164-23"><a href="machine-learning.html#cb164-23" tabindex="-1"></a></span>
<span id="cb164-24"><a href="machine-learning.html#cb164-24" tabindex="-1"></a>split <span class="ot">=</span> caTools<span class="sc">::</span><span class="fu">sample.split</span>(BreastCancer2<span class="sc">$</span>Class, <span class="at">SplitRatio =</span> <span class="fl">0.7</span>)</span>
<span id="cb164-25"><a href="machine-learning.html#cb164-25" tabindex="-1"></a>Train <span class="ot">=</span> <span class="fu">subset</span>(BreastCancer2, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb164-26"><a href="machine-learning.html#cb164-26" tabindex="-1"></a>Test <span class="ot">=</span> <span class="fu">subset</span>(BreastCancer2, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb164-27"><a href="machine-learning.html#cb164-27" tabindex="-1"></a></span>
<span id="cb164-28"><a href="machine-learning.html#cb164-28" tabindex="-1"></a>x<span class="ot">=</span>Train[,<span class="sc">-</span><span class="dv">10</span>]</span>
<span id="cb164-29"><a href="machine-learning.html#cb164-29" tabindex="-1"></a>y<span class="ot">=</span>Train<span class="sc">$</span>Class</span>
<span id="cb164-30"><a href="machine-learning.html#cb164-30" tabindex="-1"></a></span>
<span id="cb164-31"><a href="machine-learning.html#cb164-31" tabindex="-1"></a><span class="co">#cross validation indicates the number of cycle of the procedure from randomly generating new population of chromosome to mutate child chromosome.</span></span>
<span id="cb164-32"><a href="machine-learning.html#cb164-32" tabindex="-1"></a></span>
<span id="cb164-33"><a href="machine-learning.html#cb164-33" tabindex="-1"></a>ga_ctrl <span class="ot">&lt;-</span> <span class="fu">gafsControl</span>(<span class="at">functions =</span> rfGA,</span>
<span id="cb164-34"><a href="machine-learning.html#cb164-34" tabindex="-1"></a>                       <span class="at">method =</span> <span class="st">&quot;cv&quot;</span>,</span>
<span id="cb164-35"><a href="machine-learning.html#cb164-35" tabindex="-1"></a>                       <span class="at">repeats =</span> <span class="dv">3</span>, <span class="co"># default is 10</span></span>
<span id="cb164-36"><a href="machine-learning.html#cb164-36" tabindex="-1"></a>                       <span class="at">genParallel=</span><span class="cn">TRUE</span>, <span class="co"># Use parallel programming</span></span>
<span id="cb164-37"><a href="machine-learning.html#cb164-37" tabindex="-1"></a>                       <span class="at">allowParallel =</span> <span class="cn">TRUE</span></span>
<span id="cb164-38"><a href="machine-learning.html#cb164-38" tabindex="-1"></a>                       )</span>
<span id="cb164-39"><a href="machine-learning.html#cb164-39" tabindex="-1"></a></span>
<span id="cb164-40"><a href="machine-learning.html#cb164-40" tabindex="-1"></a><span class="do">## Use the same random number seed as the RFE process</span></span>
<span id="cb164-41"><a href="machine-learning.html#cb164-41" tabindex="-1"></a><span class="do">## so that the same CV folds are used for the external</span></span>
<span id="cb164-42"><a href="machine-learning.html#cb164-42" tabindex="-1"></a><span class="do">## resampling. </span></span>
<span id="cb164-43"><a href="machine-learning.html#cb164-43" tabindex="-1"></a></span>
<span id="cb164-44"><a href="machine-learning.html#cb164-44" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb164-45"><a href="machine-learning.html#cb164-45" tabindex="-1"></a><span class="fu">system.time</span>(glm_ga <span class="ot">&lt;-</span> <span class="fu">gafs</span>(<span class="at">x =</span> x, <span class="at">y =</span> y,</span>
<span id="cb164-46"><a href="machine-learning.html#cb164-46" tabindex="-1"></a>              <span class="at">iters =</span> <span class="dv">5</span>, <span class="co">#recommended is 200</span></span>
<span id="cb164-47"><a href="machine-learning.html#cb164-47" tabindex="-1"></a>              <span class="at">gafsControl =</span> ga_ctrl, <span class="at">method=</span><span class="st">&quot;glm&quot;</span>))</span>
<span id="cb164-48"><a href="machine-learning.html#cb164-48" tabindex="-1"></a></span>
<span id="cb164-49"><a href="machine-learning.html#cb164-49" tabindex="-1"></a><span class="co">#save(glm_ga,file=&quot;Logistic_GeneticAlgorithm.Rda&quot;)</span></span>
<span id="cb164-50"><a href="machine-learning.html#cb164-50" tabindex="-1"></a></span>
<span id="cb164-51"><a href="machine-learning.html#cb164-51" tabindex="-1"></a><span class="do">################################################################</span></span>
<span id="cb164-52"><a href="machine-learning.html#cb164-52" tabindex="-1"></a><span class="co"># The output of glm_ga</span></span>
<span id="cb164-53"><a href="machine-learning.html#cb164-53" tabindex="-1"></a><span class="co">#Genetic Algorithm Feature Selection</span></span>
<span id="cb164-54"><a href="machine-learning.html#cb164-54" tabindex="-1"></a></span>
<span id="cb164-55"><a href="machine-learning.html#cb164-55" tabindex="-1"></a><span class="co">#484 samples</span></span>
<span id="cb164-56"><a href="machine-learning.html#cb164-56" tabindex="-1"></a><span class="co">#9 predictors</span></span>
<span id="cb164-57"><a href="machine-learning.html#cb164-57" tabindex="-1"></a><span class="co">#2 classes: &#39;benign&#39;, &#39;malignant&#39; </span></span>
<span id="cb164-58"><a href="machine-learning.html#cb164-58" tabindex="-1"></a></span>
<span id="cb164-59"><a href="machine-learning.html#cb164-59" tabindex="-1"></a><span class="co">#Maximum generations: 5 </span></span>
<span id="cb164-60"><a href="machine-learning.html#cb164-60" tabindex="-1"></a><span class="co">#Population per generation: 50 </span></span>
<span id="cb164-61"><a href="machine-learning.html#cb164-61" tabindex="-1"></a><span class="co">#Crossover probability: 0.8 </span></span>
<span id="cb164-62"><a href="machine-learning.html#cb164-62" tabindex="-1"></a><span class="co">#Mutation probability: 0.1 </span></span>
<span id="cb164-63"><a href="machine-learning.html#cb164-63" tabindex="-1"></a><span class="co">#Elitism: 0 </span></span>
<span id="cb164-64"><a href="machine-learning.html#cb164-64" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb164-65"><a href="machine-learning.html#cb164-65" tabindex="-1"></a><span class="co">#Internal performance values: Accuracy, Kappa</span></span>
<span id="cb164-66"><a href="machine-learning.html#cb164-66" tabindex="-1"></a><span class="co">#Subset selection driven to maximize internal Accuracy </span></span>
<span id="cb164-67"><a href="machine-learning.html#cb164-67" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb164-68"><a href="machine-learning.html#cb164-68" tabindex="-1"></a><span class="co">#External performance values: Accuracy, Kappa</span></span>
<span id="cb164-69"><a href="machine-learning.html#cb164-69" tabindex="-1"></a><span class="co">#Best iteration chose by maximizing external Accuracy </span></span>
<span id="cb164-70"><a href="machine-learning.html#cb164-70" tabindex="-1"></a><span class="co">#External resampling method: Cross-Validated (10 fold) </span></span>
<span id="cb164-71"><a href="machine-learning.html#cb164-71" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb164-72"><a href="machine-learning.html#cb164-72" tabindex="-1"></a><span class="co">#During resampling:</span></span>
<span id="cb164-73"><a href="machine-learning.html#cb164-73" tabindex="-1"></a><span class="co">#  * the top 5 selected variables (out of a possible 9):</span></span>
<span id="cb164-74"><a href="machine-learning.html#cb164-74" tabindex="-1"></a><span class="co">#    Cell.shape (100%), Cl.thickness (100%), Epith.c.size (100%), </span></span>
<span id="cb164-75"><a href="machine-learning.html#cb164-75" tabindex="-1"></a>Normal.nucleoli <span class="co">#(100%), Id (90%)</span></span>
<span id="cb164-76"><a href="machine-learning.html#cb164-76" tabindex="-1"></a><span class="co">#  * on average, 6.7 variables were selected (min = 5, max = 8)</span></span>
<span id="cb164-77"><a href="machine-learning.html#cb164-77" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb164-78"><a href="machine-learning.html#cb164-78" tabindex="-1"></a><span class="co">#In the final search using the entire training set:</span></span>
<span id="cb164-79"><a href="machine-learning.html#cb164-79" tabindex="-1"></a><span class="co">#   * 7 features selected at iteration 2 including:</span></span>
<span id="cb164-80"><a href="machine-learning.html#cb164-80" tabindex="-1"></a><span class="co">#     Cl.thickness, Cell.shape, Marg.adhesion, Epith.c.size, Bl.cromatin ... </span></span>
<span id="cb164-81"><a href="machine-learning.html#cb164-81" tabindex="-1"></a><span class="co">#   * external performance at this iteration is</span></span>
<span id="cb164-82"><a href="machine-learning.html#cb164-82" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb164-83"><a href="machine-learning.html#cb164-83" tabindex="-1"></a><span class="co">#   Accuracy       Kappa </span></span>
<span id="cb164-84"><a href="machine-learning.html#cb164-84" tabindex="-1"></a><span class="co">#     0.9691      0.9328 </span></span>
<span id="cb164-85"><a href="machine-learning.html#cb164-85" tabindex="-1"></a><span class="co">#</span></span></code></pre></div>
<p>The output from the Genetic Algorithm is plotted as mean fitness by
generations. This plot shows the internal and external accuracy estimate from cross validation.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="machine-learning.html#cb165-1" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;./Logistic_GeneticAlgorithm.Rda&quot;</span>)</span>
<span id="cb165-2"><a href="machine-learning.html#cb165-2" tabindex="-1"></a><span class="co">#plot output of genetic algorithm </span></span>
<span id="cb165-3"><a href="machine-learning.html#cb165-3" tabindex="-1"></a><span class="fu">plot</span>(glm_ga)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-10-1-1.png" width="672" /></p>
</div>
</div>
<div id="manifold-learning" class="section level2 hasAnchor" number="6.8">
<h2><span class="header-section-number">6.8</span> Manifold learning<a href="machine-learning.html#manifold-learning" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Manifold learning has been described as using geometry information in high dimensional space to map data into cluster in lower dimensional space. This is a non-linear reduction technique. Several manifold learning methods are described below but this list is not exhaustive. It is available through <em>maniTools</em> package.</p>
<div id="t-stochastic-neighbourhood-embedding" class="section level3 hasAnchor" number="6.8.1">
<h3><span class="header-section-number">6.8.1</span> T-Stochastic Neighbourhood Embedding<a href="machine-learning.html#t-stochastic-neighbourhood-embedding" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>T-Stochastic Neighbourhood Embedding (TSNE) is a manifold learning method which seeks to transform the complex data into low (2) dimensions while maintaining
the distance between neighbouring objects. The distance between data points are can be measured using Euclidean distance or other measures of distance. The transformed data points are conditional probabilities that represents similarities. The original description of TSNE used PCA as a first step to speed up computation and reduce noise.</p>
<p>This method is listed here as it is a form of data reduction method. This non-linear method is different from PCA in that the low dimensional output of
TSNE are not intended for machine learning. TSNE is implemented in R as <em>Rtsne</em>. The perplexity parameter allows tuning of the proximity of the data points. The PCA step can be performed within <em>Rtsne</em> by setting the <em>pca</em> argument. The default number of iterations or max_iter is 1000.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="machine-learning.html#cb166-1" tabindex="-1"></a><span class="fu">library</span>(Rtsne)</span>
<span id="cb166-2"><a href="machine-learning.html#cb166-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb166-3"><a href="machine-learning.html#cb166-3" tabindex="-1"></a><span class="fu">library</span>(mice) <span class="co">#impute missing data</span></span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;mice&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:BiocGenerics&#39;:
## 
##     cbind, rbind</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     filter</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     cbind, rbind</code></pre>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="machine-learning.html#cb171-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;BreastCancer&quot;</span>,<span class="at">package =</span> <span class="st">&quot;mlbench&quot;</span>)</span>
<span id="cb171-2"><a href="machine-learning.html#cb171-2" tabindex="-1"></a><span class="fu">colnames</span>(BreastCancer)</span></code></pre></div>
<pre><code>##  [1] &quot;Id&quot;              &quot;Cl.thickness&quot;    &quot;Cell.size&quot;       &quot;Cell.shape&quot;     
##  [5] &quot;Marg.adhesion&quot;   &quot;Epith.c.size&quot;    &quot;Bare.nuclei&quot;     &quot;Bl.cromatin&quot;    
##  [9] &quot;Normal.nucleoli&quot; &quot;Mitoses&quot;         &quot;Class&quot;</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="machine-learning.html#cb173-1" tabindex="-1"></a><span class="co">#check for duplicates</span></span>
<span id="cb173-2"><a href="machine-learning.html#cb173-2" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">duplicated</span>(BreastCancer))</span></code></pre></div>
<pre><code>## [1] 8</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="machine-learning.html#cb175-1" tabindex="-1"></a><span class="co">#remove duplicates</span></span>
<span id="cb175-2"><a href="machine-learning.html#cb175-2" tabindex="-1"></a><span class="co">#keep Id to avoid creation of new duplicates</span></span>
<span id="cb175-3"><a href="machine-learning.html#cb175-3" tabindex="-1"></a>BreastCancer1<span class="ot">&lt;-</span><span class="fu">unique</span>(BreastCancer) <span class="co">#reduce 699 to 691 rows</span></span>
<span id="cb175-4"><a href="machine-learning.html#cb175-4" tabindex="-1"></a></span>
<span id="cb175-5"><a href="machine-learning.html#cb175-5" tabindex="-1"></a><span class="co">#impute missing data</span></span>
<span id="cb175-6"><a href="machine-learning.html#cb175-6" tabindex="-1"></a><span class="co">#m is number of multiple imputation, default is 5</span></span>
<span id="cb175-7"><a href="machine-learning.html#cb175-7" tabindex="-1"></a><span class="co">#output is a list</span></span>
<span id="cb175-8"><a href="machine-learning.html#cb175-8" tabindex="-1"></a>imputed_Data <span class="ot">&lt;-</span> <span class="fu">mice</span>(BreastCancer1, <span class="at">m=</span><span class="dv">5</span>, <span class="at">maxit =</span> <span class="dv">5</span>, <span class="at">method =</span> <span class="st">&#39;pmm&#39;</span>, <span class="at">seed =</span> <span class="dv">500</span>)</span></code></pre></div>
<pre><code>## 
##  iter imp variable
##   1   1  Bare.nuclei
##   1   2  Bare.nuclei
##   1   3  Bare.nuclei
##   1   4  Bare.nuclei
##   1   5  Bare.nuclei
##   2   1  Bare.nuclei
##   2   2  Bare.nuclei
##   2   3  Bare.nuclei
##   2   4  Bare.nuclei
##   2   5  Bare.nuclei
##   3   1  Bare.nuclei
##   3   2  Bare.nuclei
##   3   3  Bare.nuclei
##   3   4  Bare.nuclei
##   3   5  Bare.nuclei
##   4   1  Bare.nuclei
##   4   2  Bare.nuclei
##   4   3  Bare.nuclei
##   4   4  Bare.nuclei
##   4   5  Bare.nuclei
##   5   1  Bare.nuclei
##   5   2  Bare.nuclei
##   5   3  Bare.nuclei
##   5   4  Bare.nuclei
##   5   5  Bare.nuclei</code></pre>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="machine-learning.html#cb177-1" tabindex="-1"></a><span class="co">#choose among the 5 imputed dataset</span></span>
<span id="cb177-2"><a href="machine-learning.html#cb177-2" tabindex="-1"></a>completeData <span class="ot">&lt;-</span> <span class="fu">complete</span>(imputed_Data,<span class="dv">2</span>)</span>
<span id="cb177-3"><a href="machine-learning.html#cb177-3" tabindex="-1"></a></span>
<span id="cb177-4"><a href="machine-learning.html#cb177-4" tabindex="-1"></a><span class="co">#convert multiple columns to numeric</span></span>
<span id="cb177-5"><a href="machine-learning.html#cb177-5" tabindex="-1"></a><span class="co">#lapply output a list</span></span>
<span id="cb177-6"><a href="machine-learning.html#cb177-6" tabindex="-1"></a>BreastCancer2<span class="ot">&lt;-</span><span class="fu">lapply</span>(completeData[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">11</span>)], as.numeric) <span class="co">#list</span></span>
<span id="cb177-7"><a href="machine-learning.html#cb177-7" tabindex="-1"></a>BreastCancer2<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(BreastCancer2)</span>
<span id="cb177-8"><a href="machine-learning.html#cb177-8" tabindex="-1"></a>BreastCancer2<span class="sc">$</span>Class<span class="ot">&lt;-</span>BreastCancer1<span class="sc">$</span>Class</span>
<span id="cb177-9"><a href="machine-learning.html#cb177-9" tabindex="-1"></a></span>
<span id="cb177-10"><a href="machine-learning.html#cb177-10" tabindex="-1"></a>BC_unique <span class="ot">&lt;-</span> <span class="fu">unique</span>(BreastCancer2) <span class="co"># Remove duplicates</span></span>
<span id="cb177-11"><a href="machine-learning.html#cb177-11" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>) <span class="co"># Sets seed for reproducibility</span></span>
<span id="cb177-12"><a href="machine-learning.html#cb177-12" tabindex="-1"></a>tsne_out <span class="ot">&lt;-</span> <span class="fu">Rtsne</span>(<span class="fu">as.matrix</span>(BC_unique[,<span class="sc">-</span><span class="dv">11</span>]), </span>
<span id="cb177-13"><a href="machine-learning.html#cb177-13" tabindex="-1"></a>        <span class="at">normalize =</span> T, <span class="co">#normalise data</span></span>
<span id="cb177-14"><a href="machine-learning.html#cb177-14" tabindex="-1"></a>        <span class="at">pca=</span>T, <span class="at">dims =</span> <span class="dv">3</span>, <span class="co">#pca before analysis</span></span>
<span id="cb177-15"><a href="machine-learning.html#cb177-15" tabindex="-1"></a>        <span class="at">perplexity=</span><span class="dv">20</span>, <span class="co">#tuning</span></span>
<span id="cb177-16"><a href="machine-learning.html#cb177-16" tabindex="-1"></a>        <span class="at">verbose=</span><span class="cn">FALSE</span>) <span class="co"># Run TSNE</span></span>
<span id="cb177-17"><a href="machine-learning.html#cb177-17" tabindex="-1"></a><span class="co">#plot(tsne_out$Y,col=BC_unique$Class,asp=1)</span></span>
<span id="cb177-18"><a href="machine-learning.html#cb177-18" tabindex="-1"></a></span>
<span id="cb177-19"><a href="machine-learning.html#cb177-19" tabindex="-1"></a><span class="co"># Add a new column with color</span></span>
<span id="cb177-20"><a href="machine-learning.html#cb177-20" tabindex="-1"></a>mycolors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;red&#39;</span>, <span class="st">&#39;blue&#39;</span>)</span>
<span id="cb177-21"><a href="machine-learning.html#cb177-21" tabindex="-1"></a>BC_unique<span class="sc">$</span>color <span class="ot">&lt;-</span> mycolors[ <span class="fu">as.numeric</span>(BC_unique<span class="sc">$</span>Class) ]</span>
<span id="cb177-22"><a href="machine-learning.html#cb177-22" tabindex="-1"></a></span>
<span id="cb177-23"><a href="machine-learning.html#cb177-23" tabindex="-1"></a><span class="co">#turn off rgl</span></span>
<span id="cb177-24"><a href="machine-learning.html#cb177-24" tabindex="-1"></a><span class="co">#rgl::plot3d(x=tsne_out$Y[,1], y=tsne_out$Y[,2], z=tsne_out$Y[,3], type = &#39;p&#39;, col=BC_unique$color, size=8)</span></span>
<span id="cb177-25"><a href="machine-learning.html#cb177-25" tabindex="-1"></a><span class="co">#rgl::legend3d(&quot;topright&quot;, legend = names(mycolors), pch = 16, col = colors, cex=1, inset=c(0.02))</span></span></code></pre></div>
<p>The example with Breast cancer didnt turn out as well. Lets try TSNE with the iris dataset.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="machine-learning.html#cb178-1" tabindex="-1"></a><span class="co">#TSNE</span></span>
<span id="cb178-2"><a href="machine-learning.html#cb178-2" tabindex="-1"></a></span>
<span id="cb178-3"><a href="machine-learning.html#cb178-3" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb178-4"><a href="machine-learning.html#cb178-4" tabindex="-1"></a><span class="co">#5 columns</span></span>
<span id="cb178-5"><a href="machine-learning.html#cb178-5" tabindex="-1"></a></span>
<span id="cb178-6"><a href="machine-learning.html#cb178-6" tabindex="-1"></a>Iris_unique <span class="ot">&lt;-</span> <span class="fu">unique</span>(iris) <span class="co"># Remove duplicates</span></span>
<span id="cb178-7"><a href="machine-learning.html#cb178-7" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>) <span class="co"># Sets seed for reproducibility</span></span>
<span id="cb178-8"><a href="machine-learning.html#cb178-8" tabindex="-1"></a>tsne_out <span class="ot">&lt;-</span> <span class="fu">Rtsne</span>(<span class="fu">as.matrix</span>(Iris_unique[,<span class="sc">-</span><span class="dv">5</span>]), <span class="at">dims =</span> <span class="dv">2</span>, <span class="at">perplexity=</span><span class="dv">10</span>, <span class="at">verbose=</span><span class="cn">FALSE</span>) <span class="co"># Run TSNE</span></span>
<span id="cb178-9"><a href="machine-learning.html#cb178-9" tabindex="-1"></a><span class="fu">plot</span>(tsne_out<span class="sc">$</span>Y,<span class="at">col=</span>Iris_unique<span class="sc">$</span>Species,<span class="at">asp=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-11-1-1.png" width="672" /></p>
</div>
<div id="self-organising-map" class="section level3 hasAnchor" number="6.8.2">
<h3><span class="header-section-number">6.8.2</span> Self organising map<a href="machine-learning.html#self-organising-map" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Self organising map is an unsupervised machine learning method and is excellent for viewing complex data in low dimensional space i.e.a data reduction method. SOM is available as part of <em>kohonen</em> library. It uses competitive learning to adjust its weight in contrast to other neural network approaches which use backward propagation or gradient descent to update the weight of the features. Each node is evaluated to participate in the neural network. Input vectors that are close to each other in high dimensional space are mapped to be close to each other in low dimensional space. SOM is a competeitive neural network and has been considered as a deep learning method.</p>
<p>The codes below are modified from <a href="https://rpubs.com/AlgoritmaAcademy/som" class="uri">https://rpubs.com/AlgoritmaAcademy/som</a> for use in analysis of iris data. The first illustration is with unsupervised SOM.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="machine-learning.html#cb179-1" tabindex="-1"></a><span class="fu">library</span>(kohonen)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;kohonen&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     map</code></pre>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="machine-learning.html#cb182-1" tabindex="-1"></a><span class="co">#unsupervised SOM</span></span>
<span id="cb182-2"><a href="machine-learning.html#cb182-2" tabindex="-1"></a><span class="co">#use iris dataset 150 x 5</span></span>
<span id="cb182-3"><a href="machine-learning.html#cb182-3" tabindex="-1"></a></span>
<span id="cb182-4"><a href="machine-learning.html#cb182-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb182-5"><a href="machine-learning.html#cb182-5" tabindex="-1"></a></span>
<span id="cb182-6"><a href="machine-learning.html#cb182-6" tabindex="-1"></a><span class="co">#convert to numeric matrix</span></span>
<span id="cb182-7"><a href="machine-learning.html#cb182-7" tabindex="-1"></a>iris.train <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">scale</span>(iris[,<span class="sc">-</span><span class="dv">5</span>]))</span>
<span id="cb182-8"><a href="machine-learning.html#cb182-8" tabindex="-1"></a></span>
<span id="cb182-9"><a href="machine-learning.html#cb182-9" tabindex="-1"></a><span class="co"># grid should be smaller than dim(iris) 150 x5</span></span>
<span id="cb182-10"><a href="machine-learning.html#cb182-10" tabindex="-1"></a><span class="co">#xdim =10 and ydim=10 would be &lt; 120</span></span>
<span id="cb182-11"><a href="machine-learning.html#cb182-11" tabindex="-1"></a>iris.grid <span class="ot">&lt;-</span> <span class="fu">somgrid</span>(<span class="at">xdim =</span> <span class="dv">10</span>, <span class="at">ydim =</span> <span class="dv">10</span>, <span class="at">topo =</span> <span class="st">&quot;hexagonal&quot;</span>)</span>
<span id="cb182-12"><a href="machine-learning.html#cb182-12" tabindex="-1"></a></span>
<span id="cb182-13"><a href="machine-learning.html#cb182-13" tabindex="-1"></a><span class="co">#som model</span></span>
<span id="cb182-14"><a href="machine-learning.html#cb182-14" tabindex="-1"></a>iris.model <span class="ot">&lt;-</span> <span class="fu">som</span>(iris.train, iris.grid, <span class="at">rlen =</span> <span class="dv">500</span>, <span class="at">radius =</span> <span class="fl">2.5</span>, <span class="at">keep.data =</span> <span class="cn">TRUE</span>, <span class="at">dist.fcts =</span> <span class="st">&quot;euclidean&quot;</span>)</span>
<span id="cb182-15"><a href="machine-learning.html#cb182-15" tabindex="-1"></a></span>
<span id="cb182-16"><a href="machine-learning.html#cb182-16" tabindex="-1"></a><span class="fu">plot</span>(iris.model, <span class="at">type =</span> <span class="st">&quot;mapping&quot;</span>, <span class="at">pchs =</span> <span class="dv">19</span>, <span class="at">shape =</span> <span class="st">&quot;round&quot;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-12-1.png" width="672" /></p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="machine-learning.html#cb183-1" tabindex="-1"></a><span class="fu">plot</span>(iris.model, <span class="at">type =</span> <span class="st">&quot;codes&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Codes Plot&quot;</span>, <span class="at">palette.name =</span> rainbow)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-12-1-1.png" width="672" /></p>
<p>The plot of training shows that the distance between nodes reached a plateau
after 300 iterations.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="machine-learning.html#cb184-1" tabindex="-1"></a><span class="fu">plot</span>(iris.model, <span class="at">type =</span> <span class="st">&quot;changes&quot;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-12-2-1.png" width="672" /></p>
<p>Supervised SOM is now performed with the same iris data.</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="machine-learning.html#cb185-1" tabindex="-1"></a><span class="co">#SOM</span></span>
<span id="cb185-2"><a href="machine-learning.html#cb185-2" tabindex="-1"></a></span>
<span id="cb185-3"><a href="machine-learning.html#cb185-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb185-4"><a href="machine-learning.html#cb185-4" tabindex="-1"></a>int <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(iris), <span class="fu">nrow</span>(iris)<span class="sc">*</span><span class="fl">0.8</span>)</span>
<span id="cb185-5"><a href="machine-learning.html#cb185-5" tabindex="-1"></a>train <span class="ot">&lt;-</span> iris[int,]</span>
<span id="cb185-6"><a href="machine-learning.html#cb185-6" tabindex="-1"></a>test <span class="ot">&lt;-</span> iris[<span class="sc">-</span>int,]</span>
<span id="cb185-7"><a href="machine-learning.html#cb185-7" tabindex="-1"></a></span>
<span id="cb185-8"><a href="machine-learning.html#cb185-8" tabindex="-1"></a><span class="co"># scaling data</span></span>
<span id="cb185-9"><a href="machine-learning.html#cb185-9" tabindex="-1"></a>trainX <span class="ot">&lt;-</span> <span class="fu">scale</span>(train[,<span class="sc">-</span><span class="dv">5</span>])</span>
<span id="cb185-10"><a href="machine-learning.html#cb185-10" tabindex="-1"></a>testX <span class="ot">&lt;-</span> <span class="fu">scale</span>(test[,<span class="sc">-</span><span class="dv">5</span>], <span class="at">center =</span> <span class="fu">attr</span>(trainX, <span class="st">&quot;scaled:center&quot;</span>))</span>
<span id="cb185-11"><a href="machine-learning.html#cb185-11" tabindex="-1"></a></span>
<span id="cb185-12"><a href="machine-learning.html#cb185-12" tabindex="-1"></a><span class="co"># make label</span></span>
<span id="cb185-13"><a href="machine-learning.html#cb185-13" tabindex="-1"></a><span class="co">#iris$species is already of class factor</span></span>
<span id="cb185-14"><a href="machine-learning.html#cb185-14" tabindex="-1"></a></span>
<span id="cb185-15"><a href="machine-learning.html#cb185-15" tabindex="-1"></a>train.label <span class="ot">&lt;-</span> train[,<span class="dv">5</span>]</span>
<span id="cb185-16"><a href="machine-learning.html#cb185-16" tabindex="-1"></a>test.label <span class="ot">&lt;-</span> test[,<span class="dv">5</span>]</span>
<span id="cb185-17"><a href="machine-learning.html#cb185-17" tabindex="-1"></a>test[,<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="dv">916</span></span>
<span id="cb185-18"><a href="machine-learning.html#cb185-18" tabindex="-1"></a>testXY <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">independent =</span> testX, <span class="at">dependent =</span> test.label)</span>
<span id="cb185-19"><a href="machine-learning.html#cb185-19" tabindex="-1"></a></span>
<span id="cb185-20"><a href="machine-learning.html#cb185-20" tabindex="-1"></a><span class="co"># make a train data sets that scaled</span></span>
<span id="cb185-21"><a href="machine-learning.html#cb185-21" tabindex="-1"></a><span class="co"># convert them to be a numeric matrix </span></span>
<span id="cb185-22"><a href="machine-learning.html#cb185-22" tabindex="-1"></a>iris.train <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">scale</span>(train[,<span class="sc">-</span><span class="dv">5</span>]))</span>
<span id="cb185-23"><a href="machine-learning.html#cb185-23" tabindex="-1"></a></span>
<span id="cb185-24"><a href="machine-learning.html#cb185-24" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb185-25"><a href="machine-learning.html#cb185-25" tabindex="-1"></a></span>
<span id="cb185-26"><a href="machine-learning.html#cb185-26" tabindex="-1"></a><span class="co"># grid should be smaller than dim(train) 120 x5</span></span>
<span id="cb185-27"><a href="machine-learning.html#cb185-27" tabindex="-1"></a><span class="co">#xdim =10 and ydim=10 would be &lt; 120</span></span>
<span id="cb185-28"><a href="machine-learning.html#cb185-28" tabindex="-1"></a>iris.grid <span class="ot">&lt;-</span> <span class="fu">somgrid</span>(<span class="at">xdim =</span> <span class="dv">10</span>, <span class="at">ydim =</span> <span class="dv">10</span>, <span class="at">topo =</span> <span class="st">&quot;hexagonal&quot;</span>)</span>
<span id="cb185-29"><a href="machine-learning.html#cb185-29" tabindex="-1"></a></span>
<span id="cb185-30"><a href="machine-learning.html#cb185-30" tabindex="-1"></a><span class="co">#som model</span></span>
<span id="cb185-31"><a href="machine-learning.html#cb185-31" tabindex="-1"></a>iris.model <span class="ot">&lt;-</span> <span class="fu">som</span>(iris.train, iris.grid, <span class="at">rlen =</span> <span class="dv">500</span>, <span class="at">radius =</span> <span class="fl">2.5</span>, <span class="at">keep.data =</span> <span class="cn">TRUE</span>, <span class="at">dist.fcts =</span> <span class="st">&quot;euclidean&quot;</span>)</span>
<span id="cb185-32"><a href="machine-learning.html#cb185-32" tabindex="-1"></a></span>
<span id="cb185-33"><a href="machine-learning.html#cb185-33" tabindex="-1"></a>class <span class="ot">&lt;-</span> <span class="fu">xyf</span>(trainX, <span class="fu">classvec2classmat</span>(train.label), iris.grid, <span class="at">rlen =</span> <span class="dv">500</span>)</span>
<span id="cb185-34"><a href="machine-learning.html#cb185-34" tabindex="-1"></a></span>
<span id="cb185-35"><a href="machine-learning.html#cb185-35" tabindex="-1"></a><span class="fu">plot</span>(class, <span class="at">type =</span> <span class="st">&quot;changes&quot;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-13-1.png" width="672" /></p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="machine-learning.html#cb186-1" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(class, <span class="at">newdata =</span> testXY)</span>
<span id="cb186-2"><a href="machine-learning.html#cb186-2" tabindex="-1"></a><span class="fu">table</span>(<span class="at">Predict =</span> pred<span class="sc">$</span>predictions[[<span class="dv">2</span>]], <span class="at">Actual =</span> test.label)</span></code></pre></div>
<pre><code>##             Actual
## Predict      setosa versicolor virginica
##   setosa          9          0         0
##   versicolor      0          8         0
##   virginica       0          0         7</code></pre>
<p>Determine number of clusters.</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="machine-learning.html#cb188-1" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span></code></pre></div>
<pre><code>## Welcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa</code></pre>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="machine-learning.html#cb190-1" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(iris.model<span class="sc">$</span>codes[[<span class="dv">1</span>]], kmeans, <span class="at">method =</span> <span class="st">&quot;wss&quot;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-13-1-1.png" width="672" /></p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="machine-learning.html#cb191-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb191-2"><a href="machine-learning.html#cb191-2" tabindex="-1"></a>clust <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(iris.model<span class="sc">$</span>codes[[<span class="dv">1</span>]], <span class="dv">6</span>)</span>
<span id="cb191-3"><a href="machine-learning.html#cb191-3" tabindex="-1"></a><span class="fu">plot</span>(iris.model, <span class="at">type =</span> <span class="st">&quot;codes&quot;</span>, <span class="at">bgcol =</span> <span class="fu">rainbow</span>(<span class="dv">9</span>)[clust<span class="sc">$</span>cluster], </span>
<span id="cb191-4"><a href="machine-learning.html#cb191-4" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Cluster SOM&quot;</span>)</span>
<span id="cb191-5"><a href="machine-learning.html#cb191-5" tabindex="-1"></a><span class="fu">add.cluster.boundaries</span>(iris.model, clust<span class="sc">$</span>cluster)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-13-2-1.png" width="672" /></p>
</div>
<div id="multidimensional-scaling" class="section level3 hasAnchor" number="6.8.3">
<h3><span class="header-section-number">6.8.3</span> Multidimensional scaling<a href="machine-learning.html#multidimensional-scaling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>MDS is a method of dimensionality reduction which preserves the distance between variables. This method has been used in geography. It is implemented in <em>IsoplotR</em> package and <em>igraph</em> package as <em>layout.mds</em>.</p>
</div>
</div>
<div id="deep-learning" class="section level2 hasAnchor" number="6.9">
<h2><span class="header-section-number">6.9</span> Deep learning<a href="machine-learning.html#deep-learning" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Deep learning is a neural network with many layers: inner, multiple hidden and outer layer. Deep learning methods can be supervised or unsupervised. It uses gradient descent algorithm in search for the solution. One potential issue that
it may be stuck in a local minima rather than the global minima.</p>
<p>There are several R libraries for performing deep learning. Its worth checking out the installation requirement as some require installing the library in
python and uses the <em>reticulate</em> library to perform analysis. The examples used here are R libraries including <em>RSNNS</em>. The instructions for installing <em>Miniconda</em> from <em>reticulate</em> was provided in the earlier chapter on [data wrangling][Python Minconda environment]. Those instruction include installing <em>torch</em> and <em>kerras</em>.</p>
<div id="deep-neural-network" class="section level3 hasAnchor" number="6.9.1">
<h3><span class="header-section-number">6.9.1</span> Deep neural network<a href="machine-learning.html#deep-neural-network" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="multiplayer-perceptron" class="section level4 hasAnchor" number="6.9.1.1">
<h4><span class="header-section-number">6.9.1.1</span> Multiplayer Perceptron<a href="machine-learning.html#multiplayer-perceptron" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Multilayer perceptron is a type of deep learning. . It passes information in one direction from inner to hidden and outer layer and hence is referred to as feed forward artificial neural network. It trains the data using a loss function
which adapt to the parameter and optimise according to the specified learning rate. Overfitting is minimised by using an L2 regularisation penalty, termed alpha.</p>
<p>For tabular data, deep learning may not necessarily be better than other machine learning method. By contrast, deep learning may be better for unstructured data.</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="machine-learning.html#cb192-1" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb192-2"><a href="machine-learning.html#cb192-2" tabindex="-1"></a><span class="fu">library</span>(RSNNS)</span></code></pre></div>
<pre><code>## Loading required package: Rcpp</code></pre>
<pre><code>## 
## Attaching package: &#39;RSNNS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:kohonen&#39;:
## 
##     som</code></pre>
<pre><code>## The following objects are masked from &#39;package:caret&#39;:
## 
##     confusionMatrix, train</code></pre>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="machine-learning.html#cb197-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;BreastCancer&quot;</span>,<span class="at">package =</span> <span class="st">&quot;mlbench&quot;</span>)</span>
<span id="cb197-2"><a href="machine-learning.html#cb197-2" tabindex="-1"></a><span class="fu">colnames</span>(BreastCancer)</span></code></pre></div>
<pre><code>##  [1] &quot;Id&quot;              &quot;Cl.thickness&quot;    &quot;Cell.size&quot;       &quot;Cell.shape&quot;     
##  [5] &quot;Marg.adhesion&quot;   &quot;Epith.c.size&quot;    &quot;Bare.nuclei&quot;     &quot;Bl.cromatin&quot;    
##  [9] &quot;Normal.nucleoli&quot; &quot;Mitoses&quot;         &quot;Class&quot;</code></pre>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="machine-learning.html#cb199-1" tabindex="-1"></a><span class="co">#remove ID column</span></span>
<span id="cb199-2"><a href="machine-learning.html#cb199-2" tabindex="-1"></a><span class="co">#remove column a=with NA </span></span>
<span id="cb199-3"><a href="machine-learning.html#cb199-3" tabindex="-1"></a><span class="co">#alternative is to impute</span></span>
<span id="cb199-4"><a href="machine-learning.html#cb199-4" tabindex="-1"></a>BreastCancer<span class="ot">&lt;-</span>BreastCancer[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>)]<span class="co">#remaining 9 columns</span></span>
<span id="cb199-5"><a href="machine-learning.html#cb199-5" tabindex="-1"></a></span>
<span id="cb199-6"><a href="machine-learning.html#cb199-6" tabindex="-1"></a><span class="co">#convert multiple columns to numeric</span></span>
<span id="cb199-7"><a href="machine-learning.html#cb199-7" tabindex="-1"></a><span class="co">#lapply output a list</span></span>
<span id="cb199-8"><a href="machine-learning.html#cb199-8" tabindex="-1"></a>BreastCancer2<span class="ot">&lt;-</span><span class="fu">lapply</span>(BreastCancer[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">9</span>)], as.numeric)</span>
<span id="cb199-9"><a href="machine-learning.html#cb199-9" tabindex="-1"></a>BreastCancer2<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(BreastCancer2)</span>
<span id="cb199-10"><a href="machine-learning.html#cb199-10" tabindex="-1"></a>BreastCancer2<span class="ot">&lt;-</span><span class="fu">merge</span>(BreastCancer2, BreastCancer<span class="sc">$</span>Class)</span>
<span id="cb199-11"><a href="machine-learning.html#cb199-11" tabindex="-1"></a></span>
<span id="cb199-12"><a href="machine-learning.html#cb199-12" tabindex="-1"></a><span class="co">#note Class is benign or malignant of class factor</span></span>
<span id="cb199-13"><a href="machine-learning.html#cb199-13" tabindex="-1"></a><span class="co">#column Bare.nuclei removed due to NA</span></span>
<span id="cb199-14"><a href="machine-learning.html#cb199-14" tabindex="-1"></a></span>
<span id="cb199-15"><a href="machine-learning.html#cb199-15" tabindex="-1"></a><span class="co">#split data</span></span>
<span id="cb199-16"><a href="machine-learning.html#cb199-16" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb199-17"><a href="machine-learning.html#cb199-17" tabindex="-1"></a></span>
<span id="cb199-18"><a href="machine-learning.html#cb199-18" tabindex="-1"></a>BreastCancer2Values <span class="ot">&lt;-</span> BreastCancer2[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>)]</span>
<span id="cb199-19"><a href="machine-learning.html#cb199-19" tabindex="-1"></a>BreastCancer2Targets <span class="ot">&lt;-</span> <span class="fu">decodeClassLabels</span>(BreastCancer2[,<span class="dv">9</span>])</span>
<span id="cb199-20"><a href="machine-learning.html#cb199-20" tabindex="-1"></a></span>
<span id="cb199-21"><a href="machine-learning.html#cb199-21" tabindex="-1"></a><span class="co">#this returns the orginal file as a list</span></span>
<span id="cb199-22"><a href="machine-learning.html#cb199-22" tabindex="-1"></a>BreastCancer2 <span class="ot">&lt;-</span> <span class="fu">splitForTrainingAndTest</span>(BreastCancer2Values, BreastCancer2Targets, <span class="at">ratio=</span><span class="fl">0.15</span>) <span class="co">#ratio is percentage for test data</span></span>
<span id="cb199-23"><a href="machine-learning.html#cb199-23" tabindex="-1"></a>BreastCancer2 <span class="ot">&lt;-</span> <span class="fu">normTrainingAndTestSet</span>(BreastCancer2) <span class="co">#put out a list object</span></span>
<span id="cb199-24"><a href="machine-learning.html#cb199-24" tabindex="-1"></a></span>
<span id="cb199-25"><a href="machine-learning.html#cb199-25" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">mlp</span>(BreastCancer2<span class="sc">$</span>inputsTrain, </span>
<span id="cb199-26"><a href="machine-learning.html#cb199-26" tabindex="-1"></a>             BreastCancer2<span class="sc">$</span>targetsTrain, </span>
<span id="cb199-27"><a href="machine-learning.html#cb199-27" tabindex="-1"></a>             <span class="at">size=</span><span class="dv">5</span>, <span class="co">#number of unit in hidden layer </span></span>
<span id="cb199-28"><a href="machine-learning.html#cb199-28" tabindex="-1"></a>             <span class="at">learnFuncParams=</span><span class="fu">c</span>(<span class="fl">0.1</span>), </span>
<span id="cb199-29"><a href="machine-learning.html#cb199-29" tabindex="-1"></a>              <span class="at">maxit=</span><span class="dv">50</span>, <span class="co">#number of iteration to learn</span></span>
<span id="cb199-30"><a href="machine-learning.html#cb199-30" tabindex="-1"></a>             <span class="at">inputsTest=</span>BreastCancer2<span class="sc">$</span>inputsTest, <span class="at">targetsTest=</span>BreastCancer2<span class="sc">$</span>targetsTest)</span>
<span id="cb199-31"><a href="machine-learning.html#cb199-31" tabindex="-1"></a></span>
<span id="cb199-32"><a href="machine-learning.html#cb199-32" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## SNNS network definition file V1.4-3D
## generated at Mon Feb  5 10:09:39 2024
## 
## network name : RSNNS_untitled
## source files :
## no. of units : 15
## no. of connections : 50
## no. of unit types : 0
## no. of site types : 0
## 
## 
## learning function : Std_Backpropagation
## update function   : Topological_Order
## 
## 
## unit default section :
## 
## act      | bias     | st | subnet | layer | act func     | out func
## ---------|----------|----|--------|-------|--------------|-------------
##  0.00000 |  0.00000 | i  |      0 |     1 | Act_Logistic | Out_Identity 
## ---------|----------|----|--------|-------|--------------|-------------
## 
## 
## unit definition section :
## 
## no. | typeName | unitName         | act      | bias     | st | position | act func     | out func | sites
## ----|----------|------------------|----------|----------|----|----------|--------------|----------|-------
##   1 |          | Input_1          | -0.14849 | -0.12745 | i  | 1,0,0    | Act_Identity |          | 
##   2 |          | Input_2          |  1.59566 |  0.17298 | i  | 2,0,0    | Act_Identity |          | 
##   3 |          | Input_3          |  1.61379 | -0.05461 | i  | 3,0,0    | Act_Identity |          | 
##   4 |          | Input_4          |  0.76866 |  0.22981 | i  | 4,0,0    | Act_Identity |          | 
##   5 |          | Input_5          |  0.35424 |  0.26428 | i  | 5,0,0    | Act_Identity |          | 
##   6 |          | Input_6          |  2.69324 | -0.27267 | i  | 6,0,0    | Act_Identity |          | 
##   7 |          | Input_7          |  0.37127 |  0.01686 | i  | 7,0,0    | Act_Identity |          | 
##   8 |          | Input_8          | -0.35178 |  0.23545 | i  | 8,0,0    | Act_Identity |          | 
##   9 |          | Hidden_2_1       |  0.01505 | -4.19609 | h  | 1,2,0    |||
##  10 |          | Hidden_2_2       |  0.01511 | -4.18364 | h  | 2,2,0    |||
##  11 |          | Hidden_2_3       |  0.01446 | -4.17636 | h  | 3,2,0    |||
##  12 |          | Hidden_2_4       |  0.01596 | -4.17513 | h  | 4,2,0    |||
##  13 |          | Hidden_2_5       |  0.01394 | -4.20955 | h  | 5,2,0    |||
##  14 |          | Output_benign    |  0.71619 |  0.92553 | o  | 1,4,0    |||
##  15 |          | Output_malignant |  0.28380 | -0.92463 | o  | 2,4,0    |||
## ----|----------|------------------|----------|----------|----|----------|--------------|----------|-------
## 
## 
## connection definition section :
## 
## target | site | source:weight
## -------|------|---------------------------------------------------------------------------------------------------------------------
##      9 |      |  8:-0.00576,  7: 0.00727,  6:-0.00682,  5:-0.01802,  4: 0.01969,  3:-0.08011,  2: 0.09269,  1:-0.00830
##     10 |      |  8:-0.00727,  7: 0.02291,  6:-0.00065,  5:-0.01455,  4: 0.01343,  3: 0.07341,  2:-0.07951,  1:-0.00231
##     11 |      |  8:-0.02047,  7: 0.00020,  6:-0.03410,  5: 0.01364,  4: 0.05111,  3:-0.04571,  2: 0.04224,  1:-0.00804
##     12 |      |  8: 0.00616,  7: 0.00433,  6: 0.01931,  5:-0.03026,  4: 0.00085,  3:-0.02034,  2: 0.02802,  1:-0.00241
##     13 |      |  8:-0.01292,  7: 0.00408,  6: 0.00104,  5: 0.00315,  4: 0.04242,  3:-0.07730,  2: 0.02324,  1: 0.03049
##     14 |      | 13: 0.02422, 12:-0.07496, 11:-0.05541, 10: 0.00556,  9: 0.11299
##     15 |      | 13: 0.00929, 12:-0.09087, 11:-0.07272, 10:-0.00928,  9: 0.09646
## -------|------|---------------------------------------------------------------------------------------------------------------------</code></pre>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="machine-learning.html#cb201-1" tabindex="-1"></a><span class="fu">weightMatrix</span>(model)</span></code></pre></div>
<pre><code>##                  Input_1 Input_2 Input_3 Input_4 Input_5 Input_6 Input_7
## Input_1                0       0       0       0       0       0       0
## Input_2                0       0       0       0       0       0       0
## Input_3                0       0       0       0       0       0       0
## Input_4                0       0       0       0       0       0       0
## Input_5                0       0       0       0       0       0       0
## Input_6                0       0       0       0       0       0       0
## Input_7                0       0       0       0       0       0       0
## Input_8                0       0       0       0       0       0       0
## Hidden_2_1             0       0       0       0       0       0       0
## Hidden_2_2             0       0       0       0       0       0       0
## Hidden_2_3             0       0       0       0       0       0       0
## Hidden_2_4             0       0       0       0       0       0       0
## Hidden_2_5             0       0       0       0       0       0       0
## Output_benign          0       0       0       0       0       0       0
## Output_malignant       0       0       0       0       0       0       0
##                  Input_8   Hidden_2_1    Hidden_2_2    Hidden_2_3    Hidden_2_4
## Input_1                0 -0.008297254 -0.0023068141 -0.0080354111 -0.0024115480
## Input_2                0  0.092688218 -0.0795127451  0.0422427431  0.0280199945
## Input_3                0 -0.080105409  0.0734057277 -0.0457132570 -0.0203414690
## Input_4                0  0.019694204  0.0134255355  0.0511073507  0.0008500156
## Input_5                0 -0.018022288 -0.0145457229  0.0136382505 -0.0302589945
## Input_6                0 -0.006821295 -0.0006512092 -0.0341025740  0.0193094723
## Input_7                0  0.007272924  0.0229056627  0.0001989322  0.0043286891
## Input_8                0 -0.005761526 -0.0072661606 -0.0204701889  0.0061648567
## Hidden_2_1             0  0.000000000  0.0000000000  0.0000000000  0.0000000000
## Hidden_2_2             0  0.000000000  0.0000000000  0.0000000000  0.0000000000
## Hidden_2_3             0  0.000000000  0.0000000000  0.0000000000  0.0000000000
## Hidden_2_4             0  0.000000000  0.0000000000  0.0000000000  0.0000000000
## Hidden_2_5             0  0.000000000  0.0000000000  0.0000000000  0.0000000000
## Output_benign          0  0.000000000  0.0000000000  0.0000000000  0.0000000000
## Output_malignant       0  0.000000000  0.0000000000  0.0000000000  0.0000000000
##                    Hidden_2_5 Output_benign Output_malignant
## Input_1           0.030488508   0.000000000      0.000000000
## Input_2           0.023240086   0.000000000      0.000000000
## Input_3          -0.077304244   0.000000000      0.000000000
## Input_4           0.042423774   0.000000000      0.000000000
## Input_5           0.003147935   0.000000000      0.000000000
## Input_6           0.001040343   0.000000000      0.000000000
## Input_7           0.004078272   0.000000000      0.000000000
## Input_8          -0.012916351   0.000000000      0.000000000
## Hidden_2_1        0.000000000   0.112992622      0.096456863
## Hidden_2_2        0.000000000   0.005558367     -0.009282685
## Hidden_2_3        0.000000000  -0.055406742     -0.072724856
## Hidden_2_4        0.000000000  -0.074957542     -0.090871565
## Hidden_2_5        0.000000000   0.024224803      0.009294559
## Output_benign     0.000000000   0.000000000      0.000000000
## Output_malignant  0.000000000   0.000000000      0.000000000</code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="machine-learning.html#cb203-1" tabindex="-1"></a><span class="fu">extractNetInfo</span>(model)</span></code></pre></div>
<pre><code>## $infoHeader
##                 name               value
## 1       no. of units                  15
## 2 no. of connections                  50
## 3  no. of unit types                   0
## 4  no. of site types                   0
## 5  learning function Std_Backpropagation
## 6    update function   Topological_Order
## 
## $unitDefinitions
##    unitNo         unitName     unitAct    unitBias        type posX posY posZ
## 1       1          Input_1 -0.14849401 -0.12745351  UNIT_INPUT    1    0    0
## 2       2          Input_2  1.59566152  0.17298311  UNIT_INPUT    2    0    0
## 3       3          Input_3  1.61378837 -0.05461386  UNIT_INPUT    3    0    0
## 4       4          Input_4  0.76865852  0.22981048  UNIT_INPUT    4    0    0
## 5       5          Input_5  0.35424057  0.26428038  UNIT_INPUT    5    0    0
## 6       6          Input_6  2.69324446 -0.27266610  UNIT_INPUT    6    0    0
## 7       7          Input_7  0.37127367  0.01686329  UNIT_INPUT    7    0    0
## 8       8          Input_8 -0.35178334  0.23545146  UNIT_INPUT    8    0    0
## 9       9       Hidden_2_1  0.01505136 -4.19608831 UNIT_HIDDEN    1    2    0
## 10     10       Hidden_2_2  0.01510898 -4.18364382 UNIT_HIDDEN    2    2    0
## 11     11       Hidden_2_3  0.01445734 -4.17636061 UNIT_HIDDEN    3    2    0
## 12     12       Hidden_2_4  0.01596117 -4.17512655 UNIT_HIDDEN    4    2    0
## 13     13       Hidden_2_5  0.01393711 -4.20955276 UNIT_HIDDEN    5    2    0
## 14     14    Output_benign  0.71619302  0.92553055 UNIT_OUTPUT    1    4    0
## 15     15 Output_malignant  0.28380045 -0.92462683 UNIT_OUTPUT    2    4    0
##         actFunc      outFunc sites
## 1  Act_Identity Out_Identity      
## 2  Act_Identity Out_Identity      
## 3  Act_Identity Out_Identity      
## 4  Act_Identity Out_Identity      
## 5  Act_Identity Out_Identity      
## 6  Act_Identity Out_Identity      
## 7  Act_Identity Out_Identity      
## 8  Act_Identity Out_Identity      
## 9  Act_Logistic Out_Identity      
## 10 Act_Logistic Out_Identity      
## 11 Act_Logistic Out_Identity      
## 12 Act_Logistic Out_Identity      
## 13 Act_Logistic Out_Identity      
## 14 Act_Logistic Out_Identity      
## 15 Act_Logistic Out_Identity      
## 
## $fullWeightMatrix
##                  Input_1 Input_2 Input_3 Input_4 Input_5 Input_6 Input_7
## Input_1                0       0       0       0       0       0       0
## Input_2                0       0       0       0       0       0       0
## Input_3                0       0       0       0       0       0       0
## Input_4                0       0       0       0       0       0       0
## Input_5                0       0       0       0       0       0       0
## Input_6                0       0       0       0       0       0       0
## Input_7                0       0       0       0       0       0       0
## Input_8                0       0       0       0       0       0       0
## Hidden_2_1             0       0       0       0       0       0       0
## Hidden_2_2             0       0       0       0       0       0       0
## Hidden_2_3             0       0       0       0       0       0       0
## Hidden_2_4             0       0       0       0       0       0       0
## Hidden_2_5             0       0       0       0       0       0       0
## Output_benign          0       0       0       0       0       0       0
## Output_malignant       0       0       0       0       0       0       0
##                  Input_8   Hidden_2_1    Hidden_2_2    Hidden_2_3    Hidden_2_4
## Input_1                0 -0.008297254 -0.0023068141 -0.0080354111 -0.0024115480
## Input_2                0  0.092688218 -0.0795127451  0.0422427431  0.0280199945
## Input_3                0 -0.080105409  0.0734057277 -0.0457132570 -0.0203414690
## Input_4                0  0.019694204  0.0134255355  0.0511073507  0.0008500156
## Input_5                0 -0.018022288 -0.0145457229  0.0136382505 -0.0302589945
## Input_6                0 -0.006821295 -0.0006512092 -0.0341025740  0.0193094723
## Input_7                0  0.007272924  0.0229056627  0.0001989322  0.0043286891
## Input_8                0 -0.005761526 -0.0072661606 -0.0204701889  0.0061648567
## Hidden_2_1             0  0.000000000  0.0000000000  0.0000000000  0.0000000000
## Hidden_2_2             0  0.000000000  0.0000000000  0.0000000000  0.0000000000
## Hidden_2_3             0  0.000000000  0.0000000000  0.0000000000  0.0000000000
## Hidden_2_4             0  0.000000000  0.0000000000  0.0000000000  0.0000000000
## Hidden_2_5             0  0.000000000  0.0000000000  0.0000000000  0.0000000000
## Output_benign          0  0.000000000  0.0000000000  0.0000000000  0.0000000000
## Output_malignant       0  0.000000000  0.0000000000  0.0000000000  0.0000000000
##                    Hidden_2_5 Output_benign Output_malignant
## Input_1           0.030488508   0.000000000      0.000000000
## Input_2           0.023240086   0.000000000      0.000000000
## Input_3          -0.077304244   0.000000000      0.000000000
## Input_4           0.042423774   0.000000000      0.000000000
## Input_5           0.003147935   0.000000000      0.000000000
## Input_6           0.001040343   0.000000000      0.000000000
## Input_7           0.004078272   0.000000000      0.000000000
## Input_8          -0.012916351   0.000000000      0.000000000
## Hidden_2_1        0.000000000   0.112992622      0.096456863
## Hidden_2_2        0.000000000   0.005558367     -0.009282685
## Hidden_2_3        0.000000000  -0.055406742     -0.072724856
## Hidden_2_4        0.000000000  -0.074957542     -0.090871565
## Hidden_2_5        0.000000000   0.024224803      0.009294559
## Output_benign     0.000000000   0.000000000      0.000000000
## Output_malignant  0.000000000   0.000000000      0.000000000</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="machine-learning.html#cb205-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb205-2"><a href="machine-learning.html#cb205-2" tabindex="-1"></a><span class="fu">plotIterativeError</span>(model)</span>
<span id="cb205-3"><a href="machine-learning.html#cb205-3" tabindex="-1"></a></span>
<span id="cb205-4"><a href="machine-learning.html#cb205-4" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model,BreastCancer2<span class="sc">$</span>inputsTest)</span>
<span id="cb205-5"><a href="machine-learning.html#cb205-5" tabindex="-1"></a></span>
<span id="cb205-6"><a href="machine-learning.html#cb205-6" tabindex="-1"></a><span class="fu">plotRegressionError</span>(predictions[,<span class="dv">2</span>], BreastCancer2<span class="sc">$</span>targetsTest[,<span class="dv">2</span>])</span>
<span id="cb205-7"><a href="machine-learning.html#cb205-7" tabindex="-1"></a></span>
<span id="cb205-8"><a href="machine-learning.html#cb205-8" tabindex="-1"></a><span class="fu">confusionMatrix</span>(BreastCancer2<span class="sc">$</span>targetsTrain,<span class="fu">fitted.values</span>(model))</span></code></pre></div>
<pre><code>##        predictions
## targets      1
##       1 262125
##       2 153185</code></pre>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="machine-learning.html#cb207-1" tabindex="-1"></a><span class="fu">confusionMatrix</span>(BreastCancer2<span class="sc">$</span>targetsTest,predictions)</span></code></pre></div>
<pre><code>##        predictions
## targets     1
##       1 58017
##       2 15274</code></pre>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="machine-learning.html#cb209-1" tabindex="-1"></a><span class="fu">plotROC</span>(<span class="fu">fitted.values</span>(model)[,<span class="dv">2</span>], BreastCancer2<span class="sc">$</span>targetsTrain[,<span class="dv">2</span>])</span>
<span id="cb209-2"><a href="machine-learning.html#cb209-2" tabindex="-1"></a><span class="fu">plotROC</span>(predictions[,<span class="dv">2</span>], BreastCancer2<span class="sc">$</span>targetsTest[,<span class="dv">2</span>])</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-14-1.png" width="672" /></p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="machine-learning.html#cb210-1" tabindex="-1"></a>probs <span class="ot">&lt;-</span> predictions <span class="sc">/</span> <span class="fu">rowSums</span>(predictions)</span>
<span id="cb210-2"><a href="machine-learning.html#cb210-2" tabindex="-1"></a></span>
<span id="cb210-3"><a href="machine-learning.html#cb210-3" tabindex="-1"></a><span class="co">#confusion matrix with 402040-method</span></span>
<span id="cb210-4"><a href="machine-learning.html#cb210-4" tabindex="-1"></a><span class="fu">confusionMatrix</span>(BreastCancer2<span class="sc">$</span>targetsTrain, <span class="fu">encodeClassLabels</span>(<span class="fu">fitted.values</span>(model),                                                      <span class="at">method=</span><span class="st">&quot;402040&quot;</span>, <span class="at">l=</span><span class="fl">0.4</span>, <span class="at">h=</span><span class="fl">0.6</span>))</span></code></pre></div>
<pre><code>##        predictions
## targets      1
##       1 262125
##       2 153185</code></pre>
</div>
<div id="deep-survival-neural-network" class="section level4 hasAnchor" number="6.9.1.2">
<h4><span class="header-section-number">6.9.1.2</span> Deep survival neural network<a href="machine-learning.html#deep-survival-neural-network" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There are several libraries available in <em>survivalmodels</em> which interface with <em>pycox</em> from Python. First, we illustrate the use of <em>deepsurv</em>.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="machine-learning.html#cb212-1" tabindex="-1"></a><span class="fu">library</span>(survivalmodels)</span></code></pre></div>
<pre><code>## Warning: package &#39;survivalmodels&#39; was built under R version 4.3.2</code></pre>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="machine-learning.html#cb214-1" tabindex="-1"></a><span class="fu">data</span>(Melanoma, <span class="at">package =</span> <span class="st">&quot;MASS&quot;</span>)</span>
<span id="cb214-2"><a href="machine-learning.html#cb214-2" tabindex="-1"></a></span>
<span id="cb214-3"><a href="machine-learning.html#cb214-3" tabindex="-1"></a>times <span class="ot">&lt;-</span> Melanoma<span class="sc">$</span>time</span>
<span id="cb214-4"><a href="machine-learning.html#cb214-4" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(times<span class="sc">/</span><span class="dv">7</span>)  <span class="do">## weeks</span></span>
<span id="cb214-5"><a href="machine-learning.html#cb214-5" tabindex="-1"></a></span>
<span id="cb214-6"><a href="machine-learning.html#cb214-6" tabindex="-1"></a><span class="co">#1 died from melanoma, 2 alive, 3 dead from other causes.</span></span>
<span id="cb214-7"><a href="machine-learning.html#cb214-7" tabindex="-1"></a><span class="do">##delta: 0=censored, 1=dead</span></span>
<span id="cb214-8"><a href="machine-learning.html#cb214-8" tabindex="-1"></a>delta<span class="ot">=</span><span class="fu">ifelse</span>(Melanoma<span class="sc">$</span>status<span class="sc">==</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb214-9"><a href="machine-learning.html#cb214-9" tabindex="-1"></a></span>
<span id="cb214-10"><a href="machine-learning.html#cb214-10" tabindex="-1"></a><span class="do">## matrix of observed covariates</span></span>
<span id="cb214-11"><a href="machine-learning.html#cb214-11" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Melanoma<span class="sc">$</span>sex, Melanoma<span class="sc">$</span>age, Melanoma<span class="sc">$</span>thickness)</span>
<span id="cb214-12"><a href="machine-learning.html#cb214-12" tabindex="-1"></a></span>
<span id="cb214-13"><a href="machine-learning.html#cb214-13" tabindex="-1"></a><span class="fu">deepsurv</span>(<span class="at">data =</span> Melanoma, </span>
<span id="cb214-14"><a href="machine-learning.html#cb214-14" tabindex="-1"></a>    <span class="at">frac =</span> <span class="fl">0.3</span>, <span class="co">#Fraction of data to use for validation </span></span>
<span id="cb214-15"><a href="machine-learning.html#cb214-15" tabindex="-1"></a>    <span class="at">activation =</span> <span class="st">&quot;relu&quot;</span>,</span>
<span id="cb214-16"><a href="machine-learning.html#cb214-16" tabindex="-1"></a>    <span class="at">num_nodes =</span> <span class="fu">c</span>(4L, 8L, 4L, 2L), </span>
<span id="cb214-17"><a href="machine-learning.html#cb214-17" tabindex="-1"></a>    <span class="at">dropout =</span> <span class="fl">0.1</span>, </span>
<span id="cb214-18"><a href="machine-learning.html#cb214-18" tabindex="-1"></a>    <span class="at">early_stopping =</span> <span class="cn">TRUE</span>, </span>
<span id="cb214-19"><a href="machine-learning.html#cb214-19" tabindex="-1"></a>    <span class="at">epochs =</span> 100L, <span class="co">#number of epochs.</span></span>
<span id="cb214-20"><a href="machine-learning.html#cb214-20" tabindex="-1"></a>    <span class="at">batch_size =</span> 32L)</span></code></pre></div>
<pre><code>## 
##  DeepSurv Neural Network 
## 
## Call:
##   deepsurv(data = Melanoma, frac = 0.3, activation = &quot;relu&quot;, num_nodes = c(4L,      8L, 4L, 2L), dropout = 0.1, early_stopping = TRUE, batch_size = 32L,      epochs = 100L)
## 
## Response:
##   Surv(time, status)
## Features:
##   {sex, age, year, thickness, ulcer}</code></pre>
<p>Using the same Melanoma dataset, we illustrate <em>DeepHit</em>.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="machine-learning.html#cb216-1" tabindex="-1"></a>DH<span class="ot">&lt;-</span><span class="fu">deephit</span>(<span class="at">data =</span> Melanoma, </span>
<span id="cb216-2"><a href="machine-learning.html#cb216-2" tabindex="-1"></a>    <span class="at">frac =</span> <span class="fl">0.3</span>, <span class="co">#Fraction of data to use for validation </span></span>
<span id="cb216-3"><a href="machine-learning.html#cb216-3" tabindex="-1"></a>    <span class="at">activation =</span> <span class="st">&quot;relu&quot;</span>,</span>
<span id="cb216-4"><a href="machine-learning.html#cb216-4" tabindex="-1"></a>    <span class="at">num_nodes =</span> <span class="fu">c</span>(4L, 8L, 4L, 2L), </span>
<span id="cb216-5"><a href="machine-learning.html#cb216-5" tabindex="-1"></a>    <span class="at">dropout =</span> <span class="fl">0.1</span>, </span>
<span id="cb216-6"><a href="machine-learning.html#cb216-6" tabindex="-1"></a>    <span class="at">early_stopping =</span> <span class="cn">TRUE</span>, </span>
<span id="cb216-7"><a href="machine-learning.html#cb216-7" tabindex="-1"></a>    <span class="at">epochs =</span> 100L, <span class="co">#number of epochs.</span></span>
<span id="cb216-8"><a href="machine-learning.html#cb216-8" tabindex="-1"></a>    <span class="at">batch_size =</span> 32L)</span>
<span id="cb216-9"><a href="machine-learning.html#cb216-9" tabindex="-1"></a></span>
<span id="cb216-10"><a href="machine-learning.html#cb216-10" tabindex="-1"></a><span class="fu">summary</span>(DH)</span></code></pre></div>
<pre><code>## 
##  DeepHit Neural Network 
## 
## Call:
##   deephit(data = Melanoma, frac = 0.3, activation = &quot;relu&quot;, num_nodes = c(4L,      8L, 4L, 2L), dropout = 0.1, early_stopping = TRUE, batch_size = 32L,      epochs = 100L)
## 
## Response:
##   Surv(time, status)
## Features:
##   {sex, age, year, thickness, ulcer}</code></pre>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="machine-learning.html#cb218-1" tabindex="-1"></a><span class="fu">library</span>(mlr3)</span></code></pre></div>
<pre><code>## Warning: package &#39;mlr3&#39; was built under R version 4.3.2</code></pre>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="machine-learning.html#cb220-1" tabindex="-1"></a><span class="fu">library</span>(mlr3proba)</span></code></pre></div>
<pre><code>## Warning: package &#39;mlr3proba&#39; was built under R version 4.3.2</code></pre>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="machine-learning.html#cb222-1" tabindex="-1"></a><span class="fu">library</span>(mlr3extralearners)</span>
<span id="cb222-2"><a href="machine-learning.html#cb222-2" tabindex="-1"></a><span class="fu">library</span>(mlr3pipelines)</span></code></pre></div>
<pre><code>## Warning: package &#39;mlr3pipelines&#39; was built under R version 4.3.2</code></pre>
<pre><code>## 
## Attaching package: &#39;mlr3pipelines&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:BiocGenerics&#39;:
## 
##     pos</code></pre>
<pre><code>## The following object is masked from &#39;package:bitops&#39;:
## 
##     %&gt;&gt;%</code></pre>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="machine-learning.html#cb227-1" tabindex="-1"></a><span class="fu">library</span>(mlr3tuning)</span></code></pre></div>
<pre><code>## Warning: package &#39;mlr3tuning&#39; was built under R version 4.3.2</code></pre>
<pre><code>## Loading required package: paradox</code></pre>
<pre><code>## 
## Attaching package: &#39;mlr3tuning&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:multiplex&#39;:
## 
##     ti</code></pre>
<pre><code>## The following object is masked from &#39;package:e1071&#39;:
## 
##     tune</code></pre>
<pre><code>## The following object is masked from &#39;package:randomForestSRC&#39;:
## 
##     tune</code></pre>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="machine-learning.html#cb234-1" tabindex="-1"></a><span class="do">## get the `whas` task from mlr3proba</span></span>
<span id="cb234-2"><a href="machine-learning.html#cb234-2" tabindex="-1"></a>whas <span class="ot">&lt;-</span> <span class="fu">tsk</span>(<span class="st">&quot;whas&quot;</span>)</span>
<span id="cb234-3"><a href="machine-learning.html#cb234-3" tabindex="-1"></a></span>
<span id="cb234-4"><a href="machine-learning.html#cb234-4" tabindex="-1"></a><span class="do">## create our own task from the Melanoma dataset</span></span>
<span id="cb234-5"><a href="machine-learning.html#cb234-5" tabindex="-1"></a>Melanoma_data <span class="ot">&lt;-</span> MASS<span class="sc">::</span>Melanoma</span>
<span id="cb234-6"><a href="machine-learning.html#cb234-6" tabindex="-1"></a></span>
<span id="cb234-7"><a href="machine-learning.html#cb234-7" tabindex="-1"></a>Melanoma_data<span class="sc">$</span>status<span class="ot">=</span><span class="fu">ifelse</span>(Melanoma_data<span class="sc">$</span>status<span class="sc">==</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb234-8"><a href="machine-learning.html#cb234-8" tabindex="-1"></a></span>
<span id="cb234-9"><a href="machine-learning.html#cb234-9" tabindex="-1"></a><span class="do">## convert characters to factors</span></span>
<span id="cb234-10"><a href="machine-learning.html#cb234-10" tabindex="-1"></a>Melanoma_data<span class="sc">$</span>sex <span class="ot">&lt;-</span> <span class="fu">factor</span>(Melanoma_data<span class="sc">$</span>sex)</span>
<span id="cb234-11"><a href="machine-learning.html#cb234-11" tabindex="-1"></a>MelanomaTS <span class="ot">&lt;-</span> TaskSurv<span class="sc">$</span><span class="fu">new</span>(<span class="st">&quot;Melanoma&quot;</span>, Melanoma_data, <span class="at">time =</span> <span class="st">&quot;time&quot;</span>, <span class="at">event =</span> <span class="st">&quot;status&quot;</span>)</span>
<span id="cb234-12"><a href="machine-learning.html#cb234-12" tabindex="-1"></a></span>
<span id="cb234-13"><a href="machine-learning.html#cb234-13" tabindex="-1"></a></span>
<span id="cb234-14"><a href="machine-learning.html#cb234-14" tabindex="-1"></a><span class="co">#1 died from melanoma, 2 alive, 3 dead from other causes.</span></span>
<span id="cb234-15"><a href="machine-learning.html#cb234-15" tabindex="-1"></a><span class="do">##delta: 0=censored, 1=dead</span></span>
<span id="cb234-16"><a href="machine-learning.html#cb234-16" tabindex="-1"></a>delta<span class="ot">=</span><span class="fu">ifelse</span>(Melanoma_data<span class="sc">$</span>status<span class="sc">==</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb234-17"><a href="machine-learning.html#cb234-17" tabindex="-1"></a></span>
<span id="cb234-18"><a href="machine-learning.html#cb234-18" tabindex="-1"></a><span class="do">## matrix of observed covariates</span></span>
<span id="cb234-19"><a href="machine-learning.html#cb234-19" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Melanoma_data<span class="sc">$</span>sex, Melanoma_data<span class="sc">$</span>age, Melanoma_data<span class="sc">$</span>thickness)</span>
<span id="cb234-20"><a href="machine-learning.html#cb234-20" tabindex="-1"></a></span>
<span id="cb234-21"><a href="machine-learning.html#cb234-21" tabindex="-1"></a></span>
<span id="cb234-22"><a href="machine-learning.html#cb234-22" tabindex="-1"></a><span class="do">## combine in list</span></span>
<span id="cb234-23"><a href="machine-learning.html#cb234-23" tabindex="-1"></a>tasks <span class="ot">&lt;-</span> <span class="fu">list</span>(whas, MelanomaTS)</span>
<span id="cb234-24"><a href="machine-learning.html#cb234-24" tabindex="-1"></a></span>
<span id="cb234-25"><a href="machine-learning.html#cb234-25" tabindex="-1"></a><span class="fu">library</span>(paradox)</span>
<span id="cb234-26"><a href="machine-learning.html#cb234-26" tabindex="-1"></a></span>
<span id="cb234-27"><a href="machine-learning.html#cb234-27" tabindex="-1"></a>search_space <span class="ot">&lt;-</span> <span class="fu">ps</span>(</span>
<span id="cb234-28"><a href="machine-learning.html#cb234-28" tabindex="-1"></a> <span class="do">## p_dbl for numeric valued parameters</span></span>
<span id="cb234-29"><a href="machine-learning.html#cb234-29" tabindex="-1"></a> <span class="at">dropout =</span> <span class="fu">p_dbl</span>(<span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> <span class="dv">1</span>),</span>
<span id="cb234-30"><a href="machine-learning.html#cb234-30" tabindex="-1"></a> <span class="at">weight_decay =</span> <span class="fu">p_dbl</span>(<span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> <span class="fl">0.5</span>),</span>
<span id="cb234-31"><a href="machine-learning.html#cb234-31" tabindex="-1"></a> <span class="at">learning_rate =</span> <span class="fu">p_dbl</span>(<span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> <span class="dv">1</span>),</span>
<span id="cb234-32"><a href="machine-learning.html#cb234-32" tabindex="-1"></a> </span>
<span id="cb234-33"><a href="machine-learning.html#cb234-33" tabindex="-1"></a> <span class="do">## p_int for integer valued parameters</span></span>
<span id="cb234-34"><a href="machine-learning.html#cb234-34" tabindex="-1"></a> <span class="at">nodes =</span> <span class="fu">p_int</span>(<span class="at">lower =</span> <span class="dv">1</span>, <span class="at">upper =</span> <span class="dv">32</span>),</span>
<span id="cb234-35"><a href="machine-learning.html#cb234-35" tabindex="-1"></a> <span class="at">k =</span> <span class="fu">p_int</span>(<span class="at">lower =</span> <span class="dv">1</span>, <span class="at">upper =</span> <span class="dv">4</span>)</span>
<span id="cb234-36"><a href="machine-learning.html#cb234-36" tabindex="-1"></a>)</span>
<span id="cb234-37"><a href="machine-learning.html#cb234-37" tabindex="-1"></a></span>
<span id="cb234-38"><a href="machine-learning.html#cb234-38" tabindex="-1"></a>search_space<span class="sc">$</span>trafo <span class="ot">&lt;-</span> <span class="cf">function</span>(x, param_set) {</span>
<span id="cb234-39"><a href="machine-learning.html#cb234-39" tabindex="-1"></a> x<span class="sc">$</span>num_nodes <span class="ot">=</span> <span class="fu">rep</span>(x<span class="sc">$</span>nodes, x<span class="sc">$</span>k)</span>
<span id="cb234-40"><a href="machine-learning.html#cb234-40" tabindex="-1"></a> x<span class="sc">$</span>nodes <span class="ot">=</span> x<span class="sc">$</span>k <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb234-41"><a href="machine-learning.html#cb234-41" tabindex="-1"></a> <span class="fu">return</span>(x)</span>
<span id="cb234-42"><a href="machine-learning.html#cb234-42" tabindex="-1"></a>}</span>
<span id="cb234-43"><a href="machine-learning.html#cb234-43" tabindex="-1"></a></span>
<span id="cb234-44"><a href="machine-learning.html#cb234-44" tabindex="-1"></a></span>
<span id="cb234-45"><a href="machine-learning.html#cb234-45" tabindex="-1"></a>create_autotuner <span class="ot">&lt;-</span> <span class="cf">function</span>(learner) {</span>
<span id="cb234-46"><a href="machine-learning.html#cb234-46" tabindex="-1"></a> AutoTuner<span class="sc">$</span><span class="fu">new</span>(</span>
<span id="cb234-47"><a href="machine-learning.html#cb234-47" tabindex="-1"></a>   <span class="at">learner =</span> learner,</span>
<span id="cb234-48"><a href="machine-learning.html#cb234-48" tabindex="-1"></a>   <span class="at">search_space =</span> search_space,</span>
<span id="cb234-49"><a href="machine-learning.html#cb234-49" tabindex="-1"></a>   <span class="at">resampling =</span> <span class="fu">rsmp</span>(<span class="st">&quot;holdout&quot;</span>),</span>
<span id="cb234-50"><a href="machine-learning.html#cb234-50" tabindex="-1"></a>   <span class="at">measure =</span> <span class="fu">msr</span>(<span class="st">&quot;surv.cindex&quot;</span>),</span>
<span id="cb234-51"><a href="machine-learning.html#cb234-51" tabindex="-1"></a>   <span class="at">terminator =</span> <span class="fu">trm</span>(<span class="st">&quot;evals&quot;</span>, <span class="at">n_evals =</span> <span class="dv">2</span>),</span>
<span id="cb234-52"><a href="machine-learning.html#cb234-52" tabindex="-1"></a>   <span class="at">tuner =</span> <span class="fu">tnr</span>(<span class="st">&quot;random_search&quot;</span>)</span>
<span id="cb234-53"><a href="machine-learning.html#cb234-53" tabindex="-1"></a> )</span>
<span id="cb234-54"><a href="machine-learning.html#cb234-54" tabindex="-1"></a>}</span>
<span id="cb234-55"><a href="machine-learning.html#cb234-55" tabindex="-1"></a></span>
<span id="cb234-56"><a href="machine-learning.html#cb234-56" tabindex="-1"></a><span class="do">## load learners</span></span>
<span id="cb234-57"><a href="machine-learning.html#cb234-57" tabindex="-1"></a>learners <span class="ot">&lt;-</span> <span class="fu">lrns</span>(</span>
<span id="cb234-58"><a href="machine-learning.html#cb234-58" tabindex="-1"></a> <span class="co">#paste0(&quot;surv.&quot;, c(&quot;deephit&quot;, &quot;deepsurv&quot;)), #crash when running multiple learners</span></span>
<span id="cb234-59"><a href="machine-learning.html#cb234-59" tabindex="-1"></a> <span class="fu">paste0</span>(<span class="st">&quot;surv.&quot;</span>, <span class="fu">c</span>( <span class="st">&quot;deepsurv&quot;</span>)),</span>
<span id="cb234-60"><a href="machine-learning.html#cb234-60" tabindex="-1"></a> <span class="at">frac =</span> <span class="fl">0.3</span>, <span class="at">early_stopping =</span> <span class="cn">TRUE</span>, <span class="at">epochs =</span> <span class="dv">10</span>, <span class="at">optimizer =</span> <span class="st">&quot;adam&quot;</span></span>
<span id="cb234-61"><a href="machine-learning.html#cb234-61" tabindex="-1"></a>)</span>
<span id="cb234-62"><a href="machine-learning.html#cb234-62" tabindex="-1"></a> </span>
<span id="cb234-63"><a href="machine-learning.html#cb234-63" tabindex="-1"></a><span class="co"># apply our function</span></span>
<span id="cb234-64"><a href="machine-learning.html#cb234-64" tabindex="-1"></a>learners <span class="ot">&lt;-</span> <span class="fu">lapply</span>(learners, create_autotuner)</span>
<span id="cb234-65"><a href="machine-learning.html#cb234-65" tabindex="-1"></a></span>
<span id="cb234-66"><a href="machine-learning.html#cb234-66" tabindex="-1"></a></span>
<span id="cb234-67"><a href="machine-learning.html#cb234-67" tabindex="-1"></a>create_pipeops <span class="ot">&lt;-</span> <span class="cf">function</span>(learner) {</span>
<span id="cb234-68"><a href="machine-learning.html#cb234-68" tabindex="-1"></a> <span class="fu">po</span>(<span class="st">&quot;encode&quot;</span>) <span class="sc">%&gt;&gt;%</span> <span class="fu">po</span>(<span class="st">&quot;scale&quot;</span>) <span class="sc">%&gt;&gt;%</span> <span class="fu">po</span>(<span class="st">&quot;learner&quot;</span>, learner)</span>
<span id="cb234-69"><a href="machine-learning.html#cb234-69" tabindex="-1"></a>}</span>
<span id="cb234-70"><a href="machine-learning.html#cb234-70" tabindex="-1"></a></span>
<span id="cb234-71"><a href="machine-learning.html#cb234-71" tabindex="-1"></a><span class="do">## apply our function</span></span>
<span id="cb234-72"><a href="machine-learning.html#cb234-72" tabindex="-1"></a>learners <span class="ot">&lt;-</span> <span class="fu">lapply</span>(learners, create_pipeops)</span>
<span id="cb234-73"><a href="machine-learning.html#cb234-73" tabindex="-1"></a></span>
<span id="cb234-74"><a href="machine-learning.html#cb234-74" tabindex="-1"></a><span class="do">## select holdout as the resampling strategy</span></span>
<span id="cb234-75"><a href="machine-learning.html#cb234-75" tabindex="-1"></a>resampling <span class="ot">&lt;-</span> <span class="fu">rsmp</span>(<span class="st">&quot;cv&quot;</span>, <span class="at">folds =</span> <span class="dv">2</span>)</span>
<span id="cb234-76"><a href="machine-learning.html#cb234-76" tabindex="-1"></a></span>
<span id="cb234-77"><a href="machine-learning.html#cb234-77" tabindex="-1"></a><span class="do">## add KM and CPH</span></span>
<span id="cb234-78"><a href="machine-learning.html#cb234-78" tabindex="-1"></a>learners <span class="ot">&lt;-</span> <span class="fu">c</span>(learners, <span class="fu">lrns</span>(<span class="fu">c</span>(<span class="st">&quot;surv.kaplan&quot;</span>, <span class="st">&quot;surv.coxph&quot;</span>)))</span>
<span id="cb234-79"><a href="machine-learning.html#cb234-79" tabindex="-1"></a><span class="co">#learners &lt;- c(learners, lrns(c(&quot;surv.coxph&quot;)))</span></span>
<span id="cb234-80"><a href="machine-learning.html#cb234-80" tabindex="-1"></a>design <span class="ot">&lt;-</span> <span class="fu">benchmark_grid</span>(tasks, learners, resampling)</span>
<span id="cb234-81"><a href="machine-learning.html#cb234-81" tabindex="-1"></a>bm <span class="ot">&lt;-</span> <span class="fu">benchmark</span>(design)</span></code></pre></div>
<pre><code>## INFO  [10:11:24.232] [mlr3] Running benchmark with 12 resampling iterations
## INFO  [10:11:24.393] [mlr3] Applying learner &#39;encode.scale.surv.deepsurv.tuned&#39; on task &#39;whas&#39; (iter 1/2)
## INFO  [10:11:24.997] [bbotk] Starting to optimize 5 parameter(s) with &#39;&lt;OptimizerRandomSearch&gt;&#39; and &#39;&lt;TerminatorEvals&gt; [n_evals=2, k=0]&#39;
## INFO  [10:11:25.078] [bbotk] Evaluating 1 configuration(s)
## INFO  [10:11:25.120] [mlr3] Running benchmark with 1 resampling iterations
## INFO  [10:11:25.139] [mlr3] Applying learner &#39;surv.deepsurv&#39; on task &#39;whas&#39; (iter 1/1)
## INFO  [10:11:25.408] [mlr3] Finished benchmark
## INFO  [10:11:25.495] [bbotk] Result of batch 1:
## INFO  [10:11:25.500] [bbotk]    dropout weight_decay learning_rate nodes k surv.cindex warnings errors
## INFO  [10:11:25.500] [bbotk]  0.6247406    0.4554209     0.8456182    11 3   0.5219491        0      0
## INFO  [10:11:25.500] [bbotk]  runtime_learners                                uhash
## INFO  [10:11:25.500] [bbotk]              0.23 c8398de8-088c-479d-a935-b1acb46e5ccf
## INFO  [10:11:25.515] [bbotk] Evaluating 1 configuration(s)
## INFO  [10:11:25.563] [mlr3] Running benchmark with 1 resampling iterations
## INFO  [10:11:25.582] [mlr3] Applying learner &#39;surv.deepsurv&#39; on task &#39;whas&#39; (iter 1/1)
## INFO  [10:11:25.818] [mlr3] Finished benchmark
## INFO  [10:11:25.916] [bbotk] Result of batch 2:
## INFO  [10:11:25.921] [bbotk]    dropout weight_decay learning_rate nodes k surv.cindex warnings errors
## INFO  [10:11:25.921] [bbotk]  0.1573471    0.4268247     0.6872897    27 1   0.4903424        0      0
## INFO  [10:11:25.921] [bbotk]  runtime_learners                                uhash
## INFO  [10:11:25.921] [bbotk]               0.2 0e93742e-a79e-42ab-a3b6-ff559c0b2b6f
## INFO  [10:11:25.954] [bbotk] Finished optimizing after 2 evaluation(s)
## INFO  [10:11:25.956] [bbotk] Result:
## INFO  [10:11:25.960] [bbotk]    dropout weight_decay learning_rate nodes k learner_param_vals  x_domain
## INFO  [10:11:25.960] [bbotk]  0.6247406    0.4554209     0.8456182    11 3          &lt;list[8]&gt; &lt;list[4]&gt;
## INFO  [10:11:25.960] [bbotk]  surv.cindex
## INFO  [10:11:25.960] [bbotk]    0.5219491
## INFO  [10:11:27.179] [mlr3] Applying learner &#39;encode.scale.surv.deepsurv.tuned&#39; on task &#39;whas&#39; (iter 2/2)
## INFO  [10:11:27.573] [bbotk] Starting to optimize 5 parameter(s) with &#39;&lt;OptimizerRandomSearch&gt;&#39; and &#39;&lt;TerminatorEvals&gt; [n_evals=2, k=0]&#39;
## INFO  [10:11:27.638] [bbotk] Evaluating 1 configuration(s)
## INFO  [10:11:27.679] [mlr3] Running benchmark with 1 resampling iterations
## INFO  [10:11:27.697] [mlr3] Applying learner &#39;surv.deepsurv&#39; on task &#39;whas&#39; (iter 1/1)
## INFO  [10:11:27.937] [mlr3] Finished benchmark
## INFO  [10:11:28.022] [bbotk] Result of batch 1:
## INFO  [10:11:28.027] [bbotk]    dropout weight_decay learning_rate nodes k surv.cindex warnings errors
## INFO  [10:11:28.027] [bbotk]  0.9949267    0.2285935     0.8684118    17 4   0.4422026        0      0
## INFO  [10:11:28.027] [bbotk]  runtime_learners                                uhash
## INFO  [10:11:28.027] [bbotk]              0.22 70883535-e5ba-417b-8471-826e5612661e
## INFO  [10:11:28.046] [bbotk] Evaluating 1 configuration(s)
## INFO  [10:11:28.086] [mlr3] Running benchmark with 1 resampling iterations
## INFO  [10:11:28.111] [mlr3] Applying learner &#39;surv.deepsurv&#39; on task &#39;whas&#39; (iter 1/1)
## INFO  [10:11:28.373] [mlr3] Finished benchmark
## INFO  [10:11:28.636] [bbotk] Result of batch 2:
## INFO  [10:11:28.640] [bbotk]    dropout weight_decay learning_rate nodes k surv.cindex warnings errors
## INFO  [10:11:28.640] [bbotk]  0.8363856    0.2299571     0.9908099    13 2   0.3472047        0      0
## INFO  [10:11:28.640] [bbotk]  runtime_learners                                uhash
## INFO  [10:11:28.640] [bbotk]              0.25 e641b7a3-3096-4c7d-80fb-728c483517ff
## INFO  [10:11:28.675] [bbotk] Finished optimizing after 2 evaluation(s)
## INFO  [10:11:28.678] [bbotk] Result:
## INFO  [10:11:28.681] [bbotk]    dropout weight_decay learning_rate nodes k learner_param_vals  x_domain
## INFO  [10:11:28.681] [bbotk]  0.9949267    0.2285935     0.8684118    17 4          &lt;list[8]&gt; &lt;list[4]&gt;
## INFO  [10:11:28.681] [bbotk]  surv.cindex
## INFO  [10:11:28.681] [bbotk]    0.4422026
## INFO  [10:11:29.349] [mlr3] Applying learner &#39;surv.kaplan&#39; on task &#39;whas&#39; (iter 1/2)
## INFO  [10:11:29.419] [mlr3] Applying learner &#39;surv.kaplan&#39; on task &#39;whas&#39; (iter 2/2)
## INFO  [10:11:29.489] [mlr3] Applying learner &#39;surv.coxph&#39; on task &#39;whas&#39; (iter 1/2)
## INFO  [10:11:29.605] [mlr3] Applying learner &#39;surv.coxph&#39; on task &#39;whas&#39; (iter 2/2)
## INFO  [10:11:29.707] [mlr3] Applying learner &#39;encode.scale.surv.deepsurv.tuned&#39; on task &#39;Melanoma&#39; (iter 1/2)
## INFO  [10:11:30.239] [bbotk] Starting to optimize 5 parameter(s) with &#39;&lt;OptimizerRandomSearch&gt;&#39; and &#39;&lt;TerminatorEvals&gt; [n_evals=2, k=0]&#39;
## INFO  [10:11:30.313] [bbotk] Evaluating 1 configuration(s)
## INFO  [10:11:30.350] [mlr3] Running benchmark with 1 resampling iterations
## INFO  [10:11:30.369] [mlr3] Applying learner &#39;surv.deepsurv&#39; on task &#39;Melanoma&#39; (iter 1/1)
## INFO  [10:11:30.584] [mlr3] Finished benchmark
## INFO  [10:11:30.678] [bbotk] Result of batch 1:
## INFO  [10:11:30.683] [bbotk]    dropout weight_decay learning_rate nodes k surv.cindex warnings errors
## INFO  [10:11:30.683] [bbotk]  0.4570555    0.2741379     0.8601232    20 1   0.3555556        0      0
## INFO  [10:11:30.683] [bbotk]  runtime_learners                                uhash
## INFO  [10:11:30.683] [bbotk]              0.19 18149d55-7443-4481-8ec4-1c38131bbccd
## INFO  [10:11:30.701] [bbotk] Evaluating 1 configuration(s)
## INFO  [10:11:30.738] [mlr3] Running benchmark with 1 resampling iterations
## INFO  [10:11:30.763] [mlr3] Applying learner &#39;surv.deepsurv&#39; on task &#39;Melanoma&#39; (iter 1/1)
## INFO  [10:11:30.968] [mlr3] Finished benchmark
## INFO  [10:11:31.074] [bbotk] Result of batch 2:
## INFO  [10:11:31.079] [bbotk]    dropout weight_decay learning_rate nodes k surv.cindex warnings errors
## INFO  [10:11:31.079] [bbotk]  0.7608218     0.479834     0.7939875    20 3   0.6703704        0      0
## INFO  [10:11:31.079] [bbotk]  runtime_learners                                uhash
## INFO  [10:11:31.079] [bbotk]              0.17 43442330-56ee-4f93-b67a-1c048d6ed68b
## INFO  [10:11:31.106] [bbotk] Finished optimizing after 2 evaluation(s)
## INFO  [10:11:31.108] [bbotk] Result:
## INFO  [10:11:31.112] [bbotk]    dropout weight_decay learning_rate nodes k learner_param_vals  x_domain
## INFO  [10:11:31.112] [bbotk]  0.7608218     0.479834     0.7939875    20 3          &lt;list[8]&gt; &lt;list[4]&gt;
## INFO  [10:11:31.112] [bbotk]  surv.cindex
## INFO  [10:11:31.112] [bbotk]    0.6703704
## INFO  [10:11:31.711] [mlr3] Applying learner &#39;encode.scale.surv.deepsurv.tuned&#39; on task &#39;Melanoma&#39; (iter 2/2)
## INFO  [10:11:32.305] [bbotk] Starting to optimize 5 parameter(s) with &#39;&lt;OptimizerRandomSearch&gt;&#39; and &#39;&lt;TerminatorEvals&gt; [n_evals=2, k=0]&#39;
## INFO  [10:11:32.380] [bbotk] Evaluating 1 configuration(s)
## INFO  [10:11:32.426] [mlr3] Running benchmark with 1 resampling iterations
## INFO  [10:11:32.444] [mlr3] Applying learner &#39;surv.deepsurv&#39; on task &#39;Melanoma&#39; (iter 1/1)
## INFO  [10:11:32.665] [mlr3] Finished benchmark
## INFO  [10:11:32.748] [bbotk] Result of batch 1:
## INFO  [10:11:32.753] [bbotk]    dropout weight_decay learning_rate nodes k surv.cindex warnings errors
## INFO  [10:11:32.753] [bbotk]  0.1140623    0.2846605       0.22349    10 4   0.4483871        0      0
## INFO  [10:11:32.753] [bbotk]  runtime_learners                                uhash
## INFO  [10:11:32.753] [bbotk]               0.2 a6bb33ca-ee0f-474d-95b0-e9b78a60f786
## INFO  [10:11:32.778] [bbotk] Evaluating 1 configuration(s)
## INFO  [10:11:32.821] [mlr3] Running benchmark with 1 resampling iterations
## INFO  [10:11:32.841] [mlr3] Applying learner &#39;surv.deepsurv&#39; on task &#39;Melanoma&#39; (iter 1/1)
## INFO  [10:11:33.057] [mlr3] Finished benchmark
## INFO  [10:11:33.148] [bbotk] Result of batch 2:
## INFO  [10:11:33.154] [bbotk]    dropout weight_decay learning_rate nodes k surv.cindex warnings errors
## INFO  [10:11:33.154] [bbotk]  0.2337101    0.3132217     0.5829765     8 3   0.5096774        0      0
## INFO  [10:11:33.154] [bbotk]  runtime_learners                                uhash
## INFO  [10:11:33.154] [bbotk]               0.2 f9a240c9-5ca4-48f9-b561-4b1326583436
## INFO  [10:11:33.181] [bbotk] Finished optimizing after 2 evaluation(s)
## INFO  [10:11:33.183] [bbotk] Result:
## INFO  [10:11:33.186] [bbotk]    dropout weight_decay learning_rate nodes k learner_param_vals  x_domain
## INFO  [10:11:33.186] [bbotk]  0.2337101    0.3132217     0.5829765     8 3          &lt;list[8]&gt; &lt;list[4]&gt;
## INFO  [10:11:33.186] [bbotk]  surv.cindex
## INFO  [10:11:33.186] [bbotk]    0.5096774
## INFO  [10:11:33.924] [mlr3] Applying learner &#39;surv.kaplan&#39; on task &#39;Melanoma&#39; (iter 1/2)
## INFO  [10:11:33.982] [mlr3] Applying learner &#39;surv.kaplan&#39; on task &#39;Melanoma&#39; (iter 2/2)
## INFO  [10:11:34.036] [mlr3] Applying learner &#39;surv.coxph&#39; on task &#39;Melanoma&#39; (iter 1/2)
## INFO  [10:11:34.107] [mlr3] Applying learner &#39;surv.coxph&#39; on task &#39;Melanoma&#39; (iter 2/2)
## INFO  [10:11:34.178] [mlr3] Finished benchmark</code></pre>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="machine-learning.html#cb236-1" tabindex="-1"></a><span class="do">## Aggreggate with Harrell&#39;s C and Integrated Graf Score</span></span>
<span id="cb236-2"><a href="machine-learning.html#cb236-2" tabindex="-1"></a>msrs <span class="ot">&lt;-</span> <span class="fu">msrs</span>(<span class="fu">c</span>(<span class="st">&quot;surv.cindex&quot;</span>, <span class="st">&quot;surv.graf&quot;</span>))</span>
<span id="cb236-3"><a href="machine-learning.html#cb236-3" tabindex="-1"></a>bm<span class="sc">$</span><span class="fu">aggregate</span>(msrs)[, <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">8</span>)]</span></code></pre></div>
<pre><code>##     task_id                       learner_id surv.cindex surv.graf
## 1:     whas encode.scale.surv.deepsurv.tuned   0.4897944       Inf
## 2:     whas                      surv.kaplan   0.5000000       Inf
## 3:     whas                       surv.coxph   0.7502472       Inf
## 4: Melanoma encode.scale.surv.deepsurv.tuned   0.7033658       Inf
## 5: Melanoma                      surv.kaplan   0.5000000       Inf
## 6: Melanoma                       surv.coxph   0.7383489       Inf</code></pre>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="machine-learning.html#cb238-1" tabindex="-1"></a><span class="fu">library</span>(mlr3benchmark)</span></code></pre></div>
<pre><code>## Warning: package &#39;mlr3benchmark&#39; was built under R version 4.3.2</code></pre>
<pre><code>## 
## Attaching package: &#39;mlr3benchmark&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:survivalmodels&#39;:
## 
##     requireNamespaces</code></pre>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="machine-learning.html#cb242-1" tabindex="-1"></a><span class="do">## create mlr3benchmark object</span></span>
<span id="cb242-2"><a href="machine-learning.html#cb242-2" tabindex="-1"></a>bma <span class="ot">&lt;-</span> <span class="fu">as.BenchmarkAggr</span>(bm)</span></code></pre></div>
<pre><code>## Warning: &#39;as.BenchmarkAggr&#39; is deprecated.
## Use &#39;as_benchmark_aggr&#39; instead.
## See help(&quot;Deprecated&quot;)</code></pre>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="machine-learning.html#cb244-1" tabindex="-1"></a><span class="do">## run global Friedman test</span></span>
<span id="cb244-2"><a href="machine-learning.html#cb244-2" tabindex="-1"></a>bma<span class="sc">$</span><span class="fu">friedman_test</span>()</span></code></pre></div>
<pre><code>## 
##  Friedman rank sum test
## 
## data:  cindex and learner_id and task_id
## Friedman chi-squared = 3, df = 2, p-value = 0.2231</code></pre>
</div>
</div>
<div id="tabnet" class="section level3 hasAnchor" number="6.9.2">
<h3><span class="header-section-number">6.9.2</span> Tabnet<a href="machine-learning.html#tabnet" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="cnn" class="section level3 hasAnchor" number="6.9.3">
<h3><span class="header-section-number">6.9.3</span> CNN<a href="machine-learning.html#cnn" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Convolution neural network or CNN is an artifical neural network method that is well suited to classification of image data. CNN is able to develop an internal representation of the image.</p>
</div>
<div id="rnn" class="section level3 hasAnchor" number="6.9.4">
<h3><span class="header-section-number">6.9.4</span> RNN<a href="machine-learning.html#rnn" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Recurrent neural network or RNN is an artifical neural network method that is
well suited to data with repeated patterns such as natural language processing. However, this architecture is less suited for tabular or imaging data.</p>
</div>
<div id="reinforcement-learning" class="section level3 hasAnchor" number="6.9.5">
<h3><span class="header-section-number">6.9.5</span> Reinforcement learning<a href="machine-learning.html#reinforcement-learning" class="anchor-section" aria-label="Anchor link to header"></a></h3>

</div>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-10.21105/joss.00786" class="csl-entry">
Molnar, Christoph, Bernd Bischl, and Giuseppe Casalicchio. 2018. <span>Iml: An r Package for Interpretable Machine Learning.</span> <em>JOSS</em> 3 (26): 786. <a href="https://doi.org/10.21105/joss.00786">https://doi.org/10.21105/joss.00786</a>.
</div>
<div id="ref-pmid29559951" class="csl-entry">
Phan, T. G., J. Chen, S. Singhal, H. Ma, B. B. Clissold, J. Ly, and R. Beare. 2018. <span><span class="nocase"><span>E</span>xploratory <span>U</span>se of <span>D</span>ecision <span>T</span>ree <span>A</span>nalysis in <span>C</span>lassification of <span>O</span>utcome in <span>H</span>ypoxic-<span>I</span>schemic <span>B</span>rain <span>I</span>njury</span>.</span> <em>Front Neurol</em> 9: 126.
</div>
<div id="ref-pmid30761063" class="csl-entry">
Phan, T. G., T. Kooblal, C. Matley, S. Singhal, B. Clissold, J. Ly, A. G. Thrift, V. Srikanth, and H. Ma. 2019. <span><span class="nocase"><span>S</span>troke <span>S</span>everity <span>V</span>ersus <span>D</span>ysphagia <span>S</span>creen as <span>D</span>river for <span>P</span>ost-stroke <span>P</span>neumonia</span>.</span> <em>Front Neurol</em> 10: 16.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multivariate-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="machine-learning-part-2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/05-machinelearning.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Applications-of-R-in-Healthcare.pdf", "Applications-of-R-in-Healthcare.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
