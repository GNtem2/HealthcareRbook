<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Machine learning | Applications of R in Healthcare</title>
  <meta name="description" content="This is a book describing the use of R in Healthcare. It is aimed at beginners of R language. The majority of the examples are taken from works in Neurology. Where possible data from other disease such as heart disease, cancer and vaccine are used. The ideas and principles can be applied to other aspects of Healthcare. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Machine learning | Applications of R in Healthcare" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a book describing the use of R in Healthcare. It is aimed at beginners of R language. The majority of the examples are taken from works in Neurology. Where possible data from other disease such as heart disease, cancer and vaccine are used. The ideas and principles can be applied to other aspects of Healthcare. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="GNtem2/HealthcareRbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Machine learning | Applications of R in Healthcare" />
  
  <meta name="twitter:description" content="This is a book describing the use of R in Healthcare. It is aimed at beginners of R language. The majority of the examples are taken from works in Neurology. Where possible data from other disease such as heart disease, cancer and vaccine are used. The ideas and principles can be applied to other aspects of Healthcare. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Thanh Phan" />


<meta name="date" content="2024-02-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multivariate-analysis.html"/>
<link rel="next" href="machine-learning-part-2.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.2/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.2/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.2/leaflet-providers-plugin.js"></script>
<link href="libs/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="libs/HomeButton-0.0.1/home-button.js"></script>
<script src="libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.10/grViz.js"></script>
<script src="libs/d3-3.3.8/d3.min.js"></script>
<script src="libs/dagre-0.4.0/dagre-d3.min.js"></script>
<link href="libs/mermaid-0.3.0/dist/mermaid.css" rel="stylesheet" />
<script src="libs/mermaid-0.3.0/dist/mermaid.slim.min.js"></script>
<script src="libs/chromatography-0.1/chromatography.js"></script>
<script src="libs/DiagrammeR-binding-1.0.10/DiagrammeR.js"></script>
<link href="libs/vis-9.1.0/vis-network.min.css" rel="stylesheet" />
<script src="libs/vis-9.1.0/vis-network.min.js"></script>
<script src="libs/visNetwork-binding-2.1.2/visNetwork.js"></script>
<link href="libs/leaflet-awesomemarkers-2.0.3/leaflet.awesome-markers.css" rel="stylesheet" />
<script src="libs/leaflet-awesomemarkers-2.0.3/leaflet.awesome-markers.min.js"></script>
<link href="libs/ionicons-2.0.1/ionicons.min.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applications-of-R-in-Healthcare</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preamble</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#plot-using-base-r"><i class="fa fa-check"></i><b>2.1</b> Plot using base R</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#ggplot2"><i class="fa fa-check"></i><b>2.2</b> ggplot2</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#histogram"><i class="fa fa-check"></i><b>2.2.1</b> Histogram</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#bar-plot"><i class="fa fa-check"></i><b>2.2.2</b> Bar plot</a></li>
<li class="chapter" data-level="2.2.3" data-path="intro.html"><a href="intro.html#pie-chart"><i class="fa fa-check"></i><b>2.2.3</b> Pie chart</a></li>
<li class="chapter" data-level="2.2.4" data-path="intro.html"><a href="intro.html#scatter-plot"><i class="fa fa-check"></i><b>2.2.4</b> Scatter plot</a></li>
<li class="chapter" data-level="2.2.5" data-path="intro.html"><a href="intro.html#arrange-plot-in-grids"><i class="fa fa-check"></i><b>2.2.5</b> arrange plot in grids</a></li>
<li class="chapter" data-level="2.2.6" data-path="intro.html"><a href="intro.html#line-plot"><i class="fa fa-check"></i><b>2.2.6</b> Line plot</a></li>
<li class="chapter" data-level="2.2.7" data-path="intro.html"><a href="intro.html#facet-wrap"><i class="fa fa-check"></i><b>2.2.7</b> Facet wrap</a></li>
<li class="chapter" data-level="2.2.8" data-path="intro.html"><a href="intro.html#polygons"><i class="fa fa-check"></i><b>2.2.8</b> Polygons</a></li>
<li class="chapter" data-level="2.2.9" data-path="intro.html"><a href="intro.html#gantt-chart"><i class="fa fa-check"></i><b>2.2.9</b> Gantt chart</a></li>
<li class="chapter" data-level="2.2.10" data-path="intro.html"><a href="intro.html#heatmap"><i class="fa fa-check"></i><b>2.2.10</b> Heatmap</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#ggplot2-extra"><i class="fa fa-check"></i><b>2.3</b> ggplot2 extra</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#alluvial-and-sankey-diagram"><i class="fa fa-check"></i><b>2.3.1</b> Alluvial and Sankey diagram</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro.html"><a href="intro.html#survival-plot"><i class="fa fa-check"></i><b>2.3.2</b> Survival plot</a></li>
<li class="chapter" data-level="2.3.3" data-path="intro.html"><a href="intro.html#ggraph-and-tidygraph"><i class="fa fa-check"></i><b>2.3.3</b> ggraph and tidygraph</a></li>
<li class="chapter" data-level="2.3.4" data-path="intro.html"><a href="intro.html#ggparty-decision-tree"><i class="fa fa-check"></i><b>2.3.4</b> ggparty-decision tree</a></li>
<li class="chapter" data-level="2.3.5" data-path="intro.html"><a href="intro.html#map"><i class="fa fa-check"></i><b>2.3.5</b> Map</a></li>
<li class="chapter" data-level="2.3.6" data-path="intro.html"><a href="intro.html#ggwordcloud"><i class="fa fa-check"></i><b>2.3.6</b> ggwordcloud</a></li>
<li class="chapter" data-level="2.3.7" data-path="intro.html"><a href="intro.html#gganimate"><i class="fa fa-check"></i><b>2.3.7</b> gganimate</a></li>
<li class="chapter" data-level="2.3.8" data-path="intro.html"><a href="intro.html#ggneuro"><i class="fa fa-check"></i><b>2.3.8</b> ggneuro</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#plotly"><i class="fa fa-check"></i><b>2.4</b> plotly</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="intro.html"><a href="intro.html#scatter-plot-with-plotly"><i class="fa fa-check"></i><b>2.4.1</b> Scatter plot with plotly</a></li>
<li class="chapter" data-level="2.4.2" data-path="intro.html"><a href="intro.html#bar-plot-with-plotly"><i class="fa fa-check"></i><b>2.4.2</b> Bar plot with plotly</a></li>
<li class="chapter" data-level="2.4.3" data-path="intro.html"><a href="intro.html#heatmap-1"><i class="fa fa-check"></i><b>2.4.3</b> Heatmap</a></li>
<li class="chapter" data-level="2.4.4" data-path="intro.html"><a href="intro.html#map-1"><i class="fa fa-check"></i><b>2.4.4</b> map</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>3</b> Data Wrangling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-wrangling.html"><a href="data-wrangling.html#data"><i class="fa fa-check"></i><b>3.1</b> Data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="data-wrangling.html"><a href="data-wrangling.html#vector-arrays-matrix"><i class="fa fa-check"></i><b>3.1.1</b> Vector, Arrays, Matrix</a></li>
<li class="chapter" data-level="3.1.2" data-path="data-wrangling.html"><a href="data-wrangling.html#operators"><i class="fa fa-check"></i><b>3.1.2</b> Operators</a></li>
<li class="chapter" data-level="3.1.3" data-path="data-wrangling.html"><a href="data-wrangling.html#simple-function"><i class="fa fa-check"></i><b>3.1.3</b> Simple function</a></li>
<li class="chapter" data-level="3.1.4" data-path="data-wrangling.html"><a href="data-wrangling.html#for-loop"><i class="fa fa-check"></i><b>3.1.4</b> for loop</a></li>
<li class="chapter" data-level="3.1.5" data-path="data-wrangling.html"><a href="data-wrangling.html#apply-lapply-sapply"><i class="fa fa-check"></i><b>3.1.5</b> apply, lapply, sapply</a></li>
<li class="chapter" data-level="3.1.6" data-path="data-wrangling.html"><a href="data-wrangling.html#functional"><i class="fa fa-check"></i><b>3.1.6</b> Functional</a></li>
<li class="chapter" data-level="3.1.7" data-path="data-wrangling.html"><a href="data-wrangling.html#iteration"><i class="fa fa-check"></i><b>3.1.7</b> Iteration</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-wrangling.html"><a href="data-wrangling.html#data-storage"><i class="fa fa-check"></i><b>3.2</b> Data storage</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-wrangling.html"><a href="data-wrangling.html#data-frame"><i class="fa fa-check"></i><b>3.2.1</b> Data frame</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-wrangling.html"><a href="data-wrangling.html#excel-data"><i class="fa fa-check"></i><b>3.2.2</b> Excel data</a></li>
<li class="chapter" data-level="3.2.3" data-path="data-wrangling.html"><a href="data-wrangling.html#foreign-data"><i class="fa fa-check"></i><b>3.2.3</b> Foreign data</a></li>
<li class="chapter" data-level="3.2.4" data-path="data-wrangling.html"><a href="data-wrangling.html#json-format"><i class="fa fa-check"></i><b>3.2.4</b> json format</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-wrangling.html"><a href="data-wrangling.html#tidy-data"><i class="fa fa-check"></i><b>3.3</b> Tidy data</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-wrangling.html"><a href="data-wrangling.html#factors"><i class="fa fa-check"></i><b>3.3.1</b> Factors</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-wrangling.html"><a href="data-wrangling.html#multiple-files"><i class="fa fa-check"></i><b>3.3.2</b> Multiple files</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-wrangling.html"><a href="data-wrangling.html#tidy-evaluation"><i class="fa fa-check"></i><b>3.3.3</b> Tidy evaluation</a></li>
<li class="chapter" data-level="3.3.4" data-path="data-wrangling.html"><a href="data-wrangling.html#pivot-wide-and-long"><i class="fa fa-check"></i><b>3.3.4</b> Pivot wide and long</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-wrangling.html"><a href="data-wrangling.html#regular-expressions"><i class="fa fa-check"></i><b>3.4</b> Regular Expressions</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="data-wrangling.html"><a href="data-wrangling.html#base-r"><i class="fa fa-check"></i><b>3.4.1</b> base R</a></li>
<li class="chapter" data-level="3.4.2" data-path="data-wrangling.html"><a href="data-wrangling.html#stringr"><i class="fa fa-check"></i><b>3.4.2</b> stringr</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="data-wrangling.html"><a href="data-wrangling.html#pdf-to-xcel"><i class="fa fa-check"></i><b>3.5</b> PDF to xcel</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="data-wrangling.html"><a href="data-wrangling.html#scanned-text-or-picture"><i class="fa fa-check"></i><b>3.5.1</b> Scanned text or picture</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="data-wrangling.html"><a href="data-wrangling.html#web-scraping"><i class="fa fa-check"></i><b>3.6</b> Web scraping</a></li>
<li class="chapter" data-level="3.7" data-path="data-wrangling.html"><a href="data-wrangling.html#medical-images"><i class="fa fa-check"></i><b>3.7</b> Medical Images</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="data-wrangling.html"><a href="data-wrangling.html#dicom-and-nifti-format"><i class="fa fa-check"></i><b>3.7.1</b> DICOM and nifti format</a></li>
<li class="chapter" data-level="3.7.2" data-path="data-wrangling.html"><a href="data-wrangling.html#manipulating-array-of-medical-images"><i class="fa fa-check"></i><b>3.7.2</b> Manipulating array of medical images</a></li>
<li class="chapter" data-level="3.7.3" data-path="data-wrangling.html"><a href="data-wrangling.html#combining-arrays"><i class="fa fa-check"></i><b>3.7.3</b> Combining arrays</a></li>
<li class="chapter" data-level="3.7.4" data-path="data-wrangling.html"><a href="data-wrangling.html#math-operation-on-multidimensional-array"><i class="fa fa-check"></i><b>3.7.4</b> Math operation on multidimensional array</a></li>
<li class="chapter" data-level="3.7.5" data-path="data-wrangling.html"><a href="data-wrangling.html#math-operation-on-list"><i class="fa fa-check"></i><b>3.7.5</b> Math operation on list</a></li>
<li class="chapter" data-level="3.7.6" data-path="data-wrangling.html"><a href="data-wrangling.html#vectorising-nifti-object"><i class="fa fa-check"></i><b>3.7.6</b> Vectorising nifti object</a></li>
<li class="chapter" data-level="3.7.7" data-path="data-wrangling.html"><a href="data-wrangling.html#tar-file"><i class="fa fa-check"></i><b>3.7.7</b> tar file</a></li>
<li class="chapter" data-level="3.7.8" data-path="data-wrangling.html"><a href="data-wrangling.html#image-registration"><i class="fa fa-check"></i><b>3.7.8</b> Image registration</a></li>
<li class="chapter" data-level="3.7.9" data-path="data-wrangling.html"><a href="data-wrangling.html#rescaling"><i class="fa fa-check"></i><b>3.7.9</b> Rescaling</a></li>
<li class="chapter" data-level="3.7.10" data-path="data-wrangling.html"><a href="data-wrangling.html#mni-template"><i class="fa fa-check"></i><b>3.7.10</b> MNI template</a></li>
<li class="chapter" data-level="3.7.11" data-path="data-wrangling.html"><a href="data-wrangling.html#atlases"><i class="fa fa-check"></i><b>3.7.11</b> Atlases</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="data-wrangling.html"><a href="data-wrangling.html#ecg-signal-processing"><i class="fa fa-check"></i><b>3.8</b> ECG Signal processing</a></li>
<li class="chapter" data-level="3.9" data-path="data-wrangling.html"><a href="data-wrangling.html#eeg-signal-processing"><i class="fa fa-check"></i><b>3.9</b> EEG signal processing</a></li>
<li class="chapter" data-level="3.10" data-path="data-wrangling.html"><a href="data-wrangling.html#python"><i class="fa fa-check"></i><b>3.10</b> Python</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="data-wrangling.html"><a href="data-wrangling.html#reticulate"><i class="fa fa-check"></i><b>3.10.1</b> Reticulate</a></li>
<li class="chapter" data-level="3.10.2" data-path="data-wrangling.html"><a href="data-wrangling.html#minconda"><i class="fa fa-check"></i><b>3.10.2</b> Minconda</a></li>
<li class="chapter" data-level="3.10.3" data-path="data-wrangling.html"><a href="data-wrangling.html#python-environment"><i class="fa fa-check"></i><b>3.10.3</b> Python environment</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="data-wrangling.html"><a href="data-wrangling.html#matlab"><i class="fa fa-check"></i><b>3.11</b> Matlab</a></li>
<li class="chapter" data-level="3.12" data-path="data-wrangling.html"><a href="data-wrangling.html#stata"><i class="fa fa-check"></i><b>3.12</b> Stata</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>4</b> Statistics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="statistics.html"><a href="statistics.html#univariable-analyses"><i class="fa fa-check"></i><b>4.1</b> Univariable analyses</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="statistics.html"><a href="statistics.html#parametric-tests"><i class="fa fa-check"></i><b>4.1.1</b> Parametric tests</a></li>
<li class="chapter" data-level="4.1.2" data-path="statistics.html"><a href="statistics.html#non-parametric-tests"><i class="fa fa-check"></i><b>4.1.2</b> Non-parametric tests</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="statistics.html"><a href="statistics.html#regression"><i class="fa fa-check"></i><b>4.2</b> Regression</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="statistics.html"><a href="statistics.html#brief-review-of-matrix"><i class="fa fa-check"></i><b>4.2.1</b> Brief review of matrix</a></li>
<li class="chapter" data-level="4.2.2" data-path="statistics.html"><a href="statistics.html#linear-least-square-regression"><i class="fa fa-check"></i><b>4.2.2</b> Linear (least square) regression</a></li>
<li class="chapter" data-level="4.2.3" data-path="statistics.html"><a href="statistics.html#logistic-regression"><i class="fa fa-check"></i><b>4.2.3</b> Logistic regression</a></li>
<li class="chapter" data-level="4.2.4" data-path="statistics.html"><a href="statistics.html#discrimination-and-calibration"><i class="fa fa-check"></i><b>4.2.4</b> Discrimination and Calibration</a></li>
<li class="chapter" data-level="4.2.5" data-path="statistics.html"><a href="statistics.html#interaction"><i class="fa fa-check"></i><b>4.2.5</b> Interaction</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="statistics.html"><a href="statistics.html#confounder"><i class="fa fa-check"></i><b>4.3</b> Confounder</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="statistics.html"><a href="statistics.html#confounder-weighted-model"><i class="fa fa-check"></i><b>4.3.1</b> Confounder weighted model</a></li>
<li class="chapter" data-level="4.3.2" data-path="statistics.html"><a href="statistics.html#propensity-matching"><i class="fa fa-check"></i><b>4.3.2</b> Propensity matching</a></li>
<li class="chapter" data-level="4.3.3" data-path="statistics.html"><a href="statistics.html#e-values"><i class="fa fa-check"></i><b>4.3.3</b> E-values</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="statistics.html"><a href="statistics.html#causal-inference"><i class="fa fa-check"></i><b>4.4</b> Causal inference</a></li>
<li class="chapter" data-level="4.5" data-path="statistics.html"><a href="statistics.html#special-types-of-regression"><i class="fa fa-check"></i><b>4.5</b> Special types of regression</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="statistics.html"><a href="statistics.html#ordinal-regression"><i class="fa fa-check"></i><b>4.5.1</b> Ordinal regression</a></li>
<li class="chapter" data-level="4.5.2" data-path="statistics.html"><a href="statistics.html#survival-analysis"><i class="fa fa-check"></i><b>4.5.2</b> Survival analysis</a></li>
<li class="chapter" data-level="4.5.3" data-path="statistics.html"><a href="statistics.html#quantile-regression"><i class="fa fa-check"></i><b>4.5.3</b> Quantile regression</a></li>
<li class="chapter" data-level="4.5.4" data-path="statistics.html"><a href="statistics.html#non-negative-regression"><i class="fa fa-check"></i><b>4.5.4</b> Non-negative regression</a></li>
<li class="chapter" data-level="4.5.5" data-path="statistics.html"><a href="statistics.html#poisson-regression"><i class="fa fa-check"></i><b>4.5.5</b> Poisson regression</a></li>
<li class="chapter" data-level="4.5.6" data-path="statistics.html"><a href="statistics.html#conditional-logistic-regression"><i class="fa fa-check"></i><b>4.5.6</b> Conditional logistic regression</a></li>
<li class="chapter" data-level="4.5.7" data-path="statistics.html"><a href="statistics.html#multinomial-modelling"><i class="fa fa-check"></i><b>4.5.7</b> Multinomial modelling</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="statistics.html"><a href="statistics.html#sample-size-estimation"><i class="fa fa-check"></i><b>4.6</b> Sample size estimation</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="statistics.html"><a href="statistics.html#proportion"><i class="fa fa-check"></i><b>4.6.1</b> Proportion</a></li>
<li class="chapter" data-level="4.6.2" data-path="statistics.html"><a href="statistics.html#logistic-regression-1"><i class="fa fa-check"></i><b>4.6.2</b> Logistic regression</a></li>
<li class="chapter" data-level="4.6.3" data-path="statistics.html"><a href="statistics.html#survival-studies"><i class="fa fa-check"></i><b>4.6.3</b> Survival studies</a></li>
<li class="chapter" data-level="4.6.4" data-path="statistics.html"><a href="statistics.html#multiple-regression"><i class="fa fa-check"></i><b>4.6.4</b> Multiple regression</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="statistics.html"><a href="statistics.html#randomised-clinical-trials"><i class="fa fa-check"></i><b>4.7</b> Randomised clinical trials</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="statistics.html"><a href="statistics.html#covariate-adjustment-in-trials"><i class="fa fa-check"></i><b>4.7.1</b> Covariate adjustment in trials</a></li>
<li class="chapter" data-level="4.7.2" data-path="statistics.html"><a href="statistics.html#subgroup-analysis"><i class="fa fa-check"></i><b>4.7.2</b> Subgroup analysis</a></li>
<li class="chapter" data-level="4.7.3" data-path="statistics.html"><a href="statistics.html#p-value-for-interaction"><i class="fa fa-check"></i><b>4.7.3</b> p value for interaction</a></li>
<li class="chapter" data-level="4.7.4" data-path="statistics.html"><a href="statistics.html#interpreting-risk-reduction-in-clinical-trials"><i class="fa fa-check"></i><b>4.7.4</b> Interpreting risk reduction in clinical trials</a></li>
<li class="chapter" data-level="4.7.5" data-path="statistics.html"><a href="statistics.html#nnt-from-arr"><i class="fa fa-check"></i><b>4.7.5</b> NNT from ARR</a></li>
<li class="chapter" data-level="4.7.6" data-path="statistics.html"><a href="statistics.html#nnt-from-odds-ratio"><i class="fa fa-check"></i><b>4.7.6</b> NNT from odds ratio</a></li>
<li class="chapter" data-level="4.7.7" data-path="statistics.html"><a href="statistics.html#nnt-from-risk-ratio"><i class="fa fa-check"></i><b>4.7.7</b> NNT from risk ratio</a></li>
<li class="chapter" data-level="4.7.8" data-path="statistics.html"><a href="statistics.html#nnt-from-hazard-ratio"><i class="fa fa-check"></i><b>4.7.8</b> NNT from hazard ratio</a></li>
<li class="chapter" data-level="4.7.9" data-path="statistics.html"><a href="statistics.html#nnt-from-metaananlysis"><i class="fa fa-check"></i><b>4.7.9</b> NNT from metaananlysis</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="statistics.html"><a href="statistics.html#diagnostic-test"><i class="fa fa-check"></i><b>4.8</b> Diagnostic test</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="statistics.html"><a href="statistics.html#sensitivity-specificity"><i class="fa fa-check"></i><b>4.8.1</b> Sensitivity, specificity</a></li>
<li class="chapter" data-level="4.8.2" data-path="statistics.html"><a href="statistics.html#auc"><i class="fa fa-check"></i><b>4.8.2</b> AUC</a></li>
<li class="chapter" data-level="4.8.3" data-path="statistics.html"><a href="statistics.html#likelihood-ratio"><i class="fa fa-check"></i><b>4.8.3</b> Likelihood ratio</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="statistics.html"><a href="statistics.html#metaanalysis"><i class="fa fa-check"></i><b>4.9</b> Metaanalysis</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="statistics.html"><a href="statistics.html#quality-of-study"><i class="fa fa-check"></i><b>4.9.1</b> Quality of study</a></li>
<li class="chapter" data-level="4.9.2" data-path="statistics.html"><a href="statistics.html#prisma"><i class="fa fa-check"></i><b>4.9.2</b> PRISMA</a></li>
<li class="chapter" data-level="4.9.3" data-path="statistics.html"><a href="statistics.html#conversion-of-median-to-mean"><i class="fa fa-check"></i><b>4.9.3</b> Conversion of median to mean</a></li>
<li class="chapter" data-level="4.9.4" data-path="statistics.html"><a href="statistics.html#inconsistency-i2"><i class="fa fa-check"></i><b>4.9.4</b> Inconsistency I2</a></li>
<li class="chapter" data-level="4.9.5" data-path="statistics.html"><a href="statistics.html#metaanalysis-of-proportion"><i class="fa fa-check"></i><b>4.9.5</b> Metaanalysis of proportion</a></li>
<li class="chapter" data-level="4.9.6" data-path="statistics.html"><a href="statistics.html#metaanalysis-of-continuous-data"><i class="fa fa-check"></i><b>4.9.6</b> Metaanalysis of continuous data</a></li>
<li class="chapter" data-level="4.9.7" data-path="statistics.html"><a href="statistics.html#bivariate-metaanalysis"><i class="fa fa-check"></i><b>4.9.7</b> Bivariate Metaanalysis</a></li>
<li class="chapter" data-level="4.9.8" data-path="statistics.html"><a href="statistics.html#metaanalysis-of-clinical-trial."><i class="fa fa-check"></i><b>4.9.8</b> Metaanalysis of clinical trial.</a></li>
<li class="chapter" data-level="4.9.9" data-path="statistics.html"><a href="statistics.html#metaregression"><i class="fa fa-check"></i><b>4.9.9</b> Metaregression</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="statistics.html"><a href="statistics.html#data-simulation"><i class="fa fa-check"></i><b>4.10</b> Data simulation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html"><i class="fa fa-check"></i><b>5</b> Multivariate Analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#multivariate-regression"><i class="fa fa-check"></i><b>5.1</b> Multivariate regression</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#penalised-regression"><i class="fa fa-check"></i><b>5.1.1</b> Penalised regression</a></li>
<li class="chapter" data-level="5.1.2" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#mars"><i class="fa fa-check"></i><b>5.1.2</b> MARS</a></li>
<li class="chapter" data-level="5.1.3" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#mixed-modelling"><i class="fa fa-check"></i><b>5.1.3</b> Mixed modelling</a></li>
<li class="chapter" data-level="5.1.4" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#trajectory-modelling"><i class="fa fa-check"></i><b>5.1.4</b> Trajectory modelling</a></li>
<li class="chapter" data-level="5.1.5" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#generalized-estimating-equation-gee"><i class="fa fa-check"></i><b>5.1.5</b> Generalized estimating equation (GEE)</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#principal-component-analysis"><i class="fa fa-check"></i><b>5.2</b> Principal component analysis</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#pca-with-mri"><i class="fa fa-check"></i><b>5.2.1</b> PCA with MRI</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#independent-component-analysis"><i class="fa fa-check"></i><b>5.3</b> Independent component analysis</a></li>
<li class="chapter" data-level="5.4" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#partial-least-squares"><i class="fa fa-check"></i><b>5.4</b> Partial least squares</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="machine-learning.html"><a href="machine-learning.html"><i class="fa fa-check"></i><b>6</b> Machine learning</a>
<ul>
<li class="chapter" data-level="6.1" data-path="machine-learning.html"><a href="machine-learning.html#decision-tree-analysis"><i class="fa fa-check"></i><b>6.1</b> Decision tree analysis</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="machine-learning.html"><a href="machine-learning.html#information-theory-driven"><i class="fa fa-check"></i><b>6.1.1</b> Information theory driven</a></li>
<li class="chapter" data-level="6.1.2" data-path="machine-learning.html"><a href="machine-learning.html#conditional-decision-tree"><i class="fa fa-check"></i><b>6.1.2</b> Conditional decision tree</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="machine-learning.html"><a href="machine-learning.html#ensemble-tree-methods"><i class="fa fa-check"></i><b>6.2</b> Ensemble tree methods</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="machine-learning.html"><a href="machine-learning.html#bagging-trees"><i class="fa fa-check"></i><b>6.2.1</b> Bagging trees</a></li>
<li class="chapter" data-level="6.2.2" data-path="machine-learning.html"><a href="machine-learning.html#boosting-trees"><i class="fa fa-check"></i><b>6.2.2</b> Boosting trees</a></li>
<li class="chapter" data-level="6.2.3" data-path="machine-learning.html"><a href="machine-learning.html#bayesian-trees-method"><i class="fa fa-check"></i><b>6.2.3</b> Bayesian trees method</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="machine-learning.html"><a href="machine-learning.html#knn"><i class="fa fa-check"></i><b>6.3</b> KNN</a></li>
<li class="chapter" data-level="6.4" data-path="machine-learning.html"><a href="machine-learning.html#support-vector-machine"><i class="fa fa-check"></i><b>6.4</b> Support vector machine</a></li>
<li class="chapter" data-level="6.5" data-path="machine-learning.html"><a href="machine-learning.html#non-negative-matrix-factorisation"><i class="fa fa-check"></i><b>6.5</b> Non-negative matrix factorisation</a></li>
<li class="chapter" data-level="6.6" data-path="machine-learning.html"><a href="machine-learning.html#formal-concept-analysis"><i class="fa fa-check"></i><b>6.6</b> Formal concept analysis</a></li>
<li class="chapter" data-level="6.7" data-path="machine-learning.html"><a href="machine-learning.html#evolutionary-algorithm"><i class="fa fa-check"></i><b>6.7</b> Evolutionary Algorithm</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="machine-learning.html"><a href="machine-learning.html#simulated-annealing"><i class="fa fa-check"></i><b>6.7.1</b> Simulated Annealing</a></li>
<li class="chapter" data-level="6.7.2" data-path="machine-learning.html"><a href="machine-learning.html#genetic-algorithm"><i class="fa fa-check"></i><b>6.7.2</b> Genetic Algorithm</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="machine-learning.html"><a href="machine-learning.html#manifold-learning"><i class="fa fa-check"></i><b>6.8</b> Manifold learning</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="machine-learning.html"><a href="machine-learning.html#t-stochastic-neighbourhood-embedding"><i class="fa fa-check"></i><b>6.8.1</b> T-Stochastic Neighbourhood Embedding</a></li>
<li class="chapter" data-level="6.8.2" data-path="machine-learning.html"><a href="machine-learning.html#self-organising-map"><i class="fa fa-check"></i><b>6.8.2</b> Self organising map</a></li>
<li class="chapter" data-level="6.8.3" data-path="machine-learning.html"><a href="machine-learning.html#multidimensional-scaling"><i class="fa fa-check"></i><b>6.8.3</b> Multidimensional scaling</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="machine-learning.html"><a href="machine-learning.html#deep-learning"><i class="fa fa-check"></i><b>6.9</b> Deep learning</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="machine-learning.html"><a href="machine-learning.html#deep-neural-network"><i class="fa fa-check"></i><b>6.9.1</b> Deep neural network</a></li>
<li class="chapter" data-level="6.9.2" data-path="machine-learning.html"><a href="machine-learning.html#tabnet"><i class="fa fa-check"></i><b>6.9.2</b> Tabnet</a></li>
<li class="chapter" data-level="6.9.3" data-path="machine-learning.html"><a href="machine-learning.html#cnn"><i class="fa fa-check"></i><b>6.9.3</b> CNN</a></li>
<li class="chapter" data-level="6.9.4" data-path="machine-learning.html"><a href="machine-learning.html#rnn"><i class="fa fa-check"></i><b>6.9.4</b> RNN</a></li>
<li class="chapter" data-level="6.9.5" data-path="machine-learning.html"><a href="machine-learning.html#reinforcement-learning"><i class="fa fa-check"></i><b>6.9.5</b> Reinforcement learning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html"><i class="fa fa-check"></i><b>7</b> Machine Learning Part 2</a>
<ul>
<li class="chapter" data-level="7.1" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#bag-of-words"><i class="fa fa-check"></i><b>7.1</b> Bag of words</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#tfidf"><i class="fa fa-check"></i><b>7.1.1</b> TFIDF</a></li>
<li class="chapter" data-level="7.1.2" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#extracting-data-from-web"><i class="fa fa-check"></i><b>7.1.2</b> Extracting data from web</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#wordcloud"><i class="fa fa-check"></i><b>7.2</b> Wordcloud</a></li>
<li class="chapter" data-level="7.3" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#bigram-analysis"><i class="fa fa-check"></i><b>7.3</b> Bigram analysis</a></li>
<li class="chapter" data-level="7.4" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#trigram"><i class="fa fa-check"></i><b>7.4</b> Trigram</a></li>
<li class="chapter" data-level="7.5" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#topic-modeling-or-thematic-analysis"><i class="fa fa-check"></i><b>7.5</b> Topic modeling or thematic analysis</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#probabilistic-topic-model"><i class="fa fa-check"></i><b>7.5.1</b> Probabilistic topic model</a></li>
<li class="chapter" data-level="7.5.2" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#nmf"><i class="fa fa-check"></i><b>7.5.2</b> NMF</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html"><i class="fa fa-check"></i><b>8</b> Bayesian Analysis</a>
<ul>
<li class="chapter" data-level="8.1" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#baysian-belief"><i class="fa fa-check"></i><b>8.1</b> Baysian belief</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#conditional-probability"><i class="fa fa-check"></i><b>8.1.1</b> Conditional probability</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#markov-model"><i class="fa fa-check"></i><b>8.2</b> Markov model</a></li>
<li class="chapter" data-level="8.3" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#inla-stan-and-bugs"><i class="fa fa-check"></i><b>8.3</b> INLA, Stan and BUGS</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#linear-regression"><i class="fa fa-check"></i><b>8.3.1</b> Linear regression</a></li>
<li class="chapter" data-level="8.3.2" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#logistic-regression-2"><i class="fa fa-check"></i><b>8.3.2</b> Logistic regression</a></li>
<li class="chapter" data-level="8.3.3" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#mixed-model"><i class="fa fa-check"></i><b>8.3.3</b> Mixed model</a></li>
<li class="chapter" data-level="8.3.4" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#bayesian-metaanalysis"><i class="fa fa-check"></i><b>8.3.4</b> Bayesian Metaanalysis</a></li>
<li class="chapter" data-level="8.3.5" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#cost"><i class="fa fa-check"></i><b>8.3.5</b> Cost</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="operational-research.html"><a href="operational-research.html"><i class="fa fa-check"></i><b>9</b> Operational Research</a>
<ul>
<li class="chapter" data-level="9.1" data-path="operational-research.html"><a href="operational-research.html#queueing-theory"><i class="fa fa-check"></i><b>9.1</b> Queueing theory</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="operational-research.html"><a href="operational-research.html#simulate-capacity-of-system"><i class="fa fa-check"></i><b>9.1.1</b> Simulate capacity of system</a></li>
<li class="chapter" data-level="9.1.2" data-path="operational-research.html"><a href="operational-research.html#queuing-network"><i class="fa fa-check"></i><b>9.1.2</b> Queuing network</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="operational-research.html"><a href="operational-research.html#linear-programming"><i class="fa fa-check"></i><b>9.2</b> Linear Programming</a></li>
<li class="chapter" data-level="9.3" data-path="operational-research.html"><a href="operational-research.html#forecasting"><i class="fa fa-check"></i><b>9.3</b> Forecasting</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="operational-research.html"><a href="operational-research.html#bed-requirement"><i class="fa fa-check"></i><b>9.3.1</b> Bed requirement</a></li>
<li class="chapter" data-level="9.3.2" data-path="operational-research.html"><a href="operational-research.html#length-of-stay"><i class="fa fa-check"></i><b>9.3.2</b> Length of stay</a></li>
<li class="chapter" data-level="9.3.3" data-path="operational-research.html"><a href="operational-research.html#customer-churns"><i class="fa fa-check"></i><b>9.3.3</b> Customer churns</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="operational-research.html"><a href="operational-research.html#process-mapping"><i class="fa fa-check"></i><b>9.4</b> Process mapping</a></li>
<li class="chapter" data-level="9.5" data-path="operational-research.html"><a href="operational-research.html#supply-chains"><i class="fa fa-check"></i><b>9.5</b> Supply chains</a></li>
<li class="chapter" data-level="9.6" data-path="operational-research.html"><a href="operational-research.html#health-economics"><i class="fa fa-check"></i><b>9.6</b> Health economics</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="operational-research.html"><a href="operational-research.html#cost-1"><i class="fa fa-check"></i><b>9.6.1</b> Cost</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="graph-theory.html"><a href="graph-theory.html"><i class="fa fa-check"></i><b>10</b> Graph Theory</a>
<ul>
<li class="chapter" data-level="10.1" data-path="graph-theory.html"><a href="graph-theory.html#special-graphs"><i class="fa fa-check"></i><b>10.1</b> Special graphs</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="graph-theory.html"><a href="graph-theory.html#laplacian-matrix"><i class="fa fa-check"></i><b>10.1.1</b> Laplacian matrix</a></li>
<li class="chapter" data-level="10.1.2" data-path="graph-theory.html"><a href="graph-theory.html#bimodal-bipartite-graph"><i class="fa fa-check"></i><b>10.1.2</b> Bimodal (bipartite) graph</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="graph-theory.html"><a href="graph-theory.html#centrality-measures"><i class="fa fa-check"></i><b>10.2</b> Centrality Measures</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="graph-theory.html"><a href="graph-theory.html#local-centrality-measures"><i class="fa fa-check"></i><b>10.2.1</b> Local centrality measures</a></li>
<li class="chapter" data-level="10.2.2" data-path="graph-theory.html"><a href="graph-theory.html#global-centrality-measures"><i class="fa fa-check"></i><b>10.2.2</b> Global centrality measures</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="graph-theory.html"><a href="graph-theory.html#community"><i class="fa fa-check"></i><b>10.3</b> Community</a></li>
<li class="chapter" data-level="10.4" data-path="graph-theory.html"><a href="graph-theory.html#visualising-graph"><i class="fa fa-check"></i><b>10.4</b> Visualising graph</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="graph-theory.html"><a href="graph-theory.html#visnetwork"><i class="fa fa-check"></i><b>10.4.1</b> Visnetwork</a></li>
<li class="chapter" data-level="10.4.2" data-path="graph-theory.html"><a href="graph-theory.html#large-graph"><i class="fa fa-check"></i><b>10.4.2</b> Large graph</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="graph-theory.html"><a href="graph-theory.html#social-media-and-network-analysis"><i class="fa fa-check"></i><b>10.5</b> Social Media and Network Analysis</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="graph-theory.html"><a href="graph-theory.html#twitter"><i class="fa fa-check"></i><b>10.5.1</b> Twitter</a></li>
<li class="chapter" data-level="10.5.2" data-path="graph-theory.html"><a href="graph-theory.html#youtube"><i class="fa fa-check"></i><b>10.5.2</b> Youtube</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html"><i class="fa fa-check"></i><b>11</b> Geospatial analysis</a>
<ul>
<li class="chapter" data-level="11.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#geocoding"><i class="fa fa-check"></i><b>11.1</b> Geocoding</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#openstreetmap"><i class="fa fa-check"></i><b>11.1.1</b> OpenStreetMap</a></li>
<li class="chapter" data-level="11.1.2" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#google-maps-api"><i class="fa fa-check"></i><b>11.1.2</b> Google Maps API</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#sp-and-sf-objects"><i class="fa fa-check"></i><b>11.2</b> Sp and sf objects</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#section-1"><i class="fa fa-check"></i><b>11.2.1</b> </a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#thematic-map-1"><i class="fa fa-check"></i><b>11.3</b> Thematic map</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#calculate-distance-to-hospital-openstreetmap"><i class="fa fa-check"></i><b>11.3.1</b> Calculate distance to Hospital-OpenStreetMap</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#spatial-regression"><i class="fa fa-check"></i><b>11.4</b> Spatial regression</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#new-york-covid-19-mortality"><i class="fa fa-check"></i><b>11.4.1</b> New York COVID-19 mortality</a></li>
<li class="chapter" data-level="11.4.2" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#danish-stroke-registry"><i class="fa fa-check"></i><b>11.4.2</b> Danish Stroke Registry</a></li>
<li class="chapter" data-level="11.4.3" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#inla"><i class="fa fa-check"></i><b>11.4.3</b> INLA</a></li>
<li class="chapter" data-level="11.4.4" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#stan"><i class="fa fa-check"></i><b>11.4.4</b> Stan</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#machine-learning-in-spatial-analysis"><i class="fa fa-check"></i><b>11.5</b> Machine learning in spatial analysis</a></li>
<li class="chapter" data-level="11.6" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#spatio-temporal-regression"><i class="fa fa-check"></i><b>11.6</b> Spatio-temporal regression</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="app.html"><a href="app.html"><i class="fa fa-check"></i><b>12</b> App</a>
<ul>
<li class="chapter" data-level="12.1" data-path="app.html"><a href="app.html#brief-introduction-to-shiny-app"><i class="fa fa-check"></i><b>12.1</b> Brief introduction to Shiny app</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>13</b> Appendix</a>
<ul>
<li class="chapter" data-level="13.1" data-path="appendix.html"><a href="appendix.html#brief-introduction-to-matrix"><i class="fa fa-check"></i><b>13.1</b> Brief introduction to Matrix</a></li>
<li class="chapter" data-level="13.2" data-path="appendix.html"><a href="appendix.html#regression-1"><i class="fa fa-check"></i><b>13.2</b> Regression</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="appendix.html"><a href="appendix.html#linear-regression-1"><i class="fa fa-check"></i><b>13.2.1</b> Linear regression</a></li>
<li class="chapter" data-level="13.2.2" data-path="appendix.html"><a href="appendix.html#logistic-regression-3"><i class="fa fa-check"></i><b>13.2.2</b> Logistic regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applications of R in Healthcare</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="machine-learning" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Machine learning<a href="machine-learning.html#machine-learning" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>A key aspect of machine learning is cross validation to evaluate the model. It repeatedly evaluate the model based on different subsets of the model and using different parameters to select the optimal parameters. The models are compared against subset of the data. The <em>caret</em> library is an excellent tool for performing model selection.</p>
<div id="decision-tree-analysis" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Decision tree analysis<a href="machine-learning.html#decision-tree-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Decision tree method generates a logical flow diagram that resembles a tree.
This triangulated diagram, with repeated partitioning of the original data into smaller groups (nodes) on a yes or no basis, resembles clinical reasoning. By
way of contrast, regression methods generate significant predictors but it’s not clear how those predictors enter the sequential nature of clinical reasoning. Regression models assume that all of the variables are required at once to formulate an accurate prediction. This would make some of the elements of any model from regression analysis superfluous.</p>
<p>There are several different approaches to performing decision tree analyses. The most famous method CART is implemented in R as <em>rpart</em>. The second approaches
uses chi-square test to partition the tree, available from the <em>party</em> library. Decision tree may also reveal complex intreactions (relationship) among the predictors in a way that regression analyses do not easily reveal.</p>
<div id="information-theory-driven" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Information theory driven<a href="machine-learning.html#information-theory-driven" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The tree is grown using a “divide and conquer” strategy, with repeated partitioning of the original data into smaller groups (nodes) on a yes or no basis. The method uses a splitting rule built around the notion of “purity.” A node in the tree is defined as pure when all the elements belong to one class. When there is impurity in the node, a split occurs to maximize reduction in “impurity.” In some cases, the split may be biased toward attributes that
contain many different ordinal levels or scales. Thus, the selection of an attribute as the root node may vary according to the splitting rule and the scaling of the attribute. The decision tree package rpart does tolerate certain degree of missing number because the data are split using the available data for that attribute to calculate the Gini index (rather than the entire cohort). One major advantage of <em>rpart</em> is the presentation of the classification rules in
the easily interpretable form of a tree. The hierarchical nature of the decision tree is similar to many decision processes <span class="citation">(<a href="#ref-pmid29559951">Phan et al. 2018</a>)</span>. A criticism of decision tree is that it’s prone to overfitting and or preference for variable with many levels. Decision tree do not handle collinearity issues well.</p>
<div class="sourceCode" id="cb774"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb774-1"><a href="machine-learning.html#cb774-1" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb774-2"><a href="machine-learning.html#cb774-2" tabindex="-1"></a><span class="fu">library</span>(rattle)</span></code></pre></div>
<pre><code>## Rattle: A free graphical interface for data science with R.
## Version 5.5.1 Copyright (c) 2006-2021 Togaware Pty Ltd.
## Type &#39;rattle()&#39; to shake, rattle, and roll your data.</code></pre>
<div class="sourceCode" id="cb776"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb776-1"><a href="machine-learning.html#cb776-1" tabindex="-1"></a><span class="fu">library</span>(rpart.plot)</span>
<span id="cb776-2"><a href="machine-learning.html#cb776-2" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Leukemia&quot;</span>, <span class="at">package =</span> <span class="st">&quot;Stat2Data&quot;</span>)</span>
<span id="cb776-3"><a href="machine-learning.html#cb776-3" tabindex="-1"></a><span class="fu">colnames</span>(Leukemia)</span></code></pre></div>
<pre><code>## [1] &quot;Age&quot;    &quot;Smear&quot;  &quot;Infil&quot;  &quot;Index&quot;  &quot;Blasts&quot; &quot;Temp&quot;   &quot;Resp&quot;   &quot;Time&quot;   &quot;Status&quot;</code></pre>
<div class="sourceCode" id="cb778"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb778-1"><a href="machine-learning.html#cb778-1" tabindex="-1"></a><span class="co">#decision tree model for AML treatment</span></span>
<span id="cb778-2"><a href="machine-learning.html#cb778-2" tabindex="-1"></a>treLeukemia<span class="ot">&lt;-</span><span class="fu">rpart</span>(Status<span class="sc">~</span>., <span class="at">data=</span>Leukemia)</span>
<span id="cb778-3"><a href="machine-learning.html#cb778-3" tabindex="-1"></a><span class="fu">fancyRpartPlot</span>(treLeukemia)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-1-1.png" width="672" /></p>
</div>
<div id="conditional-decision-tree" class="section level3 hasAnchor" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> Conditional decision tree<a href="machine-learning.html#conditional-decision-tree" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The conditional decision tree approach has been proposed to be superior to CART method because that method uses information criterion for partitioning and which can lead to overﬁtting.The scenario of overﬁtting describes model which works
well on training data but less so with new data.The conditional approach by <em>party</em> is less prone to overﬁtting as it includes signiﬁcance testing <span class="citation">(<a href="#ref-pmid30761063">Phan, Kooblal, et al. 2019</a>)</span>.</p>
<div class="sourceCode" id="cb779"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb779-1"><a href="machine-learning.html#cb779-1" tabindex="-1"></a><span class="fu">library</span>(party)</span>
<span id="cb779-2"><a href="machine-learning.html#cb779-2" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;aSAH&quot;</span>, <span class="at">package =</span> <span class="st">&quot;pROC&quot;</span>)</span>
<span id="cb779-3"><a href="machine-learning.html#cb779-3" tabindex="-1"></a><span class="fu">colnames</span>(aSAH)</span></code></pre></div>
<pre><code>## [1] &quot;gos6&quot;    &quot;outcome&quot; &quot;gender&quot;  &quot;age&quot;     &quot;wfns&quot;    &quot;s100b&quot;   &quot;ndka&quot;</code></pre>
<div class="sourceCode" id="cb781"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb781-1"><a href="machine-learning.html#cb781-1" tabindex="-1"></a><span class="co">#decision tree model</span></span>
<span id="cb781-2"><a href="machine-learning.html#cb781-2" tabindex="-1"></a>treeSAH<span class="ot">&lt;-</span><span class="fu">ctree</span>(outcome<span class="sc">~</span>., <span class="at">data=</span>aSAH, <span class="at">control =</span> <span class="fu">ctree_control</span>(<span class="at">mincriterion=</span><span class="fl">0.95</span>, <span class="at">minsplit=</span><span class="dv">50</span>))</span>
<span id="cb781-3"><a href="machine-learning.html#cb781-3" tabindex="-1"></a><span class="fu">plot</span>(treeSAH,<span class="at">type =</span> <span class="st">&quot;simple&quot;</span>,<span class="at">main =</span> <span class="st">&quot;Conditional Inference for aSAH&quot;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-2-1.png" width="672" /></p>
</div>
</div>
<div id="ensemble-tree-methods" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Ensemble tree methods<a href="machine-learning.html#ensemble-tree-methods" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="bagging-trees" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Bagging trees<a href="machine-learning.html#bagging-trees" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Both gradient boost machine and random forest are examples of tree-based method with the former based on boosting of the residuals of the model and the latter based on bagging with random selection (rows and columns) of multiple subsets of the data. As such random forest regression ensembles the model from multiple decision trees. The trees are created by obtaining multiple subset of the data without replacement (random selection of data by rows and columns). Decision tree comes at certain disadvantage such as overfitting. Random forest avoids the problems of single decision tree analyses by aggregating the results of multiple trees obtained by performing analysis on random subsets of the original data. This method is different from the bootstrapping procedure in which the data is subsetted with replacement. Theoretically, decision tree can look very similar as the data structure is not significantly changed. There is a theoretical risk of overfitting with random forest and underfitting with boosting tree methods.</p>
<div id="random-forest" class="section level4 hasAnchor" number="6.2.1.1">
<h4><span class="header-section-number">6.2.1.1</span> Random Forest<a href="machine-learning.html#random-forest" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Random forest is available as <em>randomForest</em> or <em>ranger</em> or via <em>caret</em>.
A major drawback to random forest is that the hierarchical nature of the trees
is lost. As such this method is seen as a black box tool and is less commonly embraced in the medical literature. One way us to use an interpretable machine learning tool <em>iml</em> <span class="citation">(<a href="#ref-10.21105/joss.00786">Molnar, Bischl, and Casalicchio 2018</a>)</span> (Shapley values) tool to aid interpretation of the model. This method uses ideas from coalition game theory
to fairly distribute the contribution of the coalition of covariates to the
random forest model.</p>
<p>The machine learning models are tuned using <em>caret</em> library.</p>
<div class="sourceCode" id="cb782"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb782-1"><a href="machine-learning.html#cb782-1" tabindex="-1"></a><span class="co">#https://topepo.github.io/caret/index.html</span></span>
<span id="cb782-2"><a href="machine-learning.html#cb782-2" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb782-3"><a href="machine-learning.html#cb782-3" tabindex="-1"></a></span>
<span id="cb782-4"><a href="machine-learning.html#cb782-4" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;BreastCancer&quot;</span>,<span class="at">package =</span> <span class="st">&quot;mlbench&quot;</span>)</span>
<span id="cb782-5"><a href="machine-learning.html#cb782-5" tabindex="-1"></a><span class="co">#The Breast Cancer data contains NA as well as factors</span></span>
<span id="cb782-6"><a href="machine-learning.html#cb782-6" tabindex="-1"></a><span class="co">#note Class is benign or malignant of class factor</span></span>
<span id="cb782-7"><a href="machine-learning.html#cb782-7" tabindex="-1"></a><span class="co">#column Bare.nuclei removed due to NA</span></span>
<span id="cb782-8"><a href="machine-learning.html#cb782-8" tabindex="-1"></a>BreastCancer<span class="ot">&lt;-</span>BreastCancer[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>)]</span>
<span id="cb782-9"><a href="machine-learning.html#cb782-9" tabindex="-1"></a></span>
<span id="cb782-10"><a href="machine-learning.html#cb782-10" tabindex="-1"></a><span class="co">#split data using caTools. </span></span>
<span id="cb782-11"><a href="machine-learning.html#cb782-11" tabindex="-1"></a><span class="co">#The next example will use createDataPartition from caret</span></span>
<span id="cb782-12"><a href="machine-learning.html#cb782-12" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb782-13"><a href="machine-learning.html#cb782-13" tabindex="-1"></a>split <span class="ot">=</span> caTools<span class="sc">::</span><span class="fu">sample.split</span>(BreastCancer<span class="sc">$</span>Class, <span class="at">SplitRatio =</span> <span class="fl">0.75</span>)</span>
<span id="cb782-14"><a href="machine-learning.html#cb782-14" tabindex="-1"></a>Train <span class="ot">=</span> <span class="fu">subset</span>(BreastCancer, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb782-15"><a href="machine-learning.html#cb782-15" tabindex="-1"></a>Test <span class="ot">=</span> <span class="fu">subset</span>(BreastCancer, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb782-16"><a href="machine-learning.html#cb782-16" tabindex="-1"></a></span>
<span id="cb782-17"><a href="machine-learning.html#cb782-17" tabindex="-1"></a></span>
<span id="cb782-18"><a href="machine-learning.html#cb782-18" tabindex="-1"></a><span class="co"># specify that resampling method is </span></span>
<span id="cb782-19"><a href="machine-learning.html#cb782-19" tabindex="-1"></a>rf_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="do">## 10-fold CV</span></span>
<span id="cb782-20"><a href="machine-learning.html#cb782-20" tabindex="-1"></a>                           <span class="at">method =</span> <span class="st">&quot;cv&quot;</span>,</span>
<span id="cb782-21"><a href="machine-learning.html#cb782-21" tabindex="-1"></a>                           <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb782-22"><a href="machine-learning.html#cb782-22" tabindex="-1"></a></span>
<span id="cb782-23"><a href="machine-learning.html#cb782-23" tabindex="-1"></a><span class="co">#scaling data is performed here under preProcess</span></span>
<span id="cb782-24"><a href="machine-learning.html#cb782-24" tabindex="-1"></a><span class="co">#note that ranger handles the outcome variable as factor</span></span>
<span id="cb782-25"><a href="machine-learning.html#cb782-25" tabindex="-1"></a>rf <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(Class <span class="sc">~</span> ., </span>
<span id="cb782-26"><a href="machine-learning.html#cb782-26" tabindex="-1"></a>                    <span class="at">data =</span> Train, </span>
<span id="cb782-27"><a href="machine-learning.html#cb782-27" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">&quot;ranger&quot;</span>,</span>
<span id="cb782-28"><a href="machine-learning.html#cb782-28" tabindex="-1"></a>                 <span class="at">trControl=</span>rf_control,</span>
<span id="cb782-29"><a href="machine-learning.html#cb782-29" tabindex="-1"></a>                 <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">&quot;center&quot;</span>, <span class="st">&quot;scale&quot;</span>),</span>
<span id="cb782-30"><a href="machine-learning.html#cb782-30" tabindex="-1"></a>                 <span class="at">tuneLength =</span> <span class="dv">10</span>, <span class="at">verbose=</span>F)</span>
<span id="cb782-31"><a href="machine-learning.html#cb782-31" tabindex="-1"></a></span>
<span id="cb782-32"><a href="machine-learning.html#cb782-32" tabindex="-1"></a></span>
<span id="cb782-33"><a href="machine-learning.html#cb782-33" tabindex="-1"></a><span class="fu">summary</span>(rf)</span></code></pre></div>
<pre><code>##                           Length Class         Mode     
## predictions               525    factor        numeric  
## num.trees                   1    -none-        numeric  
## num.independent.variables   1    -none-        numeric  
## mtry                        1    -none-        numeric  
## min.node.size               1    -none-        numeric  
## prediction.error            1    -none-        numeric  
## forest                      9    ranger.forest list     
## confusion.matrix            4    table         numeric  
## splitrule                   1    -none-        character
## num.random.splits           1    -none-        numeric  
## treetype                    1    -none-        character
## call                        9    -none-        call     
## importance.mode             1    -none-        character
## num.samples                 1    -none-        numeric  
## replace                     1    -none-        logical  
## xNames                     71    -none-        character
## problemType                 1    -none-        character
## tuneValue                   3    data.frame    list     
## obsLevels                   2    -none-        character
## param                       1    -none-        list</code></pre>
<div class="sourceCode" id="cb784"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb784-1"><a href="machine-learning.html#cb784-1" tabindex="-1"></a>pred_rf<span class="ot">&lt;-</span><span class="fu">predict</span>(rf,BreastCancer)</span>
<span id="cb784-2"><a href="machine-learning.html#cb784-2" tabindex="-1"></a><span class="fu">confusionMatrix</span>(pred_rf, BreastCancer<span class="sc">$</span>Class)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    0    0
## [2,]    0  461</code></pre>
<div class="sourceCode" id="cb786"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb786-1"><a href="machine-learning.html#cb786-1" tabindex="-1"></a>roc_rf<span class="ot">&lt;-</span>pROC<span class="sc">::</span><span class="fu">roc</span>(BreastCancer<span class="sc">$</span>Class, <span class="fu">as.numeric</span>(pred_rf))</span></code></pre></div>
<pre><code>## Setting levels: control = benign, case = malignant</code></pre>
<pre><code>## Setting direction: controls &lt; cases</code></pre>
<div class="sourceCode" id="cb789"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb789-1"><a href="machine-learning.html#cb789-1" tabindex="-1"></a>roc_rf</span></code></pre></div>
<pre><code>## 
## Call:
## roc.default(response = BreastCancer$Class, predictor = as.numeric(pred_rf))
## 
## Data: as.numeric(pred_rf) in 458 controls (BreastCancer$Class benign) &lt; 241 cases (BreastCancer$Class malignant).
## Area under the curve: 0.9843</code></pre>
</div>
<div id="random-survival-forest-with-rfsrc" class="section level4 hasAnchor" number="6.2.1.2">
<h4><span class="header-section-number">6.2.1.2</span> Random survival forest with rfsrc<a href="machine-learning.html#random-survival-forest-with-rfsrc" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Random survival forest example is provided below using <em>rfsrc</em> library. The <em>survex</em> library is used for explanation on the model. This library is also available as a learner in the <em>mlr3verse</em>.</p>
<div class="sourceCode" id="cb791"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb791-1"><a href="machine-learning.html#cb791-1" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb791-2"><a href="machine-learning.html#cb791-2" tabindex="-1"></a><span class="fu">library</span>(survminer)</span>
<span id="cb791-3"><a href="machine-learning.html#cb791-3" tabindex="-1"></a><span class="fu">library</span>(randomForestSRC)</span>
<span id="cb791-4"><a href="machine-learning.html#cb791-4" tabindex="-1"></a><span class="fu">library</span>(survex)</span>
<span id="cb791-5"><a href="machine-learning.html#cb791-5" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb791-6"><a href="machine-learning.html#cb791-6" tabindex="-1"></a><span class="co">#data from survival package on NCCTG lung cancer trial</span></span>
<span id="cb791-7"><a href="machine-learning.html#cb791-7" tabindex="-1"></a><span class="co">#https://stat.ethz.ch/R-manual/R-devel/library/survival/html/lung.html</span></span>
<span id="cb791-8"><a href="machine-learning.html#cb791-8" tabindex="-1"></a><span class="fu">data</span>(cancer, <span class="at">package=</span><span class="st">&quot;survival&quot;</span>)</span>
<span id="cb791-9"><a href="machine-learning.html#cb791-9" tabindex="-1"></a></span>
<span id="cb791-10"><a href="machine-learning.html#cb791-10" tabindex="-1"></a><span class="co">#time in days</span></span>
<span id="cb791-11"><a href="machine-learning.html#cb791-11" tabindex="-1"></a><span class="co">#status censored=1, dead=2</span></span>
<span id="cb791-12"><a href="machine-learning.html#cb791-12" tabindex="-1"></a><span class="co">#sex:Male=1 Female=2</span></span>
<span id="cb791-13"><a href="machine-learning.html#cb791-13" tabindex="-1"></a></span>
<span id="cb791-14"><a href="machine-learning.html#cb791-14" tabindex="-1"></a>cancer2<span class="ot">&lt;-</span> cancer <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb791-15"><a href="machine-learning.html#cb791-15" tabindex="-1"></a>  <span class="at">status=</span><span class="fu">ifelse</span>(status<span class="sc">==</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb791-16"><a href="machine-learning.html#cb791-16" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Dead=</span>status, <span class="at">Days=</span>time)</span>
<span id="cb791-17"><a href="machine-learning.html#cb791-17" tabindex="-1"></a></span>
<span id="cb791-18"><a href="machine-learning.html#cb791-18" tabindex="-1"></a>time<span class="ot">=</span>cancer2<span class="sc">$</span>Days</span>
<span id="cb791-19"><a href="machine-learning.html#cb791-19" tabindex="-1"></a>status<span class="ot">=</span>cancer2<span class="sc">$</span>Dead</span>
<span id="cb791-20"><a href="machine-learning.html#cb791-20" tabindex="-1"></a></span>
<span id="cb791-21"><a href="machine-learning.html#cb791-21" tabindex="-1"></a>RF<span class="ot">&lt;-</span> <span class="fu">rfsrc</span>(<span class="fu">Surv</span>(Days, Dead) <span class="sc">~</span> age<span class="sc">+</span>sex<span class="sc">+</span>ph.ecog<span class="sc">+</span>ph.karno<span class="sc">+</span>wt.loss, <span class="at">data =</span> cancer2)</span>
<span id="cb791-22"><a href="machine-learning.html#cb791-22" tabindex="-1"></a></span>
<span id="cb791-23"><a href="machine-learning.html#cb791-23" tabindex="-1"></a><span class="co">#specify library to avoid confusion with dplyr</span></span>
<span id="cb791-24"><a href="machine-learning.html#cb791-24" tabindex="-1"></a>explainer<span class="ot">&lt;-</span>survex<span class="sc">::</span><span class="fu">explain</span>(RF)</span></code></pre></div>
<pre><code>## Preparation of a new explainer is initiated 
##   -&gt; model label       :  rfsrc ( [33m default [39m ) 
##   -&gt; data              :  213  rows  5  cols (  extracted from the model  ) 
##   -&gt; target variable   :  213  values ( 151 events and 62 censored , censoring rate = 0.291 ) (  extracted from the model  ) 
##   -&gt; times             :  50 unique time points , min = 5 , mean = 304.1224 , median = 263.16 , max = 835.44 
##   -&gt; times             :  (  generated from y as 50 time points being consecutive quantiles (0.00, 0.02, ..., 0.98)  ) 
##   -&gt; predict function  :  sum over the predict_cumulative_hazard_function will be used ( [33m default [39m ) 
##   -&gt; predict survival function  :  stepfun based on predict.rfsrc()$survival will be used ( [33m default [39m ) 
##   -&gt; predict cumulative hazard function  :  stepfun based on predict.rfsrc()$chf will be used ( [33m default [39m ) 
##   -&gt; model_info        :  package randomForestSRC , ver. 3.2.2 , task survival ( [33m default [39m ) 
##   A new explainer has been created!</code></pre>
<p>Plot a single tree from the random survival forest model.</p>
<div class="sourceCode" id="cb793"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb793-1"><a href="machine-learning.html#cb793-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">get.tree</span>(RF,<span class="dv">4</span>))</span></code></pre></div>
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-932d856afa6b4a5b01a4" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-932d856afa6b4a5b01a4">{"x":{"diagram":"digraph {\n\n\n\n\n  \"1\" [label = \"ph.karno\", color = \"black\", fontcolor = \"black\", penwidth = \"3\", style = \"\", shape = \"\", fontname = \"\", tooltip = \"\", fillcolor = \"\"] \n  \"2\" [label = \"age\", color = \"black\", fontcolor = \"black\", penwidth = \"3\", style = \"\", shape = \"\", fontname = \"\", tooltip = \"\", fillcolor = \"\"] \n  \"3\" [label = \"n=1\n105\", color = \"black\", fontcolor = \"black\", penwidth = \"3\", style = \"filled,rounded\", shape = \"box\", fontname = \"helvetica\", tooltip = \"- split: <=40.0000000149012\n- split.pretty: <=40\", fillcolor = \"GreenYellow\"] \n  \"4\" [label = \"ph.ecog\", color = \"black\", fontcolor = \"black\", penwidth = \"3\", style = \"\", shape = \"\", fontname = \"\", tooltip = \"\", fillcolor = \"\"] \n  \"5\" [label = \"sex\", color = \"black\", fontcolor = \"black\", penwidth = \"3\", style = \"\", shape = \"\", fontname = \"\", tooltip = \"\", fillcolor = \"\"] \n  \"6\" [label = \"n=28\n112.34\", color = \"black\", fontcolor = \"black\", penwidth = \"3\", style = \"filled,rounded\", shape = \"box\", fontname = \"helvetica\", tooltip = \"- split: <=1.00000001490116\n- split.pretty: <=1\", fillcolor = \"GreenYellow\"] \n  \"7\" [label = \"n=19\n50.95\", color = \"black\", fontcolor = \"black\", penwidth = \"3\", style = \"filled,rounded\", shape = \"box\", fontname = \"helvetica\", tooltip = \"- split: >1.00000001490116\n- split.pretty: \", fillcolor = \"GreenYellow\"] \n  \"8\" [label = \"n=26\n142.69\", color = \"black\", fontcolor = \"black\", penwidth = \"3\", style = \"filled,rounded\", shape = \"box\", fontname = \"helvetica\", tooltip = \"- split: >1.00000001490116\n- split.pretty: \", fillcolor = \"GreenYellow\"] \n  \"9\" [label = \"sex\", color = \"black\", fontcolor = \"black\", penwidth = \"3\", style = \"\", shape = \"\", fontname = \"\", tooltip = \"\", fillcolor = \"\"] \n  \"10\" [label = \"wt.loss\", color = \"black\", fontcolor = \"black\", penwidth = \"3\", style = \"\", shape = \"\", fontname = \"\", tooltip = \"\", fillcolor = \"\"] \n  \"11\" [label = \"wt.loss\", color = \"black\", fontcolor = \"black\", penwidth = \"3\", style = \"\", shape = \"\", fontname = \"\", tooltip = \"\", fillcolor = \"\"] \n  \"12\" [label = \"n=5\n19.5\", color = \"black\", fontcolor = \"black\", penwidth = \"3\", style = \"filled,rounded\", shape = \"box\", fontname = \"helvetica\", tooltip = \"- split: <=-0.999999985098839\n- split.pretty: <=-1\", fillcolor = \"GreenYellow\"] \n  \"13\" [label = \"n=29\n88.81\", color = \"black\", fontcolor = \"black\", penwidth = \"3\", style = \"filled,rounded\", shape = \"box\", fontname = \"helvetica\", tooltip = \"- split: >-0.999999985098839\n- split.pretty: \", fillcolor = \"GreenYellow\"] \n  \"14\" [label = \"n=4\n122.75\", color = \"black\", fontcolor = \"black\", penwidth = \"3\", style = \"filled,rounded\", shape = \"box\", fontname = \"helvetica\", tooltip = \"- split: >17.0000000149012\n- split.pretty: \", fillcolor = \"GreenYellow\"] \n  \"15\" [label = \"n=23\n41.82\", color = \"black\", fontcolor = \"black\", penwidth = \"3\", style = \"filled,rounded\", shape = \"box\", fontname = \"helvetica\", tooltip = \"- split: >1.00000001490116\n- split.pretty: \", fillcolor = \"GreenYellow\"] \n\"1\"->\"2\" [color = \"black\", label = \"<=80\", fontcolor = \"black\", fontcolor = \"black\"] \n\"1\"->\"9\" [color = \"black\", color = \"black\", fontcolor = \"black\", fontcolor = \"black\"] \n\"2\"->\"3\" [color = \"grey35\", label = \"<=40\", fontcolor = \"black\", arrowhead = \"vee\", penwidth = \"3\"] \n\"2\"->\"4\" [color = \"black\", color = \"black\", fontcolor = \"black\", fontcolor = \"black\"] \n\"9\"->\"10\" [color = \"black\", label = \"<=1\", fontcolor = \"black\", fontcolor = \"black\"] \n\"9\"->\"15\" [color = \"grey35\", color = \"grey35\", fontcolor = \"black\", arrowhead = \"vee\", penwidth = \"3\"] \n\"4\"->\"5\" [color = \"black\", label = \"<=1\", fontcolor = \"black\", fontcolor = \"black\"] \n\"4\"->\"8\" [color = \"grey35\", color = \"grey35\", fontcolor = \"black\", arrowhead = \"vee\", penwidth = \"3\"] \n\"10\"->\"11\" [color = \"black\", label = \"<=17\", fontcolor = \"black\", fontcolor = \"black\"] \n\"10\"->\"14\" [color = \"grey35\", color = \"grey35\", fontcolor = \"black\", arrowhead = \"vee\", penwidth = \"3\"] \n\"5\"->\"6\" [color = \"grey35\", label = \"<=1\", fontcolor = \"black\", arrowhead = \"vee\", penwidth = \"3\"] \n\"5\"->\"7\" [color = \"grey35\", color = \"grey35\", fontcolor = \"black\", arrowhead = \"vee\", penwidth = \"3\"] \n\"11\"->\"12\" [color = \"grey35\", label = \"<=-1\", fontcolor = \"black\", arrowhead = \"vee\", penwidth = \"3\"] \n\"11\"->\"13\" [color = \"grey35\", color = \"grey35\", fontcolor = \"black\", arrowhead = \"vee\", penwidth = \"3\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<p>Dynamic AUC</p>
<div class="sourceCode" id="cb794"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb794-1"><a href="machine-learning.html#cb794-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> explainer<span class="sc">$</span>y</span>
<span id="cb794-2"><a href="machine-learning.html#cb794-2" tabindex="-1"></a>times <span class="ot">&lt;-</span> explainer<span class="sc">$</span>times</span>
<span id="cb794-3"><a href="machine-learning.html#cb794-3" tabindex="-1"></a></span>
<span id="cb794-4"><a href="machine-learning.html#cb794-4" tabindex="-1"></a>surv <span class="ot">&lt;-</span> explainer<span class="sc">$</span><span class="fu">predict_survival_function</span>(RF, explainer<span class="sc">$</span>data, times)</span>
<span id="cb794-5"><a href="machine-learning.html#cb794-5" tabindex="-1"></a></span>
<span id="cb794-6"><a href="machine-learning.html#cb794-6" tabindex="-1"></a><span class="fu">cd_auc</span>(y, <span class="at">surv =</span> surv, <span class="at">times =</span> times)</span></code></pre></div>
<pre><code>##  [1] 1.0000000 0.9307568 0.9112200 0.9096154 0.8829532 0.8786292 0.8560335 0.8517304
##  [9] 0.8459069 0.8241969 0.8231190 0.8146465 0.7873396 0.7604641 0.7722174 0.7696099
## [17] 0.7667343 0.7605675 0.7514324 0.7500935 0.7638787 0.7621149 0.7673878 0.7606034
## [25] 0.7352058 0.7093474 0.7040276 0.7112689 0.7135705 0.7084011 0.7085640 0.7135241
## [33] 0.7028266 0.6921722 0.6955375 0.7029153 0.6907407 0.6919927 0.7015251 0.7019995
## [41] 0.7273598 0.7425582 0.7499178 0.7495446 0.7548334 0.7822465 0.8160264 0.8361538
## [49] 0.8801743 0.9048077</code></pre>
<p>Plot variable importance for random survival forest using permutation of features and measure impact on Brier score.</p>
<div class="sourceCode" id="cb796"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb796-1"><a href="machine-learning.html#cb796-1" tabindex="-1"></a>ModelRF<span class="ot">&lt;-</span>survex<span class="sc">::</span><span class="fu">model_parts</span>(explainer)</span>
<span id="cb796-2"><a href="machine-learning.html#cb796-2" tabindex="-1"></a></span>
<span id="cb796-3"><a href="machine-learning.html#cb796-3" tabindex="-1"></a></span>
<span id="cb796-4"><a href="machine-learning.html#cb796-4" tabindex="-1"></a><span class="fu">plot</span>(ModelRF)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-3-4-1.png" width="672" /></p>
<p>Plot partial dependence</p>
<div class="sourceCode" id="cb797"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb797-1"><a href="machine-learning.html#cb797-1" tabindex="-1"></a>Model_PD<span class="ot">&lt;-</span><span class="fu">model_profile</span>(explainer)</span></code></pre></div>
<pre><code>## Registered S3 method overwritten by &#39;ingredients&#39;:
##   method                            from  
##   plot.feature_importance_explainer survex</code></pre>
<div class="sourceCode" id="cb799"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb799-1"><a href="machine-learning.html#cb799-1" tabindex="-1"></a><span class="fu">plot</span>(Model_PD)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-3-5-1.png" width="672" /></p>
</div>
<div id="random-survival-forest-with-ranger" class="section level4 hasAnchor" number="6.2.1.3">
<h4><span class="header-section-number">6.2.1.3</span> Random survival forest with ranger<a href="machine-learning.html#random-survival-forest-with-ranger" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Random forest can be used for performing survival analysis using <em>ranger</em>, <em>randomforestSRC</em>. The example below is an example using the lung cancer trial.</p>
<div class="sourceCode" id="cb800"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb800-1"><a href="machine-learning.html#cb800-1" tabindex="-1"></a><span class="co">#data from survival package on NCCTG lung cancer trial</span></span>
<span id="cb800-2"><a href="machine-learning.html#cb800-2" tabindex="-1"></a><span class="co">#https://stat.ethz.ch/R-manual/R-devel/library/survival/html/lung.html</span></span>
<span id="cb800-3"><a href="machine-learning.html#cb800-3" tabindex="-1"></a><span class="fu">data</span>(cancer, <span class="at">package=</span><span class="st">&quot;survival&quot;</span>)</span>
<span id="cb800-4"><a href="machine-learning.html#cb800-4" tabindex="-1"></a></span>
<span id="cb800-5"><a href="machine-learning.html#cb800-5" tabindex="-1"></a><span class="co">#time in days</span></span>
<span id="cb800-6"><a href="machine-learning.html#cb800-6" tabindex="-1"></a><span class="co">#status censored=1, dead=2</span></span>
<span id="cb800-7"><a href="machine-learning.html#cb800-7" tabindex="-1"></a><span class="co">#sex:Male=1 Female=2</span></span>
<span id="cb800-8"><a href="machine-learning.html#cb800-8" tabindex="-1"></a></span>
<span id="cb800-9"><a href="machine-learning.html#cb800-9" tabindex="-1"></a><span class="fu">library</span>(ranger)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;ranger&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:rattle&#39;:
## 
##     importance</code></pre>
<div class="sourceCode" id="cb803"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb803-1"><a href="machine-learning.html#cb803-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb803-2"><a href="machine-learning.html#cb803-2" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb803-3"><a href="machine-learning.html#cb803-3" tabindex="-1"></a></span>
<span id="cb803-4"><a href="machine-learning.html#cb803-4" tabindex="-1"></a>cancer2<span class="ot">&lt;-</span>cancer <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(time, status, age,sex, ph.ecog) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>()  </span>
<span id="cb803-5"><a href="machine-learning.html#cb803-5" tabindex="-1"></a></span>
<span id="cb803-6"><a href="machine-learning.html#cb803-6" tabindex="-1"></a>survival_formula<span class="ot">&lt;-</span><span class="fu">formula</span>(<span class="fu">paste</span>(<span class="st">&#39;Surv(&#39;</span>, <span class="st">&#39;time&#39;</span>, <span class="st">&#39;,&#39;</span>, <span class="st">&#39;status&#39;</span>, <span class="st">&#39;) ~ &#39;</span>,<span class="st">&#39;age+sex+ph.ecog&#39;</span>))</span>
<span id="cb803-7"><a href="machine-learning.html#cb803-7" tabindex="-1"></a>  </span>
<span id="cb803-8"><a href="machine-learning.html#cb803-8" tabindex="-1"></a>survival_forest <span class="ot">&lt;-</span> <span class="fu">ranger</span>(survival_formula,</span>
<span id="cb803-9"><a href="machine-learning.html#cb803-9" tabindex="-1"></a>                         <span class="at">data =</span> cancer2,  </span>
<span id="cb803-10"><a href="machine-learning.html#cb803-10" tabindex="-1"></a>                         <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb803-11"><a href="machine-learning.html#cb803-11" tabindex="-1"></a>                         <span class="at">importance =</span> <span class="st">&#39;permutation&#39;</span>,</span>
<span id="cb803-12"><a href="machine-learning.html#cb803-12" tabindex="-1"></a>                         <span class="at">mtry =</span> <span class="dv">2</span>,</span>
<span id="cb803-13"><a href="machine-learning.html#cb803-13" tabindex="-1"></a>                         <span class="at">verbose =</span> <span class="cn">TRUE</span>,</span>
<span id="cb803-14"><a href="machine-learning.html#cb803-14" tabindex="-1"></a>                         <span class="at">num.trees =</span> <span class="dv">200</span>,</span>
<span id="cb803-15"><a href="machine-learning.html#cb803-15" tabindex="-1"></a>                         <span class="at">write.forest=</span><span class="cn">TRUE</span>)</span>
<span id="cb803-16"><a href="machine-learning.html#cb803-16" tabindex="-1"></a></span>
<span id="cb803-17"><a href="machine-learning.html#cb803-17" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;error:&quot;</span>); <span class="fu">print</span>(survival_forest<span class="sc">$</span>prediction.error)</span></code></pre></div>
<pre><code>## [1] &quot;error:&quot;</code></pre>
<pre><code>## [1] 0.391924</code></pre>
<p>Print variable importance</p>
<div class="sourceCode" id="cb806"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb806-1"><a href="machine-learning.html#cb806-1" tabindex="-1"></a><span class="fu">sort</span>(survival_forest<span class="sc">$</span>variable.importance)</span></code></pre></div>
<pre><code>##         age         sex     ph.ecog 
## 0.008386083 0.030801816 0.065970251</code></pre>
<p>Probability of survival</p>
<div class="sourceCode" id="cb808"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb808-1"><a href="machine-learning.html#cb808-1" tabindex="-1"></a><span class="fu">plot</span>(survival_forest<span class="sc">$</span>unique.death.times, survival_forest<span class="sc">$</span>survival[<span class="dv">1</span>,], <span class="at">type=</span><span class="st">&#39;l&#39;</span>, <span class="at">col=</span><span class="st">&#39;orange&#39;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="dv">1</span>))</span>
<span id="cb808-2"><a href="machine-learning.html#cb808-2" tabindex="-1"></a><span class="fu">lines</span>(survival_forest<span class="sc">$</span>unique.death.times, survival_forest<span class="sc">$</span>survival[<span class="dv">56</span>,], <span class="at">col=</span><span class="st">&#39;blue&#39;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-3-8-1.png" width="672" /></p>
<div class="sourceCode" id="cb809"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb809-1"><a href="machine-learning.html#cb809-1" tabindex="-1"></a><span class="fu">plot</span>(survival_forest<span class="sc">$</span>unique.death.times, survival_forest<span class="sc">$</span>survival[<span class="dv">1</span>,], <span class="at">type=</span><span class="st">&#39;l&#39;</span>, <span class="at">col=</span><span class="st">&#39;orange&#39;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="dv">1</span>))</span>
<span id="cb809-2"><a href="machine-learning.html#cb809-2" tabindex="-1"></a><span class="cf">for</span> (x <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">100</span>)) {</span>
<span id="cb809-3"><a href="machine-learning.html#cb809-3" tabindex="-1"></a>  <span class="fu">lines</span>(survival_forest<span class="sc">$</span>unique.death.times, survival_forest<span class="sc">$</span>survival[x,], <span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span>
<span id="cb809-4"><a href="machine-learning.html#cb809-4" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-3-9-1.png" width="672" /></p>
</div>
</div>
<div id="boosting-trees" class="section level3 hasAnchor" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> Boosting trees<a href="machine-learning.html#boosting-trees" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="gradient-boost-machine" class="section level4 hasAnchor" number="6.2.2.1">
<h4><span class="header-section-number">6.2.2.1</span> Gradient Boost Machine<a href="machine-learning.html#gradient-boost-machine" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Gradient boost machine is available as <em>gradient boost machine_gbm</em>.</p>
<div class="sourceCode" id="cb810"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb810-1"><a href="machine-learning.html#cb810-1" tabindex="-1"></a><span class="co">#the breast cancer data from random forest is used here</span></span>
<span id="cb810-2"><a href="machine-learning.html#cb810-2" tabindex="-1"></a></span>
<span id="cb810-3"><a href="machine-learning.html#cb810-3" tabindex="-1"></a><span class="co"># specify that the resampling method is </span></span>
<span id="cb810-4"><a href="machine-learning.html#cb810-4" tabindex="-1"></a>gbm_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="do">## 10-fold CV</span></span>
<span id="cb810-5"><a href="machine-learning.html#cb810-5" tabindex="-1"></a>                           <span class="at">method =</span> <span class="st">&quot;repeatedcv&quot;</span>,</span>
<span id="cb810-6"><a href="machine-learning.html#cb810-6" tabindex="-1"></a>                           <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb810-7"><a href="machine-learning.html#cb810-7" tabindex="-1"></a></span>
<span id="cb810-8"><a href="machine-learning.html#cb810-8" tabindex="-1"></a><span class="co">#scaling data is performed here under preProcess</span></span>
<span id="cb810-9"><a href="machine-learning.html#cb810-9" tabindex="-1"></a><span class="co">#note that ranger handles the outcome variable as factor</span></span>
<span id="cb810-10"><a href="machine-learning.html#cb810-10" tabindex="-1"></a>gbm <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(Class <span class="sc">~</span> ., </span>
<span id="cb810-11"><a href="machine-learning.html#cb810-11" tabindex="-1"></a>                    <span class="at">data =</span> Train, </span>
<span id="cb810-12"><a href="machine-learning.html#cb810-12" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">&quot;gbm&quot;</span>,</span>
<span id="cb810-13"><a href="machine-learning.html#cb810-13" tabindex="-1"></a>                 <span class="at">trControl=</span>gbm_control,</span>
<span id="cb810-14"><a href="machine-learning.html#cb810-14" tabindex="-1"></a>                 <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">&quot;center&quot;</span>, <span class="st">&quot;scale&quot;</span>),</span>
<span id="cb810-15"><a href="machine-learning.html#cb810-15" tabindex="-1"></a>                 <span class="at">tuneLength =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1427             nan     0.1000    0.0725
##      2        1.0265             nan     0.1000    0.0564
##      3        0.9280             nan     0.1000    0.0462
##      4        0.8512             nan     0.1000    0.0377
##      5        0.7835             nan     0.1000    0.0319
##      6        0.7269             nan     0.1000    0.0280
##      7        0.6797             nan     0.1000    0.0211
##      8        0.6261             nan     0.1000    0.0225
##      9        0.5811             nan     0.1000    0.0192
##     10        0.5462             nan     0.1000    0.0161
##     20        0.3514             nan     0.1000    0.0047
##     40        0.2348             nan     0.1000    0.0009
##     60        0.1887             nan     0.1000   -0.0002
##     80        0.1648             nan     0.1000   -0.0007
##    100        0.1492             nan     0.1000   -0.0017
##    120        0.1416             nan     0.1000   -0.0002
##    140        0.1289             nan     0.1000   -0.0007
##    160        0.1239             nan     0.1000   -0.0007
##    180        0.1199             nan     0.1000   -0.0006
##    200        0.1155             nan     0.1000   -0.0004
##    220        0.1131             nan     0.1000   -0.0015
##    240        0.1085             nan     0.1000   -0.0005
##    260        0.1074             nan     0.1000   -0.0009
##    280        0.1013             nan     0.1000    0.0001
##    300        0.1001             nan     0.1000   -0.0007
##    320        0.0970             nan     0.1000   -0.0008
##    340        0.0940             nan     0.1000   -0.0004
##    360        0.0940             nan     0.1000   -0.0012
##    380        0.0926             nan     0.1000   -0.0005
##    400        0.0902             nan     0.1000   -0.0008
##    420        0.0885             nan     0.1000   -0.0012
##    440        0.0871             nan     0.1000   -0.0004
##    460        0.0859             nan     0.1000   -0.0010
##    480        0.0848             nan     0.1000   -0.0008
##    500        0.0839             nan     0.1000   -0.0006
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1404             nan     0.1000    0.0706
##      2        1.0186             nan     0.1000    0.0602
##      3        0.9203             nan     0.1000    0.0470
##      4        0.8335             nan     0.1000    0.0422
##      5        0.7527             nan     0.1000    0.0384
##      6        0.6890             nan     0.1000    0.0303
##      7        0.6323             nan     0.1000    0.0267
##      8        0.5864             nan     0.1000    0.0216
##      9        0.5459             nan     0.1000    0.0175
##     10        0.5093             nan     0.1000    0.0178
##     20        0.2971             nan     0.1000    0.0053
##     40        0.1873             nan     0.1000    0.0010
##     60        0.1372             nan     0.1000   -0.0002
##     80        0.1117             nan     0.1000   -0.0006
##    100        0.0929             nan     0.1000   -0.0014
##    120        0.0825             nan     0.1000   -0.0004
##    140        0.0723             nan     0.1000   -0.0007
##    160        0.0657             nan     0.1000   -0.0009
##    180        0.0592             nan     0.1000   -0.0009
##    200        0.0534             nan     0.1000   -0.0004
##    220        0.0501             nan     0.1000   -0.0006
##    240        0.0432             nan     0.1000   -0.0005
##    260        0.0409             nan     0.1000   -0.0005
##    280        0.0358             nan     0.1000   -0.0004
##    300        0.0338             nan     0.1000   -0.0001
##    320        0.0310             nan     0.1000   -0.0004
##    340        0.0285             nan     0.1000   -0.0001
##    360        0.0256             nan     0.1000   -0.0000
##    380        0.0230             nan     0.1000   -0.0002
##    400        0.0207             nan     0.1000   -0.0001
##    420        0.0185             nan     0.1000   -0.0002
##    440        0.0173             nan     0.1000   -0.0002
##    460        0.0153             nan     0.1000   -0.0002
##    480        0.0139             nan     0.1000   -0.0002
##    500        0.0126             nan     0.1000   -0.0002
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1317             nan     0.1000    0.0753
##      2        1.0143             nan     0.1000    0.0530
##      3        0.9039             nan     0.1000    0.0534
##      4        0.8172             nan     0.1000    0.0429
##      5        0.7454             nan     0.1000    0.0339
##      6        0.6799             nan     0.1000    0.0335
##      7        0.6212             nan     0.1000    0.0261
##      8        0.5719             nan     0.1000    0.0244
##      9        0.5298             nan     0.1000    0.0205
##     10        0.4910             nan     0.1000    0.0179
##     20        0.2803             nan     0.1000    0.0041
##     40        0.1490             nan     0.1000   -0.0011
##     60        0.1038             nan     0.1000   -0.0008
##     80        0.0793             nan     0.1000   -0.0004
##    100        0.0626             nan     0.1000   -0.0004
##    120        0.0511             nan     0.1000   -0.0009
##    140        0.0421             nan     0.1000   -0.0004
##    160        0.0342             nan     0.1000   -0.0006
##    180        0.0305             nan     0.1000   -0.0004
##    200        0.0256             nan     0.1000   -0.0002
##    220        0.0210             nan     0.1000   -0.0000
##    240        0.0173             nan     0.1000   -0.0001
##    260        0.0150             nan     0.1000   -0.0001
##    280        0.0122             nan     0.1000   -0.0001
##    300        0.0108             nan     0.1000   -0.0002
##    320        0.0090             nan     0.1000   -0.0000
##    340        0.0083             nan     0.1000   -0.0001
##    360        0.0073             nan     0.1000   -0.0001
##    380        0.0060             nan     0.1000   -0.0001
##    400        0.0051             nan     0.1000   -0.0001
##    420        0.0044             nan     0.1000   -0.0000
##    440        0.0038             nan     0.1000   -0.0000
##    460        0.0033             nan     0.1000   -0.0000
##    480        0.0029             nan     0.1000   -0.0000
##    500        0.0024             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1353             nan     0.1000    0.0720
##      2        1.0104             nan     0.1000    0.0585
##      3        0.9082             nan     0.1000    0.0494
##      4        0.8160             nan     0.1000    0.0445
##      5        0.7366             nan     0.1000    0.0358
##      6        0.6760             nan     0.1000    0.0278
##      7        0.6191             nan     0.1000    0.0264
##      8        0.5679             nan     0.1000    0.0237
##      9        0.5251             nan     0.1000    0.0188
##     10        0.4870             nan     0.1000    0.0190
##     20        0.2760             nan     0.1000    0.0037
##     40        0.1335             nan     0.1000   -0.0004
##     60        0.0908             nan     0.1000   -0.0011
##     80        0.0640             nan     0.1000   -0.0009
##    100        0.0491             nan     0.1000   -0.0003
##    120        0.0382             nan     0.1000   -0.0003
##    140        0.0283             nan     0.1000   -0.0004
##    160        0.0213             nan     0.1000   -0.0002
##    180        0.0172             nan     0.1000    0.0000
##    200        0.0139             nan     0.1000   -0.0001
##    220        0.0114             nan     0.1000   -0.0002
##    240        0.0089             nan     0.1000   -0.0000
##    260        0.0071             nan     0.1000   -0.0001
##    280        0.0060             nan     0.1000   -0.0001
##    300        0.0048             nan     0.1000   -0.0001
##    320        0.0037             nan     0.1000   -0.0000
##    340        0.0029             nan     0.1000   -0.0000
##    360        0.0024             nan     0.1000   -0.0000
##    380        0.0020             nan     0.1000   -0.0001
##    400        0.0017             nan     0.1000   -0.0000
##    420        0.0014             nan     0.1000   -0.0000
##    440        0.0011             nan     0.1000   -0.0000
##    460        0.0009             nan     0.1000   -0.0000
##    480        0.0008             nan     0.1000   -0.0000
##    500        0.0006             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1263             nan     0.1000    0.0779
##      2        1.0050             nan     0.1000    0.0553
##      3        0.9025             nan     0.1000    0.0489
##      4        0.8142             nan     0.1000    0.0412
##      5        0.7407             nan     0.1000    0.0350
##      6        0.6754             nan     0.1000    0.0294
##      7        0.6170             nan     0.1000    0.0271
##      8        0.5667             nan     0.1000    0.0230
##      9        0.5237             nan     0.1000    0.0188
##     10        0.4848             nan     0.1000    0.0183
##     20        0.2694             nan     0.1000    0.0050
##     40        0.1239             nan     0.1000   -0.0009
##     60        0.0745             nan     0.1000   -0.0007
##     80        0.0505             nan     0.1000   -0.0004
##    100        0.0386             nan     0.1000   -0.0006
##    120        0.0289             nan     0.1000   -0.0006
##    140        0.0219             nan     0.1000   -0.0000
##    160        0.0175             nan     0.1000   -0.0004
##    180        0.0122             nan     0.1000   -0.0001
##    200        0.0090             nan     0.1000   -0.0001
##    220        0.0070             nan     0.1000    0.0000
##    240        0.0057             nan     0.1000   -0.0001
##    260        0.0043             nan     0.1000   -0.0001
##    280        0.0036             nan     0.1000   -0.0001
##    300        0.0025             nan     0.1000   -0.0000
##    320        0.0021             nan     0.1000   -0.0000
##    340        0.0019             nan     0.1000   -0.0001
##    360        0.0015             nan     0.1000   -0.0001
##    380        0.0011             nan     0.1000   -0.0000
##    400        0.0010             nan     0.1000   -0.0000
##    420        0.0008             nan     0.1000   -0.0000
##    440        0.0006             nan     0.1000    0.0000
##    460        0.0005             nan     0.1000   -0.0000
##    480        0.0005             nan     0.1000   -0.0000
##    500        0.0004             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1278             nan     0.1000    0.0764
##      2        1.0050             nan     0.1000    0.0633
##      3        0.9025             nan     0.1000    0.0509
##      4        0.8140             nan     0.1000    0.0421
##      5        0.7402             nan     0.1000    0.0339
##      6        0.6744             nan     0.1000    0.0312
##      7        0.6183             nan     0.1000    0.0251
##      8        0.5694             nan     0.1000    0.0216
##      9        0.5268             nan     0.1000    0.0180
##     10        0.4886             nan     0.1000    0.0174
##     20        0.2618             nan     0.1000    0.0054
##     40        0.1126             nan     0.1000   -0.0006
##     60        0.0650             nan     0.1000   -0.0005
##     80        0.0418             nan     0.1000   -0.0002
##    100        0.0305             nan     0.1000   -0.0006
##    120        0.0197             nan     0.1000   -0.0004
##    140        0.0148             nan     0.1000   -0.0002
##    160        0.0112             nan     0.1000   -0.0001
##    180        0.0080             nan     0.1000   -0.0001
##    200        0.0057             nan     0.1000   -0.0001
##    220        0.0047             nan     0.1000   -0.0001
##    240        0.0035             nan     0.1000   -0.0001
##    260        0.0024             nan     0.1000   -0.0000
##    280        0.0018             nan     0.1000    0.0000
##    300        0.0013             nan     0.1000   -0.0000
##    320        0.0010             nan     0.1000   -0.0000
##    340        0.0007             nan     0.1000   -0.0000
##    360        0.0006             nan     0.1000   -0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000    0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1250             nan     0.1000    0.0753
##      2        0.9960             nan     0.1000    0.0631
##      3        0.8924             nan     0.1000    0.0494
##      4        0.8091             nan     0.1000    0.0411
##      5        0.7351             nan     0.1000    0.0342
##      6        0.6707             nan     0.1000    0.0309
##      7        0.6129             nan     0.1000    0.0269
##      8        0.5629             nan     0.1000    0.0229
##      9        0.5179             nan     0.1000    0.0207
##     10        0.4805             nan     0.1000    0.0161
##     20        0.2540             nan     0.1000    0.0044
##     40        0.1119             nan     0.1000   -0.0003
##     60        0.0606             nan     0.1000   -0.0013
##     80        0.0402             nan     0.1000   -0.0008
##    100        0.0262             nan     0.1000   -0.0003
##    120        0.0165             nan     0.1000   -0.0003
##    140        0.0115             nan     0.1000   -0.0002
##    160        0.0074             nan     0.1000   -0.0001
##    180        0.0054             nan     0.1000   -0.0001
##    200        0.0041             nan     0.1000   -0.0001
##    220        0.0033             nan     0.1000   -0.0001
##    240        0.0026             nan     0.1000   -0.0000
##    260        0.0017             nan     0.1000   -0.0000
##    280        0.0012             nan     0.1000    0.0000
##    300        0.0009             nan     0.1000   -0.0000
##    320        0.0007             nan     0.1000   -0.0000
##    340        0.0005             nan     0.1000   -0.0000
##    360        0.0004             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0002             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000    0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1322             nan     0.1000    0.0773
##      2        1.0083             nan     0.1000    0.0644
##      3        0.9031             nan     0.1000    0.0521
##      4        0.8129             nan     0.1000    0.0427
##      5        0.7366             nan     0.1000    0.0359
##      6        0.6681             nan     0.1000    0.0318
##      7        0.6107             nan     0.1000    0.0254
##      8        0.5587             nan     0.1000    0.0240
##      9        0.5183             nan     0.1000    0.0177
##     10        0.4820             nan     0.1000    0.0155
##     20        0.2625             nan     0.1000    0.0036
##     40        0.1160             nan     0.1000    0.0000
##     60        0.0647             nan     0.1000   -0.0010
##     80        0.0391             nan     0.1000   -0.0010
##    100        0.0254             nan     0.1000   -0.0005
##    120        0.0179             nan     0.1000   -0.0003
##    140        0.0115             nan     0.1000   -0.0002
##    160        0.0085             nan     0.1000    0.0000
##    180        0.0068             nan     0.1000   -0.0002
##    200        0.0043             nan     0.1000   -0.0001
##    220        0.0036             nan     0.1000   -0.0002
##    240        0.0023             nan     0.1000   -0.0000
##    260        0.0017             nan     0.1000   -0.0000
##    280        0.0015             nan     0.1000   -0.0000
##    300        0.0013             nan     0.1000   -0.0001
##    320        0.0010             nan     0.1000   -0.0000
##    340        0.0008             nan     0.1000   -0.0000
##    360        0.0006             nan     0.1000    0.0000
##    380        0.0005             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0002             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1300             nan     0.1000    0.0741
##      2        1.0023             nan     0.1000    0.0610
##      3        0.8978             nan     0.1000    0.0495
##      4        0.8107             nan     0.1000    0.0434
##      5        0.7360             nan     0.1000    0.0348
##      6        0.6670             nan     0.1000    0.0315
##      7        0.6116             nan     0.1000    0.0256
##      8        0.5640             nan     0.1000    0.0211
##      9        0.5222             nan     0.1000    0.0192
##     10        0.4862             nan     0.1000    0.0161
##     20        0.2622             nan     0.1000    0.0043
##     40        0.1118             nan     0.1000   -0.0002
##     60        0.0655             nan     0.1000   -0.0012
##     80        0.0416             nan     0.1000   -0.0009
##    100        0.0246             nan     0.1000   -0.0006
##    120        0.0170             nan     0.1000   -0.0005
##    140        0.0114             nan     0.1000   -0.0001
##    160        0.0089             nan     0.1000   -0.0003
##    180        0.0063             nan     0.1000   -0.0003
##    200        0.0053             nan     0.1000   -0.0002
##    220        0.0035             nan     0.1000   -0.0000
##    240        0.0029             nan     0.1000   -0.0001
##    260        0.0025             nan     0.1000   -0.0001
##    280        0.0021             nan     0.1000   -0.0001
##    300        0.0015             nan     0.1000   -0.0001
##    320        0.0013             nan     0.1000   -0.0001
##    340        0.0009             nan     0.1000   -0.0000
##    360        0.0009             nan     0.1000   -0.0000
##    380        0.0007             nan     0.1000   -0.0000
##    400        0.0005             nan     0.1000   -0.0000
##    420        0.0004             nan     0.1000   -0.0000
##    440        0.0003             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0002             nan     0.1000    0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1290             nan     0.1000    0.0814
##      2        1.0029             nan     0.1000    0.0630
##      3        0.8975             nan     0.1000    0.0507
##      4        0.8085             nan     0.1000    0.0428
##      5        0.7330             nan     0.1000    0.0374
##      6        0.6735             nan     0.1000    0.0277
##      7        0.6214             nan     0.1000    0.0244
##      8        0.5721             nan     0.1000    0.0227
##      9        0.5293             nan     0.1000    0.0185
##     10        0.4898             nan     0.1000    0.0172
##     20        0.2701             nan     0.1000    0.0041
##     40        0.1231             nan     0.1000    0.0001
##     60        0.0643             nan     0.1000   -0.0006
##     80        0.0365             nan     0.1000   -0.0010
##    100        0.0260             nan     0.1000   -0.0003
##    120        0.0180             nan     0.1000   -0.0001
##    140        0.0123             nan     0.1000   -0.0001
##    160        0.0090             nan     0.1000   -0.0002
##    180        0.0074             nan     0.1000   -0.0003
##    200        0.0065             nan     0.1000   -0.0001
##    220        0.0041             nan     0.1000   -0.0001
##    240        0.0038             nan     0.1000   -0.0001
##    260        0.0027             nan     0.1000   -0.0000
##    280        0.0024             nan     0.1000   -0.0001
##    300        0.0019             nan     0.1000   -0.0001
##    320        0.0016             nan     0.1000   -0.0000
##    340        0.0011             nan     0.1000   -0.0000
##    360        0.0009             nan     0.1000   -0.0000
##    380        0.0008             nan     0.1000    0.0000
##    400        0.0007             nan     0.1000   -0.0000
##    420        0.0005             nan     0.1000   -0.0000
##    440        0.0005             nan     0.1000    0.0000
##    460        0.0004             nan     0.1000   -0.0000
##    480        0.0003             nan     0.1000   -0.0000
##    500        0.0002             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1580             nan     0.1000    0.0611
##      2        1.0377             nan     0.1000    0.0574
##      3        0.9452             nan     0.1000    0.0466
##      4        0.8664             nan     0.1000    0.0386
##      5        0.7939             nan     0.1000    0.0362
##      6        0.7283             nan     0.1000    0.0299
##      7        0.6776             nan     0.1000    0.0254
##      8        0.6344             nan     0.1000    0.0205
##      9        0.5950             nan     0.1000    0.0191
##     10        0.5567             nan     0.1000    0.0189
##     20        0.3469             nan     0.1000    0.0059
##     40        0.2207             nan     0.1000    0.0011
##     60        0.1758             nan     0.1000    0.0000
##     80        0.1545             nan     0.1000   -0.0008
##    100        0.1393             nan     0.1000   -0.0005
##    120        0.1251             nan     0.1000   -0.0004
##    140        0.1143             nan     0.1000   -0.0004
##    160        0.1082             nan     0.1000   -0.0011
##    180        0.1027             nan     0.1000   -0.0004
##    200        0.0993             nan     0.1000   -0.0007
##    220        0.0929             nan     0.1000   -0.0006
##    240        0.0911             nan     0.1000   -0.0007
##    260        0.0881             nan     0.1000   -0.0003
##    280        0.0848             nan     0.1000   -0.0003
##    300        0.0825             nan     0.1000   -0.0007
##    320        0.0813             nan     0.1000   -0.0007
##    340        0.0818             nan     0.1000   -0.0008
##    360        0.0789             nan     0.1000   -0.0006
##    380        0.0762             nan     0.1000   -0.0004
##    400        0.0743             nan     0.1000   -0.0004
##    420        0.0715             nan     0.1000   -0.0005
##    440        0.0707             nan     0.1000   -0.0003
##    460        0.0699             nan     0.1000   -0.0007
##    480        0.0671             nan     0.1000   -0.0007
##    500        0.0663             nan     0.1000   -0.0011
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1434             nan     0.1000    0.0754
##      2        1.0214             nan     0.1000    0.0553
##      3        0.9171             nan     0.1000    0.0528
##      4        0.8311             nan     0.1000    0.0430
##      5        0.7546             nan     0.1000    0.0369
##      6        0.6928             nan     0.1000    0.0298
##      7        0.6388             nan     0.1000    0.0265
##      8        0.5956             nan     0.1000    0.0201
##      9        0.5531             nan     0.1000    0.0191
##     10        0.5121             nan     0.1000    0.0177
##     20        0.2979             nan     0.1000    0.0071
##     40        0.1715             nan     0.1000   -0.0003
##     60        0.1296             nan     0.1000   -0.0004
##     80        0.1005             nan     0.1000   -0.0008
##    100        0.0831             nan     0.1000   -0.0011
##    120        0.0710             nan     0.1000   -0.0010
##    140        0.0625             nan     0.1000   -0.0002
##    160        0.0525             nan     0.1000   -0.0001
##    180        0.0466             nan     0.1000   -0.0004
##    200        0.0416             nan     0.1000   -0.0003
##    220        0.0377             nan     0.1000   -0.0001
##    240        0.0334             nan     0.1000   -0.0005
##    260        0.0292             nan     0.1000   -0.0000
##    280        0.0264             nan     0.1000   -0.0003
##    300        0.0244             nan     0.1000   -0.0003
##    320        0.0217             nan     0.1000   -0.0003
##    340        0.0192             nan     0.1000   -0.0001
##    360        0.0178             nan     0.1000   -0.0001
##    380        0.0163             nan     0.1000   -0.0001
##    400        0.0150             nan     0.1000   -0.0001
##    420        0.0136             nan     0.1000   -0.0001
##    440        0.0127             nan     0.1000   -0.0001
##    460        0.0114             nan     0.1000   -0.0001
##    480        0.0104             nan     0.1000   -0.0000
##    500        0.0094             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1385             nan     0.1000    0.0672
##      2        1.0083             nan     0.1000    0.0636
##      3        0.9009             nan     0.1000    0.0501
##      4        0.8127             nan     0.1000    0.0400
##      5        0.7386             nan     0.1000    0.0361
##      6        0.6771             nan     0.1000    0.0278
##      7        0.6206             nan     0.1000    0.0270
##      8        0.5651             nan     0.1000    0.0260
##      9        0.5235             nan     0.1000    0.0191
##     10        0.4884             nan     0.1000    0.0157
##     20        0.2743             nan     0.1000    0.0061
##     40        0.1431             nan     0.1000   -0.0017
##     60        0.0981             nan     0.1000   -0.0001
##     80        0.0772             nan     0.1000   -0.0006
##    100        0.0582             nan     0.1000   -0.0006
##    120        0.0462             nan     0.1000   -0.0005
##    140        0.0366             nan     0.1000   -0.0005
##    160        0.0302             nan     0.1000   -0.0003
##    180        0.0251             nan     0.1000   -0.0004
##    200        0.0211             nan     0.1000   -0.0001
##    220        0.0179             nan     0.1000   -0.0001
##    240        0.0158             nan     0.1000   -0.0002
##    260        0.0125             nan     0.1000   -0.0001
##    280        0.0104             nan     0.1000   -0.0001
##    300        0.0087             nan     0.1000   -0.0002
##    320        0.0076             nan     0.1000   -0.0000
##    340        0.0062             nan     0.1000   -0.0000
##    360        0.0051             nan     0.1000    0.0000
##    380        0.0044             nan     0.1000   -0.0000
##    400        0.0037             nan     0.1000   -0.0000
##    420        0.0031             nan     0.1000   -0.0000
##    440        0.0027             nan     0.1000   -0.0000
##    460        0.0023             nan     0.1000   -0.0000
##    480        0.0019             nan     0.1000   -0.0000
##    500        0.0016             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1259             nan     0.1000    0.0798
##      2        1.0046             nan     0.1000    0.0586
##      3        0.9048             nan     0.1000    0.0443
##      4        0.8163             nan     0.1000    0.0404
##      5        0.7430             nan     0.1000    0.0351
##      6        0.6765             nan     0.1000    0.0327
##      7        0.6222             nan     0.1000    0.0226
##      8        0.5747             nan     0.1000    0.0222
##      9        0.5300             nan     0.1000    0.0202
##     10        0.4897             nan     0.1000    0.0192
##     20        0.2680             nan     0.1000    0.0036
##     40        0.1345             nan     0.1000    0.0003
##     60        0.0871             nan     0.1000   -0.0004
##     80        0.0633             nan     0.1000   -0.0002
##    100        0.0474             nan     0.1000   -0.0003
##    120        0.0342             nan     0.1000   -0.0001
##    140        0.0270             nan     0.1000   -0.0003
##    160        0.0210             nan     0.1000   -0.0000
##    180        0.0152             nan     0.1000   -0.0001
##    200        0.0122             nan     0.1000   -0.0002
##    220        0.0101             nan     0.1000   -0.0001
##    240        0.0075             nan     0.1000   -0.0001
##    260        0.0058             nan     0.1000   -0.0000
##    280        0.0047             nan     0.1000   -0.0001
##    300        0.0038             nan     0.1000   -0.0000
##    320        0.0030             nan     0.1000   -0.0000
##    340        0.0025             nan     0.1000   -0.0000
##    360        0.0020             nan     0.1000   -0.0001
##    380        0.0016             nan     0.1000   -0.0000
##    400        0.0013             nan     0.1000   -0.0000
##    420        0.0010             nan     0.1000   -0.0000
##    440        0.0009             nan     0.1000   -0.0000
##    460        0.0006             nan     0.1000   -0.0000
##    480        0.0005             nan     0.1000   -0.0000
##    500        0.0004             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1225             nan     0.1000    0.0872
##      2        0.9954             nan     0.1000    0.0610
##      3        0.8951             nan     0.1000    0.0487
##      4        0.8114             nan     0.1000    0.0412
##      5        0.7393             nan     0.1000    0.0336
##      6        0.6786             nan     0.1000    0.0281
##      7        0.6211             nan     0.1000    0.0256
##      8        0.5740             nan     0.1000    0.0202
##      9        0.5319             nan     0.1000    0.0186
##     10        0.4951             nan     0.1000    0.0153
##     20        0.2632             nan     0.1000    0.0040
##     40        0.1170             nan     0.1000   -0.0004
##     60        0.0701             nan     0.1000   -0.0001
##     80        0.0441             nan     0.1000   -0.0002
##    100        0.0303             nan     0.1000    0.0001
##    120        0.0217             nan     0.1000   -0.0002
##    140        0.0148             nan     0.1000   -0.0002
##    160        0.0104             nan     0.1000   -0.0001
##    180        0.0076             nan     0.1000   -0.0000
##    200        0.0059             nan     0.1000   -0.0001
##    220        0.0044             nan     0.1000   -0.0000
##    240        0.0034             nan     0.1000   -0.0001
##    260        0.0024             nan     0.1000   -0.0000
##    280        0.0019             nan     0.1000   -0.0000
##    300        0.0014             nan     0.1000   -0.0000
##    320        0.0010             nan     0.1000   -0.0000
##    340        0.0008             nan     0.1000   -0.0000
##    360        0.0006             nan     0.1000   -0.0000
##    380        0.0005             nan     0.1000   -0.0000
##    400        0.0004             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000    0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1352             nan     0.1000    0.0697
##      2        1.0150             nan     0.1000    0.0587
##      3        0.9080             nan     0.1000    0.0514
##      4        0.8184             nan     0.1000    0.0400
##      5        0.7429             nan     0.1000    0.0372
##      6        0.6776             nan     0.1000    0.0303
##      7        0.6209             nan     0.1000    0.0270
##      8        0.5715             nan     0.1000    0.0232
##      9        0.5285             nan     0.1000    0.0201
##     10        0.4902             nan     0.1000    0.0161
##     20        0.2575             nan     0.1000    0.0046
##     40        0.1136             nan     0.1000    0.0002
##     60        0.0683             nan     0.1000   -0.0020
##     80        0.0425             nan     0.1000   -0.0002
##    100        0.0296             nan     0.1000   -0.0003
##    120        0.0201             nan     0.1000   -0.0002
##    140        0.0134             nan     0.1000   -0.0001
##    160        0.0097             nan     0.1000   -0.0001
##    180        0.0067             nan     0.1000   -0.0000
##    200        0.0045             nan     0.1000   -0.0000
##    220        0.0036             nan     0.1000   -0.0001
##    240        0.0024             nan     0.1000    0.0000
##    260        0.0019             nan     0.1000   -0.0000
##    280        0.0015             nan     0.1000   -0.0000
##    300        0.0012             nan     0.1000   -0.0000
##    320        0.0008             nan     0.1000   -0.0000
##    340        0.0006             nan     0.1000   -0.0000
##    360        0.0005             nan     0.1000   -0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000    0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1333             nan     0.1000    0.0754
##      2        1.0020             nan     0.1000    0.0638
##      3        0.8969             nan     0.1000    0.0513
##      4        0.8124             nan     0.1000    0.0398
##      5        0.7417             nan     0.1000    0.0335
##      6        0.6767             nan     0.1000    0.0309
##      7        0.6196             nan     0.1000    0.0253
##      8        0.5642             nan     0.1000    0.0256
##      9        0.5184             nan     0.1000    0.0203
##     10        0.4820             nan     0.1000    0.0157
##     20        0.2573             nan     0.1000    0.0052
##     40        0.1094             nan     0.1000   -0.0014
##     60        0.0573             nan     0.1000   -0.0003
##     80        0.0345             nan     0.1000   -0.0004
##    100        0.0229             nan     0.1000   -0.0001
##    120        0.0170             nan     0.1000   -0.0004
##    140        0.0124             nan     0.1000   -0.0003
##    160        0.0085             nan     0.1000   -0.0002
##    180        0.0064             nan     0.1000   -0.0001
##    200        0.0045             nan     0.1000    0.0000
##    220        0.0032             nan     0.1000   -0.0000
##    240        0.0024             nan     0.1000   -0.0001
##    260        0.0017             nan     0.1000   -0.0000
##    280        0.0016             nan     0.1000   -0.0000
##    300        0.0013             nan     0.1000   -0.0000
##    320        0.0012             nan     0.1000   -0.0001
##    340        0.0010             nan     0.1000   -0.0000
##    360        0.0011             nan     0.1000   -0.0000
##    380        0.0007             nan     0.1000   -0.0000
##    400        0.0004             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1353             nan     0.1000    0.0748
##      2        1.0077             nan     0.1000    0.0615
##      3        0.9042             nan     0.1000    0.0505
##      4        0.8200             nan     0.1000    0.0388
##      5        0.7463             nan     0.1000    0.0333
##      6        0.6782             nan     0.1000    0.0318
##      7        0.6199             nan     0.1000    0.0287
##      8        0.5685             nan     0.1000    0.0246
##      9        0.5259             nan     0.1000    0.0161
##     10        0.4856             nan     0.1000    0.0194
##     20        0.2593             nan     0.1000    0.0047
##     40        0.1079             nan     0.1000   -0.0001
##     60        0.0608             nan     0.1000   -0.0012
##     80        0.0391             nan     0.1000   -0.0007
##    100        0.0248             nan     0.1000   -0.0003
##    120        0.0191             nan     0.1000   -0.0004
##    140        0.0126             nan     0.1000   -0.0002
##    160        0.0088             nan     0.1000   -0.0003
##    180        0.0059             nan     0.1000   -0.0001
##    200        0.0045             nan     0.1000   -0.0001
##    220        0.0036             nan     0.1000   -0.0001
##    240        0.0029             nan     0.1000   -0.0001
##    260        0.0022             nan     0.1000   -0.0000
##    280        0.0017             nan     0.1000   -0.0001
##    300        0.0011             nan     0.1000   -0.0000
##    320        0.0009             nan     0.1000   -0.0000
##    340        0.0007             nan     0.1000    0.0000
##    360        0.0005             nan     0.1000   -0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1282             nan     0.1000    0.0818
##      2        1.0091             nan     0.1000    0.0571
##      3        0.9103             nan     0.1000    0.0479
##      4        0.8243             nan     0.1000    0.0384
##      5        0.7461             nan     0.1000    0.0363
##      6        0.6807             nan     0.1000    0.0299
##      7        0.6239             nan     0.1000    0.0259
##      8        0.5742             nan     0.1000    0.0234
##      9        0.5260             nan     0.1000    0.0208
##     10        0.4871             nan     0.1000    0.0186
##     20        0.2600             nan     0.1000    0.0038
##     40        0.0998             nan     0.1000   -0.0002
##     60        0.0490             nan     0.1000   -0.0004
##     80        0.0296             nan     0.1000    0.0001
##    100        0.0181             nan     0.1000   -0.0002
##    120        0.0153             nan     0.1000   -0.0006
##    140        0.0113             nan     0.1000   -0.0004
##    160        0.0079             nan     0.1000   -0.0000
##    180        0.0054             nan     0.1000   -0.0001
##    200        0.0038             nan     0.1000   -0.0000
##    220        0.0025             nan     0.1000   -0.0001
##    240        0.0018             nan     0.1000   -0.0000
##    260        0.0014             nan     0.1000   -0.0000
##    280        0.0009             nan     0.1000   -0.0000
##    300        0.0007             nan     0.1000   -0.0000
##    320        0.0005             nan     0.1000   -0.0000
##    340        0.0004             nan     0.1000   -0.0000
##    360        0.0003             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000    0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1378             nan     0.1000    0.0711
##      2        1.0160             nan     0.1000    0.0605
##      3        0.9141             nan     0.1000    0.0498
##      4        0.8268             nan     0.1000    0.0398
##      5        0.7493             nan     0.1000    0.0364
##      6        0.6872             nan     0.1000    0.0280
##      7        0.6286             nan     0.1000    0.0271
##      8        0.5763             nan     0.1000    0.0238
##      9        0.5324             nan     0.1000    0.0200
##     10        0.4900             nan     0.1000    0.0182
##     20        0.2624             nan     0.1000    0.0053
##     40        0.1128             nan     0.1000    0.0000
##     60        0.0578             nan     0.1000   -0.0006
##     80        0.0331             nan     0.1000   -0.0006
##    100        0.0202             nan     0.1000   -0.0005
##    120        0.0143             nan     0.1000   -0.0001
##    140        0.0100             nan     0.1000   -0.0001
##    160        0.0062             nan     0.1000    0.0001
##    180        0.0045             nan     0.1000   -0.0001
##    200        0.0035             nan     0.1000   -0.0001
##    220        0.0025             nan     0.1000   -0.0001
##    240        0.0020             nan     0.1000   -0.0001
##    260        0.0015             nan     0.1000   -0.0000
##    280        0.0014             nan     0.1000   -0.0000
##    300        0.0011             nan     0.1000   -0.0000
##    320        0.0008             nan     0.1000   -0.0000
##    340        0.0007             nan     0.1000   -0.0000
##    360        0.0006             nan     0.1000   -0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1544             nan     0.1000    0.0682
##      2        1.0388             nan     0.1000    0.0544
##      3        0.9470             nan     0.1000    0.0440
##      4        0.8735             nan     0.1000    0.0374
##      5        0.8105             nan     0.1000    0.0315
##      6        0.7587             nan     0.1000    0.0281
##      7        0.7108             nan     0.1000    0.0228
##      8        0.6644             nan     0.1000    0.0221
##      9        0.6236             nan     0.1000    0.0181
##     10        0.5893             nan     0.1000    0.0171
##     20        0.3826             nan     0.1000    0.0061
##     40        0.2487             nan     0.1000    0.0011
##     60        0.2049             nan     0.1000    0.0010
##     80        0.1810             nan     0.1000   -0.0012
##    100        0.1627             nan     0.1000    0.0000
##    120        0.1530             nan     0.1000   -0.0021
##    140        0.1433             nan     0.1000   -0.0006
##    160        0.1397             nan     0.1000   -0.0015
##    180        0.1362             nan     0.1000   -0.0007
##    200        0.1298             nan     0.1000   -0.0013
##    220        0.1243             nan     0.1000   -0.0010
##    240        0.1199             nan     0.1000   -0.0006
##    260        0.1141             nan     0.1000   -0.0010
##    280        0.1109             nan     0.1000   -0.0007
##    300        0.1094             nan     0.1000   -0.0001
##    320        0.1066             nan     0.1000   -0.0003
##    340        0.1072             nan     0.1000   -0.0005
##    360        0.1057             nan     0.1000   -0.0011
##    380        0.1037             nan     0.1000   -0.0003
##    400        0.1014             nan     0.1000   -0.0005
##    420        0.1004             nan     0.1000   -0.0007
##    440        0.0992             nan     0.1000   -0.0009
##    460        0.0987             nan     0.1000   -0.0004
##    480        0.0966             nan     0.1000   -0.0011
##    500        0.0943             nan     0.1000   -0.0013
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1419             nan     0.1000    0.0710
##      2        1.0233             nan     0.1000    0.0548
##      3        0.9248             nan     0.1000    0.0468
##      4        0.8439             nan     0.1000    0.0393
##      5        0.7700             nan     0.1000    0.0353
##      6        0.7088             nan     0.1000    0.0275
##      7        0.6580             nan     0.1000    0.0266
##      8        0.6117             nan     0.1000    0.0243
##      9        0.5686             nan     0.1000    0.0199
##     10        0.5331             nan     0.1000    0.0132
##     20        0.3141             nan     0.1000    0.0064
##     40        0.1937             nan     0.1000   -0.0005
##     60        0.1530             nan     0.1000   -0.0006
##     80        0.1272             nan     0.1000   -0.0001
##    100        0.1072             nan     0.1000   -0.0019
##    120        0.0929             nan     0.1000   -0.0010
##    140        0.0799             nan     0.1000   -0.0008
##    160        0.0705             nan     0.1000   -0.0004
##    180        0.0632             nan     0.1000   -0.0003
##    200        0.0557             nan     0.1000   -0.0004
##    220        0.0515             nan     0.1000   -0.0002
##    240        0.0455             nan     0.1000   -0.0006
##    260        0.0409             nan     0.1000   -0.0001
##    280        0.0368             nan     0.1000   -0.0001
##    300        0.0343             nan     0.1000   -0.0002
##    320        0.0313             nan     0.1000   -0.0003
##    340        0.0285             nan     0.1000   -0.0001
##    360        0.0258             nan     0.1000   -0.0001
##    380        0.0242             nan     0.1000   -0.0002
##    400        0.0222             nan     0.1000   -0.0003
##    420        0.0200             nan     0.1000   -0.0000
##    440        0.0190             nan     0.1000   -0.0002
##    460        0.0178             nan     0.1000   -0.0002
##    480        0.0167             nan     0.1000   -0.0002
##    500        0.0152             nan     0.1000   -0.0002
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1342             nan     0.1000    0.0749
##      2        1.0089             nan     0.1000    0.0582
##      3        0.9088             nan     0.1000    0.0485
##      4        0.8249             nan     0.1000    0.0406
##      5        0.7519             nan     0.1000    0.0339
##      6        0.6923             nan     0.1000    0.0285
##      7        0.6389             nan     0.1000    0.0258
##      8        0.5940             nan     0.1000    0.0212
##      9        0.5503             nan     0.1000    0.0176
##     10        0.5102             nan     0.1000    0.0185
##     20        0.2955             nan     0.1000    0.0061
##     40        0.1627             nan     0.1000   -0.0002
##     60        0.1176             nan     0.1000   -0.0003
##     80        0.0902             nan     0.1000   -0.0010
##    100        0.0721             nan     0.1000   -0.0008
##    120        0.0605             nan     0.1000   -0.0008
##    140        0.0504             nan     0.1000   -0.0007
##    160        0.0398             nan     0.1000    0.0000
##    180        0.0349             nan     0.1000   -0.0006
##    200        0.0288             nan     0.1000   -0.0003
##    220        0.0233             nan     0.1000   -0.0001
##    240        0.0198             nan     0.1000   -0.0003
##    260        0.0168             nan     0.1000   -0.0002
##    280        0.0146             nan     0.1000   -0.0001
##    300        0.0126             nan     0.1000   -0.0002
##    320        0.0107             nan     0.1000   -0.0002
##    340        0.0092             nan     0.1000   -0.0001
##    360        0.0078             nan     0.1000   -0.0000
##    380        0.0068             nan     0.1000   -0.0000
##    400        0.0060             nan     0.1000   -0.0001
##    420        0.0053             nan     0.1000   -0.0001
##    440        0.0045             nan     0.1000   -0.0000
##    460        0.0039             nan     0.1000   -0.0000
##    480        0.0034             nan     0.1000   -0.0001
##    500        0.0030             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1329             nan     0.1000    0.0733
##      2        1.0106             nan     0.1000    0.0586
##      3        0.9059             nan     0.1000    0.0503
##      4        0.8209             nan     0.1000    0.0407
##      5        0.7498             nan     0.1000    0.0339
##      6        0.6882             nan     0.1000    0.0279
##      7        0.6348             nan     0.1000    0.0260
##      8        0.5856             nan     0.1000    0.0221
##      9        0.5414             nan     0.1000    0.0200
##     10        0.5078             nan     0.1000    0.0152
##     20        0.2789             nan     0.1000    0.0040
##     40        0.1368             nan     0.1000   -0.0005
##     60        0.0946             nan     0.1000   -0.0014
##     80        0.0653             nan     0.1000   -0.0009
##    100        0.0509             nan     0.1000   -0.0003
##    120        0.0385             nan     0.1000   -0.0002
##    140        0.0307             nan     0.1000   -0.0003
##    160        0.0245             nan     0.1000   -0.0003
##    180        0.0200             nan     0.1000   -0.0001
##    200        0.0161             nan     0.1000   -0.0001
##    220        0.0125             nan     0.1000   -0.0001
##    240        0.0100             nan     0.1000   -0.0001
##    260        0.0079             nan     0.1000   -0.0001
##    280        0.0064             nan     0.1000   -0.0001
##    300        0.0050             nan     0.1000   -0.0000
##    320        0.0041             nan     0.1000   -0.0000
##    340        0.0034             nan     0.1000   -0.0000
##    360        0.0028             nan     0.1000   -0.0000
##    380        0.0024             nan     0.1000   -0.0000
##    400        0.0021             nan     0.1000   -0.0000
##    420        0.0017             nan     0.1000   -0.0000
##    440        0.0014             nan     0.1000   -0.0000
##    460        0.0011             nan     0.1000   -0.0000
##    480        0.0009             nan     0.1000   -0.0000
##    500        0.0007             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1282             nan     0.1000    0.0785
##      2        1.0040             nan     0.1000    0.0604
##      3        0.9023             nan     0.1000    0.0488
##      4        0.8131             nan     0.1000    0.0447
##      5        0.7425             nan     0.1000    0.0350
##      6        0.6794             nan     0.1000    0.0287
##      7        0.6257             nan     0.1000    0.0246
##      8        0.5811             nan     0.1000    0.0208
##      9        0.5420             nan     0.1000    0.0169
##     10        0.5046             nan     0.1000    0.0160
##     20        0.2855             nan     0.1000    0.0052
##     40        0.1359             nan     0.1000   -0.0013
##     60        0.0868             nan     0.1000   -0.0000
##     80        0.0590             nan     0.1000   -0.0010
##    100        0.0423             nan     0.1000   -0.0006
##    120        0.0281             nan     0.1000   -0.0001
##    140        0.0219             nan     0.1000   -0.0003
##    160        0.0165             nan     0.1000   -0.0001
##    180        0.0120             nan     0.1000    0.0000
##    200        0.0092             nan     0.1000   -0.0001
##    220        0.0072             nan     0.1000   -0.0002
##    240        0.0050             nan     0.1000   -0.0000
##    260        0.0040             nan     0.1000   -0.0001
##    280        0.0032             nan     0.1000   -0.0000
##    300        0.0024             nan     0.1000   -0.0000
##    320        0.0019             nan     0.1000   -0.0000
##    340        0.0015             nan     0.1000   -0.0000
##    360        0.0014             nan     0.1000   -0.0000
##    380        0.0012             nan     0.1000   -0.0000
##    400        0.0009             nan     0.1000   -0.0000
##    420        0.0007             nan     0.1000   -0.0000
##    440        0.0006             nan     0.1000   -0.0000
##    460        0.0005             nan     0.1000   -0.0000
##    480        0.0004             nan     0.1000   -0.0000
##    500        0.0003             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1425             nan     0.1000    0.0755
##      2        1.0146             nan     0.1000    0.0609
##      3        0.9154             nan     0.1000    0.0461
##      4        0.8268             nan     0.1000    0.0431
##      5        0.7495             nan     0.1000    0.0374
##      6        0.6868             nan     0.1000    0.0272
##      7        0.6357             nan     0.1000    0.0221
##      8        0.5841             nan     0.1000    0.0209
##      9        0.5411             nan     0.1000    0.0195
##     10        0.5054             nan     0.1000    0.0147
##     20        0.2709             nan     0.1000    0.0052
##     40        0.1237             nan     0.1000   -0.0012
##     60        0.0691             nan     0.1000   -0.0006
##     80        0.0462             nan     0.1000   -0.0001
##    100        0.0317             nan     0.1000   -0.0003
##    120        0.0236             nan     0.1000   -0.0001
##    140        0.0165             nan     0.1000   -0.0003
##    160        0.0120             nan     0.1000   -0.0003
##    180        0.0092             nan     0.1000   -0.0002
##    200        0.0068             nan     0.1000   -0.0000
##    220        0.0051             nan     0.1000   -0.0000
##    240        0.0037             nan     0.1000   -0.0001
##    260        0.0030             nan     0.1000   -0.0001
##    280        0.0024             nan     0.1000   -0.0000
##    300        0.0017             nan     0.1000   -0.0000
##    320        0.0013             nan     0.1000   -0.0000
##    340        0.0010             nan     0.1000    0.0000
##    360        0.0007             nan     0.1000   -0.0000
##    380        0.0005             nan     0.1000   -0.0000
##    400        0.0004             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1346             nan     0.1000    0.0747
##      2        1.0183             nan     0.1000    0.0585
##      3        0.9138             nan     0.1000    0.0477
##      4        0.8298             nan     0.1000    0.0376
##      5        0.7601             nan     0.1000    0.0335
##      6        0.6965             nan     0.1000    0.0301
##      7        0.6399             nan     0.1000    0.0243
##      8        0.5890             nan     0.1000    0.0238
##      9        0.5482             nan     0.1000    0.0182
##     10        0.5074             nan     0.1000    0.0182
##     20        0.2710             nan     0.1000    0.0057
##     40        0.1190             nan     0.1000    0.0002
##     60        0.0709             nan     0.1000   -0.0002
##     80        0.0473             nan     0.1000   -0.0002
##    100        0.0306             nan     0.1000   -0.0003
##    120        0.0222             nan     0.1000    0.0001
##    140        0.0152             nan     0.1000   -0.0002
##    160        0.0117             nan     0.1000   -0.0002
##    180        0.0083             nan     0.1000    0.0000
##    200        0.0062             nan     0.1000   -0.0001
##    220        0.0049             nan     0.1000   -0.0001
##    240        0.0034             nan     0.1000   -0.0001
##    260        0.0026             nan     0.1000   -0.0000
##    280        0.0019             nan     0.1000   -0.0000
##    300        0.0014             nan     0.1000    0.0000
##    320        0.0010             nan     0.1000   -0.0000
##    340        0.0007             nan     0.1000   -0.0000
##    360        0.0005             nan     0.1000   -0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1354             nan     0.1000    0.0728
##      2        1.0156             nan     0.1000    0.0574
##      3        0.9111             nan     0.1000    0.0484
##      4        0.8198             nan     0.1000    0.0425
##      5        0.7457             nan     0.1000    0.0354
##      6        0.6865             nan     0.1000    0.0255
##      7        0.6311             nan     0.1000    0.0270
##      8        0.5809             nan     0.1000    0.0221
##      9        0.5401             nan     0.1000    0.0154
##     10        0.4998             nan     0.1000    0.0193
##     20        0.2713             nan     0.1000    0.0043
##     40        0.1208             nan     0.1000    0.0003
##     60        0.0650             nan     0.1000   -0.0009
##     80        0.0417             nan     0.1000   -0.0002
##    100        0.0268             nan     0.1000   -0.0004
##    120        0.0211             nan     0.1000   -0.0004
##    140        0.0145             nan     0.1000   -0.0003
##    160        0.0095             nan     0.1000   -0.0002
##    180        0.0071             nan     0.1000   -0.0001
##    200        0.0055             nan     0.1000   -0.0001
##    220        0.0041             nan     0.1000   -0.0001
##    240        0.0027             nan     0.1000   -0.0000
##    260        0.0020             nan     0.1000   -0.0000
##    280        0.0015             nan     0.1000   -0.0000
##    300        0.0011             nan     0.1000   -0.0000
##    320        0.0008             nan     0.1000   -0.0000
##    340        0.0006             nan     0.1000   -0.0000
##    360        0.0004             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000    0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1347             nan     0.1000    0.0758
##      2        1.0060             nan     0.1000    0.0639
##      3        0.9023             nan     0.1000    0.0482
##      4        0.8221             nan     0.1000    0.0367
##      5        0.7454             nan     0.1000    0.0378
##      6        0.6834             nan     0.1000    0.0272
##      7        0.6238             nan     0.1000    0.0266
##      8        0.5761             nan     0.1000    0.0214
##      9        0.5363             nan     0.1000    0.0170
##     10        0.5024             nan     0.1000    0.0129
##     20        0.2659             nan     0.1000    0.0049
##     40        0.1100             nan     0.1000    0.0003
##     60        0.0624             nan     0.1000   -0.0010
##     80        0.0347             nan     0.1000   -0.0005
##    100        0.0236             nan     0.1000   -0.0005
##    120        0.0167             nan     0.1000    0.0001
##    140        0.0122             nan     0.1000   -0.0003
##    160        0.0084             nan     0.1000   -0.0001
##    180        0.0059             nan     0.1000   -0.0001
##    200        0.0045             nan     0.1000   -0.0000
##    220        0.0037             nan     0.1000   -0.0000
##    240        0.0026             nan     0.1000   -0.0001
##    260        0.0022             nan     0.1000   -0.0001
##    280        0.0020             nan     0.1000   -0.0001
##    300        0.0015             nan     0.1000   -0.0001
##    320        0.0009             nan     0.1000   -0.0000
##    340        0.0007             nan     0.1000   -0.0000
##    360        0.0005             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1324             nan     0.1000    0.0723
##      2        1.0078             nan     0.1000    0.0613
##      3        0.9095             nan     0.1000    0.0440
##      4        0.8226             nan     0.1000    0.0427
##      5        0.7499             nan     0.1000    0.0324
##      6        0.6845             nan     0.1000    0.0277
##      7        0.6241             nan     0.1000    0.0298
##      8        0.5777             nan     0.1000    0.0205
##      9        0.5360             nan     0.1000    0.0189
##     10        0.4970             nan     0.1000    0.0166
##     20        0.2639             nan     0.1000    0.0036
##     40        0.1150             nan     0.1000   -0.0013
##     60        0.0633             nan     0.1000   -0.0010
##     80        0.0371             nan     0.1000   -0.0003
##    100        0.0236             nan     0.1000   -0.0001
##    120        0.0170             nan     0.1000   -0.0003
##    140        0.0116             nan     0.1000    0.0001
##    160        0.0087             nan     0.1000   -0.0002
##    180        0.0054             nan     0.1000   -0.0001
##    200        0.0037             nan     0.1000    0.0000
##    220        0.0030             nan     0.1000   -0.0001
##    240        0.0022             nan     0.1000   -0.0001
##    260        0.0014             nan     0.1000   -0.0000
##    280        0.0015             nan     0.1000   -0.0001
##    300        0.0009             nan     0.1000   -0.0000
##    320        0.0006             nan     0.1000   -0.0000
##    340        0.0005             nan     0.1000   -0.0000
##    360        0.0003             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0001             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1528             nan     0.1000    0.0645
##      2        1.0397             nan     0.1000    0.0563
##      3        0.9505             nan     0.1000    0.0427
##      4        0.8719             nan     0.1000    0.0396
##      5        0.8112             nan     0.1000    0.0304
##      6        0.7577             nan     0.1000    0.0246
##      7        0.7050             nan     0.1000    0.0255
##      8        0.6613             nan     0.1000    0.0203
##      9        0.6254             nan     0.1000    0.0157
##     10        0.5899             nan     0.1000    0.0153
##     20        0.3914             nan     0.1000    0.0058
##     40        0.2505             nan     0.1000    0.0012
##     60        0.2096             nan     0.1000   -0.0007
##     80        0.1829             nan     0.1000   -0.0005
##    100        0.1648             nan     0.1000   -0.0010
##    120        0.1545             nan     0.1000   -0.0011
##    140        0.1443             nan     0.1000   -0.0002
##    160        0.1367             nan     0.1000   -0.0004
##    180        0.1315             nan     0.1000   -0.0009
##    200        0.1264             nan     0.1000   -0.0011
##    220        0.1225             nan     0.1000   -0.0014
##    240        0.1187             nan     0.1000   -0.0018
##    260        0.1158             nan     0.1000   -0.0011
##    280        0.1133             nan     0.1000   -0.0009
##    300        0.1102             nan     0.1000   -0.0008
##    320        0.1087             nan     0.1000   -0.0003
##    340        0.1061             nan     0.1000   -0.0012
##    360        0.1044             nan     0.1000   -0.0004
##    380        0.1020             nan     0.1000   -0.0013
##    400        0.1004             nan     0.1000   -0.0006
##    420        0.0992             nan     0.1000   -0.0008
##    440        0.0977             nan     0.1000   -0.0014
##    460        0.0975             nan     0.1000   -0.0009
##    480        0.0962             nan     0.1000   -0.0006
##    500        0.0943             nan     0.1000   -0.0006
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1424             nan     0.1000    0.0727
##      2        1.0433             nan     0.1000    0.0449
##      3        0.9408             nan     0.1000    0.0497
##      4        0.8590             nan     0.1000    0.0416
##      5        0.7901             nan     0.1000    0.0344
##      6        0.7248             nan     0.1000    0.0323
##      7        0.6707             nan     0.1000    0.0249
##      8        0.6248             nan     0.1000    0.0221
##      9        0.5798             nan     0.1000    0.0215
##     10        0.5412             nan     0.1000    0.0191
##     20        0.3270             nan     0.1000    0.0062
##     40        0.1909             nan     0.1000    0.0001
##     60        0.1503             nan     0.1000   -0.0004
##     80        0.1235             nan     0.1000   -0.0012
##    100        0.1058             nan     0.1000   -0.0002
##    120        0.0891             nan     0.1000   -0.0008
##    140        0.0774             nan     0.1000   -0.0005
##    160        0.0681             nan     0.1000   -0.0002
##    180        0.0597             nan     0.1000   -0.0002
##    200        0.0541             nan     0.1000   -0.0005
##    220        0.0502             nan     0.1000   -0.0007
##    240        0.0450             nan     0.1000   -0.0002
##    260        0.0420             nan     0.1000   -0.0001
##    280        0.0378             nan     0.1000   -0.0005
##    300        0.0352             nan     0.1000   -0.0002
##    320        0.0309             nan     0.1000   -0.0000
##    340        0.0286             nan     0.1000   -0.0002
##    360        0.0253             nan     0.1000    0.0000
##    380        0.0237             nan     0.1000   -0.0002
##    400        0.0213             nan     0.1000    0.0000
##    420        0.0197             nan     0.1000   -0.0002
##    440        0.0178             nan     0.1000   -0.0002
##    460        0.0160             nan     0.1000   -0.0001
##    480        0.0151             nan     0.1000    0.0000
##    500        0.0140             nan     0.1000   -0.0001
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1362             nan     0.1000    0.0738
##      2        1.0147             nan     0.1000    0.0574
##      3        0.9190             nan     0.1000    0.0476
##      4        0.8340             nan     0.1000    0.0405
##      5        0.7610             nan     0.1000    0.0344
##      6        0.7002             nan     0.1000    0.0272
##      7        0.6420             nan     0.1000    0.0269
##      8        0.5938             nan     0.1000    0.0223
##      9        0.5528             nan     0.1000    0.0177
##     10        0.5133             nan     0.1000    0.0171
##     20        0.2956             nan     0.1000    0.0037
##     40        0.1720             nan     0.1000   -0.0010
##     60        0.1188             nan     0.1000   -0.0007
##     80        0.0933             nan     0.1000   -0.0016
##    100        0.0736             nan     0.1000   -0.0008
##    120        0.0582             nan     0.1000   -0.0004
##    140        0.0482             nan     0.1000   -0.0007
##    160        0.0394             nan     0.1000   -0.0000
##    180        0.0329             nan     0.1000   -0.0003
##    200        0.0266             nan     0.1000   -0.0001
##    220        0.0226             nan     0.1000   -0.0002
##    240        0.0197             nan     0.1000   -0.0001
##    260        0.0169             nan     0.1000   -0.0002
##    280        0.0147             nan     0.1000   -0.0002
##    300        0.0132             nan     0.1000   -0.0001
##    320        0.0111             nan     0.1000   -0.0000
##    340        0.0099             nan     0.1000   -0.0001
##    360        0.0083             nan     0.1000   -0.0001
##    380        0.0071             nan     0.1000   -0.0000
##    400        0.0062             nan     0.1000   -0.0001
##    420        0.0054             nan     0.1000   -0.0001
##    440        0.0045             nan     0.1000   -0.0000
##    460        0.0038             nan     0.1000   -0.0000
##    480        0.0032             nan     0.1000   -0.0001
##    500        0.0028             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1345             nan     0.1000    0.0697
##      2        1.0138             nan     0.1000    0.0605
##      3        0.9126             nan     0.1000    0.0455
##      4        0.8249             nan     0.1000    0.0412
##      5        0.7514             nan     0.1000    0.0338
##      6        0.6883             nan     0.1000    0.0240
##      7        0.6337             nan     0.1000    0.0259
##      8        0.5856             nan     0.1000    0.0212
##      9        0.5438             nan     0.1000    0.0184
##     10        0.5100             nan     0.1000    0.0132
##     20        0.2926             nan     0.1000    0.0050
##     40        0.1482             nan     0.1000   -0.0013
##     60        0.1000             nan     0.1000   -0.0007
##     80        0.0728             nan     0.1000   -0.0007
##    100        0.0568             nan     0.1000   -0.0007
##    120        0.0432             nan     0.1000   -0.0004
##    140        0.0365             nan     0.1000   -0.0006
##    160        0.0272             nan     0.1000   -0.0000
##    180        0.0222             nan     0.1000   -0.0003
##    200        0.0177             nan     0.1000   -0.0001
##    220        0.0141             nan     0.1000   -0.0000
##    240        0.0116             nan     0.1000   -0.0000
##    260        0.0094             nan     0.1000   -0.0000
##    280        0.0076             nan     0.1000   -0.0001
##    300        0.0061             nan     0.1000   -0.0001
##    320        0.0049             nan     0.1000   -0.0001
##    340        0.0042             nan     0.1000   -0.0000
##    360        0.0034             nan     0.1000   -0.0001
##    380        0.0028             nan     0.1000   -0.0000
##    400        0.0023             nan     0.1000   -0.0000
##    420        0.0019             nan     0.1000   -0.0000
##    440        0.0016             nan     0.1000   -0.0000
##    460        0.0013             nan     0.1000   -0.0000
##    480        0.0011             nan     0.1000   -0.0000
##    500        0.0009             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1398             nan     0.1000    0.0696
##      2        1.0158             nan     0.1000    0.0613
##      3        0.9136             nan     0.1000    0.0465
##      4        0.8248             nan     0.1000    0.0426
##      5        0.7481             nan     0.1000    0.0343
##      6        0.6840             nan     0.1000    0.0285
##      7        0.6295             nan     0.1000    0.0231
##      8        0.5773             nan     0.1000    0.0235
##      9        0.5304             nan     0.1000    0.0226
##     10        0.4939             nan     0.1000    0.0151
##     20        0.2782             nan     0.1000    0.0044
##     40        0.1285             nan     0.1000   -0.0005
##     60        0.0774             nan     0.1000   -0.0003
##     80        0.0538             nan     0.1000   -0.0013
##    100        0.0422             nan     0.1000   -0.0006
##    120        0.0301             nan     0.1000   -0.0004
##    140        0.0229             nan     0.1000    0.0001
##    160        0.0173             nan     0.1000   -0.0001
##    180        0.0126             nan     0.1000   -0.0001
##    200        0.0096             nan     0.1000   -0.0000
##    220        0.0074             nan     0.1000   -0.0000
##    240        0.0059             nan     0.1000    0.0000
##    260        0.0045             nan     0.1000   -0.0001
##    280        0.0036             nan     0.1000   -0.0000
##    300        0.0030             nan     0.1000   -0.0001
##    320        0.0023             nan     0.1000   -0.0000
##    340        0.0018             nan     0.1000    0.0000
##    360        0.0015             nan     0.1000    0.0000
##    380        0.0012             nan     0.1000   -0.0000
##    400        0.0009             nan     0.1000   -0.0000
##    420        0.0008             nan     0.1000   -0.0000
##    440        0.0006             nan     0.1000   -0.0000
##    460        0.0005             nan     0.1000   -0.0000
##    480        0.0004             nan     0.1000   -0.0000
##    500        0.0003             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1339             nan     0.1000    0.0721
##      2        1.0110             nan     0.1000    0.0580
##      3        0.9158             nan     0.1000    0.0418
##      4        0.8311             nan     0.1000    0.0349
##      5        0.7590             nan     0.1000    0.0326
##      6        0.6977             nan     0.1000    0.0267
##      7        0.6444             nan     0.1000    0.0264
##      8        0.5978             nan     0.1000    0.0196
##      9        0.5541             nan     0.1000    0.0183
##     10        0.5189             nan     0.1000    0.0144
##     20        0.2903             nan     0.1000    0.0036
##     40        0.1335             nan     0.1000   -0.0002
##     60        0.0805             nan     0.1000   -0.0010
##     80        0.0526             nan     0.1000   -0.0007
##    100        0.0356             nan     0.1000   -0.0005
##    120        0.0244             nan     0.1000   -0.0002
##    140        0.0175             nan     0.1000   -0.0001
##    160        0.0129             nan     0.1000   -0.0003
##    180        0.0096             nan     0.1000   -0.0002
##    200        0.0074             nan     0.1000   -0.0002
##    220        0.0056             nan     0.1000   -0.0000
##    240        0.0041             nan     0.1000   -0.0000
##    260        0.0031             nan     0.1000   -0.0000
##    280        0.0024             nan     0.1000   -0.0000
##    300        0.0017             nan     0.1000   -0.0000
##    320        0.0013             nan     0.1000   -0.0000
##    340        0.0010             nan     0.1000   -0.0000
##    360        0.0007             nan     0.1000   -0.0000
##    380        0.0006             nan     0.1000   -0.0000
##    400        0.0004             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000    0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1377             nan     0.1000    0.0754
##      2        1.0152             nan     0.1000    0.0602
##      3        0.9181             nan     0.1000    0.0465
##      4        0.8325             nan     0.1000    0.0389
##      5        0.7566             nan     0.1000    0.0346
##      6        0.6902             nan     0.1000    0.0305
##      7        0.6386             nan     0.1000    0.0237
##      8        0.5919             nan     0.1000    0.0204
##      9        0.5451             nan     0.1000    0.0199
##     10        0.5085             nan     0.1000    0.0164
##     20        0.2726             nan     0.1000    0.0055
##     40        0.1179             nan     0.1000   -0.0011
##     60        0.0651             nan     0.1000   -0.0005
##     80        0.0406             nan     0.1000   -0.0003
##    100        0.0275             nan     0.1000   -0.0005
##    120        0.0194             nan     0.1000   -0.0002
##    140        0.0131             nan     0.1000   -0.0003
##    160        0.0099             nan     0.1000   -0.0002
##    180        0.0071             nan     0.1000   -0.0001
##    200        0.0053             nan     0.1000   -0.0001
##    220        0.0042             nan     0.1000    0.0000
##    240        0.0032             nan     0.1000   -0.0001
##    260        0.0025             nan     0.1000   -0.0001
##    280        0.0018             nan     0.1000   -0.0000
##    300        0.0015             nan     0.1000   -0.0000
##    320        0.0010             nan     0.1000   -0.0000
##    340        0.0008             nan     0.1000   -0.0000
##    360        0.0007             nan     0.1000   -0.0000
##    380        0.0005             nan     0.1000   -0.0000
##    400        0.0004             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1401             nan     0.1000    0.0692
##      2        1.0161             nan     0.1000    0.0609
##      3        0.9169             nan     0.1000    0.0460
##      4        0.8297             nan     0.1000    0.0396
##      5        0.7569             nan     0.1000    0.0352
##      6        0.6929             nan     0.1000    0.0286
##      7        0.6395             nan     0.1000    0.0237
##      8        0.5921             nan     0.1000    0.0214
##      9        0.5477             nan     0.1000    0.0204
##     10        0.5064             nan     0.1000    0.0186
##     20        0.2742             nan     0.1000    0.0049
##     40        0.1151             nan     0.1000   -0.0000
##     60        0.0641             nan     0.1000   -0.0011
##     80        0.0370             nan     0.1000   -0.0005
##    100        0.0250             nan     0.1000   -0.0001
##    120        0.0165             nan     0.1000   -0.0003
##    140        0.0108             nan     0.1000   -0.0000
##    160        0.0082             nan     0.1000   -0.0001
##    180        0.0062             nan     0.1000   -0.0001
##    200        0.0039             nan     0.1000   -0.0000
##    220        0.0029             nan     0.1000   -0.0001
##    240        0.0020             nan     0.1000   -0.0000
##    260        0.0017             nan     0.1000    0.0000
##    280        0.0013             nan     0.1000   -0.0000
##    300        0.0009             nan     0.1000   -0.0000
##    320        0.0007             nan     0.1000   -0.0000
##    340        0.0006             nan     0.1000   -0.0000
##    360        0.0004             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1392             nan     0.1000    0.0726
##      2        1.0200             nan     0.1000    0.0547
##      3        0.9143             nan     0.1000    0.0520
##      4        0.8277             nan     0.1000    0.0405
##      5        0.7552             nan     0.1000    0.0329
##      6        0.6930             nan     0.1000    0.0286
##      7        0.6350             nan     0.1000    0.0276
##      8        0.5902             nan     0.1000    0.0201
##      9        0.5456             nan     0.1000    0.0177
##     10        0.5091             nan     0.1000    0.0157
##     20        0.2824             nan     0.1000    0.0042
##     40        0.1189             nan     0.1000   -0.0005
##     60        0.0606             nan     0.1000   -0.0001
##     80        0.0384             nan     0.1000   -0.0000
##    100        0.0264             nan     0.1000   -0.0005
##    120        0.0177             nan     0.1000   -0.0002
##    140        0.0122             nan     0.1000   -0.0002
##    160        0.0081             nan     0.1000   -0.0000
##    180        0.0061             nan     0.1000   -0.0001
##    200        0.0038             nan     0.1000   -0.0001
##    220        0.0028             nan     0.1000   -0.0001
##    240        0.0021             nan     0.1000   -0.0001
##    260        0.0017             nan     0.1000   -0.0000
##    280        0.0012             nan     0.1000   -0.0000
##    300        0.0008             nan     0.1000    0.0000
##    320        0.0007             nan     0.1000   -0.0000
##    340        0.0005             nan     0.1000   -0.0000
##    360        0.0004             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000    0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000    0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1318             nan     0.1000    0.0715
##      2        1.0075             nan     0.1000    0.0554
##      3        0.9060             nan     0.1000    0.0482
##      4        0.8234             nan     0.1000    0.0360
##      5        0.7562             nan     0.1000    0.0275
##      6        0.6914             nan     0.1000    0.0302
##      7        0.6367             nan     0.1000    0.0232
##      8        0.5860             nan     0.1000    0.0209
##      9        0.5426             nan     0.1000    0.0198
##     10        0.5054             nan     0.1000    0.0156
##     20        0.2762             nan     0.1000    0.0061
##     40        0.1178             nan     0.1000   -0.0002
##     60        0.0710             nan     0.1000   -0.0010
##     80        0.0451             nan     0.1000    0.0003
##    100        0.0287             nan     0.1000   -0.0005
##    120        0.0180             nan     0.1000   -0.0003
##    140        0.0118             nan     0.1000   -0.0003
##    160        0.0080             nan     0.1000    0.0000
##    180        0.0048             nan     0.1000   -0.0002
##    200        0.0035             nan     0.1000   -0.0001
##    220        0.0025             nan     0.1000   -0.0000
##    240        0.0018             nan     0.1000   -0.0000
##    260        0.0014             nan     0.1000   -0.0000
##    280        0.0011             nan     0.1000   -0.0000
##    300        0.0008             nan     0.1000   -0.0000
##    320        0.0006             nan     0.1000   -0.0000
##    340        0.0004             nan     0.1000   -0.0000
##    360        0.0004             nan     0.1000   -0.0000
##    380        0.0002             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0001             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000    0.0000
##    480        0.0000             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1475             nan     0.1000    0.0706
##      2        1.0392             nan     0.1000    0.0534
##      3        0.9468             nan     0.1000    0.0420
##      4        0.8658             nan     0.1000    0.0372
##      5        0.8018             nan     0.1000    0.0291
##      6        0.7504             nan     0.1000    0.0262
##      7        0.6970             nan     0.1000    0.0249
##      8        0.6489             nan     0.1000    0.0220
##      9        0.6042             nan     0.1000    0.0201
##     10        0.5682             nan     0.1000    0.0152
##     20        0.3703             nan     0.1000    0.0052
##     40        0.2381             nan     0.1000   -0.0001
##     60        0.1871             nan     0.1000   -0.0010
##     80        0.1644             nan     0.1000   -0.0002
##    100        0.1491             nan     0.1000    0.0001
##    120        0.1434             nan     0.1000   -0.0013
##    140        0.1311             nan     0.1000   -0.0021
##    160        0.1252             nan     0.1000   -0.0009
##    180        0.1202             nan     0.1000   -0.0006
##    200        0.1145             nan     0.1000   -0.0006
##    220        0.1091             nan     0.1000   -0.0007
##    240        0.1070             nan     0.1000   -0.0008
##    260        0.1058             nan     0.1000    0.0001
##    280        0.1026             nan     0.1000   -0.0004
##    300        0.1008             nan     0.1000   -0.0006
##    320        0.1003             nan     0.1000   -0.0006
##    340        0.0965             nan     0.1000   -0.0008
##    360        0.0942             nan     0.1000   -0.0011
##    380        0.0943             nan     0.1000   -0.0007
##    400        0.0911             nan     0.1000   -0.0008
##    420        0.0897             nan     0.1000   -0.0005
##    440        0.0891             nan     0.1000   -0.0008
##    460        0.0880             nan     0.1000   -0.0004
##    480        0.0853             nan     0.1000   -0.0000
##    500        0.0841             nan     0.1000   -0.0006
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1376             nan     0.1000    0.0744
##      2        1.0190             nan     0.1000    0.0594
##      3        0.9172             nan     0.1000    0.0507
##      4        0.8337             nan     0.1000    0.0410
##      5        0.7591             nan     0.1000    0.0344
##      6        0.6982             nan     0.1000    0.0287
##      7        0.6435             nan     0.1000    0.0264
##      8        0.5949             nan     0.1000    0.0236
##      9        0.5542             nan     0.1000    0.0179
##     10        0.5145             nan     0.1000    0.0194
##     20        0.2957             nan     0.1000    0.0053
##     40        0.1843             nan     0.1000   -0.0002
##     60        0.1345             nan     0.1000   -0.0012
##     80        0.1073             nan     0.1000   -0.0006
##    100        0.0906             nan     0.1000   -0.0004
##    120        0.0811             nan     0.1000   -0.0011
##    140        0.0674             nan     0.1000   -0.0007
##    160        0.0598             nan     0.1000   -0.0004
##    180        0.0531             nan     0.1000   -0.0005
##    200        0.0471             nan     0.1000   -0.0003
##    220        0.0427             nan     0.1000   -0.0007
##    240        0.0383             nan     0.1000   -0.0003
##    260        0.0335             nan     0.1000   -0.0001
##    280        0.0307             nan     0.1000   -0.0003
##    300        0.0285             nan     0.1000   -0.0002
##    320        0.0247             nan     0.1000   -0.0004
##    340        0.0220             nan     0.1000   -0.0001
##    360        0.0202             nan     0.1000   -0.0002
##    380        0.0184             nan     0.1000   -0.0002
##    400        0.0166             nan     0.1000   -0.0002
##    420        0.0155             nan     0.1000   -0.0001
##    440        0.0144             nan     0.1000   -0.0002
##    460        0.0132             nan     0.1000   -0.0000
##    480        0.0118             nan     0.1000   -0.0000
##    500        0.0109             nan     0.1000   -0.0001
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1354             nan     0.1000    0.0780
##      2        1.0171             nan     0.1000    0.0538
##      3        0.9099             nan     0.1000    0.0489
##      4        0.8314             nan     0.1000    0.0375
##      5        0.7601             nan     0.1000    0.0303
##      6        0.6969             nan     0.1000    0.0310
##      7        0.6421             nan     0.1000    0.0252
##      8        0.5919             nan     0.1000    0.0234
##      9        0.5460             nan     0.1000    0.0217
##     10        0.5045             nan     0.1000    0.0191
##     20        0.2867             nan     0.1000    0.0043
##     40        0.1520             nan     0.1000   -0.0010
##     60        0.0999             nan     0.1000    0.0003
##     80        0.0753             nan     0.1000   -0.0007
##    100        0.0595             nan     0.1000   -0.0009
##    120        0.0462             nan     0.1000   -0.0000
##    140        0.0354             nan     0.1000   -0.0003
##    160        0.0279             nan     0.1000    0.0000
##    180        0.0232             nan     0.1000   -0.0002
##    200        0.0196             nan     0.1000   -0.0001
##    220        0.0162             nan     0.1000   -0.0001
##    240        0.0136             nan     0.1000   -0.0000
##    260        0.0116             nan     0.1000   -0.0002
##    280        0.0095             nan     0.1000   -0.0001
##    300        0.0079             nan     0.1000   -0.0000
##    320        0.0067             nan     0.1000   -0.0000
##    340        0.0054             nan     0.1000   -0.0000
##    360        0.0047             nan     0.1000   -0.0000
##    380        0.0039             nan     0.1000   -0.0000
##    400        0.0032             nan     0.1000   -0.0000
##    420        0.0027             nan     0.1000   -0.0000
##    440        0.0022             nan     0.1000   -0.0000
##    460        0.0019             nan     0.1000   -0.0000
##    480        0.0017             nan     0.1000   -0.0000
##    500        0.0014             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1363             nan     0.1000    0.0749
##      2        1.0129             nan     0.1000    0.0612
##      3        0.9164             nan     0.1000    0.0471
##      4        0.8267             nan     0.1000    0.0448
##      5        0.7478             nan     0.1000    0.0372
##      6        0.6799             nan     0.1000    0.0314
##      7        0.6238             nan     0.1000    0.0272
##      8        0.5708             nan     0.1000    0.0243
##      9        0.5309             nan     0.1000    0.0193
##     10        0.4911             nan     0.1000    0.0180
##     20        0.2644             nan     0.1000    0.0036
##     40        0.1236             nan     0.1000   -0.0001
##     60        0.0782             nan     0.1000   -0.0007
##     80        0.0538             nan     0.1000   -0.0002
##    100        0.0390             nan     0.1000   -0.0003
##    120        0.0286             nan     0.1000   -0.0004
##    140        0.0202             nan     0.1000    0.0000
##    160        0.0153             nan     0.1000   -0.0000
##    180        0.0120             nan     0.1000   -0.0002
##    200        0.0097             nan     0.1000   -0.0001
##    220        0.0073             nan     0.1000   -0.0001
##    240        0.0055             nan     0.1000   -0.0000
##    260        0.0045             nan     0.1000   -0.0000
##    280        0.0034             nan     0.1000   -0.0000
##    300        0.0026             nan     0.1000    0.0000
##    320        0.0021             nan     0.1000   -0.0000
##    340        0.0016             nan     0.1000   -0.0000
##    360        0.0013             nan     0.1000   -0.0000
##    380        0.0010             nan     0.1000   -0.0000
##    400        0.0008             nan     0.1000   -0.0000
##    420        0.0006             nan     0.1000   -0.0000
##    440        0.0005             nan     0.1000   -0.0000
##    460        0.0004             nan     0.1000   -0.0000
##    480        0.0003             nan     0.1000   -0.0000
##    500        0.0003             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1356             nan     0.1000    0.0767
##      2        1.0090             nan     0.1000    0.0600
##      3        0.9026             nan     0.1000    0.0484
##      4        0.8203             nan     0.1000    0.0371
##      5        0.7483             nan     0.1000    0.0346
##      6        0.6843             nan     0.1000    0.0289
##      7        0.6226             nan     0.1000    0.0277
##      8        0.5706             nan     0.1000    0.0251
##      9        0.5269             nan     0.1000    0.0201
##     10        0.4938             nan     0.1000    0.0122
##     20        0.2635             nan     0.1000    0.0057
##     40        0.1224             nan     0.1000   -0.0011
##     60        0.0744             nan     0.1000   -0.0004
##     80        0.0497             nan     0.1000   -0.0000
##    100        0.0347             nan     0.1000   -0.0006
##    120        0.0248             nan     0.1000   -0.0006
##    140        0.0179             nan     0.1000   -0.0002
##    160        0.0124             nan     0.1000    0.0000
##    180        0.0091             nan     0.1000   -0.0001
##    200        0.0066             nan     0.1000   -0.0001
##    220        0.0046             nan     0.1000   -0.0001
##    240        0.0038             nan     0.1000   -0.0001
##    260        0.0027             nan     0.1000   -0.0000
##    280        0.0022             nan     0.1000   -0.0001
##    300        0.0017             nan     0.1000   -0.0000
##    320        0.0012             nan     0.1000   -0.0000
##    340        0.0010             nan     0.1000   -0.0000
##    360        0.0008             nan     0.1000   -0.0000
##    380        0.0005             nan     0.1000   -0.0000
##    400        0.0004             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1349             nan     0.1000    0.0758
##      2        1.0082             nan     0.1000    0.0599
##      3        0.9050             nan     0.1000    0.0468
##      4        0.8195             nan     0.1000    0.0388
##      5        0.7440             nan     0.1000    0.0358
##      6        0.6813             nan     0.1000    0.0279
##      7        0.6251             nan     0.1000    0.0252
##      8        0.5765             nan     0.1000    0.0201
##      9        0.5335             nan     0.1000    0.0185
##     10        0.4957             nan     0.1000    0.0155
##     20        0.2561             nan     0.1000    0.0068
##     40        0.1068             nan     0.1000    0.0002
##     60        0.0596             nan     0.1000   -0.0002
##     80        0.0375             nan     0.1000   -0.0002
##    100        0.0246             nan     0.1000   -0.0004
##    120        0.0160             nan     0.1000   -0.0001
##    140        0.0117             nan     0.1000   -0.0002
##    160        0.0081             nan     0.1000   -0.0002
##    180        0.0060             nan     0.1000   -0.0000
##    200        0.0044             nan     0.1000   -0.0000
##    220        0.0035             nan     0.1000   -0.0001
##    240        0.0028             nan     0.1000   -0.0000
##    260        0.0020             nan     0.1000   -0.0001
##    280        0.0017             nan     0.1000   -0.0001
##    300        0.0014             nan     0.1000   -0.0000
##    320        0.0012             nan     0.1000   -0.0000
##    340        0.0007             nan     0.1000   -0.0000
##    360        0.0007             nan     0.1000   -0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1296             nan     0.1000    0.0712
##      2        1.0069             nan     0.1000    0.0608
##      3        0.9031             nan     0.1000    0.0502
##      4        0.8138             nan     0.1000    0.0391
##      5        0.7399             nan     0.1000    0.0351
##      6        0.6726             nan     0.1000    0.0327
##      7        0.6172             nan     0.1000    0.0254
##      8        0.5704             nan     0.1000    0.0194
##      9        0.5253             nan     0.1000    0.0206
##     10        0.4847             nan     0.1000    0.0164
##     20        0.2611             nan     0.1000    0.0046
##     40        0.1067             nan     0.1000    0.0001
##     60        0.0597             nan     0.1000   -0.0012
##     80        0.0323             nan     0.1000   -0.0001
##    100        0.0224             nan     0.1000   -0.0007
##    120        0.0137             nan     0.1000   -0.0002
##    140        0.0100             nan     0.1000   -0.0004
##    160        0.0066             nan     0.1000    0.0000
##    180        0.0048             nan     0.1000   -0.0001
##    200        0.0036             nan     0.1000   -0.0000
##    220        0.0027             nan     0.1000   -0.0000
##    240        0.0022             nan     0.1000   -0.0000
##    260        0.0018             nan     0.1000   -0.0000
##    280        0.0013             nan     0.1000   -0.0000
##    300        0.0012             nan     0.1000   -0.0001
##    320        0.0012             nan     0.1000   -0.0000
##    340        0.0009             nan     0.1000   -0.0001
##    360        0.0006             nan     0.1000   -0.0000
##    380        0.0005             nan     0.1000   -0.0000
##    400        0.0004             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000    0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1392             nan     0.1000    0.0741
##      2        1.0146             nan     0.1000    0.0564
##      3        0.9167             nan     0.1000    0.0434
##      4        0.8264             nan     0.1000    0.0443
##      5        0.7587             nan     0.1000    0.0306
##      6        0.6915             nan     0.1000    0.0317
##      7        0.6360             nan     0.1000    0.0256
##      8        0.5836             nan     0.1000    0.0247
##      9        0.5370             nan     0.1000    0.0228
##     10        0.4964             nan     0.1000    0.0190
##     20        0.2599             nan     0.1000    0.0049
##     40        0.1050             nan     0.1000   -0.0005
##     60        0.0562             nan     0.1000   -0.0008
##     80        0.0324             nan     0.1000   -0.0006
##    100        0.0207             nan     0.1000    0.0000
##    120        0.0146             nan     0.1000   -0.0002
##    140        0.0112             nan     0.1000   -0.0004
##    160        0.0077             nan     0.1000   -0.0003
##    180        0.0061             nan     0.1000   -0.0002
##    200        0.0041             nan     0.1000   -0.0000
##    220        0.0033             nan     0.1000   -0.0001
##    240        0.0024             nan     0.1000   -0.0000
##    260        0.0021             nan     0.1000   -0.0001
##    280        0.0015             nan     0.1000   -0.0000
##    300        0.0014             nan     0.1000   -0.0000
##    320        0.0013             nan     0.1000   -0.0001
##    340        0.0009             nan     0.1000   -0.0000
##    360        0.0006             nan     0.1000   -0.0000
##    380        0.0006             nan     0.1000   -0.0000
##    400        0.0004             nan     0.1000    0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0003             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0002             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1225             nan     0.1000    0.0810
##      2        0.9911             nan     0.1000    0.0652
##      3        0.8884             nan     0.1000    0.0475
##      4        0.8045             nan     0.1000    0.0395
##      5        0.7317             nan     0.1000    0.0328
##      6        0.6671             nan     0.1000    0.0288
##      7        0.6106             nan     0.1000    0.0256
##      8        0.5619             nan     0.1000    0.0218
##      9        0.5189             nan     0.1000    0.0197
##     10        0.4792             nan     0.1000    0.0184
##     20        0.2472             nan     0.1000    0.0068
##     40        0.0999             nan     0.1000   -0.0002
##     60        0.0558             nan     0.1000   -0.0004
##     80        0.0412             nan     0.1000   -0.0009
##    100        0.0275             nan     0.1000   -0.0007
##    120        0.0175             nan     0.1000   -0.0004
##    140        0.0128             nan     0.1000   -0.0004
##    160        0.0100             nan     0.1000   -0.0002
##    180        0.0071             nan     0.1000   -0.0003
##    200        0.0046             nan     0.1000   -0.0001
##    220        0.0030             nan     0.1000   -0.0001
##    240        0.0021             nan     0.1000   -0.0000
##    260        0.0014             nan     0.1000   -0.0000
##    280        0.0011             nan     0.1000   -0.0000
##    300        0.0009             nan     0.1000   -0.0000
##    320        0.0008             nan     0.1000   -0.0000
##    340        0.0007             nan     0.1000   -0.0000
##    360        0.0005             nan     0.1000   -0.0000
##    380        0.0005             nan     0.1000   -0.0000
##    400        0.0004             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0004             nan     0.1000   -0.0000
##    460        0.0003             nan     0.1000   -0.0000
##    480        0.0003             nan     0.1000   -0.0000
##    500        0.0002             nan     0.1000    0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1338             nan     0.1000    0.0711
##      2        1.0086             nan     0.1000    0.0608
##      3        0.9022             nan     0.1000    0.0488
##      4        0.8210             nan     0.1000    0.0366
##      5        0.7431             nan     0.1000    0.0361
##      6        0.6752             nan     0.1000    0.0334
##      7        0.6174             nan     0.1000    0.0262
##      8        0.5661             nan     0.1000    0.0247
##      9        0.5200             nan     0.1000    0.0198
##     10        0.4807             nan     0.1000    0.0176
##     20        0.2570             nan     0.1000    0.0050
##     40        0.1002             nan     0.1000    0.0021
##     60        0.0547             nan     0.1000   -0.0011
##     80        0.0324             nan     0.1000    0.0000
##    100        0.0213             nan     0.1000    0.0003
##    120        0.0147             nan     0.1000    0.0000
##    140        0.0099             nan     0.1000   -0.0003
##    160        0.0070             nan     0.1000   -0.0001
##    180        0.0047             nan     0.1000   -0.0001
##    200        0.0038             nan     0.1000   -0.0002
##    220        0.0028             nan     0.1000   -0.0001
##    240        0.0021             nan     0.1000   -0.0000
##    260        0.0015             nan     0.1000   -0.0000
##    280        0.0014             nan     0.1000   -0.0001
##    300        0.0008             nan     0.1000   -0.0000
##    320        0.0007             nan     0.1000   -0.0000
##    340        0.0006             nan     0.1000   -0.0000
##    360        0.0005             nan     0.1000   -0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1491             nan     0.1000    0.0664
##      2        1.0313             nan     0.1000    0.0568
##      3        0.9371             nan     0.1000    0.0447
##      4        0.8564             nan     0.1000    0.0363
##      5        0.7965             nan     0.1000    0.0289
##      6        0.7345             nan     0.1000    0.0285
##      7        0.6827             nan     0.1000    0.0231
##      8        0.6438             nan     0.1000    0.0162
##      9        0.6098             nan     0.1000    0.0132
##     10        0.5737             nan     0.1000    0.0177
##     20        0.3615             nan     0.1000    0.0062
##     40        0.2176             nan     0.1000    0.0004
##     60        0.1620             nan     0.1000   -0.0005
##     80        0.1335             nan     0.1000   -0.0002
##    100        0.1178             nan     0.1000   -0.0006
##    120        0.1079             nan     0.1000   -0.0013
##    140        0.1002             nan     0.1000   -0.0006
##    160        0.0927             nan     0.1000   -0.0009
##    180        0.0860             nan     0.1000   -0.0005
##    200        0.0837             nan     0.1000   -0.0002
##    220        0.0761             nan     0.1000   -0.0006
##    240        0.0741             nan     0.1000   -0.0006
##    260        0.0700             nan     0.1000   -0.0004
##    280        0.0690             nan     0.1000   -0.0009
##    300        0.0661             nan     0.1000   -0.0004
##    320        0.0647             nan     0.1000   -0.0010
##    340        0.0636             nan     0.1000   -0.0006
##    360        0.0611             nan     0.1000   -0.0004
##    380        0.0604             nan     0.1000   -0.0008
##    400        0.0593             nan     0.1000   -0.0006
##    420        0.0582             nan     0.1000   -0.0002
##    440        0.0573             nan     0.1000   -0.0008
##    460        0.0580             nan     0.1000   -0.0008
##    480        0.0563             nan     0.1000   -0.0005
##    500        0.0562             nan     0.1000   -0.0005
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1387             nan     0.1000    0.0695
##      2        1.0214             nan     0.1000    0.0589
##      3        0.9154             nan     0.1000    0.0522
##      4        0.8278             nan     0.1000    0.0422
##      5        0.7554             nan     0.1000    0.0367
##      6        0.6943             nan     0.1000    0.0287
##      7        0.6317             nan     0.1000    0.0272
##      8        0.5856             nan     0.1000    0.0222
##      9        0.5431             nan     0.1000    0.0196
##     10        0.5087             nan     0.1000    0.0168
##     20        0.2833             nan     0.1000    0.0052
##     40        0.1593             nan     0.1000    0.0003
##     60        0.1132             nan     0.1000   -0.0005
##     80        0.0895             nan     0.1000    0.0002
##    100        0.0734             nan     0.1000   -0.0005
##    120        0.0598             nan     0.1000   -0.0006
##    140        0.0519             nan     0.1000   -0.0003
##    160        0.0448             nan     0.1000   -0.0004
##    180        0.0399             nan     0.1000   -0.0005
##    200        0.0361             nan     0.1000   -0.0002
##    220        0.0321             nan     0.1000   -0.0001
##    240        0.0297             nan     0.1000   -0.0003
##    260        0.0264             nan     0.1000   -0.0002
##    280        0.0227             nan     0.1000   -0.0001
##    300        0.0206             nan     0.1000   -0.0002
##    320        0.0190             nan     0.1000   -0.0002
##    340        0.0167             nan     0.1000   -0.0001
##    360        0.0143             nan     0.1000   -0.0001
##    380        0.0128             nan     0.1000   -0.0002
##    400        0.0112             nan     0.1000   -0.0000
##    420        0.0102             nan     0.1000   -0.0000
##    440        0.0091             nan     0.1000   -0.0001
##    460        0.0086             nan     0.1000   -0.0001
##    480        0.0079             nan     0.1000   -0.0000
##    500        0.0070             nan     0.1000   -0.0001
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1324             nan     0.1000    0.0750
##      2        1.0107             nan     0.1000    0.0597
##      3        0.9140             nan     0.1000    0.0449
##      4        0.8229             nan     0.1000    0.0446
##      5        0.7546             nan     0.1000    0.0296
##      6        0.6960             nan     0.1000    0.0255
##      7        0.6398             nan     0.1000    0.0275
##      8        0.5914             nan     0.1000    0.0239
##      9        0.5463             nan     0.1000    0.0194
##     10        0.5062             nan     0.1000    0.0189
##     20        0.2759             nan     0.1000    0.0026
##     40        0.1280             nan     0.1000    0.0009
##     60        0.0883             nan     0.1000   -0.0009
##     80        0.0666             nan     0.1000   -0.0005
##    100        0.0504             nan     0.1000   -0.0003
##    120        0.0402             nan     0.1000   -0.0003
##    140        0.0321             nan     0.1000   -0.0003
##    160        0.0271             nan     0.1000    0.0000
##    180        0.0218             nan     0.1000   -0.0004
##    200        0.0176             nan     0.1000   -0.0001
##    220        0.0143             nan     0.1000    0.0000
##    240        0.0122             nan     0.1000   -0.0002
##    260        0.0099             nan     0.1000   -0.0001
##    280        0.0088             nan     0.1000   -0.0001
##    300        0.0074             nan     0.1000   -0.0000
##    320        0.0063             nan     0.1000   -0.0000
##    340        0.0050             nan     0.1000   -0.0000
##    360        0.0042             nan     0.1000   -0.0000
##    380        0.0033             nan     0.1000   -0.0000
##    400        0.0027             nan     0.1000   -0.0000
##    420        0.0022             nan     0.1000   -0.0000
##    440        0.0019             nan     0.1000   -0.0000
##    460        0.0016             nan     0.1000   -0.0000
##    480        0.0014             nan     0.1000   -0.0000
##    500        0.0012             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1365             nan     0.1000    0.0709
##      2        1.0144             nan     0.1000    0.0599
##      3        0.9107             nan     0.1000    0.0509
##      4        0.8248             nan     0.1000    0.0405
##      5        0.7534             nan     0.1000    0.0329
##      6        0.6857             nan     0.1000    0.0303
##      7        0.6307             nan     0.1000    0.0258
##      8        0.5759             nan     0.1000    0.0264
##      9        0.5315             nan     0.1000    0.0199
##     10        0.4908             nan     0.1000    0.0178
##     20        0.2617             nan     0.1000    0.0050
##     40        0.1223             nan     0.1000    0.0000
##     60        0.0736             nan     0.1000   -0.0011
##     80        0.0518             nan     0.1000   -0.0006
##    100        0.0383             nan     0.1000   -0.0002
##    120        0.0312             nan     0.1000   -0.0000
##    140        0.0218             nan     0.1000   -0.0001
##    160        0.0179             nan     0.1000   -0.0000
##    180        0.0147             nan     0.1000   -0.0001
##    200        0.0113             nan     0.1000   -0.0002
##    220        0.0088             nan     0.1000   -0.0001
##    240        0.0068             nan     0.1000   -0.0001
##    260        0.0053             nan     0.1000   -0.0001
##    280        0.0043             nan     0.1000   -0.0001
##    300        0.0036             nan     0.1000   -0.0000
##    320        0.0031             nan     0.1000   -0.0001
##    340        0.0022             nan     0.1000   -0.0000
##    360        0.0018             nan     0.1000   -0.0000
##    380        0.0015             nan     0.1000   -0.0000
##    400        0.0013             nan     0.1000   -0.0000
##    420        0.0010             nan     0.1000   -0.0000
##    440        0.0008             nan     0.1000   -0.0000
##    460        0.0007             nan     0.1000   -0.0000
##    480        0.0006             nan     0.1000   -0.0000
##    500        0.0005             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1274             nan     0.1000    0.0824
##      2        1.0048             nan     0.1000    0.0603
##      3        0.9093             nan     0.1000    0.0487
##      4        0.8202             nan     0.1000    0.0408
##      5        0.7465             nan     0.1000    0.0352
##      6        0.6835             nan     0.1000    0.0300
##      7        0.6276             nan     0.1000    0.0248
##      8        0.5766             nan     0.1000    0.0235
##      9        0.5329             nan     0.1000    0.0173
##     10        0.4927             nan     0.1000    0.0171
##     20        0.2589             nan     0.1000    0.0061
##     40        0.1114             nan     0.1000    0.0002
##     60        0.0634             nan     0.1000    0.0000
##     80        0.0413             nan     0.1000   -0.0004
##    100        0.0277             nan     0.1000   -0.0002
##    120        0.0197             nan     0.1000   -0.0001
##    140        0.0139             nan     0.1000   -0.0002
##    160        0.0107             nan     0.1000   -0.0002
##    180        0.0077             nan     0.1000   -0.0002
##    200        0.0061             nan     0.1000   -0.0002
##    220        0.0045             nan     0.1000   -0.0001
##    240        0.0036             nan     0.1000   -0.0000
##    260        0.0026             nan     0.1000   -0.0000
##    280        0.0019             nan     0.1000   -0.0000
##    300        0.0016             nan     0.1000   -0.0000
##    320        0.0012             nan     0.1000   -0.0000
##    340        0.0009             nan     0.1000   -0.0000
##    360        0.0007             nan     0.1000    0.0000
##    380        0.0006             nan     0.1000   -0.0000
##    400        0.0005             nan     0.1000   -0.0000
##    420        0.0004             nan     0.1000   -0.0000
##    440        0.0003             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000    0.0000
##    480        0.0002             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1371             nan     0.1000    0.0687
##      2        1.0153             nan     0.1000    0.0552
##      3        0.9113             nan     0.1000    0.0498
##      4        0.8274             nan     0.1000    0.0391
##      5        0.7517             nan     0.1000    0.0341
##      6        0.6833             nan     0.1000    0.0336
##      7        0.6269             nan     0.1000    0.0270
##      8        0.5778             nan     0.1000    0.0209
##      9        0.5322             nan     0.1000    0.0206
##     10        0.4922             nan     0.1000    0.0189
##     20        0.2678             nan     0.1000    0.0042
##     40        0.1037             nan     0.1000   -0.0006
##     60        0.0565             nan     0.1000   -0.0004
##     80        0.0353             nan     0.1000   -0.0003
##    100        0.0237             nan     0.1000   -0.0002
##    120        0.0183             nan     0.1000   -0.0002
##    140        0.0120             nan     0.1000   -0.0002
##    160        0.0090             nan     0.1000   -0.0001
##    180        0.0065             nan     0.1000    0.0001
##    200        0.0050             nan     0.1000   -0.0001
##    220        0.0037             nan     0.1000   -0.0001
##    240        0.0028             nan     0.1000   -0.0000
##    260        0.0020             nan     0.1000   -0.0001
##    280        0.0015             nan     0.1000    0.0000
##    300        0.0013             nan     0.1000   -0.0000
##    320        0.0010             nan     0.1000   -0.0000
##    340        0.0008             nan     0.1000   -0.0000
##    360        0.0006             nan     0.1000   -0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0004             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000    0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0002             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1314             nan     0.1000    0.0756
##      2        1.0051             nan     0.1000    0.0611
##      3        0.9026             nan     0.1000    0.0461
##      4        0.8142             nan     0.1000    0.0401
##      5        0.7389             nan     0.1000    0.0339
##      6        0.6725             nan     0.1000    0.0320
##      7        0.6198             nan     0.1000    0.0226
##      8        0.5711             nan     0.1000    0.0236
##      9        0.5246             nan     0.1000    0.0216
##     10        0.4829             nan     0.1000    0.0181
##     20        0.2550             nan     0.1000    0.0072
##     40        0.0953             nan     0.1000    0.0007
##     60        0.0522             nan     0.1000   -0.0008
##     80        0.0301             nan     0.1000   -0.0002
##    100        0.0195             nan     0.1000   -0.0001
##    120        0.0133             nan     0.1000   -0.0001
##    140        0.0090             nan     0.1000   -0.0002
##    160        0.0066             nan     0.1000   -0.0001
##    180        0.0048             nan     0.1000   -0.0000
##    200        0.0035             nan     0.1000   -0.0001
##    220        0.0027             nan     0.1000   -0.0000
##    240        0.0021             nan     0.1000   -0.0000
##    260        0.0014             nan     0.1000    0.0000
##    280        0.0010             nan     0.1000   -0.0000
##    300        0.0007             nan     0.1000   -0.0000
##    320        0.0005             nan     0.1000   -0.0000
##    340        0.0004             nan     0.1000   -0.0000
##    360        0.0003             nan     0.1000   -0.0000
##    380        0.0002             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0001             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000    0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1328             nan     0.1000    0.0737
##      2        1.0077             nan     0.1000    0.0619
##      3        0.9030             nan     0.1000    0.0490
##      4        0.8121             nan     0.1000    0.0439
##      5        0.7381             nan     0.1000    0.0332
##      6        0.6694             nan     0.1000    0.0339
##      7        0.6131             nan     0.1000    0.0260
##      8        0.5641             nan     0.1000    0.0221
##      9        0.5202             nan     0.1000    0.0205
##     10        0.4843             nan     0.1000    0.0148
##     20        0.2529             nan     0.1000    0.0045
##     40        0.0938             nan     0.1000   -0.0005
##     60        0.0456             nan     0.1000    0.0000
##     80        0.0264             nan     0.1000   -0.0005
##    100        0.0182             nan     0.1000   -0.0002
##    120        0.0118             nan     0.1000   -0.0002
##    140        0.0079             nan     0.1000   -0.0001
##    160        0.0062             nan     0.1000   -0.0001
##    180        0.0045             nan     0.1000   -0.0002
##    200        0.0032             nan     0.1000   -0.0000
##    220        0.0023             nan     0.1000   -0.0000
##    240        0.0020             nan     0.1000   -0.0001
##    260        0.0015             nan     0.1000   -0.0001
##    280        0.0012             nan     0.1000   -0.0000
##    300        0.0008             nan     0.1000   -0.0000
##    320        0.0007             nan     0.1000   -0.0000
##    340        0.0005             nan     0.1000   -0.0000
##    360        0.0004             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000    0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1297             nan     0.1000    0.0765
##      2        1.0052             nan     0.1000    0.0569
##      3        0.8979             nan     0.1000    0.0503
##      4        0.8061             nan     0.1000    0.0430
##      5        0.7345             nan     0.1000    0.0319
##      6        0.6675             nan     0.1000    0.0295
##      7        0.6085             nan     0.1000    0.0256
##      8        0.5604             nan     0.1000    0.0218
##      9        0.5150             nan     0.1000    0.0221
##     10        0.4743             nan     0.1000    0.0171
##     20        0.2487             nan     0.1000    0.0041
##     40        0.0954             nan     0.1000    0.0001
##     60        0.0521             nan     0.1000   -0.0005
##     80        0.0306             nan     0.1000   -0.0003
##    100        0.0214             nan     0.1000   -0.0002
##    120        0.0154             nan     0.1000   -0.0002
##    140        0.0113             nan     0.1000   -0.0001
##    160        0.0078             nan     0.1000   -0.0000
##    180        0.0059             nan     0.1000   -0.0001
##    200        0.0044             nan     0.1000   -0.0001
##    220        0.0030             nan     0.1000   -0.0001
##    240        0.0023             nan     0.1000   -0.0001
##    260        0.0016             nan     0.1000   -0.0000
##    280        0.0014             nan     0.1000   -0.0001
##    300        0.0009             nan     0.1000   -0.0000
##    320        0.0007             nan     0.1000   -0.0000
##    340        0.0005             nan     0.1000   -0.0000
##    360        0.0004             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1239             nan     0.1000    0.0769
##      2        0.9954             nan     0.1000    0.0626
##      3        0.8904             nan     0.1000    0.0487
##      4        0.8044             nan     0.1000    0.0383
##      5        0.7340             nan     0.1000    0.0317
##      6        0.6702             nan     0.1000    0.0305
##      7        0.6130             nan     0.1000    0.0262
##      8        0.5640             nan     0.1000    0.0218
##      9        0.5202             nan     0.1000    0.0192
##     10        0.4794             nan     0.1000    0.0187
##     20        0.2513             nan     0.1000    0.0045
##     40        0.0953             nan     0.1000    0.0005
##     60        0.0519             nan     0.1000   -0.0003
##     80        0.0350             nan     0.1000   -0.0003
##    100        0.0242             nan     0.1000   -0.0005
##    120        0.0141             nan     0.1000   -0.0001
##    140        0.0088             nan     0.1000   -0.0001
##    160        0.0056             nan     0.1000   -0.0001
##    180        0.0039             nan     0.1000   -0.0000
##    200        0.0029             nan     0.1000   -0.0001
##    220        0.0022             nan     0.1000   -0.0000
##    240        0.0019             nan     0.1000   -0.0000
##    260        0.0015             nan     0.1000   -0.0000
##    280        0.0011             nan     0.1000   -0.0000
##    300        0.0009             nan     0.1000   -0.0000
##    320        0.0008             nan     0.1000    0.0000
##    340        0.0007             nan     0.1000   -0.0000
##    360        0.0005             nan     0.1000   -0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0004             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000    0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0002             nan     0.1000   -0.0000
##    500        0.0003             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1466             nan     0.1000    0.0661
##      2        1.0433             nan     0.1000    0.0500
##      3        0.9458             nan     0.1000    0.0481
##      4        0.8639             nan     0.1000    0.0389
##      5        0.7918             nan     0.1000    0.0348
##      6        0.7312             nan     0.1000    0.0300
##      7        0.6776             nan     0.1000    0.0243
##      8        0.6327             nan     0.1000    0.0224
##      9        0.5925             nan     0.1000    0.0185
##     10        0.5557             nan     0.1000    0.0182
##     20        0.3583             nan     0.1000    0.0043
##     40        0.2201             nan     0.1000   -0.0006
##     60        0.1759             nan     0.1000   -0.0009
##     80        0.1527             nan     0.1000   -0.0008
##    100        0.1372             nan     0.1000   -0.0013
##    120        0.1269             nan     0.1000    0.0000
##    140        0.1154             nan     0.1000   -0.0005
##    160        0.1066             nan     0.1000   -0.0007
##    180        0.1007             nan     0.1000   -0.0003
##    200        0.0936             nan     0.1000   -0.0005
##    220        0.0914             nan     0.1000   -0.0008
##    240        0.0879             nan     0.1000   -0.0001
##    260        0.0846             nan     0.1000   -0.0003
##    280        0.0815             nan     0.1000   -0.0008
##    300        0.0797             nan     0.1000   -0.0009
##    320        0.0788             nan     0.1000   -0.0006
##    340        0.0752             nan     0.1000   -0.0011
##    360        0.0738             nan     0.1000   -0.0003
##    380        0.0721             nan     0.1000   -0.0007
##    400        0.0714             nan     0.1000   -0.0005
##    420        0.0700             nan     0.1000   -0.0008
##    440        0.0683             nan     0.1000   -0.0003
##    460        0.0676             nan     0.1000   -0.0005
##    480        0.0662             nan     0.1000   -0.0004
##    500        0.0650             nan     0.1000   -0.0007
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1372             nan     0.1000    0.0756
##      2        1.0143             nan     0.1000    0.0598
##      3        0.9145             nan     0.1000    0.0476
##      4        0.8274             nan     0.1000    0.0421
##      5        0.7507             nan     0.1000    0.0382
##      6        0.6939             nan     0.1000    0.0250
##      7        0.6390             nan     0.1000    0.0258
##      8        0.5913             nan     0.1000    0.0232
##      9        0.5479             nan     0.1000    0.0206
##     10        0.5102             nan     0.1000    0.0164
##     20        0.2949             nan     0.1000    0.0031
##     40        0.1682             nan     0.1000   -0.0003
##     60        0.1245             nan     0.1000   -0.0008
##     80        0.0967             nan     0.1000   -0.0011
##    100        0.0835             nan     0.1000   -0.0010
##    120        0.0699             nan     0.1000   -0.0007
##    140        0.0602             nan     0.1000   -0.0002
##    160        0.0549             nan     0.1000   -0.0003
##    180        0.0487             nan     0.1000   -0.0003
##    200        0.0434             nan     0.1000   -0.0008
##    220        0.0396             nan     0.1000   -0.0005
##    240        0.0356             nan     0.1000   -0.0002
##    260        0.0310             nan     0.1000   -0.0003
##    280        0.0288             nan     0.1000   -0.0003
##    300        0.0264             nan     0.1000   -0.0003
##    320        0.0243             nan     0.1000   -0.0004
##    340        0.0231             nan     0.1000   -0.0002
##    360        0.0206             nan     0.1000   -0.0003
##    380        0.0188             nan     0.1000   -0.0002
##    400        0.0170             nan     0.1000   -0.0003
##    420        0.0154             nan     0.1000   -0.0002
##    440        0.0139             nan     0.1000    0.0000
##    460        0.0128             nan     0.1000   -0.0000
##    480        0.0114             nan     0.1000   -0.0001
##    500        0.0106             nan     0.1000   -0.0001
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1309             nan     0.1000    0.0721
##      2        1.0076             nan     0.1000    0.0626
##      3        0.9050             nan     0.1000    0.0465
##      4        0.8241             nan     0.1000    0.0384
##      5        0.7524             nan     0.1000    0.0351
##      6        0.6838             nan     0.1000    0.0289
##      7        0.6296             nan     0.1000    0.0249
##      8        0.5843             nan     0.1000    0.0214
##      9        0.5383             nan     0.1000    0.0204
##     10        0.5013             nan     0.1000    0.0159
##     20        0.2780             nan     0.1000    0.0047
##     40        0.1375             nan     0.1000   -0.0007
##     60        0.0941             nan     0.1000   -0.0009
##     80        0.0699             nan     0.1000   -0.0010
##    100        0.0528             nan     0.1000    0.0001
##    120        0.0413             nan     0.1000   -0.0003
##    140        0.0360             nan     0.1000    0.0000
##    160        0.0308             nan     0.1000   -0.0004
##    180        0.0256             nan     0.1000   -0.0004
##    200        0.0206             nan     0.1000   -0.0001
##    220        0.0167             nan     0.1000   -0.0001
##    240        0.0141             nan     0.1000   -0.0001
##    260        0.0117             nan     0.1000   -0.0001
##    280        0.0099             nan     0.1000   -0.0002
##    300        0.0083             nan     0.1000   -0.0000
##    320        0.0073             nan     0.1000   -0.0001
##    340        0.0063             nan     0.1000   -0.0001
##    360        0.0054             nan     0.1000   -0.0000
##    380        0.0045             nan     0.1000   -0.0000
##    400        0.0041             nan     0.1000   -0.0001
##    420        0.0035             nan     0.1000   -0.0000
##    440        0.0029             nan     0.1000   -0.0000
##    460        0.0025             nan     0.1000   -0.0000
##    480        0.0021             nan     0.1000   -0.0000
##    500        0.0018             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1381             nan     0.1000    0.0744
##      2        1.0124             nan     0.1000    0.0623
##      3        0.9079             nan     0.1000    0.0496
##      4        0.8168             nan     0.1000    0.0461
##      5        0.7448             nan     0.1000    0.0336
##      6        0.6799             nan     0.1000    0.0294
##      7        0.6193             nan     0.1000    0.0275
##      8        0.5729             nan     0.1000    0.0211
##      9        0.5257             nan     0.1000    0.0213
##     10        0.4862             nan     0.1000    0.0186
##     20        0.2655             nan     0.1000    0.0048
##     40        0.1255             nan     0.1000   -0.0000
##     60        0.0828             nan     0.1000   -0.0014
##     80        0.0608             nan     0.1000   -0.0008
##    100        0.0437             nan     0.1000   -0.0005
##    120        0.0317             nan     0.1000   -0.0004
##    140        0.0242             nan     0.1000   -0.0002
##    160        0.0176             nan     0.1000   -0.0001
##    180        0.0138             nan     0.1000   -0.0000
##    200        0.0106             nan     0.1000   -0.0001
##    220        0.0086             nan     0.1000   -0.0000
##    240        0.0065             nan     0.1000   -0.0000
##    260        0.0053             nan     0.1000   -0.0001
##    280        0.0042             nan     0.1000   -0.0000
##    300        0.0035             nan     0.1000   -0.0000
##    320        0.0029             nan     0.1000   -0.0000
##    340        0.0022             nan     0.1000   -0.0000
##    360        0.0018             nan     0.1000   -0.0000
##    380        0.0013             nan     0.1000   -0.0000
##    400        0.0010             nan     0.1000   -0.0000
##    420        0.0008             nan     0.1000   -0.0000
##    440        0.0006             nan     0.1000   -0.0000
##    460        0.0005             nan     0.1000   -0.0000
##    480        0.0004             nan     0.1000   -0.0000
##    500        0.0003             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1331             nan     0.1000    0.0741
##      2        1.0097             nan     0.1000    0.0596
##      3        0.9025             nan     0.1000    0.0470
##      4        0.8165             nan     0.1000    0.0401
##      5        0.7428             nan     0.1000    0.0357
##      6        0.6783             nan     0.1000    0.0293
##      7        0.6228             nan     0.1000    0.0244
##      8        0.5700             nan     0.1000    0.0250
##      9        0.5274             nan     0.1000    0.0184
##     10        0.4874             nan     0.1000    0.0171
##     20        0.2637             nan     0.1000    0.0039
##     40        0.1162             nan     0.1000    0.0004
##     60        0.0662             nan     0.1000   -0.0005
##     80        0.0448             nan     0.1000   -0.0007
##    100        0.0313             nan     0.1000   -0.0002
##    120        0.0247             nan     0.1000    0.0001
##    140        0.0184             nan     0.1000   -0.0002
##    160        0.0133             nan     0.1000   -0.0002
##    180        0.0096             nan     0.1000   -0.0001
##    200        0.0069             nan     0.1000   -0.0002
##    220        0.0048             nan     0.1000   -0.0001
##    240        0.0037             nan     0.1000   -0.0001
##    260        0.0027             nan     0.1000    0.0000
##    280        0.0021             nan     0.1000   -0.0000
##    300        0.0015             nan     0.1000   -0.0000
##    320        0.0011             nan     0.1000   -0.0000
##    340        0.0008             nan     0.1000   -0.0000
##    360        0.0006             nan     0.1000   -0.0000
##    380        0.0005             nan     0.1000   -0.0000
##    400        0.0004             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000    0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1323             nan     0.1000    0.0753
##      2        1.0085             nan     0.1000    0.0596
##      3        0.9053             nan     0.1000    0.0505
##      4        0.8160             nan     0.1000    0.0443
##      5        0.7379             nan     0.1000    0.0352
##      6        0.6789             nan     0.1000    0.0264
##      7        0.6243             nan     0.1000    0.0225
##      8        0.5747             nan     0.1000    0.0215
##      9        0.5288             nan     0.1000    0.0217
##     10        0.4891             nan     0.1000    0.0186
##     20        0.2585             nan     0.1000    0.0057
##     40        0.1027             nan     0.1000    0.0008
##     60        0.0581             nan     0.1000   -0.0008
##     80        0.0389             nan     0.1000   -0.0005
##    100        0.0256             nan     0.1000   -0.0003
##    120        0.0175             nan     0.1000   -0.0001
##    140        0.0129             nan     0.1000   -0.0003
##    160        0.0092             nan     0.1000   -0.0000
##    180        0.0067             nan     0.1000   -0.0001
##    200        0.0046             nan     0.1000   -0.0000
##    220        0.0033             nan     0.1000    0.0000
##    240        0.0024             nan     0.1000   -0.0000
##    260        0.0016             nan     0.1000   -0.0000
##    280        0.0011             nan     0.1000   -0.0000
##    300        0.0008             nan     0.1000   -0.0000
##    320        0.0006             nan     0.1000   -0.0000
##    340        0.0005             nan     0.1000   -0.0000
##    360        0.0004             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1299             nan     0.1000    0.0744
##      2        1.0018             nan     0.1000    0.0626
##      3        0.8963             nan     0.1000    0.0482
##      4        0.8076             nan     0.1000    0.0419
##      5        0.7316             nan     0.1000    0.0394
##      6        0.6672             nan     0.1000    0.0296
##      7        0.6078             nan     0.1000    0.0274
##      8        0.5607             nan     0.1000    0.0190
##      9        0.5144             nan     0.1000    0.0192
##     10        0.4789             nan     0.1000    0.0150
##     20        0.2546             nan     0.1000    0.0030
##     40        0.1082             nan     0.1000   -0.0003
##     60        0.0587             nan     0.1000   -0.0007
##     80        0.0407             nan     0.1000   -0.0016
##    100        0.0254             nan     0.1000   -0.0000
##    120        0.0171             nan     0.1000   -0.0003
##    140        0.0125             nan     0.1000   -0.0005
##    160        0.0093             nan     0.1000   -0.0003
##    180        0.0070             nan     0.1000   -0.0001
##    200        0.0053             nan     0.1000   -0.0002
##    220        0.0041             nan     0.1000   -0.0002
##    240        0.0029             nan     0.1000   -0.0000
##    260        0.0020             nan     0.1000   -0.0000
##    280        0.0014             nan     0.1000   -0.0000
##    300        0.0010             nan     0.1000   -0.0000
##    320        0.0008             nan     0.1000   -0.0000
##    340        0.0005             nan     0.1000   -0.0000
##    360        0.0004             nan     0.1000   -0.0000
##    380        0.0002             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0001             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000    0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1347             nan     0.1000    0.0719
##      2        1.0126             nan     0.1000    0.0564
##      3        0.9078             nan     0.1000    0.0518
##      4        0.8233             nan     0.1000    0.0396
##      5        0.7449             nan     0.1000    0.0365
##      6        0.6781             nan     0.1000    0.0340
##      7        0.6232             nan     0.1000    0.0226
##      8        0.5720             nan     0.1000    0.0248
##      9        0.5300             nan     0.1000    0.0174
##     10        0.4925             nan     0.1000    0.0175
##     20        0.2562             nan     0.1000    0.0051
##     40        0.1031             nan     0.1000    0.0003
##     60        0.0482             nan     0.1000   -0.0004
##     80        0.0294             nan     0.1000   -0.0004
##    100        0.0191             nan     0.1000   -0.0003
##    120        0.0145             nan     0.1000   -0.0005
##    140        0.0109             nan     0.1000   -0.0000
##    160        0.0067             nan     0.1000   -0.0001
##    180        0.0045             nan     0.1000   -0.0001
##    200        0.0036             nan     0.1000   -0.0001
##    220        0.0026             nan     0.1000   -0.0000
##    240        0.0017             nan     0.1000   -0.0000
##    260        0.0013             nan     0.1000   -0.0000
##    280        0.0009             nan     0.1000   -0.0000
##    300        0.0008             nan     0.1000   -0.0000
##    320        0.0006             nan     0.1000    0.0000
##    340        0.0005             nan     0.1000   -0.0000
##    360        0.0003             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000    0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1303             nan     0.1000    0.0725
##      2        1.0023             nan     0.1000    0.0618
##      3        0.8951             nan     0.1000    0.0531
##      4        0.8087             nan     0.1000    0.0401
##      5        0.7378             nan     0.1000    0.0312
##      6        0.6752             nan     0.1000    0.0295
##      7        0.6190             nan     0.1000    0.0249
##      8        0.5697             nan     0.1000    0.0232
##      9        0.5274             nan     0.1000    0.0208
##     10        0.4886             nan     0.1000    0.0171
##     20        0.2496             nan     0.1000    0.0050
##     40        0.1027             nan     0.1000    0.0002
##     60        0.0485             nan     0.1000   -0.0004
##     80        0.0296             nan     0.1000   -0.0002
##    100        0.0194             nan     0.1000   -0.0001
##    120        0.0136             nan     0.1000   -0.0002
##    140        0.0107             nan     0.1000   -0.0003
##    160        0.0082             nan     0.1000   -0.0003
##    180        0.0060             nan     0.1000    0.0000
##    200        0.0040             nan     0.1000   -0.0001
##    220        0.0028             nan     0.1000   -0.0001
##    240        0.0021             nan     0.1000   -0.0000
##    260        0.0016             nan     0.1000   -0.0000
##    280        0.0012             nan     0.1000    0.0000
##    300        0.0009             nan     0.1000   -0.0000
##    320        0.0008             nan     0.1000   -0.0000
##    340        0.0006             nan     0.1000   -0.0000
##    360        0.0005             nan     0.1000   -0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000    0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1345             nan     0.1000    0.0759
##      2        1.0035             nan     0.1000    0.0667
##      3        0.8998             nan     0.1000    0.0497
##      4        0.8138             nan     0.1000    0.0401
##      5        0.7339             nan     0.1000    0.0358
##      6        0.6653             nan     0.1000    0.0300
##      7        0.6077             nan     0.1000    0.0244
##      8        0.5631             nan     0.1000    0.0177
##      9        0.5199             nan     0.1000    0.0198
##     10        0.4820             nan     0.1000    0.0165
##     20        0.2487             nan     0.1000    0.0050
##     40        0.0998             nan     0.1000   -0.0003
##     60        0.0496             nan     0.1000    0.0001
##     80        0.0320             nan     0.1000   -0.0005
##    100        0.0201             nan     0.1000   -0.0002
##    120        0.0123             nan     0.1000   -0.0002
##    140        0.0090             nan     0.1000   -0.0001
##    160        0.0061             nan     0.1000   -0.0001
##    180        0.0046             nan     0.1000   -0.0001
##    200        0.0036             nan     0.1000   -0.0001
##    220        0.0025             nan     0.1000   -0.0001
##    240        0.0021             nan     0.1000   -0.0000
##    260        0.0015             nan     0.1000   -0.0000
##    280        0.0010             nan     0.1000   -0.0000
##    300        0.0007             nan     0.1000   -0.0000
##    320        0.0006             nan     0.1000   -0.0000
##    340        0.0004             nan     0.1000   -0.0000
##    360        0.0003             nan     0.1000    0.0000
##    380        0.0002             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000    0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1463             nan     0.1000    0.0652
##      2        1.0342             nan     0.1000    0.0550
##      3        0.9444             nan     0.1000    0.0453
##      4        0.8684             nan     0.1000    0.0381
##      5        0.8040             nan     0.1000    0.0321
##      6        0.7465             nan     0.1000    0.0260
##      7        0.6950             nan     0.1000    0.0241
##      8        0.6533             nan     0.1000    0.0207
##      9        0.6164             nan     0.1000    0.0183
##     10        0.5806             nan     0.1000    0.0173
##     20        0.3862             nan     0.1000    0.0055
##     40        0.2442             nan     0.1000   -0.0012
##     60        0.1975             nan     0.1000   -0.0001
##     80        0.1744             nan     0.1000   -0.0005
##    100        0.1568             nan     0.1000   -0.0007
##    120        0.1465             nan     0.1000   -0.0011
##    140        0.1346             nan     0.1000   -0.0013
##    160        0.1249             nan     0.1000   -0.0020
##    180        0.1208             nan     0.1000   -0.0011
##    200        0.1147             nan     0.1000   -0.0003
##    220        0.1088             nan     0.1000   -0.0007
##    240        0.1043             nan     0.1000   -0.0006
##    260        0.1005             nan     0.1000   -0.0006
##    280        0.0960             nan     0.1000   -0.0012
##    300        0.0923             nan     0.1000   -0.0007
##    320        0.0919             nan     0.1000   -0.0009
##    340        0.0888             nan     0.1000   -0.0004
##    360        0.0870             nan     0.1000   -0.0005
##    380        0.0856             nan     0.1000   -0.0004
##    400        0.0836             nan     0.1000   -0.0013
##    420        0.0814             nan     0.1000   -0.0004
##    440        0.0804             nan     0.1000   -0.0010
##    460        0.0796             nan     0.1000   -0.0007
##    480        0.0785             nan     0.1000   -0.0005
##    500        0.0761             nan     0.1000   -0.0007
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1367             nan     0.1000    0.0690
##      2        1.0159             nan     0.1000    0.0581
##      3        0.9179             nan     0.1000    0.0474
##      4        0.8367             nan     0.1000    0.0380
##      5        0.7651             nan     0.1000    0.0339
##      6        0.7007             nan     0.1000    0.0311
##      7        0.6490             nan     0.1000    0.0229
##      8        0.6037             nan     0.1000    0.0213
##      9        0.5680             nan     0.1000    0.0180
##     10        0.5275             nan     0.1000    0.0175
##     20        0.3221             nan     0.1000    0.0042
##     40        0.1933             nan     0.1000   -0.0019
##     60        0.1488             nan     0.1000   -0.0002
##     80        0.1190             nan     0.1000   -0.0003
##    100        0.1011             nan     0.1000   -0.0008
##    120        0.0830             nan     0.1000    0.0000
##    140        0.0722             nan     0.1000   -0.0002
##    160        0.0639             nan     0.1000   -0.0011
##    180        0.0576             nan     0.1000   -0.0006
##    200        0.0506             nan     0.1000   -0.0006
##    220        0.0457             nan     0.1000   -0.0005
##    240        0.0421             nan     0.1000   -0.0005
##    260        0.0377             nan     0.1000   -0.0005
##    280        0.0341             nan     0.1000   -0.0005
##    300        0.0306             nan     0.1000   -0.0006
##    320        0.0274             nan     0.1000   -0.0002
##    340        0.0257             nan     0.1000   -0.0001
##    360        0.0232             nan     0.1000   -0.0002
##    380        0.0213             nan     0.1000   -0.0002
##    400        0.0193             nan     0.1000   -0.0002
##    420        0.0177             nan     0.1000   -0.0001
##    440        0.0162             nan     0.1000   -0.0001
##    460        0.0147             nan     0.1000   -0.0001
##    480        0.0130             nan     0.1000   -0.0001
##    500        0.0116             nan     0.1000   -0.0001
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1393             nan     0.1000    0.0704
##      2        1.0126             nan     0.1000    0.0623
##      3        0.9160             nan     0.1000    0.0480
##      4        0.8293             nan     0.1000    0.0411
##      5        0.7581             nan     0.1000    0.0336
##      6        0.7001             nan     0.1000    0.0254
##      7        0.6461             nan     0.1000    0.0257
##      8        0.5928             nan     0.1000    0.0251
##      9        0.5498             nan     0.1000    0.0197
##     10        0.5110             nan     0.1000    0.0183
##     20        0.2908             nan     0.1000    0.0038
##     40        0.1528             nan     0.1000   -0.0002
##     60        0.1092             nan     0.1000   -0.0011
##     80        0.0837             nan     0.1000   -0.0004
##    100        0.0675             nan     0.1000   -0.0015
##    120        0.0551             nan     0.1000   -0.0005
##    140        0.0458             nan     0.1000   -0.0003
##    160        0.0369             nan     0.1000   -0.0004
##    180        0.0298             nan     0.1000   -0.0005
##    200        0.0244             nan     0.1000   -0.0002
##    220        0.0207             nan     0.1000   -0.0001
##    240        0.0173             nan     0.1000   -0.0002
##    260        0.0147             nan     0.1000   -0.0001
##    280        0.0126             nan     0.1000   -0.0001
##    300        0.0108             nan     0.1000   -0.0001
##    320        0.0097             nan     0.1000   -0.0001
##    340        0.0080             nan     0.1000   -0.0000
##    360        0.0068             nan     0.1000   -0.0001
##    380        0.0058             nan     0.1000   -0.0001
##    400        0.0049             nan     0.1000    0.0000
##    420        0.0041             nan     0.1000   -0.0000
##    440        0.0035             nan     0.1000   -0.0000
##    460        0.0030             nan     0.1000   -0.0000
##    480        0.0026             nan     0.1000   -0.0000
##    500        0.0022             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1349             nan     0.1000    0.0692
##      2        1.0107             nan     0.1000    0.0604
##      3        0.9070             nan     0.1000    0.0479
##      4        0.8205             nan     0.1000    0.0379
##      5        0.7520             nan     0.1000    0.0313
##      6        0.6897             nan     0.1000    0.0292
##      7        0.6326             nan     0.1000    0.0264
##      8        0.5820             nan     0.1000    0.0223
##      9        0.5413             nan     0.1000    0.0183
##     10        0.5059             nan     0.1000    0.0143
##     20        0.2819             nan     0.1000    0.0051
##     40        0.1432             nan     0.1000    0.0002
##     60        0.0929             nan     0.1000   -0.0008
##     80        0.0662             nan     0.1000   -0.0010
##    100        0.0470             nan     0.1000   -0.0003
##    120        0.0355             nan     0.1000   -0.0000
##    140        0.0266             nan     0.1000   -0.0004
##    160        0.0202             nan     0.1000   -0.0000
##    180        0.0161             nan     0.1000   -0.0001
##    200        0.0125             nan     0.1000   -0.0002
##    220        0.0100             nan     0.1000   -0.0002
##    240        0.0079             nan     0.1000   -0.0000
##    260        0.0065             nan     0.1000   -0.0000
##    280        0.0051             nan     0.1000   -0.0000
##    300        0.0041             nan     0.1000   -0.0001
##    320        0.0033             nan     0.1000   -0.0000
##    340        0.0026             nan     0.1000   -0.0000
##    360        0.0021             nan     0.1000   -0.0000
##    380        0.0018             nan     0.1000   -0.0000
##    400        0.0014             nan     0.1000   -0.0000
##    420        0.0011             nan     0.1000   -0.0000
##    440        0.0009             nan     0.1000   -0.0000
##    460        0.0008             nan     0.1000   -0.0000
##    480        0.0006             nan     0.1000   -0.0000
##    500        0.0006             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1244             nan     0.1000    0.0809
##      2        1.0035             nan     0.1000    0.0611
##      3        0.9046             nan     0.1000    0.0493
##      4        0.8213             nan     0.1000    0.0406
##      5        0.7470             nan     0.1000    0.0335
##      6        0.6871             nan     0.1000    0.0255
##      7        0.6310             nan     0.1000    0.0283
##      8        0.5837             nan     0.1000    0.0198
##      9        0.5376             nan     0.1000    0.0211
##     10        0.5012             nan     0.1000    0.0132
##     20        0.2792             nan     0.1000    0.0051
##     40        0.1339             nan     0.1000   -0.0007
##     60        0.0862             nan     0.1000   -0.0009
##     80        0.0562             nan     0.1000   -0.0005
##    100        0.0398             nan     0.1000   -0.0001
##    120        0.0278             nan     0.1000   -0.0000
##    140        0.0207             nan     0.1000   -0.0004
##    160        0.0153             nan     0.1000   -0.0002
##    180        0.0125             nan     0.1000   -0.0001
##    200        0.0089             nan     0.1000   -0.0001
##    220        0.0069             nan     0.1000    0.0000
##    240        0.0055             nan     0.1000   -0.0001
##    260        0.0040             nan     0.1000   -0.0000
##    280        0.0032             nan     0.1000   -0.0001
##    300        0.0026             nan     0.1000   -0.0000
##    320        0.0021             nan     0.1000   -0.0000
##    340        0.0016             nan     0.1000   -0.0000
##    360        0.0013             nan     0.1000   -0.0000
##    380        0.0010             nan     0.1000   -0.0000
##    400        0.0008             nan     0.1000   -0.0000
##    420        0.0006             nan     0.1000   -0.0000
##    440        0.0005             nan     0.1000   -0.0000
##    460        0.0004             nan     0.1000    0.0000
##    480        0.0003             nan     0.1000   -0.0000
##    500        0.0002             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1337             nan     0.1000    0.0750
##      2        1.0115             nan     0.1000    0.0596
##      3        0.9078             nan     0.1000    0.0458
##      4        0.8246             nan     0.1000    0.0393
##      5        0.7494             nan     0.1000    0.0343
##      6        0.6828             nan     0.1000    0.0343
##      7        0.6270             nan     0.1000    0.0241
##      8        0.5763             nan     0.1000    0.0226
##      9        0.5320             nan     0.1000    0.0184
##     10        0.4936             nan     0.1000    0.0164
##     20        0.2718             nan     0.1000    0.0026
##     40        0.1226             nan     0.1000   -0.0000
##     60        0.0705             nan     0.1000   -0.0003
##     80        0.0464             nan     0.1000   -0.0007
##    100        0.0303             nan     0.1000   -0.0001
##    120        0.0216             nan     0.1000   -0.0003
##    140        0.0150             nan     0.1000    0.0000
##    160        0.0108             nan     0.1000   -0.0001
##    180        0.0077             nan     0.1000   -0.0001
##    200        0.0065             nan     0.1000   -0.0001
##    220        0.0043             nan     0.1000   -0.0000
##    240        0.0034             nan     0.1000   -0.0001
##    260        0.0024             nan     0.1000   -0.0000
##    280        0.0018             nan     0.1000   -0.0000
##    300        0.0013             nan     0.1000   -0.0000
##    320        0.0011             nan     0.1000   -0.0000
##    340        0.0008             nan     0.1000   -0.0000
##    360        0.0006             nan     0.1000    0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000    0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1348             nan     0.1000    0.0735
##      2        1.0100             nan     0.1000    0.0588
##      3        0.9099             nan     0.1000    0.0496
##      4        0.8261             nan     0.1000    0.0387
##      5        0.7515             nan     0.1000    0.0358
##      6        0.6889             nan     0.1000    0.0292
##      7        0.6359             nan     0.1000    0.0250
##      8        0.5875             nan     0.1000    0.0213
##      9        0.5424             nan     0.1000    0.0186
##     10        0.5021             nan     0.1000    0.0167
##     20        0.2723             nan     0.1000    0.0039
##     40        0.1227             nan     0.1000   -0.0002
##     60        0.0722             nan     0.1000   -0.0002
##     80        0.0462             nan     0.1000   -0.0004
##    100        0.0300             nan     0.1000   -0.0006
##    120        0.0195             nan     0.1000   -0.0003
##    140        0.0131             nan     0.1000   -0.0001
##    160        0.0093             nan     0.1000   -0.0001
##    180        0.0066             nan     0.1000   -0.0002
##    200        0.0050             nan     0.1000   -0.0001
##    220        0.0040             nan     0.1000   -0.0001
##    240        0.0023             nan     0.1000   -0.0000
##    260        0.0016             nan     0.1000   -0.0000
##    280        0.0012             nan     0.1000   -0.0000
##    300        0.0009             nan     0.1000   -0.0000
##    320        0.0007             nan     0.1000    0.0000
##    340        0.0005             nan     0.1000   -0.0000
##    360        0.0004             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000    0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1304             nan     0.1000    0.0791
##      2        1.0064             nan     0.1000    0.0616
##      3        0.9016             nan     0.1000    0.0474
##      4        0.8138             nan     0.1000    0.0432
##      5        0.7401             nan     0.1000    0.0356
##      6        0.6764             nan     0.1000    0.0305
##      7        0.6219             nan     0.1000    0.0246
##      8        0.5741             nan     0.1000    0.0222
##      9        0.5332             nan     0.1000    0.0175
##     10        0.4967             nan     0.1000    0.0156
##     20        0.2779             nan     0.1000    0.0029
##     40        0.1226             nan     0.1000    0.0011
##     60        0.0673             nan     0.1000   -0.0007
##     80        0.0416             nan     0.1000   -0.0005
##    100        0.0285             nan     0.1000   -0.0005
##    120        0.0192             nan     0.1000   -0.0004
##    140        0.0138             nan     0.1000   -0.0002
##    160        0.0111             nan     0.1000   -0.0004
##    180        0.0074             nan     0.1000   -0.0000
##    200        0.0053             nan     0.1000   -0.0001
##    220        0.0044             nan     0.1000   -0.0002
##    240        0.0037             nan     0.1000   -0.0000
##    260        0.0028             nan     0.1000   -0.0001
##    280        0.0020             nan     0.1000   -0.0000
##    300        0.0013             nan     0.1000   -0.0000
##    320        0.0009             nan     0.1000   -0.0000
##    340        0.0007             nan     0.1000   -0.0000
##    360        0.0006             nan     0.1000   -0.0000
##    380        0.0006             nan     0.1000   -0.0000
##    400        0.0005             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0003             nan     0.1000   -0.0000
##    460        0.0003             nan     0.1000    0.0000
##    480        0.0002             nan     0.1000   -0.0000
##    500        0.0002             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1304             nan     0.1000    0.0727
##      2        1.0121             nan     0.1000    0.0582
##      3        0.9117             nan     0.1000    0.0507
##      4        0.8243             nan     0.1000    0.0427
##      5        0.7510             nan     0.1000    0.0332
##      6        0.6856             nan     0.1000    0.0305
##      7        0.6327             nan     0.1000    0.0237
##      8        0.5842             nan     0.1000    0.0210
##      9        0.5379             nan     0.1000    0.0211
##     10        0.5016             nan     0.1000    0.0171
##     20        0.2693             nan     0.1000    0.0052
##     40        0.1153             nan     0.1000    0.0004
##     60        0.0604             nan     0.1000   -0.0011
##     80        0.0375             nan     0.1000   -0.0002
##    100        0.0245             nan     0.1000   -0.0003
##    120        0.0164             nan     0.1000   -0.0006
##    140        0.0108             nan     0.1000   -0.0001
##    160        0.0081             nan     0.1000   -0.0002
##    180        0.0056             nan     0.1000   -0.0001
##    200        0.0038             nan     0.1000   -0.0001
##    220        0.0026             nan     0.1000   -0.0001
##    240        0.0018             nan     0.1000   -0.0000
##    260        0.0014             nan     0.1000   -0.0000
##    280        0.0009             nan     0.1000   -0.0000
##    300        0.0008             nan     0.1000   -0.0000
##    320        0.0007             nan     0.1000   -0.0000
##    340        0.0005             nan     0.1000   -0.0000
##    360        0.0004             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000    0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1335             nan     0.1000    0.0747
##      2        1.0122             nan     0.1000    0.0595
##      3        0.9150             nan     0.1000    0.0479
##      4        0.8230             nan     0.1000    0.0435
##      5        0.7477             nan     0.1000    0.0336
##      6        0.6883             nan     0.1000    0.0286
##      7        0.6328             nan     0.1000    0.0233
##      8        0.5826             nan     0.1000    0.0239
##      9        0.5380             nan     0.1000    0.0212
##     10        0.4963             nan     0.1000    0.0202
##     20        0.2634             nan     0.1000    0.0058
##     40        0.1070             nan     0.1000   -0.0011
##     60        0.0553             nan     0.1000   -0.0001
##     80        0.0353             nan     0.1000   -0.0003
##    100        0.0256             nan     0.1000   -0.0006
##    120        0.0167             nan     0.1000   -0.0002
##    140        0.0114             nan     0.1000   -0.0004
##    160        0.0083             nan     0.1000   -0.0000
##    180        0.0056             nan     0.1000   -0.0000
##    200        0.0038             nan     0.1000    0.0000
##    220        0.0029             nan     0.1000   -0.0000
##    240        0.0025             nan     0.1000   -0.0000
##    260        0.0016             nan     0.1000   -0.0000
##    280        0.0012             nan     0.1000   -0.0000
##    300        0.0008             nan     0.1000   -0.0000
##    320        0.0006             nan     0.1000    0.0000
##    340        0.0005             nan     0.1000    0.0000
##    360        0.0003             nan     0.1000   -0.0000
##    380        0.0002             nan     0.1000   -0.0000
##    400        0.0001             nan     0.1000   -0.0000
##    420        0.0001             nan     0.1000    0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1672             nan     0.1000    0.0564
##      2        1.0603             nan     0.1000    0.0543
##      3        0.9636             nan     0.1000    0.0452
##      4        0.8785             nan     0.1000    0.0405
##      5        0.8108             nan     0.1000    0.0341
##      6        0.7523             nan     0.1000    0.0273
##      7        0.7144             nan     0.1000    0.0156
##      8        0.6715             nan     0.1000    0.0199
##      9        0.6278             nan     0.1000    0.0205
##     10        0.5939             nan     0.1000    0.0161
##     20        0.3797             nan     0.1000    0.0051
##     40        0.2421             nan     0.1000    0.0007
##     60        0.1969             nan     0.1000   -0.0014
##     80        0.1797             nan     0.1000   -0.0004
##    100        0.1635             nan     0.1000   -0.0017
##    120        0.1491             nan     0.1000   -0.0014
##    140        0.1417             nan     0.1000   -0.0015
##    160        0.1361             nan     0.1000   -0.0005
##    180        0.1312             nan     0.1000   -0.0022
##    200        0.1242             nan     0.1000   -0.0005
##    220        0.1216             nan     0.1000   -0.0011
##    240        0.1192             nan     0.1000   -0.0012
##    260        0.1166             nan     0.1000   -0.0004
##    280        0.1128             nan     0.1000   -0.0005
##    300        0.1107             nan     0.1000   -0.0007
##    320        0.1084             nan     0.1000   -0.0006
##    340        0.1085             nan     0.1000   -0.0015
##    360        0.1039             nan     0.1000   -0.0006
##    380        0.1031             nan     0.1000   -0.0013
##    400        0.1028             nan     0.1000   -0.0018
##    420        0.0991             nan     0.1000   -0.0016
##    440        0.0997             nan     0.1000   -0.0011
##    460        0.0971             nan     0.1000   -0.0002
##    480        0.0960             nan     0.1000   -0.0005
##    500        0.0955             nan     0.1000   -0.0007
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1491             nan     0.1000    0.0640
##      2        1.0313             nan     0.1000    0.0579
##      3        0.9290             nan     0.1000    0.0491
##      4        0.8475             nan     0.1000    0.0415
##      5        0.7828             nan     0.1000    0.0330
##      6        0.7193             nan     0.1000    0.0292
##      7        0.6685             nan     0.1000    0.0250
##      8        0.6244             nan     0.1000    0.0199
##      9        0.5826             nan     0.1000    0.0192
##     10        0.5412             nan     0.1000    0.0196
##     20        0.3160             nan     0.1000    0.0050
##     40        0.1956             nan     0.1000   -0.0024
##     60        0.1517             nan     0.1000   -0.0015
##     80        0.1246             nan     0.1000   -0.0009
##    100        0.1079             nan     0.1000   -0.0010
##    120        0.0911             nan     0.1000   -0.0010
##    140        0.0796             nan     0.1000   -0.0008
##    160        0.0713             nan     0.1000   -0.0011
##    180        0.0642             nan     0.1000   -0.0001
##    200        0.0555             nan     0.1000   -0.0000
##    220        0.0509             nan     0.1000   -0.0009
##    240        0.0448             nan     0.1000   -0.0003
##    260        0.0418             nan     0.1000   -0.0005
##    280        0.0372             nan     0.1000   -0.0003
##    300        0.0339             nan     0.1000   -0.0002
##    320        0.0312             nan     0.1000   -0.0002
##    340        0.0284             nan     0.1000   -0.0002
##    360        0.0260             nan     0.1000   -0.0002
##    380        0.0240             nan     0.1000   -0.0002
##    400        0.0223             nan     0.1000   -0.0001
##    420        0.0208             nan     0.1000   -0.0001
##    440        0.0194             nan     0.1000   -0.0002
##    460        0.0182             nan     0.1000   -0.0001
##    480        0.0170             nan     0.1000   -0.0001
##    500        0.0154             nan     0.1000   -0.0002
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1390             nan     0.1000    0.0718
##      2        1.0173             nan     0.1000    0.0584
##      3        0.9175             nan     0.1000    0.0492
##      4        0.8303             nan     0.1000    0.0419
##      5        0.7591             nan     0.1000    0.0341
##      6        0.6968             nan     0.1000    0.0300
##      7        0.6442             nan     0.1000    0.0249
##      8        0.5967             nan     0.1000    0.0214
##      9        0.5527             nan     0.1000    0.0201
##     10        0.5113             nan     0.1000    0.0183
##     20        0.2895             nan     0.1000    0.0030
##     40        0.1563             nan     0.1000    0.0004
##     60        0.1143             nan     0.1000   -0.0011
##     80        0.0909             nan     0.1000   -0.0011
##    100        0.0727             nan     0.1000    0.0002
##    120        0.0593             nan     0.1000   -0.0004
##    140        0.0459             nan     0.1000   -0.0006
##    160        0.0385             nan     0.1000   -0.0002
##    180        0.0317             nan     0.1000   -0.0001
##    200        0.0265             nan     0.1000   -0.0001
##    220        0.0223             nan     0.1000   -0.0002
##    240        0.0185             nan     0.1000   -0.0002
##    260        0.0160             nan     0.1000   -0.0001
##    280        0.0135             nan     0.1000   -0.0002
##    300        0.0116             nan     0.1000   -0.0001
##    320        0.0106             nan     0.1000   -0.0001
##    340        0.0090             nan     0.1000   -0.0001
##    360        0.0079             nan     0.1000   -0.0001
##    380        0.0069             nan     0.1000   -0.0001
##    400        0.0060             nan     0.1000   -0.0000
##    420        0.0051             nan     0.1000   -0.0000
##    440        0.0043             nan     0.1000   -0.0000
##    460        0.0037             nan     0.1000   -0.0000
##    480        0.0032             nan     0.1000   -0.0001
##    500        0.0028             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1380             nan     0.1000    0.0739
##      2        1.0122             nan     0.1000    0.0624
##      3        0.9070             nan     0.1000    0.0495
##      4        0.8218             nan     0.1000    0.0407
##      5        0.7438             nan     0.1000    0.0360
##      6        0.6787             nan     0.1000    0.0311
##      7        0.6260             nan     0.1000    0.0253
##      8        0.5797             nan     0.1000    0.0214
##      9        0.5373             nan     0.1000    0.0184
##     10        0.5047             nan     0.1000    0.0143
##     20        0.2770             nan     0.1000    0.0052
##     40        0.1391             nan     0.1000    0.0005
##     60        0.0904             nan     0.1000   -0.0004
##     80        0.0656             nan     0.1000   -0.0010
##    100        0.0477             nan     0.1000   -0.0004
##    120        0.0366             nan     0.1000   -0.0004
##    140        0.0273             nan     0.1000   -0.0000
##    160        0.0218             nan     0.1000   -0.0006
##    180        0.0176             nan     0.1000   -0.0001
##    200        0.0137             nan     0.1000   -0.0001
##    220        0.0114             nan     0.1000   -0.0001
##    240        0.0095             nan     0.1000   -0.0001
##    260        0.0078             nan     0.1000   -0.0001
##    280        0.0063             nan     0.1000   -0.0001
##    300        0.0052             nan     0.1000   -0.0001
##    320        0.0042             nan     0.1000   -0.0000
##    340        0.0033             nan     0.1000   -0.0000
##    360        0.0027             nan     0.1000   -0.0000
##    380        0.0022             nan     0.1000   -0.0000
##    400        0.0018             nan     0.1000   -0.0000
##    420        0.0015             nan     0.1000   -0.0000
##    440        0.0012             nan     0.1000   -0.0000
##    460        0.0010             nan     0.1000   -0.0000
##    480        0.0008             nan     0.1000   -0.0000
##    500        0.0007             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1361             nan     0.1000    0.0735
##      2        1.0105             nan     0.1000    0.0628
##      3        0.9093             nan     0.1000    0.0493
##      4        0.8260             nan     0.1000    0.0402
##      5        0.7538             nan     0.1000    0.0338
##      6        0.6921             nan     0.1000    0.0296
##      7        0.6380             nan     0.1000    0.0244
##      8        0.5886             nan     0.1000    0.0229
##      9        0.5461             nan     0.1000    0.0178
##     10        0.5031             nan     0.1000    0.0182
##     20        0.2787             nan     0.1000    0.0024
##     40        0.1288             nan     0.1000   -0.0009
##     60        0.0781             nan     0.1000   -0.0003
##     80        0.0530             nan     0.1000   -0.0003
##    100        0.0359             nan     0.1000   -0.0004
##    120        0.0261             nan     0.1000   -0.0005
##    140        0.0208             nan     0.1000   -0.0001
##    160        0.0162             nan     0.1000   -0.0003
##    180        0.0119             nan     0.1000   -0.0000
##    200        0.0091             nan     0.1000   -0.0000
##    220        0.0068             nan     0.1000   -0.0001
##    240        0.0056             nan     0.1000   -0.0001
##    260        0.0043             nan     0.1000   -0.0001
##    280        0.0032             nan     0.1000   -0.0000
##    300        0.0025             nan     0.1000   -0.0000
##    320        0.0021             nan     0.1000   -0.0000
##    340        0.0018             nan     0.1000   -0.0000
##    360        0.0015             nan     0.1000   -0.0000
##    380        0.0011             nan     0.1000   -0.0000
##    400        0.0009             nan     0.1000   -0.0000
##    420        0.0007             nan     0.1000   -0.0000
##    440        0.0005             nan     0.1000   -0.0000
##    460        0.0004             nan     0.1000   -0.0000
##    480        0.0003             nan     0.1000   -0.0000
##    500        0.0003             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1312             nan     0.1000    0.0757
##      2        1.0038             nan     0.1000    0.0626
##      3        0.9045             nan     0.1000    0.0462
##      4        0.8277             nan     0.1000    0.0321
##      5        0.7513             nan     0.1000    0.0355
##      6        0.6904             nan     0.1000    0.0273
##      7        0.6364             nan     0.1000    0.0233
##      8        0.5904             nan     0.1000    0.0195
##      9        0.5493             nan     0.1000    0.0177
##     10        0.5145             nan     0.1000    0.0136
##     20        0.2801             nan     0.1000    0.0065
##     40        0.1282             nan     0.1000   -0.0007
##     60        0.0780             nan     0.1000   -0.0011
##     80        0.0543             nan     0.1000   -0.0005
##    100        0.0413             nan     0.1000   -0.0008
##    120        0.0270             nan     0.1000   -0.0002
##    140        0.0183             nan     0.1000   -0.0002
##    160        0.0142             nan     0.1000   -0.0004
##    180        0.0110             nan     0.1000   -0.0001
##    200        0.0078             nan     0.1000   -0.0002
##    220        0.0061             nan     0.1000   -0.0001
##    240        0.0046             nan     0.1000   -0.0001
##    260        0.0035             nan     0.1000   -0.0000
##    280        0.0028             nan     0.1000   -0.0000
##    300        0.0022             nan     0.1000    0.0000
##    320        0.0017             nan     0.1000   -0.0000
##    340        0.0012             nan     0.1000   -0.0000
##    360        0.0009             nan     0.1000   -0.0000
##    380        0.0007             nan     0.1000   -0.0000
##    400        0.0006             nan     0.1000   -0.0000
##    420        0.0004             nan     0.1000   -0.0000
##    440        0.0003             nan     0.1000   -0.0000
##    460        0.0003             nan     0.1000   -0.0000
##    480        0.0002             nan     0.1000   -0.0000
##    500        0.0002             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1331             nan     0.1000    0.0763
##      2        1.0114             nan     0.1000    0.0600
##      3        0.9073             nan     0.1000    0.0494
##      4        0.8249             nan     0.1000    0.0370
##      5        0.7560             nan     0.1000    0.0323
##      6        0.6937             nan     0.1000    0.0306
##      7        0.6357             nan     0.1000    0.0247
##      8        0.5864             nan     0.1000    0.0221
##      9        0.5455             nan     0.1000    0.0174
##     10        0.5062             nan     0.1000    0.0179
##     20        0.2692             nan     0.1000    0.0048
##     40        0.1150             nan     0.1000   -0.0012
##     60        0.0692             nan     0.1000   -0.0002
##     80        0.0454             nan     0.1000   -0.0011
##    100        0.0309             nan     0.1000   -0.0006
##    120        0.0233             nan     0.1000   -0.0004
##    140        0.0173             nan     0.1000   -0.0004
##    160        0.0139             nan     0.1000   -0.0004
##    180        0.0085             nan     0.1000    0.0000
##    200        0.0066             nan     0.1000   -0.0002
##    220        0.0054             nan     0.1000   -0.0002
##    240        0.0040             nan     0.1000   -0.0002
##    260        0.0030             nan     0.1000   -0.0001
##    280        0.0020             nan     0.1000   -0.0000
##    300        0.0015             nan     0.1000   -0.0001
##    320        0.0011             nan     0.1000   -0.0000
##    340        0.0009             nan     0.1000   -0.0000
##    360        0.0006             nan     0.1000   -0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0003             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1371             nan     0.1000    0.0716
##      2        1.0154             nan     0.1000    0.0542
##      3        0.9140             nan     0.1000    0.0434
##      4        0.8200             nan     0.1000    0.0431
##      5        0.7398             nan     0.1000    0.0370
##      6        0.6788             nan     0.1000    0.0273
##      7        0.6220             nan     0.1000    0.0266
##      8        0.5774             nan     0.1000    0.0162
##      9        0.5341             nan     0.1000    0.0190
##     10        0.4956             nan     0.1000    0.0169
##     20        0.2704             nan     0.1000    0.0045
##     40        0.1160             nan     0.1000   -0.0005
##     60        0.0646             nan     0.1000   -0.0001
##     80        0.0383             nan     0.1000    0.0000
##    100        0.0238             nan     0.1000   -0.0001
##    120        0.0160             nan     0.1000   -0.0003
##    140        0.0103             nan     0.1000   -0.0002
##    160        0.0068             nan     0.1000   -0.0001
##    180        0.0045             nan     0.1000   -0.0001
##    200        0.0034             nan     0.1000   -0.0001
##    220        0.0027             nan     0.1000   -0.0000
##    240        0.0020             nan     0.1000   -0.0000
##    260        0.0015             nan     0.1000   -0.0000
##    280        0.0011             nan     0.1000    0.0000
##    300        0.0008             nan     0.1000   -0.0000
##    320        0.0006             nan     0.1000   -0.0000
##    340        0.0005             nan     0.1000   -0.0000
##    360        0.0004             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0001             nan     0.1000    0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1364             nan     0.1000    0.0763
##      2        1.0169             nan     0.1000    0.0565
##      3        0.9170             nan     0.1000    0.0505
##      4        0.8279             nan     0.1000    0.0433
##      5        0.7562             nan     0.1000    0.0324
##      6        0.6882             nan     0.1000    0.0316
##      7        0.6320             nan     0.1000    0.0272
##      8        0.5828             nan     0.1000    0.0220
##      9        0.5389             nan     0.1000    0.0183
##     10        0.5006             nan     0.1000    0.0153
##     20        0.2701             nan     0.1000    0.0055
##     40        0.1142             nan     0.1000   -0.0006
##     60        0.0661             nan     0.1000    0.0007
##     80        0.0419             nan     0.1000   -0.0005
##    100        0.0300             nan     0.1000   -0.0001
##    120        0.0207             nan     0.1000   -0.0003
##    140        0.0153             nan     0.1000   -0.0003
##    160        0.0099             nan     0.1000   -0.0002
##    180        0.0071             nan     0.1000   -0.0002
##    200        0.0053             nan     0.1000   -0.0000
##    220        0.0039             nan     0.1000   -0.0002
##    240        0.0032             nan     0.1000   -0.0001
##    260        0.0028             nan     0.1000   -0.0001
##    280        0.0024             nan     0.1000   -0.0001
##    300        0.0016             nan     0.1000   -0.0000
##    320        0.0010             nan     0.1000   -0.0000
##    340        0.0007             nan     0.1000   -0.0000
##    360        0.0005             nan     0.1000   -0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0002             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1327             nan     0.1000    0.0713
##      2        1.0079             nan     0.1000    0.0563
##      3        0.9086             nan     0.1000    0.0468
##      4        0.8241             nan     0.1000    0.0393
##      5        0.7548             nan     0.1000    0.0333
##      6        0.6908             nan     0.1000    0.0296
##      7        0.6416             nan     0.1000    0.0207
##      8        0.5931             nan     0.1000    0.0209
##      9        0.5493             nan     0.1000    0.0196
##     10        0.5120             nan     0.1000    0.0165
##     20        0.2683             nan     0.1000    0.0055
##     40        0.1133             nan     0.1000   -0.0001
##     60        0.0649             nan     0.1000   -0.0005
##     80        0.0443             nan     0.1000   -0.0004
##    100        0.0268             nan     0.1000   -0.0003
##    120        0.0192             nan     0.1000   -0.0003
##    140        0.0131             nan     0.1000   -0.0002
##    160        0.0091             nan     0.1000   -0.0000
##    180        0.0067             nan     0.1000   -0.0001
##    200        0.0051             nan     0.1000   -0.0001
##    220        0.0035             nan     0.1000   -0.0001
##    240        0.0027             nan     0.1000   -0.0001
##    260        0.0026             nan     0.1000   -0.0001
##    280        0.0020             nan     0.1000   -0.0000
##    300        0.0015             nan     0.1000   -0.0000
##    320        0.0012             nan     0.1000   -0.0000
##    340        0.0009             nan     0.1000   -0.0000
##    360        0.0007             nan     0.1000   -0.0000
##    380        0.0005             nan     0.1000   -0.0000
##    400        0.0004             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000    0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1532             nan     0.1000    0.0666
##      2        1.0461             nan     0.1000    0.0559
##      3        0.9626             nan     0.1000    0.0400
##      4        0.8793             nan     0.1000    0.0399
##      5        0.8079             nan     0.1000    0.0329
##      6        0.7485             nan     0.1000    0.0288
##      7        0.6987             nan     0.1000    0.0245
##      8        0.6576             nan     0.1000    0.0200
##      9        0.6185             nan     0.1000    0.0191
##     10        0.5861             nan     0.1000    0.0146
##     20        0.3824             nan     0.1000    0.0039
##     40        0.2417             nan     0.1000   -0.0002
##     60        0.1922             nan     0.1000   -0.0006
##     80        0.1700             nan     0.1000    0.0006
##    100        0.1535             nan     0.1000   -0.0011
##    120        0.1392             nan     0.1000   -0.0003
##    140        0.1317             nan     0.1000   -0.0018
##    160        0.1239             nan     0.1000   -0.0003
##    180        0.1146             nan     0.1000   -0.0006
##    200        0.1065             nan     0.1000   -0.0010
##    220        0.1021             nan     0.1000   -0.0008
##    240        0.0974             nan     0.1000   -0.0006
##    260        0.0950             nan     0.1000   -0.0008
##    280        0.0900             nan     0.1000   -0.0010
##    300        0.0869             nan     0.1000   -0.0007
##    320        0.0843             nan     0.1000   -0.0002
##    340        0.0836             nan     0.1000   -0.0006
##    360        0.0831             nan     0.1000   -0.0012
##    380        0.0811             nan     0.1000   -0.0006
##    400        0.0780             nan     0.1000   -0.0006
##    420        0.0779             nan     0.1000   -0.0007
##    440        0.0767             nan     0.1000   -0.0006
##    460        0.0748             nan     0.1000   -0.0008
##    480        0.0740             nan     0.1000   -0.0006
##    500        0.0723             nan     0.1000   -0.0007
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1418             nan     0.1000    0.0704
##      2        1.0277             nan     0.1000    0.0553
##      3        0.9270             nan     0.1000    0.0516
##      4        0.8436             nan     0.1000    0.0405
##      5        0.7738             nan     0.1000    0.0338
##      6        0.7104             nan     0.1000    0.0301
##      7        0.6571             nan     0.1000    0.0242
##      8        0.6098             nan     0.1000    0.0247
##      9        0.5725             nan     0.1000    0.0170
##     10        0.5419             nan     0.1000    0.0152
##     20        0.3151             nan     0.1000    0.0038
##     40        0.1829             nan     0.1000    0.0002
##     60        0.1382             nan     0.1000   -0.0012
##     80        0.1132             nan     0.1000   -0.0006
##    100        0.0917             nan     0.1000   -0.0006
##    120        0.0783             nan     0.1000   -0.0001
##    140        0.0684             nan     0.1000   -0.0004
##    160        0.0601             nan     0.1000   -0.0003
##    180        0.0538             nan     0.1000   -0.0008
##    200        0.0472             nan     0.1000   -0.0002
##    220        0.0426             nan     0.1000   -0.0001
##    240        0.0386             nan     0.1000   -0.0006
##    260        0.0358             nan     0.1000   -0.0003
##    280        0.0320             nan     0.1000   -0.0001
##    300        0.0289             nan     0.1000   -0.0003
##    320        0.0258             nan     0.1000   -0.0002
##    340        0.0234             nan     0.1000   -0.0001
##    360        0.0207             nan     0.1000   -0.0003
##    380        0.0191             nan     0.1000   -0.0002
##    400        0.0170             nan     0.1000   -0.0001
##    420        0.0157             nan     0.1000   -0.0001
##    440        0.0142             nan     0.1000   -0.0001
##    460        0.0130             nan     0.1000    0.0000
##    480        0.0125             nan     0.1000   -0.0001
##    500        0.0113             nan     0.1000   -0.0001
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1356             nan     0.1000    0.0740
##      2        1.0178             nan     0.1000    0.0555
##      3        0.9133             nan     0.1000    0.0475
##      4        0.8312             nan     0.1000    0.0384
##      5        0.7560             nan     0.1000    0.0350
##      6        0.6933             nan     0.1000    0.0306
##      7        0.6368             nan     0.1000    0.0238
##      8        0.5925             nan     0.1000    0.0198
##      9        0.5453             nan     0.1000    0.0214
##     10        0.5085             nan     0.1000    0.0165
##     20        0.2886             nan     0.1000    0.0054
##     40        0.1546             nan     0.1000   -0.0012
##     60        0.1063             nan     0.1000   -0.0013
##     80        0.0793             nan     0.1000   -0.0008
##    100        0.0587             nan     0.1000   -0.0004
##    120        0.0489             nan     0.1000   -0.0001
##    140        0.0388             nan     0.1000   -0.0004
##    160        0.0327             nan     0.1000    0.0000
##    180        0.0249             nan     0.1000   -0.0001
##    200        0.0205             nan     0.1000   -0.0002
##    220        0.0166             nan     0.1000   -0.0002
##    240        0.0135             nan     0.1000   -0.0001
##    260        0.0113             nan     0.1000   -0.0000
##    280        0.0095             nan     0.1000   -0.0001
##    300        0.0080             nan     0.1000   -0.0001
##    320        0.0068             nan     0.1000   -0.0001
##    340        0.0058             nan     0.1000   -0.0001
##    360        0.0050             nan     0.1000   -0.0000
##    380        0.0044             nan     0.1000   -0.0001
##    400        0.0034             nan     0.1000   -0.0000
##    420        0.0029             nan     0.1000   -0.0000
##    440        0.0025             nan     0.1000   -0.0000
##    460        0.0021             nan     0.1000   -0.0000
##    480        0.0018             nan     0.1000   -0.0000
##    500        0.0015             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1377             nan     0.1000    0.0685
##      2        1.0159             nan     0.1000    0.0602
##      3        0.9185             nan     0.1000    0.0473
##      4        0.8325             nan     0.1000    0.0417
##      5        0.7618             nan     0.1000    0.0330
##      6        0.7000             nan     0.1000    0.0279
##      7        0.6417             nan     0.1000    0.0265
##      8        0.5892             nan     0.1000    0.0232
##      9        0.5439             nan     0.1000    0.0208
##     10        0.5078             nan     0.1000    0.0163
##     20        0.2918             nan     0.1000    0.0043
##     40        0.1386             nan     0.1000   -0.0000
##     60        0.0874             nan     0.1000    0.0003
##     80        0.0583             nan     0.1000    0.0002
##    100        0.0417             nan     0.1000   -0.0006
##    120        0.0309             nan     0.1000   -0.0003
##    140        0.0233             nan     0.1000   -0.0002
##    160        0.0183             nan     0.1000   -0.0002
##    180        0.0138             nan     0.1000   -0.0002
##    200        0.0105             nan     0.1000   -0.0001
##    220        0.0082             nan     0.1000   -0.0001
##    240        0.0062             nan     0.1000   -0.0000
##    260        0.0050             nan     0.1000   -0.0000
##    280        0.0040             nan     0.1000   -0.0000
##    300        0.0031             nan     0.1000   -0.0000
##    320        0.0026             nan     0.1000   -0.0000
##    340        0.0021             nan     0.1000   -0.0000
##    360        0.0017             nan     0.1000   -0.0000
##    380        0.0012             nan     0.1000   -0.0000
##    400        0.0010             nan     0.1000   -0.0000
##    420        0.0008             nan     0.1000   -0.0000
##    440        0.0006             nan     0.1000   -0.0000
##    460        0.0005             nan     0.1000   -0.0000
##    480        0.0004             nan     0.1000   -0.0000
##    500        0.0003             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1360             nan     0.1000    0.0705
##      2        1.0126             nan     0.1000    0.0615
##      3        0.9108             nan     0.1000    0.0513
##      4        0.8227             nan     0.1000    0.0427
##      5        0.7506             nan     0.1000    0.0348
##      6        0.6847             nan     0.1000    0.0313
##      7        0.6257             nan     0.1000    0.0280
##      8        0.5799             nan     0.1000    0.0195
##      9        0.5393             nan     0.1000    0.0174
##     10        0.5008             nan     0.1000    0.0159
##     20        0.2728             nan     0.1000    0.0057
##     40        0.1240             nan     0.1000    0.0005
##     60        0.0737             nan     0.1000    0.0007
##     80        0.0497             nan     0.1000   -0.0001
##    100        0.0324             nan     0.1000    0.0000
##    120        0.0228             nan     0.1000   -0.0003
##    140        0.0163             nan     0.1000   -0.0003
##    160        0.0123             nan     0.1000   -0.0001
##    180        0.0086             nan     0.1000   -0.0002
##    200        0.0060             nan     0.1000   -0.0000
##    220        0.0044             nan     0.1000    0.0000
##    240        0.0034             nan     0.1000   -0.0000
##    260        0.0027             nan     0.1000   -0.0001
##    280        0.0020             nan     0.1000   -0.0000
##    300        0.0017             nan     0.1000   -0.0000
##    320        0.0013             nan     0.1000   -0.0000
##    340        0.0010             nan     0.1000   -0.0000
##    360        0.0008             nan     0.1000   -0.0000
##    380        0.0007             nan     0.1000   -0.0000
##    400        0.0006             nan     0.1000   -0.0000
##    420        0.0004             nan     0.1000   -0.0000
##    440        0.0003             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0002             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1290             nan     0.1000    0.0749
##      2        1.0009             nan     0.1000    0.0613
##      3        0.8983             nan     0.1000    0.0455
##      4        0.8156             nan     0.1000    0.0380
##      5        0.7440             nan     0.1000    0.0305
##      6        0.6813             nan     0.1000    0.0302
##      7        0.6213             nan     0.1000    0.0267
##      8        0.5744             nan     0.1000    0.0218
##      9        0.5279             nan     0.1000    0.0213
##     10        0.4874             nan     0.1000    0.0166
##     20        0.2618             nan     0.1000    0.0064
##     40        0.1119             nan     0.1000   -0.0002
##     60        0.0637             nan     0.1000   -0.0005
##     80        0.0386             nan     0.1000   -0.0005
##    100        0.0262             nan     0.1000   -0.0004
##    120        0.0194             nan     0.1000   -0.0003
##    140        0.0157             nan     0.1000   -0.0003
##    160        0.0113             nan     0.1000   -0.0003
##    180        0.0091             nan     0.1000   -0.0002
##    200        0.0062             nan     0.1000   -0.0001
##    220        0.0039             nan     0.1000   -0.0000
##    240        0.0031             nan     0.1000   -0.0001
##    260        0.0025             nan     0.1000   -0.0000
##    280        0.0019             nan     0.1000   -0.0000
##    300        0.0014             nan     0.1000   -0.0000
##    320        0.0010             nan     0.1000   -0.0000
##    340        0.0008             nan     0.1000   -0.0000
##    360        0.0006             nan     0.1000   -0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000    0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1286             nan     0.1000    0.0796
##      2        1.0082             nan     0.1000    0.0585
##      3        0.9066             nan     0.1000    0.0484
##      4        0.8176             nan     0.1000    0.0411
##      5        0.7396             nan     0.1000    0.0370
##      6        0.6809             nan     0.1000    0.0242
##      7        0.6235             nan     0.1000    0.0265
##      8        0.5730             nan     0.1000    0.0241
##      9        0.5302             nan     0.1000    0.0177
##     10        0.4908             nan     0.1000    0.0188
##     20        0.2664             nan     0.1000    0.0062
##     40        0.1146             nan     0.1000    0.0010
##     60        0.0663             nan     0.1000   -0.0012
##     80        0.0379             nan     0.1000   -0.0001
##    100        0.0217             nan     0.1000   -0.0001
##    120        0.0150             nan     0.1000   -0.0001
##    140        0.0109             nan     0.1000   -0.0003
##    160        0.0078             nan     0.1000   -0.0001
##    180        0.0056             nan     0.1000   -0.0001
##    200        0.0038             nan     0.1000   -0.0000
##    220        0.0031             nan     0.1000   -0.0001
##    240        0.0025             nan     0.1000   -0.0000
##    260        0.0016             nan     0.1000   -0.0000
##    280        0.0013             nan     0.1000   -0.0000
##    300        0.0009             nan     0.1000   -0.0000
##    320        0.0007             nan     0.1000   -0.0000
##    340        0.0004             nan     0.1000   -0.0000
##    360        0.0003             nan     0.1000   -0.0000
##    380        0.0002             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0001             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1342             nan     0.1000    0.0766
##      2        1.0123             nan     0.1000    0.0564
##      3        0.9102             nan     0.1000    0.0491
##      4        0.8220             nan     0.1000    0.0423
##      5        0.7459             nan     0.1000    0.0338
##      6        0.6778             nan     0.1000    0.0321
##      7        0.6270             nan     0.1000    0.0237
##      8        0.5788             nan     0.1000    0.0229
##      9        0.5365             nan     0.1000    0.0203
##     10        0.4973             nan     0.1000    0.0188
##     20        0.2602             nan     0.1000    0.0066
##     40        0.1053             nan     0.1000    0.0011
##     60        0.0597             nan     0.1000   -0.0011
##     80        0.0330             nan     0.1000   -0.0004
##    100        0.0208             nan     0.1000   -0.0000
##    120        0.0139             nan     0.1000   -0.0002
##    140        0.0088             nan     0.1000   -0.0002
##    160        0.0067             nan     0.1000   -0.0001
##    180        0.0049             nan     0.1000   -0.0001
##    200        0.0034             nan     0.1000    0.0000
##    220        0.0024             nan     0.1000   -0.0001
##    240        0.0017             nan     0.1000   -0.0000
##    260        0.0012             nan     0.1000   -0.0000
##    280        0.0009             nan     0.1000   -0.0000
##    300        0.0007             nan     0.1000   -0.0000
##    320        0.0004             nan     0.1000   -0.0000
##    340        0.0003             nan     0.1000   -0.0000
##    360        0.0002             nan     0.1000   -0.0000
##    380        0.0002             nan     0.1000   -0.0000
##    400        0.0001             nan     0.1000   -0.0000
##    420        0.0001             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000    0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1308             nan     0.1000    0.0723
##      2        1.0046             nan     0.1000    0.0637
##      3        0.9038             nan     0.1000    0.0460
##      4        0.8165             nan     0.1000    0.0394
##      5        0.7431             nan     0.1000    0.0351
##      6        0.6783             nan     0.1000    0.0284
##      7        0.6240             nan     0.1000    0.0265
##      8        0.5774             nan     0.1000    0.0210
##      9        0.5381             nan     0.1000    0.0171
##     10        0.5010             nan     0.1000    0.0159
##     20        0.2603             nan     0.1000    0.0049
##     40        0.1087             nan     0.1000    0.0004
##     60        0.0591             nan     0.1000   -0.0011
##     80        0.0346             nan     0.1000   -0.0006
##    100        0.0227             nan     0.1000    0.0002
##    120        0.0158             nan     0.1000   -0.0004
##    140        0.0104             nan     0.1000   -0.0004
##    160        0.0080             nan     0.1000   -0.0002
##    180        0.0061             nan     0.1000   -0.0002
##    200        0.0044             nan     0.1000   -0.0000
##    220        0.0038             nan     0.1000   -0.0001
##    240        0.0026             nan     0.1000   -0.0001
##    260        0.0020             nan     0.1000   -0.0000
##    280        0.0017             nan     0.1000   -0.0000
##    300        0.0010             nan     0.1000   -0.0000
##    320        0.0008             nan     0.1000   -0.0000
##    340        0.0007             nan     0.1000   -0.0000
##    360        0.0005             nan     0.1000   -0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1360             nan     0.1000    0.0763
##      2        1.0152             nan     0.1000    0.0600
##      3        0.9149             nan     0.1000    0.0476
##      4        0.8323             nan     0.1000    0.0362
##      5        0.7554             nan     0.1000    0.0367
##      6        0.6915             nan     0.1000    0.0304
##      7        0.6326             nan     0.1000    0.0267
##      8        0.5850             nan     0.1000    0.0215
##      9        0.5390             nan     0.1000    0.0193
##     10        0.5022             nan     0.1000    0.0139
##     20        0.2669             nan     0.1000    0.0041
##     40        0.1084             nan     0.1000    0.0004
##     60        0.0539             nan     0.1000   -0.0002
##     80        0.0292             nan     0.1000    0.0002
##    100        0.0186             nan     0.1000   -0.0002
##    120        0.0125             nan     0.1000   -0.0005
##    140        0.0074             nan     0.1000   -0.0001
##    160        0.0054             nan     0.1000   -0.0001
##    180        0.0036             nan     0.1000   -0.0001
##    200        0.0024             nan     0.1000   -0.0000
##    220        0.0017             nan     0.1000   -0.0000
##    240        0.0014             nan     0.1000   -0.0000
##    260        0.0010             nan     0.1000   -0.0000
##    280        0.0006             nan     0.1000   -0.0000
##    300        0.0004             nan     0.1000   -0.0000
##    320        0.0003             nan     0.1000   -0.0000
##    340        0.0002             nan     0.1000   -0.0000
##    360        0.0002             nan     0.1000   -0.0000
##    380        0.0001             nan     0.1000    0.0000
##    400        0.0001             nan     0.1000   -0.0000
##    420        0.0001             nan     0.1000   -0.0000
##    440        0.0000             nan     0.1000   -0.0000
##    460        0.0000             nan     0.1000   -0.0000
##    480        0.0000             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1323             nan     0.1000    0.0771
##      2        1.0072             nan     0.1000    0.0590
##      3        0.9077             nan     0.1000    0.0485
##      4        0.8202             nan     0.1000    0.0413
##      5        0.7432             nan     0.1000    0.0377
##      6        0.6793             nan     0.1000    0.0295
##      7        0.6198             nan     0.1000    0.0259
##      8        0.5696             nan     0.1000    0.0238
##      9        0.5237             nan     0.1000    0.0198
##     10        0.4853             nan     0.1000    0.0171
##     20        0.2601             nan     0.1000    0.0038
##     40        0.1132             nan     0.1000    0.0007
##     60        0.0659             nan     0.1000   -0.0008
##     80        0.0412             nan     0.1000   -0.0004
##    100        0.0291             nan     0.1000   -0.0001
##    120        0.0211             nan     0.1000   -0.0003
##    140        0.0163             nan     0.1000   -0.0002
##    150        0.0133             nan     0.1000   -0.0002</code></pre>
<div class="sourceCode" id="cb812"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb812-1"><a href="machine-learning.html#cb812-1" tabindex="-1"></a><span class="fu">summary</span>(gbm)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-4-1.png" width="672" /></p>
<pre><code>##                                 var      rel.inf
## Cell.shape.L           Cell.shape.L 34.019899160
## Cell.size.L             Cell.size.L 33.945736557
## Cl.thickness.L       Cl.thickness.L  5.148781596
## Epith.c.size.L       Epith.c.size.L  3.721787231
## Marg.adhesion.L     Marg.adhesion.L  2.284713140
## Cell.size^5             Cell.size^5  1.612481713
## Epith.c.size.Q       Epith.c.size.Q  1.526622845
## Marg.adhesion^9     Marg.adhesion^9  1.112704849
## Cl.thickness^4       Cl.thickness^4  1.047868769
## Epith.c.size^5       Epith.c.size^5  1.018452214
## Cell.shape.Q           Cell.shape.Q  0.958963895
## Marg.adhesion.Q     Marg.adhesion.Q  0.927327940
## Cl.thickness^9       Cl.thickness^9  0.917482427
## Cell.shape^7           Cell.shape^7  0.737573067
## Cell.size^8             Cell.size^8  0.725473198
## Cell.size.Q             Cell.size.Q  0.684507459
## Marg.adhesion^5     Marg.adhesion^5  0.684042933
## Cell.size^4             Cell.size^4  0.667807695
## Cell.size^7             Cell.size^7  0.627808870
## Cell.shape^8           Cell.shape^8  0.610750035
## Bl.cromatin4           Bl.cromatin4  0.605100397
## Bl.cromatin5           Bl.cromatin5  0.542376201
## Epith.c.size^9       Epith.c.size^9  0.489746326
## Cell.size^9             Cell.size^9  0.479544369
## Marg.adhesion^7     Marg.adhesion^7  0.464082103
## Cell.shape^5           Cell.shape^5  0.454885656
## Cl.thickness^8       Cl.thickness^8  0.319727239
## Cl.thickness.Q       Cl.thickness.Q  0.285998944
## Cell.size^6             Cell.size^6  0.250220030
## Normal.nucleoli10 Normal.nucleoli10  0.235789813
## Epith.c.size^8       Epith.c.size^8  0.233298921
## Epith.c.size^6       Epith.c.size^6  0.195192427
## Marg.adhesion.C     Marg.adhesion.C  0.195019938
## Cell.size.C             Cell.size.C  0.187025587
## Cell.shape^6           Cell.shape^6  0.186992637
## Marg.adhesion^8     Marg.adhesion^8  0.180777704
## Cell.shape.C           Cell.shape.C  0.179319599
## Bl.cromatin7           Bl.cromatin7  0.171228044
## Epith.c.size^7       Epith.c.size^7  0.170200293
## Marg.adhesion^4     Marg.adhesion^4  0.168205952
## Cl.thickness^6       Cl.thickness^6  0.131316900
## Bl.cromatin3           Bl.cromatin3  0.119258478
## Cell.shape^9           Cell.shape^9  0.118742215
## Normal.nucleoli8   Normal.nucleoli8  0.117109214
## Cl.thickness^5       Cl.thickness^5  0.101190293
## Marg.adhesion^6     Marg.adhesion^6  0.091375810
## Cell.shape^4           Cell.shape^4  0.079103318
## Cl.thickness^7       Cl.thickness^7  0.066088160
## Epith.c.size^4       Epith.c.size^4  0.055727339
## Normal.nucleoli3   Normal.nucleoli3  0.049411397
## Epith.c.size.C       Epith.c.size.C  0.032180840
## Mitoses2                   Mitoses2  0.020866411
## Cl.thickness.C       Cl.thickness.C  0.019820125
## Normal.nucleoli4   Normal.nucleoli4  0.017283676
## Normal.nucleoli2   Normal.nucleoli2  0.003974461
## Bl.cromatin8           Bl.cromatin8  0.001033587
## Bl.cromatin2           Bl.cromatin2  0.000000000
## Bl.cromatin6           Bl.cromatin6  0.000000000
## Bl.cromatin9           Bl.cromatin9  0.000000000
## Bl.cromatin10         Bl.cromatin10  0.000000000
## Normal.nucleoli5   Normal.nucleoli5  0.000000000
## Normal.nucleoli6   Normal.nucleoli6  0.000000000
## Normal.nucleoli7   Normal.nucleoli7  0.000000000
## Normal.nucleoli9   Normal.nucleoli9  0.000000000
## Mitoses3                   Mitoses3  0.000000000
## Mitoses4                   Mitoses4  0.000000000
## Mitoses5                   Mitoses5  0.000000000
## Mitoses6                   Mitoses6  0.000000000
## Mitoses7                   Mitoses7  0.000000000
## Mitoses8                   Mitoses8  0.000000000
## Mitoses10                 Mitoses10  0.000000000</code></pre>
<div class="sourceCode" id="cb814"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb814-1"><a href="machine-learning.html#cb814-1" tabindex="-1"></a>pred_gbm<span class="ot">&lt;-</span><span class="fu">predict</span>(gbm,BreastCancer)</span>
<span id="cb814-2"><a href="machine-learning.html#cb814-2" tabindex="-1"></a><span class="fu">confusionMatrix</span>(pred_gbm, BreastCancer<span class="sc">$</span>Class)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    0    0
## [2,]    0  466</code></pre>
<div class="sourceCode" id="cb816"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb816-1"><a href="machine-learning.html#cb816-1" tabindex="-1"></a>roc_gbm<span class="ot">&lt;-</span>pROC<span class="sc">::</span><span class="fu">roc</span>(BreastCancer<span class="sc">$</span>Class, <span class="fu">as.numeric</span>(pred_gbm))</span></code></pre></div>
<pre><code>## Setting levels: control = benign, case = malignant</code></pre>
<pre><code>## Setting direction: controls &lt; cases</code></pre>
<div class="sourceCode" id="cb819"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb819-1"><a href="machine-learning.html#cb819-1" tabindex="-1"></a>roc_gbm</span></code></pre></div>
<pre><code>## 
## Call:
## roc.default(response = BreastCancer$Class, predictor = as.numeric(pred_gbm))
## 
## Data: as.numeric(pred_gbm) in 458 controls (BreastCancer$Class benign) &lt; 241 cases (BreastCancer$Class malignant).
## Area under the curve: 0.9771</code></pre>
</div>
<div id="extreme-gradient-boost-machine" class="section level4 hasAnchor" number="6.2.2.2">
<h4><span class="header-section-number">6.2.2.2</span> Extreme gradient boost machine<a href="machine-learning.html#extreme-gradient-boost-machine" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In the examples above, the outcome variable is treated as a factor. Extreme gradient boost machine <em>xgboost</em> requires conversion to numeric variable.</p>
<div class="sourceCode" id="cb821"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb821-1"><a href="machine-learning.html#cb821-1" tabindex="-1"></a><span class="fu">library</span>(xgboost)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;xgboost&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:rattle&#39;:
## 
##     xgboost</code></pre>
<pre><code>## The following object is masked from &#39;package:CHNOSZ&#39;:
## 
##     slice</code></pre>
<pre><code>## The following object is masked from &#39;package:plotly&#39;:
## 
##     slice</code></pre>
<pre><code>## The following object is masked from &#39;package:tidygraph&#39;:
## 
##     slice</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     slice</code></pre>
<pre><code>## The following object is masked from &#39;package:oro.nifti&#39;:
## 
##     slice</code></pre>
<div class="sourceCode" id="cb829"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb829-1"><a href="machine-learning.html#cb829-1" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb829-2"><a href="machine-learning.html#cb829-2" tabindex="-1"></a></span>
<span id="cb829-3"><a href="machine-learning.html#cb829-3" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;BreastCancer&quot;</span>,<span class="at">package =</span> <span class="st">&quot;mlbench&quot;</span>)</span>
<span id="cb829-4"><a href="machine-learning.html#cb829-4" tabindex="-1"></a><span class="co">#predict breast cancer</span></span>
<span id="cb829-5"><a href="machine-learning.html#cb829-5" tabindex="-1"></a></span>
<span id="cb829-6"><a href="machine-learning.html#cb829-6" tabindex="-1"></a>BreastCancer<span class="sc">$</span>Class<span class="ot">&lt;-</span><span class="fu">as.character</span>(BreastCancer<span class="sc">$</span>Class)</span>
<span id="cb829-7"><a href="machine-learning.html#cb829-7" tabindex="-1"></a>BreastCancer<span class="sc">$</span>Class[BreastCancer<span class="sc">$</span>Class<span class="sc">==</span><span class="st">&quot;benign&quot;</span>]<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb829-8"><a href="machine-learning.html#cb829-8" tabindex="-1"></a>BreastCancer<span class="sc">$</span>Class[BreastCancer<span class="sc">$</span>Class<span class="sc">==</span><span class="st">&quot;malignant&quot;</span>]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb829-9"><a href="machine-learning.html#cb829-9" tabindex="-1"></a>BreastCancer<span class="sc">$</span>Class<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(BreastCancer<span class="sc">$</span>Class)</span>
<span id="cb829-10"><a href="machine-learning.html#cb829-10" tabindex="-1"></a></span>
<span id="cb829-11"><a href="machine-learning.html#cb829-11" tabindex="-1"></a><span class="co">#remove ID column</span></span>
<span id="cb829-12"><a href="machine-learning.html#cb829-12" tabindex="-1"></a><span class="co">#remove column a=with NA </span></span>
<span id="cb829-13"><a href="machine-learning.html#cb829-13" tabindex="-1"></a><span class="co">#remaining 9 columns</span></span>
<span id="cb829-14"><a href="machine-learning.html#cb829-14" tabindex="-1"></a><span class="co">#convert multiple columns to numeric</span></span>
<span id="cb829-15"><a href="machine-learning.html#cb829-15" tabindex="-1"></a><span class="co">#lapply output a list</span></span>
<span id="cb829-16"><a href="machine-learning.html#cb829-16" tabindex="-1"></a>BreastCancer2<span class="ot">&lt;-</span><span class="fu">lapply</span>(BreastCancer[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>)], as.numeric)</span>
<span id="cb829-17"><a href="machine-learning.html#cb829-17" tabindex="-1"></a>BreastCancer2<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(BreastCancer2)</span>
<span id="cb829-18"><a href="machine-learning.html#cb829-18" tabindex="-1"></a></span>
<span id="cb829-19"><a href="machine-learning.html#cb829-19" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb829-20"><a href="machine-learning.html#cb829-20" tabindex="-1"></a>parts <span class="ot">=</span> <span class="fu">createDataPartition</span>(BreastCancer2<span class="sc">$</span>Class, <span class="at">p =</span> <span class="fl">0.75</span>, <span class="at">list=</span>F)</span>
<span id="cb829-21"><a href="machine-learning.html#cb829-21" tabindex="-1"></a>train <span class="ot">=</span> BreastCancer2[parts, ]</span>
<span id="cb829-22"><a href="machine-learning.html#cb829-22" tabindex="-1"></a>test <span class="ot">=</span> BreastCancer2[<span class="sc">-</span>parts, ]</span>
<span id="cb829-23"><a href="machine-learning.html#cb829-23" tabindex="-1"></a></span>
<span id="cb829-24"><a href="machine-learning.html#cb829-24" tabindex="-1"></a>X_train <span class="ot">=</span> <span class="fu">data.matrix</span>(train[,<span class="sc">-</span><span class="dv">9</span>])          <span class="co"># independent variables for train</span></span>
<span id="cb829-25"><a href="machine-learning.html#cb829-25" tabindex="-1"></a>y_train <span class="ot">=</span> train[,<span class="dv">9</span>]                        <span class="co"># dependent variables for train</span></span>
<span id="cb829-26"><a href="machine-learning.html#cb829-26" tabindex="-1"></a>X_test <span class="ot">=</span> <span class="fu">data.matrix</span>(test[,<span class="sc">-</span><span class="dv">9</span>])            <span class="co"># independent variables for test</span></span>
<span id="cb829-27"><a href="machine-learning.html#cb829-27" tabindex="-1"></a>y_test <span class="ot">=</span> test[,<span class="dv">9</span>]                          <span class="co"># dependent variables for test</span></span>
<span id="cb829-28"><a href="machine-learning.html#cb829-28" tabindex="-1"></a></span>
<span id="cb829-29"><a href="machine-learning.html#cb829-29" tabindex="-1"></a><span class="co"># convert the train and test data into xgboost matrix type.</span></span>
<span id="cb829-30"><a href="machine-learning.html#cb829-30" tabindex="-1"></a>xgboost_train <span class="ot">=</span> <span class="fu">xgb.DMatrix</span>(<span class="at">data=</span>X_train, <span class="at">label=</span><span class="fu">as.matrix</span>(y_train))</span>
<span id="cb829-31"><a href="machine-learning.html#cb829-31" tabindex="-1"></a>xgboost_test <span class="ot">=</span> <span class="fu">xgb.DMatrix</span>(<span class="at">data=</span>X_test, <span class="at">label=</span><span class="fu">as.matrix</span>(y_test))</span>
<span id="cb829-32"><a href="machine-learning.html#cb829-32" tabindex="-1"></a></span>
<span id="cb829-33"><a href="machine-learning.html#cb829-33" tabindex="-1"></a><span class="co"># train a model using our training data</span></span>
<span id="cb829-34"><a href="machine-learning.html#cb829-34" tabindex="-1"></a><span class="co"># nthread is the number of CPU threads we use</span></span>
<span id="cb829-35"><a href="machine-learning.html#cb829-35" tabindex="-1"></a><span class="co"># nrounds is the number of passes on the data</span></span>
<span id="cb829-36"><a href="machine-learning.html#cb829-36" tabindex="-1"></a></span>
<span id="cb829-37"><a href="machine-learning.html#cb829-37" tabindex="-1"></a><span class="co">#the function xgboost exist in xgboost and rattle</span></span>
<span id="cb829-38"><a href="machine-learning.html#cb829-38" tabindex="-1"></a>model <span class="ot">&lt;-</span> xgboost<span class="sc">::</span><span class="fu">xgboost</span>(<span class="at">data =</span> xgboost_train, <span class="at">max.depth =</span> <span class="dv">2</span>, <span class="at">eta =</span> <span class="dv">1</span>, <span class="at">nthread =</span> <span class="dv">2</span>, <span class="at">nrounds =</span> <span class="dv">2</span>, <span class="at">objective =</span> <span class="st">&quot;binary:logistic&quot;</span>, <span class="at">verbose =</span> <span class="dv">2</span>)                           </span></code></pre></div>
<pre><code>## [1]  train-logloss:0.221760 
## [2]  train-logloss:0.129150</code></pre>
<div class="sourceCode" id="cb831"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb831-1"><a href="machine-learning.html#cb831-1" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>##                Length Class              Mode       
## handle            1   xgb.Booster.handle externalptr
## raw            5890   -none-             raw        
## niter             1   -none-             numeric    
## evaluation_log    2   data.table         list       
## call             17   -none-             call       
## params            5   -none-             list       
## callbacks         2   -none-             list       
## feature_names     8   -none-             character  
## nfeatures         1   -none-             numeric</code></pre>
<div class="sourceCode" id="cb833"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb833-1"><a href="machine-learning.html#cb833-1" tabindex="-1"></a><span class="co">#use model to make predictions on test data</span></span>
<span id="cb833-2"><a href="machine-learning.html#cb833-2" tabindex="-1"></a>pred_test <span class="ot">=</span> <span class="fu">predict</span>(model, xgboost_test)</span>
<span id="cb833-3"><a href="machine-learning.html#cb833-3" tabindex="-1"></a>pred_test</span></code></pre></div>
<pre><code>##   [1] 0.04247886 0.04247886 0.93661994 0.04247886 0.04247886 0.93661994 0.04247886
##   [8] 0.04247886 0.50793731 0.84730983 0.04247886 0.04247886 0.04247886 0.93661994
##  [15] 0.13179043 0.61858213 0.04247886 0.93661994 0.04247886 0.90757442 0.04247886
##  [22] 0.93661994 0.50793731 0.10175808 0.04247886 0.13179043 0.04247886 0.04247886
##  [29] 0.04247886 0.04247886 0.04247886 0.04247886 0.04247886 0.93661994 0.90757442
##  [36] 0.90757442 0.93661994 0.90757442 0.04247886 0.61858213 0.04247886 0.04247886
##  [43] 0.04247886 0.04247886 0.04247886 0.93661994 0.04247886 0.61858213 0.04247886
##  [50] 0.04247886 0.93661994 0.61858213 0.93661994 0.04247886 0.93661994 0.04247886
##  [57] 0.04247886 0.04247886 0.04247886 0.93661994 0.93661994 0.04247886 0.93661994
##  [64] 0.93661994 0.04247886 0.93661994 0.13179043 0.04247886 0.93661994 0.61858213
##  [71] 0.04247886 0.93661994 0.04247886 0.04247886 0.04247886 0.04247886 0.93661994
##  [78] 0.93661994 0.04247886 0.28787071 0.84532809 0.04247886 0.04247886 0.04247886
##  [85] 0.04247886 0.93661994 0.93661994 0.93661994 0.04247886 0.84730983 0.04247886
##  [92] 0.61858213 0.84730983 0.04247886 0.93661994 0.93661994 0.93661994 0.61858213
##  [99] 0.04247886 0.04247886 0.04247886 0.04247886 0.84730983 0.93661994 0.04247886
## [106] 0.04247886 0.04247886 0.04247886 0.04247886 0.93661994 0.10175808 0.04247886
## [113] 0.10175808 0.61858213 0.90757442 0.04247886 0.04247886 0.04247886 0.04247886
## [120] 0.93661994 0.04247886 0.04247886 0.04247886 0.04247886 0.04247886 0.93661994
## [127] 0.04247886 0.93661994 0.04247886 0.04247886 0.04247886 0.04247886 0.04247886
## [134] 0.04247886 0.93661994 0.04247886 0.04247886 0.93661994 0.04247886 0.04247886
## [141] 0.04247886 0.93661994 0.93661994 0.13179043 0.04247886 0.04247886 0.04247886
## [148] 0.04247886 0.93661994 0.04247886 0.04247886 0.04247886 0.93661994 0.04247886
## [155] 0.93661994 0.93661994 0.04247886 0.93661994 0.93661994 0.10175808 0.04247886
## [162] 0.04247886 0.04247886 0.04247886 0.04247886 0.61858213 0.04247886 0.93661994
## [169] 0.04247886 0.10175808 0.04247886 0.93661994 0.04247886 0.93661994</code></pre>
<div class="sourceCode" id="cb835"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb835-1"><a href="machine-learning.html#cb835-1" tabindex="-1"></a><span class="co">#classify 1 if prediction &gt;.5</span></span>
<span id="cb835-2"><a href="machine-learning.html#cb835-2" tabindex="-1"></a>prediction <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(pred_test <span class="sc">&gt;</span> <span class="fl">0.5</span>)</span>
<span id="cb835-3"><a href="machine-learning.html#cb835-3" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(prediction))</span></code></pre></div>
<pre><code>## [1] 0 0 1 0 0 1</code></pre>
<div class="sourceCode" id="cb837"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb837-1"><a href="machine-learning.html#cb837-1" tabindex="-1"></a>err <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(pred_test <span class="sc">&gt;</span> <span class="fl">0.5</span>) <span class="sc">!=</span> y_test)</span>
<span id="cb837-2"><a href="machine-learning.html#cb837-2" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;test-error=&quot;</span>, err))</span></code></pre></div>
<pre><code>## [1] &quot;test-error= 0.0632183908045977&quot;</code></pre>
<div class="sourceCode" id="cb839"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb839-1"><a href="machine-learning.html#cb839-1" tabindex="-1"></a><span class="co">#plot of the first 2 trees</span></span>
<span id="cb839-2"><a href="machine-learning.html#cb839-2" tabindex="-1"></a><span class="fu">xgb.plot.tree</span>(<span class="at">model =</span> model, <span class="at">trees =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span></code></pre></div>
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-e256f0d1d9c715cdb1d6" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-e256f0d1d9c715cdb1d6">{"x":{"diagram":"digraph {\n\ngraph [layout = \"dot\",\n       rankdir = \"LR\"]\n\nnode [color = \"DimGray\",\n      style = \"filled\",\n      fontname = \"Helvetica\"]\n\nedge [color = \"DimGray\",\n     arrowsize = \"1.5\",\n     arrowhead = \"vee\",\n     fontname = \"Helvetica\"]\n\n  \"1\" [label = \"Tree 1\nBl.cromatin\nCover: 64.5307846\nGain: 55.5894661\", shape = \"rectangle\", fontcolor = \"black\", fillcolor = \"Beige\"] \n  \"2\" [label = \"Cl.thickness\nCover: 42.5443878\nGain: 13.7194939\", shape = \"rectangle\", fontcolor = \"black\", fillcolor = \"Beige\"] \n  \"3\" [label = \"Epith.c.size\nCover: 21.9863949\nGain: 1.98490334\", shape = \"rectangle\", fontcolor = \"black\", fillcolor = \"Beige\"] \n  \"4\" [label = \"Leaf\nCover: 38.4290581\nValue: -1.17784131\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n  \"5\" [label = \"Leaf\nCover: 4.11532879\nValue: 0.622996688\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n  \"6\" [label = \"Leaf\nCover: 2.42281723\nValue: 0.0522798002\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n  \"7\" [label = \"Leaf\nCover: 19.5635796\nValue: 1.03175199\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n\"1\"->\"2\" [label = \"< 3.5\", style = \"bold\"] \n\"2\"->\"4\" [label = \"< 6.5\", style = \"bold\"] \n\"3\"->\"6\" [label = \"< 2.5\", style = \"bold\"] \n\"1\"->\"3\" [style = \"bold\", style = \"solid\"] \n\"2\"->\"5\" [style = \"solid\", style = \"solid\"] \n\"3\"->\"7\" [style = \"solid\", style = \"solid\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="bayesian-trees-method" class="section level3 hasAnchor" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> Bayesian trees method<a href="machine-learning.html#bayesian-trees-method" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="bart" class="section level4 hasAnchor" number="6.2.3.1">
<h4><span class="header-section-number">6.2.3.1</span> BART<a href="machine-learning.html#bart" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>BART or Bayesian additive regression trees is a non-parametric method that uses a sum of Bayesian trees to estimate an unknown function. Every tree acts as a weak learner in this ensemle method. It can also be used in causal inference. It uses tuning parameters derived from Bayesian priors. Each predicted value has a posterior distribution. BART uses a regularization prior that forces each tree to be able to explain only a limited subset of the relationships between the covariates and the predictor variable. In some instances, BART outperform xgboost.</p>
<div class="sourceCode" id="cb840"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb840-1"><a href="machine-learning.html#cb840-1" tabindex="-1"></a><span class="fu">library</span>(BART)</span>
<span id="cb840-2"><a href="machine-learning.html#cb840-2" tabindex="-1"></a></span>
<span id="cb840-3"><a href="machine-learning.html#cb840-3" tabindex="-1"></a><span class="fu">data</span>(Melanoma, <span class="at">package =</span> <span class="st">&quot;MASS&quot;</span>)</span>
<span id="cb840-4"><a href="machine-learning.html#cb840-4" tabindex="-1"></a></span>
<span id="cb840-5"><a href="machine-learning.html#cb840-5" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">length</span>(Melanoma<span class="sc">$</span>status)</span>
<span id="cb840-6"><a href="machine-learning.html#cb840-6" tabindex="-1"></a></span>
<span id="cb840-7"><a href="machine-learning.html#cb840-7" tabindex="-1"></a><span class="co">#table(Melanoma$ph.karno, cancer$pat.karno)</span></span>
<span id="cb840-8"><a href="machine-learning.html#cb840-8" tabindex="-1"></a></span>
<span id="cb840-9"><a href="machine-learning.html#cb840-9" tabindex="-1"></a><span class="do">## if physician&#39;s KPS unavailable, then use the patient&#39;s</span></span>
<span id="cb840-10"><a href="machine-learning.html#cb840-10" tabindex="-1"></a><span class="co">#h &lt;- which(is.na(cancer$ph.karno))</span></span>
<span id="cb840-11"><a href="machine-learning.html#cb840-11" tabindex="-1"></a><span class="co">#cancer$ph.karno[h] &lt;- cancer$pat.karno[h]</span></span>
<span id="cb840-12"><a href="machine-learning.html#cb840-12" tabindex="-1"></a></span>
<span id="cb840-13"><a href="machine-learning.html#cb840-13" tabindex="-1"></a>times <span class="ot">&lt;-</span> Melanoma<span class="sc">$</span>time</span>
<span id="cb840-14"><a href="machine-learning.html#cb840-14" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(times<span class="sc">/</span><span class="dv">7</span>)  <span class="do">## weeks</span></span>
<span id="cb840-15"><a href="machine-learning.html#cb840-15" tabindex="-1"></a></span>
<span id="cb840-16"><a href="machine-learning.html#cb840-16" tabindex="-1"></a><span class="co">#1 died from melanoma, 2 alive, 3 dead from other causes.</span></span>
<span id="cb840-17"><a href="machine-learning.html#cb840-17" tabindex="-1"></a><span class="do">##delta: 0=censored, 1=dead</span></span>
<span id="cb840-18"><a href="machine-learning.html#cb840-18" tabindex="-1"></a>delta<span class="ot">=</span><span class="fu">ifelse</span>(Melanoma<span class="sc">$</span>status<span class="sc">==</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb840-19"><a href="machine-learning.html#cb840-19" tabindex="-1"></a></span>
<span id="cb840-20"><a href="machine-learning.html#cb840-20" tabindex="-1"></a><span class="do">## matrix of observed covariates</span></span>
<span id="cb840-21"><a href="machine-learning.html#cb840-21" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Melanoma<span class="sc">$</span>sex, Melanoma<span class="sc">$</span>age, Melanoma<span class="sc">$</span>thickness)</span>
<span id="cb840-22"><a href="machine-learning.html#cb840-22" tabindex="-1"></a></span>
<span id="cb840-23"><a href="machine-learning.html#cb840-23" tabindex="-1"></a><span class="co">#provide column names</span></span>
<span id="cb840-24"><a href="machine-learning.html#cb840-24" tabindex="-1"></a><span class="fu">dimnames</span>(x.train)[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;M(1):F(0)&#39;</span>,<span class="st">&#39;age&#39;</span>, <span class="st">&#39;thickness&#39;</span>)</span>
<span id="cb840-25"><a href="machine-learning.html#cb840-25" tabindex="-1"></a></span>
<span id="cb840-26"><a href="machine-learning.html#cb840-26" tabindex="-1"></a><span class="fu">table</span>(x.train[ , <span class="dv">1</span>])</span></code></pre></div>
<pre><code>## 
##   0   1 
## 126  79</code></pre>
<div class="sourceCode" id="cb842"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb842-1"><a href="machine-learning.html#cb842-1" tabindex="-1"></a><span class="fu">summary</span>(x.train[ , <span class="dv">2</span>])</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    4.00   42.00   54.00   52.46   65.00   95.00</code></pre>
<div class="sourceCode" id="cb844"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb844-1"><a href="machine-learning.html#cb844-1" tabindex="-1"></a><span class="fu">table</span>(x.train[ , <span class="dv">3</span>])</span></code></pre></div>
<pre><code>## 
##   0.1  0.16  0.24  0.32  0.48  0.58  0.64  0.65  0.81  0.97  1.03  1.13  1.29  1.34 
##     1     7     1     6     4     1     4    10    11    11     1     4    16     2 
##  1.37  1.45  1.53  1.62  1.76  1.78  1.94   2.1  2.24  2.26  2.34  2.42  2.58  2.74 
##     1     3     1    12     1     2    10     3     1     5     1     1     9     1 
##   2.9  3.06  3.22  3.54  3.56  3.87  4.04  4.09  4.19  4.51  4.82  4.83  4.84  5.16 
##     3     2    10     8     1     6     1     1     2     1     1     2     5     3 
##  5.48  5.64   5.8  6.12  6.44  6.76  7.06  7.09  7.41  7.73  7.89  8.06  8.38  8.54 
##     2     1     2     2     1     1     2     2     1     2     1     1     1     1 
##  9.66 12.08 12.24 12.56 12.88 13.85 14.66 17.42 
##     1     1     1     1     2     1     1     1</code></pre>
<div class="sourceCode" id="cb846"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb846-1"><a href="machine-learning.html#cb846-1" tabindex="-1"></a><span class="do">##test BART with token run to ensure installation works</span></span>
<span id="cb846-2"><a href="machine-learning.html#cb846-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">99</span>)</span>
<span id="cb846-3"><a href="machine-learning.html#cb846-3" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">surv.bart</span>(<span class="at">x.train=</span>x.train, <span class="at">times=</span>times, <span class="at">delta=</span>delta,</span>
<span id="cb846-4"><a href="machine-learning.html#cb846-4" tabindex="-1"></a>                  <span class="at">nskip=</span><span class="dv">1</span>, <span class="at">ndpost=</span><span class="dv">1</span>, <span class="at">keepevery=</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## *****Calling gbart: type=2
## *****Data:
## data:n,p,np: 17042, 4, 0
## y1,yn: 1.000000, 0.000000
## x1,x[n*p]: 2.000000, 2.900000
## *****Number of Trees: 50
## *****Number of Cut Points: 100 ... 63
## *****burn,nd,thin: 1,1,1
## *****Prior:beta,alpha,tau,nu,lambda,offset: 2,0.95,0.212132,3,1,-2.6383
## *****Dirichlet:sparse,theta,omega,a,b,rho,augment: 0,0,1,0.5,1,3,0
## *****printevery: 100
## 
## MCMC
## done 0 (out of 2)
## time: 0s
## trcnt,tecnt: 1,0</code></pre>
<div class="sourceCode" id="cb848"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb848-1"><a href="machine-learning.html#cb848-1" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">surv.bart</span>(<span class="at">x.train=</span>x.train, <span class="at">times=</span>times, <span class="at">delta=</span>delta,</span>
<span id="cb848-2"><a href="machine-learning.html#cb848-2" tabindex="-1"></a>                      <span class="at">seed=</span><span class="dv">99</span>)</span></code></pre></div>
<pre><code>## *****Calling gbart: type=2
## *****Data:
## data:n,p,np: 17042, 4, 0
## y1,yn: 1.000000, 0.000000
## x1,x[n*p]: 2.000000, 2.900000
## *****Number of Trees: 50
## *****Number of Cut Points: 100 ... 63
## *****burn,nd,thin: 250,10000,10
## *****Prior:beta,alpha,tau,nu,lambda,offset: 2,0.95,0.212132,3,1,-2.6383
## *****Dirichlet:sparse,theta,omega,a,b,rho,augment: 0,0,1,0.5,1,3,0
## *****printevery: 100
## 
## MCMC
## done 0 (out of 10250)
## done 100 (out of 10250)
## done 200 (out of 10250)
## done 300 (out of 10250)
## done 400 (out of 10250)
## done 500 (out of 10250)
## done 600 (out of 10250)
## done 700 (out of 10250)
## done 800 (out of 10250)
## done 900 (out of 10250)
## done 1000 (out of 10250)
## done 1100 (out of 10250)
## done 1200 (out of 10250)
## done 1300 (out of 10250)
## done 1400 (out of 10250)
## done 1500 (out of 10250)
## done 1600 (out of 10250)
## done 1700 (out of 10250)
## done 1800 (out of 10250)
## done 1900 (out of 10250)
## done 2000 (out of 10250)
## done 2100 (out of 10250)
## done 2200 (out of 10250)
## done 2300 (out of 10250)
## done 2400 (out of 10250)
## done 2500 (out of 10250)
## done 2600 (out of 10250)
## done 2700 (out of 10250)
## done 2800 (out of 10250)
## done 2900 (out of 10250)
## done 3000 (out of 10250)
## done 3100 (out of 10250)
## done 3200 (out of 10250)
## done 3300 (out of 10250)
## done 3400 (out of 10250)
## done 3500 (out of 10250)
## done 3600 (out of 10250)
## done 3700 (out of 10250)
## done 3800 (out of 10250)
## done 3900 (out of 10250)
## done 4000 (out of 10250)
## done 4100 (out of 10250)
## done 4200 (out of 10250)
## done 4300 (out of 10250)
## done 4400 (out of 10250)
## done 4500 (out of 10250)
## done 4600 (out of 10250)
## done 4700 (out of 10250)
## done 4800 (out of 10250)
## done 4900 (out of 10250)
## done 5000 (out of 10250)
## done 5100 (out of 10250)
## done 5200 (out of 10250)
## done 5300 (out of 10250)
## done 5400 (out of 10250)
## done 5500 (out of 10250)
## done 5600 (out of 10250)
## done 5700 (out of 10250)
## done 5800 (out of 10250)
## done 5900 (out of 10250)
## done 6000 (out of 10250)
## done 6100 (out of 10250)
## done 6200 (out of 10250)
## done 6300 (out of 10250)
## done 6400 (out of 10250)
## done 6500 (out of 10250)
## done 6600 (out of 10250)
## done 6700 (out of 10250)
## done 6800 (out of 10250)
## done 6900 (out of 10250)
## done 7000 (out of 10250)
## done 7100 (out of 10250)
## done 7200 (out of 10250)
## done 7300 (out of 10250)
## done 7400 (out of 10250)
## done 7500 (out of 10250)
## done 7600 (out of 10250)
## done 7700 (out of 10250)
## done 7800 (out of 10250)
## done 7900 (out of 10250)
## done 8000 (out of 10250)
## done 8100 (out of 10250)
## done 8200 (out of 10250)
## done 8300 (out of 10250)
## done 8400 (out of 10250)
## done 8500 (out of 10250)
## done 8600 (out of 10250)
## done 8700 (out of 10250)
## done 8800 (out of 10250)
## done 8900 (out of 10250)
## done 9000 (out of 10250)
## done 9100 (out of 10250)
## done 9200 (out of 10250)
## done 9300 (out of 10250)
## done 9400 (out of 10250)
## done 9500 (out of 10250)
## done 9600 (out of 10250)
## done 9700 (out of 10250)
## done 9800 (out of 10250)
## done 9900 (out of 10250)
## done 10000 (out of 10250)
## done 10100 (out of 10250)
## done 10200 (out of 10250)
## time: 425s
## trcnt,tecnt: 1000,0</code></pre>
<div class="sourceCode" id="cb850"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb850-1"><a href="machine-learning.html#cb850-1" tabindex="-1"></a>pre <span class="ot">&lt;-</span> <span class="fu">surv.pre.bart</span>(<span class="at">times=</span>times, <span class="at">delta=</span>delta, <span class="at">x.train=</span>x.train,</span>
<span id="cb850-2"><a href="machine-learning.html#cb850-2" tabindex="-1"></a>                     <span class="at">x.test=</span>x.train)</span>
<span id="cb850-3"><a href="machine-learning.html#cb850-3" tabindex="-1"></a></span>
<span id="cb850-4"><a href="machine-learning.html#cb850-4" tabindex="-1"></a>K <span class="ot">&lt;-</span> pre<span class="sc">$</span>K</span>
<span id="cb850-5"><a href="machine-learning.html#cb850-5" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">nrow</span>(post<span class="sc">$</span>yhat.train)</span>
<span id="cb850-6"><a href="machine-learning.html#cb850-6" tabindex="-1"></a></span>
<span id="cb850-7"><a href="machine-learning.html#cb850-7" tabindex="-1"></a>pre<span class="sc">$</span>tx.test <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pre<span class="sc">$</span>tx.test, pre<span class="sc">$</span>tx.test)</span>
<span id="cb850-8"><a href="machine-learning.html#cb850-8" tabindex="-1"></a>pre<span class="sc">$</span>tx.test[ , <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, N<span class="sc">*</span>K), <span class="fu">rep</span>(<span class="dv">2</span>, N<span class="sc">*</span>K))</span>
<span id="cb850-9"><a href="machine-learning.html#cb850-9" tabindex="-1"></a><span class="do">## sex pushed to col 2, since time is always in col 1</span></span>
<span id="cb850-10"><a href="machine-learning.html#cb850-10" tabindex="-1"></a></span>
<span id="cb850-11"><a href="machine-learning.html#cb850-11" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(post, <span class="at">newdata=</span>pre<span class="sc">$</span>tx.test)</span></code></pre></div>
<pre><code>## *****In main of C++ for bart prediction
## tc (threadcount): 1
## number of bart draws: 1000
## number of trees in bart sum: 50
## number of x columns: 4
## from x,np,p: 4, 67240
## ***using serial code</code></pre>
<div class="sourceCode" id="cb852"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb852-1"><a href="machine-learning.html#cb852-1" tabindex="-1"></a>pd <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span>M, <span class="at">ncol=</span><span class="dv">2</span><span class="sc">*</span>K)</span>
<span id="cb852-2"><a href="machine-learning.html#cb852-2" tabindex="-1"></a></span>
<span id="cb852-3"><a href="machine-learning.html#cb852-3" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K) {</span>
<span id="cb852-4"><a href="machine-learning.html#cb852-4" tabindex="-1"></a>  h <span class="ot">&lt;-</span> <span class="fu">seq</span>(j, N<span class="sc">*</span>K, <span class="at">by=</span>K)</span>
<span id="cb852-5"><a href="machine-learning.html#cb852-5" tabindex="-1"></a>  pd[ , j] <span class="ot">&lt;-</span> <span class="fu">apply</span>(pred<span class="sc">$</span>surv.test[ , h], <span class="dv">1</span>, mean)</span>
<span id="cb852-6"><a href="machine-learning.html#cb852-6" tabindex="-1"></a>  pd[ , j<span class="sc">+</span>K] <span class="ot">&lt;-</span> <span class="fu">apply</span>(pred<span class="sc">$</span>surv.test[ , h<span class="sc">+</span>N<span class="sc">*</span>K], <span class="dv">1</span>, mean)</span>
<span id="cb852-7"><a href="machine-learning.html#cb852-7" tabindex="-1"></a>}</span>
<span id="cb852-8"><a href="machine-learning.html#cb852-8" tabindex="-1"></a></span>
<span id="cb852-9"><a href="machine-learning.html#cb852-9" tabindex="-1"></a>pd.mu  <span class="ot">&lt;-</span> <span class="fu">apply</span>(pd, <span class="dv">2</span>, mean)</span>
<span id="cb852-10"><a href="machine-learning.html#cb852-10" tabindex="-1"></a>pd<span class="fl">.025</span> <span class="ot">&lt;-</span> <span class="fu">apply</span>(pd, <span class="dv">2</span>, quantile, <span class="at">probs=</span><span class="fl">0.025</span>)</span>
<span id="cb852-11"><a href="machine-learning.html#cb852-11" tabindex="-1"></a>pd<span class="fl">.975</span> <span class="ot">&lt;-</span> <span class="fu">apply</span>(pd, <span class="dv">2</span>, quantile, <span class="at">probs=</span><span class="fl">0.975</span>)</span>
<span id="cb852-12"><a href="machine-learning.html#cb852-12" tabindex="-1"></a></span>
<span id="cb852-13"><a href="machine-learning.html#cb852-13" tabindex="-1"></a>males <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>K</span>
<span id="cb852-14"><a href="machine-learning.html#cb852-14" tabindex="-1"></a>females <span class="ot">&lt;-</span> males<span class="sc">+</span>K</span>
<span id="cb852-15"><a href="machine-learning.html#cb852-15" tabindex="-1"></a></span>
<span id="cb852-16"><a href="machine-learning.html#cb852-16" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">c</span>(<span class="dv">0</span>, pre<span class="sc">$</span>times), <span class="fu">c</span>(<span class="dv">1</span>, pd.mu[males]), <span class="at">type=</span><span class="st">&#39;s&#39;</span>, <span class="at">col=</span><span class="st">&#39;blue&#39;</span>,</span>
<span id="cb852-17"><a href="machine-learning.html#cb852-17" tabindex="-1"></a>     <span class="at">ylim=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">ylab=</span><span class="st">&#39;S(t, x)&#39;</span>, <span class="at">xlab=</span><span class="st">&#39;t (weeks)&#39;</span>,</span>
<span id="cb852-18"><a href="machine-learning.html#cb852-18" tabindex="-1"></a>     <span class="at">main=</span><span class="fu">paste</span>(<span class="st">&#39;Melanoma ex. (MASS:: Melanoma)&#39;</span>,</span>
<span id="cb852-19"><a href="machine-learning.html#cb852-19" tabindex="-1"></a>                <span class="st">&quot;Friedman&#39;s partial dependence function&quot;</span>,</span>
<span id="cb852-20"><a href="machine-learning.html#cb852-20" tabindex="-1"></a>                <span class="st">&#39;Male (blue) vs. Female (red)&#39;</span>, <span class="at">sep=</span><span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>))</span>
<span id="cb852-21"><a href="machine-learning.html#cb852-21" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">0</span>, pre<span class="sc">$</span>times), <span class="fu">c</span>(<span class="dv">1</span>, pd<span class="fl">.025</span>[males]), <span class="at">col=</span><span class="st">&#39;blue&#39;</span>, <span class="at">type=</span><span class="st">&#39;s&#39;</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb852-22"><a href="machine-learning.html#cb852-22" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">0</span>, pre<span class="sc">$</span>times), <span class="fu">c</span>(<span class="dv">1</span>, pd<span class="fl">.975</span>[males]), <span class="at">col=</span><span class="st">&#39;blue&#39;</span>, <span class="at">type=</span><span class="st">&#39;s&#39;</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb852-23"><a href="machine-learning.html#cb852-23" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">0</span>, pre<span class="sc">$</span>times), <span class="fu">c</span>(<span class="dv">1</span>, pd.mu[females]), <span class="at">col=</span><span class="st">&#39;red&#39;</span>, <span class="at">type=</span><span class="st">&#39;s&#39;</span>)</span>
<span id="cb852-24"><a href="machine-learning.html#cb852-24" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">0</span>, pre<span class="sc">$</span>times), <span class="fu">c</span>(<span class="dv">1</span>, pd<span class="fl">.025</span>[females]), <span class="at">col=</span><span class="st">&#39;red&#39;</span>, <span class="at">type=</span><span class="st">&#39;s&#39;</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb852-25"><a href="machine-learning.html#cb852-25" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">0</span>, pre<span class="sc">$</span>times), <span class="fu">c</span>(<span class="dv">1</span>, pd<span class="fl">.975</span>[females]), <span class="at">col=</span><span class="st">&#39;red&#39;</span>, <span class="at">type=</span><span class="st">&#39;s&#39;</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-4-2-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="knn" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> KNN<a href="machine-learning.html#knn" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>K nearest neighbour (KNN) uses ’feature similarity based on measure of distance between data points to make prediction. The K in KNN refers to the number of neighbours to define the case for similarity. K nearest neighbour is available from the <em>caret</em> library.</p>
<div class="sourceCode" id="cb853"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb853-1"><a href="machine-learning.html#cb853-1" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb853-2"><a href="machine-learning.html#cb853-2" tabindex="-1"></a></span>
<span id="cb853-3"><a href="machine-learning.html#cb853-3" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;BreastCancer&quot;</span>,<span class="at">package =</span> <span class="st">&quot;mlbench&quot;</span>)</span>
<span id="cb853-4"><a href="machine-learning.html#cb853-4" tabindex="-1"></a><span class="fu">colnames</span>(BreastCancer)</span></code></pre></div>
<pre><code>##  [1] &quot;Id&quot;              &quot;Cl.thickness&quot;    &quot;Cell.size&quot;       &quot;Cell.shape&quot;     
##  [5] &quot;Marg.adhesion&quot;   &quot;Epith.c.size&quot;    &quot;Bare.nuclei&quot;     &quot;Bl.cromatin&quot;    
##  [9] &quot;Normal.nucleoli&quot; &quot;Mitoses&quot;         &quot;Class&quot;</code></pre>
<div class="sourceCode" id="cb855"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb855-1"><a href="machine-learning.html#cb855-1" tabindex="-1"></a><span class="co">#note Class is benign or malignant of class factor</span></span>
<span id="cb855-2"><a href="machine-learning.html#cb855-2" tabindex="-1"></a><span class="co">#column Bare.nuclei removed due to NA</span></span>
<span id="cb855-3"><a href="machine-learning.html#cb855-3" tabindex="-1"></a>BreastCancer<span class="ot">&lt;-</span>BreastCancer[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>)]</span>
<span id="cb855-4"><a href="machine-learning.html#cb855-4" tabindex="-1"></a></span>
<span id="cb855-5"><a href="machine-learning.html#cb855-5" tabindex="-1"></a><span class="co">#split data</span></span>
<span id="cb855-6"><a href="machine-learning.html#cb855-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb855-7"><a href="machine-learning.html#cb855-7" tabindex="-1"></a>split <span class="ot">=</span> caTools<span class="sc">::</span><span class="fu">sample.split</span>(BreastCancer<span class="sc">$</span>Class, <span class="at">SplitRatio =</span> <span class="fl">0.75</span>)</span>
<span id="cb855-8"><a href="machine-learning.html#cb855-8" tabindex="-1"></a>Train <span class="ot">=</span> <span class="fu">subset</span>(BreastCancer, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb855-9"><a href="machine-learning.html#cb855-9" tabindex="-1"></a>Test <span class="ot">=</span> <span class="fu">subset</span>(BreastCancer, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb855-10"><a href="machine-learning.html#cb855-10" tabindex="-1"></a></span>
<span id="cb855-11"><a href="machine-learning.html#cb855-11" tabindex="-1"></a><span class="co">#grid of values to test in cross-validation.</span></span>
<span id="cb855-12"><a href="machine-learning.html#cb855-12" tabindex="-1"></a>knn_Grid <span class="ot">&lt;-</span>  <span class="fu">expand.grid</span>(<span class="at">k =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>))</span>
<span id="cb855-13"><a href="machine-learning.html#cb855-13" tabindex="-1"></a></span>
<span id="cb855-14"><a href="machine-learning.html#cb855-14" tabindex="-1"></a>knn_Control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;cv&quot;</span>,</span>
<span id="cb855-15"><a href="machine-learning.html#cb855-15" tabindex="-1"></a>                           <span class="at">number =</span> <span class="dv">10</span>, </span>
<span id="cb855-16"><a href="machine-learning.html#cb855-16" tabindex="-1"></a>                           <span class="co"># repeats = 10, # uncomment for repeatedcv </span></span>
<span id="cb855-17"><a href="machine-learning.html#cb855-17" tabindex="-1"></a>                           <span class="do">## Estimate class probabilities</span></span>
<span id="cb855-18"><a href="machine-learning.html#cb855-18" tabindex="-1"></a>                           <span class="at">classProbs =</span> <span class="cn">TRUE</span>,</span>
<span id="cb855-19"><a href="machine-learning.html#cb855-19" tabindex="-1"></a>                           <span class="do">## Evaluate performance using </span></span>
<span id="cb855-20"><a href="machine-learning.html#cb855-20" tabindex="-1"></a>                           <span class="do">## the following function</span></span>
<span id="cb855-21"><a href="machine-learning.html#cb855-21" tabindex="-1"></a>                           <span class="at">summaryFunction =</span> twoClassSummary)</span>
<span id="cb855-22"><a href="machine-learning.html#cb855-22" tabindex="-1"></a></span>
<span id="cb855-23"><a href="machine-learning.html#cb855-23" tabindex="-1"></a><span class="co">#scaling data is performed here under preProcess</span></span>
<span id="cb855-24"><a href="machine-learning.html#cb855-24" tabindex="-1"></a></span>
<span id="cb855-25"><a href="machine-learning.html#cb855-25" tabindex="-1"></a>knn <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(Class <span class="sc">~</span> ., </span>
<span id="cb855-26"><a href="machine-learning.html#cb855-26" tabindex="-1"></a>                    <span class="at">data =</span> Train, </span>
<span id="cb855-27"><a href="machine-learning.html#cb855-27" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">&quot;knn&quot;</span>,</span>
<span id="cb855-28"><a href="machine-learning.html#cb855-28" tabindex="-1"></a>                 <span class="at">trControl=</span>knn_Control,</span>
<span id="cb855-29"><a href="machine-learning.html#cb855-29" tabindex="-1"></a>                 <span class="at">tuneGrid=</span>knn_Grid,</span>
<span id="cb855-30"><a href="machine-learning.html#cb855-30" tabindex="-1"></a>                 <span class="co">#optimise with roc metric</span></span>
<span id="cb855-31"><a href="machine-learning.html#cb855-31" tabindex="-1"></a>                 <span class="at">metric=</span><span class="st">&quot;ROC&quot;</span>)</span>
<span id="cb855-32"><a href="machine-learning.html#cb855-32" tabindex="-1"></a></span>
<span id="cb855-33"><a href="machine-learning.html#cb855-33" tabindex="-1"></a></span>
<span id="cb855-34"><a href="machine-learning.html#cb855-34" tabindex="-1"></a><span class="fu">summary</span>(knn)</span></code></pre></div>
<pre><code>##             Length Class      Mode     
## learn        2     -none-     list     
## k            1     -none-     numeric  
## theDots      0     -none-     list     
## xNames      71     -none-     character
## problemType  1     -none-     character
## tuneValue    1     data.frame list     
## obsLevels    2     -none-     character
## param        0     -none-     list</code></pre>
<div class="sourceCode" id="cb857"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb857-1"><a href="machine-learning.html#cb857-1" tabindex="-1"></a>pred_knn<span class="ot">&lt;-</span><span class="fu">predict</span>(knn,Test)</span>
<span id="cb857-2"><a href="machine-learning.html#cb857-2" tabindex="-1"></a><span class="fu">confusionMatrix</span>(pred_knn, Test<span class="sc">$</span>Class)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    0    0
## [2,]    0  139</code></pre>
<div class="sourceCode" id="cb859"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb859-1"><a href="machine-learning.html#cb859-1" tabindex="-1"></a>roc_knn<span class="ot">&lt;-</span>pROC<span class="sc">::</span><span class="fu">roc</span>(Test<span class="sc">$</span>Class, <span class="fu">as.numeric</span>(pred_knn))</span></code></pre></div>
<pre><code>## Setting levels: control = benign, case = malignant</code></pre>
<pre><code>## Setting direction: controls &lt; cases</code></pre>
<div class="sourceCode" id="cb862"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb862-1"><a href="machine-learning.html#cb862-1" tabindex="-1"></a>roc_knn</span></code></pre></div>
<pre><code>## 
## Call:
## roc.default(response = Test$Class, predictor = as.numeric(pred_knn))
## 
## Data: as.numeric(pred_knn) in 114 controls (Test$Class benign) &lt; 60 cases (Test$Class malignant).
## Area under the curve: 0.7917</code></pre>
<div class="sourceCode" id="cb864"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb864-1"><a href="machine-learning.html#cb864-1" tabindex="-1"></a><span class="co">#https://plotly.com/r/knn-classification/</span></span>
<span id="cb864-2"><a href="machine-learning.html#cb864-2" tabindex="-1"></a></span>
<span id="cb864-3"><a href="machine-learning.html#cb864-3" tabindex="-1"></a>pdb <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Test[,<span class="sc">-</span><span class="dv">9</span>], Test[,<span class="dv">9</span>])</span>
<span id="cb864-4"><a href="machine-learning.html#cb864-4" tabindex="-1"></a>pdb <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pdb, pred_knn)</span>
<span id="cb864-5"><a href="machine-learning.html#cb864-5" tabindex="-1"></a></span>
<span id="cb864-6"><a href="machine-learning.html#cb864-6" tabindex="-1"></a>fig <span class="ot">&lt;-</span> plotly<span class="sc">::</span><span class="fu">plot_ly</span>(<span class="at">data =</span> pdb,</span>
<span id="cb864-7"><a href="machine-learning.html#cb864-7" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">~</span><span class="fu">as.numeric</span>(Test<span class="sc">$</span>Cl.thickness), </span>
<span id="cb864-8"><a href="machine-learning.html#cb864-8" tabindex="-1"></a>    <span class="at">y =</span> <span class="sc">~</span><span class="fu">as.numeric</span>(Test<span class="sc">$</span>Epith.c.size), </span>
<span id="cb864-9"><a href="machine-learning.html#cb864-9" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&#39;scatter&#39;</span>, <span class="at">mode =</span> <span class="st">&#39;markers&#39;</span>,<span class="at">color =</span> <span class="sc">~</span>pred_knn, <span class="at">colors =</span> <span class="st">&#39;RdBu&#39;</span>, </span>
<span id="cb864-10"><a href="machine-learning.html#cb864-10" tabindex="-1"></a>    <span class="at">symbol =</span> <span class="sc">~</span>Test<span class="sc">$</span>Class, <span class="at">split =</span> <span class="sc">~</span>Test<span class="sc">$</span>Class, </span>
<span id="cb864-11"><a href="machine-learning.html#cb864-11" tabindex="-1"></a>    <span class="at">symbols =</span> <span class="fu">c</span>(<span class="st">&#39;square-dot&#39;</span>,<span class="st">&#39;circle-dot&#39;</span>), </span>
<span id="cb864-12"><a href="machine-learning.html#cb864-12" tabindex="-1"></a>    <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;black&#39;</span>, <span class="at">width =</span> <span class="dv">1</span>)))</span>
<span id="cb864-13"><a href="machine-learning.html#cb864-13" tabindex="-1"></a></span>
<span id="cb864-14"><a href="machine-learning.html#cb864-14" tabindex="-1"></a>fig</span></code></pre></div>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-364a385f2ce4e40b9da2" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-364a385f2ce4e40b9da2">{"x":{"visdat":{"59f825be3c71":["function () ","plotlyVisDat"]},"cur_data":"59f825be3c71","attrs":{"59f825be3c71":{"x":{},"y":{},"mode":"markers","marker":{"size":12,"line":{"color":"black","width":1}},"color":{},"symbol":{},"split":{},"colors":"RdBu","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"symbols":["square-dot","circle-dot"],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"as.numeric(Test$Cl.thickness)"},"yaxis":{"domain":[0,1],"automargin":true,"title":"as.numeric(Test$Epith.c.size)"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[5,6,4,2,2,3,2,1,2,4,1,4,1,3,2,1,1,1,1,3,1,2,1,4,1,1,3,1,6,2,3,5,5,6,3,3,1,5,4,3,3,1,4,1,3,5,1,5,2,1,1,5,2,5,3,3,3,1,5,3,3,5,5,1,5,3,5,6,1,1,3,1,4,1,4,4,3,1,1,4,4,3,5,5,4,3,5,5,3,1,1,5,5,4,5,1,4,5,1,3,2,2,6,3,1,3,4,1,1,2,1,3,3,2],"y":[7,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,10,2,3,2,2,2,2,1,2,1,2,2,2,2,2,1,2,2,2,2,2,2,7,5,2,2,2,3,2,2,1,2,2,3,2,2,2,1,2,2,2,2,2,2,3,2,2,2,2,1,1,2,1,1,2,2,1,1,3,3,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,3,2],"mode":"markers","marker":{"color":"rgba(239,138,98,1)","symbol":"square-dot","size":12,"line":{"color":"black","width":1}},"type":"scatter","name":"benign<br />benign<br />benign","textfont":{"color":"rgba(239,138,98,1)"},"error_y":{"color":"rgba(239,138,98,1)"},"error_x":{"color":"rgba(239,138,98,1)"},"line":{"color":"rgba(239,138,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[5,10,8,6,10,10,3,1,4,8,5,8,3,7,1,10,10,10,3,4,5,7,10,3,7],"y":[2,3,5,5,3,3,5,8,1,2,4,3,3,3,4,2,2,2,5,3,3,2,2,3,4],"mode":"markers","marker":{"color":"rgba(239,138,98,1)","symbol":"circle-dot","size":12,"line":{"color":"black","width":1}},"type":"scatter","name":"benign<br />malignant<br />malignant","textfont":{"color":"rgba(239,138,98,1)"},"error_y":{"color":"rgba(239,138,98,1)"},"error_x":{"color":"rgba(239,138,98,1)"},"line":{"color":"rgba(239,138,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[8,10,10,5,9,5,6,5,1,10,9,10,8,10,10,6,8,10,8,10,10,8,10,8,10,10,10,8,6,7,10,10,10,5,8],"y":[7,8,10,8,6,8,8,8,5,6,5,7,4,7,5,8,5,10,4,4,5,8,3,3,3,4,5,7,3,4,6,3,3,5,6],"mode":"markers","marker":{"color":"rgba(247,247,247,1)","symbol":"circle-dot","size":12,"line":{"color":"black","width":1}},"type":"scatter","name":"malignant<br />malignant<br />malignant","textfont":{"color":"rgba(247,247,247,1)"},"error_y":{"color":"rgba(247,247,247,1)"},"error_x":{"color":"rgba(247,247,247,1)"},"line":{"color":"rgba(247,247,247,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="support-vector-machine" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Support vector machine<a href="machine-learning.html#support-vector-machine" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In brief, support vector machine regression (SVR) can be seen as a way to
enhance data which may not be easily separated in its native space. It
manipulates data from low dimension to higher dimension in feature space and
which can reveal relationship not discernible in low dimensional space. It does this around the hyperparameter controlling the margin of the data from a fitted line in a way not dissimilar from fitting a regression line based on minimising least squares. The default setting is radial basis function.</p>
<div class="sourceCode" id="cb865"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb865-1"><a href="machine-learning.html#cb865-1" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb865-2"><a href="machine-learning.html#cb865-2" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb865-3"><a href="machine-learning.html#cb865-3" tabindex="-1"></a></span>
<span id="cb865-4"><a href="machine-learning.html#cb865-4" tabindex="-1"></a><span class="co"># The Breast cancer data is used again from knn</span></span>
<span id="cb865-5"><a href="machine-learning.html#cb865-5" tabindex="-1"></a></span>
<span id="cb865-6"><a href="machine-learning.html#cb865-6" tabindex="-1"></a>trctrl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;repeatedcv&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>, <span class="at">repeats =</span> <span class="dv">3</span>)</span>
<span id="cb865-7"><a href="machine-learning.html#cb865-7" tabindex="-1"></a></span>
<span id="cb865-8"><a href="machine-learning.html#cb865-8" tabindex="-1"></a><span class="co">#scaling data is performed here under preProcess</span></span>
<span id="cb865-9"><a href="machine-learning.html#cb865-9" tabindex="-1"></a></span>
<span id="cb865-10"><a href="machine-learning.html#cb865-10" tabindex="-1"></a>svm_Linear <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(Class <span class="sc">~</span> ., </span>
<span id="cb865-11"><a href="machine-learning.html#cb865-11" tabindex="-1"></a>                    <span class="at">data =</span> Train, </span>
<span id="cb865-12"><a href="machine-learning.html#cb865-12" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">&quot;svmLinear&quot;</span>,</span>
<span id="cb865-13"><a href="machine-learning.html#cb865-13" tabindex="-1"></a>                 <span class="at">trControl=</span>trctrl,</span>
<span id="cb865-14"><a href="machine-learning.html#cb865-14" tabindex="-1"></a>                 <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">&quot;center&quot;</span>, <span class="st">&quot;scale&quot;</span>),</span>
<span id="cb865-15"><a href="machine-learning.html#cb865-15" tabindex="-1"></a>                 <span class="at">tuneLength =</span> <span class="dv">10</span>)</span>
<span id="cb865-16"><a href="machine-learning.html#cb865-16" tabindex="-1"></a></span>
<span id="cb865-17"><a href="machine-learning.html#cb865-17" tabindex="-1"></a></span>
<span id="cb865-18"><a href="machine-learning.html#cb865-18" tabindex="-1"></a><span class="fu">summary</span>(svm_Linear)</span></code></pre></div>
<pre><code>## Length  Class   Mode 
##      1   ksvm     S4</code></pre>
<div class="sourceCode" id="cb867"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb867-1"><a href="machine-learning.html#cb867-1" tabindex="-1"></a>pred<span class="ot">&lt;-</span><span class="fu">predict</span>(svm_Linear,BreastCancer)</span>
<span id="cb867-2"><a href="machine-learning.html#cb867-2" tabindex="-1"></a><span class="fu">confusionMatrix</span>(pred, BreastCancer<span class="sc">$</span>Class)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    0    0
## [2,]    0  468</code></pre>
<div class="sourceCode" id="cb869"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb869-1"><a href="machine-learning.html#cb869-1" tabindex="-1"></a>roc_svm<span class="ot">&lt;-</span>pROC<span class="sc">::</span><span class="fu">roc</span>(BreastCancer<span class="sc">$</span>Class, <span class="fu">as.numeric</span>(pred))</span></code></pre></div>
<pre><code>## Setting levels: control = benign, case = malignant</code></pre>
<pre><code>## Setting direction: controls &lt; cases</code></pre>
<div class="sourceCode" id="cb872"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb872-1"><a href="machine-learning.html#cb872-1" tabindex="-1"></a>roc_svm</span></code></pre></div>
<pre><code>## 
## Call:
## roc.default(response = BreastCancer$Class, predictor = as.numeric(pred))
## 
## Data: as.numeric(pred) in 458 controls (BreastCancer$Class benign) &lt; 241 cases (BreastCancer$Class malignant).
## Area under the curve: 0.9698</code></pre>
</div>
<div id="non-negative-matrix-factorisation" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Non-negative matrix factorisation<a href="machine-learning.html#non-negative-matrix-factorisation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Non-negative matrix factorisation is an unsupervised machine learning method, which seeks to explain the observed clinical features using smaller number of basis components (hidden variables). A matrix V of dimension m x n is factorise
to 2 matrices W and H. W has dimensions m x k an H has dimensions n x k. For
topic modeling in the chapter of text mining, V matrix is the document term matrix. Each row of H is the word embedding and the columns pf W represent the weight.</p>
<p>The interpretation of NMF components is similar to, but often more natural than, related methods such as factor analysis and principal component analysis. The non-negativity constraint in NMF leads to a simple “parts-based” interpretation and has been successfully used in facial recognition, metagene pattern
discovery, and market research. For a clinical example, the matrix for NMF decomposition consists of rows of hospitals and their service availability.</p>
<p>The example below used the recommended procedure to estimate the factorization rank, based on stability of the cophenetic correlation coefficient and the residual error, prior to performing the NMF analysis. The data were permuted and the factorization rank computed. These data were used as reference for selecting factorization rank to minimize the chance of overfitting.</p>
<div class="sourceCode" id="cb874"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb874-1"><a href="machine-learning.html#cb874-1" tabindex="-1"></a><span class="co">#BiocManager::install(&quot;Biobase&quot;)</span></span>
<span id="cb874-2"><a href="machine-learning.html#cb874-2" tabindex="-1"></a><span class="fu">library</span>(NMF,<span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb874-3"><a href="machine-learning.html#cb874-3" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb874-4"><a href="machine-learning.html#cb874-4" tabindex="-1"></a>edge<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./Data-Use/Hosp_Network_geocoded.csv&quot;</span>)</span>
<span id="cb874-5"><a href="machine-learning.html#cb874-5" tabindex="-1"></a>df<span class="ot">&lt;-</span>edge[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="fu">dim</span>(edge)[<span class="dv">2</span>])]</span>
<span id="cb874-6"><a href="machine-learning.html#cb874-6" tabindex="-1"></a><span class="fu">row.names</span>(df)<span class="ot">&lt;-</span>edge[,<span class="dv">1</span>] <span class="co">#bipartite matrix</span></span>
<span id="cb874-7"><a href="machine-learning.html#cb874-7" tabindex="-1"></a><span class="co">#select columns#remove distance data</span></span>
<span id="cb874-8"><a href="machine-learning.html#cb874-8" tabindex="-1"></a>df_se<span class="ot">&lt;-</span>edge[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">16</span>)]</span>
<span id="cb874-9"><a href="machine-learning.html#cb874-9" tabindex="-1"></a><span class="fu">row.names</span>(df_se)<span class="ot">&lt;-</span>edge[,<span class="dv">1</span>] <span class="co">#bipartite matrix</span></span>
<span id="cb874-10"><a href="machine-learning.html#cb874-10" tabindex="-1"></a><span class="co">#south eastern hospitals</span></span>
<span id="cb874-11"><a href="machine-learning.html#cb874-11" tabindex="-1"></a><span class="co">#select rows</span></span>
<span id="cb874-12"><a href="machine-learning.html#cb874-12" tabindex="-1"></a>df_se<span class="ot">&lt;-</span>df_se[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">19</span>,<span class="dv">20</span>,<span class="dv">24</span>,<span class="dv">31</span>,<span class="dv">33</span>,<span class="dv">34</span>,<span class="dv">35</span>),]</span>
<span id="cb874-13"><a href="machine-learning.html#cb874-13" tabindex="-1"></a></span>
<span id="cb874-14"><a href="machine-learning.html#cb874-14" tabindex="-1"></a></span>
<span id="cb874-15"><a href="machine-learning.html#cb874-15" tabindex="-1"></a><span class="co">#estimate factorisation rank-prevent overfitting</span></span>
<span id="cb874-16"><a href="machine-learning.html#cb874-16" tabindex="-1"></a>estim.r <span class="ot">&lt;-</span> <span class="fu">nmf</span>(df_se, <span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">nrun =</span> <span class="dv">10</span>, <span class="at">seed =</span> <span class="dv">123456</span>)</span>
<span id="cb874-17"><a href="machine-learning.html#cb874-17" tabindex="-1"></a><span class="fu">plot</span>(estim.r)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-7-1.png" width="672" /></p>
<div class="sourceCode" id="cb875"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb875-1"><a href="machine-learning.html#cb875-1" tabindex="-1"></a><span class="fu">consensusmap</span>(estim.r)</span></code></pre></div>
<pre><code>## Found more than one class &quot;dist&quot; in cache; using the first, from namespace &#39;BiocGenerics&#39;</code></pre>
<pre><code>## Also defined by &#39;spam&#39;</code></pre>
<pre><code>## Found more than one class &quot;dist&quot; in cache; using the first, from namespace &#39;BiocGenerics&#39;</code></pre>
<pre><code>## Also defined by &#39;spam&#39;</code></pre>
<pre><code>## Found more than one class &quot;dist&quot; in cache; using the first, from namespace &#39;BiocGenerics&#39;</code></pre>
<pre><code>## Also defined by &#39;spam&#39;</code></pre>
<pre><code>## Found more than one class &quot;dist&quot; in cache; using the first, from namespace &#39;BiocGenerics&#39;</code></pre>
<pre><code>## Also defined by &#39;spam&#39;</code></pre>
<pre><code>## Found more than one class &quot;dist&quot; in cache; using the first, from namespace &#39;BiocGenerics&#39;</code></pre>
<pre><code>## Also defined by &#39;spam&#39;</code></pre>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-7-2.png" width="672" /></p>
<p>The optimal number of rank for this data is likely to be 4.</p>
<div class="sourceCode" id="cb886"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb886-1"><a href="machine-learning.html#cb886-1" tabindex="-1"></a><span class="co">#Using the data above we can use which argument to find the order</span></span>
<span id="cb886-2"><a href="machine-learning.html#cb886-2" tabindex="-1"></a><span class="co">#since the starting point is 2 we just need to add 1</span></span>
<span id="cb886-3"><a href="machine-learning.html#cb886-3" tabindex="-1"></a>Rank<span class="ot">=</span><span class="fu">which</span>(estim.r<span class="sc">$</span>measures<span class="sc">$</span>cophenetic<span class="sc">==</span><span class="fu">max</span>(estim.r<span class="sc">$</span>measures<span class="sc">$</span>cophenetic))<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb886-4"><a href="machine-learning.html#cb886-4" tabindex="-1"></a></span>
<span id="cb886-5"><a href="machine-learning.html#cb886-5" tabindex="-1"></a>model<span class="ot">&lt;-</span><span class="fu">nmf</span>(df_se, Rank,<span class="at">nrun=</span><span class="dv">100</span>)</span>
<span id="cb886-6"><a href="machine-learning.html#cb886-6" tabindex="-1"></a>pmodel<span class="ot">&lt;-</span><span class="fu">predict</span>(model,<span class="at">prob=</span><span class="cn">TRUE</span>)</span>
<span id="cb886-7"><a href="machine-learning.html#cb886-7" tabindex="-1"></a><span class="fu">coefmap</span>(model)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-7-1-1.png" width="672" /></p>
<div class="sourceCode" id="cb887"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb887-1"><a href="machine-learning.html#cb887-1" tabindex="-1"></a><span class="fu">basismap</span>(model)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-7-1-2.png" width="672" /></p>
<div class="sourceCode" id="cb888"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb888-1"><a href="machine-learning.html#cb888-1" tabindex="-1"></a><span class="fu">consensusmap</span>(model)</span></code></pre></div>
<pre><code>## Found more than one class &quot;dist&quot; in cache; using the first, from namespace &#39;BiocGenerics&#39;</code></pre>
<pre><code>## Also defined by &#39;spam&#39;</code></pre>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-7-1-3.png" width="672" /></p>
</div>
<div id="formal-concept-analysis" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Formal concept analysis<a href="machine-learning.html#formal-concept-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This is an unsupervised machine learning method which takes an input matrix of objects and attributes (binary values) and seeks to find the hierarchy of relations. Each concept shares a set of attributes with other objects and each sub-concept shares a smaller set of attributes with a subset of the objects. A Hasse diagram is used to display the hierarchy of relations.</p>
<p>First we will illustrate with a simple relationship among fruit. Note in this example there is no close set for apple and pear, as both share the attribute of green color. There is a close set for the tropical fruit mango and and banana.</p>
<p>There are several libraries for FCA. Here we will use <em>multiplex</em>. The <em>fcaR</em> library can also handle fuzzy data.</p>
<div class="sourceCode" id="cb891"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb891-1"><a href="machine-learning.html#cb891-1" tabindex="-1"></a><span class="co">#BiocManager::install(&quot;Rgraphviz&quot;)</span></span>
<span id="cb891-2"><a href="machine-learning.html#cb891-2" tabindex="-1"></a></span>
<span id="cb891-3"><a href="machine-learning.html#cb891-3" tabindex="-1"></a><span class="fu">library</span>(multiplex) <span class="co">#Algebraic Tools for the Analysis of Multiple Social Networks</span></span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;multiplex&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:meta&#39;:
## 
##     transf</code></pre>
<pre><code>## The following object is masked from &#39;package:car&#39;:
## 
##     mmp</code></pre>
<pre><code>## The following object is masked from &#39;package:mgcv&#39;:
## 
##     ti</code></pre>
<pre><code>## The following object is masked from &#39;package:pracma&#39;:
## 
##     fact</code></pre>
<pre><code>## The following object is masked from &#39;package:rms&#39;:
## 
##     cph</code></pre>
<pre><code>## The following object is masked from &#39;package:CHNOSZ&#39;:
## 
##     diagram</code></pre>
<div class="sourceCode" id="cb899"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb899-1"><a href="machine-learning.html#cb899-1" tabindex="-1"></a><span class="fu">library</span>(Rgraphviz) <span class="co">#plot hasse diagram</span></span></code></pre></div>
<pre><code>## Loading required package: graph</code></pre>
<pre><code>## 
## Attaching package: &#39;graph&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:munsell&#39;:
## 
##     complement</code></pre>
<pre><code>## The following objects are masked from &#39;package:igraph&#39;:
## 
##     degree, edges, intersection</code></pre>
<pre><code>## The following object is masked from &#39;package:XML&#39;:
## 
##     addNode</code></pre>
<pre><code>## The following object is masked from &#39;package:party&#39;:
## 
##     nodes</code></pre>
<pre><code>## The following object is masked from &#39;package:strucchange&#39;:
## 
##     boundary</code></pre>
<pre><code>## The following object is masked from &#39;package:plyr&#39;:
## 
##     join</code></pre>
<pre><code>## The following object is masked from &#39;package:stringr&#39;:
## 
##     boundary</code></pre>
<pre><code>## 
## Attaching package: &#39;Rgraphviz&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:car&#39;:
## 
##     sp</code></pre>
<pre><code>## The following object is masked from &#39;package:crayon&#39;:
## 
##     style</code></pre>
<pre><code>## The following object is masked from &#39;package:plotly&#39;:
## 
##     style</code></pre>
<pre><code>## The following object is masked from &#39;package:NMF&#39;:
## 
##     name</code></pre>
<div class="sourceCode" id="cb914"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb914-1"><a href="machine-learning.html#cb914-1" tabindex="-1"></a>fr<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">Fruit=</span><span class="fu">c</span>(<span class="st">&quot;Apple&quot;</span>, <span class="st">&quot;Banana&quot;</span>,<span class="st">&quot;Pear&quot;</span>, <span class="st">&quot;Mango&quot;</span>),</span>
<span id="cb914-2"><a href="machine-learning.html#cb914-2" tabindex="-1"></a>                 <span class="at">round=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb914-3"><a href="machine-learning.html#cb914-3" tabindex="-1"></a>                 <span class="at">cylindrical=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb914-4"><a href="machine-learning.html#cb914-4" tabindex="-1"></a>                 <span class="at">yellow=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb914-5"><a href="machine-learning.html#cb914-5" tabindex="-1"></a>                 <span class="at">red=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb914-6"><a href="machine-learning.html#cb914-6" tabindex="-1"></a>                 <span class="at">green=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="co">#color when ripe</span></span>
<span id="cb914-7"><a href="machine-learning.html#cb914-7" tabindex="-1"></a>                 <span class="at">tropical=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb914-8"><a href="machine-learning.html#cb914-8" tabindex="-1"></a>               <span class="at">large_seed=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb914-9"><a href="machine-learning.html#cb914-9" tabindex="-1"></a>)</span>
<span id="cb914-10"><a href="machine-learning.html#cb914-10" tabindex="-1"></a></span>
<span id="cb914-11"><a href="machine-learning.html#cb914-11" tabindex="-1"></a>df<span class="ot">&lt;-</span>fr[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="fu">dim</span>(fr)[<span class="dv">2</span>])]</span>
<span id="cb914-12"><a href="machine-learning.html#cb914-12" tabindex="-1"></a><span class="fu">row.names</span>(df)<span class="ot">&lt;-</span>fr[,<span class="dv">1</span>] <span class="co">#bipartite matrix</span></span>
<span id="cb914-13"><a href="machine-learning.html#cb914-13" tabindex="-1"></a></span>
<span id="cb914-14"><a href="machine-learning.html#cb914-14" tabindex="-1"></a><span class="co">#perform Galois derivations between partially ordered subsets</span></span>
<span id="cb914-15"><a href="machine-learning.html#cb914-15" tabindex="-1"></a><span class="co">#galois(df_se&#39;,labeling = &quot;full&quot;)</span></span>
<span id="cb914-16"><a href="machine-learning.html#cb914-16" tabindex="-1"></a>gf <span class="ot">&lt;-</span> <span class="fu">galois</span>(df, <span class="at">labeling =</span> <span class="st">&quot;reduced&quot;</span>)</span>
<span id="cb914-17"><a href="machine-learning.html#cb914-17" tabindex="-1"></a></span>
<span id="cb914-18"><a href="machine-learning.html#cb914-18" tabindex="-1"></a><span class="co">#partial ordering of concept</span></span>
<span id="cb914-19"><a href="machine-learning.html#cb914-19" tabindex="-1"></a>po<span class="ot">&lt;-</span><span class="fu">partial.order</span>(gf,<span class="at">type=</span><span class="st">&quot;galois&quot;</span>)</span>
<span id="cb914-20"><a href="machine-learning.html#cb914-20" tabindex="-1"></a><span class="fu">diagram</span>(po, <span class="at">main=</span><span class="st">&quot;Hasse diagram of partial order - Fruit&quot;</span>) </span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-8-1.png" width="672" /></p>
<div class="sourceCode" id="cb915"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb915-1"><a href="machine-learning.html#cb915-1" tabindex="-1"></a><span class="co">#lattice  diagram with reduced context</span></span>
<span id="cb915-2"><a href="machine-learning.html#cb915-2" tabindex="-1"></a><span class="fu">diagram.levels</span>(po)</span></code></pre></div>
<pre><code>## $`4`
## [1] &quot;{round} {Apple}&quot;        &quot;{cylindrical} {Banana}&quot; &quot;{large_seed} {Mango}&quot;  
## 
## $`3`
## [1] &quot;{tropical, yellow} {}&quot; &quot;{green} {Pear}&quot;       
## 
## $`2`
## [1] &quot;{red} {}&quot;
## 
## $`5`
## [1] &quot;7&quot;
## 
## $`1`
## [1] &quot;8&quot;</code></pre>
<p>Next we illustrate FCA in network of hospitals in South-Eastern Melbourne. The objects are the hospitals and the attributes are the services available in those hospitals.</p>
<div class="sourceCode" id="cb917"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb917-1"><a href="machine-learning.html#cb917-1" tabindex="-1"></a><span class="co">#library(multiplex) #Algebraic Tools for the Analysis of Multiple Social Networks</span></span>
<span id="cb917-2"><a href="machine-learning.html#cb917-2" tabindex="-1"></a><span class="co">#library(Rgraphviz) #plot hasse diagram</span></span>
<span id="cb917-3"><a href="machine-learning.html#cb917-3" tabindex="-1"></a></span>
<span id="cb917-4"><a href="machine-learning.html#cb917-4" tabindex="-1"></a><span class="co">#install BiocManager::install(&quot;Rgraphviz&quot;)</span></span>
<span id="cb917-5"><a href="machine-learning.html#cb917-5" tabindex="-1"></a></span>
<span id="cb917-6"><a href="machine-learning.html#cb917-6" tabindex="-1"></a>edge<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./Data-Use/Hosp_Network_geocoded.csv&quot;</span>)</span>
<span id="cb917-7"><a href="machine-learning.html#cb917-7" tabindex="-1"></a>df<span class="ot">&lt;-</span>edge[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="fu">dim</span>(edge)[<span class="dv">2</span>])]</span>
<span id="cb917-8"><a href="machine-learning.html#cb917-8" tabindex="-1"></a><span class="fu">row.names</span>(df)<span class="ot">&lt;-</span>edge[,<span class="dv">1</span>] <span class="co">#bipartite matrix</span></span>
<span id="cb917-9"><a href="machine-learning.html#cb917-9" tabindex="-1"></a></span>
<span id="cb917-10"><a href="machine-learning.html#cb917-10" tabindex="-1"></a><span class="co">#select columns#remove distance data</span></span>
<span id="cb917-11"><a href="machine-learning.html#cb917-11" tabindex="-1"></a>df_se<span class="ot">&lt;-</span>edge[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">16</span>)]</span>
<span id="cb917-12"><a href="machine-learning.html#cb917-12" tabindex="-1"></a><span class="fu">row.names</span>(df_se)<span class="ot">&lt;-</span>edge[,<span class="dv">1</span>] <span class="co">#bipartite matrix</span></span>
<span id="cb917-13"><a href="machine-learning.html#cb917-13" tabindex="-1"></a></span>
<span id="cb917-14"><a href="machine-learning.html#cb917-14" tabindex="-1"></a><span class="co">#south eastern hospitals</span></span>
<span id="cb917-15"><a href="machine-learning.html#cb917-15" tabindex="-1"></a><span class="co">#select rows</span></span>
<span id="cb917-16"><a href="machine-learning.html#cb917-16" tabindex="-1"></a>df_se<span class="ot">&lt;-</span>df_se[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">19</span>,<span class="dv">20</span>,<span class="dv">24</span>,<span class="dv">31</span>,<span class="dv">33</span>,<span class="dv">34</span>,<span class="dv">35</span>),]</span>
<span id="cb917-17"><a href="machine-learning.html#cb917-17" tabindex="-1"></a></span>
<span id="cb917-18"><a href="machine-learning.html#cb917-18" tabindex="-1"></a><span class="co">#perform Galois derivations between partially ordered subsets</span></span>
<span id="cb917-19"><a href="machine-learning.html#cb917-19" tabindex="-1"></a><span class="co">#galois(df_se&#39;,labeling = &quot;full&quot;)</span></span>
<span id="cb917-20"><a href="machine-learning.html#cb917-20" tabindex="-1"></a>gf <span class="ot">&lt;-</span> <span class="fu">galois</span>(df_se, <span class="at">labeling =</span> <span class="st">&quot;reduced&quot;</span>)</span>
<span id="cb917-21"><a href="machine-learning.html#cb917-21" tabindex="-1"></a><span class="co">#partial ordering of concept</span></span>
<span id="cb917-22"><a href="machine-learning.html#cb917-22" tabindex="-1"></a>po<span class="ot">&lt;-</span><span class="fu">partial.order</span>(gf,<span class="at">type=</span><span class="st">&quot;galois&quot;</span>)</span>
<span id="cb917-23"><a href="machine-learning.html#cb917-23" tabindex="-1"></a><span class="fu">diagram</span>(po, <span class="at">main=</span><span class="st">&quot;Hasse diagram of partial order with reduced context&quot;</span>) </span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-8-1-1.png" width="672" /></p>
<div class="sourceCode" id="cb918"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb918-1"><a href="machine-learning.html#cb918-1" tabindex="-1"></a><span class="co">#lattice  diagram with reduced context</span></span>
<span id="cb918-2"><a href="machine-learning.html#cb918-2" tabindex="-1"></a><span class="fu">diagram.levels</span>(po)</span></code></pre></div>
<pre><code>## $`9`
## [1] &quot;{designated, ECR} {mmc}&quot;
## 
## $`4`
## [1] &quot;{link_rmh} {}&quot; &quot;18&quot;            &quot;25&quot;            &quot;27&quot;            &quot;28&quot;           
## [6] &quot;31&quot;           
## 
## $`1`
## [1] &quot;{CT, link_mmc} {}&quot;
## 
## $`3`
## [1] &quot;{X99min_rmh} {dandenongvalley, knoxprivate, seprivate}&quot;
## [2] &quot;{TPA} {}&quot;                                              
## [3] &quot;{CTA} {}&quot;                                              
## [4] &quot;{stroke_unit} {}&quot;                                      
## [5] &quot;23&quot;                                                    
## 
## $`2`
## [1] &quot;{X99min_mmc} {}&quot; &quot;{public} {}&quot;    
## 
## $`7`
## [1] &quot;{CTP} {ddh}&quot;    &quot;{} {frankston}&quot; &quot;{} {latrobe}&quot;  
## 
## $`6`
## [1] &quot;{MRI} {}&quot;        &quot;{} {marroondah}&quot; &quot;19&quot;              &quot;{} {casey}&quot;     
## [5] &quot;{} {bairnsdale}&quot; &quot;{} {sale}&quot;      
## 
## $`5`
## [1] &quot;{VST} {}&quot;     &quot;{} {hampton}&quot; &quot;22&quot;           &quot;24&quot;           &quot;30&quot;          
## 
## $`8`
## [1] &quot;{neurosx} {cabrini}&quot; &quot;{} {bhh}&quot;            &quot;{} {warragul}&quot;      
## 
## $`10`
## [1] &quot;14&quot;</code></pre>
</div>
<div id="evolutionary-algorithm" class="section level2 hasAnchor" number="6.7">
<h2><span class="header-section-number">6.7</span> Evolutionary Algorithm<a href="machine-learning.html#evolutionary-algorithm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Evolutionary algorithm are search method which take the source of inspiration
from nature such as evolution and survival of the fittest. These are seen as heuristic based method. The results from evolutionary algorithm shouldn’t be compared unless all conditions set are the same. In essence the findings are similar under the same conditions.</p>
<div id="simulated-annealing" class="section level3 hasAnchor" number="6.7.1">
<h3><span class="header-section-number">6.7.1</span> Simulated Annealing<a href="machine-learning.html#simulated-annealing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This method uses idea in metallurgy whereby metal is heated and then cooled to alter its property.</p>
<div class="sourceCode" id="cb920"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb920-1"><a href="machine-learning.html#cb920-1" tabindex="-1"></a><span class="co">#SA section is set not to run as the analysis takes a long time.</span></span>
<span id="cb920-2"><a href="machine-learning.html#cb920-2" tabindex="-1"></a><span class="co"># a saved run is provided below</span></span>
<span id="cb920-3"><a href="machine-learning.html#cb920-3" tabindex="-1"></a></span>
<span id="cb920-4"><a href="machine-learning.html#cb920-4" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;BreastCancer&quot;</span>,<span class="at">package =</span> <span class="st">&quot;mlbench&quot;</span>)</span>
<span id="cb920-5"><a href="machine-learning.html#cb920-5" tabindex="-1"></a><span class="fu">colnames</span>(BreastCancer)</span>
<span id="cb920-6"><a href="machine-learning.html#cb920-6" tabindex="-1"></a></span>
<span id="cb920-7"><a href="machine-learning.html#cb920-7" tabindex="-1"></a><span class="co">#check for duplicates</span></span>
<span id="cb920-8"><a href="machine-learning.html#cb920-8" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">duplicated</span>(BreastCancer))</span>
<span id="cb920-9"><a href="machine-learning.html#cb920-9" tabindex="-1"></a></span>
<span id="cb920-10"><a href="machine-learning.html#cb920-10" tabindex="-1"></a><span class="co">#remove duplicates</span></span>
<span id="cb920-11"><a href="machine-learning.html#cb920-11" tabindex="-1"></a><span class="co">#keep Id to avoid creation of new duplicates</span></span>
<span id="cb920-12"><a href="machine-learning.html#cb920-12" tabindex="-1"></a>BreastCancer1<span class="ot">&lt;-</span><span class="fu">unique</span>(BreastCancer) <span class="co">#reduce 699 to 691 rows</span></span>
<span id="cb920-13"><a href="machine-learning.html#cb920-13" tabindex="-1"></a></span>
<span id="cb920-14"><a href="machine-learning.html#cb920-14" tabindex="-1"></a><span class="co">#convert multiple columns to numeric</span></span>
<span id="cb920-15"><a href="machine-learning.html#cb920-15" tabindex="-1"></a><span class="co">#lapply output a list</span></span>
<span id="cb920-16"><a href="machine-learning.html#cb920-16" tabindex="-1"></a>BreastCancer2<span class="ot">&lt;-</span><span class="fu">lapply</span>(BreastCancer1[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">11</span>)], as.numeric) <span class="co">#list</span></span>
<span id="cb920-17"><a href="machine-learning.html#cb920-17" tabindex="-1"></a>BreastCancer2<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(BreastCancer2)</span>
<span id="cb920-18"><a href="machine-learning.html#cb920-18" tabindex="-1"></a>BreastCancer2<span class="sc">$</span>Class<span class="ot">&lt;-</span>BreastCancer1<span class="sc">$</span>Class</span>
<span id="cb920-19"><a href="machine-learning.html#cb920-19" tabindex="-1"></a></span>
<span id="cb920-20"><a href="machine-learning.html#cb920-20" tabindex="-1"></a>x<span class="ot">=</span>BreastCancer2[,<span class="sc">-</span><span class="dv">10</span>]</span>
<span id="cb920-21"><a href="machine-learning.html#cb920-21" tabindex="-1"></a>y<span class="ot">=</span>BreastCancer2<span class="sc">$</span>Class</span>
<span id="cb920-22"><a href="machine-learning.html#cb920-22" tabindex="-1"></a></span>
<span id="cb920-23"><a href="machine-learning.html#cb920-23" tabindex="-1"></a></span>
<span id="cb920-24"><a href="machine-learning.html#cb920-24" tabindex="-1"></a>sa_ctrl <span class="ot">&lt;-</span> <span class="fu">safsControl</span>(<span class="at">functions =</span> rfSA,</span>
<span id="cb920-25"><a href="machine-learning.html#cb920-25" tabindex="-1"></a>                       <span class="at">method =</span> <span class="st">&quot;repeatedcv&quot;</span>,</span>
<span id="cb920-26"><a href="machine-learning.html#cb920-26" tabindex="-1"></a>                       <span class="at">repeats =</span> <span class="dv">3</span>, <span class="co">#default is 5</span></span>
<span id="cb920-27"><a href="machine-learning.html#cb920-27" tabindex="-1"></a>                       <span class="at">improve =</span> <span class="dv">50</span>)</span>
<span id="cb920-28"><a href="machine-learning.html#cb920-28" tabindex="-1"></a></span>
<span id="cb920-29"><a href="machine-learning.html#cb920-29" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb920-30"><a href="machine-learning.html#cb920-30" tabindex="-1"></a>glm_sa <span class="ot">&lt;-</span> <span class="fu">safs</span>(<span class="at">x =</span> x, <span class="at">y =</span> y,</span>
<span id="cb920-31"><a href="machine-learning.html#cb920-31" tabindex="-1"></a>              <span class="at">iters =</span> <span class="dv">5</span>, <span class="co">#default is 250</span></span>
<span id="cb920-32"><a href="machine-learning.html#cb920-32" tabindex="-1"></a>              <span class="at">safsControl =</span> sa_ctrl, <span class="at">method=</span><span class="st">&quot;glm&quot;</span>)</span>
<span id="cb920-33"><a href="machine-learning.html#cb920-33" tabindex="-1"></a></span>
<span id="cb920-34"><a href="machine-learning.html#cb920-34" tabindex="-1"></a><span class="co">#save(glm_sa,file=&quot;Logistic_SimulatedAnnealing.Rda&quot;)</span></span>
<span id="cb920-35"><a href="machine-learning.html#cb920-35" tabindex="-1"></a></span>
<span id="cb920-36"><a href="machine-learning.html#cb920-36" tabindex="-1"></a><span class="do">#############################################</span></span>
<span id="cb920-37"><a href="machine-learning.html#cb920-37" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb920-38"><a href="machine-learning.html#cb920-38" tabindex="-1"></a><span class="co">#Simulated Annealing Feature Selection</span></span>
<span id="cb920-39"><a href="machine-learning.html#cb920-39" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb920-40"><a href="machine-learning.html#cb920-40" tabindex="-1"></a><span class="co">#691 samples</span></span>
<span id="cb920-41"><a href="machine-learning.html#cb920-41" tabindex="-1"></a><span class="co">#9 predictors</span></span>
<span id="cb920-42"><a href="machine-learning.html#cb920-42" tabindex="-1"></a><span class="co">#2 classes: &#39;benign&#39;, &#39;malignant&#39; </span></span>
<span id="cb920-43"><a href="machine-learning.html#cb920-43" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb920-44"><a href="machine-learning.html#cb920-44" tabindex="-1"></a><span class="co">#Maximum search iterations: 5 </span></span>
<span id="cb920-45"><a href="machine-learning.html#cb920-45" tabindex="-1"></a><span class="co">#Restart after 50 iterations without improvement (0 restarts on average)</span></span>
<span id="cb920-46"><a href="machine-learning.html#cb920-46" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb920-47"><a href="machine-learning.html#cb920-47" tabindex="-1"></a><span class="co">#Internal performance values: Accuracy, Kappa</span></span>
<span id="cb920-48"><a href="machine-learning.html#cb920-48" tabindex="-1"></a><span class="co">#Subset selection driven to maximize internal Accuracy </span></span>
<span id="cb920-49"><a href="machine-learning.html#cb920-49" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb920-50"><a href="machine-learning.html#cb920-50" tabindex="-1"></a><span class="co">#External performance values: Accuracy, Kappa</span></span>
<span id="cb920-51"><a href="machine-learning.html#cb920-51" tabindex="-1"></a><span class="co">#Best iteration chose by maximizing external Accuracy </span></span>
<span id="cb920-52"><a href="machine-learning.html#cb920-52" tabindex="-1"></a><span class="co">#External resampling method: Cross-Validated (10 fold, repeated 3 times) </span></span>
<span id="cb920-53"><a href="machine-learning.html#cb920-53" tabindex="-1"></a></span>
<span id="cb920-54"><a href="machine-learning.html#cb920-54" tabindex="-1"></a><span class="co">#During resampling:</span></span>
<span id="cb920-55"><a href="machine-learning.html#cb920-55" tabindex="-1"></a><span class="co">#  * the top 5 selected variables (out of a possible 9):</span></span>
<span id="cb920-56"><a href="machine-learning.html#cb920-56" tabindex="-1"></a><span class="co">#    Bl.cromatin (56.7%), Id (46.7%), Cl.thickness (43.3%), Epith.c.size (43.3%), #Marg.adhesion (43.3%)</span></span>
<span id="cb920-57"><a href="machine-learning.html#cb920-57" tabindex="-1"></a><span class="co">#  * on average, 3.5 variables were selected (min = 2, max = 5)</span></span>
<span id="cb920-58"><a href="machine-learning.html#cb920-58" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb920-59"><a href="machine-learning.html#cb920-59" tabindex="-1"></a><span class="co">#In the final search using the entire training set:</span></span>
<span id="cb920-60"><a href="machine-learning.html#cb920-60" tabindex="-1"></a><span class="co">#   * 2 features selected at iteration 5 including:</span></span>
<span id="cb920-61"><a href="machine-learning.html#cb920-61" tabindex="-1"></a><span class="co">#     Cl.thickness, Cell.size  </span></span>
<span id="cb920-62"><a href="machine-learning.html#cb920-62" tabindex="-1"></a><span class="co">#   * external performance at this iteration is</span></span>
<span id="cb920-63"><a href="machine-learning.html#cb920-63" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb920-64"><a href="machine-learning.html#cb920-64" tabindex="-1"></a><span class="co">#   Accuracy       Kappa </span></span>
<span id="cb920-65"><a href="machine-learning.html#cb920-65" tabindex="-1"></a><span class="co">#     0.9314      0.8479 </span></span></code></pre></div>
<div class="sourceCode" id="cb921"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb921-1"><a href="machine-learning.html#cb921-1" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;./Logistic_SimulatedAnnealing.Rda&quot;</span>)</span>
<span id="cb921-2"><a href="machine-learning.html#cb921-2" tabindex="-1"></a></span>
<span id="cb921-3"><a href="machine-learning.html#cb921-3" tabindex="-1"></a><span class="co">#plot output of simulated annealing</span></span>
<span id="cb921-4"><a href="machine-learning.html#cb921-4" tabindex="-1"></a><span class="fu">plot</span>(glm_sa)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-9-1-1.png" width="672" /></p>
</div>
<div id="genetic-algorithm" class="section level3 hasAnchor" number="6.7.2">
<h3><span class="header-section-number">6.7.2</span> Genetic Algorithm<a href="machine-learning.html#genetic-algorithm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Genetic algorithm is a machine learning tool based on ideas from Darwin’s
concept of natural selection. It is based on mutation, crossover and selection. Genetic algorithm can be used in any situation. The issue is in finding the fitness function to evaluate the output. Since it does not depend on gradient descent algorithm, it is less likely to be stuck in local minima compared to
other machine learning methods. Genetic algorithm is available in R as part of <em>caret</em> and <em>GA</em> libraries. Genetic algorithm can be used to optimise feature selection for regression modelling at the expense of much longer running time.</p>
<p>One potential issue with using cross-validation in genetic algorithm for feature selection is that it would be not right to use it again when feeding this data into another machine learning method.</p>
<div class="sourceCode" id="cb922"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb922-1"><a href="machine-learning.html#cb922-1" tabindex="-1"></a><span class="co">#GA</span></span>
<span id="cb922-2"><a href="machine-learning.html#cb922-2" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb922-3"><a href="machine-learning.html#cb922-3" tabindex="-1"></a></span>
<span id="cb922-4"><a href="machine-learning.html#cb922-4" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;BreastCancer&quot;</span>,<span class="at">package =</span> <span class="st">&quot;mlbench&quot;</span>)</span>
<span id="cb922-5"><a href="machine-learning.html#cb922-5" tabindex="-1"></a><span class="fu">colnames</span>(BreastCancer)</span>
<span id="cb922-6"><a href="machine-learning.html#cb922-6" tabindex="-1"></a></span>
<span id="cb922-7"><a href="machine-learning.html#cb922-7" tabindex="-1"></a><span class="co">#check for duplicates</span></span>
<span id="cb922-8"><a href="machine-learning.html#cb922-8" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">duplicated</span>(BreastCancer))</span>
<span id="cb922-9"><a href="machine-learning.html#cb922-9" tabindex="-1"></a></span>
<span id="cb922-10"><a href="machine-learning.html#cb922-10" tabindex="-1"></a><span class="co">#remove duplicates</span></span>
<span id="cb922-11"><a href="machine-learning.html#cb922-11" tabindex="-1"></a><span class="co">#keep Id to avoid creation of new duplicates</span></span>
<span id="cb922-12"><a href="machine-learning.html#cb922-12" tabindex="-1"></a>BreastCancer1<span class="ot">&lt;-</span><span class="fu">unique</span>(BreastCancer) <span class="co">#reduce 699 to 691 rows</span></span>
<span id="cb922-13"><a href="machine-learning.html#cb922-13" tabindex="-1"></a></span>
<span id="cb922-14"><a href="machine-learning.html#cb922-14" tabindex="-1"></a><span class="co">#convert multiple columns to numeric</span></span>
<span id="cb922-15"><a href="machine-learning.html#cb922-15" tabindex="-1"></a><span class="co">#lapply output a list</span></span>
<span id="cb922-16"><a href="machine-learning.html#cb922-16" tabindex="-1"></a>BreastCancer2<span class="ot">&lt;-</span><span class="fu">lapply</span>(BreastCancer1[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">11</span>)], as.numeric) <span class="co">#list</span></span>
<span id="cb922-17"><a href="machine-learning.html#cb922-17" tabindex="-1"></a>BreastCancer2<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(BreastCancer2)</span>
<span id="cb922-18"><a href="machine-learning.html#cb922-18" tabindex="-1"></a>BreastCancer2<span class="sc">$</span>Class<span class="ot">&lt;-</span>BreastCancer1<span class="sc">$</span>Class</span>
<span id="cb922-19"><a href="machine-learning.html#cb922-19" tabindex="-1"></a></span>
<span id="cb922-20"><a href="machine-learning.html#cb922-20" tabindex="-1"></a></span>
<span id="cb922-21"><a href="machine-learning.html#cb922-21" tabindex="-1"></a><span class="co">#check for NA</span></span>
<span id="cb922-22"><a href="machine-learning.html#cb922-22" tabindex="-1"></a><span class="fu">anyNA</span>(BreastCancer2)</span>
<span id="cb922-23"><a href="machine-learning.html#cb922-23" tabindex="-1"></a></span>
<span id="cb922-24"><a href="machine-learning.html#cb922-24" tabindex="-1"></a>split <span class="ot">=</span> caTools<span class="sc">::</span><span class="fu">sample.split</span>(BreastCancer2<span class="sc">$</span>Class, <span class="at">SplitRatio =</span> <span class="fl">0.7</span>)</span>
<span id="cb922-25"><a href="machine-learning.html#cb922-25" tabindex="-1"></a>Train <span class="ot">=</span> <span class="fu">subset</span>(BreastCancer2, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb922-26"><a href="machine-learning.html#cb922-26" tabindex="-1"></a>Test <span class="ot">=</span> <span class="fu">subset</span>(BreastCancer2, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb922-27"><a href="machine-learning.html#cb922-27" tabindex="-1"></a></span>
<span id="cb922-28"><a href="machine-learning.html#cb922-28" tabindex="-1"></a>x<span class="ot">=</span>Train[,<span class="sc">-</span><span class="dv">10</span>]</span>
<span id="cb922-29"><a href="machine-learning.html#cb922-29" tabindex="-1"></a>y<span class="ot">=</span>Train<span class="sc">$</span>Class</span>
<span id="cb922-30"><a href="machine-learning.html#cb922-30" tabindex="-1"></a></span>
<span id="cb922-31"><a href="machine-learning.html#cb922-31" tabindex="-1"></a><span class="co">#cross validation indicates the number of cycle of the procedure from randomly generating new population of chromosome to mutate child chromosome.</span></span>
<span id="cb922-32"><a href="machine-learning.html#cb922-32" tabindex="-1"></a></span>
<span id="cb922-33"><a href="machine-learning.html#cb922-33" tabindex="-1"></a>ga_ctrl <span class="ot">&lt;-</span> <span class="fu">gafsControl</span>(<span class="at">functions =</span> rfGA,</span>
<span id="cb922-34"><a href="machine-learning.html#cb922-34" tabindex="-1"></a>                       <span class="at">method =</span> <span class="st">&quot;cv&quot;</span>,</span>
<span id="cb922-35"><a href="machine-learning.html#cb922-35" tabindex="-1"></a>                       <span class="at">repeats =</span> <span class="dv">3</span>, <span class="co"># default is 10</span></span>
<span id="cb922-36"><a href="machine-learning.html#cb922-36" tabindex="-1"></a>                       <span class="at">genParallel=</span><span class="cn">TRUE</span>, <span class="co"># Use parallel programming</span></span>
<span id="cb922-37"><a href="machine-learning.html#cb922-37" tabindex="-1"></a>                       <span class="at">allowParallel =</span> <span class="cn">TRUE</span></span>
<span id="cb922-38"><a href="machine-learning.html#cb922-38" tabindex="-1"></a>                       )</span>
<span id="cb922-39"><a href="machine-learning.html#cb922-39" tabindex="-1"></a></span>
<span id="cb922-40"><a href="machine-learning.html#cb922-40" tabindex="-1"></a><span class="do">## Use the same random number seed as the RFE process</span></span>
<span id="cb922-41"><a href="machine-learning.html#cb922-41" tabindex="-1"></a><span class="do">## so that the same CV folds are used for the external</span></span>
<span id="cb922-42"><a href="machine-learning.html#cb922-42" tabindex="-1"></a><span class="do">## resampling. </span></span>
<span id="cb922-43"><a href="machine-learning.html#cb922-43" tabindex="-1"></a></span>
<span id="cb922-44"><a href="machine-learning.html#cb922-44" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb922-45"><a href="machine-learning.html#cb922-45" tabindex="-1"></a><span class="fu">system.time</span>(glm_ga <span class="ot">&lt;-</span> <span class="fu">gafs</span>(<span class="at">x =</span> x, <span class="at">y =</span> y,</span>
<span id="cb922-46"><a href="machine-learning.html#cb922-46" tabindex="-1"></a>              <span class="at">iters =</span> <span class="dv">5</span>, <span class="co">#recommended is 200</span></span>
<span id="cb922-47"><a href="machine-learning.html#cb922-47" tabindex="-1"></a>              <span class="at">gafsControl =</span> ga_ctrl, <span class="at">method=</span><span class="st">&quot;glm&quot;</span>))</span>
<span id="cb922-48"><a href="machine-learning.html#cb922-48" tabindex="-1"></a></span>
<span id="cb922-49"><a href="machine-learning.html#cb922-49" tabindex="-1"></a><span class="co">#save(glm_ga,file=&quot;Logistic_GeneticAlgorithm.Rda&quot;)</span></span>
<span id="cb922-50"><a href="machine-learning.html#cb922-50" tabindex="-1"></a></span>
<span id="cb922-51"><a href="machine-learning.html#cb922-51" tabindex="-1"></a><span class="do">################################################################</span></span>
<span id="cb922-52"><a href="machine-learning.html#cb922-52" tabindex="-1"></a><span class="co"># The output of glm_ga</span></span>
<span id="cb922-53"><a href="machine-learning.html#cb922-53" tabindex="-1"></a><span class="co">#Genetic Algorithm Feature Selection</span></span>
<span id="cb922-54"><a href="machine-learning.html#cb922-54" tabindex="-1"></a></span>
<span id="cb922-55"><a href="machine-learning.html#cb922-55" tabindex="-1"></a><span class="co">#484 samples</span></span>
<span id="cb922-56"><a href="machine-learning.html#cb922-56" tabindex="-1"></a><span class="co">#9 predictors</span></span>
<span id="cb922-57"><a href="machine-learning.html#cb922-57" tabindex="-1"></a><span class="co">#2 classes: &#39;benign&#39;, &#39;malignant&#39; </span></span>
<span id="cb922-58"><a href="machine-learning.html#cb922-58" tabindex="-1"></a></span>
<span id="cb922-59"><a href="machine-learning.html#cb922-59" tabindex="-1"></a><span class="co">#Maximum generations: 5 </span></span>
<span id="cb922-60"><a href="machine-learning.html#cb922-60" tabindex="-1"></a><span class="co">#Population per generation: 50 </span></span>
<span id="cb922-61"><a href="machine-learning.html#cb922-61" tabindex="-1"></a><span class="co">#Crossover probability: 0.8 </span></span>
<span id="cb922-62"><a href="machine-learning.html#cb922-62" tabindex="-1"></a><span class="co">#Mutation probability: 0.1 </span></span>
<span id="cb922-63"><a href="machine-learning.html#cb922-63" tabindex="-1"></a><span class="co">#Elitism: 0 </span></span>
<span id="cb922-64"><a href="machine-learning.html#cb922-64" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb922-65"><a href="machine-learning.html#cb922-65" tabindex="-1"></a><span class="co">#Internal performance values: Accuracy, Kappa</span></span>
<span id="cb922-66"><a href="machine-learning.html#cb922-66" tabindex="-1"></a><span class="co">#Subset selection driven to maximize internal Accuracy </span></span>
<span id="cb922-67"><a href="machine-learning.html#cb922-67" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb922-68"><a href="machine-learning.html#cb922-68" tabindex="-1"></a><span class="co">#External performance values: Accuracy, Kappa</span></span>
<span id="cb922-69"><a href="machine-learning.html#cb922-69" tabindex="-1"></a><span class="co">#Best iteration chose by maximizing external Accuracy </span></span>
<span id="cb922-70"><a href="machine-learning.html#cb922-70" tabindex="-1"></a><span class="co">#External resampling method: Cross-Validated (10 fold) </span></span>
<span id="cb922-71"><a href="machine-learning.html#cb922-71" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb922-72"><a href="machine-learning.html#cb922-72" tabindex="-1"></a><span class="co">#During resampling:</span></span>
<span id="cb922-73"><a href="machine-learning.html#cb922-73" tabindex="-1"></a><span class="co">#  * the top 5 selected variables (out of a possible 9):</span></span>
<span id="cb922-74"><a href="machine-learning.html#cb922-74" tabindex="-1"></a><span class="co">#    Cell.shape (100%), Cl.thickness (100%), Epith.c.size (100%), </span></span>
<span id="cb922-75"><a href="machine-learning.html#cb922-75" tabindex="-1"></a>Normal.nucleoli <span class="co">#(100%), Id (90%)</span></span>
<span id="cb922-76"><a href="machine-learning.html#cb922-76" tabindex="-1"></a><span class="co">#  * on average, 6.7 variables were selected (min = 5, max = 8)</span></span>
<span id="cb922-77"><a href="machine-learning.html#cb922-77" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb922-78"><a href="machine-learning.html#cb922-78" tabindex="-1"></a><span class="co">#In the final search using the entire training set:</span></span>
<span id="cb922-79"><a href="machine-learning.html#cb922-79" tabindex="-1"></a><span class="co">#   * 7 features selected at iteration 2 including:</span></span>
<span id="cb922-80"><a href="machine-learning.html#cb922-80" tabindex="-1"></a><span class="co">#     Cl.thickness, Cell.shape, Marg.adhesion, Epith.c.size, Bl.cromatin ... </span></span>
<span id="cb922-81"><a href="machine-learning.html#cb922-81" tabindex="-1"></a><span class="co">#   * external performance at this iteration is</span></span>
<span id="cb922-82"><a href="machine-learning.html#cb922-82" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb922-83"><a href="machine-learning.html#cb922-83" tabindex="-1"></a><span class="co">#   Accuracy       Kappa </span></span>
<span id="cb922-84"><a href="machine-learning.html#cb922-84" tabindex="-1"></a><span class="co">#     0.9691      0.9328 </span></span>
<span id="cb922-85"><a href="machine-learning.html#cb922-85" tabindex="-1"></a><span class="co">#</span></span></code></pre></div>
<p>The output from the Genetic Algorithm is plotted as mean fitness by
generations. This plot shows the internal and external accuracy estimate from cross validation.</p>
<div class="sourceCode" id="cb923"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb923-1"><a href="machine-learning.html#cb923-1" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;./Logistic_GeneticAlgorithm.Rda&quot;</span>)</span>
<span id="cb923-2"><a href="machine-learning.html#cb923-2" tabindex="-1"></a><span class="co">#plot output of genetic algorithm </span></span>
<span id="cb923-3"><a href="machine-learning.html#cb923-3" tabindex="-1"></a><span class="fu">plot</span>(glm_ga)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-10-1-1.png" width="672" /></p>
</div>
</div>
<div id="manifold-learning" class="section level2 hasAnchor" number="6.8">
<h2><span class="header-section-number">6.8</span> Manifold learning<a href="machine-learning.html#manifold-learning" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Manifold learning has been described as using geometry information in high dimensional space to map data into cluster in lower dimensional space. This is a non-linear reduction technique. Several manifold learning methods are described below but this list is not exhaustive. It is available through <em>maniTools</em> package.</p>
<div id="t-stochastic-neighbourhood-embedding" class="section level3 hasAnchor" number="6.8.1">
<h3><span class="header-section-number">6.8.1</span> T-Stochastic Neighbourhood Embedding<a href="machine-learning.html#t-stochastic-neighbourhood-embedding" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>T-Stochastic Neighbourhood Embedding (TSNE) is a manifold learning method which seeks to transform the complex data into low (2) dimensions while maintaining
the distance between neighbouring objects. The distance between data points are can be measured using Euclidean distance or other measures of distance. The transformed data points are conditional probabilities that represents similarities. The original description of TSNE used PCA as a first step to speed up computation and reduce noise.</p>
<p>This method is listed here as it is a form of data reduction method. This non-linear method is different from PCA in that the low dimensional output of
TSNE are not intended for machine learning. TSNE is implemented in R as <em>Rtsne</em>. The perplexity parameter allows tuning of the proximity of the data points. The PCA step can be performed within <em>Rtsne</em> by setting the <em>pca</em> argument. The default number of iterations or max_iter is 1000.</p>
<div class="sourceCode" id="cb924"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb924-1"><a href="machine-learning.html#cb924-1" tabindex="-1"></a><span class="fu">library</span>(Rtsne)</span>
<span id="cb924-2"><a href="machine-learning.html#cb924-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb924-3"><a href="machine-learning.html#cb924-3" tabindex="-1"></a><span class="fu">library</span>(mice) <span class="co">#impute missing data</span></span>
<span id="cb924-4"><a href="machine-learning.html#cb924-4" tabindex="-1"></a></span>
<span id="cb924-5"><a href="machine-learning.html#cb924-5" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;BreastCancer&quot;</span>,<span class="at">package =</span> <span class="st">&quot;mlbench&quot;</span>)</span>
<span id="cb924-6"><a href="machine-learning.html#cb924-6" tabindex="-1"></a><span class="fu">colnames</span>(BreastCancer)</span></code></pre></div>
<pre><code>##  [1] &quot;Id&quot;              &quot;Cl.thickness&quot;    &quot;Cell.size&quot;       &quot;Cell.shape&quot;     
##  [5] &quot;Marg.adhesion&quot;   &quot;Epith.c.size&quot;    &quot;Bare.nuclei&quot;     &quot;Bl.cromatin&quot;    
##  [9] &quot;Normal.nucleoli&quot; &quot;Mitoses&quot;         &quot;Class&quot;</code></pre>
<div class="sourceCode" id="cb926"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb926-1"><a href="machine-learning.html#cb926-1" tabindex="-1"></a><span class="co">#check for duplicates</span></span>
<span id="cb926-2"><a href="machine-learning.html#cb926-2" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">duplicated</span>(BreastCancer))</span></code></pre></div>
<pre><code>## [1] 8</code></pre>
<div class="sourceCode" id="cb928"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb928-1"><a href="machine-learning.html#cb928-1" tabindex="-1"></a><span class="co">#remove duplicates</span></span>
<span id="cb928-2"><a href="machine-learning.html#cb928-2" tabindex="-1"></a><span class="co">#keep Id to avoid creation of new duplicates</span></span>
<span id="cb928-3"><a href="machine-learning.html#cb928-3" tabindex="-1"></a>BreastCancer1<span class="ot">&lt;-</span><span class="fu">unique</span>(BreastCancer) <span class="co">#reduce 699 to 691 rows</span></span>
<span id="cb928-4"><a href="machine-learning.html#cb928-4" tabindex="-1"></a></span>
<span id="cb928-5"><a href="machine-learning.html#cb928-5" tabindex="-1"></a><span class="co">#impute missing data</span></span>
<span id="cb928-6"><a href="machine-learning.html#cb928-6" tabindex="-1"></a><span class="co">#m is number of multiple imputation, default is 5</span></span>
<span id="cb928-7"><a href="machine-learning.html#cb928-7" tabindex="-1"></a><span class="co">#output is a list</span></span>
<span id="cb928-8"><a href="machine-learning.html#cb928-8" tabindex="-1"></a>imputed_Data <span class="ot">&lt;-</span> <span class="fu">mice</span>(BreastCancer1, <span class="at">m=</span><span class="dv">5</span>, <span class="at">maxit =</span> <span class="dv">5</span>, <span class="at">method =</span> <span class="st">&#39;pmm&#39;</span>, <span class="at">seed =</span> <span class="dv">500</span>)</span></code></pre></div>
<pre><code>## 
##  iter imp variable
##   1   1  Bare.nuclei
##   1   2  Bare.nuclei
##   1   3  Bare.nuclei
##   1   4  Bare.nuclei
##   1   5  Bare.nuclei
##   2   1  Bare.nuclei
##   2   2  Bare.nuclei
##   2   3  Bare.nuclei
##   2   4  Bare.nuclei
##   2   5  Bare.nuclei
##   3   1  Bare.nuclei
##   3   2  Bare.nuclei
##   3   3  Bare.nuclei
##   3   4  Bare.nuclei
##   3   5  Bare.nuclei
##   4   1  Bare.nuclei
##   4   2  Bare.nuclei
##   4   3  Bare.nuclei
##   4   4  Bare.nuclei
##   4   5  Bare.nuclei
##   5   1  Bare.nuclei
##   5   2  Bare.nuclei
##   5   3  Bare.nuclei
##   5   4  Bare.nuclei
##   5   5  Bare.nuclei</code></pre>
<div class="sourceCode" id="cb930"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb930-1"><a href="machine-learning.html#cb930-1" tabindex="-1"></a><span class="co">#choose among the 5 imputed dataset</span></span>
<span id="cb930-2"><a href="machine-learning.html#cb930-2" tabindex="-1"></a>completeData <span class="ot">&lt;-</span> <span class="fu">complete</span>(imputed_Data,<span class="dv">2</span>)</span>
<span id="cb930-3"><a href="machine-learning.html#cb930-3" tabindex="-1"></a></span>
<span id="cb930-4"><a href="machine-learning.html#cb930-4" tabindex="-1"></a><span class="co">#convert multiple columns to numeric</span></span>
<span id="cb930-5"><a href="machine-learning.html#cb930-5" tabindex="-1"></a><span class="co">#lapply output a list</span></span>
<span id="cb930-6"><a href="machine-learning.html#cb930-6" tabindex="-1"></a>BreastCancer2<span class="ot">&lt;-</span><span class="fu">lapply</span>(completeData[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">11</span>)], as.numeric) <span class="co">#list</span></span>
<span id="cb930-7"><a href="machine-learning.html#cb930-7" tabindex="-1"></a>BreastCancer2<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(BreastCancer2)</span>
<span id="cb930-8"><a href="machine-learning.html#cb930-8" tabindex="-1"></a>BreastCancer2<span class="sc">$</span>Class<span class="ot">&lt;-</span>BreastCancer1<span class="sc">$</span>Class</span>
<span id="cb930-9"><a href="machine-learning.html#cb930-9" tabindex="-1"></a></span>
<span id="cb930-10"><a href="machine-learning.html#cb930-10" tabindex="-1"></a>BC_unique <span class="ot">&lt;-</span> <span class="fu">unique</span>(BreastCancer2) <span class="co"># Remove duplicates</span></span>
<span id="cb930-11"><a href="machine-learning.html#cb930-11" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>) <span class="co"># Sets seed for reproducibility</span></span>
<span id="cb930-12"><a href="machine-learning.html#cb930-12" tabindex="-1"></a>tsne_out <span class="ot">&lt;-</span> <span class="fu">Rtsne</span>(<span class="fu">as.matrix</span>(BC_unique[,<span class="sc">-</span><span class="dv">11</span>]), </span>
<span id="cb930-13"><a href="machine-learning.html#cb930-13" tabindex="-1"></a>        <span class="at">normalize =</span> T, <span class="co">#normalise data</span></span>
<span id="cb930-14"><a href="machine-learning.html#cb930-14" tabindex="-1"></a>        <span class="at">pca=</span>T, <span class="at">dims =</span> <span class="dv">3</span>, <span class="co">#pca before analysis</span></span>
<span id="cb930-15"><a href="machine-learning.html#cb930-15" tabindex="-1"></a>        <span class="at">perplexity=</span><span class="dv">20</span>, <span class="co">#tuning</span></span>
<span id="cb930-16"><a href="machine-learning.html#cb930-16" tabindex="-1"></a>        <span class="at">verbose=</span><span class="cn">FALSE</span>) <span class="co"># Run TSNE</span></span>
<span id="cb930-17"><a href="machine-learning.html#cb930-17" tabindex="-1"></a><span class="co">#plot(tsne_out$Y,col=BC_unique$Class,asp=1)</span></span>
<span id="cb930-18"><a href="machine-learning.html#cb930-18" tabindex="-1"></a></span>
<span id="cb930-19"><a href="machine-learning.html#cb930-19" tabindex="-1"></a><span class="co"># Add a new column with color</span></span>
<span id="cb930-20"><a href="machine-learning.html#cb930-20" tabindex="-1"></a>mycolors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;red&#39;</span>, <span class="st">&#39;blue&#39;</span>)</span>
<span id="cb930-21"><a href="machine-learning.html#cb930-21" tabindex="-1"></a>BC_unique<span class="sc">$</span>color <span class="ot">&lt;-</span> mycolors[ <span class="fu">as.numeric</span>(BC_unique<span class="sc">$</span>Class) ]</span>
<span id="cb930-22"><a href="machine-learning.html#cb930-22" tabindex="-1"></a></span>
<span id="cb930-23"><a href="machine-learning.html#cb930-23" tabindex="-1"></a><span class="co">#turn off rgl</span></span>
<span id="cb930-24"><a href="machine-learning.html#cb930-24" tabindex="-1"></a><span class="co">#rgl::plot3d(x=tsne_out$Y[,1], y=tsne_out$Y[,2], z=tsne_out$Y[,3], type = &#39;p&#39;, col=BC_unique$color, size=8)</span></span>
<span id="cb930-25"><a href="machine-learning.html#cb930-25" tabindex="-1"></a><span class="co">#rgl::legend3d(&quot;topright&quot;, legend = names(mycolors), pch = 16, col = colors, cex=1, inset=c(0.02))</span></span></code></pre></div>
<p>The example with Breast cancer didn’t turn out as well. Let’s try TSNE with the iris dataset.</p>
<div class="sourceCode" id="cb931"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb931-1"><a href="machine-learning.html#cb931-1" tabindex="-1"></a><span class="co">#TSNE</span></span>
<span id="cb931-2"><a href="machine-learning.html#cb931-2" tabindex="-1"></a></span>
<span id="cb931-3"><a href="machine-learning.html#cb931-3" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb931-4"><a href="machine-learning.html#cb931-4" tabindex="-1"></a><span class="co">#5 columns</span></span>
<span id="cb931-5"><a href="machine-learning.html#cb931-5" tabindex="-1"></a></span>
<span id="cb931-6"><a href="machine-learning.html#cb931-6" tabindex="-1"></a>Iris_unique <span class="ot">&lt;-</span> <span class="fu">unique</span>(iris) <span class="co"># Remove duplicates</span></span>
<span id="cb931-7"><a href="machine-learning.html#cb931-7" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>) <span class="co"># Sets seed for reproducibility</span></span>
<span id="cb931-8"><a href="machine-learning.html#cb931-8" tabindex="-1"></a>tsne_out <span class="ot">&lt;-</span> <span class="fu">Rtsne</span>(<span class="fu">as.matrix</span>(Iris_unique[,<span class="sc">-</span><span class="dv">5</span>]), <span class="at">dims =</span> <span class="dv">2</span>, <span class="at">perplexity=</span><span class="dv">10</span>, <span class="at">verbose=</span><span class="cn">FALSE</span>) <span class="co"># Run TSNE</span></span>
<span id="cb931-9"><a href="machine-learning.html#cb931-9" tabindex="-1"></a><span class="fu">plot</span>(tsne_out<span class="sc">$</span>Y,<span class="at">col=</span>Iris_unique<span class="sc">$</span>Species,<span class="at">asp=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-11-1-1.png" width="672" /></p>
</div>
<div id="self-organising-map" class="section level3 hasAnchor" number="6.8.2">
<h3><span class="header-section-number">6.8.2</span> Self organising map<a href="machine-learning.html#self-organising-map" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Self organising map is an unsupervised machine learning method and is excellent for viewing complex data in low dimensional space i.e. a data reduction method. SOM is available as part of <em>kohonen</em> library. It uses competitive learning to adjust its weight in contrast to other neural network approaches which use backward propagation or gradient descent to update the weight of the features. Each node is evaluated to participate in the neural network. Input vectors that are close to each other in high dimensional space are mapped to be close to each other in low dimensional space. SOM is a competeitive neural network and has been considered as a deep learning method.</p>
<p>The codes below are modified from <a href="https://rpubs.com/AlgoritmaAcademy/som" class="uri">https://rpubs.com/AlgoritmaAcademy/som</a> for use in analysis of iris data. The first illustration is with unsupervised SOM.</p>
<div class="sourceCode" id="cb932"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb932-1"><a href="machine-learning.html#cb932-1" tabindex="-1"></a><span class="fu">library</span>(kohonen)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;kohonen&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:maps&#39;:
## 
##     map</code></pre>
<pre><code>## The following object is masked from &#39;package:listenv&#39;:
## 
##     map</code></pre>
<pre><code>## The following object is masked from &#39;package:class&#39;:
## 
##     somgrid</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     map</code></pre>
<div class="sourceCode" id="cb938"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb938-1"><a href="machine-learning.html#cb938-1" tabindex="-1"></a><span class="co">#unsupervised SOM</span></span>
<span id="cb938-2"><a href="machine-learning.html#cb938-2" tabindex="-1"></a><span class="co">#use iris dataset 150 x 5</span></span>
<span id="cb938-3"><a href="machine-learning.html#cb938-3" tabindex="-1"></a></span>
<span id="cb938-4"><a href="machine-learning.html#cb938-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb938-5"><a href="machine-learning.html#cb938-5" tabindex="-1"></a></span>
<span id="cb938-6"><a href="machine-learning.html#cb938-6" tabindex="-1"></a><span class="co">#convert to numeric matrix</span></span>
<span id="cb938-7"><a href="machine-learning.html#cb938-7" tabindex="-1"></a>iris.train <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">scale</span>(iris[,<span class="sc">-</span><span class="dv">5</span>]))</span>
<span id="cb938-8"><a href="machine-learning.html#cb938-8" tabindex="-1"></a></span>
<span id="cb938-9"><a href="machine-learning.html#cb938-9" tabindex="-1"></a><span class="co"># grid should be smaller than dim(iris) 150 x5</span></span>
<span id="cb938-10"><a href="machine-learning.html#cb938-10" tabindex="-1"></a><span class="co">#xdim =10 and ydim=10 would be &lt; 120</span></span>
<span id="cb938-11"><a href="machine-learning.html#cb938-11" tabindex="-1"></a>iris.grid <span class="ot">&lt;-</span> <span class="fu">somgrid</span>(<span class="at">xdim =</span> <span class="dv">10</span>, <span class="at">ydim =</span> <span class="dv">10</span>, <span class="at">topo =</span> <span class="st">&quot;hexagonal&quot;</span>)</span>
<span id="cb938-12"><a href="machine-learning.html#cb938-12" tabindex="-1"></a></span>
<span id="cb938-13"><a href="machine-learning.html#cb938-13" tabindex="-1"></a><span class="co">#som model</span></span>
<span id="cb938-14"><a href="machine-learning.html#cb938-14" tabindex="-1"></a>iris.model <span class="ot">&lt;-</span> <span class="fu">som</span>(iris.train, iris.grid, <span class="at">rlen =</span> <span class="dv">500</span>, <span class="at">radius =</span> <span class="fl">2.5</span>, <span class="at">keep.data =</span> <span class="cn">TRUE</span>, <span class="at">dist.fcts =</span> <span class="st">&quot;euclidean&quot;</span>)</span>
<span id="cb938-15"><a href="machine-learning.html#cb938-15" tabindex="-1"></a></span>
<span id="cb938-16"><a href="machine-learning.html#cb938-16" tabindex="-1"></a><span class="fu">plot</span>(iris.model, <span class="at">type =</span> <span class="st">&quot;mapping&quot;</span>, <span class="at">pchs =</span> <span class="dv">19</span>, <span class="at">shape =</span> <span class="st">&quot;round&quot;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-12-1.png" width="672" /></p>
<div class="sourceCode" id="cb939"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb939-1"><a href="machine-learning.html#cb939-1" tabindex="-1"></a><span class="fu">plot</span>(iris.model, <span class="at">type =</span> <span class="st">&quot;codes&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Codes Plot&quot;</span>, <span class="at">palette.name =</span> rainbow)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-12-1-1.png" width="672" /></p>
<p>The plot of training shows that the distance between nodes reached a plateau
after 300 iterations.</p>
<div class="sourceCode" id="cb940"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb940-1"><a href="machine-learning.html#cb940-1" tabindex="-1"></a><span class="fu">plot</span>(iris.model, <span class="at">type =</span> <span class="st">&quot;changes&quot;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-12-2-1.png" width="672" /></p>
<p>Supervised SOM is now performed with the same iris data.</p>
<div class="sourceCode" id="cb941"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb941-1"><a href="machine-learning.html#cb941-1" tabindex="-1"></a><span class="co">#SOM</span></span>
<span id="cb941-2"><a href="machine-learning.html#cb941-2" tabindex="-1"></a></span>
<span id="cb941-3"><a href="machine-learning.html#cb941-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb941-4"><a href="machine-learning.html#cb941-4" tabindex="-1"></a>int <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(iris), <span class="fu">nrow</span>(iris)<span class="sc">*</span><span class="fl">0.8</span>)</span>
<span id="cb941-5"><a href="machine-learning.html#cb941-5" tabindex="-1"></a>train <span class="ot">&lt;-</span> iris[int,]</span>
<span id="cb941-6"><a href="machine-learning.html#cb941-6" tabindex="-1"></a>test <span class="ot">&lt;-</span> iris[<span class="sc">-</span>int,]</span>
<span id="cb941-7"><a href="machine-learning.html#cb941-7" tabindex="-1"></a></span>
<span id="cb941-8"><a href="machine-learning.html#cb941-8" tabindex="-1"></a><span class="co"># scaling data</span></span>
<span id="cb941-9"><a href="machine-learning.html#cb941-9" tabindex="-1"></a>trainX <span class="ot">&lt;-</span> <span class="fu">scale</span>(train[,<span class="sc">-</span><span class="dv">5</span>])</span>
<span id="cb941-10"><a href="machine-learning.html#cb941-10" tabindex="-1"></a>testX <span class="ot">&lt;-</span> <span class="fu">scale</span>(test[,<span class="sc">-</span><span class="dv">5</span>], <span class="at">center =</span> <span class="fu">attr</span>(trainX, <span class="st">&quot;scaled:center&quot;</span>))</span>
<span id="cb941-11"><a href="machine-learning.html#cb941-11" tabindex="-1"></a></span>
<span id="cb941-12"><a href="machine-learning.html#cb941-12" tabindex="-1"></a><span class="co"># make label</span></span>
<span id="cb941-13"><a href="machine-learning.html#cb941-13" tabindex="-1"></a><span class="co">#iris$species is already of class factor</span></span>
<span id="cb941-14"><a href="machine-learning.html#cb941-14" tabindex="-1"></a></span>
<span id="cb941-15"><a href="machine-learning.html#cb941-15" tabindex="-1"></a>train.label <span class="ot">&lt;-</span> train[,<span class="dv">5</span>]</span>
<span id="cb941-16"><a href="machine-learning.html#cb941-16" tabindex="-1"></a>test.label <span class="ot">&lt;-</span> test[,<span class="dv">5</span>]</span>
<span id="cb941-17"><a href="machine-learning.html#cb941-17" tabindex="-1"></a>test[,<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="dv">916</span></span>
<span id="cb941-18"><a href="machine-learning.html#cb941-18" tabindex="-1"></a>testXY <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">independent =</span> testX, <span class="at">dependent =</span> test.label)</span>
<span id="cb941-19"><a href="machine-learning.html#cb941-19" tabindex="-1"></a></span>
<span id="cb941-20"><a href="machine-learning.html#cb941-20" tabindex="-1"></a><span class="co"># make a train data sets that scaled</span></span>
<span id="cb941-21"><a href="machine-learning.html#cb941-21" tabindex="-1"></a><span class="co"># convert them to be a numeric matrix </span></span>
<span id="cb941-22"><a href="machine-learning.html#cb941-22" tabindex="-1"></a>iris.train <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">scale</span>(train[,<span class="sc">-</span><span class="dv">5</span>]))</span>
<span id="cb941-23"><a href="machine-learning.html#cb941-23" tabindex="-1"></a></span>
<span id="cb941-24"><a href="machine-learning.html#cb941-24" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb941-25"><a href="machine-learning.html#cb941-25" tabindex="-1"></a></span>
<span id="cb941-26"><a href="machine-learning.html#cb941-26" tabindex="-1"></a><span class="co"># grid should be smaller than dim(train) 120 x5</span></span>
<span id="cb941-27"><a href="machine-learning.html#cb941-27" tabindex="-1"></a><span class="co">#xdim =10 and ydim=10 would be &lt; 120</span></span>
<span id="cb941-28"><a href="machine-learning.html#cb941-28" tabindex="-1"></a>iris.grid <span class="ot">&lt;-</span> <span class="fu">somgrid</span>(<span class="at">xdim =</span> <span class="dv">10</span>, <span class="at">ydim =</span> <span class="dv">10</span>, <span class="at">topo =</span> <span class="st">&quot;hexagonal&quot;</span>)</span>
<span id="cb941-29"><a href="machine-learning.html#cb941-29" tabindex="-1"></a></span>
<span id="cb941-30"><a href="machine-learning.html#cb941-30" tabindex="-1"></a><span class="co">#som model</span></span>
<span id="cb941-31"><a href="machine-learning.html#cb941-31" tabindex="-1"></a>iris.model <span class="ot">&lt;-</span> <span class="fu">som</span>(iris.train, iris.grid, <span class="at">rlen =</span> <span class="dv">500</span>, <span class="at">radius =</span> <span class="fl">2.5</span>, <span class="at">keep.data =</span> <span class="cn">TRUE</span>, <span class="at">dist.fcts =</span> <span class="st">&quot;euclidean&quot;</span>)</span>
<span id="cb941-32"><a href="machine-learning.html#cb941-32" tabindex="-1"></a></span>
<span id="cb941-33"><a href="machine-learning.html#cb941-33" tabindex="-1"></a>class <span class="ot">&lt;-</span> <span class="fu">xyf</span>(trainX, <span class="fu">classvec2classmat</span>(train.label), iris.grid, <span class="at">rlen =</span> <span class="dv">500</span>)</span>
<span id="cb941-34"><a href="machine-learning.html#cb941-34" tabindex="-1"></a></span>
<span id="cb941-35"><a href="machine-learning.html#cb941-35" tabindex="-1"></a><span class="fu">plot</span>(class, <span class="at">type =</span> <span class="st">&quot;changes&quot;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-13-1.png" width="672" /></p>
<div class="sourceCode" id="cb942"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb942-1"><a href="machine-learning.html#cb942-1" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(class, <span class="at">newdata =</span> testXY)</span>
<span id="cb942-2"><a href="machine-learning.html#cb942-2" tabindex="-1"></a><span class="fu">table</span>(<span class="at">Predict =</span> pred<span class="sc">$</span>predictions[[<span class="dv">2</span>]], <span class="at">Actual =</span> test.label)</span></code></pre></div>
<pre><code>##             Actual
## Predict      setosa versicolor virginica
##   setosa          9          0         0
##   versicolor      0          8         0
##   virginica       0          0         7</code></pre>
<p>Determine number of clusters.</p>
<div class="sourceCode" id="cb944"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb944-1"><a href="machine-learning.html#cb944-1" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span></code></pre></div>
<pre><code>## Welcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa</code></pre>
<div class="sourceCode" id="cb946"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb946-1"><a href="machine-learning.html#cb946-1" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(iris.model<span class="sc">$</span>codes[[<span class="dv">1</span>]], kmeans, <span class="at">method =</span> <span class="st">&quot;wss&quot;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-13-1-1.png" width="672" /></p>
<div class="sourceCode" id="cb947"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb947-1"><a href="machine-learning.html#cb947-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb947-2"><a href="machine-learning.html#cb947-2" tabindex="-1"></a>clust <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(iris.model<span class="sc">$</span>codes[[<span class="dv">1</span>]], <span class="dv">6</span>)</span>
<span id="cb947-3"><a href="machine-learning.html#cb947-3" tabindex="-1"></a><span class="fu">plot</span>(iris.model, <span class="at">type =</span> <span class="st">&quot;codes&quot;</span>, <span class="at">bgcol =</span> <span class="fu">rainbow</span>(<span class="dv">9</span>)[clust<span class="sc">$</span>cluster], </span>
<span id="cb947-4"><a href="machine-learning.html#cb947-4" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Cluster SOM&quot;</span>)</span>
<span id="cb947-5"><a href="machine-learning.html#cb947-5" tabindex="-1"></a><span class="fu">add.cluster.boundaries</span>(iris.model, clust<span class="sc">$</span>cluster)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-13-2-1.png" width="672" /></p>
</div>
<div id="multidimensional-scaling" class="section level3 hasAnchor" number="6.8.3">
<h3><span class="header-section-number">6.8.3</span> Multidimensional scaling<a href="machine-learning.html#multidimensional-scaling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>MDS is a method of dimensionality reduction which preserves the distance between variables. This method has been used in geography. It is implemented in <em>IsoplotR</em> package and <em>igraph</em> package as <em>layout.mds</em>.</p>
</div>
</div>
<div id="deep-learning" class="section level2 hasAnchor" number="6.9">
<h2><span class="header-section-number">6.9</span> Deep learning<a href="machine-learning.html#deep-learning" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Deep learning is a neural network with many layers: inner, multiple hidden and outer layer. Deep learning methods can be supervised or unsupervised. It uses gradient descent algorithm in search for the solution. One potential issue that
it may be stuck in a local minima rather than the global minima.</p>
<p>There are several R libraries for performing deep learning. It’s worth checking out the installation requirement as some require installing the library in
python and uses the <em>reticulate</em> library to perform analysis. The examples used here are R libraries including <em>RSNNS</em>. The instructions for installing <em>Miniconda</em> from <em>reticulate</em> was provided in the earlier chapter on [data wrangling][Python Minconda environment]. Those instruction include installing <em>torch</em> and <em>kerras</em>.</p>
<div id="deep-neural-network" class="section level3 hasAnchor" number="6.9.1">
<h3><span class="header-section-number">6.9.1</span> Deep neural network<a href="machine-learning.html#deep-neural-network" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="multiplayer-perceptron" class="section level4 hasAnchor" number="6.9.1.1">
<h4><span class="header-section-number">6.9.1.1</span> Multiplayer Perceptron<a href="machine-learning.html#multiplayer-perceptron" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Multilayer perceptron is a type of deep learning. . It passes information in one direction from inner to hidden and outer layer and hence is referred to as feed forward artificial neural network. It trains the data using a loss function
which adapt to the parameter and optimise according to the specified learning rate. Overfitting is minimised by using an L2 regularisation penalty, termed alpha.</p>
<p>For tabular data, deep learning may not necessarily be better than other machine learning method. By contrast, deep learning may be better for unstructured data.</p>
<div class="sourceCode" id="cb948"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb948-1"><a href="machine-learning.html#cb948-1" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb948-2"><a href="machine-learning.html#cb948-2" tabindex="-1"></a><span class="fu">library</span>(RSNNS)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;RSNNS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:kohonen&#39;:
## 
##     som</code></pre>
<pre><code>## The following object is masked from &#39;package:ModelMetrics&#39;:
## 
##     confusionMatrix</code></pre>
<pre><code>## The following objects are masked from &#39;package:caret&#39;:
## 
##     confusionMatrix, train</code></pre>
<pre><code>## The following object is masked from &#39;package:generics&#39;:
## 
##     train</code></pre>
<div class="sourceCode" id="cb954"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb954-1"><a href="machine-learning.html#cb954-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;BreastCancer&quot;</span>,<span class="at">package =</span> <span class="st">&quot;mlbench&quot;</span>)</span>
<span id="cb954-2"><a href="machine-learning.html#cb954-2" tabindex="-1"></a><span class="fu">colnames</span>(BreastCancer)</span></code></pre></div>
<pre><code>##  [1] &quot;Id&quot;              &quot;Cl.thickness&quot;    &quot;Cell.size&quot;       &quot;Cell.shape&quot;     
##  [5] &quot;Marg.adhesion&quot;   &quot;Epith.c.size&quot;    &quot;Bare.nuclei&quot;     &quot;Bl.cromatin&quot;    
##  [9] &quot;Normal.nucleoli&quot; &quot;Mitoses&quot;         &quot;Class&quot;</code></pre>
<div class="sourceCode" id="cb956"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb956-1"><a href="machine-learning.html#cb956-1" tabindex="-1"></a><span class="co">#remove ID column</span></span>
<span id="cb956-2"><a href="machine-learning.html#cb956-2" tabindex="-1"></a><span class="co">#remove column a=with NA </span></span>
<span id="cb956-3"><a href="machine-learning.html#cb956-3" tabindex="-1"></a><span class="co">#alternative is to impute</span></span>
<span id="cb956-4"><a href="machine-learning.html#cb956-4" tabindex="-1"></a>BreastCancer<span class="ot">&lt;-</span>BreastCancer[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>)]<span class="co">#remaining 9 columns</span></span>
<span id="cb956-5"><a href="machine-learning.html#cb956-5" tabindex="-1"></a></span>
<span id="cb956-6"><a href="machine-learning.html#cb956-6" tabindex="-1"></a><span class="co">#convert multiple columns to numeric</span></span>
<span id="cb956-7"><a href="machine-learning.html#cb956-7" tabindex="-1"></a><span class="co">#lapply output a list</span></span>
<span id="cb956-8"><a href="machine-learning.html#cb956-8" tabindex="-1"></a>BreastCancer2<span class="ot">&lt;-</span><span class="fu">lapply</span>(BreastCancer[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">9</span>)], as.numeric)</span>
<span id="cb956-9"><a href="machine-learning.html#cb956-9" tabindex="-1"></a>BreastCancer2<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(BreastCancer2)</span>
<span id="cb956-10"><a href="machine-learning.html#cb956-10" tabindex="-1"></a>BreastCancer2<span class="ot">&lt;-</span><span class="fu">merge</span>(BreastCancer2, BreastCancer<span class="sc">$</span>Class)</span>
<span id="cb956-11"><a href="machine-learning.html#cb956-11" tabindex="-1"></a></span>
<span id="cb956-12"><a href="machine-learning.html#cb956-12" tabindex="-1"></a><span class="co">#note Class is benign or malignant of class factor</span></span>
<span id="cb956-13"><a href="machine-learning.html#cb956-13" tabindex="-1"></a><span class="co">#column Bare.nuclei removed due to NA</span></span>
<span id="cb956-14"><a href="machine-learning.html#cb956-14" tabindex="-1"></a></span>
<span id="cb956-15"><a href="machine-learning.html#cb956-15" tabindex="-1"></a><span class="co">#split data</span></span>
<span id="cb956-16"><a href="machine-learning.html#cb956-16" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb956-17"><a href="machine-learning.html#cb956-17" tabindex="-1"></a></span>
<span id="cb956-18"><a href="machine-learning.html#cb956-18" tabindex="-1"></a>BreastCancer2Values <span class="ot">&lt;-</span> BreastCancer2[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>)]</span>
<span id="cb956-19"><a href="machine-learning.html#cb956-19" tabindex="-1"></a>BreastCancer2Targets <span class="ot">&lt;-</span> <span class="fu">decodeClassLabels</span>(BreastCancer2[,<span class="dv">9</span>])</span>
<span id="cb956-20"><a href="machine-learning.html#cb956-20" tabindex="-1"></a></span>
<span id="cb956-21"><a href="machine-learning.html#cb956-21" tabindex="-1"></a><span class="co">#this returns the orginal file as a list</span></span>
<span id="cb956-22"><a href="machine-learning.html#cb956-22" tabindex="-1"></a>BreastCancer2 <span class="ot">&lt;-</span> <span class="fu">splitForTrainingAndTest</span>(BreastCancer2Values, BreastCancer2Targets, <span class="at">ratio=</span><span class="fl">0.15</span>) <span class="co">#ratio is percentage for test data</span></span>
<span id="cb956-23"><a href="machine-learning.html#cb956-23" tabindex="-1"></a>BreastCancer2 <span class="ot">&lt;-</span> <span class="fu">normTrainingAndTestSet</span>(BreastCancer2) <span class="co">#put out a list object</span></span>
<span id="cb956-24"><a href="machine-learning.html#cb956-24" tabindex="-1"></a></span>
<span id="cb956-25"><a href="machine-learning.html#cb956-25" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">mlp</span>(BreastCancer2<span class="sc">$</span>inputsTrain, </span>
<span id="cb956-26"><a href="machine-learning.html#cb956-26" tabindex="-1"></a>             BreastCancer2<span class="sc">$</span>targetsTrain, </span>
<span id="cb956-27"><a href="machine-learning.html#cb956-27" tabindex="-1"></a>             <span class="at">size=</span><span class="dv">5</span>, <span class="co">#number of unit in hidden layer </span></span>
<span id="cb956-28"><a href="machine-learning.html#cb956-28" tabindex="-1"></a>             <span class="at">learnFuncParams=</span><span class="fu">c</span>(<span class="fl">0.1</span>), </span>
<span id="cb956-29"><a href="machine-learning.html#cb956-29" tabindex="-1"></a>              <span class="at">maxit=</span><span class="dv">50</span>, <span class="co">#number of iteration to learn</span></span>
<span id="cb956-30"><a href="machine-learning.html#cb956-30" tabindex="-1"></a>             <span class="at">inputsTest=</span>BreastCancer2<span class="sc">$</span>inputsTest, <span class="at">targetsTest=</span>BreastCancer2<span class="sc">$</span>targetsTest)</span>
<span id="cb956-31"><a href="machine-learning.html#cb956-31" tabindex="-1"></a></span>
<span id="cb956-32"><a href="machine-learning.html#cb956-32" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## SNNS network definition file V1.4-3D
## generated at Sat Feb 10 22:43:54 2024
## 
## network name : RSNNS_untitled
## source files :
## no. of units : 15
## no. of connections : 50
## no. of unit types : 0
## no. of site types : 0
## 
## 
## learning function : Std_Backpropagation
## update function   : Topological_Order
## 
## 
## unit default section :
## 
## act      | bias     | st | subnet | layer | act func     | out func
## ---------|----------|----|--------|-------|--------------|-------------
##  0.00000 |  0.00000 | i  |      0 |     1 | Act_Logistic | Out_Identity 
## ---------|----------|----|--------|-------|--------------|-------------
## 
## 
## unit definition section :
## 
## no. | typeName | unitName         | act      | bias     | st | position | act func     | out func | sites
## ----|----------|------------------|----------|----------|----|----------|--------------|----------|-------
##   1 |          | Input_1          | -0.14849 | -0.12745 | i  | 1,0,0    | Act_Identity |          | 
##   2 |          | Input_2          |  1.59566 |  0.17298 | i  | 2,0,0    | Act_Identity |          | 
##   3 |          | Input_3          |  1.61379 | -0.05461 | i  | 3,0,0    | Act_Identity |          | 
##   4 |          | Input_4          |  0.76866 |  0.22981 | i  | 4,0,0    | Act_Identity |          | 
##   5 |          | Input_5          |  0.35424 |  0.26428 | i  | 5,0,0    | Act_Identity |          | 
##   6 |          | Input_6          |  2.69324 | -0.27267 | i  | 6,0,0    | Act_Identity |          | 
##   7 |          | Input_7          |  0.37127 |  0.01686 | i  | 7,0,0    | Act_Identity |          | 
##   8 |          | Input_8          | -0.35178 |  0.23545 | i  | 8,0,0    | Act_Identity |          | 
##   9 |          | Hidden_2_1       |  0.01505 | -4.19609 | h  | 1,2,0    |||
##  10 |          | Hidden_2_2       |  0.01511 | -4.18364 | h  | 2,2,0    |||
##  11 |          | Hidden_2_3       |  0.01446 | -4.17636 | h  | 3,2,0    |||
##  12 |          | Hidden_2_4       |  0.01596 | -4.17513 | h  | 4,2,0    |||
##  13 |          | Hidden_2_5       |  0.01394 | -4.20955 | h  | 5,2,0    |||
##  14 |          | Output_benign    |  0.71619 |  0.92553 | o  | 1,4,0    |||
##  15 |          | Output_malignant |  0.28380 | -0.92463 | o  | 2,4,0    |||
## ----|----------|------------------|----------|----------|----|----------|--------------|----------|-------
## 
## 
## connection definition section :
## 
## target | site | source:weight
## -------|------|---------------------------------------------------------------------------------------------------------------------
##      9 |      |  8:-0.00576,  7: 0.00727,  6:-0.00682,  5:-0.01802,  4: 0.01969,  3:-0.08011,  2: 0.09269,  1:-0.00830
##     10 |      |  8:-0.00727,  7: 0.02291,  6:-0.00065,  5:-0.01455,  4: 0.01343,  3: 0.07341,  2:-0.07951,  1:-0.00231
##     11 |      |  8:-0.02047,  7: 0.00020,  6:-0.03410,  5: 0.01364,  4: 0.05111,  3:-0.04571,  2: 0.04224,  1:-0.00804
##     12 |      |  8: 0.00616,  7: 0.00433,  6: 0.01931,  5:-0.03026,  4: 0.00085,  3:-0.02034,  2: 0.02802,  1:-0.00241
##     13 |      |  8:-0.01292,  7: 0.00408,  6: 0.00104,  5: 0.00315,  4: 0.04242,  3:-0.07730,  2: 0.02324,  1: 0.03049
##     14 |      | 13: 0.02422, 12:-0.07496, 11:-0.05541, 10: 0.00556,  9: 0.11299
##     15 |      | 13: 0.00929, 12:-0.09087, 11:-0.07272, 10:-0.00928,  9: 0.09646
## -------|------|---------------------------------------------------------------------------------------------------------------------</code></pre>
<div class="sourceCode" id="cb958"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb958-1"><a href="machine-learning.html#cb958-1" tabindex="-1"></a><span class="fu">weightMatrix</span>(model)</span></code></pre></div>
<pre><code>##                  Input_1 Input_2 Input_3 Input_4 Input_5 Input_6 Input_7 Input_8
## Input_1                0       0       0       0       0       0       0       0
## Input_2                0       0       0       0       0       0       0       0
## Input_3                0       0       0       0       0       0       0       0
## Input_4                0       0       0       0       0       0       0       0
## Input_5                0       0       0       0       0       0       0       0
## Input_6                0       0       0       0       0       0       0       0
## Input_7                0       0       0       0       0       0       0       0
## Input_8                0       0       0       0       0       0       0       0
## Hidden_2_1             0       0       0       0       0       0       0       0
## Hidden_2_2             0       0       0       0       0       0       0       0
## Hidden_2_3             0       0       0       0       0       0       0       0
## Hidden_2_4             0       0       0       0       0       0       0       0
## Hidden_2_5             0       0       0       0       0       0       0       0
## Output_benign          0       0       0       0       0       0       0       0
## Output_malignant       0       0       0       0       0       0       0       0
##                    Hidden_2_1    Hidden_2_2    Hidden_2_3    Hidden_2_4   Hidden_2_5
## Input_1          -0.008297254 -0.0023068141 -0.0080354111 -0.0024115480  0.030488508
## Input_2           0.092688218 -0.0795127451  0.0422427431  0.0280199945  0.023240086
## Input_3          -0.080105409  0.0734057277 -0.0457132570 -0.0203414690 -0.077304244
## Input_4           0.019694204  0.0134255355  0.0511073507  0.0008500156  0.042423774
## Input_5          -0.018022288 -0.0145457229  0.0136382505 -0.0302589945  0.003147935
## Input_6          -0.006821295 -0.0006512092 -0.0341025740  0.0193094723  0.001040343
## Input_7           0.007272924  0.0229056627  0.0001989322  0.0043286891  0.004078272
## Input_8          -0.005761526 -0.0072661606 -0.0204701889  0.0061648567 -0.012916351
## Hidden_2_1        0.000000000  0.0000000000  0.0000000000  0.0000000000  0.000000000
## Hidden_2_2        0.000000000  0.0000000000  0.0000000000  0.0000000000  0.000000000
## Hidden_2_3        0.000000000  0.0000000000  0.0000000000  0.0000000000  0.000000000
## Hidden_2_4        0.000000000  0.0000000000  0.0000000000  0.0000000000  0.000000000
## Hidden_2_5        0.000000000  0.0000000000  0.0000000000  0.0000000000  0.000000000
## Output_benign     0.000000000  0.0000000000  0.0000000000  0.0000000000  0.000000000
## Output_malignant  0.000000000  0.0000000000  0.0000000000  0.0000000000  0.000000000
##                  Output_benign Output_malignant
## Input_1            0.000000000      0.000000000
## Input_2            0.000000000      0.000000000
## Input_3            0.000000000      0.000000000
## Input_4            0.000000000      0.000000000
## Input_5            0.000000000      0.000000000
## Input_6            0.000000000      0.000000000
## Input_7            0.000000000      0.000000000
## Input_8            0.000000000      0.000000000
## Hidden_2_1         0.112992622      0.096456863
## Hidden_2_2         0.005558367     -0.009282685
## Hidden_2_3        -0.055406742     -0.072724856
## Hidden_2_4        -0.074957542     -0.090871565
## Hidden_2_5         0.024224803      0.009294559
## Output_benign      0.000000000      0.000000000
## Output_malignant   0.000000000      0.000000000</code></pre>
<div class="sourceCode" id="cb960"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb960-1"><a href="machine-learning.html#cb960-1" tabindex="-1"></a><span class="fu">extractNetInfo</span>(model)</span></code></pre></div>
<pre><code>## $infoHeader
##                 name               value
## 1       no. of units                  15
## 2 no. of connections                  50
## 3  no. of unit types                   0
## 4  no. of site types                   0
## 5  learning function Std_Backpropagation
## 6    update function   Topological_Order
## 
## $unitDefinitions
##    unitNo         unitName     unitAct    unitBias        type posX posY posZ
## 1       1          Input_1 -0.14849401 -0.12745351  UNIT_INPUT    1    0    0
## 2       2          Input_2  1.59566152  0.17298311  UNIT_INPUT    2    0    0
## 3       3          Input_3  1.61378837 -0.05461386  UNIT_INPUT    3    0    0
## 4       4          Input_4  0.76865852  0.22981048  UNIT_INPUT    4    0    0
## 5       5          Input_5  0.35424057  0.26428038  UNIT_INPUT    5    0    0
## 6       6          Input_6  2.69324446 -0.27266610  UNIT_INPUT    6    0    0
## 7       7          Input_7  0.37127367  0.01686329  UNIT_INPUT    7    0    0
## 8       8          Input_8 -0.35178334  0.23545146  UNIT_INPUT    8    0    0
## 9       9       Hidden_2_1  0.01505136 -4.19608831 UNIT_HIDDEN    1    2    0
## 10     10       Hidden_2_2  0.01510898 -4.18364382 UNIT_HIDDEN    2    2    0
## 11     11       Hidden_2_3  0.01445734 -4.17636061 UNIT_HIDDEN    3    2    0
## 12     12       Hidden_2_4  0.01596117 -4.17512655 UNIT_HIDDEN    4    2    0
## 13     13       Hidden_2_5  0.01393711 -4.20955276 UNIT_HIDDEN    5    2    0
## 14     14    Output_benign  0.71619302  0.92553055 UNIT_OUTPUT    1    4    0
## 15     15 Output_malignant  0.28380045 -0.92462683 UNIT_OUTPUT    2    4    0
##         actFunc      outFunc sites
## 1  Act_Identity Out_Identity      
## 2  Act_Identity Out_Identity      
## 3  Act_Identity Out_Identity      
## 4  Act_Identity Out_Identity      
## 5  Act_Identity Out_Identity      
## 6  Act_Identity Out_Identity      
## 7  Act_Identity Out_Identity      
## 8  Act_Identity Out_Identity      
## 9  Act_Logistic Out_Identity      
## 10 Act_Logistic Out_Identity      
## 11 Act_Logistic Out_Identity      
## 12 Act_Logistic Out_Identity      
## 13 Act_Logistic Out_Identity      
## 14 Act_Logistic Out_Identity      
## 15 Act_Logistic Out_Identity      
## 
## $fullWeightMatrix
##                  Input_1 Input_2 Input_3 Input_4 Input_5 Input_6 Input_7 Input_8
## Input_1                0       0       0       0       0       0       0       0
## Input_2                0       0       0       0       0       0       0       0
## Input_3                0       0       0       0       0       0       0       0
## Input_4                0       0       0       0       0       0       0       0
## Input_5                0       0       0       0       0       0       0       0
## Input_6                0       0       0       0       0       0       0       0
## Input_7                0       0       0       0       0       0       0       0
## Input_8                0       0       0       0       0       0       0       0
## Hidden_2_1             0       0       0       0       0       0       0       0
## Hidden_2_2             0       0       0       0       0       0       0       0
## Hidden_2_3             0       0       0       0       0       0       0       0
## Hidden_2_4             0       0       0       0       0       0       0       0
## Hidden_2_5             0       0       0       0       0       0       0       0
## Output_benign          0       0       0       0       0       0       0       0
## Output_malignant       0       0       0       0       0       0       0       0
##                    Hidden_2_1    Hidden_2_2    Hidden_2_3    Hidden_2_4   Hidden_2_5
## Input_1          -0.008297254 -0.0023068141 -0.0080354111 -0.0024115480  0.030488508
## Input_2           0.092688218 -0.0795127451  0.0422427431  0.0280199945  0.023240086
## Input_3          -0.080105409  0.0734057277 -0.0457132570 -0.0203414690 -0.077304244
## Input_4           0.019694204  0.0134255355  0.0511073507  0.0008500156  0.042423774
## Input_5          -0.018022288 -0.0145457229  0.0136382505 -0.0302589945  0.003147935
## Input_6          -0.006821295 -0.0006512092 -0.0341025740  0.0193094723  0.001040343
## Input_7           0.007272924  0.0229056627  0.0001989322  0.0043286891  0.004078272
## Input_8          -0.005761526 -0.0072661606 -0.0204701889  0.0061648567 -0.012916351
## Hidden_2_1        0.000000000  0.0000000000  0.0000000000  0.0000000000  0.000000000
## Hidden_2_2        0.000000000  0.0000000000  0.0000000000  0.0000000000  0.000000000
## Hidden_2_3        0.000000000  0.0000000000  0.0000000000  0.0000000000  0.000000000
## Hidden_2_4        0.000000000  0.0000000000  0.0000000000  0.0000000000  0.000000000
## Hidden_2_5        0.000000000  0.0000000000  0.0000000000  0.0000000000  0.000000000
## Output_benign     0.000000000  0.0000000000  0.0000000000  0.0000000000  0.000000000
## Output_malignant  0.000000000  0.0000000000  0.0000000000  0.0000000000  0.000000000
##                  Output_benign Output_malignant
## Input_1            0.000000000      0.000000000
## Input_2            0.000000000      0.000000000
## Input_3            0.000000000      0.000000000
## Input_4            0.000000000      0.000000000
## Input_5            0.000000000      0.000000000
## Input_6            0.000000000      0.000000000
## Input_7            0.000000000      0.000000000
## Input_8            0.000000000      0.000000000
## Hidden_2_1         0.112992622      0.096456863
## Hidden_2_2         0.005558367     -0.009282685
## Hidden_2_3        -0.055406742     -0.072724856
## Hidden_2_4        -0.074957542     -0.090871565
## Hidden_2_5         0.024224803      0.009294559
## Output_benign      0.000000000      0.000000000
## Output_malignant   0.000000000      0.000000000</code></pre>
<div class="sourceCode" id="cb962"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb962-1"><a href="machine-learning.html#cb962-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb962-2"><a href="machine-learning.html#cb962-2" tabindex="-1"></a><span class="fu">plotIterativeError</span>(model)</span>
<span id="cb962-3"><a href="machine-learning.html#cb962-3" tabindex="-1"></a></span>
<span id="cb962-4"><a href="machine-learning.html#cb962-4" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model,BreastCancer2<span class="sc">$</span>inputsTest)</span>
<span id="cb962-5"><a href="machine-learning.html#cb962-5" tabindex="-1"></a></span>
<span id="cb962-6"><a href="machine-learning.html#cb962-6" tabindex="-1"></a><span class="fu">plotRegressionError</span>(predictions[,<span class="dv">2</span>], BreastCancer2<span class="sc">$</span>targetsTest[,<span class="dv">2</span>])</span>
<span id="cb962-7"><a href="machine-learning.html#cb962-7" tabindex="-1"></a></span>
<span id="cb962-8"><a href="machine-learning.html#cb962-8" tabindex="-1"></a><span class="fu">confusionMatrix</span>(BreastCancer2<span class="sc">$</span>targetsTrain,<span class="fu">fitted.values</span>(model))</span></code></pre></div>
<pre><code>##        predictions
## targets      1
##       1 262125
##       2 153185</code></pre>
<div class="sourceCode" id="cb964"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb964-1"><a href="machine-learning.html#cb964-1" tabindex="-1"></a><span class="fu">confusionMatrix</span>(BreastCancer2<span class="sc">$</span>targetsTest,predictions)</span></code></pre></div>
<pre><code>##        predictions
## targets     1
##       1 58017
##       2 15274</code></pre>
<div class="sourceCode" id="cb966"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb966-1"><a href="machine-learning.html#cb966-1" tabindex="-1"></a><span class="fu">plotROC</span>(<span class="fu">fitted.values</span>(model)[,<span class="dv">2</span>], BreastCancer2<span class="sc">$</span>targetsTrain[,<span class="dv">2</span>])</span>
<span id="cb966-2"><a href="machine-learning.html#cb966-2" tabindex="-1"></a><span class="fu">plotROC</span>(predictions[,<span class="dv">2</span>], BreastCancer2<span class="sc">$</span>targetsTest[,<span class="dv">2</span>])</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-14-1.png" width="672" /></p>
<div class="sourceCode" id="cb967"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb967-1"><a href="machine-learning.html#cb967-1" tabindex="-1"></a>probs <span class="ot">&lt;-</span> predictions <span class="sc">/</span> <span class="fu">rowSums</span>(predictions)</span>
<span id="cb967-2"><a href="machine-learning.html#cb967-2" tabindex="-1"></a></span>
<span id="cb967-3"><a href="machine-learning.html#cb967-3" tabindex="-1"></a><span class="co">#confusion matrix with 402040-method</span></span>
<span id="cb967-4"><a href="machine-learning.html#cb967-4" tabindex="-1"></a><span class="fu">confusionMatrix</span>(BreastCancer2<span class="sc">$</span>targetsTrain, <span class="fu">encodeClassLabels</span>(<span class="fu">fitted.values</span>(model),                                                      <span class="at">method=</span><span class="st">&quot;402040&quot;</span>, <span class="at">l=</span><span class="fl">0.4</span>, <span class="at">h=</span><span class="fl">0.6</span>))</span></code></pre></div>
<pre><code>##        predictions
## targets      1
##       1 262125
##       2 153185</code></pre>
</div>
<div id="deep-survival-neural-network" class="section level4 hasAnchor" number="6.9.1.2">
<h4><span class="header-section-number">6.9.1.2</span> Deep survival neural network<a href="machine-learning.html#deep-survival-neural-network" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There are several libraries available in <em>survivalmodels</em> which interface with <em>pycox</em> from Python. First, we illustrate the use of <em>deepsurv</em>.</p>
<div class="sourceCode" id="cb969"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb969-1"><a href="machine-learning.html#cb969-1" tabindex="-1"></a><span class="fu">library</span>(survivalmodels)</span></code></pre></div>
<pre><code>## Warning: package &#39;survivalmodels&#39; was built under R version 4.3.2</code></pre>
<div class="sourceCode" id="cb971"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb971-1"><a href="machine-learning.html#cb971-1" tabindex="-1"></a><span class="fu">data</span>(Melanoma, <span class="at">package =</span> <span class="st">&quot;MASS&quot;</span>)</span>
<span id="cb971-2"><a href="machine-learning.html#cb971-2" tabindex="-1"></a></span>
<span id="cb971-3"><a href="machine-learning.html#cb971-3" tabindex="-1"></a>times <span class="ot">&lt;-</span> Melanoma<span class="sc">$</span>time</span>
<span id="cb971-4"><a href="machine-learning.html#cb971-4" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(times<span class="sc">/</span><span class="dv">7</span>)  <span class="do">## weeks</span></span>
<span id="cb971-5"><a href="machine-learning.html#cb971-5" tabindex="-1"></a></span>
<span id="cb971-6"><a href="machine-learning.html#cb971-6" tabindex="-1"></a><span class="co">#1 died from melanoma, 2 alive, 3 dead from other causes.</span></span>
<span id="cb971-7"><a href="machine-learning.html#cb971-7" tabindex="-1"></a><span class="do">##delta: 0=censored, 1=dead</span></span>
<span id="cb971-8"><a href="machine-learning.html#cb971-8" tabindex="-1"></a>delta<span class="ot">=</span><span class="fu">ifelse</span>(Melanoma<span class="sc">$</span>status<span class="sc">==</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb971-9"><a href="machine-learning.html#cb971-9" tabindex="-1"></a></span>
<span id="cb971-10"><a href="machine-learning.html#cb971-10" tabindex="-1"></a><span class="do">## matrix of observed covariates</span></span>
<span id="cb971-11"><a href="machine-learning.html#cb971-11" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Melanoma<span class="sc">$</span>sex, Melanoma<span class="sc">$</span>age, Melanoma<span class="sc">$</span>thickness)</span>
<span id="cb971-12"><a href="machine-learning.html#cb971-12" tabindex="-1"></a></span>
<span id="cb971-13"><a href="machine-learning.html#cb971-13" tabindex="-1"></a><span class="fu">deepsurv</span>(<span class="at">data =</span> Melanoma, </span>
<span id="cb971-14"><a href="machine-learning.html#cb971-14" tabindex="-1"></a>    <span class="at">frac =</span> <span class="fl">0.3</span>, <span class="co">#Fraction of data to use for validation </span></span>
<span id="cb971-15"><a href="machine-learning.html#cb971-15" tabindex="-1"></a>    <span class="at">activation =</span> <span class="st">&quot;relu&quot;</span>,</span>
<span id="cb971-16"><a href="machine-learning.html#cb971-16" tabindex="-1"></a>    <span class="at">num_nodes =</span> <span class="fu">c</span>(4L, 8L, 4L, 2L), </span>
<span id="cb971-17"><a href="machine-learning.html#cb971-17" tabindex="-1"></a>    <span class="at">dropout =</span> <span class="fl">0.1</span>, </span>
<span id="cb971-18"><a href="machine-learning.html#cb971-18" tabindex="-1"></a>    <span class="at">early_stopping =</span> <span class="cn">TRUE</span>, </span>
<span id="cb971-19"><a href="machine-learning.html#cb971-19" tabindex="-1"></a>    <span class="at">epochs =</span> 100L, <span class="co">#number of epochs.</span></span>
<span id="cb971-20"><a href="machine-learning.html#cb971-20" tabindex="-1"></a>    <span class="at">batch_size =</span> 32L)</span></code></pre></div>
<pre><code>## 
##  DeepSurv Neural Network 
## 
## Call:
##   deepsurv(data = Melanoma, frac = 0.3, activation = &quot;relu&quot;, num_nodes = c(4L,      8L, 4L, 2L), dropout = 0.1, early_stopping = TRUE, batch_size = 32L,      epochs = 100L)
## 
## Response:
##   Surv(time, status)
## Features:
##   {sex, age, year, thickness, ulcer}</code></pre>
<p>Using the same Melanoma dataset, we illustrate <em>DeepHit</em>.</p>
<div class="sourceCode" id="cb973"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb973-1"><a href="machine-learning.html#cb973-1" tabindex="-1"></a>DH<span class="ot">&lt;-</span><span class="fu">deephit</span>(<span class="at">data =</span> Melanoma, </span>
<span id="cb973-2"><a href="machine-learning.html#cb973-2" tabindex="-1"></a>    <span class="at">frac =</span> <span class="fl">0.3</span>, <span class="co">#Fraction of data to use for validation </span></span>
<span id="cb973-3"><a href="machine-learning.html#cb973-3" tabindex="-1"></a>    <span class="at">activation =</span> <span class="st">&quot;relu&quot;</span>,</span>
<span id="cb973-4"><a href="machine-learning.html#cb973-4" tabindex="-1"></a>    <span class="at">num_nodes =</span> <span class="fu">c</span>(4L, 8L, 4L, 2L), </span>
<span id="cb973-5"><a href="machine-learning.html#cb973-5" tabindex="-1"></a>    <span class="at">dropout =</span> <span class="fl">0.1</span>, </span>
<span id="cb973-6"><a href="machine-learning.html#cb973-6" tabindex="-1"></a>    <span class="at">early_stopping =</span> <span class="cn">TRUE</span>, </span>
<span id="cb973-7"><a href="machine-learning.html#cb973-7" tabindex="-1"></a>    <span class="at">epochs =</span> 100L, <span class="co">#number of epochs.</span></span>
<span id="cb973-8"><a href="machine-learning.html#cb973-8" tabindex="-1"></a>    <span class="at">batch_size =</span> 32L)</span>
<span id="cb973-9"><a href="machine-learning.html#cb973-9" tabindex="-1"></a></span>
<span id="cb973-10"><a href="machine-learning.html#cb973-10" tabindex="-1"></a><span class="fu">summary</span>(DH)</span></code></pre></div>
<pre><code>## 
##  DeepHit Neural Network 
## 
## Call:
##   deephit(data = Melanoma, frac = 0.3, activation = &quot;relu&quot;, num_nodes = c(4L,      8L, 4L, 2L), dropout = 0.1, early_stopping = TRUE, batch_size = 32L,      epochs = 100L)
## 
## Response:
##   Surv(time, status)
## Features:
##   {sex, age, year, thickness, ulcer}</code></pre>
<div class="sourceCode" id="cb975"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb975-1"><a href="machine-learning.html#cb975-1" tabindex="-1"></a><span class="fu">library</span>(mlr3)</span></code></pre></div>
<pre><code>## Warning: package &#39;mlr3&#39; was built under R version 4.3.2</code></pre>
<pre><code>## 
## Attaching package: &#39;mlr3&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:R.utils&#39;:
## 
##     resample</code></pre>
<pre><code>## The following object is masked from &#39;package:signal&#39;:
## 
##     resample</code></pre>
<pre><code>## The following object is masked from &#39;package:raster&#39;:
## 
##     resample</code></pre>
<pre><code>## The following object is masked from &#39;package:terra&#39;:
## 
##     resample</code></pre>
<div class="sourceCode" id="cb982"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb982-1"><a href="machine-learning.html#cb982-1" tabindex="-1"></a><span class="fu">library</span>(mlr3proba)</span></code></pre></div>
<pre><code>## Warning: package &#39;mlr3proba&#39; was built under R version 4.3.2</code></pre>
<div class="sourceCode" id="cb984"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb984-1"><a href="machine-learning.html#cb984-1" tabindex="-1"></a><span class="fu">library</span>(mlr3extralearners)</span>
<span id="cb984-2"><a href="machine-learning.html#cb984-2" tabindex="-1"></a><span class="fu">library</span>(mlr3pipelines)</span></code></pre></div>
<pre><code>## Warning: package &#39;mlr3pipelines&#39; was built under R version 4.3.2</code></pre>
<pre><code>## 
## Attaching package: &#39;mlr3pipelines&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:bitops&#39;:
## 
##     %&gt;&gt;%</code></pre>
<pre><code>## The following object is masked from &#39;package:BiocGenerics&#39;:
## 
##     pos</code></pre>
<div class="sourceCode" id="cb989"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb989-1"><a href="machine-learning.html#cb989-1" tabindex="-1"></a><span class="fu">library</span>(mlr3tuning)</span></code></pre></div>
<pre><code>## Warning: package &#39;mlr3tuning&#39; was built under R version 4.3.2</code></pre>
<pre><code>## Loading required package: paradox</code></pre>
<pre><code>## 
## Attaching package: &#39;mlr3tuning&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:multiplex&#39;:
## 
##     ti</code></pre>
<pre><code>## The following object is masked from &#39;package:hardhat&#39;:
## 
##     tune</code></pre>
<pre><code>## The following object is masked from &#39;package:ModelMetrics&#39;:
## 
##     tnr</code></pre>
<pre><code>## The following object is masked from &#39;package:randomForestSRC&#39;:
## 
##     tune</code></pre>
<pre><code>## The following object is masked from &#39;package:mgcv&#39;:
## 
##     ti</code></pre>
<pre><code>## The following object is masked from &#39;package:e1071&#39;:
## 
##     tune</code></pre>
<div class="sourceCode" id="cb999"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb999-1"><a href="machine-learning.html#cb999-1" tabindex="-1"></a><span class="do">## get the `whas` task from mlr3proba</span></span>
<span id="cb999-2"><a href="machine-learning.html#cb999-2" tabindex="-1"></a>whas <span class="ot">&lt;-</span> <span class="fu">tsk</span>(<span class="st">&quot;whas&quot;</span>)</span>
<span id="cb999-3"><a href="machine-learning.html#cb999-3" tabindex="-1"></a></span>
<span id="cb999-4"><a href="machine-learning.html#cb999-4" tabindex="-1"></a><span class="do">## create our own task from the Melanoma dataset</span></span>
<span id="cb999-5"><a href="machine-learning.html#cb999-5" tabindex="-1"></a>Melanoma_data <span class="ot">&lt;-</span> MASS<span class="sc">::</span>Melanoma</span>
<span id="cb999-6"><a href="machine-learning.html#cb999-6" tabindex="-1"></a></span>
<span id="cb999-7"><a href="machine-learning.html#cb999-7" tabindex="-1"></a>Melanoma_data<span class="sc">$</span>status<span class="ot">=</span><span class="fu">ifelse</span>(Melanoma_data<span class="sc">$</span>status<span class="sc">==</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb999-8"><a href="machine-learning.html#cb999-8" tabindex="-1"></a></span>
<span id="cb999-9"><a href="machine-learning.html#cb999-9" tabindex="-1"></a><span class="do">## convert characters to factors</span></span>
<span id="cb999-10"><a href="machine-learning.html#cb999-10" tabindex="-1"></a>Melanoma_data<span class="sc">$</span>sex <span class="ot">&lt;-</span> <span class="fu">factor</span>(Melanoma_data<span class="sc">$</span>sex)</span>
<span id="cb999-11"><a href="machine-learning.html#cb999-11" tabindex="-1"></a>MelanomaTS <span class="ot">&lt;-</span> TaskSurv<span class="sc">$</span><span class="fu">new</span>(<span class="st">&quot;Melanoma&quot;</span>, Melanoma_data, <span class="at">time =</span> <span class="st">&quot;time&quot;</span>, <span class="at">event =</span> <span class="st">&quot;status&quot;</span>)</span>
<span id="cb999-12"><a href="machine-learning.html#cb999-12" tabindex="-1"></a></span>
<span id="cb999-13"><a href="machine-learning.html#cb999-13" tabindex="-1"></a></span>
<span id="cb999-14"><a href="machine-learning.html#cb999-14" tabindex="-1"></a><span class="co">#1 died from melanoma, 2 alive, 3 dead from other causes.</span></span>
<span id="cb999-15"><a href="machine-learning.html#cb999-15" tabindex="-1"></a><span class="do">##delta: 0=censored, 1=dead</span></span>
<span id="cb999-16"><a href="machine-learning.html#cb999-16" tabindex="-1"></a>delta<span class="ot">=</span><span class="fu">ifelse</span>(Melanoma_data<span class="sc">$</span>status<span class="sc">==</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb999-17"><a href="machine-learning.html#cb999-17" tabindex="-1"></a></span>
<span id="cb999-18"><a href="machine-learning.html#cb999-18" tabindex="-1"></a><span class="do">## matrix of observed covariates</span></span>
<span id="cb999-19"><a href="machine-learning.html#cb999-19" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Melanoma_data<span class="sc">$</span>sex, Melanoma_data<span class="sc">$</span>age, Melanoma_data<span class="sc">$</span>thickness)</span>
<span id="cb999-20"><a href="machine-learning.html#cb999-20" tabindex="-1"></a></span>
<span id="cb999-21"><a href="machine-learning.html#cb999-21" tabindex="-1"></a></span>
<span id="cb999-22"><a href="machine-learning.html#cb999-22" tabindex="-1"></a><span class="do">## combine in list</span></span>
<span id="cb999-23"><a href="machine-learning.html#cb999-23" tabindex="-1"></a>tasks <span class="ot">&lt;-</span> <span class="fu">list</span>(whas, MelanomaTS)</span>
<span id="cb999-24"><a href="machine-learning.html#cb999-24" tabindex="-1"></a></span>
<span id="cb999-25"><a href="machine-learning.html#cb999-25" tabindex="-1"></a><span class="fu">library</span>(paradox)</span>
<span id="cb999-26"><a href="machine-learning.html#cb999-26" tabindex="-1"></a></span>
<span id="cb999-27"><a href="machine-learning.html#cb999-27" tabindex="-1"></a>search_space <span class="ot">&lt;-</span> <span class="fu">ps</span>(</span>
<span id="cb999-28"><a href="machine-learning.html#cb999-28" tabindex="-1"></a> <span class="do">## p_dbl for numeric valued parameters</span></span>
<span id="cb999-29"><a href="machine-learning.html#cb999-29" tabindex="-1"></a> <span class="at">dropout =</span> <span class="fu">p_dbl</span>(<span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> <span class="dv">1</span>),</span>
<span id="cb999-30"><a href="machine-learning.html#cb999-30" tabindex="-1"></a> <span class="at">weight_decay =</span> <span class="fu">p_dbl</span>(<span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> <span class="fl">0.5</span>),</span>
<span id="cb999-31"><a href="machine-learning.html#cb999-31" tabindex="-1"></a> <span class="at">learning_rate =</span> <span class="fu">p_dbl</span>(<span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> <span class="dv">1</span>),</span>
<span id="cb999-32"><a href="machine-learning.html#cb999-32" tabindex="-1"></a> </span>
<span id="cb999-33"><a href="machine-learning.html#cb999-33" tabindex="-1"></a> <span class="do">## p_int for integer valued parameters</span></span>
<span id="cb999-34"><a href="machine-learning.html#cb999-34" tabindex="-1"></a> <span class="at">nodes =</span> <span class="fu">p_int</span>(<span class="at">lower =</span> <span class="dv">1</span>, <span class="at">upper =</span> <span class="dv">32</span>),</span>
<span id="cb999-35"><a href="machine-learning.html#cb999-35" tabindex="-1"></a> <span class="at">k =</span> <span class="fu">p_int</span>(<span class="at">lower =</span> <span class="dv">1</span>, <span class="at">upper =</span> <span class="dv">4</span>)</span>
<span id="cb999-36"><a href="machine-learning.html#cb999-36" tabindex="-1"></a>)</span>
<span id="cb999-37"><a href="machine-learning.html#cb999-37" tabindex="-1"></a></span>
<span id="cb999-38"><a href="machine-learning.html#cb999-38" tabindex="-1"></a>search_space<span class="sc">$</span>trafo <span class="ot">&lt;-</span> <span class="cf">function</span>(x, param_set) {</span>
<span id="cb999-39"><a href="machine-learning.html#cb999-39" tabindex="-1"></a> x<span class="sc">$</span>num_nodes <span class="ot">=</span> <span class="fu">rep</span>(x<span class="sc">$</span>nodes, x<span class="sc">$</span>k)</span>
<span id="cb999-40"><a href="machine-learning.html#cb999-40" tabindex="-1"></a> x<span class="sc">$</span>nodes <span class="ot">=</span> x<span class="sc">$</span>k <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb999-41"><a href="machine-learning.html#cb999-41" tabindex="-1"></a> <span class="fu">return</span>(x)</span>
<span id="cb999-42"><a href="machine-learning.html#cb999-42" tabindex="-1"></a>}</span>
<span id="cb999-43"><a href="machine-learning.html#cb999-43" tabindex="-1"></a></span>
<span id="cb999-44"><a href="machine-learning.html#cb999-44" tabindex="-1"></a></span>
<span id="cb999-45"><a href="machine-learning.html#cb999-45" tabindex="-1"></a>create_autotuner <span class="ot">&lt;-</span> <span class="cf">function</span>(learner) {</span>
<span id="cb999-46"><a href="machine-learning.html#cb999-46" tabindex="-1"></a> AutoTuner<span class="sc">$</span><span class="fu">new</span>(</span>
<span id="cb999-47"><a href="machine-learning.html#cb999-47" tabindex="-1"></a>   <span class="at">learner =</span> learner,</span>
<span id="cb999-48"><a href="machine-learning.html#cb999-48" tabindex="-1"></a>   <span class="at">search_space =</span> search_space,</span>
<span id="cb999-49"><a href="machine-learning.html#cb999-49" tabindex="-1"></a>   <span class="at">resampling =</span> <span class="fu">rsmp</span>(<span class="st">&quot;holdout&quot;</span>),</span>
<span id="cb999-50"><a href="machine-learning.html#cb999-50" tabindex="-1"></a>   <span class="at">measure =</span> <span class="fu">msr</span>(<span class="st">&quot;surv.cindex&quot;</span>),</span>
<span id="cb999-51"><a href="machine-learning.html#cb999-51" tabindex="-1"></a>   <span class="at">terminator =</span> <span class="fu">trm</span>(<span class="st">&quot;evals&quot;</span>, <span class="at">n_evals =</span> <span class="dv">2</span>),</span>
<span id="cb999-52"><a href="machine-learning.html#cb999-52" tabindex="-1"></a>   <span class="at">tuner =</span> <span class="fu">tnr</span>(<span class="st">&quot;random_search&quot;</span>)</span>
<span id="cb999-53"><a href="machine-learning.html#cb999-53" tabindex="-1"></a> )</span>
<span id="cb999-54"><a href="machine-learning.html#cb999-54" tabindex="-1"></a>}</span>
<span id="cb999-55"><a href="machine-learning.html#cb999-55" tabindex="-1"></a></span>
<span id="cb999-56"><a href="machine-learning.html#cb999-56" tabindex="-1"></a><span class="do">## load learners</span></span>
<span id="cb999-57"><a href="machine-learning.html#cb999-57" tabindex="-1"></a>learners <span class="ot">&lt;-</span> <span class="fu">lrns</span>(</span>
<span id="cb999-58"><a href="machine-learning.html#cb999-58" tabindex="-1"></a> <span class="co">#paste0(&quot;surv.&quot;, c(&quot;deephit&quot;, &quot;deepsurv&quot;)), #crash when running multiple learners</span></span>
<span id="cb999-59"><a href="machine-learning.html#cb999-59" tabindex="-1"></a> <span class="fu">paste0</span>(<span class="st">&quot;surv.&quot;</span>, <span class="fu">c</span>( <span class="st">&quot;deepsurv&quot;</span>)),</span>
<span id="cb999-60"><a href="machine-learning.html#cb999-60" tabindex="-1"></a> <span class="at">frac =</span> <span class="fl">0.3</span>, <span class="at">early_stopping =</span> <span class="cn">TRUE</span>, <span class="at">epochs =</span> <span class="dv">10</span>, <span class="at">optimizer =</span> <span class="st">&quot;adam&quot;</span></span>
<span id="cb999-61"><a href="machine-learning.html#cb999-61" tabindex="-1"></a>)</span>
<span id="cb999-62"><a href="machine-learning.html#cb999-62" tabindex="-1"></a> </span>
<span id="cb999-63"><a href="machine-learning.html#cb999-63" tabindex="-1"></a><span class="co"># apply our function</span></span>
<span id="cb999-64"><a href="machine-learning.html#cb999-64" tabindex="-1"></a>learners <span class="ot">&lt;-</span> <span class="fu">lapply</span>(learners, create_autotuner)</span>
<span id="cb999-65"><a href="machine-learning.html#cb999-65" tabindex="-1"></a></span>
<span id="cb999-66"><a href="machine-learning.html#cb999-66" tabindex="-1"></a></span>
<span id="cb999-67"><a href="machine-learning.html#cb999-67" tabindex="-1"></a>create_pipeops <span class="ot">&lt;-</span> <span class="cf">function</span>(learner) {</span>
<span id="cb999-68"><a href="machine-learning.html#cb999-68" tabindex="-1"></a> <span class="fu">po</span>(<span class="st">&quot;encode&quot;</span>) <span class="sc">%&gt;&gt;%</span> <span class="fu">po</span>(<span class="st">&quot;scale&quot;</span>) <span class="sc">%&gt;&gt;%</span> <span class="fu">po</span>(<span class="st">&quot;learner&quot;</span>, learner)</span>
<span id="cb999-69"><a href="machine-learning.html#cb999-69" tabindex="-1"></a>}</span>
<span id="cb999-70"><a href="machine-learning.html#cb999-70" tabindex="-1"></a></span>
<span id="cb999-71"><a href="machine-learning.html#cb999-71" tabindex="-1"></a><span class="do">## apply our function</span></span>
<span id="cb999-72"><a href="machine-learning.html#cb999-72" tabindex="-1"></a>learners <span class="ot">&lt;-</span> <span class="fu">lapply</span>(learners, create_pipeops)</span>
<span id="cb999-73"><a href="machine-learning.html#cb999-73" tabindex="-1"></a></span>
<span id="cb999-74"><a href="machine-learning.html#cb999-74" tabindex="-1"></a><span class="do">## select holdout as the resampling strategy</span></span>
<span id="cb999-75"><a href="machine-learning.html#cb999-75" tabindex="-1"></a>resampling <span class="ot">&lt;-</span> <span class="fu">rsmp</span>(<span class="st">&quot;cv&quot;</span>, <span class="at">folds =</span> <span class="dv">2</span>)</span>
<span id="cb999-76"><a href="machine-learning.html#cb999-76" tabindex="-1"></a></span>
<span id="cb999-77"><a href="machine-learning.html#cb999-77" tabindex="-1"></a><span class="do">## add KM and CPH</span></span>
<span id="cb999-78"><a href="machine-learning.html#cb999-78" tabindex="-1"></a>learners <span class="ot">&lt;-</span> <span class="fu">c</span>(learners, <span class="fu">lrns</span>(<span class="fu">c</span>(<span class="st">&quot;surv.kaplan&quot;</span>, <span class="st">&quot;surv.coxph&quot;</span>)))</span>
<span id="cb999-79"><a href="machine-learning.html#cb999-79" tabindex="-1"></a><span class="co">#learners &lt;- c(learners, lrns(c(&quot;surv.coxph&quot;)))</span></span>
<span id="cb999-80"><a href="machine-learning.html#cb999-80" tabindex="-1"></a>design <span class="ot">&lt;-</span> <span class="fu">benchmark_grid</span>(tasks, learners, resampling)</span>
<span id="cb999-81"><a href="machine-learning.html#cb999-81" tabindex="-1"></a>bm <span class="ot">&lt;-</span> <span class="fu">benchmark</span>(design)</span></code></pre></div>
<pre><code>## INFO  [22:45:30.466] [mlr3] Running benchmark with 12 resampling iterations
## INFO  [22:45:30.536] [mlr3] Applying learner &#39;encode.scale.surv.deepsurv.tuned&#39; on task &#39;whas&#39; (iter 1/2)
## INFO  [22:45:30.956] [bbotk] Starting to optimize 5 parameter(s) with &#39;&lt;OptimizerRandomSearch&gt;&#39; and &#39;&lt;TerminatorEvals&gt; [n_evals=2, k=0]&#39;
## INFO  [22:45:31.023] [bbotk] Evaluating 1 configuration(s)
## INFO  [22:45:31.065] [mlr3] Running benchmark with 1 resampling iterations
## INFO  [22:45:31.083] [mlr3] Applying learner &#39;surv.deepsurv&#39; on task &#39;whas&#39; (iter 1/1)
## INFO  [22:45:31.306] [mlr3] Finished benchmark
## INFO  [22:45:31.407] [bbotk] Result of batch 1:
## INFO  [22:45:31.411] [bbotk]    dropout weight_decay learning_rate nodes k surv.cindex warnings errors
## INFO  [22:45:31.411] [bbotk]  0.6247406    0.4554209     0.8456182    11 3   0.6066725        0      0
## INFO  [22:45:31.411] [bbotk]  runtime_learners                                uhash
## INFO  [22:45:31.411] [bbotk]              0.23 3ea7cab2-7ba1-4d11-a121-f97867a32362
## INFO  [22:45:31.426] [bbotk] Evaluating 1 configuration(s)
## INFO  [22:45:31.487] [mlr3] Running benchmark with 1 resampling iterations
## INFO  [22:45:31.505] [mlr3] Applying learner &#39;surv.deepsurv&#39; on task &#39;whas&#39; (iter 1/1)
## INFO  [22:45:31.682] [mlr3] Finished benchmark
## INFO  [22:45:31.769] [bbotk] Result of batch 2:
## INFO  [22:45:31.773] [bbotk]    dropout weight_decay learning_rate nodes k surv.cindex warnings errors
## INFO  [22:45:31.773] [bbotk]  0.1573471    0.4268247     0.6872897    27 1   0.6738367        0      0
## INFO  [22:45:31.773] [bbotk]  runtime_learners                                uhash
## INFO  [22:45:31.773] [bbotk]              0.18 14ba6949-ab43-4e4b-9b15-dcadc5181700
## INFO  [22:45:31.798] [bbotk] Finished optimizing after 2 evaluation(s)
## INFO  [22:45:31.800] [bbotk] Result:
## INFO  [22:45:31.803] [bbotk]    dropout weight_decay learning_rate nodes k learner_param_vals  x_domain
## INFO  [22:45:31.803] [bbotk]  0.1573471    0.4268247     0.6872897    27 1          &lt;list[8]&gt; &lt;list[4]&gt;
## INFO  [22:45:31.803] [bbotk]  surv.cindex
## INFO  [22:45:31.803] [bbotk]    0.6738367
## INFO  [22:45:32.334] [mlr3] Applying learner &#39;encode.scale.surv.deepsurv.tuned&#39; on task &#39;whas&#39; (iter 2/2)
## INFO  [22:45:32.686] [bbotk] Starting to optimize 5 parameter(s) with &#39;&lt;OptimizerRandomSearch&gt;&#39; and &#39;&lt;TerminatorEvals&gt; [n_evals=2, k=0]&#39;
## INFO  [22:45:32.738] [bbotk] Evaluating 1 configuration(s)
## INFO  [22:45:32.776] [mlr3] Running benchmark with 1 resampling iterations
## INFO  [22:45:32.793] [mlr3] Applying learner &#39;surv.deepsurv&#39; on task &#39;whas&#39; (iter 1/1)
## INFO  [22:45:33.788] [mlr3] Finished benchmark
## INFO  [22:45:33.891] [bbotk] Result of batch 1:
## INFO  [22:45:33.897] [bbotk]    dropout weight_decay learning_rate nodes k surv.cindex warnings errors
## INFO  [22:45:33.897] [bbotk]  0.9949267    0.2285935     0.8684118    17 4    0.627995        0      0
## INFO  [22:45:33.897] [bbotk]  runtime_learners                                uhash
## INFO  [22:45:33.897] [bbotk]              0.97 ee7d69c6-a523-42b5-87bf-cc74c6e3050a
## INFO  [22:45:33.919] [bbotk] Evaluating 1 configuration(s)
## INFO  [22:45:33.969] [mlr3] Running benchmark with 1 resampling iterations
## INFO  [22:45:33.992] [mlr3] Applying learner &#39;surv.deepsurv&#39; on task &#39;whas&#39; (iter 1/1)
## INFO  [22:45:34.222] [mlr3] Finished benchmark
## INFO  [22:45:34.338] [bbotk] Result of batch 2:
## INFO  [22:45:34.343] [bbotk]    dropout weight_decay learning_rate nodes k surv.cindex warnings errors
## INFO  [22:45:34.343] [bbotk]  0.8363856    0.2299571     0.9908099    13 2   0.4897016        0      0
## INFO  [22:45:34.343] [bbotk]  runtime_learners                                uhash
## INFO  [22:45:34.343] [bbotk]               0.2 969eb2e1-87b3-4270-9687-2b42b2221661
## INFO  [22:45:34.370] [bbotk] Finished optimizing after 2 evaluation(s)
## INFO  [22:45:34.371] [bbotk] Result:
## INFO  [22:45:34.373] [bbotk]    dropout weight_decay learning_rate nodes k learner_param_vals  x_domain
## INFO  [22:45:34.373] [bbotk]  0.9949267    0.2285935     0.8684118    17 4          &lt;list[8]&gt; &lt;list[4]&gt;
## INFO  [22:45:34.373] [bbotk]  surv.cindex
## INFO  [22:45:34.373] [bbotk]     0.627995
## INFO  [22:45:34.908] [mlr3] Applying learner &#39;surv.kaplan&#39; on task &#39;whas&#39; (iter 1/2)
## INFO  [22:45:34.973] [mlr3] Applying learner &#39;surv.kaplan&#39; on task &#39;whas&#39; (iter 2/2)
## INFO  [22:45:35.026] [mlr3] Applying learner &#39;surv.coxph&#39; on task &#39;whas&#39; (iter 1/2)
## INFO  [22:45:35.129] [mlr3] Applying learner &#39;surv.coxph&#39; on task &#39;whas&#39; (iter 2/2)
## INFO  [22:45:35.202] [mlr3] Applying learner &#39;encode.scale.surv.deepsurv.tuned&#39; on task &#39;Melanoma&#39; (iter 1/2)
## INFO  [22:45:35.582] [bbotk] Starting to optimize 5 parameter(s) with &#39;&lt;OptimizerRandomSearch&gt;&#39; and &#39;&lt;TerminatorEvals&gt; [n_evals=2, k=0]&#39;
## INFO  [22:45:35.635] [bbotk] Evaluating 1 configuration(s)
## INFO  [22:45:35.675] [mlr3] Running benchmark with 1 resampling iterations
## INFO  [22:45:35.692] [mlr3] Applying learner &#39;surv.deepsurv&#39; on task &#39;Melanoma&#39; (iter 1/1)
## INFO  [22:45:35.842] [mlr3] Finished benchmark
## INFO  [22:45:35.921] [bbotk] Result of batch 1:
## INFO  [22:45:35.925] [bbotk]    dropout weight_decay learning_rate nodes k surv.cindex warnings errors
## INFO  [22:45:35.925] [bbotk]  0.4570555    0.2741379     0.8601232    20 1   0.7703704        0      0
## INFO  [22:45:35.925] [bbotk]  runtime_learners                                uhash
## INFO  [22:45:35.925] [bbotk]              0.13 29542f3a-2e87-4685-a5dc-4846d9dc658f
## INFO  [22:45:35.941] [bbotk] Evaluating 1 configuration(s)
## INFO  [22:45:35.979] [mlr3] Running benchmark with 1 resampling iterations
## INFO  [22:45:35.997] [mlr3] Applying learner &#39;surv.deepsurv&#39; on task &#39;Melanoma&#39; (iter 1/1)
## INFO  [22:45:36.154] [mlr3] Finished benchmark
## INFO  [22:45:36.245] [bbotk] Result of batch 2:
## INFO  [22:45:36.249] [bbotk]    dropout weight_decay learning_rate nodes k surv.cindex warnings errors
## INFO  [22:45:36.249] [bbotk]  0.7608218     0.479834     0.7939875    20 3   0.6814815        0      0
## INFO  [22:45:36.249] [bbotk]  runtime_learners                                uhash
## INFO  [22:45:36.249] [bbotk]              0.13 9e732a8a-5c8e-4dae-b5fe-6d2e69c8b9b7
## INFO  [22:45:36.272] [bbotk] Finished optimizing after 2 evaluation(s)
## INFO  [22:45:36.274] [bbotk] Result:
## INFO  [22:45:36.276] [bbotk]    dropout weight_decay learning_rate nodes k learner_param_vals  x_domain
## INFO  [22:45:36.276] [bbotk]  0.4570555    0.2741379     0.8601232    20 1          &lt;list[8]&gt; &lt;list[4]&gt;
## INFO  [22:45:36.276] [bbotk]  surv.cindex
## INFO  [22:45:36.276] [bbotk]    0.7703704
## INFO  [22:45:36.749] [mlr3] Applying learner &#39;encode.scale.surv.deepsurv.tuned&#39; on task &#39;Melanoma&#39; (iter 2/2)
## INFO  [22:45:37.111] [bbotk] Starting to optimize 5 parameter(s) with &#39;&lt;OptimizerRandomSearch&gt;&#39; and &#39;&lt;TerminatorEvals&gt; [n_evals=2, k=0]&#39;
## INFO  [22:45:37.165] [bbotk] Evaluating 1 configuration(s)
## INFO  [22:45:37.205] [mlr3] Running benchmark with 1 resampling iterations
## INFO  [22:45:37.223] [mlr3] Applying learner &#39;surv.deepsurv&#39; on task &#39;Melanoma&#39; (iter 1/1)
## INFO  [22:45:37.391] [mlr3] Finished benchmark
## INFO  [22:45:37.470] [bbotk] Result of batch 1:
## INFO  [22:45:37.474] [bbotk]    dropout weight_decay learning_rate nodes k surv.cindex warnings errors
## INFO  [22:45:37.474] [bbotk]  0.1140623    0.2846605       0.22349    10 4   0.6612903        0      0
## INFO  [22:45:37.474] [bbotk]  runtime_learners                                uhash
## INFO  [22:45:37.474] [bbotk]              0.16 690f0fef-632b-4560-b9f3-158d3d2c0f43
## INFO  [22:45:37.490] [bbotk] Evaluating 1 configuration(s)
## INFO  [22:45:37.528] [mlr3] Running benchmark with 1 resampling iterations
## INFO  [22:45:37.547] [mlr3] Applying learner &#39;surv.deepsurv&#39; on task &#39;Melanoma&#39; (iter 1/1)
## INFO  [22:45:37.857] [mlr3] Finished benchmark
## INFO  [22:45:37.947] [bbotk] Result of batch 2:
## INFO  [22:45:37.950] [bbotk]    dropout weight_decay learning_rate nodes k surv.cindex warnings errors
## INFO  [22:45:37.950] [bbotk]  0.2337101    0.3132217     0.5829765     8 3   0.4903226        0      0
## INFO  [22:45:37.950] [bbotk]  runtime_learners                                uhash
## INFO  [22:45:37.950] [bbotk]               0.3 bb3cb79c-2903-4a94-bf60-5e3b21585b9d
## INFO  [22:45:37.973] [bbotk] Finished optimizing after 2 evaluation(s)
## INFO  [22:45:37.974] [bbotk] Result:
## INFO  [22:45:37.977] [bbotk]    dropout weight_decay learning_rate nodes k learner_param_vals  x_domain
## INFO  [22:45:37.977] [bbotk]  0.1140623    0.2846605       0.22349    10 4          &lt;list[8]&gt; &lt;list[4]&gt;
## INFO  [22:45:37.977] [bbotk]  surv.cindex
## INFO  [22:45:37.977] [bbotk]    0.6612903
## INFO  [22:45:38.450] [mlr3] Applying learner &#39;surv.kaplan&#39; on task &#39;Melanoma&#39; (iter 1/2)
## INFO  [22:45:38.491] [mlr3] Applying learner &#39;surv.kaplan&#39; on task &#39;Melanoma&#39; (iter 2/2)
## INFO  [22:45:38.532] [mlr3] Applying learner &#39;surv.coxph&#39; on task &#39;Melanoma&#39; (iter 1/2)
## INFO  [22:45:38.583] [mlr3] Applying learner &#39;surv.coxph&#39; on task &#39;Melanoma&#39; (iter 2/2)
## INFO  [22:45:38.634] [mlr3] Finished benchmark</code></pre>
<div class="sourceCode" id="cb1001"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1001-1"><a href="machine-learning.html#cb1001-1" tabindex="-1"></a><span class="do">## Aggreggate with Harrell&#39;s C and Integrated Graf Score</span></span>
<span id="cb1001-2"><a href="machine-learning.html#cb1001-2" tabindex="-1"></a>msrs <span class="ot">&lt;-</span> <span class="fu">msrs</span>(<span class="fu">c</span>(<span class="st">&quot;surv.cindex&quot;</span>, <span class="st">&quot;surv.graf&quot;</span>))</span>
<span id="cb1001-3"><a href="machine-learning.html#cb1001-3" tabindex="-1"></a>bm<span class="sc">$</span><span class="fu">aggregate</span>(msrs)[, <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">8</span>)]</span></code></pre></div>
<pre><code>##     task_id                       learner_id surv.cindex surv.graf
## 1:     whas encode.scale.surv.deepsurv.tuned   0.6280322       Inf
## 2:     whas                      surv.kaplan   0.5000000       Inf
## 3:     whas                       surv.coxph   0.7502472       Inf
## 4: Melanoma encode.scale.surv.deepsurv.tuned   0.6223551       Inf
## 5: Melanoma                      surv.kaplan   0.5000000       Inf
## 6: Melanoma                       surv.coxph   0.7383489       Inf</code></pre>
<div class="sourceCode" id="cb1003"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1003-1"><a href="machine-learning.html#cb1003-1" tabindex="-1"></a><span class="fu">library</span>(mlr3benchmark)</span></code></pre></div>
<pre><code>## Warning: package &#39;mlr3benchmark&#39; was built under R version 4.3.2</code></pre>
<pre><code>## 
## Attaching package: &#39;mlr3benchmark&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:survivalmodels&#39;:
## 
##     requireNamespaces</code></pre>
<div class="sourceCode" id="cb1007"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1007-1"><a href="machine-learning.html#cb1007-1" tabindex="-1"></a><span class="do">## create mlr3benchmark object</span></span>
<span id="cb1007-2"><a href="machine-learning.html#cb1007-2" tabindex="-1"></a>bma <span class="ot">&lt;-</span> <span class="fu">as.BenchmarkAggr</span>(bm)</span></code></pre></div>
<pre><code>## Warning: &#39;as.BenchmarkAggr&#39; is deprecated.
## Use &#39;as_benchmark_aggr&#39; instead.
## See help(&quot;Deprecated&quot;)</code></pre>
<div class="sourceCode" id="cb1009"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1009-1"><a href="machine-learning.html#cb1009-1" tabindex="-1"></a><span class="do">## run global Friedman test</span></span>
<span id="cb1009-2"><a href="machine-learning.html#cb1009-2" tabindex="-1"></a>bma<span class="sc">$</span><span class="fu">friedman_test</span>()</span></code></pre></div>
<pre><code>## 
##  Friedman rank sum test
## 
## data:  cindex and learner_id and task_id
## Friedman chi-squared = 4, df = 2, p-value = 0.1353</code></pre>
</div>
</div>
<div id="tabnet" class="section level3 hasAnchor" number="6.9.2">
<h3><span class="header-section-number">6.9.2</span> Tabnet<a href="machine-learning.html#tabnet" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="cnn" class="section level3 hasAnchor" number="6.9.3">
<h3><span class="header-section-number">6.9.3</span> CNN<a href="machine-learning.html#cnn" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Convolution neural network or CNN is an artifical neural network method that is well suited to classification of image data. CNN is able to develop an internal representation of the image.</p>
</div>
<div id="rnn" class="section level3 hasAnchor" number="6.9.4">
<h3><span class="header-section-number">6.9.4</span> RNN<a href="machine-learning.html#rnn" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Recurrent neural network or RNN is an artifical neural network method that is
well suited to data with repeated patterns such as natural language processing. However, this architecture is less suited for tabular or imaging data.</p>
</div>
<div id="reinforcement-learning" class="section level3 hasAnchor" number="6.9.5">
<h3><span class="header-section-number">6.9.5</span> Reinforcement learning<a href="machine-learning.html#reinforcement-learning" class="anchor-section" aria-label="Anchor link to header"></a></h3>

</div>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-10.21105/joss.00786" class="csl-entry">
Molnar, Christoph, Bernd Bischl, and Giuseppe Casalicchio. 2018. <span>“Iml: An r Package for Interpretable Machine Learning.”</span> <em>JOSS</em> 3 (26): 786. <a href="https://doi.org/10.21105/joss.00786">https://doi.org/10.21105/joss.00786</a>.
</div>
<div id="ref-pmid29559951" class="csl-entry">
Phan, T. G., J. Chen, S. Singhal, H. Ma, B. B. Clissold, J. Ly, and R. Beare. 2018. <span>“<span class="nocase"><span>E</span>xploratory <span>U</span>se of <span>D</span>ecision <span>T</span>ree <span>A</span>nalysis in <span>C</span>lassification of <span>O</span>utcome in <span>H</span>ypoxic-<span>I</span>schemic <span>B</span>rain <span>I</span>njury</span>.”</span> <em>Front Neurol</em> 9: 126.
</div>
<div id="ref-pmid30761063" class="csl-entry">
Phan, T. G., T. Kooblal, C. Matley, S. Singhal, B. Clissold, J. Ly, A. G. Thrift, V. Srikanth, and H. Ma. 2019. <span>“<span class="nocase"><span>S</span>troke <span>S</span>everity <span>V</span>ersus <span>D</span>ysphagia <span>S</span>creen as <span>D</span>river for <span>P</span>ost-stroke <span>P</span>neumonia</span>.”</span> <em>Front Neurol</em> 10: 16.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multivariate-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="machine-learning-part-2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/05-machinelearning.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Applications-of-R-in-Healthcare.pdf", "Applications-of-R-in-Healthcare.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
