<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Machine learning | Applications of R in Healthcare</title>
  <meta name="description" content="This is a book describing the use of R in Healthcare. It is aimed at beginners of R language. The majority of the examples are taken from works in Neurology. Where possible data from other disease such as heart disease, cancer and vaccine are used. The ideas and principles can be applied to other aspects of Healthcare. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Machine learning | Applications of R in Healthcare" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a book describing the use of R in Healthcare. It is aimed at beginners of R language. The majority of the examples are taken from works in Neurology. Where possible data from other disease such as heart disease, cancer and vaccine are used. The ideas and principles can be applied to other aspects of Healthcare. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="GNtem2/HealthcareRbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Machine learning | Applications of R in Healthcare" />
  
  <meta name="twitter:description" content="This is a book describing the use of R in Healthcare. It is aimed at beginners of R language. The majority of the examples are taken from works in Neurology. Where possible data from other disease such as heart disease, cancer and vaccine are used. The ideas and principles can be applied to other aspects of Healthcare. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Thanh Phan" />


<meta name="date" content="2023-05-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multivariate-analysis.html"/>
<link rel="next" href="machine-learning-part-2.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>
<script src="libs/plotly-binding-4.9.2.2/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applications-of-R-in-Healthcare</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preamble</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#plot-using-base-r"><i class="fa fa-check"></i><b>2.1</b> Plot using base R</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#ggplot2"><i class="fa fa-check"></i><b>2.2</b> ggplot2</a><ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#histogram"><i class="fa fa-check"></i><b>2.2.1</b> Histogram</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#bar-plot"><i class="fa fa-check"></i><b>2.2.2</b> Bar plot</a></li>
<li class="chapter" data-level="2.2.3" data-path="intro.html"><a href="intro.html#pie-chart"><i class="fa fa-check"></i><b>2.2.3</b> Pie chart</a></li>
<li class="chapter" data-level="2.2.4" data-path="intro.html"><a href="intro.html#scatter-plot"><i class="fa fa-check"></i><b>2.2.4</b> Scatter plot</a></li>
<li class="chapter" data-level="2.2.5" data-path="intro.html"><a href="intro.html#arrange-plot-in-grids"><i class="fa fa-check"></i><b>2.2.5</b> arrange plot in grids</a></li>
<li class="chapter" data-level="2.2.6" data-path="intro.html"><a href="intro.html#line-plot"><i class="fa fa-check"></i><b>2.2.6</b> Line plot</a></li>
<li class="chapter" data-level="2.2.7" data-path="intro.html"><a href="intro.html#facet-wrap"><i class="fa fa-check"></i><b>2.2.7</b> Facet wrap</a></li>
<li class="chapter" data-level="2.2.8" data-path="intro.html"><a href="intro.html#polygons"><i class="fa fa-check"></i><b>2.2.8</b> Polygons</a></li>
<li class="chapter" data-level="2.2.9" data-path="intro.html"><a href="intro.html#gantt-chart"><i class="fa fa-check"></i><b>2.2.9</b> Gantt chart</a></li>
<li class="chapter" data-level="2.2.10" data-path="intro.html"><a href="intro.html#heatmap"><i class="fa fa-check"></i><b>2.2.10</b> Heatmap</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#ggplot2-extra"><i class="fa fa-check"></i><b>2.3</b> ggplot2 extra</a><ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#alluvial-and-sankey-diagram"><i class="fa fa-check"></i><b>2.3.1</b> Alluvial and Sankey diagram</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro.html"><a href="intro.html#survival-plot"><i class="fa fa-check"></i><b>2.3.2</b> Survival plot</a></li>
<li class="chapter" data-level="2.3.3" data-path="intro.html"><a href="intro.html#ggraph-and-tidygraph"><i class="fa fa-check"></i><b>2.3.3</b> ggraph and tidygraph</a></li>
<li class="chapter" data-level="2.3.4" data-path="intro.html"><a href="intro.html#ggparty-decision-tree"><i class="fa fa-check"></i><b>2.3.4</b> ggparty-decision tree</a></li>
<li class="chapter" data-level="2.3.5" data-path="intro.html"><a href="intro.html#ggroc--roc-curve"><i class="fa fa-check"></i><b>2.3.5</b> ggROC- ROC curve</a></li>
<li class="chapter" data-level="2.3.6" data-path="intro.html"><a href="intro.html#map"><i class="fa fa-check"></i><b>2.3.6</b> Map</a></li>
<li class="chapter" data-level="2.3.7" data-path="intro.html"><a href="intro.html#ggwordcloud"><i class="fa fa-check"></i><b>2.3.7</b> ggwordcloud</a></li>
<li class="chapter" data-level="2.3.8" data-path="intro.html"><a href="intro.html#gganimate"><i class="fa fa-check"></i><b>2.3.8</b> gganimate</a></li>
<li class="chapter" data-level="2.3.9" data-path="intro.html"><a href="intro.html#ggneuro"><i class="fa fa-check"></i><b>2.3.9</b> ggneuro</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#plotly"><i class="fa fa-check"></i><b>2.4</b> plotly</a><ul>
<li class="chapter" data-level="2.4.1" data-path="intro.html"><a href="intro.html#scatter-plot-1"><i class="fa fa-check"></i><b>2.4.1</b> Scatter plot</a></li>
<li class="chapter" data-level="2.4.2" data-path="intro.html"><a href="intro.html#bar-plot-1"><i class="fa fa-check"></i><b>2.4.2</b> Bar plot</a></li>
<li class="chapter" data-level="2.4.3" data-path="intro.html"><a href="intro.html#heatmap-1"><i class="fa fa-check"></i><b>2.4.3</b> Heatmap</a></li>
<li class="chapter" data-level="2.4.4" data-path="intro.html"><a href="intro.html#map-1"><i class="fa fa-check"></i><b>2.4.4</b> map</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>3</b> Data Wrangling</a><ul>
<li class="chapter" data-level="3.1" data-path="data-wrangling.html"><a href="data-wrangling.html#data"><i class="fa fa-check"></i><b>3.1</b> Data</a><ul>
<li class="chapter" data-level="3.1.1" data-path="data-wrangling.html"><a href="data-wrangling.html#vector-arrays-matrix"><i class="fa fa-check"></i><b>3.1.1</b> Vector, Arrays, Matrix</a></li>
<li class="chapter" data-level="3.1.2" data-path="data-wrangling.html"><a href="data-wrangling.html#apply-lapply-sapply"><i class="fa fa-check"></i><b>3.1.2</b> apply, lapply, sapply</a></li>
<li class="chapter" data-level="3.1.3" data-path="data-wrangling.html"><a href="data-wrangling.html#simple-function"><i class="fa fa-check"></i><b>3.1.3</b> Simple function</a></li>
<li class="chapter" data-level="3.1.4" data-path="data-wrangling.html"><a href="data-wrangling.html#for-loop"><i class="fa fa-check"></i><b>3.1.4</b> for loop</a></li>
<li class="chapter" data-level="3.1.5" data-path="data-wrangling.html"><a href="data-wrangling.html#functional"><i class="fa fa-check"></i><b>3.1.5</b> Functional</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-wrangling.html"><a href="data-wrangling.html#data-storage"><i class="fa fa-check"></i><b>3.2</b> Data storage</a><ul>
<li class="chapter" data-level="3.2.1" data-path="data-wrangling.html"><a href="data-wrangling.html#data-frame"><i class="fa fa-check"></i><b>3.2.1</b> Data frame</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-wrangling.html"><a href="data-wrangling.html#excel-data"><i class="fa fa-check"></i><b>3.2.2</b> Excel data</a></li>
<li class="chapter" data-level="3.2.3" data-path="data-wrangling.html"><a href="data-wrangling.html#foreign-data"><i class="fa fa-check"></i><b>3.2.3</b> Foreign data</a></li>
<li class="chapter" data-level="3.2.4" data-path="data-wrangling.html"><a href="data-wrangling.html#json-format"><i class="fa fa-check"></i><b>3.2.4</b> json format</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-wrangling.html"><a href="data-wrangling.html#tidy-data"><i class="fa fa-check"></i><b>3.3</b> Tidy data</a><ul>
<li class="chapter" data-level="3.3.1" data-path="data-wrangling.html"><a href="data-wrangling.html#factors"><i class="fa fa-check"></i><b>3.3.1</b> Factors</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-wrangling.html"><a href="data-wrangling.html#multiple-files"><i class="fa fa-check"></i><b>3.3.2</b> Multiple files</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-wrangling.html"><a href="data-wrangling.html#pivot"><i class="fa fa-check"></i><b>3.3.3</b> Pivot</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-wrangling.html"><a href="data-wrangling.html#regular-expressions"><i class="fa fa-check"></i><b>3.4</b> Regular Expressions</a><ul>
<li class="chapter" data-level="3.4.1" data-path="data-wrangling.html"><a href="data-wrangling.html#base-r"><i class="fa fa-check"></i><b>3.4.1</b> base R</a></li>
<li class="chapter" data-level="3.4.2" data-path="data-wrangling.html"><a href="data-wrangling.html#stringr"><i class="fa fa-check"></i><b>3.4.2</b> stringr</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="data-wrangling.html"><a href="data-wrangling.html#pdf-to-xcel"><i class="fa fa-check"></i><b>3.5</b> PDF to xcel</a><ul>
<li class="chapter" data-level="3.5.1" data-path="data-wrangling.html"><a href="data-wrangling.html#scanned-text-or-picture"><i class="fa fa-check"></i><b>3.5.1</b> Scanned text or picture</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="data-wrangling.html"><a href="data-wrangling.html#web-scraping"><i class="fa fa-check"></i><b>3.6</b> Web scraping</a></li>
<li class="chapter" data-level="3.7" data-path="data-wrangling.html"><a href="data-wrangling.html#manipulating-medical-images"><i class="fa fa-check"></i><b>3.7</b> Manipulating Medical Images</a><ul>
<li class="chapter" data-level="3.7.1" data-path="data-wrangling.html"><a href="data-wrangling.html#dicom-and-nifti-format"><i class="fa fa-check"></i><b>3.7.1</b> DICOM and nifti format</a></li>
<li class="chapter" data-level="3.7.2" data-path="data-wrangling.html"><a href="data-wrangling.html#manipulating-array-of-medical-images"><i class="fa fa-check"></i><b>3.7.2</b> Manipulating array of medical images</a></li>
<li class="chapter" data-level="3.7.3" data-path="data-wrangling.html"><a href="data-wrangling.html#combining-arrays"><i class="fa fa-check"></i><b>3.7.3</b> Combining arrays</a></li>
<li class="chapter" data-level="3.7.4" data-path="data-wrangling.html"><a href="data-wrangling.html#math-operation-on-multidimensional-array"><i class="fa fa-check"></i><b>3.7.4</b> Math operation on multidimensional array</a></li>
<li class="chapter" data-level="3.7.5" data-path="data-wrangling.html"><a href="data-wrangling.html#math-operation-on-list"><i class="fa fa-check"></i><b>3.7.5</b> Math operation on list</a></li>
<li class="chapter" data-level="3.7.6" data-path="data-wrangling.html"><a href="data-wrangling.html#vectorising-nifti-object"><i class="fa fa-check"></i><b>3.7.6</b> Vectorising nifti object</a></li>
<li class="chapter" data-level="3.7.7" data-path="data-wrangling.html"><a href="data-wrangling.html#tar-file"><i class="fa fa-check"></i><b>3.7.7</b> tar file</a></li>
<li class="chapter" data-level="3.7.8" data-path="data-wrangling.html"><a href="data-wrangling.html#image-registration"><i class="fa fa-check"></i><b>3.7.8</b> Image registration</a></li>
<li class="chapter" data-level="3.7.9" data-path="data-wrangling.html"><a href="data-wrangling.html#rescaling"><i class="fa fa-check"></i><b>3.7.9</b> Rescaling</a></li>
<li class="chapter" data-level="3.7.10" data-path="data-wrangling.html"><a href="data-wrangling.html#mni-template"><i class="fa fa-check"></i><b>3.7.10</b> MNI template</a></li>
<li class="chapter" data-level="3.7.11" data-path="data-wrangling.html"><a href="data-wrangling.html#add-text"><i class="fa fa-check"></i><b>3.7.11</b> add text</a></li>
<li class="chapter" data-level="3.7.12" data-path="data-wrangling.html"><a href="data-wrangling.html#add-text-1"><i class="fa fa-check"></i><b>3.7.12</b> add text</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>4</b> Statistics</a><ul>
<li class="chapter" data-level="4.1" data-path="statistics.html"><a href="statistics.html#univariable-analyses"><i class="fa fa-check"></i><b>4.1</b> Univariable analyses</a><ul>
<li class="chapter" data-level="4.1.1" data-path="statistics.html"><a href="statistics.html#parametric-tests"><i class="fa fa-check"></i><b>4.1.1</b> Parametric tests</a></li>
<li class="chapter" data-level="4.1.2" data-path="statistics.html"><a href="statistics.html#non-parametric-tests"><i class="fa fa-check"></i><b>4.1.2</b> Non-parametric tests</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="statistics.html"><a href="statistics.html#regression"><i class="fa fa-check"></i><b>4.2</b> Regression</a><ul>
<li class="chapter" data-level="4.2.1" data-path="statistics.html"><a href="statistics.html#brief-review-of-matrix"><i class="fa fa-check"></i><b>4.2.1</b> Brief review of matrix</a></li>
<li class="chapter" data-level="4.2.2" data-path="statistics.html"><a href="statistics.html#linear-least-square-regression"><i class="fa fa-check"></i><b>4.2.2</b> Linear (least square) regression</a></li>
<li class="chapter" data-level="4.2.3" data-path="statistics.html"><a href="statistics.html#logistic-regression"><i class="fa fa-check"></i><b>4.2.3</b> Logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="statistics.html"><a href="statistics.html#special-types-of-regression"><i class="fa fa-check"></i><b>4.3</b> Special types of regression</a><ul>
<li class="chapter" data-level="4.3.1" data-path="statistics.html"><a href="statistics.html#ordinal-regression"><i class="fa fa-check"></i><b>4.3.1</b> Ordinal regression</a></li>
<li class="chapter" data-level="4.3.2" data-path="statistics.html"><a href="statistics.html#survival-analysis"><i class="fa fa-check"></i><b>4.3.2</b> Survival analysis</a></li>
<li class="chapter" data-level="4.3.3" data-path="statistics.html"><a href="statistics.html#quantile-regression"><i class="fa fa-check"></i><b>4.3.3</b> Quantile regression</a></li>
<li class="chapter" data-level="4.3.4" data-path="statistics.html"><a href="statistics.html#poisson-regression"><i class="fa fa-check"></i><b>4.3.4</b> Poisson regression</a></li>
<li class="chapter" data-level="4.3.5" data-path="statistics.html"><a href="statistics.html#conditional-logistic-regression"><i class="fa fa-check"></i><b>4.3.5</b> Conditional logistic regression</a></li>
<li class="chapter" data-level="4.3.6" data-path="statistics.html"><a href="statistics.html#multinomial-modelling"><i class="fa fa-check"></i><b>4.3.6</b> Multinomial modelling</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="statistics.html"><a href="statistics.html#sample-size-estimation"><i class="fa fa-check"></i><b>4.4</b> Sample size estimation</a><ul>
<li class="chapter" data-level="4.4.1" data-path="statistics.html"><a href="statistics.html#proportion"><i class="fa fa-check"></i><b>4.4.1</b> Proportion</a></li>
<li class="chapter" data-level="4.4.2" data-path="statistics.html"><a href="statistics.html#logistic-regression-1"><i class="fa fa-check"></i><b>4.4.2</b> Logistic regression</a></li>
<li class="chapter" data-level="4.4.3" data-path="statistics.html"><a href="statistics.html#survival-studies"><i class="fa fa-check"></i><b>4.4.3</b> Survival studies</a></li>
<li class="chapter" data-level="4.4.4" data-path="statistics.html"><a href="statistics.html#multiple-regression"><i class="fa fa-check"></i><b>4.4.4</b> Multiple regression</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="statistics.html"><a href="statistics.html#interpreting-clinical-trials"><i class="fa fa-check"></i><b>4.5</b> Interpreting clinical trials</a><ul>
<li class="chapter" data-level="4.5.1" data-path="statistics.html"><a href="statistics.html#nnt-from-arr"><i class="fa fa-check"></i><b>4.5.1</b> NNT from ARR</a></li>
<li class="chapter" data-level="4.5.2" data-path="statistics.html"><a href="statistics.html#nnt-from-odds-ratio"><i class="fa fa-check"></i><b>4.5.2</b> NNT from odds ratio</a></li>
<li class="chapter" data-level="4.5.3" data-path="statistics.html"><a href="statistics.html#nnt-from-hazard-ratio"><i class="fa fa-check"></i><b>4.5.3</b> NNT from hazard ratio</a></li>
<li class="chapter" data-level="4.5.4" data-path="statistics.html"><a href="statistics.html#nnt-from-metaananlysis"><i class="fa fa-check"></i><b>4.5.4</b> NNT from metaananlysis</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="statistics.html"><a href="statistics.html#metaanalysis"><i class="fa fa-check"></i><b>4.6</b> Metaanalysis</a><ul>
<li class="chapter" data-level="4.6.1" data-path="statistics.html"><a href="statistics.html#prisma"><i class="fa fa-check"></i><b>4.6.1</b> PRISMA</a></li>
<li class="chapter" data-level="4.6.2" data-path="statistics.html"><a href="statistics.html#conversion-of-mean-and-median"><i class="fa fa-check"></i><b>4.6.2</b> Conversion of mean and median</a></li>
<li class="chapter" data-level="4.6.3" data-path="statistics.html"><a href="statistics.html#inconsistency-i2"><i class="fa fa-check"></i><b>4.6.3</b> Inconsistency I2</a></li>
<li class="chapter" data-level="4.6.4" data-path="statistics.html"><a href="statistics.html#metaanalysis-of-proportion"><i class="fa fa-check"></i><b>4.6.4</b> Metaanalysis of proportion</a></li>
<li class="chapter" data-level="4.6.5" data-path="statistics.html"><a href="statistics.html#bivariate-metaanalysis"><i class="fa fa-check"></i><b>4.6.5</b> Bivariate Metaanalysis</a></li>
<li class="chapter" data-level="4.6.6" data-path="statistics.html"><a href="statistics.html#metaanalysis-of-clinical-trial."><i class="fa fa-check"></i><b>4.6.6</b> Metaanalysis of clinical trial.</a></li>
<li class="chapter" data-level="4.6.7" data-path="statistics.html"><a href="statistics.html#metaregression"><i class="fa fa-check"></i><b>4.6.7</b> Metaregression</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="statistics.html"><a href="statistics.html#data-simulation"><i class="fa fa-check"></i><b>4.7</b> Data simulation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html"><i class="fa fa-check"></i><b>5</b> Multivariate Analysis</a><ul>
<li class="chapter" data-level="5.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#multivariate-regression"><i class="fa fa-check"></i><b>5.1</b> Multivariate regression</a><ul>
<li class="chapter" data-level="5.1.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#penalised-regression"><i class="fa fa-check"></i><b>5.1.1</b> Penalised regression</a></li>
<li class="chapter" data-level="5.1.2" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#mars"><i class="fa fa-check"></i><b>5.1.2</b> MARS</a></li>
<li class="chapter" data-level="5.1.3" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#mixed-modelling"><i class="fa fa-check"></i><b>5.1.3</b> Mixed modelling</a></li>
<li class="chapter" data-level="5.1.4" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#trajectory-modelling"><i class="fa fa-check"></i><b>5.1.4</b> Trajectory modelling</a></li>
<li class="chapter" data-level="5.1.5" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#generalized-estimating-equation-gee"><i class="fa fa-check"></i><b>5.1.5</b> Generalized estimating equation (GEE)</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#principal-component-analysis"><i class="fa fa-check"></i><b>5.2</b> Principal component analysis</a></li>
<li class="chapter" data-level="5.3" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#independent-component-analysis"><i class="fa fa-check"></i><b>5.3</b> Independent component analysis</a></li>
<li class="chapter" data-level="5.4" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#partial-least-squares"><i class="fa fa-check"></i><b>5.4</b> Partial least squares</a></li>
<li class="chapter" data-level="5.5" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#causal-inference"><i class="fa fa-check"></i><b>5.5</b> Causal inference</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="machine-learning.html"><a href="machine-learning.html"><i class="fa fa-check"></i><b>6</b> Machine learning</a><ul>
<li class="chapter" data-level="6.1" data-path="machine-learning.html"><a href="machine-learning.html#decision-tree-analysis"><i class="fa fa-check"></i><b>6.1</b> Decision tree analysis</a><ul>
<li class="chapter" data-level="6.1.1" data-path="machine-learning.html"><a href="machine-learning.html#information-theory-driven"><i class="fa fa-check"></i><b>6.1.1</b> Information theory driven</a></li>
<li class="chapter" data-level="6.1.2" data-path="machine-learning.html"><a href="machine-learning.html#conditional-decision-tree"><i class="fa fa-check"></i><b>6.1.2</b> Conditional decision tree</a></li>
<li class="chapter" data-level="6.1.3" data-path="machine-learning.html"><a href="machine-learning.html#criticisms-of-decision-tree"><i class="fa fa-check"></i><b>6.1.3</b> criticisms of decision tree</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="machine-learning.html"><a href="machine-learning.html#random-forest"><i class="fa fa-check"></i><b>6.2</b> Random Forest</a><ul>
<li class="chapter" data-level="6.2.1" data-path="machine-learning.html"><a href="machine-learning.html#random-survival-forest"><i class="fa fa-check"></i><b>6.2.1</b> Random survival forest</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="machine-learning.html"><a href="machine-learning.html#gradient-boost-machine"><i class="fa fa-check"></i><b>6.3</b> Gradient Boost Machine</a><ul>
<li class="chapter" data-level="6.3.1" data-path="machine-learning.html"><a href="machine-learning.html#extreme-gradient-boost-machine"><i class="fa fa-check"></i><b>6.3.1</b> Extreme gradient boost machine</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="machine-learning.html"><a href="machine-learning.html#knn"><i class="fa fa-check"></i><b>6.4</b> KNN</a></li>
<li class="chapter" data-level="6.5" data-path="machine-learning.html"><a href="machine-learning.html#support-vector-machine"><i class="fa fa-check"></i><b>6.5</b> Support vector machine</a><ul>
<li class="chapter" data-level="6.5.1" data-path="machine-learning.html"><a href="machine-learning.html#survival-analysis-using-random-forest"><i class="fa fa-check"></i><b>6.5.1</b> Survival analysis using random forest</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="machine-learning.html"><a href="machine-learning.html#non-negative-matrix-factorisation"><i class="fa fa-check"></i><b>6.6</b> Non-negative matrix factorisation</a></li>
<li class="chapter" data-level="6.7" data-path="machine-learning.html"><a href="machine-learning.html#formal-concept-analysis"><i class="fa fa-check"></i><b>6.7</b> Formal concept analysis</a></li>
<li class="chapter" data-level="6.8" data-path="machine-learning.html"><a href="machine-learning.html#evolutionary-algorithm"><i class="fa fa-check"></i><b>6.8</b> Evolutionary Algorithm</a><ul>
<li class="chapter" data-level="6.8.1" data-path="machine-learning.html"><a href="machine-learning.html#simulated-annealing"><i class="fa fa-check"></i><b>6.8.1</b> Simulated Annealing</a></li>
<li class="chapter" data-level="6.8.2" data-path="machine-learning.html"><a href="machine-learning.html#genetic-algorithm"><i class="fa fa-check"></i><b>6.8.2</b> Genetic Algorithm</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="machine-learning.html"><a href="machine-learning.html#manifold-learning"><i class="fa fa-check"></i><b>6.9</b> Manifold learning</a><ul>
<li class="chapter" data-level="6.9.1" data-path="machine-learning.html"><a href="machine-learning.html#t-stochastic-neighbourhood-embedding"><i class="fa fa-check"></i><b>6.9.1</b> T-Stochastic Neighbourhood Embedding</a></li>
<li class="chapter" data-level="6.9.2" data-path="machine-learning.html"><a href="machine-learning.html#self-organising-map"><i class="fa fa-check"></i><b>6.9.2</b> Self organising map</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="machine-learning.html"><a href="machine-learning.html#deep-learning"><i class="fa fa-check"></i><b>6.10</b> Deep learning</a><ul>
<li class="chapter" data-level="6.10.1" data-path="machine-learning.html"><a href="machine-learning.html#multiplayer-perceptron"><i class="fa fa-check"></i><b>6.10.1</b> Multiplayer Perceptron</a></li>
<li class="chapter" data-level="6.10.2" data-path="machine-learning.html"><a href="machine-learning.html#cnn"><i class="fa fa-check"></i><b>6.10.2</b> CNN</a></li>
<li class="chapter" data-level="6.10.3" data-path="machine-learning.html"><a href="machine-learning.html#rnn"><i class="fa fa-check"></i><b>6.10.3</b> RNN</a></li>
<li class="chapter" data-level="6.10.4" data-path="machine-learning.html"><a href="machine-learning.html#reinforcement-learning"><i class="fa fa-check"></i><b>6.10.4</b> Reinforcement learning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html"><i class="fa fa-check"></i><b>7</b> Machine Learning Part 2</a><ul>
<li class="chapter" data-level="7.1" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#bag-of-words"><i class="fa fa-check"></i><b>7.1</b> Bag of words</a><ul>
<li class="chapter" data-level="7.1.1" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#tfidf"><i class="fa fa-check"></i><b>7.1.1</b> TFIDF</a></li>
<li class="chapter" data-level="7.1.2" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#extracting-data-from-web"><i class="fa fa-check"></i><b>7.1.2</b> Extracting data from web</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#wordcloud"><i class="fa fa-check"></i><b>7.2</b> Wordcloud</a></li>
<li class="chapter" data-level="7.3" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#bigram-analysis"><i class="fa fa-check"></i><b>7.3</b> Bigram analysis</a></li>
<li class="chapter" data-level="7.4" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#trigram"><i class="fa fa-check"></i><b>7.4</b> Trigram</a></li>
<li class="chapter" data-level="7.5" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#topic-modeling-or-thematic-analysis"><i class="fa fa-check"></i><b>7.5</b> Topic modeling or thematic analysis</a><ul>
<li class="chapter" data-level="7.5.1" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#probabilistic-topic-model"><i class="fa fa-check"></i><b>7.5.1</b> Probabilistic topic model</a></li>
<li class="chapter" data-level="7.5.2" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#nmf"><i class="fa fa-check"></i><b>7.5.2</b> NMF</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html"><i class="fa fa-check"></i><b>8</b> Bayesian Analysis</a><ul>
<li class="chapter" data-level="8.1" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#baysian-belief"><i class="fa fa-check"></i><b>8.1</b> Baysian belief</a><ul>
<li class="chapter" data-level="8.1.1" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#conditional-probability"><i class="fa fa-check"></i><b>8.1.1</b> Conditional probability</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#markov-model"><i class="fa fa-check"></i><b>8.2</b> Markov model</a></li>
<li class="chapter" data-level="8.3" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#inla-stan-and-bugs"><i class="fa fa-check"></i><b>8.3</b> INLA, Stan and BUGS</a><ul>
<li class="chapter" data-level="8.3.1" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#linear-regression"><i class="fa fa-check"></i><b>8.3.1</b> Linear regression</a></li>
<li class="chapter" data-level="8.3.2" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#logistic-regression-2"><i class="fa fa-check"></i><b>8.3.2</b> Logistic regression</a></li>
<li class="chapter" data-level="8.3.3" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#mixed-model"><i class="fa fa-check"></i><b>8.3.3</b> Mixed model</a></li>
<li class="chapter" data-level="8.3.4" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#bayesian-metaanalysis"><i class="fa fa-check"></i><b>8.3.4</b> Bayesian Metaanalysis</a></li>
<li class="chapter" data-level="8.3.5" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#cost"><i class="fa fa-check"></i><b>8.3.5</b> Cost</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="operational-research.html"><a href="operational-research.html"><i class="fa fa-check"></i><b>9</b> Operational Research</a><ul>
<li class="chapter" data-level="9.1" data-path="operational-research.html"><a href="operational-research.html#queueing-theory"><i class="fa fa-check"></i><b>9.1</b> Queueing theory</a></li>
<li class="chapter" data-level="9.2" data-path="operational-research.html"><a href="operational-research.html#discrete-event-simulations"><i class="fa fa-check"></i><b>9.2</b> Discrete Event Simulations</a><ul>
<li class="chapter" data-level="9.2.1" data-path="operational-research.html"><a href="operational-research.html#simulate-capacity-of-system"><i class="fa fa-check"></i><b>9.2.1</b> Simulate capacity of system</a></li>
<li class="chapter" data-level="9.2.2" data-path="operational-research.html"><a href="operational-research.html#queuing-network"><i class="fa fa-check"></i><b>9.2.2</b> Queuing network</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="operational-research.html"><a href="operational-research.html#linear-programming"><i class="fa fa-check"></i><b>9.3</b> Linear Programming</a></li>
<li class="chapter" data-level="9.4" data-path="operational-research.html"><a href="operational-research.html#forecasting"><i class="fa fa-check"></i><b>9.4</b> Forecasting</a><ul>
<li class="chapter" data-level="9.4.1" data-path="operational-research.html"><a href="operational-research.html#bed-requirement"><i class="fa fa-check"></i><b>9.4.1</b> Bed requirement</a></li>
<li class="chapter" data-level="9.4.2" data-path="operational-research.html"><a href="operational-research.html#length-of-stay"><i class="fa fa-check"></i><b>9.4.2</b> Length of stay</a></li>
<li class="chapter" data-level="9.4.3" data-path="operational-research.html"><a href="operational-research.html#customer-churns"><i class="fa fa-check"></i><b>9.4.3</b> Customer churns</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="operational-research.html"><a href="operational-research.html#process-mapping"><i class="fa fa-check"></i><b>9.5</b> Process mapping</a></li>
<li class="chapter" data-level="9.6" data-path="operational-research.html"><a href="operational-research.html#supply-chains"><i class="fa fa-check"></i><b>9.6</b> Supply chains</a></li>
<li class="chapter" data-level="9.7" data-path="operational-research.html"><a href="operational-research.html#health-economics"><i class="fa fa-check"></i><b>9.7</b> Health economics</a><ul>
<li class="chapter" data-level="9.7.1" data-path="operational-research.html"><a href="operational-research.html#cost-1"><i class="fa fa-check"></i><b>9.7.1</b> Cost</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="graph-theory.html"><a href="graph-theory.html"><i class="fa fa-check"></i><b>10</b> Graph Theory</a><ul>
<li class="chapter" data-level="10.1" data-path="graph-theory.html"><a href="graph-theory.html#special-graphs"><i class="fa fa-check"></i><b>10.1</b> Special graphs</a><ul>
<li class="chapter" data-level="10.1.1" data-path="graph-theory.html"><a href="graph-theory.html#laplacian-matrix"><i class="fa fa-check"></i><b>10.1.1</b> Laplacian matrix</a></li>
<li class="chapter" data-level="10.1.2" data-path="graph-theory.html"><a href="graph-theory.html#bimodal-bipartite-graph"><i class="fa fa-check"></i><b>10.1.2</b> Bimodal (bipartite) graph</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="graph-theory.html"><a href="graph-theory.html#centrality-measures"><i class="fa fa-check"></i><b>10.2</b> Centrality Measures</a><ul>
<li class="chapter" data-level="10.2.1" data-path="graph-theory.html"><a href="graph-theory.html#local-centrality-measures"><i class="fa fa-check"></i><b>10.2.1</b> Local centrality measures</a></li>
<li class="chapter" data-level="10.2.2" data-path="graph-theory.html"><a href="graph-theory.html#global-centrality-measures"><i class="fa fa-check"></i><b>10.2.2</b> Global centrality measures</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="graph-theory.html"><a href="graph-theory.html#community"><i class="fa fa-check"></i><b>10.3</b> Community</a></li>
<li class="chapter" data-level="10.4" data-path="graph-theory.html"><a href="graph-theory.html#visualising-graph"><i class="fa fa-check"></i><b>10.4</b> Visualising graph</a><ul>
<li class="chapter" data-level="10.4.1" data-path="graph-theory.html"><a href="graph-theory.html#visnetwork"><i class="fa fa-check"></i><b>10.4.1</b> Visnetwork</a></li>
<li class="chapter" data-level="10.4.2" data-path="graph-theory.html"><a href="graph-theory.html#large-graph"><i class="fa fa-check"></i><b>10.4.2</b> Large graph</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="graph-theory.html"><a href="graph-theory.html#social-media-and-network-analysis"><i class="fa fa-check"></i><b>10.5</b> Social Media and Network Analysis</a><ul>
<li class="chapter" data-level="10.5.1" data-path="graph-theory.html"><a href="graph-theory.html#twitter"><i class="fa fa-check"></i><b>10.5.1</b> Twitter</a></li>
<li class="chapter" data-level="10.5.2" data-path="graph-theory.html"><a href="graph-theory.html#youtube"><i class="fa fa-check"></i><b>10.5.2</b> Youtube</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html"><i class="fa fa-check"></i><b>11</b> Geospatial analysis</a><ul>
<li class="chapter" data-level="11.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#geocoding"><i class="fa fa-check"></i><b>11.1</b> Geocoding</a><ul>
<li class="chapter" data-level="11.1.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#openstreetmap"><i class="fa fa-check"></i><b>11.1.1</b> OpenStreetMap</a></li>
<li class="chapter" data-level="11.1.2" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#google-maps-api"><i class="fa fa-check"></i><b>11.1.2</b> Google Maps API</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#sp-and-sf-objects"><i class="fa fa-check"></i><b>11.2</b> Sp and sf objects</a></li>
<li class="chapter" data-level="11.3" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#thematic-map-1"><i class="fa fa-check"></i><b>11.3</b> Thematic map</a><ul>
<li class="chapter" data-level="11.3.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#calculate-distance-to-hospital-openstreetmap"><i class="fa fa-check"></i><b>11.3.1</b> Calculate distance to Hospital-OpenStreetMap</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#spatial-regression"><i class="fa fa-check"></i><b>11.4</b> Spatial regression</a><ul>
<li class="chapter" data-level="11.4.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#new-york-covid-19-mortality"><i class="fa fa-check"></i><b>11.4.1</b> New York COVID-19 mortality</a></li>
<li class="chapter" data-level="11.4.2" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#danish-stroke-registry"><i class="fa fa-check"></i><b>11.4.2</b> Danish Stroke Registry</a></li>
<li class="chapter" data-level="11.4.3" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#inla"><i class="fa fa-check"></i><b>11.4.3</b> INLA</a></li>
<li class="chapter" data-level="11.4.4" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#stan"><i class="fa fa-check"></i><b>11.4.4</b> Stan</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#machine-learning-1"><i class="fa fa-check"></i><b>11.5</b> Machine learning</a></li>
<li class="chapter" data-level="11.6" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#spatio-temporal-regression"><i class="fa fa-check"></i><b>11.6</b> Spatio-temporal regression</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="app.html"><a href="app.html"><i class="fa fa-check"></i><b>12</b> App</a><ul>
<li class="chapter" data-level="12.1" data-path="app.html"><a href="app.html#brief-introduction-to-shiny-app"><i class="fa fa-check"></i><b>12.1</b> Brief introduction to Shiny app</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>13</b> Appendix</a><ul>
<li class="chapter" data-level="13.1" data-path="appendix.html"><a href="appendix.html#brief-introduction-to-matrix"><i class="fa fa-check"></i><b>13.1</b> Brief introduction to Matrix</a></li>
<li class="chapter" data-level="13.2" data-path="appendix.html"><a href="appendix.html#regression-1"><i class="fa fa-check"></i><b>13.2</b> Regression</a><ul>
<li class="chapter" data-level="13.2.1" data-path="appendix.html"><a href="appendix.html#linear-regression-1"><i class="fa fa-check"></i><b>13.2.1</b> Linear regression</a></li>
<li class="chapter" data-level="13.2.2" data-path="appendix.html"><a href="appendix.html#logistic-regression-3"><i class="fa fa-check"></i><b>13.2.2</b> Logistic regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applications of R in Healthcare</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="machine-learning" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Machine learning</h1>
<p>A key aspect of machine learning is cross validation to evaluate the model. It repeatedly evaluate the model based on different subsets of the model and using different parameters to select the optimal parameters. The models are compared against subset of the data. The <em>caret</em> library is an excellent tool for performing model selection.</p>
<div id="decision-tree-analysis" class="section level2">
<h2><span class="header-section-number">6.1</span> Decision tree analysis</h2>
<p>Decision tree method generates a logical flow diagram that resembles a tree.
This triangulated diagram, with repeated partitioning of the original data into smaller groups (nodes) on a yes or no basis, resembles clinical reasoning. By
way of contrast, regression methods generate significant predictors but it’s not clear how those predictors enter the sequential nature of clinical reasoning. Regression models assume that all of the variables are required at once to formulate an accurate prediction. This would make some of the elements of any model from regression analysis superfluous.</p>
<p>There are several different approaches to performing decision tree analyses. The most famous method CART is implemented in R as <em>rpart</em>. The second approaches
uses chi-square test to partition the tree, available from the <em>party</em> library. Decision tree may also reveal complex intreactions (relationship) among the predictors in a way that regression analyses do not easily reveal.</p>
<div id="information-theory-driven" class="section level3">
<h3><span class="header-section-number">6.1.1</span> Information theory driven</h3>
<p>The tree is grown using a “divide and conquer” strategy, with repeated partitioning of the original data into smaller groups (nodes) on a yes or no basis. The method uses a splitting rule built around the notion of “purity.” A node in the tree is defined as pure when all the elements belong to one class. When there is impurity in the node, a split occurs to maximize reduction in “impurity.” In some cases, the split may be biased toward attributes that
contain many different ordinal levels or scales. Thus, the selection of an attribute as the root node may vary according to the splitting rule and the scaling of the attribute. The decision tree package rpart does tolerate certain degree of missing number because the data are split using the available data for that attribute to calculate the Gini index (rather than the entire cohort). One major advantage of <em>rpart</em> is the presentation of the classification rules in
the easily interpretable form of a tree. The hierarchical nature of the decision tree is similar to many decision processes <span class="citation">(Phan et al. <a href="#ref-pmid29559951" role="doc-biblioref">2018</a>)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="machine-learning.html#cb1-1"></a><span class="kw">library</span>(rpart)</span>
<span id="cb1-2"><a href="machine-learning.html#cb1-2"></a><span class="kw">library</span>(rattle)</span></code></pre></div>
<pre><code>## Loading required package: tibble</code></pre>
<pre><code>## Loading required package: bitops</code></pre>
<pre><code>## Rattle: A free graphical interface for data science with R.
## Version 5.4.0 Copyright (c) 2006-2020 Togaware Pty Ltd.
## Type &#39;rattle()&#39; to shake, rattle, and roll your data.</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="machine-learning.html#cb5-1"></a><span class="kw">library</span>(rpart.plot)</span>
<span id="cb5-2"><a href="machine-learning.html#cb5-2"></a><span class="kw">data</span>(<span class="st">&quot;Leukemia&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;Stat2Data&quot;</span>)</span>
<span id="cb5-3"><a href="machine-learning.html#cb5-3"></a><span class="kw">colnames</span>(Leukemia)</span></code></pre></div>
<pre><code>## [1] &quot;Age&quot;    &quot;Smear&quot;  &quot;Infil&quot;  &quot;Index&quot;  &quot;Blasts&quot; &quot;Temp&quot;   &quot;Resp&quot;   &quot;Time&quot;  
## [9] &quot;Status&quot;</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="machine-learning.html#cb7-1"></a><span class="co">#decision tree model for AML treatment</span></span>
<span id="cb7-2"><a href="machine-learning.html#cb7-2"></a>treLeukemia&lt;-<span class="kw">rpart</span>(Status<span class="op">~</span>., <span class="dt">data=</span>Leukemia)</span>
<span id="cb7-3"><a href="machine-learning.html#cb7-3"></a><span class="kw">fancyRpartPlot</span>(treLeukemia)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-1-1.png" width="672" /></p>
</div>
<div id="conditional-decision-tree" class="section level3">
<h3><span class="header-section-number">6.1.2</span> Conditional decision tree</h3>
<p>The conditional decision tree approach has been proposed to be superior to CART method because that method uses information criterion for partitioning and which can lead to overﬁtting.The scenario of overﬁtting describes model which works
well on training data but less so with new data.The conditional approach by <em>party</em> is less prone to overﬁtting as it includes signiﬁcance testing <span class="citation">(Phan et al. <a href="#ref-pmid30761063" role="doc-biblioref">2019</a>)</span>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="machine-learning.html#cb8-1"></a><span class="kw">library</span>(party)</span></code></pre></div>
<pre><code>## Loading required package: grid</code></pre>
<pre><code>## Loading required package: mvtnorm</code></pre>
<pre><code>## Loading required package: modeltools</code></pre>
<pre><code>## Loading required package: stats4</code></pre>
<pre><code>## Loading required package: strucchange</code></pre>
<pre><code>## Loading required package: zoo</code></pre>
<pre><code>## 
## Attaching package: &#39;zoo&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     as.Date, as.Date.numeric</code></pre>
<pre><code>## Loading required package: sandwich</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="machine-learning.html#cb18-1"></a><span class="kw">data</span>(<span class="st">&quot;aSAH&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;pROC&quot;</span>)</span>
<span id="cb18-2"><a href="machine-learning.html#cb18-2"></a><span class="kw">colnames</span>(aSAH)</span></code></pre></div>
<pre><code>## [1] &quot;gos6&quot;    &quot;outcome&quot; &quot;gender&quot;  &quot;age&quot;     &quot;wfns&quot;    &quot;s100b&quot;   &quot;ndka&quot;</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="machine-learning.html#cb20-1"></a><span class="co">#decision tree model</span></span>
<span id="cb20-2"><a href="machine-learning.html#cb20-2"></a>treeSAH&lt;-<span class="kw">ctree</span>(outcome<span class="op">~</span>., <span class="dt">data=</span>aSAH, <span class="dt">control =</span> <span class="kw">ctree_control</span>(<span class="dt">mincriterion=</span><span class="fl">0.95</span>, <span class="dt">minsplit=</span><span class="dv">50</span>))</span>
<span id="cb20-3"><a href="machine-learning.html#cb20-3"></a><span class="kw">plot</span>(treeSAH,<span class="dt">type =</span> <span class="st">&quot;simple&quot;</span>,<span class="dt">main =</span> <span class="st">&quot;Conditional Inference for aSAH&quot;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-2-1.png" width="672" /></p>
</div>
<div id="criticisms-of-decision-tree" class="section level3">
<h3><span class="header-section-number">6.1.3</span> criticisms of decision tree</h3>
<p>Overfitting and prone to chosing variable with many levels are some disadvantage of <em>decision tree</em>. Decision tree do not handle collinearity issues well and the related method of <em>random forest</em> is proposed below.</p>
</div>
</div>
<div id="random-forest" class="section level2">
<h2><span class="header-section-number">6.2</span> Random Forest</h2>
<p>Both gradient boost machine and random forest are examples of tree-based method with the former based on boosting of the residuals of the model and the latter based on bagging with random selection (rows and columns) of multiple subsets of the data. As such random forest regression ensembles the model from multiple decision trees. The trees are created by obtaining multiple subset of the data (random selection of data by rows and columns). Decision tree comes at certain disadvantage such as overfitting. Random forest avoids the problems of single decision tree analyses by aggregating the results of multiple trees obtained by performing analysis on random subsets of the original data. This method is different from the bootstrapping procedure that can be used in decision tree
which may not change the data structure; hence the trees can look very similar. Random forest is available as <em>randomForest</em> or <em>ranger</em> or via <em>caret</em>.</p>
<p>A major drawback to random forest is that the hierarchical nature of the trees
is lost. As such this method is seen as a black box tool and is less commonly embraced in the medical literature. One way us to use an interpretable machine learning tool <em>iml</em> <span class="citation">(Molnar, Bischl, and Casalicchio <a href="#ref-10.21105/joss.00786" role="doc-biblioref">2018</a>)</span> (Shapley values) tool to aid interpretation of the model. This method uses ideas from coalition game theory
to fairly distribute the contribution of the coalition of covariates to the
random forest model.</p>
<p>The machine learning models are tuned using <em>caret</em> library.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="machine-learning.html#cb21-1"></a><span class="co">#https://topepo.github.io/caret/index.html</span></span>
<span id="cb21-2"><a href="machine-learning.html#cb21-2"></a><span class="kw">library</span>(caret)</span></code></pre></div>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## Loading required package: ggplot2</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="machine-learning.html#cb24-1"></a><span class="kw">data</span>(<span class="st">&quot;BreastCancer&quot;</span>,<span class="dt">package =</span> <span class="st">&quot;mlbench&quot;</span>)</span>
<span id="cb24-2"><a href="machine-learning.html#cb24-2"></a><span class="co">#The Breast Cancer data contains NA as well as factors</span></span>
<span id="cb24-3"><a href="machine-learning.html#cb24-3"></a><span class="co">#note Class is benign or malignant of class factor</span></span>
<span id="cb24-4"><a href="machine-learning.html#cb24-4"></a><span class="co">#column Bare.nuclei removed due to NA</span></span>
<span id="cb24-5"><a href="machine-learning.html#cb24-5"></a>BreastCancer&lt;-BreastCancer[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">7</span>)]</span>
<span id="cb24-6"><a href="machine-learning.html#cb24-6"></a></span>
<span id="cb24-7"><a href="machine-learning.html#cb24-7"></a><span class="co">#split data using caTools. </span></span>
<span id="cb24-8"><a href="machine-learning.html#cb24-8"></a><span class="co">#The next example will use createDataPartition from caret</span></span>
<span id="cb24-9"><a href="machine-learning.html#cb24-9"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb24-10"><a href="machine-learning.html#cb24-10"></a>split =<span class="st"> </span>caTools<span class="op">::</span><span class="kw">sample.split</span>(BreastCancer<span class="op">$</span>Class, <span class="dt">SplitRatio =</span> <span class="fl">0.75</span>)</span>
<span id="cb24-11"><a href="machine-learning.html#cb24-11"></a>Train =<span class="st"> </span><span class="kw">subset</span>(BreastCancer, split <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>)</span>
<span id="cb24-12"><a href="machine-learning.html#cb24-12"></a>Test =<span class="st"> </span><span class="kw">subset</span>(BreastCancer, split <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>)</span>
<span id="cb24-13"><a href="machine-learning.html#cb24-13"></a></span>
<span id="cb24-14"><a href="machine-learning.html#cb24-14"></a></span>
<span id="cb24-15"><a href="machine-learning.html#cb24-15"></a><span class="co"># specify that resampling method is </span></span>
<span id="cb24-16"><a href="machine-learning.html#cb24-16"></a>rf_control &lt;-<span class="st"> </span><span class="kw">trainControl</span>(<span class="co">## 10-fold CV</span></span>
<span id="cb24-17"><a href="machine-learning.html#cb24-17"></a>                           <span class="dt">method =</span> <span class="st">&quot;cv&quot;</span>,</span>
<span id="cb24-18"><a href="machine-learning.html#cb24-18"></a>                           <span class="dt">number =</span> <span class="dv">10</span>)</span>
<span id="cb24-19"><a href="machine-learning.html#cb24-19"></a></span>
<span id="cb24-20"><a href="machine-learning.html#cb24-20"></a><span class="co">#scaling data is performed here under preProcess</span></span>
<span id="cb24-21"><a href="machine-learning.html#cb24-21"></a><span class="co">#note that ranger handles the outcome variable as factor</span></span>
<span id="cb24-22"><a href="machine-learning.html#cb24-22"></a>rf &lt;-<span class="st"> </span>caret<span class="op">::</span><span class="kw">train</span>(Class <span class="op">~</span><span class="st"> </span>., </span>
<span id="cb24-23"><a href="machine-learning.html#cb24-23"></a>                    <span class="dt">data =</span> Train, </span>
<span id="cb24-24"><a href="machine-learning.html#cb24-24"></a>                  <span class="dt">method =</span> <span class="st">&quot;ranger&quot;</span>,</span>
<span id="cb24-25"><a href="machine-learning.html#cb24-25"></a>                 <span class="dt">trControl=</span>rf_control,</span>
<span id="cb24-26"><a href="machine-learning.html#cb24-26"></a>                 <span class="dt">preProcess =</span> <span class="kw">c</span>(<span class="st">&quot;center&quot;</span>, <span class="st">&quot;scale&quot;</span>),</span>
<span id="cb24-27"><a href="machine-learning.html#cb24-27"></a>                 <span class="dt">tuneLength =</span> <span class="dv">10</span>, <span class="dt">verbose=</span>F)</span>
<span id="cb24-28"><a href="machine-learning.html#cb24-28"></a></span>
<span id="cb24-29"><a href="machine-learning.html#cb24-29"></a></span>
<span id="cb24-30"><a href="machine-learning.html#cb24-30"></a><span class="kw">summary</span>(rf)</span></code></pre></div>
<pre><code>##                           Length Class         Mode     
## predictions               525    factor        numeric  
## num.trees                   1    -none-        numeric  
## num.independent.variables   1    -none-        numeric  
## mtry                        1    -none-        numeric  
## min.node.size               1    -none-        numeric  
## prediction.error            1    -none-        numeric  
## forest                      9    ranger.forest list     
## confusion.matrix            4    table         numeric  
## splitrule                   1    -none-        character
## num.random.splits           1    -none-        numeric  
## treetype                    1    -none-        character
## call                        9    -none-        call     
## importance.mode             1    -none-        character
## num.samples                 1    -none-        numeric  
## replace                     1    -none-        logical  
## xNames                     71    -none-        character
## problemType                 1    -none-        character
## tuneValue                   3    data.frame    list     
## obsLevels                   2    -none-        character
## param                       1    -none-        list</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="machine-learning.html#cb26-1"></a>pred_rf&lt;-<span class="kw">predict</span>(rf,BreastCancer)</span>
<span id="cb26-2"><a href="machine-learning.html#cb26-2"></a><span class="kw">confusionMatrix</span>(pred_rf, BreastCancer<span class="op">$</span>Class)</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##            Reference
## Prediction  benign malignant
##   benign       455         6
##   malignant      3       235
##                                           
##                Accuracy : 0.9871          
##                  95% CI : (0.9757, 0.9941)
##     No Information Rate : 0.6552          
##     P-Value [Acc &gt; NIR] : &lt;2e-16          
##                                           
##                   Kappa : 0.9714          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.505           
##                                           
##             Sensitivity : 0.9934          
##             Specificity : 0.9751          
##          Pos Pred Value : 0.9870          
##          Neg Pred Value : 0.9874          
##              Prevalence : 0.6552          
##          Detection Rate : 0.6509          
##    Detection Prevalence : 0.6595          
##       Balanced Accuracy : 0.9843          
##                                           
##        &#39;Positive&#39; Class : benign          
## </code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="machine-learning.html#cb28-1"></a>roc_rf&lt;-pROC<span class="op">::</span><span class="kw">roc</span>(BreastCancer<span class="op">$</span>Class, <span class="kw">as.numeric</span>(pred_rf))</span></code></pre></div>
<pre><code>## Setting levels: control = benign, case = malignant</code></pre>
<pre><code>## Setting direction: controls &lt; cases</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="machine-learning.html#cb31-1"></a>roc_rf</span></code></pre></div>
<pre><code>## 
## Call:
## roc.default(response = BreastCancer$Class, predictor = as.numeric(pred_rf))
## 
## Data: as.numeric(pred_rf) in 458 controls (BreastCancer$Class benign) &lt; 241 cases (BreastCancer$Class malignant).
## Area under the curve: 0.9843</code></pre>
<div id="random-survival-forest" class="section level3">
<h3><span class="header-section-number">6.2.1</span> Random survival forest</h3>
<p>Random survival forest example is provided below using <em>rfsrc</em> library. The <em>survex</em> library is used for explanation on the model.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="machine-learning.html#cb33-1"></a><span class="kw">library</span>(survival)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;survival&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:caret&#39;:
## 
##     cluster</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="machine-learning.html#cb36-1"></a><span class="kw">library</span>(survminer)</span></code></pre></div>
<pre><code>## Loading required package: ggpubr</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="machine-learning.html#cb38-1"></a><span class="kw">library</span>(randomForestSRC)</span></code></pre></div>
<pre><code>## 
##  randomForestSRC 2.9.3 
##  
##  Type rfsrc.news() to see new features, changes, and bug fixes. 
## </code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="machine-learning.html#cb40-1"></a><span class="kw">library</span>(survex)</span>
<span id="cb40-2"><a href="machine-learning.html#cb40-2"></a><span class="kw">library</span>(dplyr)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:survex&#39;:
## 
##     explain</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="machine-learning.html#cb45-1"></a><span class="co">#data from survival package on NCCTG lung cancer trial</span></span>
<span id="cb45-2"><a href="machine-learning.html#cb45-2"></a><span class="co">#https://stat.ethz.ch/R-manual/R-devel/library/survival/html/lung.html</span></span>
<span id="cb45-3"><a href="machine-learning.html#cb45-3"></a><span class="kw">data</span>(cancer, <span class="dt">package=</span><span class="st">&quot;survival&quot;</span>)</span>
<span id="cb45-4"><a href="machine-learning.html#cb45-4"></a></span>
<span id="cb45-5"><a href="machine-learning.html#cb45-5"></a><span class="co">#time in days</span></span>
<span id="cb45-6"><a href="machine-learning.html#cb45-6"></a><span class="co">#status censored=1, dead=2</span></span>
<span id="cb45-7"><a href="machine-learning.html#cb45-7"></a><span class="co">#sex:Male=1 Female=2</span></span>
<span id="cb45-8"><a href="machine-learning.html#cb45-8"></a></span>
<span id="cb45-9"><a href="machine-learning.html#cb45-9"></a>cancer2&lt;-<span class="st"> </span>cancer <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(</span>
<span id="cb45-10"><a href="machine-learning.html#cb45-10"></a>  <span class="dt">status=</span><span class="kw">ifelse</span>(status<span class="op">==</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)) <span class="op">%&gt;%</span></span>
<span id="cb45-11"><a href="machine-learning.html#cb45-11"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">Dead=</span>status, <span class="dt">Days=</span>time)</span>
<span id="cb45-12"><a href="machine-learning.html#cb45-12"></a></span>
<span id="cb45-13"><a href="machine-learning.html#cb45-13"></a>time=cancer2<span class="op">$</span>Days</span>
<span id="cb45-14"><a href="machine-learning.html#cb45-14"></a>status=cancer2<span class="op">$</span>Dead</span>
<span id="cb45-15"><a href="machine-learning.html#cb45-15"></a></span>
<span id="cb45-16"><a href="machine-learning.html#cb45-16"></a>RF&lt;-<span class="st"> </span><span class="kw">rfsrc</span>(<span class="kw">Surv</span>(Days, Dead) <span class="op">~</span><span class="st"> </span>age<span class="op">+</span>sex<span class="op">+</span>ph.ecog<span class="op">+</span>ph.karno<span class="op">+</span>wt.loss, <span class="dt">data =</span> cancer2)</span>
<span id="cb45-17"><a href="machine-learning.html#cb45-17"></a></span>
<span id="cb45-18"><a href="machine-learning.html#cb45-18"></a><span class="co">#specify library to avoid confusion with dplyr</span></span>
<span id="cb45-19"><a href="machine-learning.html#cb45-19"></a>explainer&lt;-survex<span class="op">::</span><span class="kw">explain</span>(RF)</span></code></pre></div>
<pre><code>## Preparation of a new explainer is initiated 
##   -&gt; model label       :  rfsrc ( [33m default [39m ) 
##   -&gt; data              :  213  rows  5  cols (  extracted from the model  ) 
##   -&gt; target variable   :  213  values ( 151 events and 62 censored , censoring rate = 0.291 ) (  extracted from the model  ) 
##   -&gt; times             :  50 unique time points , min = 5 , mean = 304.1224 , median = 263.16 , max = 835.44 
##   -&gt; times             :  (  generated from y as 50 time points being consecutive quantiles (0.00, 0.02, ..., 0.98)  ) 
##   -&gt; predict function  :  sum over the predict_cumulative_hazard_function will be used ( [33m default [39m ) 
##   -&gt; predict survival function  :  stepfun based on predict.rfsrc()$survival will be used ( [33m default [39m ) 
##   -&gt; predict cumulative hazard function  :  stepfun based on predict.rfsrc()$chf will be used ( [33m default [39m ) 
##   -&gt; model_info        :  package randomForestSRC , ver. 2.9.3 , task survival ( [33m default [39m ) 
##   A new explainer has been created!</code></pre>
<p>Dynamic AUC</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="machine-learning.html#cb47-1"></a>y &lt;-<span class="st"> </span>explainer<span class="op">$</span>y</span>
<span id="cb47-2"><a href="machine-learning.html#cb47-2"></a>times &lt;-<span class="st"> </span>explainer<span class="op">$</span>times</span>
<span id="cb47-3"><a href="machine-learning.html#cb47-3"></a></span>
<span id="cb47-4"><a href="machine-learning.html#cb47-4"></a>surv &lt;-<span class="st"> </span>explainer<span class="op">$</span><span class="kw">predict_survival_function</span>(RF, explainer<span class="op">$</span>data, times)</span>
<span id="cb47-5"><a href="machine-learning.html#cb47-5"></a></span>
<span id="cb47-6"><a href="machine-learning.html#cb47-6"></a><span class="kw">cd_auc</span>(y, <span class="dt">surv =</span> surv, <span class="dt">times =</span> times)</span></code></pre></div>
<pre><code>##  [1] 1.0000000 0.9299517 0.9133987 0.9150000 0.8784514 0.8738696 0.8492632
##  [8] 0.8469945 0.8443018 0.8200707 0.8181943 0.8126263 0.7827403 0.7585305
## [15] 0.7703840 0.7680369 0.7674442 0.7616438 0.7524828 0.7506547 0.7638787
## [22] 0.7612142 0.7654211 0.7581189 0.7332627 0.7094356 0.7019078 0.7102041
## [29] 0.7105310 0.7056007 0.7075489 0.7109053 0.6989114 0.6901174 0.6906694
## [36] 0.7026007 0.6867102 0.6900591 0.7003147 0.7009741 0.7261286 0.7376953
## [43] 0.7469602 0.7449909 0.7498972 0.7805807 0.8130252 0.8342308 0.8758170
## [50] 0.9000000</code></pre>
<p>Plot variable importance for random survival forest using permutation of features and measure impact on Brier score.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="machine-learning.html#cb49-1"></a>ModelRF&lt;-survex<span class="op">::</span><span class="kw">model_parts</span>(explainer)</span>
<span id="cb49-2"><a href="machine-learning.html#cb49-2"></a></span>
<span id="cb49-3"><a href="machine-learning.html#cb49-3"></a></span>
<span id="cb49-4"><a href="machine-learning.html#cb49-4"></a><span class="kw">plot</span>(ModelRF)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-3-3-1.png" width="672" /></p>
<p>Plot partial dependence</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="machine-learning.html#cb50-1"></a>Model_PD&lt;-<span class="kw">model_profile</span>(explainer)</span>
<span id="cb50-2"><a href="machine-learning.html#cb50-2"></a><span class="kw">plot</span>(Model_PD)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-3-4-1.png" width="672" /></p>
</div>
</div>
<div id="gradient-boost-machine" class="section level2">
<h2><span class="header-section-number">6.3</span> Gradient Boost Machine</h2>
<p>Gradient boost machine is available as <em>gradient boost machine_gbm</em>.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="machine-learning.html#cb51-1"></a><span class="co">#the breast cancer data from random forest is used here</span></span>
<span id="cb51-2"><a href="machine-learning.html#cb51-2"></a></span>
<span id="cb51-3"><a href="machine-learning.html#cb51-3"></a><span class="co"># specify that the resampling method is </span></span>
<span id="cb51-4"><a href="machine-learning.html#cb51-4"></a>gbm_control &lt;-<span class="st"> </span><span class="kw">trainControl</span>(<span class="co">## 10-fold CV</span></span>
<span id="cb51-5"><a href="machine-learning.html#cb51-5"></a>                           <span class="dt">method =</span> <span class="st">&quot;repeatedcv&quot;</span>,</span>
<span id="cb51-6"><a href="machine-learning.html#cb51-6"></a>                           <span class="dt">number =</span> <span class="dv">10</span>)</span>
<span id="cb51-7"><a href="machine-learning.html#cb51-7"></a></span>
<span id="cb51-8"><a href="machine-learning.html#cb51-8"></a><span class="co">#scaling data is performed here under preProcess</span></span>
<span id="cb51-9"><a href="machine-learning.html#cb51-9"></a><span class="co">#note that ranger handles the outcome variable as factor</span></span>
<span id="cb51-10"><a href="machine-learning.html#cb51-10"></a>gbm &lt;-<span class="st"> </span>caret<span class="op">::</span><span class="kw">train</span>(Class <span class="op">~</span><span class="st"> </span>., </span>
<span id="cb51-11"><a href="machine-learning.html#cb51-11"></a>                    <span class="dt">data =</span> Train, </span>
<span id="cb51-12"><a href="machine-learning.html#cb51-12"></a>                  <span class="dt">method =</span> <span class="st">&quot;gbm&quot;</span>,</span>
<span id="cb51-13"><a href="machine-learning.html#cb51-13"></a>                 <span class="dt">trControl=</span>gbm_control,</span>
<span id="cb51-14"><a href="machine-learning.html#cb51-14"></a>                 <span class="dt">preProcess =</span> <span class="kw">c</span>(<span class="st">&quot;center&quot;</span>, <span class="st">&quot;scale&quot;</span>),</span>
<span id="cb51-15"><a href="machine-learning.html#cb51-15"></a>                 <span class="dt">tuneLength =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1522             nan     0.1000    0.0657
##      2        1.0452             nan     0.1000    0.0520
##      3        0.9465             nan     0.1000    0.0486
##      4        0.8699             nan     0.1000    0.0376
##      5        0.8031             nan     0.1000    0.0314
##      6        0.7480             nan     0.1000    0.0279
##      7        0.6949             nan     0.1000    0.0264
##      8        0.6500             nan     0.1000    0.0206
##      9        0.6110             nan     0.1000    0.0178
##     10        0.5772             nan     0.1000    0.0173
##     20        0.3674             nan     0.1000    0.0043
##     40        0.2291             nan     0.1000   -0.0004
##     60        0.1753             nan     0.1000   -0.0003
##     80        0.1502             nan     0.1000   -0.0001
##    100        0.1353             nan     0.1000    0.0000
##    120        0.1218             nan     0.1000   -0.0004
##    140        0.1114             nan     0.1000    0.0001
##    160        0.1033             nan     0.1000   -0.0006
##    180        0.1008             nan     0.1000   -0.0001
##    200        0.0958             nan     0.1000   -0.0012
##    220        0.0935             nan     0.1000   -0.0008
##    240        0.0880             nan     0.1000    0.0000
##    260        0.0851             nan     0.1000   -0.0002
##    280        0.0826             nan     0.1000    0.0002
##    300        0.0787             nan     0.1000   -0.0007
##    320        0.0760             nan     0.1000   -0.0002
##    340        0.0749             nan     0.1000   -0.0010
##    360        0.0730             nan     0.1000   -0.0008
##    380        0.0714             nan     0.1000   -0.0005
##    400        0.0707             nan     0.1000   -0.0011
##    420        0.0684             nan     0.1000   -0.0007
##    440        0.0677             nan     0.1000   -0.0006
##    460        0.0654             nan     0.1000   -0.0005
##    480        0.0642             nan     0.1000   -0.0004
##    500        0.0628             nan     0.1000   -0.0005
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1503             nan     0.1000    0.0720
##      2        1.0312             nan     0.1000    0.0637
##      3        0.9344             nan     0.1000    0.0459
##      4        0.8459             nan     0.1000    0.0426
##      5        0.7714             nan     0.1000    0.0350
##      6        0.7103             nan     0.1000    0.0297
##      7        0.6549             nan     0.1000    0.0252
##      8        0.6086             nan     0.1000    0.0224
##      9        0.5655             nan     0.1000    0.0203
##     10        0.5309             nan     0.1000    0.0142
##     20        0.3039             nan     0.1000    0.0034
##     40        0.1670             nan     0.1000    0.0004
##     60        0.1252             nan     0.1000   -0.0008
##     80        0.1025             nan     0.1000   -0.0005
##    100        0.0838             nan     0.1000   -0.0005
##    120        0.0725             nan     0.1000   -0.0004
##    140        0.0648             nan     0.1000   -0.0007
##    160        0.0567             nan     0.1000    0.0002
##    180        0.0512             nan     0.1000   -0.0002
##    200        0.0447             nan     0.1000   -0.0003
##    220        0.0395             nan     0.1000   -0.0004
##    240        0.0348             nan     0.1000   -0.0002
##    260        0.0322             nan     0.1000   -0.0004
##    280        0.0291             nan     0.1000   -0.0003
##    300        0.0266             nan     0.1000   -0.0002
##    320        0.0238             nan     0.1000   -0.0001
##    340        0.0226             nan     0.1000   -0.0002
##    360        0.0205             nan     0.1000   -0.0002
##    380        0.0184             nan     0.1000   -0.0001
##    400        0.0172             nan     0.1000   -0.0002
##    420        0.0160             nan     0.1000   -0.0002
##    440        0.0143             nan     0.1000   -0.0001
##    460        0.0130             nan     0.1000   -0.0002
##    480        0.0116             nan     0.1000   -0.0001
##    500        0.0104             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1391             nan     0.1000    0.0729
##      2        1.0123             nan     0.1000    0.0620
##      3        0.9073             nan     0.1000    0.0506
##      4        0.8186             nan     0.1000    0.0406
##      5        0.7505             nan     0.1000    0.0336
##      6        0.6854             nan     0.1000    0.0317
##      7        0.6319             nan     0.1000    0.0263
##      8        0.5862             nan     0.1000    0.0223
##      9        0.5435             nan     0.1000    0.0179
##     10        0.5077             nan     0.1000    0.0169
##     20        0.2713             nan     0.1000    0.0040
##     40        0.1418             nan     0.1000   -0.0008
##     60        0.0973             nan     0.1000    0.0001
##     80        0.0767             nan     0.1000   -0.0010
##    100        0.0585             nan     0.1000   -0.0004
##    120        0.0475             nan     0.1000   -0.0003
##    140        0.0378             nan     0.1000   -0.0001
##    160        0.0310             nan     0.1000   -0.0004
##    180        0.0259             nan     0.1000   -0.0004
##    200        0.0220             nan     0.1000   -0.0004
##    220        0.0181             nan     0.1000   -0.0002
##    240        0.0161             nan     0.1000   -0.0003
##    260        0.0134             nan     0.1000   -0.0002
##    280        0.0115             nan     0.1000   -0.0001
##    300        0.0099             nan     0.1000   -0.0001
##    320        0.0085             nan     0.1000   -0.0001
##    340        0.0074             nan     0.1000   -0.0001
##    360        0.0066             nan     0.1000   -0.0001
##    380        0.0055             nan     0.1000   -0.0000
##    400        0.0049             nan     0.1000   -0.0000
##    420        0.0043             nan     0.1000   -0.0000
##    440        0.0037             nan     0.1000   -0.0000
##    460        0.0031             nan     0.1000   -0.0000
##    480        0.0027             nan     0.1000   -0.0000
##    500        0.0024             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1380             nan     0.1000    0.0745
##      2        1.0151             nan     0.1000    0.0609
##      3        0.9125             nan     0.1000    0.0492
##      4        0.8251             nan     0.1000    0.0397
##      5        0.7505             nan     0.1000    0.0346
##      6        0.6840             nan     0.1000    0.0316
##      7        0.6268             nan     0.1000    0.0280
##      8        0.5754             nan     0.1000    0.0247
##      9        0.5327             nan     0.1000    0.0171
##     10        0.4934             nan     0.1000    0.0172
##     20        0.2630             nan     0.1000    0.0059
##     40        0.1275             nan     0.1000   -0.0006
##     60        0.0786             nan     0.1000   -0.0010
##     80        0.0552             nan     0.1000   -0.0007
##    100        0.0392             nan     0.1000   -0.0004
##    120        0.0289             nan     0.1000   -0.0004
##    140        0.0223             nan     0.1000   -0.0002
##    160        0.0176             nan     0.1000   -0.0002
##    180        0.0141             nan     0.1000   -0.0001
##    200        0.0107             nan     0.1000   -0.0001
##    220        0.0087             nan     0.1000   -0.0001
##    240        0.0068             nan     0.1000   -0.0000
##    260        0.0054             nan     0.1000   -0.0000
##    280        0.0043             nan     0.1000   -0.0001
##    300        0.0033             nan     0.1000   -0.0000
##    320        0.0027             nan     0.1000   -0.0000
##    340        0.0020             nan     0.1000   -0.0000
##    360        0.0016             nan     0.1000   -0.0000
##    380        0.0013             nan     0.1000   -0.0000
##    400        0.0011             nan     0.1000   -0.0000
##    420        0.0009             nan     0.1000   -0.0000
##    440        0.0007             nan     0.1000   -0.0000
##    460        0.0006             nan     0.1000   -0.0000
##    480        0.0005             nan     0.1000   -0.0000
##    500        0.0004             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1362             nan     0.1000    0.0781
##      2        1.0087             nan     0.1000    0.0624
##      3        0.8981             nan     0.1000    0.0531
##      4        0.8110             nan     0.1000    0.0422
##      5        0.7379             nan     0.1000    0.0332
##      6        0.6761             nan     0.1000    0.0292
##      7        0.6210             nan     0.1000    0.0253
##      8        0.5673             nan     0.1000    0.0240
##      9        0.5235             nan     0.1000    0.0211
##     10        0.4845             nan     0.1000    0.0180
##     20        0.2600             nan     0.1000    0.0042
##     40        0.1179             nan     0.1000   -0.0014
##     60        0.0721             nan     0.1000   -0.0015
##     80        0.0471             nan     0.1000   -0.0003
##    100        0.0323             nan     0.1000   -0.0004
##    120        0.0232             nan     0.1000   -0.0002
##    140        0.0173             nan     0.1000   -0.0002
##    160        0.0127             nan     0.1000   -0.0002
##    180        0.0093             nan     0.1000   -0.0000
##    200        0.0066             nan     0.1000   -0.0001
##    220        0.0055             nan     0.1000   -0.0001
##    240        0.0039             nan     0.1000    0.0000
##    260        0.0030             nan     0.1000   -0.0000
##    280        0.0021             nan     0.1000   -0.0000
##    300        0.0017             nan     0.1000   -0.0000
##    320        0.0014             nan     0.1000   -0.0000
##    340        0.0011             nan     0.1000   -0.0000
##    360        0.0008             nan     0.1000   -0.0000
##    380        0.0006             nan     0.1000   -0.0000
##    400        0.0005             nan     0.1000   -0.0000
##    420        0.0004             nan     0.1000   -0.0000
##    440        0.0003             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0002             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1368             nan     0.1000    0.0740
##      2        1.0143             nan     0.1000    0.0581
##      3        0.9146             nan     0.1000    0.0474
##      4        0.8273             nan     0.1000    0.0431
##      5        0.7535             nan     0.1000    0.0343
##      6        0.6904             nan     0.1000    0.0313
##      7        0.6320             nan     0.1000    0.0263
##      8        0.5784             nan     0.1000    0.0246
##      9        0.5362             nan     0.1000    0.0180
##     10        0.4980             nan     0.1000    0.0148
##     20        0.2605             nan     0.1000    0.0038
##     40        0.1074             nan     0.1000   -0.0018
##     60        0.0587             nan     0.1000   -0.0010
##     80        0.0384             nan     0.1000   -0.0004
##    100        0.0248             nan     0.1000   -0.0005
##    120        0.0176             nan     0.1000   -0.0004
##    140        0.0124             nan     0.1000   -0.0001
##    160        0.0085             nan     0.1000   -0.0001
##    180        0.0058             nan     0.1000   -0.0001
##    200        0.0042             nan     0.1000   -0.0000
##    220        0.0030             nan     0.1000   -0.0000
##    240        0.0023             nan     0.1000   -0.0000
##    260        0.0017             nan     0.1000   -0.0001
##    280        0.0012             nan     0.1000   -0.0000
##    300        0.0009             nan     0.1000   -0.0000
##    320        0.0007             nan     0.1000   -0.0000
##    340        0.0006             nan     0.1000   -0.0000
##    360        0.0004             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000    0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1362             nan     0.1000    0.0753
##      2        1.0097             nan     0.1000    0.0619
##      3        0.9048             nan     0.1000    0.0515
##      4        0.8158             nan     0.1000    0.0413
##      5        0.7373             nan     0.1000    0.0372
##      6        0.6690             nan     0.1000    0.0321
##      7        0.6114             nan     0.1000    0.0272
##      8        0.5631             nan     0.1000    0.0221
##      9        0.5219             nan     0.1000    0.0174
##     10        0.4847             nan     0.1000    0.0164
##     20        0.2624             nan     0.1000    0.0046
##     40        0.1023             nan     0.1000   -0.0003
##     60        0.0598             nan     0.1000   -0.0010
##     80        0.0373             nan     0.1000   -0.0007
##    100        0.0229             nan     0.1000   -0.0002
##    120        0.0161             nan     0.1000   -0.0003
##    140        0.0118             nan     0.1000   -0.0004
##    160        0.0087             nan     0.1000   -0.0001
##    180        0.0060             nan     0.1000    0.0000
##    200        0.0044             nan     0.1000   -0.0001
##    220        0.0031             nan     0.1000   -0.0001
##    240        0.0021             nan     0.1000   -0.0000
##    260        0.0016             nan     0.1000   -0.0000
##    280        0.0010             nan     0.1000   -0.0000
##    300        0.0007             nan     0.1000   -0.0000
##    320        0.0005             nan     0.1000   -0.0000
##    340        0.0004             nan     0.1000   -0.0000
##    360        0.0003             nan     0.1000   -0.0000
##    380        0.0002             nan     0.1000   -0.0000
##    400        0.0001             nan     0.1000   -0.0000
##    420        0.0001             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000    0.0000
##    480        0.0000             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1338             nan     0.1000    0.0751
##      2        1.0053             nan     0.1000    0.0580
##      3        0.9014             nan     0.1000    0.0491
##      4        0.8204             nan     0.1000    0.0394
##      5        0.7435             nan     0.1000    0.0356
##      6        0.6761             nan     0.1000    0.0314
##      7        0.6180             nan     0.1000    0.0278
##      8        0.5678             nan     0.1000    0.0228
##      9        0.5224             nan     0.1000    0.0205
##     10        0.4835             nan     0.1000    0.0182
##     20        0.2562             nan     0.1000    0.0039
##     40        0.1050             nan     0.1000    0.0002
##     60        0.0602             nan     0.1000    0.0000
##     80        0.0363             nan     0.1000   -0.0009
##    100        0.0215             nan     0.1000   -0.0003
##    120        0.0152             nan     0.1000   -0.0001
##    140        0.0097             nan     0.1000   -0.0000
##    160        0.0069             nan     0.1000   -0.0001
##    180        0.0050             nan     0.1000   -0.0001
##    200        0.0036             nan     0.1000   -0.0001
##    220        0.0023             nan     0.1000    0.0000
##    240        0.0015             nan     0.1000   -0.0000
##    260        0.0011             nan     0.1000   -0.0000
##    280        0.0008             nan     0.1000   -0.0000
##    300        0.0006             nan     0.1000   -0.0000
##    320        0.0005             nan     0.1000   -0.0000
##    340        0.0003             nan     0.1000   -0.0000
##    360        0.0003             nan     0.1000   -0.0000
##    380        0.0002             nan     0.1000   -0.0000
##    400        0.0001             nan     0.1000   -0.0000
##    420        0.0001             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0000             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1314             nan     0.1000    0.0719
##      2        1.0135             nan     0.1000    0.0594
##      3        0.9168             nan     0.1000    0.0447
##      4        0.8288             nan     0.1000    0.0413
##      5        0.7542             nan     0.1000    0.0375
##      6        0.6882             nan     0.1000    0.0303
##      7        0.6293             nan     0.1000    0.0268
##      8        0.5776             nan     0.1000    0.0238
##      9        0.5313             nan     0.1000    0.0200
##     10        0.4949             nan     0.1000    0.0154
##     20        0.2559             nan     0.1000    0.0031
##     40        0.1015             nan     0.1000    0.0014
##     60        0.0533             nan     0.1000   -0.0001
##     80        0.0317             nan     0.1000   -0.0004
##    100        0.0221             nan     0.1000   -0.0003
##    120        0.0147             nan     0.1000   -0.0002
##    140        0.0097             nan     0.1000   -0.0003
##    160        0.0073             nan     0.1000   -0.0002
##    180        0.0055             nan     0.1000   -0.0002
##    200        0.0034             nan     0.1000   -0.0001
##    220        0.0020             nan     0.1000    0.0000
##    240        0.0016             nan     0.1000   -0.0000
##    260        0.0012             nan     0.1000   -0.0000
##    280        0.0009             nan     0.1000    0.0000
##    300        0.0007             nan     0.1000    0.0000
##    320        0.0006             nan     0.1000   -0.0000
##    340        0.0004             nan     0.1000    0.0000
##    360        0.0003             nan     0.1000   -0.0000
##    380        0.0002             nan     0.1000   -0.0000
##    400        0.0001             nan     0.1000    0.0000
##    420        0.0001             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1379             nan     0.1000    0.0704
##      2        1.0121             nan     0.1000    0.0599
##      3        0.9038             nan     0.1000    0.0500
##      4        0.8195             nan     0.1000    0.0422
##      5        0.7441             nan     0.1000    0.0339
##      6        0.6852             nan     0.1000    0.0265
##      7        0.6269             nan     0.1000    0.0281
##      8        0.5777             nan     0.1000    0.0202
##      9        0.5340             nan     0.1000    0.0205
##     10        0.4959             nan     0.1000    0.0166
##     20        0.2599             nan     0.1000    0.0053
##     40        0.1110             nan     0.1000    0.0003
##     60        0.0573             nan     0.1000   -0.0006
##     80        0.0356             nan     0.1000   -0.0004
##    100        0.0251             nan     0.1000   -0.0002
##    120        0.0181             nan     0.1000    0.0001
##    140        0.0134             nan     0.1000   -0.0005
##    160        0.0101             nan     0.1000   -0.0003
##    180        0.0075             nan     0.1000   -0.0001
##    200        0.0052             nan     0.1000   -0.0000
##    220        0.0039             nan     0.1000   -0.0001
##    240        0.0031             nan     0.1000   -0.0001
##    260        0.0023             nan     0.1000   -0.0000
##    280        0.0017             nan     0.1000   -0.0000
##    300        0.0013             nan     0.1000   -0.0000
##    320        0.0011             nan     0.1000   -0.0000
##    340        0.0008             nan     0.1000   -0.0000
##    360        0.0006             nan     0.1000   -0.0000
##    380        0.0005             nan     0.1000   -0.0000
##    400        0.0004             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0003             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1483             nan     0.1000    0.0660
##      2        1.0427             nan     0.1000    0.0513
##      3        0.9512             nan     0.1000    0.0461
##      4        0.8777             nan     0.1000    0.0373
##      5        0.8136             nan     0.1000    0.0320
##      6        0.7544             nan     0.1000    0.0285
##      7        0.7039             nan     0.1000    0.0226
##      8        0.6653             nan     0.1000    0.0171
##      9        0.6268             nan     0.1000    0.0173
##     10        0.5916             nan     0.1000    0.0158
##     20        0.3881             nan     0.1000    0.0057
##     40        0.2439             nan     0.1000    0.0008
##     60        0.2027             nan     0.1000    0.0009
##     80        0.1778             nan     0.1000   -0.0006
##    100        0.1659             nan     0.1000   -0.0008
##    120        0.1523             nan     0.1000   -0.0007
##    140        0.1446             nan     0.1000   -0.0007
##    160        0.1382             nan     0.1000   -0.0007
##    180        0.1328             nan     0.1000   -0.0003
##    200        0.1293             nan     0.1000   -0.0005
##    220        0.1271             nan     0.1000   -0.0018
##    240        0.1199             nan     0.1000   -0.0008
##    260        0.1169             nan     0.1000   -0.0011
##    280        0.1139             nan     0.1000   -0.0004
##    300        0.1080             nan     0.1000   -0.0009
##    320        0.1057             nan     0.1000   -0.0008
##    340        0.1019             nan     0.1000   -0.0007
##    360        0.1016             nan     0.1000   -0.0016
##    380        0.1010             nan     0.1000   -0.0008
##    400        0.1002             nan     0.1000   -0.0004
##    420        0.0992             nan     0.1000   -0.0008
##    440        0.0970             nan     0.1000   -0.0008
##    460        0.0962             nan     0.1000   -0.0005
##    480        0.0945             nan     0.1000   -0.0004
##    500        0.0939             nan     0.1000   -0.0006
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1342             nan     0.1000    0.0714
##      2        1.0162             nan     0.1000    0.0592
##      3        0.9188             nan     0.1000    0.0460
##      4        0.8413             nan     0.1000    0.0370
##      5        0.7696             nan     0.1000    0.0350
##      6        0.7082             nan     0.1000    0.0279
##      7        0.6599             nan     0.1000    0.0223
##      8        0.6125             nan     0.1000    0.0225
##      9        0.5724             nan     0.1000    0.0190
##     10        0.5350             nan     0.1000    0.0153
##     20        0.3143             nan     0.1000    0.0055
##     40        0.1901             nan     0.1000   -0.0010
##     60        0.1475             nan     0.1000   -0.0014
##     80        0.1207             nan     0.1000   -0.0000
##    100        0.1060             nan     0.1000   -0.0002
##    120        0.0948             nan     0.1000   -0.0009
##    140        0.0815             nan     0.1000   -0.0002
##    160        0.0722             nan     0.1000   -0.0007
##    180        0.0657             nan     0.1000   -0.0007
##    200        0.0592             nan     0.1000   -0.0004
##    220        0.0539             nan     0.1000   -0.0001
##    240        0.0483             nan     0.1000   -0.0002
##    260        0.0445             nan     0.1000   -0.0004
##    280        0.0395             nan     0.1000   -0.0002
##    300        0.0365             nan     0.1000   -0.0004
##    320        0.0336             nan     0.1000   -0.0002
##    340        0.0315             nan     0.1000   -0.0003
##    360        0.0283             nan     0.1000   -0.0001
##    380        0.0258             nan     0.1000   -0.0003
##    400        0.0244             nan     0.1000   -0.0002
##    420        0.0224             nan     0.1000   -0.0001
##    440        0.0208             nan     0.1000   -0.0001
##    460        0.0192             nan     0.1000   -0.0003
##    480        0.0179             nan     0.1000   -0.0002
##    500        0.0161             nan     0.1000   -0.0001
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1377             nan     0.1000    0.0749
##      2        1.0149             nan     0.1000    0.0601
##      3        0.9142             nan     0.1000    0.0466
##      4        0.8282             nan     0.1000    0.0361
##      5        0.7581             nan     0.1000    0.0347
##      6        0.6939             nan     0.1000    0.0311
##      7        0.6386             nan     0.1000    0.0259
##      8        0.5934             nan     0.1000    0.0225
##      9        0.5536             nan     0.1000    0.0170
##     10        0.5165             nan     0.1000    0.0174
##     20        0.2941             nan     0.1000    0.0048
##     40        0.1628             nan     0.1000   -0.0013
##     60        0.1102             nan     0.1000    0.0010
##     80        0.0862             nan     0.1000   -0.0005
##    100        0.0690             nan     0.1000   -0.0007
##    120        0.0574             nan     0.1000   -0.0007
##    140        0.0469             nan     0.1000   -0.0004
##    160        0.0405             nan     0.1000   -0.0004
##    180        0.0331             nan     0.1000   -0.0001
##    200        0.0277             nan     0.1000   -0.0005
##    220        0.0223             nan     0.1000   -0.0001
##    240        0.0193             nan     0.1000   -0.0001
##    260        0.0168             nan     0.1000   -0.0001
##    280        0.0143             nan     0.1000   -0.0001
##    300        0.0119             nan     0.1000   -0.0001
##    320        0.0106             nan     0.1000   -0.0001
##    340        0.0089             nan     0.1000   -0.0001
##    360        0.0081             nan     0.1000   -0.0001
##    380        0.0069             nan     0.1000   -0.0001
##    400        0.0060             nan     0.1000   -0.0001
##    420        0.0051             nan     0.1000    0.0000
##    440        0.0043             nan     0.1000   -0.0000
##    460        0.0038             nan     0.1000   -0.0000
##    480        0.0033             nan     0.1000   -0.0000
##    500        0.0029             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1268             nan     0.1000    0.0769
##      2        1.0068             nan     0.1000    0.0570
##      3        0.9047             nan     0.1000    0.0476
##      4        0.8184             nan     0.1000    0.0406
##      5        0.7421             nan     0.1000    0.0367
##      6        0.6809             nan     0.1000    0.0277
##      7        0.6272             nan     0.1000    0.0232
##      8        0.5772             nan     0.1000    0.0221
##      9        0.5371             nan     0.1000    0.0174
##     10        0.5009             nan     0.1000    0.0172
##     20        0.2771             nan     0.1000    0.0049
##     40        0.1423             nan     0.1000    0.0011
##     60        0.0903             nan     0.1000    0.0003
##     80        0.0657             nan     0.1000   -0.0002
##    100        0.0507             nan     0.1000   -0.0007
##    120        0.0402             nan     0.1000   -0.0009
##    140        0.0309             nan     0.1000   -0.0001
##    160        0.0246             nan     0.1000   -0.0000
##    180        0.0200             nan     0.1000   -0.0004
##    200        0.0154             nan     0.1000   -0.0001
##    220        0.0129             nan     0.1000   -0.0002
##    240        0.0104             nan     0.1000   -0.0000
##    260        0.0088             nan     0.1000   -0.0001
##    280        0.0069             nan     0.1000   -0.0000
##    300        0.0056             nan     0.1000   -0.0001
##    320        0.0046             nan     0.1000   -0.0001
##    340        0.0037             nan     0.1000    0.0000
##    360        0.0030             nan     0.1000   -0.0000
##    380        0.0025             nan     0.1000   -0.0000
##    400        0.0020             nan     0.1000   -0.0000
##    420        0.0016             nan     0.1000   -0.0000
##    440        0.0013             nan     0.1000   -0.0000
##    460        0.0011             nan     0.1000   -0.0000
##    480        0.0009             nan     0.1000   -0.0000
##    500        0.0008             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1352             nan     0.1000    0.0716
##      2        1.0122             nan     0.1000    0.0583
##      3        0.9094             nan     0.1000    0.0471
##      4        0.8230             nan     0.1000    0.0373
##      5        0.7545             nan     0.1000    0.0325
##      6        0.6911             nan     0.1000    0.0294
##      7        0.6314             nan     0.1000    0.0254
##      8        0.5820             nan     0.1000    0.0214
##      9        0.5415             nan     0.1000    0.0186
##     10        0.5072             nan     0.1000    0.0140
##     20        0.2781             nan     0.1000    0.0048
##     40        0.1322             nan     0.1000    0.0001
##     60        0.0830             nan     0.1000   -0.0007
##     80        0.0559             nan     0.1000   -0.0006
##    100        0.0416             nan     0.1000   -0.0007
##    120        0.0303             nan     0.1000   -0.0005
##    140        0.0225             nan     0.1000   -0.0004
##    160        0.0166             nan     0.1000   -0.0001
##    180        0.0126             nan     0.1000   -0.0003
##    200        0.0099             nan     0.1000   -0.0002
##    220        0.0073             nan     0.1000   -0.0001
##    240        0.0053             nan     0.1000   -0.0000
##    260        0.0042             nan     0.1000   -0.0001
##    280        0.0034             nan     0.1000   -0.0000
##    300        0.0026             nan     0.1000   -0.0000
##    320        0.0020             nan     0.1000   -0.0000
##    340        0.0015             nan     0.1000   -0.0000
##    360        0.0012             nan     0.1000   -0.0000
##    380        0.0010             nan     0.1000   -0.0000
##    400        0.0008             nan     0.1000   -0.0000
##    420        0.0006             nan     0.1000   -0.0000
##    440        0.0005             nan     0.1000   -0.0000
##    460        0.0004             nan     0.1000   -0.0000
##    480        0.0003             nan     0.1000   -0.0000
##    500        0.0002             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1333             nan     0.1000    0.0751
##      2        1.0097             nan     0.1000    0.0589
##      3        0.9126             nan     0.1000    0.0451
##      4        0.8283             nan     0.1000    0.0422
##      5        0.7567             nan     0.1000    0.0343
##      6        0.6897             nan     0.1000    0.0305
##      7        0.6350             nan     0.1000    0.0244
##      8        0.5859             nan     0.1000    0.0235
##      9        0.5402             nan     0.1000    0.0228
##     10        0.5023             nan     0.1000    0.0156
##     20        0.2756             nan     0.1000    0.0047
##     40        0.1234             nan     0.1000    0.0005
##     60        0.0692             nan     0.1000    0.0001
##     80        0.0460             nan     0.1000   -0.0007
##    100        0.0345             nan     0.1000   -0.0001
##    120        0.0264             nan     0.1000   -0.0005
##    140        0.0186             nan     0.1000   -0.0004
##    160        0.0130             nan     0.1000   -0.0002
##    180        0.0097             nan     0.1000   -0.0001
##    200        0.0073             nan     0.1000   -0.0001
##    220        0.0057             nan     0.1000   -0.0001
##    240        0.0041             nan     0.1000   -0.0001
##    260        0.0030             nan     0.1000   -0.0000
##    280        0.0024             nan     0.1000   -0.0000
##    300        0.0018             nan     0.1000   -0.0000
##    320        0.0013             nan     0.1000   -0.0000
##    340        0.0009             nan     0.1000   -0.0000
##    360        0.0006             nan     0.1000    0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000    0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1362             nan     0.1000    0.0723
##      2        1.0098             nan     0.1000    0.0587
##      3        0.9041             nan     0.1000    0.0466
##      4        0.8182             nan     0.1000    0.0382
##      5        0.7424             nan     0.1000    0.0329
##      6        0.6810             nan     0.1000    0.0280
##      7        0.6232             nan     0.1000    0.0262
##      8        0.5750             nan     0.1000    0.0234
##      9        0.5335             nan     0.1000    0.0178
##     10        0.4975             nan     0.1000    0.0150
##     20        0.2712             nan     0.1000    0.0043
##     40        0.1243             nan     0.1000    0.0002
##     60        0.0689             nan     0.1000   -0.0006
##     80        0.0453             nan     0.1000   -0.0001
##    100        0.0326             nan     0.1000   -0.0010
##    120        0.0233             nan     0.1000   -0.0002
##    140        0.0165             nan     0.1000    0.0001
##    160        0.0108             nan     0.1000   -0.0001
##    180        0.0082             nan     0.1000   -0.0001
##    200        0.0055             nan     0.1000   -0.0002
##    220        0.0045             nan     0.1000   -0.0001
##    240        0.0035             nan     0.1000   -0.0000
##    260        0.0025             nan     0.1000   -0.0000
##    280        0.0020             nan     0.1000   -0.0000
##    300        0.0014             nan     0.1000   -0.0000
##    320        0.0010             nan     0.1000   -0.0000
##    340        0.0007             nan     0.1000   -0.0000
##    360        0.0006             nan     0.1000    0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1344             nan     0.1000    0.0753
##      2        1.0097             nan     0.1000    0.0569
##      3        0.9104             nan     0.1000    0.0496
##      4        0.8270             nan     0.1000    0.0390
##      5        0.7474             nan     0.1000    0.0354
##      6        0.6879             nan     0.1000    0.0265
##      7        0.6305             nan     0.1000    0.0264
##      8        0.5832             nan     0.1000    0.0200
##      9        0.5407             nan     0.1000    0.0182
##     10        0.5000             nan     0.1000    0.0184
##     20        0.2737             nan     0.1000    0.0047
##     40        0.1187             nan     0.1000   -0.0003
##     60        0.0636             nan     0.1000   -0.0010
##     80        0.0411             nan     0.1000   -0.0014
##    100        0.0287             nan     0.1000   -0.0004
##    120        0.0183             nan     0.1000   -0.0001
##    140        0.0131             nan     0.1000   -0.0002
##    160        0.0087             nan     0.1000   -0.0001
##    180        0.0065             nan     0.1000   -0.0002
##    200        0.0047             nan     0.1000   -0.0002
##    220        0.0033             nan     0.1000   -0.0001
##    240        0.0025             nan     0.1000   -0.0000
##    260        0.0018             nan     0.1000   -0.0001
##    280        0.0013             nan     0.1000   -0.0000
##    300        0.0010             nan     0.1000   -0.0000
##    320        0.0008             nan     0.1000   -0.0000
##    340        0.0006             nan     0.1000   -0.0000
##    360        0.0004             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000    0.0000
##    500        0.0001             nan     0.1000    0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1384             nan     0.1000    0.0748
##      2        1.0172             nan     0.1000    0.0554
##      3        0.9119             nan     0.1000    0.0501
##      4        0.8252             nan     0.1000    0.0405
##      5        0.7552             nan     0.1000    0.0345
##      6        0.6944             nan     0.1000    0.0273
##      7        0.6340             nan     0.1000    0.0266
##      8        0.5883             nan     0.1000    0.0198
##      9        0.5441             nan     0.1000    0.0181
##     10        0.5037             nan     0.1000    0.0196
##     20        0.2750             nan     0.1000    0.0051
##     40        0.1137             nan     0.1000   -0.0003
##     60        0.0623             nan     0.1000   -0.0006
##     80        0.0393             nan     0.1000   -0.0004
##    100        0.0254             nan     0.1000   -0.0003
##    120        0.0166             nan     0.1000   -0.0002
##    140        0.0120             nan     0.1000   -0.0001
##    160        0.0088             nan     0.1000   -0.0001
##    180        0.0063             nan     0.1000   -0.0001
##    200        0.0050             nan     0.1000    0.0000
##    220        0.0039             nan     0.1000   -0.0001
##    240        0.0031             nan     0.1000   -0.0001
##    260        0.0026             nan     0.1000   -0.0001
##    280        0.0017             nan     0.1000   -0.0000
##    300        0.0012             nan     0.1000   -0.0000
##    320        0.0009             nan     0.1000   -0.0000
##    340        0.0007             nan     0.1000   -0.0000
##    360        0.0005             nan     0.1000   -0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1418             nan     0.1000    0.0772
##      2        1.0151             nan     0.1000    0.0588
##      3        0.9132             nan     0.1000    0.0535
##      4        0.8245             nan     0.1000    0.0420
##      5        0.7454             nan     0.1000    0.0350
##      6        0.6795             nan     0.1000    0.0312
##      7        0.6274             nan     0.1000    0.0251
##      8        0.5798             nan     0.1000    0.0201
##      9        0.5369             nan     0.1000    0.0193
##     10        0.5000             nan     0.1000    0.0148
##     20        0.2787             nan     0.1000    0.0050
##     40        0.1210             nan     0.1000   -0.0007
##     60        0.0626             nan     0.1000   -0.0007
##     80        0.0380             nan     0.1000   -0.0008
##    100        0.0244             nan     0.1000   -0.0003
##    120        0.0159             nan     0.1000   -0.0002
##    140        0.0103             nan     0.1000   -0.0000
##    160        0.0070             nan     0.1000   -0.0001
##    180        0.0052             nan     0.1000   -0.0000
##    200        0.0041             nan     0.1000   -0.0001
##    220        0.0031             nan     0.1000   -0.0000
##    240        0.0022             nan     0.1000    0.0000
##    260        0.0017             nan     0.1000   -0.0001
##    280        0.0014             nan     0.1000   -0.0000
##    300        0.0010             nan     0.1000   -0.0000
##    320        0.0006             nan     0.1000   -0.0000
##    340        0.0005             nan     0.1000   -0.0000
##    360        0.0004             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000    0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000    0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1613             nan     0.1000    0.0631
##      2        1.0553             nan     0.1000    0.0510
##      3        0.9610             nan     0.1000    0.0491
##      4        0.8846             nan     0.1000    0.0379
##      5        0.8118             nan     0.1000    0.0345
##      6        0.7602             nan     0.1000    0.0245
##      7        0.7073             nan     0.1000    0.0259
##      8        0.6631             nan     0.1000    0.0225
##      9        0.6241             nan     0.1000    0.0169
##     10        0.5903             nan     0.1000    0.0164
##     20        0.3839             nan     0.1000    0.0043
##     40        0.2482             nan     0.1000    0.0008
##     60        0.2035             nan     0.1000   -0.0009
##     80        0.1767             nan     0.1000   -0.0003
##    100        0.1626             nan     0.1000    0.0004
##    120        0.1486             nan     0.1000   -0.0009
##    140        0.1426             nan     0.1000   -0.0002
##    160        0.1389             nan     0.1000   -0.0010
##    180        0.1345             nan     0.1000   -0.0011
##    200        0.1262             nan     0.1000   -0.0007
##    220        0.1193             nan     0.1000   -0.0009
##    240        0.1166             nan     0.1000   -0.0002
##    260        0.1156             nan     0.1000   -0.0008
##    280        0.1151             nan     0.1000   -0.0015
##    300        0.1129             nan     0.1000   -0.0009
##    320        0.1111             nan     0.1000   -0.0013
##    340        0.1066             nan     0.1000   -0.0008
##    360        0.1035             nan     0.1000   -0.0016
##    380        0.1029             nan     0.1000   -0.0009
##    400        0.1000             nan     0.1000   -0.0002
##    420        0.0994             nan     0.1000   -0.0007
##    440        0.0972             nan     0.1000   -0.0006
##    460        0.0974             nan     0.1000   -0.0014
##    480        0.0961             nan     0.1000   -0.0011
##    500        0.0953             nan     0.1000   -0.0004
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1341             nan     0.1000    0.0735
##      2        1.0147             nan     0.1000    0.0594
##      3        0.9153             nan     0.1000    0.0488
##      4        0.8325             nan     0.1000    0.0409
##      5        0.7605             nan     0.1000    0.0346
##      6        0.7002             nan     0.1000    0.0284
##      7        0.6507             nan     0.1000    0.0236
##      8        0.6035             nan     0.1000    0.0231
##      9        0.5618             nan     0.1000    0.0187
##     10        0.5259             nan     0.1000    0.0148
##     20        0.3162             nan     0.1000    0.0028
##     40        0.1852             nan     0.1000   -0.0000
##     60        0.1503             nan     0.1000   -0.0000
##     80        0.1293             nan     0.1000   -0.0012
##    100        0.1066             nan     0.1000   -0.0009
##    120        0.0926             nan     0.1000   -0.0010
##    140        0.0817             nan     0.1000   -0.0011
##    160        0.0728             nan     0.1000   -0.0009
##    180        0.0664             nan     0.1000   -0.0001
##    200        0.0590             nan     0.1000   -0.0003
##    220        0.0516             nan     0.1000   -0.0004
##    240        0.0480             nan     0.1000   -0.0002
##    260        0.0440             nan     0.1000   -0.0001
##    280        0.0400             nan     0.1000   -0.0004
##    300        0.0354             nan     0.1000   -0.0003
##    320        0.0318             nan     0.1000   -0.0004
##    340        0.0286             nan     0.1000   -0.0003
##    360        0.0261             nan     0.1000   -0.0003
##    380        0.0233             nan     0.1000   -0.0002
##    400        0.0216             nan     0.1000   -0.0001
##    420        0.0196             nan     0.1000   -0.0001
##    440        0.0180             nan     0.1000   -0.0001
##    460        0.0162             nan     0.1000   -0.0001
##    480        0.0149             nan     0.1000   -0.0002
##    500        0.0137             nan     0.1000   -0.0002
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1365             nan     0.1000    0.0771
##      2        1.0119             nan     0.1000    0.0640
##      3        0.9063             nan     0.1000    0.0484
##      4        0.8232             nan     0.1000    0.0408
##      5        0.7521             nan     0.1000    0.0344
##      6        0.6930             nan     0.1000    0.0284
##      7        0.6384             nan     0.1000    0.0260
##      8        0.5884             nan     0.1000    0.0225
##      9        0.5428             nan     0.1000    0.0194
##     10        0.5065             nan     0.1000    0.0155
##     20        0.2874             nan     0.1000    0.0056
##     40        0.1529             nan     0.1000   -0.0008
##     60        0.1162             nan     0.1000   -0.0009
##     80        0.0887             nan     0.1000   -0.0001
##    100        0.0655             nan     0.1000   -0.0007
##    120        0.0539             nan     0.1000   -0.0004
##    140        0.0433             nan     0.1000    0.0000
##    160        0.0355             nan     0.1000   -0.0003
##    180        0.0282             nan     0.1000   -0.0004
##    200        0.0229             nan     0.1000   -0.0001
##    220        0.0195             nan     0.1000   -0.0002
##    240        0.0165             nan     0.1000   -0.0001
##    260        0.0143             nan     0.1000    0.0000
##    280        0.0122             nan     0.1000   -0.0002
##    300        0.0101             nan     0.1000   -0.0001
##    320        0.0086             nan     0.1000   -0.0001
##    340        0.0074             nan     0.1000   -0.0000
##    360        0.0065             nan     0.1000   -0.0001
##    380        0.0058             nan     0.1000   -0.0001
##    400        0.0048             nan     0.1000   -0.0001
##    420        0.0042             nan     0.1000   -0.0000
##    440        0.0035             nan     0.1000   -0.0000
##    460        0.0030             nan     0.1000   -0.0000
##    480        0.0025             nan     0.1000   -0.0000
##    500        0.0022             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1443             nan     0.1000    0.0686
##      2        1.0217             nan     0.1000    0.0564
##      3        0.9226             nan     0.1000    0.0481
##      4        0.8398             nan     0.1000    0.0394
##      5        0.7634             nan     0.1000    0.0355
##      6        0.6985             nan     0.1000    0.0307
##      7        0.6452             nan     0.1000    0.0234
##      8        0.5899             nan     0.1000    0.0239
##      9        0.5491             nan     0.1000    0.0182
##     10        0.5111             nan     0.1000    0.0179
##     20        0.2888             nan     0.1000    0.0043
##     40        0.1428             nan     0.1000    0.0002
##     60        0.0908             nan     0.1000   -0.0009
##     80        0.0648             nan     0.1000   -0.0009
##    100        0.0478             nan     0.1000   -0.0001
##    120        0.0383             nan     0.1000   -0.0003
##    140        0.0315             nan     0.1000   -0.0004
##    160        0.0258             nan     0.1000   -0.0004
##    180        0.0197             nan     0.1000   -0.0002
##    200        0.0155             nan     0.1000   -0.0002
##    220        0.0119             nan     0.1000   -0.0001
##    240        0.0098             nan     0.1000   -0.0002
##    260        0.0076             nan     0.1000   -0.0001
##    280        0.0060             nan     0.1000   -0.0001
##    300        0.0048             nan     0.1000   -0.0000
##    320        0.0040             nan     0.1000   -0.0000
##    340        0.0033             nan     0.1000   -0.0000
##    360        0.0027             nan     0.1000   -0.0000
##    380        0.0023             nan     0.1000   -0.0000
##    400        0.0020             nan     0.1000   -0.0000
##    420        0.0017             nan     0.1000   -0.0000
##    440        0.0014             nan     0.1000   -0.0000
##    460        0.0011             nan     0.1000   -0.0000
##    480        0.0010             nan     0.1000   -0.0000
##    500        0.0008             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1342             nan     0.1000    0.0735
##      2        1.0106             nan     0.1000    0.0598
##      3        0.9114             nan     0.1000    0.0471
##      4        0.8277             nan     0.1000    0.0376
##      5        0.7512             nan     0.1000    0.0386
##      6        0.6900             nan     0.1000    0.0307
##      7        0.6334             nan     0.1000    0.0289
##      8        0.5860             nan     0.1000    0.0208
##      9        0.5392             nan     0.1000    0.0214
##     10        0.4993             nan     0.1000    0.0174
##     20        0.2732             nan     0.1000    0.0034
##     40        0.1196             nan     0.1000    0.0007
##     60        0.0730             nan     0.1000   -0.0007
##     80        0.0508             nan     0.1000   -0.0003
##    100        0.0347             nan     0.1000   -0.0007
##    120        0.0249             nan     0.1000   -0.0003
##    140        0.0181             nan     0.1000   -0.0001
##    160        0.0148             nan     0.1000   -0.0002
##    180        0.0108             nan     0.1000    0.0000
##    200        0.0084             nan     0.1000   -0.0000
##    220        0.0065             nan     0.1000   -0.0000
##    240        0.0048             nan     0.1000   -0.0000
##    260        0.0038             nan     0.1000   -0.0000
##    280        0.0029             nan     0.1000   -0.0001
##    300        0.0021             nan     0.1000   -0.0000
##    320        0.0016             nan     0.1000   -0.0000
##    340        0.0012             nan     0.1000   -0.0000
##    360        0.0009             nan     0.1000   -0.0000
##    380        0.0007             nan     0.1000   -0.0000
##    400        0.0006             nan     0.1000   -0.0000
##    420        0.0004             nan     0.1000   -0.0000
##    440        0.0004             nan     0.1000   -0.0000
##    460        0.0003             nan     0.1000   -0.0000
##    480        0.0002             nan     0.1000   -0.0000
##    500        0.0002             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1350             nan     0.1000    0.0694
##      2        1.0050             nan     0.1000    0.0577
##      3        0.8994             nan     0.1000    0.0495
##      4        0.8119             nan     0.1000    0.0426
##      5        0.7375             nan     0.1000    0.0339
##      6        0.6715             nan     0.1000    0.0317
##      7        0.6141             nan     0.1000    0.0227
##      8        0.5620             nan     0.1000    0.0233
##      9        0.5169             nan     0.1000    0.0189
##     10        0.4821             nan     0.1000    0.0141
##     20        0.2603             nan     0.1000    0.0030
##     40        0.1199             nan     0.1000   -0.0004
##     60        0.0717             nan     0.1000   -0.0008
##     80        0.0460             nan     0.1000   -0.0003
##    100        0.0302             nan     0.1000   -0.0000
##    120        0.0211             nan     0.1000   -0.0002
##    140        0.0151             nan     0.1000   -0.0001
##    160        0.0103             nan     0.1000   -0.0001
##    180        0.0076             nan     0.1000   -0.0001
##    200        0.0054             nan     0.1000   -0.0000
##    220        0.0039             nan     0.1000   -0.0000
##    240        0.0030             nan     0.1000   -0.0000
##    260        0.0023             nan     0.1000   -0.0000
##    280        0.0018             nan     0.1000   -0.0000
##    300        0.0015             nan     0.1000   -0.0000
##    320        0.0010             nan     0.1000   -0.0000
##    340        0.0008             nan     0.1000   -0.0000
##    360        0.0006             nan     0.1000   -0.0000
##    380        0.0005             nan     0.1000    0.0000
##    400        0.0004             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1295             nan     0.1000    0.0729
##      2        1.0012             nan     0.1000    0.0631
##      3        0.9023             nan     0.1000    0.0466
##      4        0.8165             nan     0.1000    0.0402
##      5        0.7436             nan     0.1000    0.0366
##      6        0.6826             nan     0.1000    0.0285
##      7        0.6324             nan     0.1000    0.0207
##      8        0.5845             nan     0.1000    0.0211
##      9        0.5399             nan     0.1000    0.0185
##     10        0.5006             nan     0.1000    0.0147
##     20        0.2691             nan     0.1000    0.0029
##     40        0.1089             nan     0.1000   -0.0010
##     60        0.0600             nan     0.1000   -0.0004
##     80        0.0380             nan     0.1000   -0.0007
##    100        0.0255             nan     0.1000   -0.0004
##    120        0.0172             nan     0.1000   -0.0004
##    140        0.0126             nan     0.1000   -0.0001
##    160        0.0085             nan     0.1000   -0.0001
##    180        0.0054             nan     0.1000   -0.0001
##    200        0.0039             nan     0.1000   -0.0001
##    220        0.0028             nan     0.1000   -0.0000
##    240        0.0020             nan     0.1000   -0.0000
##    260        0.0014             nan     0.1000   -0.0000
##    280        0.0012             nan     0.1000   -0.0000
##    300        0.0009             nan     0.1000   -0.0000
##    320        0.0008             nan     0.1000   -0.0000
##    340        0.0006             nan     0.1000    0.0000
##    360        0.0005             nan     0.1000   -0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000    0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1288             nan     0.1000    0.0711
##      2        1.0064             nan     0.1000    0.0595
##      3        0.9036             nan     0.1000    0.0466
##      4        0.8216             nan     0.1000    0.0395
##      5        0.7497             nan     0.1000    0.0338
##      6        0.6853             nan     0.1000    0.0284
##      7        0.6341             nan     0.1000    0.0236
##      8        0.5861             nan     0.1000    0.0214
##      9        0.5443             nan     0.1000    0.0190
##     10        0.5053             nan     0.1000    0.0170
##     20        0.2653             nan     0.1000    0.0067
##     40        0.1101             nan     0.1000    0.0014
##     60        0.0583             nan     0.1000   -0.0004
##     80        0.0371             nan     0.1000   -0.0003
##    100        0.0274             nan     0.1000   -0.0003
##    120        0.0179             nan     0.1000   -0.0003
##    140        0.0133             nan     0.1000   -0.0002
##    160        0.0102             nan     0.1000   -0.0001
##    180        0.0073             nan     0.1000   -0.0002
##    200        0.0051             nan     0.1000   -0.0000
##    220        0.0043             nan     0.1000   -0.0001
##    240        0.0031             nan     0.1000   -0.0000
##    260        0.0024             nan     0.1000   -0.0000
##    280        0.0021             nan     0.1000   -0.0000
##    300        0.0017             nan     0.1000   -0.0001
##    320        0.0012             nan     0.1000   -0.0000
##    340        0.0010             nan     0.1000   -0.0000
##    360        0.0008             nan     0.1000   -0.0000
##    380        0.0005             nan     0.1000   -0.0000
##    400        0.0004             nan     0.1000   -0.0000
##    420        0.0004             nan     0.1000   -0.0000
##    440        0.0003             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0002             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1353             nan     0.1000    0.0754
##      2        1.0182             nan     0.1000    0.0578
##      3        0.9152             nan     0.1000    0.0484
##      4        0.8254             nan     0.1000    0.0396
##      5        0.7535             nan     0.1000    0.0332
##      6        0.6910             nan     0.1000    0.0289
##      7        0.6294             nan     0.1000    0.0286
##      8        0.5823             nan     0.1000    0.0216
##      9        0.5372             nan     0.1000    0.0188
##     10        0.4969             nan     0.1000    0.0176
##     20        0.2674             nan     0.1000    0.0038
##     40        0.1080             nan     0.1000    0.0004
##     60        0.0596             nan     0.1000   -0.0003
##     80        0.0413             nan     0.1000   -0.0005
##    100        0.0250             nan     0.1000   -0.0003
##    120        0.0189             nan     0.1000   -0.0003
##    140        0.0142             nan     0.1000   -0.0003
##    160        0.0100             nan     0.1000   -0.0003
##    180        0.0068             nan     0.1000   -0.0003
##    200        0.0043             nan     0.1000   -0.0001
##    220        0.0028             nan     0.1000   -0.0000
##    240        0.0023             nan     0.1000   -0.0001
##    260        0.0016             nan     0.1000   -0.0000
##    280        0.0015             nan     0.1000   -0.0001
##    300        0.0012             nan     0.1000   -0.0001
##    320        0.0010             nan     0.1000   -0.0000
##    340        0.0010             nan     0.1000   -0.0001
##    360        0.0007             nan     0.1000   -0.0000
##    380        0.0005             nan     0.1000   -0.0000
##    400        0.0004             nan     0.1000    0.0000
##    420        0.0003             nan     0.1000    0.0000
##    440        0.0002             nan     0.1000    0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1309             nan     0.1000    0.0724
##      2        1.0101             nan     0.1000    0.0554
##      3        0.9140             nan     0.1000    0.0448
##      4        0.8287             nan     0.1000    0.0393
##      5        0.7571             nan     0.1000    0.0311
##      6        0.6957             nan     0.1000    0.0269
##      7        0.6418             nan     0.1000    0.0244
##      8        0.5889             nan     0.1000    0.0223
##      9        0.5438             nan     0.1000    0.0203
##     10        0.5068             nan     0.1000    0.0163
##     20        0.2685             nan     0.1000    0.0058
##     40        0.1141             nan     0.1000   -0.0003
##     60        0.0593             nan     0.1000   -0.0003
##     80        0.0346             nan     0.1000   -0.0002
##    100        0.0226             nan     0.1000   -0.0005
##    120        0.0138             nan     0.1000   -0.0002
##    140        0.0095             nan     0.1000   -0.0002
##    160        0.0066             nan     0.1000   -0.0001
##    180        0.0050             nan     0.1000    0.0000
##    200        0.0032             nan     0.1000   -0.0000
##    220        0.0024             nan     0.1000   -0.0001
##    240        0.0021             nan     0.1000   -0.0001
##    260        0.0014             nan     0.1000   -0.0000
##    280        0.0012             nan     0.1000   -0.0001
##    300        0.0009             nan     0.1000   -0.0000
##    320        0.0007             nan     0.1000   -0.0000
##    340        0.0005             nan     0.1000   -0.0000
##    360        0.0005             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000    0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1529             nan     0.1000    0.0627
##      2        1.0422             nan     0.1000    0.0535
##      3        0.9454             nan     0.1000    0.0485
##      4        0.8647             nan     0.1000    0.0404
##      5        0.7992             nan     0.1000    0.0333
##      6        0.7419             nan     0.1000    0.0277
##      7        0.6939             nan     0.1000    0.0234
##      8        0.6501             nan     0.1000    0.0194
##      9        0.6073             nan     0.1000    0.0196
##     10        0.5718             nan     0.1000    0.0159
##     20        0.3715             nan     0.1000    0.0055
##     40        0.2363             nan     0.1000   -0.0002
##     60        0.1844             nan     0.1000    0.0010
##     80        0.1610             nan     0.1000   -0.0006
##    100        0.1447             nan     0.1000   -0.0011
##    120        0.1332             nan     0.1000   -0.0023
##    140        0.1238             nan     0.1000   -0.0004
##    160        0.1191             nan     0.1000   -0.0006
##    180        0.1098             nan     0.1000   -0.0008
##    200        0.1033             nan     0.1000   -0.0010
##    220        0.0996             nan     0.1000   -0.0010
##    240        0.0944             nan     0.1000   -0.0007
##    260        0.0917             nan     0.1000   -0.0009
##    280        0.0882             nan     0.1000   -0.0005
##    300        0.0846             nan     0.1000   -0.0008
##    320        0.0837             nan     0.1000   -0.0003
##    340        0.0824             nan     0.1000   -0.0008
##    360        0.0803             nan     0.1000   -0.0005
##    380        0.0788             nan     0.1000   -0.0008
##    400        0.0775             nan     0.1000   -0.0011
##    420        0.0755             nan     0.1000   -0.0011
##    440        0.0749             nan     0.1000   -0.0007
##    460        0.0742             nan     0.1000   -0.0002
##    480        0.0727             nan     0.1000   -0.0004
##    500        0.0719             nan     0.1000   -0.0003
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1456             nan     0.1000    0.0697
##      2        1.0206             nan     0.1000    0.0677
##      3        0.9204             nan     0.1000    0.0506
##      4        0.8354             nan     0.1000    0.0393
##      5        0.7583             nan     0.1000    0.0349
##      6        0.6986             nan     0.1000    0.0282
##      7        0.6396             nan     0.1000    0.0269
##      8        0.5938             nan     0.1000    0.0225
##      9        0.5520             nan     0.1000    0.0188
##     10        0.5137             nan     0.1000    0.0158
##     20        0.2915             nan     0.1000    0.0064
##     40        0.1801             nan     0.1000   -0.0004
##     60        0.1383             nan     0.1000   -0.0005
##     80        0.1124             nan     0.1000   -0.0012
##    100        0.0907             nan     0.1000   -0.0005
##    120        0.0772             nan     0.1000   -0.0005
##    140        0.0662             nan     0.1000   -0.0007
##    160        0.0567             nan     0.1000   -0.0007
##    180        0.0497             nan     0.1000   -0.0005
##    200        0.0447             nan     0.1000   -0.0004
##    220        0.0395             nan     0.1000   -0.0002
##    240        0.0353             nan     0.1000   -0.0002
##    260        0.0334             nan     0.1000   -0.0007
##    280        0.0294             nan     0.1000   -0.0001
##    300        0.0273             nan     0.1000   -0.0004
##    320        0.0245             nan     0.1000   -0.0000
##    340        0.0221             nan     0.1000   -0.0002
##    360        0.0202             nan     0.1000   -0.0003
##    380        0.0186             nan     0.1000   -0.0003
##    400        0.0169             nan     0.1000   -0.0003
##    420        0.0158             nan     0.1000   -0.0002
##    440        0.0147             nan     0.1000   -0.0001
##    460        0.0133             nan     0.1000   -0.0001
##    480        0.0121             nan     0.1000   -0.0001
##    500        0.0109             nan     0.1000   -0.0001
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1408             nan     0.1000    0.0641
##      2        1.0134             nan     0.1000    0.0611
##      3        0.9112             nan     0.1000    0.0464
##      4        0.8236             nan     0.1000    0.0396
##      5        0.7548             nan     0.1000    0.0329
##      6        0.6926             nan     0.1000    0.0305
##      7        0.6403             nan     0.1000    0.0239
##      8        0.5918             nan     0.1000    0.0219
##      9        0.5494             nan     0.1000    0.0190
##     10        0.5128             nan     0.1000    0.0175
##     20        0.2863             nan     0.1000    0.0054
##     40        0.1454             nan     0.1000    0.0003
##     60        0.0979             nan     0.1000    0.0003
##     80        0.0733             nan     0.1000   -0.0006
##    100        0.0575             nan     0.1000   -0.0004
##    120        0.0460             nan     0.1000   -0.0000
##    140        0.0362             nan     0.1000   -0.0002
##    160        0.0291             nan     0.1000   -0.0002
##    180        0.0257             nan     0.1000   -0.0005
##    200        0.0212             nan     0.1000   -0.0001
##    220        0.0182             nan     0.1000   -0.0001
##    240        0.0155             nan     0.1000   -0.0001
##    260        0.0128             nan     0.1000   -0.0001
##    280        0.0112             nan     0.1000   -0.0001
##    300        0.0092             nan     0.1000   -0.0002
##    320        0.0079             nan     0.1000   -0.0000
##    340        0.0068             nan     0.1000   -0.0001
##    360        0.0059             nan     0.1000   -0.0000
##    380        0.0052             nan     0.1000   -0.0000
##    400        0.0044             nan     0.1000   -0.0000
##    420        0.0037             nan     0.1000   -0.0000
##    440        0.0031             nan     0.1000   -0.0000
##    460        0.0027             nan     0.1000   -0.0000
##    480        0.0023             nan     0.1000   -0.0000
##    500        0.0020             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1331             nan     0.1000    0.0773
##      2        1.0115             nan     0.1000    0.0621
##      3        0.9083             nan     0.1000    0.0462
##      4        0.8296             nan     0.1000    0.0383
##      5        0.7528             nan     0.1000    0.0336
##      6        0.6892             nan     0.1000    0.0276
##      7        0.6321             nan     0.1000    0.0264
##      8        0.5801             nan     0.1000    0.0243
##      9        0.5341             nan     0.1000    0.0199
##     10        0.4957             nan     0.1000    0.0182
##     20        0.2819             nan     0.1000    0.0022
##     40        0.1394             nan     0.1000    0.0002
##     60        0.0964             nan     0.1000   -0.0000
##     80        0.0651             nan     0.1000   -0.0006
##    100        0.0470             nan     0.1000   -0.0007
##    120        0.0363             nan     0.1000   -0.0002
##    140        0.0293             nan     0.1000   -0.0004
##    160        0.0220             nan     0.1000   -0.0001
##    180        0.0178             nan     0.1000   -0.0001
##    200        0.0131             nan     0.1000   -0.0001
##    220        0.0102             nan     0.1000   -0.0001
##    240        0.0081             nan     0.1000   -0.0001
##    260        0.0071             nan     0.1000   -0.0001
##    280        0.0058             nan     0.1000   -0.0001
##    300        0.0048             nan     0.1000   -0.0001
##    320        0.0038             nan     0.1000   -0.0000
##    340        0.0031             nan     0.1000   -0.0000
##    360        0.0025             nan     0.1000   -0.0000
##    380        0.0019             nan     0.1000   -0.0000
##    400        0.0015             nan     0.1000   -0.0000
##    420        0.0012             nan     0.1000   -0.0000
##    440        0.0009             nan     0.1000   -0.0000
##    460        0.0008             nan     0.1000   -0.0000
##    480        0.0006             nan     0.1000   -0.0000
##    500        0.0005             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1344             nan     0.1000    0.0733
##      2        1.0068             nan     0.1000    0.0618
##      3        0.9027             nan     0.1000    0.0506
##      4        0.8130             nan     0.1000    0.0403
##      5        0.7384             nan     0.1000    0.0360
##      6        0.6727             nan     0.1000    0.0301
##      7        0.6138             nan     0.1000    0.0271
##      8        0.5677             nan     0.1000    0.0197
##      9        0.5251             nan     0.1000    0.0179
##     10        0.4852             nan     0.1000    0.0189
##     20        0.2666             nan     0.1000    0.0063
##     40        0.1235             nan     0.1000    0.0005
##     60        0.0726             nan     0.1000   -0.0012
##     80        0.0447             nan     0.1000   -0.0005
##    100        0.0312             nan     0.1000    0.0004
##    120        0.0227             nan     0.1000   -0.0004
##    140        0.0171             nan     0.1000   -0.0001
##    160        0.0126             nan     0.1000   -0.0000
##    180        0.0090             nan     0.1000   -0.0001
##    200        0.0069             nan     0.1000   -0.0000
##    220        0.0052             nan     0.1000   -0.0000
##    240        0.0038             nan     0.1000   -0.0001
##    260        0.0029             nan     0.1000   -0.0000
##    280        0.0022             nan     0.1000   -0.0001
##    300        0.0017             nan     0.1000   -0.0000
##    320        0.0013             nan     0.1000   -0.0000
##    340        0.0010             nan     0.1000   -0.0000
##    360        0.0007             nan     0.1000   -0.0000
##    380        0.0005             nan     0.1000   -0.0000
##    400        0.0004             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1342             nan     0.1000    0.0749
##      2        1.0105             nan     0.1000    0.0593
##      3        0.9092             nan     0.1000    0.0485
##      4        0.8211             nan     0.1000    0.0415
##      5        0.7409             nan     0.1000    0.0383
##      6        0.6751             nan     0.1000    0.0316
##      7        0.6194             nan     0.1000    0.0272
##      8        0.5717             nan     0.1000    0.0219
##      9        0.5278             nan     0.1000    0.0193
##     10        0.4933             nan     0.1000    0.0161
##     20        0.2610             nan     0.1000    0.0042
##     40        0.1180             nan     0.1000   -0.0014
##     60        0.0707             nan     0.1000    0.0003
##     80        0.0417             nan     0.1000   -0.0004
##    100        0.0278             nan     0.1000   -0.0002
##    120        0.0194             nan     0.1000   -0.0004
##    140        0.0132             nan     0.1000   -0.0003
##    160        0.0090             nan     0.1000   -0.0001
##    180        0.0073             nan     0.1000   -0.0002
##    200        0.0054             nan     0.1000   -0.0001
##    220        0.0040             nan     0.1000   -0.0001
##    240        0.0031             nan     0.1000   -0.0000
##    260        0.0023             nan     0.1000   -0.0001
##    280        0.0016             nan     0.1000   -0.0000
##    300        0.0011             nan     0.1000   -0.0000
##    320        0.0009             nan     0.1000   -0.0000
##    340        0.0008             nan     0.1000   -0.0000
##    360        0.0006             nan     0.1000   -0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000    0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1331             nan     0.1000    0.0715
##      2        1.0134             nan     0.1000    0.0589
##      3        0.9154             nan     0.1000    0.0447
##      4        0.8226             nan     0.1000    0.0399
##      5        0.7490             nan     0.1000    0.0339
##      6        0.6845             nan     0.1000    0.0295
##      7        0.6301             nan     0.1000    0.0246
##      8        0.5820             nan     0.1000    0.0215
##      9        0.5374             nan     0.1000    0.0210
##     10        0.4973             nan     0.1000    0.0172
##     20        0.2622             nan     0.1000    0.0058
##     40        0.1177             nan     0.1000    0.0003
##     60        0.0666             nan     0.1000   -0.0000
##     80        0.0432             nan     0.1000   -0.0008
##    100        0.0294             nan     0.1000   -0.0005
##    120        0.0182             nan     0.1000   -0.0002
##    140        0.0135             nan     0.1000   -0.0003
##    160        0.0086             nan     0.1000   -0.0001
##    180        0.0062             nan     0.1000   -0.0002
##    200        0.0041             nan     0.1000   -0.0001
##    220        0.0034             nan     0.1000   -0.0000
##    240        0.0026             nan     0.1000   -0.0000
##    260        0.0018             nan     0.1000   -0.0000
##    280        0.0014             nan     0.1000   -0.0000
##    300        0.0010             nan     0.1000   -0.0000
##    320        0.0008             nan     0.1000   -0.0000
##    340        0.0006             nan     0.1000   -0.0000
##    360        0.0004             nan     0.1000   -0.0000
##    380        0.0005             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000    0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0004             nan     0.1000   -0.0000
##    460        0.0003             nan     0.1000   -0.0000
##    480        0.0003             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000    0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1238             nan     0.1000    0.0828
##      2        0.9975             nan     0.1000    0.0631
##      3        0.8940             nan     0.1000    0.0481
##      4        0.8043             nan     0.1000    0.0428
##      5        0.7331             nan     0.1000    0.0340
##      6        0.6656             nan     0.1000    0.0311
##      7        0.6098             nan     0.1000    0.0245
##      8        0.5658             nan     0.1000    0.0184
##      9        0.5238             nan     0.1000    0.0195
##     10        0.4835             nan     0.1000    0.0187
##     20        0.2530             nan     0.1000    0.0051
##     40        0.0976             nan     0.1000    0.0005
##     60        0.0491             nan     0.1000   -0.0006
##     80        0.0294             nan     0.1000   -0.0001
##    100        0.0203             nan     0.1000   -0.0002
##    120        0.0145             nan     0.1000   -0.0002
##    140        0.0103             nan     0.1000   -0.0000
##    160        0.0074             nan     0.1000   -0.0002
##    180        0.0047             nan     0.1000   -0.0001
##    200        0.0030             nan     0.1000   -0.0000
##    220        0.0024             nan     0.1000   -0.0000
##    240        0.0018             nan     0.1000   -0.0001
##    260        0.0013             nan     0.1000   -0.0000
##    280        0.0009             nan     0.1000   -0.0000
##    300        0.0008             nan     0.1000   -0.0000
##    320        0.0006             nan     0.1000    0.0000
##    340        0.0004             nan     0.1000   -0.0000
##    360        0.0003             nan     0.1000   -0.0000
##    380        0.0002             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000    0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1292             nan     0.1000    0.0808
##      2        1.0022             nan     0.1000    0.0586
##      3        0.9062             nan     0.1000    0.0442
##      4        0.8209             nan     0.1000    0.0405
##      5        0.7440             nan     0.1000    0.0389
##      6        0.6795             nan     0.1000    0.0309
##      7        0.6248             nan     0.1000    0.0254
##      8        0.5780             nan     0.1000    0.0204
##      9        0.5304             nan     0.1000    0.0233
##     10        0.4938             nan     0.1000    0.0153
##     20        0.2587             nan     0.1000    0.0049
##     40        0.1005             nan     0.1000    0.0003
##     60        0.0533             nan     0.1000   -0.0006
##     80        0.0330             nan     0.1000   -0.0005
##    100        0.0228             nan     0.1000   -0.0004
##    120        0.0142             nan     0.1000   -0.0002
##    140        0.0119             nan     0.1000   -0.0003
##    160        0.0085             nan     0.1000    0.0000
##    180        0.0064             nan     0.1000   -0.0002
##    200        0.0044             nan     0.1000   -0.0000
##    220        0.0030             nan     0.1000   -0.0001
##    240        0.0021             nan     0.1000   -0.0000
##    260        0.0015             nan     0.1000   -0.0000
##    280        0.0012             nan     0.1000   -0.0000
##    300        0.0010             nan     0.1000   -0.0000
##    320        0.0007             nan     0.1000   -0.0000
##    340        0.0005             nan     0.1000    0.0000
##    360        0.0003             nan     0.1000   -0.0000
##    380        0.0002             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0001             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0000             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1386             nan     0.1000    0.0720
##      2        1.0105             nan     0.1000    0.0640
##      3        0.9058             nan     0.1000    0.0494
##      4        0.8200             nan     0.1000    0.0398
##      5        0.7404             nan     0.1000    0.0357
##      6        0.6755             nan     0.1000    0.0294
##      7        0.6220             nan     0.1000    0.0244
##      8        0.5690             nan     0.1000    0.0249
##      9        0.5253             nan     0.1000    0.0178
##     10        0.4900             nan     0.1000    0.0156
##     20        0.2620             nan     0.1000    0.0050
##     40        0.1074             nan     0.1000   -0.0005
##     60        0.0537             nan     0.1000   -0.0009
##     80        0.0348             nan     0.1000   -0.0001
##    100        0.0222             nan     0.1000   -0.0004
##    120        0.0158             nan     0.1000   -0.0002
##    140        0.0109             nan     0.1000   -0.0003
##    160        0.0084             nan     0.1000   -0.0002
##    180        0.0067             nan     0.1000   -0.0001
##    200        0.0060             nan     0.1000   -0.0002
##    220        0.0040             nan     0.1000   -0.0000
##    240        0.0033             nan     0.1000   -0.0001
##    260        0.0026             nan     0.1000   -0.0000
##    280        0.0017             nan     0.1000   -0.0000
##    300        0.0013             nan     0.1000   -0.0000
##    320        0.0011             nan     0.1000   -0.0000
##    340        0.0009             nan     0.1000   -0.0000
##    360        0.0008             nan     0.1000   -0.0000
##    380        0.0006             nan     0.1000   -0.0000
##    400        0.0005             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0003             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0002             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1522             nan     0.1000    0.0678
##      2        1.0417             nan     0.1000    0.0503
##      3        0.9464             nan     0.1000    0.0455
##      4        0.8631             nan     0.1000    0.0418
##      5        0.7950             nan     0.1000    0.0337
##      6        0.7381             nan     0.1000    0.0270
##      7        0.6856             nan     0.1000    0.0255
##      8        0.6401             nan     0.1000    0.0194
##      9        0.6049             nan     0.1000    0.0181
##     10        0.5647             nan     0.1000    0.0180
##     20        0.3614             nan     0.1000    0.0060
##     40        0.2206             nan     0.1000    0.0012
##     60        0.1815             nan     0.1000   -0.0008
##     80        0.1564             nan     0.1000   -0.0007
##    100        0.1428             nan     0.1000   -0.0006
##    120        0.1333             nan     0.1000   -0.0008
##    140        0.1276             nan     0.1000   -0.0010
##    160        0.1182             nan     0.1000   -0.0008
##    180        0.1096             nan     0.1000   -0.0001
##    200        0.1060             nan     0.1000   -0.0009
##    220        0.1010             nan     0.1000   -0.0007
##    240        0.0976             nan     0.1000   -0.0005
##    260        0.0956             nan     0.1000   -0.0003
##    280        0.0942             nan     0.1000   -0.0001
##    300        0.0911             nan     0.1000   -0.0007
##    320        0.0882             nan     0.1000   -0.0005
##    340        0.0870             nan     0.1000   -0.0006
##    360        0.0854             nan     0.1000   -0.0007
##    380        0.0841             nan     0.1000   -0.0007
##    400        0.0828             nan     0.1000   -0.0007
##    420        0.0814             nan     0.1000   -0.0006
##    440        0.0803             nan     0.1000   -0.0003
##    460        0.0782             nan     0.1000   -0.0005
##    480        0.0763             nan     0.1000   -0.0004
##    500        0.0763             nan     0.1000   -0.0011
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1353             nan     0.1000    0.0730
##      2        1.0175             nan     0.1000    0.0620
##      3        0.9192             nan     0.1000    0.0481
##      4        0.8336             nan     0.1000    0.0414
##      5        0.7661             nan     0.1000    0.0334
##      6        0.7064             nan     0.1000    0.0265
##      7        0.6485             nan     0.1000    0.0275
##      8        0.5948             nan     0.1000    0.0240
##      9        0.5526             nan     0.1000    0.0195
##     10        0.5177             nan     0.1000    0.0157
##     20        0.2948             nan     0.1000    0.0053
##     40        0.1691             nan     0.1000   -0.0021
##     60        0.1304             nan     0.1000   -0.0006
##     80        0.1128             nan     0.1000   -0.0007
##    100        0.0921             nan     0.1000   -0.0009
##    120        0.0800             nan     0.1000   -0.0004
##    140        0.0682             nan     0.1000   -0.0002
##    160        0.0598             nan     0.1000   -0.0004
##    180        0.0556             nan     0.1000   -0.0006
##    200        0.0489             nan     0.1000   -0.0005
##    220        0.0437             nan     0.1000   -0.0001
##    240        0.0416             nan     0.1000   -0.0003
##    260        0.0377             nan     0.1000   -0.0004
##    280        0.0325             nan     0.1000   -0.0002
##    300        0.0307             nan     0.1000   -0.0002
##    320        0.0280             nan     0.1000   -0.0003
##    340        0.0260             nan     0.1000   -0.0003
##    360        0.0242             nan     0.1000   -0.0000
##    380        0.0215             nan     0.1000   -0.0002
##    400        0.0195             nan     0.1000   -0.0002
##    420        0.0178             nan     0.1000   -0.0001
##    440        0.0166             nan     0.1000   -0.0002
##    460        0.0151             nan     0.1000   -0.0000
##    480        0.0137             nan     0.1000   -0.0000
##    500        0.0127             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1341             nan     0.1000    0.0725
##      2        1.0093             nan     0.1000    0.0586
##      3        0.9047             nan     0.1000    0.0492
##      4        0.8189             nan     0.1000    0.0427
##      5        0.7469             nan     0.1000    0.0361
##      6        0.6816             nan     0.1000    0.0331
##      7        0.6232             nan     0.1000    0.0275
##      8        0.5757             nan     0.1000    0.0221
##      9        0.5318             nan     0.1000    0.0190
##     10        0.4966             nan     0.1000    0.0158
##     20        0.2699             nan     0.1000    0.0055
##     40        0.1396             nan     0.1000   -0.0002
##     60        0.0968             nan     0.1000    0.0002
##     80        0.0775             nan     0.1000   -0.0006
##    100        0.0617             nan     0.1000   -0.0008
##    120        0.0482             nan     0.1000   -0.0009
##    140        0.0378             nan     0.1000   -0.0003
##    160        0.0305             nan     0.1000   -0.0004
##    180        0.0265             nan     0.1000   -0.0001
##    200        0.0219             nan     0.1000   -0.0003
##    220        0.0176             nan     0.1000   -0.0001
##    240        0.0145             nan     0.1000   -0.0001
##    260        0.0122             nan     0.1000   -0.0001
##    280        0.0105             nan     0.1000   -0.0001
##    300        0.0091             nan     0.1000   -0.0001
##    320        0.0075             nan     0.1000   -0.0001
##    340        0.0066             nan     0.1000   -0.0000
##    360        0.0060             nan     0.1000   -0.0001
##    380        0.0051             nan     0.1000   -0.0001
##    400        0.0043             nan     0.1000   -0.0001
##    420        0.0036             nan     0.1000   -0.0000
##    440        0.0031             nan     0.1000   -0.0000
##    460        0.0028             nan     0.1000   -0.0000
##    480        0.0023             nan     0.1000   -0.0000
##    500        0.0021             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1324             nan     0.1000    0.0750
##      2        1.0074             nan     0.1000    0.0583
##      3        0.9005             nan     0.1000    0.0509
##      4        0.8152             nan     0.1000    0.0404
##      5        0.7381             nan     0.1000    0.0361
##      6        0.6761             nan     0.1000    0.0296
##      7        0.6209             nan     0.1000    0.0249
##      8        0.5718             nan     0.1000    0.0221
##      9        0.5315             nan     0.1000    0.0162
##     10        0.4942             nan     0.1000    0.0164
##     20        0.2736             nan     0.1000    0.0041
##     40        0.1291             nan     0.1000    0.0010
##     60        0.0841             nan     0.1000   -0.0013
##     80        0.0595             nan     0.1000   -0.0007
##    100        0.0434             nan     0.1000   -0.0004
##    120        0.0343             nan     0.1000   -0.0005
##    140        0.0267             nan     0.1000   -0.0002
##    160        0.0209             nan     0.1000   -0.0004
##    180        0.0169             nan     0.1000   -0.0003
##    200        0.0134             nan     0.1000   -0.0002
##    220        0.0107             nan     0.1000   -0.0001
##    240        0.0086             nan     0.1000   -0.0001
##    260        0.0066             nan     0.1000   -0.0001
##    280        0.0054             nan     0.1000   -0.0000
##    300        0.0044             nan     0.1000   -0.0000
##    320        0.0035             nan     0.1000   -0.0000
##    340        0.0028             nan     0.1000   -0.0000
##    360        0.0023             nan     0.1000   -0.0000
##    380        0.0018             nan     0.1000   -0.0000
##    400        0.0015             nan     0.1000   -0.0000
##    420        0.0012             nan     0.1000   -0.0000
##    440        0.0011             nan     0.1000   -0.0000
##    460        0.0008             nan     0.1000   -0.0000
##    480        0.0007             nan     0.1000   -0.0000
##    500        0.0005             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1259             nan     0.1000    0.0782
##      2        1.0025             nan     0.1000    0.0620
##      3        0.9038             nan     0.1000    0.0460
##      4        0.8143             nan     0.1000    0.0411
##      5        0.7391             nan     0.1000    0.0344
##      6        0.6730             nan     0.1000    0.0304
##      7        0.6182             nan     0.1000    0.0256
##      8        0.5655             nan     0.1000    0.0251
##      9        0.5215             nan     0.1000    0.0178
##     10        0.4832             nan     0.1000    0.0189
##     20        0.2554             nan     0.1000    0.0048
##     40        0.1142             nan     0.1000    0.0000
##     60        0.0705             nan     0.1000   -0.0009
##     80        0.0507             nan     0.1000   -0.0006
##    100        0.0357             nan     0.1000    0.0002
##    120        0.0252             nan     0.1000   -0.0003
##    140        0.0187             nan     0.1000   -0.0003
##    160        0.0130             nan     0.1000   -0.0001
##    180        0.0113             nan     0.1000   -0.0004
##    200        0.0080             nan     0.1000   -0.0001
##    220        0.0064             nan     0.1000   -0.0001
##    240        0.0046             nan     0.1000   -0.0000
##    260        0.0036             nan     0.1000   -0.0000
##    280        0.0028             nan     0.1000   -0.0000
##    300        0.0023             nan     0.1000   -0.0000
##    320        0.0019             nan     0.1000   -0.0000
##    340        0.0015             nan     0.1000   -0.0000
##    360        0.0012             nan     0.1000   -0.0000
##    380        0.0009             nan     0.1000   -0.0000
##    400        0.0007             nan     0.1000   -0.0000
##    420        0.0006             nan     0.1000   -0.0000
##    440        0.0004             nan     0.1000   -0.0000
##    460        0.0003             nan     0.1000   -0.0000
##    480        0.0003             nan     0.1000   -0.0000
##    500        0.0002             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1276             nan     0.1000    0.0761
##      2        1.0018             nan     0.1000    0.0624
##      3        0.8973             nan     0.1000    0.0484
##      4        0.8122             nan     0.1000    0.0385
##      5        0.7340             nan     0.1000    0.0375
##      6        0.6700             nan     0.1000    0.0319
##      7        0.6140             nan     0.1000    0.0262
##      8        0.5631             nan     0.1000    0.0236
##      9        0.5209             nan     0.1000    0.0197
##     10        0.4820             nan     0.1000    0.0174
##     20        0.2584             nan     0.1000    0.0047
##     40        0.1128             nan     0.1000   -0.0005
##     60        0.0675             nan     0.1000   -0.0003
##     80        0.0420             nan     0.1000   -0.0007
##    100        0.0283             nan     0.1000   -0.0004
##    120        0.0200             nan     0.1000   -0.0003
##    140        0.0142             nan     0.1000   -0.0000
##    160        0.0100             nan     0.1000   -0.0001
##    180        0.0076             nan     0.1000   -0.0001
##    200        0.0058             nan     0.1000   -0.0000
##    220        0.0042             nan     0.1000   -0.0000
##    240        0.0030             nan     0.1000   -0.0000
##    260        0.0022             nan     0.1000   -0.0000
##    280        0.0017             nan     0.1000   -0.0000
##    300        0.0015             nan     0.1000   -0.0000
##    320        0.0013             nan     0.1000   -0.0000
##    340        0.0010             nan     0.1000   -0.0000
##    360        0.0009             nan     0.1000   -0.0000
##    380        0.0006             nan     0.1000   -0.0000
##    400        0.0004             nan     0.1000   -0.0000
##    420        0.0004             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1289             nan     0.1000    0.0729
##      2        1.0046             nan     0.1000    0.0568
##      3        0.9031             nan     0.1000    0.0481
##      4        0.8149             nan     0.1000    0.0440
##      5        0.7401             nan     0.1000    0.0356
##      6        0.6762             nan     0.1000    0.0295
##      7        0.6175             nan     0.1000    0.0265
##      8        0.5676             nan     0.1000    0.0197
##      9        0.5274             nan     0.1000    0.0161
##     10        0.4885             nan     0.1000    0.0152
##     20        0.2634             nan     0.1000    0.0053
##     40        0.1127             nan     0.1000   -0.0009
##     60        0.0617             nan     0.1000   -0.0014
##     80        0.0409             nan     0.1000   -0.0011
##    100        0.0279             nan     0.1000   -0.0001
##    120        0.0180             nan     0.1000   -0.0003
##    140        0.0118             nan     0.1000   -0.0001
##    160        0.0088             nan     0.1000   -0.0000
##    180        0.0066             nan     0.1000   -0.0001
##    200        0.0053             nan     0.1000   -0.0001
##    220        0.0039             nan     0.1000   -0.0001
##    240        0.0029             nan     0.1000    0.0000
##    260        0.0023             nan     0.1000   -0.0000
##    280        0.0017             nan     0.1000   -0.0000
##    300        0.0012             nan     0.1000   -0.0000
##    320        0.0009             nan     0.1000   -0.0000
##    340        0.0007             nan     0.1000   -0.0000
##    360        0.0005             nan     0.1000   -0.0000
##    380        0.0004             nan     0.1000    0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1294             nan     0.1000    0.0807
##      2        0.9995             nan     0.1000    0.0649
##      3        0.8940             nan     0.1000    0.0534
##      4        0.8063             nan     0.1000    0.0408
##      5        0.7357             nan     0.1000    0.0352
##      6        0.6718             nan     0.1000    0.0287
##      7        0.6156             nan     0.1000    0.0264
##      8        0.5677             nan     0.1000    0.0205
##      9        0.5260             nan     0.1000    0.0195
##     10        0.4880             nan     0.1000    0.0174
##     20        0.2582             nan     0.1000    0.0057
##     40        0.1010             nan     0.1000    0.0003
##     60        0.0557             nan     0.1000   -0.0007
##     80        0.0339             nan     0.1000    0.0002
##    100        0.0224             nan     0.1000   -0.0000
##    120        0.0156             nan     0.1000   -0.0002
##    140        0.0112             nan     0.1000   -0.0001
##    160        0.0088             nan     0.1000   -0.0001
##    180        0.0067             nan     0.1000   -0.0001
##    200        0.0052             nan     0.1000   -0.0001
##    220        0.0034             nan     0.1000   -0.0000
##    240        0.0024             nan     0.1000   -0.0000
##    260        0.0018             nan     0.1000   -0.0000
##    280        0.0013             nan     0.1000   -0.0000
##    300        0.0010             nan     0.1000   -0.0000
##    320        0.0008             nan     0.1000   -0.0000
##    340        0.0006             nan     0.1000   -0.0000
##    360        0.0004             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000    0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0001             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000    0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1289             nan     0.1000    0.0775
##      2        1.0045             nan     0.1000    0.0552
##      3        0.9002             nan     0.1000    0.0530
##      4        0.8129             nan     0.1000    0.0418
##      5        0.7413             nan     0.1000    0.0324
##      6        0.6779             nan     0.1000    0.0280
##      7        0.6181             nan     0.1000    0.0298
##      8        0.5716             nan     0.1000    0.0214
##      9        0.5313             nan     0.1000    0.0173
##     10        0.4923             nan     0.1000    0.0162
##     20        0.2552             nan     0.1000    0.0052
##     40        0.1037             nan     0.1000   -0.0011
##     60        0.0588             nan     0.1000   -0.0007
##     80        0.0393             nan     0.1000   -0.0007
##    100        0.0267             nan     0.1000    0.0000
##    120        0.0191             nan     0.1000   -0.0003
##    140        0.0133             nan     0.1000   -0.0001
##    160        0.0103             nan     0.1000   -0.0004
##    180        0.0072             nan     0.1000   -0.0002
##    200        0.0049             nan     0.1000   -0.0002
##    220        0.0039             nan     0.1000    0.0000
##    240        0.0028             nan     0.1000   -0.0001
##    260        0.0020             nan     0.1000   -0.0000
##    280        0.0014             nan     0.1000   -0.0000
##    300        0.0012             nan     0.1000   -0.0000
##    320        0.0008             nan     0.1000   -0.0000
##    340        0.0007             nan     0.1000   -0.0000
##    360        0.0005             nan     0.1000    0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000    0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1356             nan     0.1000    0.0688
##      2        1.0105             nan     0.1000    0.0557
##      3        0.9147             nan     0.1000    0.0414
##      4        0.8234             nan     0.1000    0.0412
##      5        0.7489             nan     0.1000    0.0359
##      6        0.6873             nan     0.1000    0.0262
##      7        0.6300             nan     0.1000    0.0267
##      8        0.5794             nan     0.1000    0.0239
##      9        0.5374             nan     0.1000    0.0173
##     10        0.5001             nan     0.1000    0.0168
##     20        0.2661             nan     0.1000    0.0051
##     40        0.1145             nan     0.1000   -0.0002
##     60        0.0559             nan     0.1000   -0.0001
##     80        0.0343             nan     0.1000   -0.0003
##    100        0.0224             nan     0.1000   -0.0006
##    120        0.0152             nan     0.1000   -0.0001
##    140        0.0104             nan     0.1000   -0.0004
##    160        0.0070             nan     0.1000   -0.0000
##    180        0.0052             nan     0.1000   -0.0000
##    200        0.0039             nan     0.1000   -0.0001
##    220        0.0027             nan     0.1000   -0.0000
##    240        0.0024             nan     0.1000   -0.0001
##    260        0.0020             nan     0.1000   -0.0001
##    280        0.0016             nan     0.1000   -0.0001
##    300        0.0010             nan     0.1000   -0.0000
##    320        0.0005             nan     0.1000   -0.0000
##    340        0.0005             nan     0.1000   -0.0000
##    360        0.0003             nan     0.1000   -0.0000
##    380        0.0002             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0001             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1439             nan     0.1000    0.0628
##      2        1.0362             nan     0.1000    0.0525
##      3        0.9414             nan     0.1000    0.0446
##      4        0.8649             nan     0.1000    0.0371
##      5        0.8013             nan     0.1000    0.0324
##      6        0.7436             nan     0.1000    0.0276
##      7        0.6945             nan     0.1000    0.0243
##      8        0.6499             nan     0.1000    0.0201
##      9        0.6103             nan     0.1000    0.0187
##     10        0.5753             nan     0.1000    0.0170
##     20        0.3754             nan     0.1000    0.0059
##     40        0.2426             nan     0.1000    0.0007
##     60        0.1981             nan     0.1000    0.0006
##     80        0.1751             nan     0.1000   -0.0002
##    100        0.1576             nan     0.1000   -0.0009
##    120        0.1486             nan     0.1000   -0.0002
##    140        0.1408             nan     0.1000   -0.0015
##    160        0.1287             nan     0.1000   -0.0011
##    180        0.1222             nan     0.1000   -0.0006
##    200        0.1182             nan     0.1000   -0.0010
##    220        0.1124             nan     0.1000   -0.0007
##    240        0.1074             nan     0.1000   -0.0004
##    260        0.1049             nan     0.1000   -0.0006
##    280        0.1019             nan     0.1000   -0.0010
##    300        0.1003             nan     0.1000   -0.0006
##    320        0.0982             nan     0.1000   -0.0013
##    340        0.0975             nan     0.1000   -0.0004
##    360        0.0961             nan     0.1000   -0.0007
##    380        0.0934             nan     0.1000   -0.0012
##    400        0.0917             nan     0.1000   -0.0006
##    420        0.0893             nan     0.1000   -0.0009
##    440        0.0873             nan     0.1000   -0.0011
##    460        0.0862             nan     0.1000   -0.0004
##    480        0.0862             nan     0.1000   -0.0003
##    500        0.0858             nan     0.1000   -0.0007
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1368             nan     0.1000    0.0781
##      2        1.0196             nan     0.1000    0.0561
##      3        0.9214             nan     0.1000    0.0442
##      4        0.8391             nan     0.1000    0.0420
##      5        0.7680             nan     0.1000    0.0325
##      6        0.7099             nan     0.1000    0.0291
##      7        0.6545             nan     0.1000    0.0233
##      8        0.6047             nan     0.1000    0.0238
##      9        0.5661             nan     0.1000    0.0180
##     10        0.5280             nan     0.1000    0.0167
##     20        0.3131             nan     0.1000    0.0036
##     40        0.1828             nan     0.1000   -0.0012
##     60        0.1432             nan     0.1000    0.0000
##     80        0.1100             nan     0.1000    0.0003
##    100        0.0939             nan     0.1000   -0.0010
##    120        0.0823             nan     0.1000   -0.0005
##    140        0.0724             nan     0.1000   -0.0004
##    160        0.0616             nan     0.1000   -0.0008
##    180        0.0552             nan     0.1000   -0.0005
##    200        0.0479             nan     0.1000   -0.0003
##    220        0.0444             nan     0.1000   -0.0005
##    240        0.0400             nan     0.1000   -0.0003
##    260        0.0355             nan     0.1000   -0.0001
##    280        0.0325             nan     0.1000   -0.0003
##    300        0.0296             nan     0.1000   -0.0000
##    320        0.0270             nan     0.1000   -0.0002
##    340        0.0252             nan     0.1000   -0.0002
##    360        0.0224             nan     0.1000   -0.0002
##    380        0.0203             nan     0.1000   -0.0003
##    400        0.0189             nan     0.1000   -0.0002
##    420        0.0171             nan     0.1000   -0.0002
##    440        0.0156             nan     0.1000   -0.0001
##    460        0.0146             nan     0.1000   -0.0001
##    480        0.0140             nan     0.1000   -0.0002
##    500        0.0129             nan     0.1000   -0.0002
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1336             nan     0.1000    0.0742
##      2        1.0129             nan     0.1000    0.0602
##      3        0.9073             nan     0.1000    0.0525
##      4        0.8237             nan     0.1000    0.0381
##      5        0.7505             nan     0.1000    0.0367
##      6        0.6861             nan     0.1000    0.0312
##      7        0.6344             nan     0.1000    0.0245
##      8        0.5857             nan     0.1000    0.0228
##      9        0.5483             nan     0.1000    0.0162
##     10        0.5126             nan     0.1000    0.0151
##     20        0.2831             nan     0.1000    0.0058
##     40        0.1557             nan     0.1000   -0.0001
##     60        0.1098             nan     0.1000   -0.0006
##     80        0.0825             nan     0.1000   -0.0003
##    100        0.0667             nan     0.1000   -0.0006
##    120        0.0539             nan     0.1000   -0.0005
##    140        0.0437             nan     0.1000   -0.0002
##    160        0.0360             nan     0.1000   -0.0003
##    180        0.0310             nan     0.1000   -0.0001
##    200        0.0266             nan     0.1000   -0.0004
##    220        0.0223             nan     0.1000   -0.0002
##    240        0.0180             nan     0.1000   -0.0001
##    260        0.0156             nan     0.1000   -0.0000
##    280        0.0131             nan     0.1000   -0.0002
##    300        0.0120             nan     0.1000   -0.0002
##    320        0.0102             nan     0.1000   -0.0002
##    340        0.0086             nan     0.1000   -0.0001
##    360        0.0073             nan     0.1000   -0.0000
##    380        0.0064             nan     0.1000   -0.0000
##    400        0.0054             nan     0.1000    0.0000
##    420        0.0045             nan     0.1000   -0.0001
##    440        0.0037             nan     0.1000   -0.0000
##    460        0.0032             nan     0.1000   -0.0000
##    480        0.0027             nan     0.1000   -0.0000
##    500        0.0022             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1383             nan     0.1000    0.0697
##      2        1.0153             nan     0.1000    0.0575
##      3        0.9115             nan     0.1000    0.0474
##      4        0.8284             nan     0.1000    0.0389
##      5        0.7558             nan     0.1000    0.0324
##      6        0.6943             nan     0.1000    0.0298
##      7        0.6408             nan     0.1000    0.0245
##      8        0.5920             nan     0.1000    0.0219
##      9        0.5508             nan     0.1000    0.0166
##     10        0.5132             nan     0.1000    0.0161
##     20        0.2802             nan     0.1000    0.0033
##     40        0.1384             nan     0.1000    0.0002
##     60        0.0913             nan     0.1000    0.0002
##     80        0.0660             nan     0.1000   -0.0007
##    100        0.0475             nan     0.1000   -0.0004
##    120        0.0353             nan     0.1000   -0.0006
##    140        0.0269             nan     0.1000   -0.0003
##    160        0.0217             nan     0.1000   -0.0003
##    180        0.0177             nan     0.1000   -0.0000
##    200        0.0141             nan     0.1000   -0.0002
##    220        0.0115             nan     0.1000   -0.0001
##    240        0.0090             nan     0.1000   -0.0000
##    260        0.0073             nan     0.1000   -0.0001
##    280        0.0060             nan     0.1000   -0.0000
##    300        0.0047             nan     0.1000   -0.0001
##    320        0.0036             nan     0.1000   -0.0000
##    340        0.0030             nan     0.1000   -0.0000
##    360        0.0023             nan     0.1000   -0.0000
##    380        0.0018             nan     0.1000   -0.0000
##    400        0.0015             nan     0.1000   -0.0000
##    420        0.0012             nan     0.1000   -0.0000
##    440        0.0010             nan     0.1000   -0.0000
##    460        0.0008             nan     0.1000   -0.0000
##    480        0.0007             nan     0.1000   -0.0000
##    500        0.0005             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1299             nan     0.1000    0.0747
##      2        1.0100             nan     0.1000    0.0587
##      3        0.9096             nan     0.1000    0.0491
##      4        0.8206             nan     0.1000    0.0410
##      5        0.7465             nan     0.1000    0.0343
##      6        0.6805             nan     0.1000    0.0310
##      7        0.6238             nan     0.1000    0.0248
##      8        0.5793             nan     0.1000    0.0181
##      9        0.5351             nan     0.1000    0.0200
##     10        0.4963             nan     0.1000    0.0175
##     20        0.2701             nan     0.1000    0.0057
##     40        0.1269             nan     0.1000   -0.0009
##     60        0.0800             nan     0.1000   -0.0005
##     80        0.0520             nan     0.1000   -0.0012
##    100        0.0376             nan     0.1000   -0.0009
##    120        0.0271             nan     0.1000   -0.0000
##    140        0.0193             nan     0.1000   -0.0003
##    160        0.0158             nan     0.1000   -0.0002
##    180        0.0122             nan     0.1000   -0.0001
##    200        0.0095             nan     0.1000    0.0000
##    220        0.0072             nan     0.1000   -0.0001
##    240        0.0059             nan     0.1000   -0.0001
##    260        0.0043             nan     0.1000   -0.0000
##    280        0.0033             nan     0.1000   -0.0000
##    300        0.0027             nan     0.1000   -0.0000
##    320        0.0022             nan     0.1000   -0.0000
##    340        0.0017             nan     0.1000   -0.0000
##    360        0.0013             nan     0.1000   -0.0000
##    380        0.0010             nan     0.1000   -0.0000
##    400        0.0008             nan     0.1000   -0.0000
##    420        0.0006             nan     0.1000   -0.0000
##    440        0.0004             nan     0.1000    0.0000
##    460        0.0003             nan     0.1000   -0.0000
##    480        0.0003             nan     0.1000   -0.0000
##    500        0.0002             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1304             nan     0.1000    0.0740
##      2        1.0050             nan     0.1000    0.0534
##      3        0.9073             nan     0.1000    0.0436
##      4        0.8185             nan     0.1000    0.0412
##      5        0.7441             nan     0.1000    0.0364
##      6        0.6806             nan     0.1000    0.0268
##      7        0.6204             nan     0.1000    0.0258
##      8        0.5740             nan     0.1000    0.0200
##      9        0.5332             nan     0.1000    0.0172
##     10        0.4976             nan     0.1000    0.0147
##     20        0.2698             nan     0.1000    0.0044
##     40        0.1185             nan     0.1000    0.0005
##     60        0.0738             nan     0.1000   -0.0012
##     80        0.0476             nan     0.1000   -0.0003
##    100        0.0315             nan     0.1000    0.0000
##    120        0.0231             nan     0.1000   -0.0004
##    140        0.0168             nan     0.1000   -0.0002
##    160        0.0118             nan     0.1000   -0.0001
##    180        0.0085             nan     0.1000   -0.0002
##    200        0.0059             nan     0.1000   -0.0000
##    220        0.0049             nan     0.1000   -0.0001
##    240        0.0036             nan     0.1000   -0.0001
##    260        0.0027             nan     0.1000   -0.0001
##    280        0.0018             nan     0.1000   -0.0000
##    300        0.0014             nan     0.1000   -0.0000
##    320        0.0010             nan     0.1000   -0.0000
##    340        0.0008             nan     0.1000   -0.0000
##    360        0.0006             nan     0.1000   -0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000    0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1295             nan     0.1000    0.0726
##      2        1.0056             nan     0.1000    0.0561
##      3        0.9022             nan     0.1000    0.0464
##      4        0.8188             nan     0.1000    0.0399
##      5        0.7410             nan     0.1000    0.0368
##      6        0.6805             nan     0.1000    0.0291
##      7        0.6280             nan     0.1000    0.0253
##      8        0.5792             nan     0.1000    0.0220
##      9        0.5375             nan     0.1000    0.0192
##     10        0.5010             nan     0.1000    0.0147
##     20        0.2691             nan     0.1000    0.0040
##     40        0.1164             nan     0.1000   -0.0015
##     60        0.0673             nan     0.1000   -0.0002
##     80        0.0431             nan     0.1000   -0.0002
##    100        0.0298             nan     0.1000   -0.0006
##    120        0.0176             nan     0.1000   -0.0004
##    140        0.0122             nan     0.1000   -0.0001
##    160        0.0085             nan     0.1000   -0.0001
##    180        0.0060             nan     0.1000   -0.0001
##    200        0.0048             nan     0.1000   -0.0001
##    220        0.0037             nan     0.1000   -0.0001
##    240        0.0025             nan     0.1000   -0.0000
##    260        0.0019             nan     0.1000   -0.0001
##    280        0.0017             nan     0.1000   -0.0000
##    300        0.0014             nan     0.1000   -0.0000
##    320        0.0009             nan     0.1000   -0.0000
##    340        0.0006             nan     0.1000   -0.0000
##    360        0.0005             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1336             nan     0.1000    0.0754
##      2        1.0054             nan     0.1000    0.0583
##      3        0.8980             nan     0.1000    0.0519
##      4        0.8118             nan     0.1000    0.0383
##      5        0.7369             nan     0.1000    0.0356
##      6        0.6753             nan     0.1000    0.0269
##      7        0.6201             nan     0.1000    0.0258
##      8        0.5729             nan     0.1000    0.0229
##      9        0.5295             nan     0.1000    0.0189
##     10        0.4910             nan     0.1000    0.0163
##     20        0.2585             nan     0.1000    0.0078
##     40        0.1127             nan     0.1000   -0.0002
##     60        0.0607             nan     0.1000   -0.0006
##     80        0.0359             nan     0.1000   -0.0005
##    100        0.0229             nan     0.1000   -0.0002
##    120        0.0156             nan     0.1000   -0.0003
##    140        0.0113             nan     0.1000   -0.0004
##    160        0.0078             nan     0.1000    0.0000
##    180        0.0060             nan     0.1000   -0.0001
##    200        0.0044             nan     0.1000   -0.0001
##    220        0.0030             nan     0.1000   -0.0001
##    240        0.0022             nan     0.1000   -0.0000
##    260        0.0016             nan     0.1000   -0.0000
##    280        0.0013             nan     0.1000   -0.0000
##    300        0.0010             nan     0.1000   -0.0000
##    320        0.0007             nan     0.1000   -0.0000
##    340        0.0004             nan     0.1000   -0.0000
##    360        0.0003             nan     0.1000   -0.0000
##    380        0.0002             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0001             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0000             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1343             nan     0.1000    0.0676
##      2        1.0026             nan     0.1000    0.0643
##      3        0.8984             nan     0.1000    0.0502
##      4        0.8134             nan     0.1000    0.0430
##      5        0.7418             nan     0.1000    0.0353
##      6        0.6765             nan     0.1000    0.0309
##      7        0.6186             nan     0.1000    0.0280
##      8        0.5689             nan     0.1000    0.0216
##      9        0.5276             nan     0.1000    0.0186
##     10        0.4894             nan     0.1000    0.0177
##     20        0.2707             nan     0.1000    0.0051
##     40        0.1073             nan     0.1000   -0.0004
##     60        0.0587             nan     0.1000   -0.0003
##     80        0.0338             nan     0.1000   -0.0007
##    100        0.0223             nan     0.1000   -0.0002
##    120        0.0148             nan     0.1000   -0.0002
##    140        0.0098             nan     0.1000   -0.0001
##    160        0.0071             nan     0.1000   -0.0001
##    180        0.0051             nan     0.1000   -0.0001
##    200        0.0039             nan     0.1000   -0.0001
##    220        0.0027             nan     0.1000   -0.0001
##    240        0.0019             nan     0.1000   -0.0000
##    260        0.0015             nan     0.1000   -0.0000
##    280        0.0011             nan     0.1000   -0.0000
##    300        0.0009             nan     0.1000   -0.0000
##    320        0.0006             nan     0.1000   -0.0000
##    340        0.0004             nan     0.1000   -0.0000
##    360        0.0003             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000    0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0002             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1341             nan     0.1000    0.0790
##      2        1.0139             nan     0.1000    0.0529
##      3        0.9143             nan     0.1000    0.0456
##      4        0.8276             nan     0.1000    0.0400
##      5        0.7520             nan     0.1000    0.0332
##      6        0.6873             nan     0.1000    0.0295
##      7        0.6313             nan     0.1000    0.0251
##      8        0.5808             nan     0.1000    0.0229
##      9        0.5400             nan     0.1000    0.0183
##     10        0.5051             nan     0.1000    0.0145
##     20        0.2690             nan     0.1000    0.0046
##     40        0.1111             nan     0.1000   -0.0003
##     60        0.0637             nan     0.1000   -0.0016
##     80        0.0405             nan     0.1000   -0.0005
##    100        0.0276             nan     0.1000   -0.0005
##    120        0.0169             nan     0.1000   -0.0001
##    140        0.0109             nan     0.1000   -0.0002
##    160        0.0083             nan     0.1000   -0.0000
##    180        0.0061             nan     0.1000   -0.0001
##    200        0.0043             nan     0.1000    0.0000
##    220        0.0031             nan     0.1000   -0.0000
##    240        0.0022             nan     0.1000   -0.0000
##    260        0.0016             nan     0.1000   -0.0000
##    280        0.0012             nan     0.1000   -0.0000
##    300        0.0009             nan     0.1000   -0.0000
##    320        0.0007             nan     0.1000   -0.0000
##    340        0.0005             nan     0.1000    0.0000
##    360        0.0004             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000    0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1541             nan     0.1000    0.0701
##      2        1.0366             nan     0.1000    0.0537
##      3        0.9429             nan     0.1000    0.0447
##      4        0.8686             nan     0.1000    0.0360
##      5        0.8031             nan     0.1000    0.0308
##      6        0.7428             nan     0.1000    0.0276
##      7        0.6927             nan     0.1000    0.0250
##      8        0.6555             nan     0.1000    0.0159
##      9        0.6149             nan     0.1000    0.0175
##     10        0.5782             nan     0.1000    0.0173
##     20        0.3729             nan     0.1000    0.0042
##     40        0.2351             nan     0.1000    0.0011
##     60        0.1789             nan     0.1000    0.0007
##     80        0.1548             nan     0.1000   -0.0002
##    100        0.1352             nan     0.1000    0.0000
##    120        0.1231             nan     0.1000   -0.0009
##    140        0.1136             nan     0.1000   -0.0007
##    160        0.1093             nan     0.1000   -0.0005
##    180        0.1018             nan     0.1000   -0.0009
##    200        0.0951             nan     0.1000   -0.0005
##    220        0.0899             nan     0.1000   -0.0002
##    240        0.0869             nan     0.1000   -0.0005
##    260        0.0863             nan     0.1000   -0.0006
##    280        0.0829             nan     0.1000   -0.0007
##    300        0.0791             nan     0.1000   -0.0012
##    320        0.0770             nan     0.1000   -0.0007
##    340        0.0754             nan     0.1000   -0.0016
##    360        0.0728             nan     0.1000   -0.0000
##    380        0.0707             nan     0.1000   -0.0004
##    400        0.0684             nan     0.1000   -0.0004
##    420        0.0665             nan     0.1000   -0.0004
##    440        0.0647             nan     0.1000   -0.0002
##    460        0.0634             nan     0.1000   -0.0005
##    480        0.0617             nan     0.1000   -0.0001
##    500        0.0597             nan     0.1000   -0.0007
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1377             nan     0.1000    0.0701
##      2        1.0237             nan     0.1000    0.0559
##      3        0.9250             nan     0.1000    0.0485
##      4        0.8476             nan     0.1000    0.0372
##      5        0.7784             nan     0.1000    0.0340
##      6        0.7165             nan     0.1000    0.0295
##      7        0.6606             nan     0.1000    0.0280
##      8        0.6100             nan     0.1000    0.0231
##      9        0.5661             nan     0.1000    0.0192
##     10        0.5288             nan     0.1000    0.0171
##     20        0.3070             nan     0.1000    0.0048
##     40        0.1690             nan     0.1000    0.0002
##     60        0.1287             nan     0.1000   -0.0004
##     80        0.1067             nan     0.1000   -0.0000
##    100        0.0900             nan     0.1000   -0.0004
##    120        0.0758             nan     0.1000   -0.0001
##    140        0.0672             nan     0.1000   -0.0000
##    160        0.0592             nan     0.1000   -0.0003
##    180        0.0513             nan     0.1000   -0.0002
##    200        0.0450             nan     0.1000   -0.0002
##    220        0.0400             nan     0.1000   -0.0007
##    240        0.0360             nan     0.1000   -0.0002
##    260        0.0313             nan     0.1000   -0.0001
##    280        0.0276             nan     0.1000   -0.0001
##    300        0.0248             nan     0.1000   -0.0002
##    320        0.0227             nan     0.1000   -0.0003
##    340        0.0208             nan     0.1000   -0.0002
##    360        0.0188             nan     0.1000   -0.0001
##    380        0.0171             nan     0.1000   -0.0002
##    400        0.0155             nan     0.1000   -0.0002
##    420        0.0148             nan     0.1000   -0.0003
##    440        0.0133             nan     0.1000   -0.0001
##    460        0.0122             nan     0.1000   -0.0001
##    480        0.0111             nan     0.1000   -0.0002
##    500        0.0104             nan     0.1000   -0.0001
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1367             nan     0.1000    0.0773
##      2        1.0090             nan     0.1000    0.0615
##      3        0.9080             nan     0.1000    0.0490
##      4        0.8258             nan     0.1000    0.0396
##      5        0.7470             nan     0.1000    0.0354
##      6        0.6874             nan     0.1000    0.0277
##      7        0.6314             nan     0.1000    0.0277
##      8        0.5821             nan     0.1000    0.0225
##      9        0.5389             nan     0.1000    0.0200
##     10        0.5034             nan     0.1000    0.0146
##     20        0.2768             nan     0.1000    0.0075
##     40        0.1469             nan     0.1000   -0.0001
##     60        0.1019             nan     0.1000   -0.0004
##     80        0.0764             nan     0.1000   -0.0001
##    100        0.0591             nan     0.1000   -0.0001
##    120        0.0471             nan     0.1000   -0.0002
##    140        0.0372             nan     0.1000    0.0002
##    160        0.0312             nan     0.1000   -0.0004
##    180        0.0249             nan     0.1000   -0.0003
##    200        0.0210             nan     0.1000   -0.0002
##    220        0.0177             nan     0.1000   -0.0001
##    240        0.0149             nan     0.1000   -0.0002
##    260        0.0125             nan     0.1000   -0.0001
##    280        0.0107             nan     0.1000   -0.0001
##    300        0.0088             nan     0.1000   -0.0001
##    320        0.0079             nan     0.1000   -0.0001
##    340        0.0067             nan     0.1000   -0.0001
##    360        0.0060             nan     0.1000   -0.0000
##    380        0.0050             nan     0.1000   -0.0000
##    400        0.0044             nan     0.1000   -0.0000
##    420        0.0037             nan     0.1000   -0.0000
##    440        0.0031             nan     0.1000   -0.0000
##    460        0.0026             nan     0.1000   -0.0000
##    480        0.0022             nan     0.1000   -0.0000
##    500        0.0018             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1412             nan     0.1000    0.0732
##      2        1.0167             nan     0.1000    0.0581
##      3        0.9133             nan     0.1000    0.0476
##      4        0.8285             nan     0.1000    0.0432
##      5        0.7547             nan     0.1000    0.0362
##      6        0.6896             nan     0.1000    0.0291
##      7        0.6321             nan     0.1000    0.0258
##      8        0.5851             nan     0.1000    0.0233
##      9        0.5445             nan     0.1000    0.0185
##     10        0.5049             nan     0.1000    0.0189
##     20        0.2717             nan     0.1000    0.0053
##     40        0.1316             nan     0.1000    0.0005
##     60        0.0854             nan     0.1000   -0.0006
##     80        0.0604             nan     0.1000   -0.0002
##    100        0.0437             nan     0.1000   -0.0002
##    120        0.0327             nan     0.1000   -0.0004
##    140        0.0239             nan     0.1000   -0.0003
##    160        0.0183             nan     0.1000   -0.0002
##    180        0.0150             nan     0.1000   -0.0003
##    200        0.0120             nan     0.1000   -0.0002
##    220        0.0094             nan     0.1000   -0.0002
##    240        0.0074             nan     0.1000   -0.0001
##    260        0.0057             nan     0.1000   -0.0001
##    280        0.0046             nan     0.1000   -0.0000
##    300        0.0038             nan     0.1000   -0.0000
##    320        0.0031             nan     0.1000   -0.0000
##    340        0.0024             nan     0.1000   -0.0000
##    360        0.0019             nan     0.1000   -0.0000
##    380        0.0015             nan     0.1000   -0.0000
##    400        0.0012             nan     0.1000   -0.0000
##    420        0.0010             nan     0.1000   -0.0000
##    440        0.0008             nan     0.1000   -0.0000
##    460        0.0006             nan     0.1000   -0.0000
##    480        0.0005             nan     0.1000   -0.0000
##    500        0.0004             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1311             nan     0.1000    0.0731
##      2        1.0055             nan     0.1000    0.0606
##      3        0.8991             nan     0.1000    0.0484
##      4        0.8139             nan     0.1000    0.0394
##      5        0.7446             nan     0.1000    0.0330
##      6        0.6854             nan     0.1000    0.0273
##      7        0.6285             nan     0.1000    0.0287
##      8        0.5815             nan     0.1000    0.0216
##      9        0.5342             nan     0.1000    0.0213
##     10        0.4968             nan     0.1000    0.0161
##     20        0.2711             nan     0.1000    0.0053
##     40        0.1170             nan     0.1000   -0.0001
##     60        0.0686             nan     0.1000    0.0001
##     80        0.0449             nan     0.1000    0.0000
##    100        0.0320             nan     0.1000   -0.0002
##    120        0.0225             nan     0.1000   -0.0002
##    140        0.0159             nan     0.1000   -0.0001
##    160        0.0117             nan     0.1000   -0.0001
##    180        0.0093             nan     0.1000   -0.0000
##    200        0.0071             nan     0.1000   -0.0002
##    220        0.0051             nan     0.1000   -0.0000
##    240        0.0036             nan     0.1000   -0.0000
##    260        0.0028             nan     0.1000   -0.0000
##    280        0.0022             nan     0.1000   -0.0000
##    300        0.0017             nan     0.1000   -0.0000
##    320        0.0012             nan     0.1000   -0.0000
##    340        0.0009             nan     0.1000   -0.0000
##    360        0.0007             nan     0.1000   -0.0000
##    380        0.0005             nan     0.1000   -0.0000
##    400        0.0004             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1412             nan     0.1000    0.0618
##      2        1.0162             nan     0.1000    0.0583
##      3        0.9167             nan     0.1000    0.0478
##      4        0.8293             nan     0.1000    0.0430
##      5        0.7520             nan     0.1000    0.0355
##      6        0.6868             nan     0.1000    0.0312
##      7        0.6319             nan     0.1000    0.0238
##      8        0.5845             nan     0.1000    0.0228
##      9        0.5414             nan     0.1000    0.0200
##     10        0.4987             nan     0.1000    0.0181
##     20        0.2623             nan     0.1000    0.0042
##     40        0.1110             nan     0.1000    0.0009
##     60        0.0619             nan     0.1000   -0.0004
##     80        0.0436             nan     0.1000   -0.0003
##    100        0.0287             nan     0.1000   -0.0004
##    120        0.0201             nan     0.1000   -0.0000
##    140        0.0132             nan     0.1000   -0.0001
##    160        0.0091             nan     0.1000   -0.0001
##    180        0.0067             nan     0.1000   -0.0000
##    200        0.0052             nan     0.1000    0.0000
##    220        0.0039             nan     0.1000    0.0000
##    240        0.0027             nan     0.1000   -0.0000
##    260        0.0021             nan     0.1000   -0.0000
##    280        0.0018             nan     0.1000   -0.0001
##    300        0.0013             nan     0.1000   -0.0000
##    320        0.0010             nan     0.1000   -0.0000
##    340        0.0008             nan     0.1000   -0.0000
##    360        0.0006             nan     0.1000    0.0000
##    380        0.0005             nan     0.1000   -0.0000
##    400        0.0004             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0003             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1389             nan     0.1000    0.0709
##      2        1.0121             nan     0.1000    0.0599
##      3        0.9074             nan     0.1000    0.0502
##      4        0.8216             nan     0.1000    0.0402
##      5        0.7504             nan     0.1000    0.0324
##      6        0.6885             nan     0.1000    0.0280
##      7        0.6312             nan     0.1000    0.0251
##      8        0.5844             nan     0.1000    0.0201
##      9        0.5374             nan     0.1000    0.0201
##     10        0.4988             nan     0.1000    0.0174
##     20        0.2662             nan     0.1000    0.0056
##     40        0.1082             nan     0.1000    0.0009
##     60        0.0581             nan     0.1000   -0.0002
##     80        0.0357             nan     0.1000   -0.0002
##    100        0.0246             nan     0.1000   -0.0004
##    120        0.0162             nan     0.1000   -0.0002
##    140        0.0111             nan     0.1000   -0.0002
##    160        0.0076             nan     0.1000   -0.0002
##    180        0.0053             nan     0.1000   -0.0001
##    200        0.0041             nan     0.1000   -0.0000
##    220        0.0027             nan     0.1000   -0.0001
##    240        0.0021             nan     0.1000   -0.0000
##    260        0.0017             nan     0.1000   -0.0000
##    280        0.0012             nan     0.1000    0.0000
##    300        0.0009             nan     0.1000   -0.0000
##    320        0.0007             nan     0.1000   -0.0000
##    340        0.0004             nan     0.1000    0.0000
##    360        0.0003             nan     0.1000   -0.0000
##    380        0.0002             nan     0.1000    0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0001             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000    0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1292             nan     0.1000    0.0755
##      2        1.0071             nan     0.1000    0.0578
##      3        0.9070             nan     0.1000    0.0462
##      4        0.8231             nan     0.1000    0.0406
##      5        0.7514             nan     0.1000    0.0349
##      6        0.6873             nan     0.1000    0.0283
##      7        0.6279             nan     0.1000    0.0295
##      8        0.5815             nan     0.1000    0.0206
##      9        0.5383             nan     0.1000    0.0200
##     10        0.5026             nan     0.1000    0.0143
##     20        0.2654             nan     0.1000    0.0061
##     40        0.1094             nan     0.1000    0.0003
##     60        0.0533             nan     0.1000    0.0001
##     80        0.0331             nan     0.1000   -0.0004
##    100        0.0223             nan     0.1000   -0.0003
##    120        0.0143             nan     0.1000   -0.0000
##    140        0.0103             nan     0.1000   -0.0001
##    160        0.0074             nan     0.1000   -0.0002
##    180        0.0061             nan     0.1000   -0.0001
##    200        0.0043             nan     0.1000   -0.0001
##    220        0.0030             nan     0.1000   -0.0001
##    240        0.0019             nan     0.1000   -0.0000
##    260        0.0013             nan     0.1000   -0.0000
##    280        0.0009             nan     0.1000   -0.0000
##    300        0.0006             nan     0.1000    0.0000
##    320        0.0005             nan     0.1000   -0.0000
##    340        0.0003             nan     0.1000   -0.0000
##    360        0.0003             nan     0.1000   -0.0000
##    380        0.0002             nan     0.1000   -0.0000
##    400        0.0001             nan     0.1000   -0.0000
##    420        0.0001             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000    0.0000
##    460        0.0000             nan     0.1000   -0.0000
##    480        0.0000             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1295             nan     0.1000    0.0764
##      2        1.0109             nan     0.1000    0.0610
##      3        0.9083             nan     0.1000    0.0519
##      4        0.8193             nan     0.1000    0.0442
##      5        0.7452             nan     0.1000    0.0341
##      6        0.6819             nan     0.1000    0.0282
##      7        0.6270             nan     0.1000    0.0230
##      8        0.5798             nan     0.1000    0.0211
##      9        0.5338             nan     0.1000    0.0213
##     10        0.4934             nan     0.1000    0.0184
##     20        0.2599             nan     0.1000    0.0044
##     40        0.1042             nan     0.1000    0.0004
##     60        0.0560             nan     0.1000   -0.0003
##     80        0.0359             nan     0.1000    0.0001
##    100        0.0245             nan     0.1000   -0.0002
##    120        0.0168             nan     0.1000   -0.0002
##    140        0.0109             nan     0.1000   -0.0001
##    160        0.0075             nan     0.1000   -0.0000
##    180        0.0051             nan     0.1000   -0.0001
##    200        0.0038             nan     0.1000   -0.0001
##    220        0.0028             nan     0.1000   -0.0000
##    240        0.0024             nan     0.1000   -0.0001
##    260        0.0016             nan     0.1000   -0.0000
##    280        0.0014             nan     0.1000   -0.0001
##    300        0.0010             nan     0.1000    0.0000
##    320        0.0007             nan     0.1000   -0.0000
##    340        0.0004             nan     0.1000   -0.0000
##    360        0.0003             nan     0.1000   -0.0000
##    380        0.0002             nan     0.1000   -0.0000
##    400        0.0001             nan     0.1000   -0.0000
##    420        0.0001             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1387             nan     0.1000    0.0768
##      2        1.0158             nan     0.1000    0.0572
##      3        0.9156             nan     0.1000    0.0462
##      4        0.8271             nan     0.1000    0.0429
##      5        0.7476             nan     0.1000    0.0373
##      6        0.6843             nan     0.1000    0.0286
##      7        0.6294             nan     0.1000    0.0237
##      8        0.5794             nan     0.1000    0.0213
##      9        0.5362             nan     0.1000    0.0213
##     10        0.4991             nan     0.1000    0.0156
##     20        0.2667             nan     0.1000    0.0036
##     40        0.1101             nan     0.1000   -0.0004
##     60        0.0566             nan     0.1000   -0.0006
##     80        0.0321             nan     0.1000   -0.0000
##    100        0.0220             nan     0.1000   -0.0004
##    120        0.0153             nan     0.1000   -0.0001
##    140        0.0115             nan     0.1000   -0.0002
##    160        0.0068             nan     0.1000   -0.0001
##    180        0.0045             nan     0.1000   -0.0000
##    200        0.0034             nan     0.1000   -0.0000
##    220        0.0023             nan     0.1000   -0.0001
##    240        0.0017             nan     0.1000   -0.0000
##    260        0.0012             nan     0.1000   -0.0000
##    280        0.0010             nan     0.1000   -0.0000
##    300        0.0009             nan     0.1000   -0.0000
##    320        0.0007             nan     0.1000   -0.0000
##    340        0.0006             nan     0.1000   -0.0000
##    360        0.0005             nan     0.1000   -0.0000
##    380        0.0006             nan     0.1000   -0.0000
##    400        0.0005             nan     0.1000   -0.0000
##    420        0.0005             nan     0.1000   -0.0000
##    440        0.0004             nan     0.1000   -0.0000
##    460        0.0003             nan     0.1000   -0.0000
##    480        0.0002             nan     0.1000   -0.0000
##    500        0.0002             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1465             nan     0.1000    0.0655
##      2        1.0386             nan     0.1000    0.0534
##      3        0.9470             nan     0.1000    0.0428
##      4        0.8707             nan     0.1000    0.0344
##      5        0.8022             nan     0.1000    0.0328
##      6        0.7459             nan     0.1000    0.0293
##      7        0.6991             nan     0.1000    0.0204
##      8        0.6544             nan     0.1000    0.0202
##      9        0.6085             nan     0.1000    0.0193
##     10        0.5731             nan     0.1000    0.0168
##     20        0.3679             nan     0.1000    0.0059
##     40        0.2420             nan     0.1000   -0.0005
##     60        0.1907             nan     0.1000   -0.0014
##     80        0.1709             nan     0.1000    0.0003
##    100        0.1544             nan     0.1000   -0.0017
##    120        0.1440             nan     0.1000   -0.0016
##    140        0.1355             nan     0.1000   -0.0006
##    160        0.1302             nan     0.1000   -0.0018
##    180        0.1278             nan     0.1000   -0.0010
##    200        0.1220             nan     0.1000   -0.0010
##    220        0.1185             nan     0.1000   -0.0016
##    240        0.1160             nan     0.1000   -0.0011
##    260        0.1135             nan     0.1000   -0.0008
##    280        0.1114             nan     0.1000   -0.0008
##    300        0.1072             nan     0.1000    0.0002
##    320        0.1040             nan     0.1000   -0.0012
##    340        0.1023             nan     0.1000   -0.0003
##    360        0.0989             nan     0.1000   -0.0006
##    380        0.0970             nan     0.1000   -0.0008
##    400        0.0966             nan     0.1000   -0.0008
##    420        0.0944             nan     0.1000   -0.0006
##    440        0.0928             nan     0.1000   -0.0005
##    460        0.0925             nan     0.1000   -0.0007
##    480        0.0927             nan     0.1000   -0.0005
##    500        0.0919             nan     0.1000   -0.0010
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1383             nan     0.1000    0.0719
##      2        1.0233             nan     0.1000    0.0560
##      3        0.9258             nan     0.1000    0.0472
##      4        0.8407             nan     0.1000    0.0403
##      5        0.7715             nan     0.1000    0.0339
##      6        0.7066             nan     0.1000    0.0301
##      7        0.6541             nan     0.1000    0.0259
##      8        0.6047             nan     0.1000    0.0231
##      9        0.5600             nan     0.1000    0.0209
##     10        0.5232             nan     0.1000    0.0175
##     20        0.3084             nan     0.1000    0.0056
##     40        0.1829             nan     0.1000    0.0002
##     60        0.1394             nan     0.1000    0.0003
##     80        0.1139             nan     0.1000   -0.0006
##    100        0.1006             nan     0.1000   -0.0009
##    120        0.0909             nan     0.1000   -0.0013
##    140        0.0799             nan     0.1000   -0.0013
##    160        0.0697             nan     0.1000   -0.0004
##    180        0.0628             nan     0.1000   -0.0003
##    200        0.0580             nan     0.1000   -0.0010
##    220        0.0533             nan     0.1000   -0.0007
##    240        0.0493             nan     0.1000   -0.0004
##    260        0.0458             nan     0.1000   -0.0005
##    280        0.0401             nan     0.1000   -0.0001
##    300        0.0363             nan     0.1000   -0.0006
##    320        0.0318             nan     0.1000    0.0000
##    340        0.0294             nan     0.1000   -0.0002
##    360        0.0267             nan     0.1000   -0.0000
##    380        0.0244             nan     0.1000   -0.0002
##    400        0.0230             nan     0.1000   -0.0003
##    420        0.0213             nan     0.1000   -0.0003
##    440        0.0197             nan     0.1000   -0.0001
##    460        0.0185             nan     0.1000   -0.0000
##    480        0.0174             nan     0.1000   -0.0002
##    500        0.0160             nan     0.1000   -0.0003
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1330             nan     0.1000    0.0730
##      2        1.0129             nan     0.1000    0.0563
##      3        0.9141             nan     0.1000    0.0455
##      4        0.8308             nan     0.1000    0.0389
##      5        0.7536             nan     0.1000    0.0381
##      6        0.6910             nan     0.1000    0.0285
##      7        0.6324             nan     0.1000    0.0279
##      8        0.5817             nan     0.1000    0.0247
##      9        0.5357             nan     0.1000    0.0205
##     10        0.5023             nan     0.1000    0.0149
##     20        0.2841             nan     0.1000    0.0047
##     40        0.1543             nan     0.1000   -0.0004
##     60        0.1069             nan     0.1000   -0.0004
##     80        0.0860             nan     0.1000   -0.0010
##    100        0.0702             nan     0.1000   -0.0008
##    120        0.0560             nan     0.1000   -0.0004
##    140        0.0444             nan     0.1000   -0.0007
##    160        0.0376             nan     0.1000   -0.0002
##    180        0.0307             nan     0.1000   -0.0003
##    200        0.0241             nan     0.1000   -0.0001
##    220        0.0205             nan     0.1000   -0.0002
##    240        0.0181             nan     0.1000   -0.0000
##    260        0.0156             nan     0.1000    0.0001
##    280        0.0133             nan     0.1000   -0.0001
##    300        0.0113             nan     0.1000   -0.0001
##    320        0.0097             nan     0.1000   -0.0001
##    340        0.0083             nan     0.1000   -0.0000
##    360        0.0074             nan     0.1000   -0.0001
##    380        0.0065             nan     0.1000   -0.0001
##    400        0.0058             nan     0.1000   -0.0001
##    420        0.0048             nan     0.1000   -0.0001
##    440        0.0041             nan     0.1000   -0.0001
##    460        0.0037             nan     0.1000   -0.0000
##    480        0.0032             nan     0.1000   -0.0000
##    500        0.0028             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1427             nan     0.1000    0.0749
##      2        1.0196             nan     0.1000    0.0583
##      3        0.9187             nan     0.1000    0.0501
##      4        0.8372             nan     0.1000    0.0364
##      5        0.7585             nan     0.1000    0.0373
##      6        0.6944             nan     0.1000    0.0310
##      7        0.6408             nan     0.1000    0.0228
##      8        0.5916             nan     0.1000    0.0223
##      9        0.5511             nan     0.1000    0.0171
##     10        0.5086             nan     0.1000    0.0179
##     20        0.2845             nan     0.1000    0.0051
##     40        0.1448             nan     0.1000   -0.0002
##     60        0.0929             nan     0.1000   -0.0007
##     80        0.0688             nan     0.1000   -0.0006
##    100        0.0513             nan     0.1000   -0.0002
##    120        0.0377             nan     0.1000   -0.0005
##    140        0.0275             nan     0.1000    0.0000
##    160        0.0218             nan     0.1000   -0.0002
##    180        0.0171             nan     0.1000   -0.0001
##    200        0.0129             nan     0.1000   -0.0002
##    220        0.0105             nan     0.1000    0.0000
##    240        0.0089             nan     0.1000   -0.0001
##    260        0.0072             nan     0.1000   -0.0001
##    280        0.0057             nan     0.1000   -0.0001
##    300        0.0047             nan     0.1000   -0.0000
##    320        0.0039             nan     0.1000   -0.0000
##    340        0.0031             nan     0.1000   -0.0001
##    360        0.0025             nan     0.1000   -0.0000
##    380        0.0020             nan     0.1000   -0.0000
##    400        0.0017             nan     0.1000   -0.0000
##    420        0.0014             nan     0.1000   -0.0000
##    440        0.0011             nan     0.1000   -0.0000
##    460        0.0009             nan     0.1000   -0.0000
##    480        0.0007             nan     0.1000   -0.0000
##    500        0.0006             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1334             nan     0.1000    0.0794
##      2        1.0099             nan     0.1000    0.0594
##      3        0.9039             nan     0.1000    0.0491
##      4        0.8165             nan     0.1000    0.0394
##      5        0.7413             nan     0.1000    0.0365
##      6        0.6816             nan     0.1000    0.0262
##      7        0.6199             nan     0.1000    0.0280
##      8        0.5715             nan     0.1000    0.0224
##      9        0.5279             nan     0.1000    0.0191
##     10        0.4896             nan     0.1000    0.0164
##     20        0.2641             nan     0.1000    0.0067
##     40        0.1298             nan     0.1000   -0.0012
##     60        0.0777             nan     0.1000   -0.0009
##     80        0.0517             nan     0.1000   -0.0008
##    100        0.0373             nan     0.1000   -0.0003
##    120        0.0268             nan     0.1000   -0.0001
##    140        0.0195             nan     0.1000   -0.0001
##    160        0.0153             nan     0.1000   -0.0001
##    180        0.0111             nan     0.1000   -0.0001
##    200        0.0087             nan     0.1000   -0.0001
##    220        0.0064             nan     0.1000   -0.0001
##    240        0.0050             nan     0.1000   -0.0001
##    260        0.0041             nan     0.1000   -0.0001
##    280        0.0032             nan     0.1000   -0.0001
##    300        0.0026             nan     0.1000   -0.0000
##    320        0.0020             nan     0.1000   -0.0001
##    340        0.0016             nan     0.1000   -0.0000
##    360        0.0014             nan     0.1000   -0.0000
##    380        0.0011             nan     0.1000    0.0000
##    400        0.0007             nan     0.1000   -0.0000
##    420        0.0006             nan     0.1000   -0.0000
##    440        0.0004             nan     0.1000   -0.0000
##    460        0.0003             nan     0.1000   -0.0000
##    480        0.0002             nan     0.1000   -0.0000
##    500        0.0002             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1248             nan     0.1000    0.0775
##      2        1.0020             nan     0.1000    0.0586
##      3        0.8990             nan     0.1000    0.0477
##      4        0.8099             nan     0.1000    0.0435
##      5        0.7370             nan     0.1000    0.0347
##      6        0.6759             nan     0.1000    0.0305
##      7        0.6180             nan     0.1000    0.0268
##      8        0.5672             nan     0.1000    0.0235
##      9        0.5247             nan     0.1000    0.0178
##     10        0.4872             nan     0.1000    0.0164
##     20        0.2630             nan     0.1000    0.0042
##     40        0.1088             nan     0.1000    0.0004
##     60        0.0607             nan     0.1000    0.0000
##     80        0.0391             nan     0.1000   -0.0005
##    100        0.0253             nan     0.1000   -0.0002
##    120        0.0172             nan     0.1000   -0.0001
##    140        0.0120             nan     0.1000   -0.0001
##    160        0.0089             nan     0.1000    0.0000
##    180        0.0067             nan     0.1000   -0.0001
##    200        0.0053             nan     0.1000    0.0000
##    220        0.0041             nan     0.1000   -0.0002
##    240        0.0032             nan     0.1000   -0.0001
##    260        0.0024             nan     0.1000   -0.0001
##    280        0.0019             nan     0.1000   -0.0000
##    300        0.0015             nan     0.1000   -0.0000
##    320        0.0011             nan     0.1000   -0.0000
##    340        0.0009             nan     0.1000    0.0000
##    360        0.0006             nan     0.1000   -0.0000
##    380        0.0005             nan     0.1000   -0.0000
##    400        0.0004             nan     0.1000    0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000    0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1405             nan     0.1000    0.0695
##      2        1.0179             nan     0.1000    0.0624
##      3        0.9227             nan     0.1000    0.0462
##      4        0.8347             nan     0.1000    0.0442
##      5        0.7557             nan     0.1000    0.0360
##      6        0.6914             nan     0.1000    0.0306
##      7        0.6315             nan     0.1000    0.0277
##      8        0.5833             nan     0.1000    0.0227
##      9        0.5369             nan     0.1000    0.0210
##     10        0.4995             nan     0.1000    0.0160
##     20        0.2695             nan     0.1000    0.0041
##     40        0.1112             nan     0.1000   -0.0004
##     60        0.0621             nan     0.1000   -0.0003
##     80        0.0413             nan     0.1000   -0.0003
##    100        0.0273             nan     0.1000   -0.0004
##    120        0.0177             nan     0.1000   -0.0004
##    140        0.0130             nan     0.1000   -0.0002
##    160        0.0084             nan     0.1000   -0.0001
##    180        0.0063             nan     0.1000   -0.0001
##    200        0.0047             nan     0.1000   -0.0000
##    220        0.0034             nan     0.1000   -0.0000
##    240        0.0023             nan     0.1000    0.0000
##    260        0.0016             nan     0.1000   -0.0000
##    280        0.0014             nan     0.1000    0.0000
##    300        0.0010             nan     0.1000   -0.0000
##    320        0.0008             nan     0.1000   -0.0000
##    340        0.0006             nan     0.1000    0.0000
##    360        0.0004             nan     0.1000   -0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1340             nan     0.1000    0.0695
##      2        1.0140             nan     0.1000    0.0591
##      3        0.9123             nan     0.1000    0.0476
##      4        0.8261             nan     0.1000    0.0388
##      5        0.7502             nan     0.1000    0.0349
##      6        0.6874             nan     0.1000    0.0269
##      7        0.6274             nan     0.1000    0.0272
##      8        0.5803             nan     0.1000    0.0214
##      9        0.5325             nan     0.1000    0.0222
##     10        0.4930             nan     0.1000    0.0163
##     20        0.2691             nan     0.1000    0.0049
##     40        0.1073             nan     0.1000    0.0007
##     60        0.0579             nan     0.1000   -0.0002
##     80        0.0423             nan     0.1000   -0.0016
##    100        0.0279             nan     0.1000   -0.0005
##    120        0.0201             nan     0.1000   -0.0002
##    140        0.0140             nan     0.1000   -0.0003
##    160        0.0107             nan     0.1000   -0.0002
##    180        0.0083             nan     0.1000   -0.0002
##    200        0.0058             nan     0.1000   -0.0002
##    220        0.0045             nan     0.1000   -0.0001
##    240        0.0028             nan     0.1000   -0.0000
##    260        0.0022             nan     0.1000   -0.0001
##    280        0.0018             nan     0.1000   -0.0001
##    300        0.0012             nan     0.1000   -0.0000
##    320        0.0009             nan     0.1000   -0.0000
##    340        0.0007             nan     0.1000   -0.0000
##    360        0.0007             nan     0.1000   -0.0000
##    380        0.0006             nan     0.1000   -0.0000
##    400        0.0004             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0002             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1362             nan     0.1000    0.0804
##      2        1.0097             nan     0.1000    0.0585
##      3        0.9129             nan     0.1000    0.0454
##      4        0.8241             nan     0.1000    0.0439
##      5        0.7510             nan     0.1000    0.0317
##      6        0.6827             nan     0.1000    0.0321
##      7        0.6291             nan     0.1000    0.0241
##      8        0.5812             nan     0.1000    0.0230
##      9        0.5382             nan     0.1000    0.0191
##     10        0.5003             nan     0.1000    0.0169
##     20        0.2621             nan     0.1000    0.0054
##     40        0.1068             nan     0.1000   -0.0005
##     60        0.0557             nan     0.1000   -0.0008
##     80        0.0335             nan     0.1000    0.0004
##    100        0.0210             nan     0.1000   -0.0003
##    120        0.0143             nan     0.1000   -0.0003
##    140        0.0095             nan     0.1000   -0.0001
##    160        0.0061             nan     0.1000   -0.0001
##    180        0.0046             nan     0.1000   -0.0001
##    200        0.0034             nan     0.1000   -0.0001
##    220        0.0025             nan     0.1000   -0.0001
##    240        0.0018             nan     0.1000    0.0000
##    260        0.0015             nan     0.1000   -0.0000
##    280        0.0010             nan     0.1000   -0.0000
##    300        0.0008             nan     0.1000   -0.0000
##    320        0.0006             nan     0.1000   -0.0000
##    340        0.0004             nan     0.1000   -0.0000
##    360        0.0003             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0001             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0000             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1337             nan     0.1000    0.0727
##      2        1.0061             nan     0.1000    0.0577
##      3        0.9016             nan     0.1000    0.0474
##      4        0.8122             nan     0.1000    0.0436
##      5        0.7370             nan     0.1000    0.0352
##      6        0.6708             nan     0.1000    0.0299
##      7        0.6119             nan     0.1000    0.0245
##      8        0.5633             nan     0.1000    0.0212
##      9        0.5194             nan     0.1000    0.0187
##     10        0.4807             nan     0.1000    0.0182
##     20        0.2530             nan     0.1000    0.0040
##     40        0.1104             nan     0.1000   -0.0008
##     60        0.0591             nan     0.1000   -0.0000
##     80        0.0345             nan     0.1000   -0.0002
##    100        0.0237             nan     0.1000   -0.0006
##    120        0.0167             nan     0.1000   -0.0002
##    140        0.0106             nan     0.1000   -0.0002
##    160        0.0069             nan     0.1000   -0.0000
##    180        0.0042             nan     0.1000   -0.0001
##    200        0.0031             nan     0.1000   -0.0001
##    220        0.0025             nan     0.1000   -0.0001
##    240        0.0021             nan     0.1000   -0.0000
##    260        0.0016             nan     0.1000    0.0000
##    280        0.0012             nan     0.1000   -0.0000
##    300        0.0007             nan     0.1000   -0.0000
##    320        0.0005             nan     0.1000   -0.0000
##    340        0.0004             nan     0.1000   -0.0000
##    360        0.0003             nan     0.1000    0.0000
##    380        0.0002             nan     0.1000   -0.0000
##    400        0.0001             nan     0.1000   -0.0000
##    420        0.0001             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0000             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1471             nan     0.1000    0.0669
##      2        1.0395             nan     0.1000    0.0476
##      3        0.9467             nan     0.1000    0.0480
##      4        0.8642             nan     0.1000    0.0397
##      5        0.7925             nan     0.1000    0.0339
##      6        0.7360             nan     0.1000    0.0312
##      7        0.6830             nan     0.1000    0.0254
##      8        0.6341             nan     0.1000    0.0209
##      9        0.5967             nan     0.1000    0.0193
##     10        0.5578             nan     0.1000    0.0167
##     20        0.3561             nan     0.1000    0.0047
##     40        0.2255             nan     0.1000    0.0006
##     60        0.1846             nan     0.1000    0.0009
##     80        0.1637             nan     0.1000   -0.0006
##    100        0.1450             nan     0.1000   -0.0007
##    120        0.1347             nan     0.1000   -0.0012
##    140        0.1281             nan     0.1000   -0.0002
##    160        0.1224             nan     0.1000   -0.0005
##    180        0.1152             nan     0.1000   -0.0009
##    200        0.1113             nan     0.1000   -0.0007
##    220        0.1058             nan     0.1000   -0.0010
##    240        0.1010             nan     0.1000   -0.0009
##    260        0.0994             nan     0.1000   -0.0004
##    280        0.0980             nan     0.1000   -0.0007
##    300        0.0933             nan     0.1000   -0.0003
##    320        0.0911             nan     0.1000   -0.0009
##    340        0.0880             nan     0.1000   -0.0006
##    360        0.0856             nan     0.1000   -0.0009
##    380        0.0851             nan     0.1000   -0.0010
##    400        0.0830             nan     0.1000    0.0000
##    420        0.0821             nan     0.1000   -0.0010
##    440        0.0819             nan     0.1000   -0.0002
##    460        0.0803             nan     0.1000   -0.0003
##    480        0.0795             nan     0.1000   -0.0012
##    500        0.0793             nan     0.1000   -0.0004
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1395             nan     0.1000    0.0737
##      2        1.0166             nan     0.1000    0.0593
##      3        0.9176             nan     0.1000    0.0476
##      4        0.8296             nan     0.1000    0.0431
##      5        0.7546             nan     0.1000    0.0354
##      6        0.6892             nan     0.1000    0.0321
##      7        0.6368             nan     0.1000    0.0240
##      8        0.5899             nan     0.1000    0.0214
##      9        0.5530             nan     0.1000    0.0170
##     10        0.5131             nan     0.1000    0.0179
##     20        0.3005             nan     0.1000    0.0020
##     40        0.1747             nan     0.1000   -0.0007
##     60        0.1349             nan     0.1000   -0.0010
##     80        0.1109             nan     0.1000   -0.0003
##    100        0.0965             nan     0.1000   -0.0012
##    120        0.0858             nan     0.1000   -0.0008
##    140        0.0752             nan     0.1000   -0.0010
##    160        0.0639             nan     0.1000   -0.0006
##    180        0.0569             nan     0.1000   -0.0003
##    200        0.0521             nan     0.1000   -0.0003
##    220        0.0470             nan     0.1000   -0.0007
##    240        0.0429             nan     0.1000   -0.0003
##    260        0.0400             nan     0.1000   -0.0004
##    280        0.0359             nan     0.1000   -0.0005
##    300        0.0327             nan     0.1000   -0.0001
##    320        0.0304             nan     0.1000   -0.0003
##    340        0.0279             nan     0.1000   -0.0002
##    360        0.0255             nan     0.1000   -0.0003
##    380        0.0236             nan     0.1000   -0.0002
##    400        0.0222             nan     0.1000   -0.0001
##    420        0.0203             nan     0.1000   -0.0003
##    440        0.0185             nan     0.1000   -0.0001
##    460        0.0168             nan     0.1000   -0.0001
##    480        0.0151             nan     0.1000    0.0000
##    500        0.0139             nan     0.1000   -0.0001
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1363             nan     0.1000    0.0744
##      2        1.0107             nan     0.1000    0.0608
##      3        0.9083             nan     0.1000    0.0485
##      4        0.8217             nan     0.1000    0.0416
##      5        0.7486             nan     0.1000    0.0362
##      6        0.6839             nan     0.1000    0.0311
##      7        0.6295             nan     0.1000    0.0275
##      8        0.5803             nan     0.1000    0.0226
##      9        0.5365             nan     0.1000    0.0213
##     10        0.4964             nan     0.1000    0.0176
##     20        0.2719             nan     0.1000    0.0047
##     40        0.1518             nan     0.1000   -0.0001
##     60        0.1040             nan     0.1000   -0.0011
##     80        0.0828             nan     0.1000   -0.0007
##    100        0.0648             nan     0.1000   -0.0007
##    120        0.0548             nan     0.1000   -0.0006
##    140        0.0455             nan     0.1000   -0.0005
##    160        0.0361             nan     0.1000   -0.0002
##    180        0.0302             nan     0.1000   -0.0004
##    200        0.0248             nan     0.1000   -0.0001
##    220        0.0210             nan     0.1000   -0.0003
##    240        0.0181             nan     0.1000   -0.0005
##    260        0.0148             nan     0.1000   -0.0003
##    280        0.0126             nan     0.1000   -0.0001
##    300        0.0108             nan     0.1000   -0.0002
##    320        0.0094             nan     0.1000   -0.0000
##    340        0.0079             nan     0.1000   -0.0000
##    360        0.0068             nan     0.1000   -0.0001
##    380        0.0059             nan     0.1000   -0.0000
##    400        0.0050             nan     0.1000   -0.0000
##    420        0.0042             nan     0.1000   -0.0000
##    440        0.0036             nan     0.1000   -0.0000
##    460        0.0032             nan     0.1000   -0.0000
##    480        0.0027             nan     0.1000   -0.0001
##    500        0.0023             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1332             nan     0.1000    0.0718
##      2        1.0043             nan     0.1000    0.0626
##      3        0.9037             nan     0.1000    0.0476
##      4        0.8153             nan     0.1000    0.0417
##      5        0.7432             nan     0.1000    0.0360
##      6        0.6778             nan     0.1000    0.0305
##      7        0.6222             nan     0.1000    0.0265
##      8        0.5731             nan     0.1000    0.0212
##      9        0.5285             nan     0.1000    0.0214
##     10        0.4919             nan     0.1000    0.0145
##     20        0.2679             nan     0.1000    0.0059
##     40        0.1321             nan     0.1000   -0.0000
##     60        0.0846             nan     0.1000   -0.0002
##     80        0.0592             nan     0.1000   -0.0007
##    100        0.0438             nan     0.1000   -0.0005
##    120        0.0341             nan     0.1000   -0.0008
##    140        0.0267             nan     0.1000   -0.0004
##    160        0.0212             nan     0.1000   -0.0004
##    180        0.0173             nan     0.1000   -0.0001
##    200        0.0134             nan     0.1000   -0.0002
##    220        0.0111             nan     0.1000   -0.0000
##    240        0.0090             nan     0.1000   -0.0001
##    260        0.0074             nan     0.1000   -0.0002
##    280        0.0065             nan     0.1000   -0.0002
##    300        0.0047             nan     0.1000    0.0000
##    320        0.0038             nan     0.1000   -0.0000
##    340        0.0030             nan     0.1000   -0.0000
##    360        0.0025             nan     0.1000   -0.0000
##    380        0.0020             nan     0.1000   -0.0000
##    400        0.0016             nan     0.1000   -0.0000
##    420        0.0013             nan     0.1000   -0.0000
##    440        0.0011             nan     0.1000   -0.0000
##    460        0.0008             nan     0.1000   -0.0000
##    480        0.0007             nan     0.1000   -0.0000
##    500        0.0006             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1326             nan     0.1000    0.0707
##      2        1.0062             nan     0.1000    0.0624
##      3        0.9061             nan     0.1000    0.0471
##      4        0.8199             nan     0.1000    0.0409
##      5        0.7473             nan     0.1000    0.0341
##      6        0.6793             nan     0.1000    0.0335
##      7        0.6198             nan     0.1000    0.0291
##      8        0.5707             nan     0.1000    0.0224
##      9        0.5278             nan     0.1000    0.0182
##     10        0.4897             nan     0.1000    0.0177
##     20        0.2684             nan     0.1000    0.0057
##     40        0.1240             nan     0.1000   -0.0009
##     60        0.0747             nan     0.1000   -0.0011
##     80        0.0506             nan     0.1000   -0.0004
##    100        0.0341             nan     0.1000   -0.0001
##    120        0.0249             nan     0.1000   -0.0005
##    140        0.0190             nan     0.1000   -0.0002
##    160        0.0143             nan     0.1000   -0.0002
##    180        0.0098             nan     0.1000   -0.0002
##    200        0.0077             nan     0.1000   -0.0001
##    220        0.0059             nan     0.1000   -0.0001
##    240        0.0049             nan     0.1000   -0.0001
##    260        0.0038             nan     0.1000   -0.0000
##    280        0.0027             nan     0.1000   -0.0000
##    300        0.0022             nan     0.1000   -0.0000
##    320        0.0017             nan     0.1000   -0.0000
##    340        0.0014             nan     0.1000   -0.0000
##    360        0.0012             nan     0.1000   -0.0000
##    380        0.0010             nan     0.1000   -0.0000
##    400        0.0008             nan     0.1000   -0.0000
##    420        0.0006             nan     0.1000   -0.0000
##    440        0.0005             nan     0.1000   -0.0000
##    460        0.0004             nan     0.1000   -0.0000
##    480        0.0003             nan     0.1000   -0.0000
##    500        0.0003             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1308             nan     0.1000    0.0746
##      2        1.0121             nan     0.1000    0.0532
##      3        0.9102             nan     0.1000    0.0509
##      4        0.8202             nan     0.1000    0.0442
##      5        0.7403             nan     0.1000    0.0397
##      6        0.6793             nan     0.1000    0.0267
##      7        0.6225             nan     0.1000    0.0232
##      8        0.5744             nan     0.1000    0.0216
##      9        0.5328             nan     0.1000    0.0194
##     10        0.4925             nan     0.1000    0.0157
##     20        0.2594             nan     0.1000    0.0057
##     40        0.1121             nan     0.1000    0.0010
##     60        0.0715             nan     0.1000   -0.0010
##     80        0.0484             nan     0.1000   -0.0006
##    100        0.0311             nan     0.1000   -0.0004
##    120        0.0246             nan     0.1000   -0.0005
##    140        0.0161             nan     0.1000   -0.0003
##    160        0.0126             nan     0.1000   -0.0003
##    180        0.0083             nan     0.1000   -0.0001
##    200        0.0066             nan     0.1000   -0.0000
##    220        0.0052             nan     0.1000   -0.0001
##    240        0.0039             nan     0.1000   -0.0001
##    260        0.0030             nan     0.1000   -0.0000
##    280        0.0025             nan     0.1000   -0.0001
##    300        0.0020             nan     0.1000   -0.0001
##    320        0.0015             nan     0.1000   -0.0000
##    340        0.0011             nan     0.1000   -0.0000
##    360        0.0008             nan     0.1000   -0.0000
##    380        0.0007             nan     0.1000   -0.0000
##    400        0.0005             nan     0.1000   -0.0000
##    420        0.0004             nan     0.1000   -0.0000
##    440        0.0003             nan     0.1000   -0.0000
##    460        0.0002             nan     0.1000    0.0000
##    480        0.0002             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1283             nan     0.1000    0.0768
##      2        1.0007             nan     0.1000    0.0611
##      3        0.9010             nan     0.1000    0.0492
##      4        0.8157             nan     0.1000    0.0424
##      5        0.7444             nan     0.1000    0.0333
##      6        0.6805             nan     0.1000    0.0307
##      7        0.6230             nan     0.1000    0.0269
##      8        0.5742             nan     0.1000    0.0225
##      9        0.5330             nan     0.1000    0.0185
##     10        0.4946             nan     0.1000    0.0150
##     20        0.2604             nan     0.1000    0.0038
##     40        0.1100             nan     0.1000   -0.0004
##     60        0.0613             nan     0.1000   -0.0004
##     80        0.0365             nan     0.1000   -0.0005
##    100        0.0247             nan     0.1000   -0.0003
##    120        0.0166             nan     0.1000   -0.0003
##    140        0.0117             nan     0.1000   -0.0002
##    160        0.0087             nan     0.1000   -0.0002
##    180        0.0061             nan     0.1000   -0.0002
##    200        0.0044             nan     0.1000   -0.0001
##    220        0.0036             nan     0.1000   -0.0001
##    240        0.0033             nan     0.1000   -0.0001
##    260        0.0019             nan     0.1000    0.0000
##    280        0.0012             nan     0.1000   -0.0000
##    300        0.0009             nan     0.1000   -0.0000
##    320        0.0007             nan     0.1000   -0.0000
##    340        0.0006             nan     0.1000   -0.0000
##    360        0.0005             nan     0.1000   -0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000    0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1352             nan     0.1000    0.0764
##      2        1.0084             nan     0.1000    0.0584
##      3        0.9052             nan     0.1000    0.0501
##      4        0.8148             nan     0.1000    0.0448
##      5        0.7366             nan     0.1000    0.0350
##      6        0.6703             nan     0.1000    0.0299
##      7        0.6151             nan     0.1000    0.0228
##      8        0.5661             nan     0.1000    0.0225
##      9        0.5250             nan     0.1000    0.0171
##     10        0.4912             nan     0.1000    0.0151
##     20        0.2587             nan     0.1000    0.0051
##     40        0.1114             nan     0.1000   -0.0002
##     60        0.0599             nan     0.1000   -0.0007
##     80        0.0386             nan     0.1000   -0.0001
##    100        0.0257             nan     0.1000   -0.0005
##    120        0.0181             nan     0.1000   -0.0002
##    140        0.0136             nan     0.1000   -0.0004
##    160        0.0086             nan     0.1000   -0.0003
##    180        0.0060             nan     0.1000   -0.0000
##    200        0.0044             nan     0.1000   -0.0001
##    220        0.0030             nan     0.1000   -0.0000
##    240        0.0020             nan     0.1000   -0.0001
##    260        0.0016             nan     0.1000   -0.0000
##    280        0.0012             nan     0.1000    0.0000
##    300        0.0009             nan     0.1000   -0.0000
##    320        0.0006             nan     0.1000   -0.0000
##    340        0.0005             nan     0.1000   -0.0000
##    360        0.0003             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0001             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0000             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1267             nan     0.1000    0.0806
##      2        1.0060             nan     0.1000    0.0571
##      3        0.8980             nan     0.1000    0.0502
##      4        0.8139             nan     0.1000    0.0377
##      5        0.7393             nan     0.1000    0.0348
##      6        0.6725             nan     0.1000    0.0301
##      7        0.6162             nan     0.1000    0.0267
##      8        0.5647             nan     0.1000    0.0247
##      9        0.5224             nan     0.1000    0.0188
##     10        0.4812             nan     0.1000    0.0188
##     20        0.2533             nan     0.1000    0.0050
##     40        0.0996             nan     0.1000   -0.0003
##     60        0.0584             nan     0.1000   -0.0003
##     80        0.0369             nan     0.1000   -0.0007
##    100        0.0250             nan     0.1000   -0.0003
##    120        0.0185             nan     0.1000   -0.0002
##    140        0.0129             nan     0.1000   -0.0004
##    160        0.0094             nan     0.1000    0.0000
##    180        0.0064             nan     0.1000   -0.0001
##    200        0.0047             nan     0.1000   -0.0000
##    220        0.0040             nan     0.1000   -0.0001
##    240        0.0029             nan     0.1000   -0.0001
##    260        0.0024             nan     0.1000   -0.0000
##    280        0.0018             nan     0.1000   -0.0001
##    300        0.0013             nan     0.1000    0.0000
##    320        0.0010             nan     0.1000   -0.0000
##    340        0.0008             nan     0.1000   -0.0000
##    360        0.0006             nan     0.1000   -0.0000
##    380        0.0004             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1361             nan     0.1000    0.0664
##      2        1.0081             nan     0.1000    0.0651
##      3        0.9089             nan     0.1000    0.0453
##      4        0.8241             nan     0.1000    0.0398
##      5        0.7504             nan     0.1000    0.0361
##      6        0.6853             nan     0.1000    0.0304
##      7        0.6270             nan     0.1000    0.0261
##      8        0.5760             nan     0.1000    0.0231
##      9        0.5284             nan     0.1000    0.0222
##     10        0.4886             nan     0.1000    0.0174
##     20        0.2662             nan     0.1000    0.0037
##     40        0.1074             nan     0.1000    0.0010
##     60        0.0615             nan     0.1000   -0.0005
##     80        0.0426             nan     0.1000   -0.0008
##    100        0.0281             nan     0.1000   -0.0009
##    120        0.0195             nan     0.1000   -0.0003
##    140        0.0139             nan     0.1000   -0.0004
##    160        0.0109             nan     0.1000   -0.0001
##    180        0.0088             nan     0.1000   -0.0004
##    200        0.0062             nan     0.1000   -0.0001
##    220        0.0046             nan     0.1000   -0.0001
##    240        0.0031             nan     0.1000   -0.0001
##    260        0.0024             nan     0.1000   -0.0001
##    280        0.0015             nan     0.1000    0.0000
##    300        0.0013             nan     0.1000   -0.0001
##    320        0.0008             nan     0.1000   -0.0000
##    340        0.0006             nan     0.1000   -0.0000
##    360        0.0004             nan     0.1000   -0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000    0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1486             nan     0.1000    0.0693
##      2        1.0371             nan     0.1000    0.0560
##      3        0.9406             nan     0.1000    0.0438
##      4        0.8594             nan     0.1000    0.0364
##      5        0.7884             nan     0.1000    0.0352
##      6        0.7323             nan     0.1000    0.0272
##      7        0.6816             nan     0.1000    0.0256
##      8        0.6412             nan     0.1000    0.0166
##      9        0.6004             nan     0.1000    0.0184
##     10        0.5655             nan     0.1000    0.0174
##     20        0.3605             nan     0.1000    0.0051
##     40        0.2219             nan     0.1000   -0.0007
##     60        0.1806             nan     0.1000   -0.0010
##     80        0.1580             nan     0.1000   -0.0006
##    100        0.1361             nan     0.1000   -0.0006
##    120        0.1212             nan     0.1000   -0.0001
##    140        0.1068             nan     0.1000    0.0003
##    160        0.0988             nan     0.1000   -0.0004
##    180        0.0948             nan     0.1000   -0.0017
##    200        0.0908             nan     0.1000   -0.0010
##    220        0.0884             nan     0.1000   -0.0003
##    240        0.0857             nan     0.1000   -0.0004
##    260        0.0807             nan     0.1000   -0.0011
##    280        0.0773             nan     0.1000   -0.0004
##    300        0.0755             nan     0.1000   -0.0007
##    320        0.0729             nan     0.1000   -0.0002
##    340        0.0713             nan     0.1000   -0.0006
##    360        0.0693             nan     0.1000   -0.0005
##    380        0.0675             nan     0.1000   -0.0005
##    400        0.0667             nan     0.1000   -0.0008
##    420        0.0660             nan     0.1000   -0.0005
##    440        0.0652             nan     0.1000   -0.0003
##    460        0.0632             nan     0.1000   -0.0008
##    480        0.0623             nan     0.1000   -0.0005
##    500        0.0611             nan     0.1000   -0.0006
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1349             nan     0.1000    0.0777
##      2        1.0132             nan     0.1000    0.0609
##      3        0.9132             nan     0.1000    0.0517
##      4        0.8297             nan     0.1000    0.0381
##      5        0.7573             nan     0.1000    0.0347
##      6        0.6954             nan     0.1000    0.0284
##      7        0.6449             nan     0.1000    0.0250
##      8        0.5947             nan     0.1000    0.0230
##      9        0.5526             nan     0.1000    0.0194
##     10        0.5134             nan     0.1000    0.0174
##     20        0.2947             nan     0.1000    0.0066
##     40        0.1715             nan     0.1000   -0.0005
##     60        0.1244             nan     0.1000   -0.0012
##     80        0.0971             nan     0.1000   -0.0002
##    100        0.0797             nan     0.1000   -0.0006
##    120        0.0681             nan     0.1000   -0.0004
##    140        0.0593             nan     0.1000   -0.0000
##    160        0.0519             nan     0.1000   -0.0007
##    180        0.0451             nan     0.1000   -0.0003
##    200        0.0404             nan     0.1000   -0.0002
##    220        0.0362             nan     0.1000   -0.0004
##    240        0.0321             nan     0.1000   -0.0002
##    260        0.0288             nan     0.1000   -0.0002
##    280        0.0250             nan     0.1000   -0.0002
##    300        0.0223             nan     0.1000   -0.0001
##    320        0.0208             nan     0.1000   -0.0002
##    340        0.0188             nan     0.1000   -0.0003
##    360        0.0159             nan     0.1000   -0.0001
##    380        0.0140             nan     0.1000   -0.0002
##    400        0.0123             nan     0.1000   -0.0001
##    420        0.0110             nan     0.1000   -0.0002
##    440        0.0104             nan     0.1000   -0.0000
##    460        0.0093             nan     0.1000   -0.0001
##    480        0.0082             nan     0.1000   -0.0001
##    500        0.0077             nan     0.1000   -0.0001
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1351             nan     0.1000    0.0762
##      2        1.0134             nan     0.1000    0.0566
##      3        0.9129             nan     0.1000    0.0478
##      4        0.8316             nan     0.1000    0.0415
##      5        0.7607             nan     0.1000    0.0349
##      6        0.6939             nan     0.1000    0.0330
##      7        0.6405             nan     0.1000    0.0233
##      8        0.5900             nan     0.1000    0.0245
##      9        0.5457             nan     0.1000    0.0215
##     10        0.5070             nan     0.1000    0.0177
##     20        0.2786             nan     0.1000    0.0050
##     40        0.1375             nan     0.1000    0.0005
##     60        0.0947             nan     0.1000   -0.0005
##     80        0.0720             nan     0.1000   -0.0010
##    100        0.0542             nan     0.1000   -0.0005
##    120        0.0409             nan     0.1000   -0.0005
##    140        0.0331             nan     0.1000   -0.0005
##    160        0.0265             nan     0.1000   -0.0001
##    180        0.0225             nan     0.1000   -0.0004
##    200        0.0189             nan     0.1000   -0.0001
##    220        0.0157             nan     0.1000   -0.0002
##    240        0.0127             nan     0.1000   -0.0000
##    260        0.0109             nan     0.1000   -0.0001
##    280        0.0096             nan     0.1000   -0.0002
##    300        0.0080             nan     0.1000   -0.0000
##    320        0.0067             nan     0.1000   -0.0001
##    340        0.0057             nan     0.1000   -0.0001
##    360        0.0049             nan     0.1000   -0.0000
##    380        0.0040             nan     0.1000   -0.0000
##    400        0.0034             nan     0.1000   -0.0001
##    420        0.0029             nan     0.1000   -0.0000
##    440        0.0024             nan     0.1000   -0.0000
##    460        0.0021             nan     0.1000   -0.0000
##    480        0.0017             nan     0.1000    0.0000
##    500        0.0015             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1318             nan     0.1000    0.0754
##      2        1.0063             nan     0.1000    0.0592
##      3        0.9009             nan     0.1000    0.0511
##      4        0.8209             nan     0.1000    0.0364
##      5        0.7432             nan     0.1000    0.0359
##      6        0.6806             nan     0.1000    0.0277
##      7        0.6278             nan     0.1000    0.0232
##      8        0.5800             nan     0.1000    0.0202
##      9        0.5356             nan     0.1000    0.0220
##     10        0.4961             nan     0.1000    0.0178
##     20        0.2662             nan     0.1000    0.0056
##     40        0.1219             nan     0.1000   -0.0004
##     60        0.0757             nan     0.1000   -0.0003
##     80        0.0520             nan     0.1000   -0.0006
##    100        0.0357             nan     0.1000   -0.0002
##    120        0.0248             nan     0.1000   -0.0003
##    140        0.0182             nan     0.1000   -0.0003
##    160        0.0143             nan     0.1000   -0.0002
##    180        0.0109             nan     0.1000   -0.0001
##    200        0.0083             nan     0.1000   -0.0001
##    220        0.0064             nan     0.1000    0.0000
##    240        0.0052             nan     0.1000   -0.0000
##    260        0.0044             nan     0.1000   -0.0001
##    280        0.0035             nan     0.1000   -0.0000
##    300        0.0027             nan     0.1000   -0.0000
##    320        0.0022             nan     0.1000   -0.0000
##    340        0.0019             nan     0.1000   -0.0000
##    360        0.0017             nan     0.1000   -0.0000
##    380        0.0013             nan     0.1000   -0.0000
##    400        0.0012             nan     0.1000   -0.0000
##    420        0.0009             nan     0.1000    0.0000
##    440        0.0008             nan     0.1000   -0.0000
##    460        0.0006             nan     0.1000   -0.0000
##    480        0.0005             nan     0.1000   -0.0000
##    500        0.0004             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1364             nan     0.1000    0.0751
##      2        1.0112             nan     0.1000    0.0606
##      3        0.9097             nan     0.1000    0.0465
##      4        0.8215             nan     0.1000    0.0454
##      5        0.7483             nan     0.1000    0.0345
##      6        0.6827             nan     0.1000    0.0306
##      7        0.6260             nan     0.1000    0.0263
##      8        0.5801             nan     0.1000    0.0206
##      9        0.5385             nan     0.1000    0.0189
##     10        0.4988             nan     0.1000    0.0174
##     20        0.2617             nan     0.1000    0.0055
##     40        0.1155             nan     0.1000    0.0008
##     60        0.0686             nan     0.1000   -0.0007
##     80        0.0461             nan     0.1000   -0.0011
##    100        0.0304             nan     0.1000   -0.0003
##    120        0.0207             nan     0.1000   -0.0004
##    140        0.0150             nan     0.1000   -0.0002
##    160        0.0110             nan     0.1000   -0.0002
##    180        0.0088             nan     0.1000   -0.0001
##    200        0.0065             nan     0.1000   -0.0001
##    220        0.0050             nan     0.1000   -0.0001
##    240        0.0034             nan     0.1000   -0.0000
##    260        0.0024             nan     0.1000   -0.0000
##    280        0.0018             nan     0.1000   -0.0000
##    300        0.0013             nan     0.1000   -0.0000
##    320        0.0010             nan     0.1000   -0.0000
##    340        0.0007             nan     0.1000   -0.0000
##    360        0.0006             nan     0.1000   -0.0000
##    380        0.0005             nan     0.1000   -0.0000
##    400        0.0004             nan     0.1000   -0.0000
##    420        0.0003             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000    0.0000
##    460        0.0002             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000    0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1330             nan     0.1000    0.0734
##      2        1.0096             nan     0.1000    0.0591
##      3        0.9074             nan     0.1000    0.0469
##      4        0.8213             nan     0.1000    0.0385
##      5        0.7415             nan     0.1000    0.0383
##      6        0.6770             nan     0.1000    0.0276
##      7        0.6268             nan     0.1000    0.0220
##      8        0.5734             nan     0.1000    0.0236
##      9        0.5348             nan     0.1000    0.0167
##     10        0.4971             nan     0.1000    0.0165
##     20        0.2641             nan     0.1000    0.0071
##     40        0.1133             nan     0.1000    0.0010
##     60        0.0645             nan     0.1000   -0.0004
##     80        0.0414             nan     0.1000   -0.0003
##    100        0.0261             nan     0.1000   -0.0002
##    120        0.0166             nan     0.1000   -0.0002
##    140        0.0104             nan     0.1000   -0.0002
##    160        0.0075             nan     0.1000   -0.0001
##    180        0.0058             nan     0.1000   -0.0001
##    200        0.0042             nan     0.1000    0.0000
##    220        0.0031             nan     0.1000   -0.0001
##    240        0.0025             nan     0.1000   -0.0000
##    260        0.0016             nan     0.1000   -0.0000
##    280        0.0013             nan     0.1000   -0.0000
##    300        0.0009             nan     0.1000   -0.0000
##    320        0.0008             nan     0.1000   -0.0000
##    340        0.0005             nan     0.1000   -0.0000
##    360        0.0004             nan     0.1000    0.0000
##    380        0.0003             nan     0.1000   -0.0000
##    400        0.0003             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0002             nan     0.1000    0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1286             nan     0.1000    0.0762
##      2        1.0057             nan     0.1000    0.0573
##      3        0.9064             nan     0.1000    0.0462
##      4        0.8172             nan     0.1000    0.0419
##      5        0.7359             nan     0.1000    0.0343
##      6        0.6717             nan     0.1000    0.0288
##      7        0.6160             nan     0.1000    0.0274
##      8        0.5663             nan     0.1000    0.0222
##      9        0.5248             nan     0.1000    0.0180
##     10        0.4829             nan     0.1000    0.0196
##     20        0.2619             nan     0.1000    0.0035
##     40        0.1219             nan     0.1000   -0.0006
##     60        0.0619             nan     0.1000    0.0003
##     80        0.0326             nan     0.1000   -0.0004
##    100        0.0218             nan     0.1000   -0.0005
##    120        0.0159             nan     0.1000   -0.0001
##    140        0.0099             nan     0.1000    0.0000
##    160        0.0070             nan     0.1000   -0.0002
##    180        0.0043             nan     0.1000    0.0000
##    200        0.0031             nan     0.1000   -0.0000
##    220        0.0023             nan     0.1000   -0.0001
##    240        0.0017             nan     0.1000   -0.0000
##    260        0.0013             nan     0.1000   -0.0000
##    280        0.0009             nan     0.1000   -0.0000
##    300        0.0006             nan     0.1000   -0.0000
##    320        0.0005             nan     0.1000   -0.0000
##    340        0.0003             nan     0.1000   -0.0000
##    360        0.0002             nan     0.1000   -0.0000
##    380        0.0002             nan     0.1000   -0.0000
##    400        0.0001             nan     0.1000   -0.0000
##    420        0.0001             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0001             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000    0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1362             nan     0.1000    0.0808
##      2        1.0087             nan     0.1000    0.0627
##      3        0.9071             nan     0.1000    0.0496
##      4        0.8208             nan     0.1000    0.0404
##      5        0.7422             nan     0.1000    0.0380
##      6        0.6746             nan     0.1000    0.0337
##      7        0.6199             nan     0.1000    0.0245
##      8        0.5742             nan     0.1000    0.0207
##      9        0.5314             nan     0.1000    0.0183
##     10        0.4905             nan     0.1000    0.0187
##     20        0.2531             nan     0.1000    0.0047
##     40        0.0954             nan     0.1000   -0.0000
##     60        0.0461             nan     0.1000   -0.0008
##     80        0.0293             nan     0.1000    0.0001
##    100        0.0168             nan     0.1000   -0.0002
##    120        0.0124             nan     0.1000   -0.0003
##    140        0.0078             nan     0.1000   -0.0000
##    160        0.0051             nan     0.1000   -0.0001
##    180        0.0034             nan     0.1000   -0.0000
##    200        0.0026             nan     0.1000   -0.0001
##    220        0.0021             nan     0.1000   -0.0001
##    240        0.0013             nan     0.1000   -0.0000
##    260        0.0009             nan     0.1000    0.0000
##    280        0.0006             nan     0.1000   -0.0000
##    300        0.0005             nan     0.1000   -0.0000
##    320        0.0004             nan     0.1000   -0.0000
##    340        0.0003             nan     0.1000   -0.0000
##    360        0.0002             nan     0.1000   -0.0000
##    380        0.0002             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0001             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0000             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000    0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1323             nan     0.1000    0.0686
##      2        1.0041             nan     0.1000    0.0634
##      3        0.9017             nan     0.1000    0.0489
##      4        0.8171             nan     0.1000    0.0392
##      5        0.7430             nan     0.1000    0.0370
##      6        0.6819             nan     0.1000    0.0291
##      7        0.6218             nan     0.1000    0.0278
##      8        0.5762             nan     0.1000    0.0219
##      9        0.5329             nan     0.1000    0.0203
##     10        0.4941             nan     0.1000    0.0174
##     20        0.2651             nan     0.1000    0.0068
##     40        0.1003             nan     0.1000    0.0006
##     60        0.0534             nan     0.1000   -0.0007
##     80        0.0307             nan     0.1000   -0.0000
##    100        0.0199             nan     0.1000   -0.0002
##    120        0.0137             nan     0.1000   -0.0001
##    140        0.0099             nan     0.1000   -0.0001
##    160        0.0067             nan     0.1000   -0.0001
##    180        0.0056             nan     0.1000   -0.0002
##    200        0.0035             nan     0.1000   -0.0001
##    220        0.0031             nan     0.1000   -0.0001
##    240        0.0018             nan     0.1000   -0.0000
##    260        0.0013             nan     0.1000   -0.0001
##    280        0.0009             nan     0.1000   -0.0000
##    300        0.0006             nan     0.1000   -0.0000
##    320        0.0005             nan     0.1000   -0.0000
##    340        0.0004             nan     0.1000   -0.0000
##    360        0.0002             nan     0.1000   -0.0000
##    380        0.0002             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000   -0.0000
##    420        0.0002             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000    0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0002             nan     0.1000   -0.0000
##    500        0.0001             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1306             nan     0.1000    0.0777
##      2        1.0014             nan     0.1000    0.0570
##      3        0.9031             nan     0.1000    0.0472
##      4        0.8138             nan     0.1000    0.0431
##      5        0.7376             nan     0.1000    0.0373
##      6        0.6692             nan     0.1000    0.0302
##      7        0.6136             nan     0.1000    0.0251
##      8        0.5644             nan     0.1000    0.0224
##      9        0.5192             nan     0.1000    0.0199
##     10        0.4827             nan     0.1000    0.0155
##     20        0.2548             nan     0.1000    0.0058
##     40        0.0993             nan     0.1000   -0.0003
##     60        0.0497             nan     0.1000   -0.0008
##     80        0.0277             nan     0.1000   -0.0002
##    100        0.0177             nan     0.1000   -0.0005
##    120        0.0103             nan     0.1000   -0.0001
##    140        0.0078             nan     0.1000   -0.0002
##    160        0.0050             nan     0.1000   -0.0000
##    180        0.0040             nan     0.1000   -0.0000
##    200        0.0025             nan     0.1000   -0.0000
##    220        0.0020             nan     0.1000   -0.0001
##    240        0.0017             nan     0.1000   -0.0000
##    260        0.0011             nan     0.1000    0.0000
##    280        0.0009             nan     0.1000   -0.0000
##    300        0.0006             nan     0.1000   -0.0000
##    320        0.0004             nan     0.1000   -0.0000
##    340        0.0003             nan     0.1000   -0.0000
##    360        0.0004             nan     0.1000   -0.0000
##    380        0.0002             nan     0.1000   -0.0000
##    400        0.0001             nan     0.1000    0.0000
##    420        0.0001             nan     0.1000   -0.0000
##    440        0.0001             nan     0.1000   -0.0000
##    460        0.0001             nan     0.1000   -0.0000
##    480        0.0000             nan     0.1000   -0.0000
##    500        0.0000             nan     0.1000   -0.0000
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.1327             nan     0.1000    0.0755
##      2        1.0091             nan     0.1000    0.0614
##      3        0.9077             nan     0.1000    0.0485
##      4        0.8170             nan     0.1000    0.0413
##      5        0.7433             nan     0.1000    0.0334
##      6        0.6796             nan     0.1000    0.0305
##      7        0.6249             nan     0.1000    0.0245
##      8        0.5745             nan     0.1000    0.0228
##      9        0.5307             nan     0.1000    0.0196
##     10        0.4929             nan     0.1000    0.0159
##     20        0.2697             nan     0.1000    0.0047
##     40        0.1085             nan     0.1000    0.0005
##     60        0.0583             nan     0.1000   -0.0005
##     80        0.0370             nan     0.1000   -0.0004
##    100        0.0242             nan     0.1000   -0.0005
##    120        0.0177             nan     0.1000   -0.0005
##    140        0.0110             nan     0.1000   -0.0001
##    160        0.0076             nan     0.1000   -0.0001
##    180        0.0052             nan     0.1000   -0.0001
##    200        0.0035             nan     0.1000   -0.0000
##    220        0.0023             nan     0.1000   -0.0000
##    240        0.0017             nan     0.1000   -0.0000
##    260        0.0013             nan     0.1000   -0.0000
##    280        0.0009             nan     0.1000   -0.0000
##    300        0.0007             nan     0.1000   -0.0000
##    320        0.0005             nan     0.1000   -0.0000
##    340        0.0004             nan     0.1000    0.0000
##    360        0.0003             nan     0.1000   -0.0000
##    380        0.0002             nan     0.1000   -0.0000
##    400        0.0002             nan     0.1000    0.0000</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="machine-learning.html#cb53-1"></a><span class="kw">summary</span>(gbm)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-4-1.png" width="672" /></p>
<pre><code>##                                 var      rel.inf
## Cell.size.L             Cell.size.L 3.762217e+01
## Cell.shape.L           Cell.shape.L 3.410643e+01
## Cl.thickness.L       Cl.thickness.L 5.300737e+00
## Epith.c.size.Q       Epith.c.size.Q 2.270009e+00
## Cell.size^5             Cell.size^5 1.832493e+00
## Marg.adhesion.L     Marg.adhesion.L 1.692787e+00
## Epith.c.size.L       Epith.c.size.L 1.592017e+00
## Cell.size^6             Cell.size^6 1.421087e+00
## Marg.adhesion.Q     Marg.adhesion.Q 9.740727e-01
## Marg.adhesion^9     Marg.adhesion^9 9.281401e-01
## Marg.adhesion^5     Marg.adhesion^5 7.599278e-01
## Epith.c.size^8       Epith.c.size^8 6.202545e-01
## Cell.size^7             Cell.size^7 5.262077e-01
## Cell.shape^8           Cell.shape^8 5.251158e-01
## Epith.c.size^9       Epith.c.size^9 5.191550e-01
## Cl.thickness^9       Cl.thickness^9 5.058204e-01
## Bl.cromatin4           Bl.cromatin4 4.860685e-01
## Marg.adhesion^4     Marg.adhesion^4 4.419548e-01
## Cell.size^9             Cell.size^9 4.251802e-01
## Cell.shape^9           Cell.shape^9 4.075587e-01
## Epith.c.size^6       Epith.c.size^6 3.983203e-01
## Cell.size^8             Cell.size^8 3.935835e-01
## Cell.shape^7           Cell.shape^7 3.850965e-01
## Cell.shape.Q           Cell.shape.Q 3.674735e-01
## Marg.adhesion^8     Marg.adhesion^8 3.540357e-01
## Cell.shape^4           Cell.shape^4 3.395992e-01
## Cl.thickness.Q       Cl.thickness.Q 3.235096e-01
## Marg.adhesion.C     Marg.adhesion.C 3.179329e-01
## Cell.size.C             Cell.size.C 3.073359e-01
## Cl.thickness^4       Cl.thickness^4 2.900184e-01
## Bl.cromatin5           Bl.cromatin5 2.766143e-01
## Cell.shape.C           Cell.shape.C 2.732635e-01
## Cell.size.Q             Cell.size.Q 2.473414e-01
## Cl.thickness^7       Cl.thickness^7 2.454652e-01
## Cell.size^4             Cell.size^4 2.326584e-01
## Epith.c.size^7       Epith.c.size^7 2.325282e-01
## Marg.adhesion^7     Marg.adhesion^7 2.289592e-01
## Marg.adhesion^6     Marg.adhesion^6 1.967629e-01
## Normal.nucleoli10 Normal.nucleoli10 1.962180e-01
## Cl.thickness^6       Cl.thickness^6 1.725714e-01
## Cl.thickness^8       Cl.thickness^8 1.623151e-01
## Bl.cromatin3           Bl.cromatin3 1.505009e-01
## Normal.nucleoli8   Normal.nucleoli8 1.204623e-01
## Epith.c.size.C       Epith.c.size.C 1.199819e-01
## Cell.shape^6           Cell.shape^6 1.194549e-01
## Cl.thickness.C       Cl.thickness.C 1.064451e-01
## Cl.thickness^5       Cl.thickness^5 9.411520e-02
## Epith.c.size^5       Epith.c.size^5 9.274469e-02
## Normal.nucleoli4   Normal.nucleoli4 7.671772e-02
## Bl.cromatin7           Bl.cromatin7 4.823597e-02
## Epith.c.size^4       Epith.c.size^4 4.565179e-02
## Mitoses2                   Mitoses2 4.446334e-02
## Cell.shape^5           Cell.shape^5 4.141406e-02
## Bl.cromatin8           Bl.cromatin8 1.488719e-02
## Normal.nucleoli6   Normal.nucleoli6 1.187680e-02
## Normal.nucleoli2   Normal.nucleoli2 8.207888e-03
## Normal.nucleoli3   Normal.nucleoli3 5.884371e-03
## Bl.cromatin2           Bl.cromatin2 1.012618e-04
## Normal.nucleoli7   Normal.nucleoli7 6.499138e-05
## Mitoses3                   Mitoses3 3.593587e-07
## Bl.cromatin6           Bl.cromatin6 0.000000e+00
## Bl.cromatin9           Bl.cromatin9 0.000000e+00
## Bl.cromatin10         Bl.cromatin10 0.000000e+00
## Normal.nucleoli5   Normal.nucleoli5 0.000000e+00
## Normal.nucleoli9   Normal.nucleoli9 0.000000e+00
## Mitoses4                   Mitoses4 0.000000e+00
## Mitoses5                   Mitoses5 0.000000e+00
## Mitoses6                   Mitoses6 0.000000e+00
## Mitoses7                   Mitoses7 0.000000e+00
## Mitoses8                   Mitoses8 0.000000e+00
## Mitoses10                 Mitoses10 0.000000e+00</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="machine-learning.html#cb55-1"></a>pred_gbm&lt;-<span class="kw">predict</span>(gbm,BreastCancer)</span>
<span id="cb55-2"><a href="machine-learning.html#cb55-2"></a><span class="kw">confusionMatrix</span>(pred_gbm, BreastCancer<span class="op">$</span>Class)</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##            Reference
## Prediction  benign malignant
##   benign       456        10
##   malignant      2       231
##                                           
##                Accuracy : 0.9828          
##                  95% CI : (0.9702, 0.9911)
##     No Information Rate : 0.6552          
##     P-Value [Acc &gt; NIR] : &lt; 2e-16         
##                                           
##                   Kappa : 0.9617          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.04331         
##                                           
##             Sensitivity : 0.9956          
##             Specificity : 0.9585          
##          Pos Pred Value : 0.9785          
##          Neg Pred Value : 0.9914          
##              Prevalence : 0.6552          
##          Detection Rate : 0.6524          
##    Detection Prevalence : 0.6667          
##       Balanced Accuracy : 0.9771          
##                                           
##        &#39;Positive&#39; Class : benign          
## </code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="machine-learning.html#cb57-1"></a>roc_gbm&lt;-pROC<span class="op">::</span><span class="kw">roc</span>(BreastCancer<span class="op">$</span>Class, <span class="kw">as.numeric</span>(pred_gbm))</span></code></pre></div>
<pre><code>## Setting levels: control = benign, case = malignant</code></pre>
<pre><code>## Setting direction: controls &lt; cases</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="machine-learning.html#cb60-1"></a>roc_gbm</span></code></pre></div>
<pre><code>## 
## Call:
## roc.default(response = BreastCancer$Class, predictor = as.numeric(pred_gbm))
## 
## Data: as.numeric(pred_gbm) in 458 controls (BreastCancer$Class benign) &lt; 241 cases (BreastCancer$Class malignant).
## Area under the curve: 0.9771</code></pre>
<div id="extreme-gradient-boost-machine" class="section level3">
<h3><span class="header-section-number">6.3.1</span> Extreme gradient boost machine</h3>
<p>In the examples above, the outcome variable is treated as a factor. Extreme gradient boost machine <em>xgboost</em> requires conversion to numeric variable.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="machine-learning.html#cb62-1"></a><span class="kw">library</span>(xgboost)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;xgboost&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     slice</code></pre>
<pre><code>## The following object is masked from &#39;package:rattle&#39;:
## 
##     xgboost</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="machine-learning.html#cb66-1"></a><span class="kw">library</span>(caret)</span>
<span id="cb66-2"><a href="machine-learning.html#cb66-2"></a></span>
<span id="cb66-3"><a href="machine-learning.html#cb66-3"></a><span class="kw">data</span>(<span class="st">&quot;BreastCancer&quot;</span>,<span class="dt">package =</span> <span class="st">&quot;mlbench&quot;</span>)</span>
<span id="cb66-4"><a href="machine-learning.html#cb66-4"></a><span class="co">#predict breast cancer</span></span>
<span id="cb66-5"><a href="machine-learning.html#cb66-5"></a></span>
<span id="cb66-6"><a href="machine-learning.html#cb66-6"></a>BreastCancer<span class="op">$</span>Class&lt;-<span class="kw">as.character</span>(BreastCancer<span class="op">$</span>Class)</span>
<span id="cb66-7"><a href="machine-learning.html#cb66-7"></a>BreastCancer<span class="op">$</span>Class[BreastCancer<span class="op">$</span>Class<span class="op">==</span><span class="st">&quot;benign&quot;</span>]&lt;-<span class="dv">0</span></span>
<span id="cb66-8"><a href="machine-learning.html#cb66-8"></a>BreastCancer<span class="op">$</span>Class[BreastCancer<span class="op">$</span>Class<span class="op">==</span><span class="st">&quot;malignant&quot;</span>]&lt;-<span class="dv">1</span></span>
<span id="cb66-9"><a href="machine-learning.html#cb66-9"></a>BreastCancer<span class="op">$</span>Class&lt;-<span class="kw">as.numeric</span>(BreastCancer<span class="op">$</span>Class)</span>
<span id="cb66-10"><a href="machine-learning.html#cb66-10"></a></span>
<span id="cb66-11"><a href="machine-learning.html#cb66-11"></a><span class="co">#remove ID column</span></span>
<span id="cb66-12"><a href="machine-learning.html#cb66-12"></a><span class="co">#remove column a=with NA </span></span>
<span id="cb66-13"><a href="machine-learning.html#cb66-13"></a><span class="co">#remaining 9 columns</span></span>
<span id="cb66-14"><a href="machine-learning.html#cb66-14"></a><span class="co">#convert multiple columns to numeric</span></span>
<span id="cb66-15"><a href="machine-learning.html#cb66-15"></a><span class="co">#lapply output a list</span></span>
<span id="cb66-16"><a href="machine-learning.html#cb66-16"></a>BreastCancer2&lt;-<span class="kw">lapply</span>(BreastCancer[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">7</span>)], as.numeric)</span>
<span id="cb66-17"><a href="machine-learning.html#cb66-17"></a>BreastCancer2&lt;-<span class="kw">as.data.frame</span>(BreastCancer2)</span>
<span id="cb66-18"><a href="machine-learning.html#cb66-18"></a></span>
<span id="cb66-19"><a href="machine-learning.html#cb66-19"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb66-20"><a href="machine-learning.html#cb66-20"></a>parts =<span class="st"> </span><span class="kw">createDataPartition</span>(BreastCancer2<span class="op">$</span>Class, <span class="dt">p =</span> <span class="fl">0.75</span>, <span class="dt">list=</span>F)</span>
<span id="cb66-21"><a href="machine-learning.html#cb66-21"></a>train =<span class="st"> </span>BreastCancer2[parts, ]</span>
<span id="cb66-22"><a href="machine-learning.html#cb66-22"></a>test =<span class="st"> </span>BreastCancer2[<span class="op">-</span>parts, ]</span>
<span id="cb66-23"><a href="machine-learning.html#cb66-23"></a></span>
<span id="cb66-24"><a href="machine-learning.html#cb66-24"></a>X_train =<span class="st"> </span><span class="kw">data.matrix</span>(train[,<span class="op">-</span><span class="dv">9</span>])          <span class="co"># independent variables for train</span></span>
<span id="cb66-25"><a href="machine-learning.html#cb66-25"></a>y_train =<span class="st"> </span>train[,<span class="dv">9</span>]                        <span class="co"># dependent variables for train</span></span>
<span id="cb66-26"><a href="machine-learning.html#cb66-26"></a>X_test =<span class="st"> </span><span class="kw">data.matrix</span>(test[,<span class="op">-</span><span class="dv">9</span>])            <span class="co"># independent variables for test</span></span>
<span id="cb66-27"><a href="machine-learning.html#cb66-27"></a>y_test =<span class="st"> </span>test[,<span class="dv">9</span>]                          <span class="co"># dependent variables for test</span></span>
<span id="cb66-28"><a href="machine-learning.html#cb66-28"></a></span>
<span id="cb66-29"><a href="machine-learning.html#cb66-29"></a><span class="co"># convert the train and test data into xgboost matrix type.</span></span>
<span id="cb66-30"><a href="machine-learning.html#cb66-30"></a>xgboost_train =<span class="st"> </span><span class="kw">xgb.DMatrix</span>(<span class="dt">data=</span>X_train, <span class="dt">label=</span><span class="kw">as.matrix</span>(y_train))</span>
<span id="cb66-31"><a href="machine-learning.html#cb66-31"></a>xgboost_test =<span class="st"> </span><span class="kw">xgb.DMatrix</span>(<span class="dt">data=</span>X_test, <span class="dt">label=</span><span class="kw">as.matrix</span>(y_test))</span>
<span id="cb66-32"><a href="machine-learning.html#cb66-32"></a></span>
<span id="cb66-33"><a href="machine-learning.html#cb66-33"></a><span class="co"># train a model using our training data</span></span>
<span id="cb66-34"><a href="machine-learning.html#cb66-34"></a><span class="co"># nthread is the number of CPU threads we use</span></span>
<span id="cb66-35"><a href="machine-learning.html#cb66-35"></a><span class="co"># nrounds is the number of passes on the data</span></span>
<span id="cb66-36"><a href="machine-learning.html#cb66-36"></a></span>
<span id="cb66-37"><a href="machine-learning.html#cb66-37"></a><span class="co">#the function xgboost exist in xgboost and rattle</span></span>
<span id="cb66-38"><a href="machine-learning.html#cb66-38"></a>model &lt;-<span class="st"> </span>xgboost<span class="op">::</span><span class="kw">xgboost</span>(<span class="dt">data =</span> xgboost_train, <span class="dt">max.depth =</span> <span class="dv">2</span>, <span class="dt">eta =</span> <span class="dv">1</span>, <span class="dt">nthread =</span> <span class="dv">2</span>, <span class="dt">nrounds =</span> <span class="dv">2</span>, <span class="dt">objective =</span> <span class="st">&quot;binary:logistic&quot;</span>, <span class="dt">verbose =</span> <span class="dv">2</span>)                           </span></code></pre></div>
<pre><code>## [1]  train-logloss:0.221760 
## [2]  train-logloss:0.129150</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="machine-learning.html#cb68-1"></a><span class="kw">summary</span>(model)</span></code></pre></div>
<pre><code>##                Length Class              Mode       
## handle            1   xgb.Booster.handle externalptr
## raw            5820   -none-             raw        
## niter             1   -none-             numeric    
## evaluation_log    2   data.table         list       
## call             17   -none-             call       
## params            5   -none-             list       
## callbacks         2   -none-             list       
## feature_names     8   -none-             character  
## nfeatures         1   -none-             numeric</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="machine-learning.html#cb70-1"></a><span class="co">#use model to make predictions on test data</span></span>
<span id="cb70-2"><a href="machine-learning.html#cb70-2"></a>pred_test =<span class="st"> </span><span class="kw">predict</span>(model, xgboost_test)</span>
<span id="cb70-3"><a href="machine-learning.html#cb70-3"></a>pred_test</span></code></pre></div>
<pre><code>##   [1] 0.04247886 0.04247886 0.93661994 0.04247886 0.04247886 0.93661994
##   [7] 0.04247886 0.04247886 0.50793731 0.84730983 0.04247886 0.04247886
##  [13] 0.04247886 0.93661994 0.13179043 0.61858213 0.04247886 0.93661994
##  [19] 0.04247886 0.90757442 0.04247886 0.93661994 0.50793731 0.10175808
##  [25] 0.04247886 0.13179043 0.04247886 0.04247886 0.04247886 0.04247886
##  [31] 0.04247886 0.04247886 0.04247886 0.93661994 0.90757442 0.90757442
##  [37] 0.93661994 0.90757442 0.04247886 0.61858213 0.04247886 0.04247886
##  [43] 0.04247886 0.04247886 0.04247886 0.93661994 0.04247886 0.61858213
##  [49] 0.04247886 0.04247886 0.93661994 0.61858213 0.93661994 0.04247886
##  [55] 0.93661994 0.04247886 0.04247886 0.04247886 0.04247886 0.93661994
##  [61] 0.93661994 0.04247886 0.93661994 0.93661994 0.04247886 0.93661994
##  [67] 0.13179043 0.04247886 0.93661994 0.61858213 0.04247886 0.93661994
##  [73] 0.04247886 0.04247886 0.04247886 0.04247886 0.93661994 0.93661994
##  [79] 0.04247886 0.28787071 0.84532809 0.04247886 0.04247886 0.04247886
##  [85] 0.04247886 0.93661994 0.93661994 0.93661994 0.04247886 0.84730983
##  [91] 0.04247886 0.61858213 0.84730983 0.04247886 0.93661994 0.93661994
##  [97] 0.93661994 0.61858213 0.04247886 0.04247886 0.04247886 0.04247886
## [103] 0.84730983 0.93661994 0.04247886 0.04247886 0.04247886 0.04247886
## [109] 0.04247886 0.93661994 0.10175808 0.04247886 0.10175808 0.61858213
## [115] 0.90757442 0.04247886 0.04247886 0.04247886 0.04247886 0.93661994
## [121] 0.04247886 0.04247886 0.04247886 0.04247886 0.04247886 0.93661994
## [127] 0.04247886 0.93661994 0.04247886 0.04247886 0.04247886 0.04247886
## [133] 0.04247886 0.04247886 0.93661994 0.04247886 0.04247886 0.93661994
## [139] 0.04247886 0.04247886 0.04247886 0.93661994 0.93661994 0.13179043
## [145] 0.04247886 0.04247886 0.04247886 0.04247886 0.93661994 0.04247886
## [151] 0.04247886 0.04247886 0.93661994 0.04247886 0.93661994 0.93661994
## [157] 0.04247886 0.93661994 0.93661994 0.10175808 0.04247886 0.04247886
## [163] 0.04247886 0.04247886 0.04247886 0.61858213 0.04247886 0.93661994
## [169] 0.04247886 0.10175808 0.04247886 0.93661994 0.04247886 0.93661994</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="machine-learning.html#cb72-1"></a><span class="co">#classify 1 if prediction &gt;.5</span></span>
<span id="cb72-2"><a href="machine-learning.html#cb72-2"></a>prediction &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(pred_test <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>)</span>
<span id="cb72-3"><a href="machine-learning.html#cb72-3"></a><span class="kw">print</span>(<span class="kw">head</span>(prediction))</span></code></pre></div>
<pre><code>## [1] 0 0 1 0 0 1</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="machine-learning.html#cb74-1"></a>err &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">as.numeric</span>(pred_test <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>) <span class="op">!=</span><span class="st"> </span>y_test)</span>
<span id="cb74-2"><a href="machine-learning.html#cb74-2"></a><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;test-error=&quot;</span>, err))</span></code></pre></div>
<pre><code>## [1] &quot;test-error= 0.0632183908045977&quot;</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="machine-learning.html#cb76-1"></a><span class="co">#plot of the first 2 trees</span></span>
<span id="cb76-2"><a href="machine-learning.html#cb76-2"></a><span class="kw">xgb.plot.tree</span>(<span class="dt">model =</span> model, <span class="dt">trees =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)</span></code></pre></div>
<div id="htmlwidget-1b307ab87e8401592516" style="width:672px;height:480px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-1b307ab87e8401592516">{"x":{"diagram":"digraph {\n\ngraph [layout = \"dot\",\n       rankdir = \"LR\"]\n\nnode [color = \"DimGray\",\n      style = \"filled\",\n      fontname = \"Helvetica\"]\n\nedge [color = \"DimGray\",\n     arrowsize = \"1.5\",\n     arrowhead = \"vee\",\n     fontname = \"Helvetica\"]\n\n  \"1\" [label = \"Tree 1\nBl.cromatin\nCover: 64.5307846\nGain: 55.5894661\", shape = \"rectangle\", fontcolor = \"black\", fillcolor = \"Beige\"] \n  \"2\" [label = \"Cl.thickness\nCover: 42.5443878\nGain: 13.7194939\", shape = \"rectangle\", fontcolor = \"black\", fillcolor = \"Beige\"] \n  \"3\" [label = \"Epith.c.size\nCover: 21.9863949\nGain: 1.98490334\", shape = \"rectangle\", fontcolor = \"black\", fillcolor = \"Beige\"] \n  \"4\" [label = \"Leaf\nCover: 38.4290581\nValue: -1.17784131\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n  \"5\" [label = \"Leaf\nCover: 4.11532879\nValue: 0.622996688\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n  \"6\" [label = \"Leaf\nCover: 2.42281723\nValue: 0.0522798002\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n  \"7\" [label = \"Leaf\nCover: 19.5635796\nValue: 1.03175199\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n\"1\"->\"2\" [label = \"< 3.5\", style = \"bold\"] \n\"2\"->\"4\" [label = \"< 6.5\", style = \"bold\"] \n\"3\"->\"6\" [label = \"< 2.5\", style = \"bold\"] \n\"1\"->\"3\" [style = \"bold\", style = \"solid\"] \n\"2\"->\"5\" [style = \"solid\", style = \"solid\"] \n\"3\"->\"7\" [style = \"solid\", style = \"solid\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="knn" class="section level2">
<h2><span class="header-section-number">6.4</span> KNN</h2>
<p>K nearest neighbour (KNN) uses ‘feature similarity based on measure of distance between data points to make prediction. The K in KNN refers to the number of neighbours to define the case for similarity. K nearest neighbour is available from the <em>caret</em> library.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="machine-learning.html#cb77-1"></a><span class="kw">library</span>(caret)</span>
<span id="cb77-2"><a href="machine-learning.html#cb77-2"></a></span>
<span id="cb77-3"><a href="machine-learning.html#cb77-3"></a><span class="kw">data</span>(<span class="st">&quot;BreastCancer&quot;</span>,<span class="dt">package =</span> <span class="st">&quot;mlbench&quot;</span>)</span>
<span id="cb77-4"><a href="machine-learning.html#cb77-4"></a><span class="kw">colnames</span>(BreastCancer)</span></code></pre></div>
<pre><code>##  [1] &quot;Id&quot;              &quot;Cl.thickness&quot;    &quot;Cell.size&quot;       &quot;Cell.shape&quot;     
##  [5] &quot;Marg.adhesion&quot;   &quot;Epith.c.size&quot;    &quot;Bare.nuclei&quot;     &quot;Bl.cromatin&quot;    
##  [9] &quot;Normal.nucleoli&quot; &quot;Mitoses&quot;         &quot;Class&quot;</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="machine-learning.html#cb79-1"></a><span class="co">#note Class is benign or malignant of class factor</span></span>
<span id="cb79-2"><a href="machine-learning.html#cb79-2"></a><span class="co">#column Bare.nuclei removed due to NA</span></span>
<span id="cb79-3"><a href="machine-learning.html#cb79-3"></a>BreastCancer&lt;-BreastCancer[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">7</span>)]</span>
<span id="cb79-4"><a href="machine-learning.html#cb79-4"></a></span>
<span id="cb79-5"><a href="machine-learning.html#cb79-5"></a><span class="co">#split data</span></span>
<span id="cb79-6"><a href="machine-learning.html#cb79-6"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb79-7"><a href="machine-learning.html#cb79-7"></a>split =<span class="st"> </span>caTools<span class="op">::</span><span class="kw">sample.split</span>(BreastCancer<span class="op">$</span>Class, <span class="dt">SplitRatio =</span> <span class="fl">0.75</span>)</span>
<span id="cb79-8"><a href="machine-learning.html#cb79-8"></a>Train =<span class="st"> </span><span class="kw">subset</span>(BreastCancer, split <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>)</span>
<span id="cb79-9"><a href="machine-learning.html#cb79-9"></a>Test =<span class="st"> </span><span class="kw">subset</span>(BreastCancer, split <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>)</span>
<span id="cb79-10"><a href="machine-learning.html#cb79-10"></a></span>
<span id="cb79-11"><a href="machine-learning.html#cb79-11"></a><span class="co">#grid of values to test in cross-validation.</span></span>
<span id="cb79-12"><a href="machine-learning.html#cb79-12"></a>knn_Grid &lt;-<span class="st">  </span><span class="kw">expand.grid</span>(<span class="dt">k =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">15</span>))</span>
<span id="cb79-13"><a href="machine-learning.html#cb79-13"></a></span>
<span id="cb79-14"><a href="machine-learning.html#cb79-14"></a>knn_Control &lt;-<span class="st"> </span><span class="kw">trainControl</span>(<span class="dt">method =</span> <span class="st">&quot;cv&quot;</span>,</span>
<span id="cb79-15"><a href="machine-learning.html#cb79-15"></a>                           <span class="dt">number =</span> <span class="dv">10</span>, </span>
<span id="cb79-16"><a href="machine-learning.html#cb79-16"></a>                           <span class="co"># repeats = 10, # uncomment for repeatedcv </span></span>
<span id="cb79-17"><a href="machine-learning.html#cb79-17"></a>                           <span class="co">## Estimate class probabilities</span></span>
<span id="cb79-18"><a href="machine-learning.html#cb79-18"></a>                           <span class="dt">classProbs =</span> <span class="ot">TRUE</span>,</span>
<span id="cb79-19"><a href="machine-learning.html#cb79-19"></a>                           <span class="co">## Evaluate performance using </span></span>
<span id="cb79-20"><a href="machine-learning.html#cb79-20"></a>                           <span class="co">## the following function</span></span>
<span id="cb79-21"><a href="machine-learning.html#cb79-21"></a>                           <span class="dt">summaryFunction =</span> twoClassSummary)</span>
<span id="cb79-22"><a href="machine-learning.html#cb79-22"></a></span>
<span id="cb79-23"><a href="machine-learning.html#cb79-23"></a><span class="co">#scaling data is performed here under preProcess</span></span>
<span id="cb79-24"><a href="machine-learning.html#cb79-24"></a></span>
<span id="cb79-25"><a href="machine-learning.html#cb79-25"></a>knn &lt;-<span class="st"> </span>caret<span class="op">::</span><span class="kw">train</span>(Class <span class="op">~</span><span class="st"> </span>., </span>
<span id="cb79-26"><a href="machine-learning.html#cb79-26"></a>                    <span class="dt">data =</span> Train, </span>
<span id="cb79-27"><a href="machine-learning.html#cb79-27"></a>                  <span class="dt">method =</span> <span class="st">&quot;knn&quot;</span>,</span>
<span id="cb79-28"><a href="machine-learning.html#cb79-28"></a>                 <span class="dt">trControl=</span>knn_Control,</span>
<span id="cb79-29"><a href="machine-learning.html#cb79-29"></a>                 <span class="dt">tuneGrid=</span>knn_Grid,</span>
<span id="cb79-30"><a href="machine-learning.html#cb79-30"></a>                 <span class="co">#optimise with roc metric</span></span>
<span id="cb79-31"><a href="machine-learning.html#cb79-31"></a>                 <span class="dt">metric=</span><span class="st">&quot;ROC&quot;</span>)</span>
<span id="cb79-32"><a href="machine-learning.html#cb79-32"></a></span>
<span id="cb79-33"><a href="machine-learning.html#cb79-33"></a></span>
<span id="cb79-34"><a href="machine-learning.html#cb79-34"></a><span class="kw">summary</span>(knn)</span></code></pre></div>
<pre><code>##             Length Class      Mode     
## learn        2     -none-     list     
## k            1     -none-     numeric  
## theDots      0     -none-     list     
## xNames      71     -none-     character
## problemType  1     -none-     character
## tuneValue    1     data.frame list     
## obsLevels    2     -none-     character
## param        0     -none-     list</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="machine-learning.html#cb81-1"></a>pred_knn&lt;-<span class="kw">predict</span>(knn,Test)</span>
<span id="cb81-2"><a href="machine-learning.html#cb81-2"></a><span class="kw">confusionMatrix</span>(pred_knn, Test<span class="op">$</span>Class)</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##            Reference
## Prediction  benign malignant
##   benign       114        24
##   malignant      0        36
##                                           
##                Accuracy : 0.8621          
##                  95% CI : (0.8018, 0.9096)
##     No Information Rate : 0.6552          
##     P-Value [Acc &gt; NIR] : 5.842e-10       
##                                           
##                   Kappa : 0.6628          
##                                           
##  Mcnemar&#39;s Test P-Value : 2.668e-06       
##                                           
##             Sensitivity : 1.0000          
##             Specificity : 0.6000          
##          Pos Pred Value : 0.8261          
##          Neg Pred Value : 1.0000          
##              Prevalence : 0.6552          
##          Detection Rate : 0.6552          
##    Detection Prevalence : 0.7931          
##       Balanced Accuracy : 0.8000          
##                                           
##        &#39;Positive&#39; Class : benign          
## </code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="machine-learning.html#cb83-1"></a>roc_knn&lt;-pROC<span class="op">::</span><span class="kw">roc</span>(Test<span class="op">$</span>Class, <span class="kw">as.numeric</span>(pred_knn))</span></code></pre></div>
<pre><code>## Setting levels: control = benign, case = malignant</code></pre>
<pre><code>## Setting direction: controls &lt; cases</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="machine-learning.html#cb86-1"></a>roc_knn</span></code></pre></div>
<pre><code>## 
## Call:
## roc.default(response = Test$Class, predictor = as.numeric(pred_knn))
## 
## Data: as.numeric(pred_knn) in 114 controls (Test$Class benign) &lt; 60 cases (Test$Class malignant).
## Area under the curve: 0.8</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="machine-learning.html#cb88-1"></a><span class="co">#https://plotly.com/r/knn-classification/</span></span>
<span id="cb88-2"><a href="machine-learning.html#cb88-2"></a></span>
<span id="cb88-3"><a href="machine-learning.html#cb88-3"></a>pdb &lt;-<span class="st"> </span><span class="kw">cbind</span>(Test[,<span class="op">-</span><span class="dv">9</span>], Test[,<span class="dv">9</span>])</span>
<span id="cb88-4"><a href="machine-learning.html#cb88-4"></a>pdb &lt;-<span class="st"> </span><span class="kw">cbind</span>(pdb, pred_knn)</span>
<span id="cb88-5"><a href="machine-learning.html#cb88-5"></a></span>
<span id="cb88-6"><a href="machine-learning.html#cb88-6"></a>fig &lt;-<span class="st"> </span>plotly<span class="op">::</span><span class="kw">plot_ly</span>(<span class="dt">data =</span> pdb,</span>
<span id="cb88-7"><a href="machine-learning.html#cb88-7"></a>    <span class="dt">x =</span> <span class="op">~</span><span class="kw">as.numeric</span>(Test<span class="op">$</span>Cl.thickness), </span>
<span id="cb88-8"><a href="machine-learning.html#cb88-8"></a>    <span class="dt">y =</span> <span class="op">~</span><span class="kw">as.numeric</span>(Test<span class="op">$</span>Epith.c.size), </span>
<span id="cb88-9"><a href="machine-learning.html#cb88-9"></a>    <span class="dt">type =</span> <span class="st">&#39;scatter&#39;</span>, <span class="dt">mode =</span> <span class="st">&#39;markers&#39;</span>,<span class="dt">color =</span> <span class="op">~</span>pred_knn, <span class="dt">colors =</span> <span class="st">&#39;RdBu&#39;</span>, </span>
<span id="cb88-10"><a href="machine-learning.html#cb88-10"></a>    <span class="dt">symbol =</span> <span class="op">~</span>Test<span class="op">$</span>Class, <span class="dt">split =</span> <span class="op">~</span>Test<span class="op">$</span>Class, </span>
<span id="cb88-11"><a href="machine-learning.html#cb88-11"></a>    <span class="dt">symbols =</span> <span class="kw">c</span>(<span class="st">&#39;square-dot&#39;</span>,<span class="st">&#39;circle-dot&#39;</span>), </span>
<span id="cb88-12"><a href="machine-learning.html#cb88-12"></a>    <span class="dt">marker =</span> <span class="kw">list</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">line =</span> <span class="kw">list</span>(<span class="dt">color =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">width =</span> <span class="dv">1</span>)))</span>
<span id="cb88-13"><a href="machine-learning.html#cb88-13"></a></span>
<span id="cb88-14"><a href="machine-learning.html#cb88-14"></a>fig</span></code></pre></div>
<div id="htmlwidget-b12334d4297a6d9b9c14" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-b12334d4297a6d9b9c14">{"x":{"visdat":{"50a87d7b73":["function () ","plotlyVisDat"]},"cur_data":"50a87d7b73","attrs":{"50a87d7b73":{"x":{},"y":{},"mode":"markers","marker":{"size":12,"line":{"color":"black","width":1}},"color":{},"symbol":{},"split":{},"colors":"RdBu","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"symbols":["square-dot","circle-dot"],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"as.numeric(Test$Cl.thickness)"},"yaxis":{"domain":[0,1],"automargin":true,"title":"as.numeric(Test$Epith.c.size)"},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[5,6,4,2,2,3,2,1,2,4,1,4,1,3,2,1,1,1,1,3,1,2,1,4,1,1,3,1,6,2,3,5,5,6,3,3,1,5,4,3,3,1,4,1,3,5,1,5,2,1,1,5,2,5,3,3,3,1,5,3,3,5,5,1,5,3,5,6,1,1,3,1,4,1,4,4,3,1,1,4,4,3,5,5,4,3,5,5,3,1,1,5,5,4,5,1,4,5,1,3,2,2,6,3,1,3,4,1,1,2,1,3,3,2],"y":[7,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,10,2,3,2,2,2,2,1,2,1,2,2,2,2,2,1,2,2,2,2,2,2,7,5,2,2,2,3,2,2,1,2,2,3,2,2,2,1,2,2,2,2,2,2,3,2,2,2,2,1,1,2,1,1,2,2,1,1,3,3,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,3,2],"mode":"markers","marker":{"color":"rgba(239,138,98,1)","symbol":"square-dot","size":12,"line":{"color":"black","width":1}},"type":"scatter","name":"benign<br />benign<br />benign","textfont":{"color":"rgba(239,138,98,1)"},"error_y":{"color":"rgba(239,138,98,1)"},"error_x":{"color":"rgba(239,138,98,1)"},"line":{"color":"rgba(239,138,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[5,10,8,6,10,10,3,1,4,8,5,8,3,7,1,10,10,10,3,4,5,7,10,3],"y":[2,3,5,5,3,3,5,8,1,2,4,3,3,3,4,2,2,2,5,3,3,2,2,3],"mode":"markers","marker":{"color":"rgba(239,138,98,1)","symbol":"circle-dot","size":12,"line":{"color":"black","width":1}},"type":"scatter","name":"benign<br />malignant<br />malignant","textfont":{"color":"rgba(239,138,98,1)"},"error_y":{"color":"rgba(239,138,98,1)"},"error_x":{"color":"rgba(239,138,98,1)"},"line":{"color":"rgba(239,138,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[8,10,10,5,9,5,6,5,1,10,9,10,8,10,10,6,8,10,8,10,10,8,10,8,10,10,10,8,6,7,7,10,10,10,5,8],"y":[7,8,10,8,6,8,8,8,5,6,5,7,4,7,5,8,5,10,4,4,5,8,3,3,3,4,5,7,3,4,4,6,3,3,5,6],"mode":"markers","marker":{"color":"rgba(247,247,247,1)","symbol":"circle-dot","size":12,"line":{"color":"black","width":1}},"type":"scatter","name":"malignant<br />malignant<br />malignant","textfont":{"color":"rgba(247,247,247,1)"},"error_y":{"color":"rgba(247,247,247,1)"},"error_x":{"color":"rgba(247,247,247,1)"},"line":{"color":"rgba(247,247,247,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="support-vector-machine" class="section level2">
<h2><span class="header-section-number">6.5</span> Support vector machine</h2>
<p>In brief, support vector machine regression (SVR) can be seen as a way to
enhance data which may not be easily separated in its native space. It
manipulates data from low dimension to higher dimension in feature space and
which can reveal relationship not discernible in low dimensional space. It does this around the hyperparameter controlling the margin of the data from a fitted line in a way not dissimilar from fitting a regression line based on minimising least squares. The default setting is radial basis function.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="machine-learning.html#cb89-1"></a><span class="kw">library</span>(e1071)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;e1071&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:randomForestSRC&#39;:
## 
##     impute, tune</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="machine-learning.html#cb92-1"></a><span class="kw">library</span>(caret)</span>
<span id="cb92-2"><a href="machine-learning.html#cb92-2"></a></span>
<span id="cb92-3"><a href="machine-learning.html#cb92-3"></a><span class="co"># The Breast cancer data is used again from knn</span></span>
<span id="cb92-4"><a href="machine-learning.html#cb92-4"></a></span>
<span id="cb92-5"><a href="machine-learning.html#cb92-5"></a>trctrl &lt;-<span class="st"> </span><span class="kw">trainControl</span>(<span class="dt">method =</span> <span class="st">&quot;repeatedcv&quot;</span>, <span class="dt">number =</span> <span class="dv">10</span>, <span class="dt">repeats =</span> <span class="dv">3</span>)</span>
<span id="cb92-6"><a href="machine-learning.html#cb92-6"></a></span>
<span id="cb92-7"><a href="machine-learning.html#cb92-7"></a><span class="co">#scaling data is performed here under preProcess</span></span>
<span id="cb92-8"><a href="machine-learning.html#cb92-8"></a></span>
<span id="cb92-9"><a href="machine-learning.html#cb92-9"></a>svm_Linear &lt;-<span class="st"> </span>caret<span class="op">::</span><span class="kw">train</span>(Class <span class="op">~</span><span class="st"> </span>., </span>
<span id="cb92-10"><a href="machine-learning.html#cb92-10"></a>                    <span class="dt">data =</span> Train, </span>
<span id="cb92-11"><a href="machine-learning.html#cb92-11"></a>                  <span class="dt">method =</span> <span class="st">&quot;svmLinear&quot;</span>,</span>
<span id="cb92-12"><a href="machine-learning.html#cb92-12"></a>                 <span class="dt">trControl=</span>trctrl,</span>
<span id="cb92-13"><a href="machine-learning.html#cb92-13"></a>                 <span class="dt">preProcess =</span> <span class="kw">c</span>(<span class="st">&quot;center&quot;</span>, <span class="st">&quot;scale&quot;</span>),</span>
<span id="cb92-14"><a href="machine-learning.html#cb92-14"></a>                 <span class="dt">tuneLength =</span> <span class="dv">10</span>)</span>
<span id="cb92-15"><a href="machine-learning.html#cb92-15"></a></span>
<span id="cb92-16"><a href="machine-learning.html#cb92-16"></a></span>
<span id="cb92-17"><a href="machine-learning.html#cb92-17"></a><span class="kw">summary</span>(svm_Linear)</span></code></pre></div>
<pre><code>## Length  Class   Mode 
##      1   ksvm     S4</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="machine-learning.html#cb94-1"></a>pred&lt;-<span class="kw">predict</span>(svm_Linear,BreastCancer)</span>
<span id="cb94-2"><a href="machine-learning.html#cb94-2"></a><span class="kw">confusionMatrix</span>(pred, BreastCancer<span class="op">$</span>Class)</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##            Reference
## Prediction  benign malignant
##   benign       455        13
##   malignant      3       228
##                                           
##                Accuracy : 0.9771          
##                  95% CI : (0.9631, 0.9869)
##     No Information Rate : 0.6552          
##     P-Value [Acc &gt; NIR] : &lt; 2e-16         
##                                           
##                   Kappa : 0.9488          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.02445         
##                                           
##             Sensitivity : 0.9934          
##             Specificity : 0.9461          
##          Pos Pred Value : 0.9722          
##          Neg Pred Value : 0.9870          
##              Prevalence : 0.6552          
##          Detection Rate : 0.6509          
##    Detection Prevalence : 0.6695          
##       Balanced Accuracy : 0.9698          
##                                           
##        &#39;Positive&#39; Class : benign          
## </code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="machine-learning.html#cb96-1"></a>roc_svm&lt;-pROC<span class="op">::</span><span class="kw">roc</span>(BreastCancer<span class="op">$</span>Class, <span class="kw">as.numeric</span>(pred))</span></code></pre></div>
<pre><code>## Setting levels: control = benign, case = malignant</code></pre>
<pre><code>## Setting direction: controls &lt; cases</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="machine-learning.html#cb99-1"></a>roc_svm</span></code></pre></div>
<pre><code>## 
## Call:
## roc.default(response = BreastCancer$Class, predictor = as.numeric(pred))
## 
## Data: as.numeric(pred) in 458 controls (BreastCancer$Class benign) &lt; 241 cases (BreastCancer$Class malignant).
## Area under the curve: 0.9698</code></pre>
<div id="survival-analysis-using-random-forest" class="section level3">
<h3><span class="header-section-number">6.5.1</span> Survival analysis using random forest</h3>
<p>Random forest can be used for performing survival analysis using <em>ranger</em>, <em>randomforestSRC</em>. The example below is an example using the lung cancer trial.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="machine-learning.html#cb101-1"></a><span class="co">#data from survival package on NCCTG lung cancer trial</span></span>
<span id="cb101-2"><a href="machine-learning.html#cb101-2"></a><span class="co">#https://stat.ethz.ch/R-manual/R-devel/library/survival/html/lung.html</span></span>
<span id="cb101-3"><a href="machine-learning.html#cb101-3"></a><span class="kw">data</span>(cancer, <span class="dt">package=</span><span class="st">&quot;survival&quot;</span>)</span>
<span id="cb101-4"><a href="machine-learning.html#cb101-4"></a></span>
<span id="cb101-5"><a href="machine-learning.html#cb101-5"></a><span class="co">#time in days</span></span>
<span id="cb101-6"><a href="machine-learning.html#cb101-6"></a><span class="co">#status censored=1, dead=2</span></span>
<span id="cb101-7"><a href="machine-learning.html#cb101-7"></a><span class="co">#sex:Male=1 Female=2</span></span>
<span id="cb101-8"><a href="machine-learning.html#cb101-8"></a></span>
<span id="cb101-9"><a href="machine-learning.html#cb101-9"></a><span class="kw">library</span>(ranger)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;ranger&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:rattle&#39;:
## 
##     importance</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="machine-learning.html#cb104-1"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## -- Attaching packages --------------------------------------- tidyverse 1.3.0 --</code></pre>
<pre><code>## v tidyr   1.1.4     v stringr 1.4.0
## v readr   1.4.0     v forcats 0.5.0
## v purrr   0.3.4</code></pre>
<pre><code>## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x stringr::boundary() masks strucchange::boundary()
## x dplyr::explain()    masks survex::explain()
## x dplyr::filter()     masks stats::filter()
## x dplyr::lag()        masks stats::lag()
## x purrr::lift()       masks caret::lift()
## x purrr::partial()    masks randomForestSRC::partial()
## x xgboost::slice()    masks dplyr::slice()</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="machine-learning.html#cb108-1"></a><span class="kw">library</span>(survival)</span>
<span id="cb108-2"><a href="machine-learning.html#cb108-2"></a></span>
<span id="cb108-3"><a href="machine-learning.html#cb108-3"></a>cancer2&lt;-cancer <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(time, status, age,sex, ph.ecog) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>()  </span>
<span id="cb108-4"><a href="machine-learning.html#cb108-4"></a></span>
<span id="cb108-5"><a href="machine-learning.html#cb108-5"></a>survival_formula&lt;-<span class="kw">formula</span>(<span class="kw">paste</span>(<span class="st">&#39;Surv(&#39;</span>, <span class="st">&#39;time&#39;</span>, <span class="st">&#39;,&#39;</span>, <span class="st">&#39;status&#39;</span>, <span class="st">&#39;) ~ &#39;</span>,<span class="st">&#39;age+sex+ph.ecog&#39;</span>))</span>
<span id="cb108-6"><a href="machine-learning.html#cb108-6"></a>  </span>
<span id="cb108-7"><a href="machine-learning.html#cb108-7"></a>survival_forest &lt;-<span class="st"> </span><span class="kw">ranger</span>(survival_formula,</span>
<span id="cb108-8"><a href="machine-learning.html#cb108-8"></a>                         <span class="dt">data =</span> cancer2,  </span>
<span id="cb108-9"><a href="machine-learning.html#cb108-9"></a>                         <span class="dt">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb108-10"><a href="machine-learning.html#cb108-10"></a>                         <span class="dt">importance =</span> <span class="st">&#39;permutation&#39;</span>,</span>
<span id="cb108-11"><a href="machine-learning.html#cb108-11"></a>                         <span class="dt">mtry =</span> <span class="dv">2</span>,</span>
<span id="cb108-12"><a href="machine-learning.html#cb108-12"></a>                         <span class="dt">verbose =</span> <span class="ot">TRUE</span>,</span>
<span id="cb108-13"><a href="machine-learning.html#cb108-13"></a>                         <span class="dt">num.trees =</span> <span class="dv">200</span>,</span>
<span id="cb108-14"><a href="machine-learning.html#cb108-14"></a>                         <span class="dt">write.forest=</span><span class="ot">TRUE</span>)</span>
<span id="cb108-15"><a href="machine-learning.html#cb108-15"></a></span>
<span id="cb108-16"><a href="machine-learning.html#cb108-16"></a><span class="kw">print</span>(<span class="st">&quot;error:&quot;</span>); <span class="kw">print</span>(survival_forest<span class="op">$</span>prediction.error)</span></code></pre></div>
<pre><code>## [1] &quot;error:&quot;</code></pre>
<pre><code>## [1] 0.391924</code></pre>
<p>Print variable importance</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="machine-learning.html#cb111-1"></a><span class="kw">sort</span>(survival_forest<span class="op">$</span>variable.importance)</span></code></pre></div>
<pre><code>##         age         sex     ph.ecog 
## 0.008386083 0.030801816 0.065970251</code></pre>
<p>Probability of survival</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="machine-learning.html#cb113-1"></a><span class="kw">plot</span>(survival_forest<span class="op">$</span>unique.death.times, survival_forest<span class="op">$</span>survival[<span class="dv">1</span>,], <span class="dt">type=</span><span class="st">&#39;l&#39;</span>, <span class="dt">col=</span><span class="st">&#39;orange&#39;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">0.01</span>,<span class="dv">1</span>))</span>
<span id="cb113-2"><a href="machine-learning.html#cb113-2"></a><span class="kw">lines</span>(survival_forest<span class="op">$</span>unique.death.times, survival_forest<span class="op">$</span>survival[<span class="dv">56</span>,], <span class="dt">col=</span><span class="st">&#39;blue&#39;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-7-2-1.png" width="672" /></p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="machine-learning.html#cb114-1"></a><span class="kw">plot</span>(survival_forest<span class="op">$</span>unique.death.times, survival_forest<span class="op">$</span>survival[<span class="dv">1</span>,], <span class="dt">type=</span><span class="st">&#39;l&#39;</span>, <span class="dt">col=</span><span class="st">&#39;orange&#39;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">0.01</span>,<span class="dv">1</span>))</span>
<span id="cb114-2"><a href="machine-learning.html#cb114-2"></a><span class="cf">for</span> (x <span class="cf">in</span> <span class="kw">c</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">100</span>)) {</span>
<span id="cb114-3"><a href="machine-learning.html#cb114-3"></a>  <span class="kw">lines</span>(survival_forest<span class="op">$</span>unique.death.times, survival_forest<span class="op">$</span>survival[x,], <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</span>
<span id="cb114-4"><a href="machine-learning.html#cb114-4"></a>}</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-7-3-1.png" width="672" /></p>
</div>
</div>
<div id="non-negative-matrix-factorisation" class="section level2">
<h2><span class="header-section-number">6.6</span> Non-negative matrix factorisation</h2>
<p>Non-negative matrix factorisation is an unsupervised machine learning method, which seeks to explain the observed clinical features using smaller number of basis components (hidden variables). A matrix V of dimension m x n is factorise
to 2 matrices W and H. W has dimensions m x k an H has dimensions n x k. For
topic modeling in the chapter of text mining, V matrix is the document term matrix. Each row of H is the word embedding and the columns pf W represent the weight.</p>
<p>The interpretation of NMF components is similar to, but often more natural than, related methods such as factor analysis and principal component analysis. The non-negativity constraint in NMF leads to a simple “parts-based” interpretation and has been successfully used in facial recognition, metagene pattern
discovery, and market research. For a clinical example, the matrix for NMF decomposition consists of rows of hospitals and their service availability.</p>
<p>The example below used the recommended procedure to estimate the factorization rank, based on stability of the cophenetic correlation coefficient and the residual error, prior to performing the NMF analysis. The data were permuted and the factorization rank computed. These data were used as reference for selecting factorization rank to minimize the chance of overfitting.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="machine-learning.html#cb115-1"></a><span class="kw">library</span>(NMF,<span class="dt">quietly =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## NMF - BioConductor layer [OK] | Shared memory capabilities [NO: windows] | Cores 7/8</code></pre>
<pre><code>## 
## Attaching package: &#39;NMF&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:party&#39;:
## 
##     fit</code></pre>
<pre><code>## The following object is masked from &#39;package:modeltools&#39;:
## 
##     fit</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="machine-learning.html#cb120-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb120-2"><a href="machine-learning.html#cb120-2"></a>edge&lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./Data-Use/Hosp_Network_geocoded.csv&quot;</span>)</span>
<span id="cb120-3"><a href="machine-learning.html#cb120-3"></a>df&lt;-edge[,<span class="kw">c</span>(<span class="dv">2</span><span class="op">:</span><span class="kw">dim</span>(edge)[<span class="dv">2</span>])]</span>
<span id="cb120-4"><a href="machine-learning.html#cb120-4"></a><span class="kw">row.names</span>(df)&lt;-edge[,<span class="dv">1</span>] <span class="co">#bipartite matrix</span></span>
<span id="cb120-5"><a href="machine-learning.html#cb120-5"></a><span class="co">#select columns#remove distance data</span></span>
<span id="cb120-6"><a href="machine-learning.html#cb120-6"></a>df_se&lt;-edge[,<span class="kw">c</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">16</span>)]</span>
<span id="cb120-7"><a href="machine-learning.html#cb120-7"></a><span class="kw">row.names</span>(df_se)&lt;-edge[,<span class="dv">1</span>] <span class="co">#bipartite matrix</span></span>
<span id="cb120-8"><a href="machine-learning.html#cb120-8"></a><span class="co">#south eastern hospitals</span></span>
<span id="cb120-9"><a href="machine-learning.html#cb120-9"></a><span class="co">#select rows</span></span>
<span id="cb120-10"><a href="machine-learning.html#cb120-10"></a>df_se&lt;-df_se[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">19</span>,<span class="dv">20</span>,<span class="dv">24</span>,<span class="dv">31</span>,<span class="dv">33</span>,<span class="dv">34</span>,<span class="dv">35</span>),]</span>
<span id="cb120-11"><a href="machine-learning.html#cb120-11"></a></span>
<span id="cb120-12"><a href="machine-learning.html#cb120-12"></a></span>
<span id="cb120-13"><a href="machine-learning.html#cb120-13"></a><span class="co">#estimate factorisation rank-prevent overfitting</span></span>
<span id="cb120-14"><a href="machine-learning.html#cb120-14"></a>estim.r &lt;-<span class="st"> </span><span class="kw">nmf</span>(df_se, <span class="dv">2</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">nrun =</span> <span class="dv">10</span>, <span class="dt">seed =</span> <span class="dv">123456</span>)</span>
<span id="cb120-15"><a href="machine-learning.html#cb120-15"></a><span class="kw">plot</span>(estim.r)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-8-1.png" width="672" /></p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="machine-learning.html#cb121-1"></a><span class="kw">consensusmap</span>(estim.r)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-8-2.png" width="672" /></p>
<p>The optimal number of rank for this data is likely to be 4.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="machine-learning.html#cb122-1"></a><span class="co">#Using the data above we can use which argument to find the order</span></span>
<span id="cb122-2"><a href="machine-learning.html#cb122-2"></a><span class="co">#since the starting point is 2 we just need to add 1</span></span>
<span id="cb122-3"><a href="machine-learning.html#cb122-3"></a>Rank=<span class="kw">which</span>(estim.r<span class="op">$</span>measures<span class="op">$</span>cophenetic<span class="op">==</span><span class="kw">max</span>(estim.r<span class="op">$</span>measures<span class="op">$</span>cophenetic))<span class="op">+</span><span class="dv">1</span></span>
<span id="cb122-4"><a href="machine-learning.html#cb122-4"></a></span>
<span id="cb122-5"><a href="machine-learning.html#cb122-5"></a>model&lt;-<span class="kw">nmf</span>(df_se, Rank,<span class="dt">nrun=</span><span class="dv">100</span>)</span>
<span id="cb122-6"><a href="machine-learning.html#cb122-6"></a>pmodel&lt;-<span class="kw">predict</span>(model,<span class="dt">prob=</span><span class="ot">TRUE</span>)</span>
<span id="cb122-7"><a href="machine-learning.html#cb122-7"></a><span class="kw">coefmap</span>(model)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-8-1-1.png" width="672" /></p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="machine-learning.html#cb123-1"></a><span class="kw">basismap</span>(model)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-8-1-2.png" width="672" /></p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="machine-learning.html#cb124-1"></a><span class="kw">consensusmap</span>(model)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-8-1-3.png" width="672" /></p>
</div>
<div id="formal-concept-analysis" class="section level2">
<h2><span class="header-section-number">6.7</span> Formal concept analysis</h2>
<p>This is an unsupervised machine learning method which takes an input matrix of objects and attributes (binary values) and seeks to find the hierarchy of relations. Each concept shares a set of attributes with other objects and each sub-concept shares a smaller set of attributes with a subset of the objects. A Hasse diagram is used to display the hierarchy of relations.</p>
<p>First we will illustrate with a simple relationship among fruit. Note in this example there is no close set for apple and pear, as both share the attribute of green color. There is a close set for the tropical fruit mango and and banana.</p>
<p>There are several libraries for FCA. Here we will use <em>multiplex</em>. The <em>fcaR</em> library can also handle fuzzy data.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="machine-learning.html#cb125-1"></a><span class="kw">library</span>(multiplex) <span class="co">#Algebraic Tools for the Analysis of Multiple Social Networks</span></span>
<span id="cb125-2"><a href="machine-learning.html#cb125-2"></a><span class="kw">library</span>(Rgraphviz) <span class="co">#plot hasse diagram</span></span></code></pre></div>
<pre><code>## Loading required package: graph</code></pre>
<pre><code>## 
## Attaching package: &#39;graph&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:stringr&#39;:
## 
##     boundary</code></pre>
<pre><code>## The following object is masked from &#39;package:party&#39;:
## 
##     nodes</code></pre>
<pre><code>## The following object is masked from &#39;package:strucchange&#39;:
## 
##     boundary</code></pre>
<pre><code>## 
## Attaching package: &#39;Rgraphviz&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:NMF&#39;:
## 
##     name</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="machine-learning.html#cb133-1"></a>fr&lt;-<span class="kw">data.frame</span>(<span class="dt">Fruit=</span><span class="kw">c</span>(<span class="st">&quot;Apple&quot;</span>, <span class="st">&quot;Banana&quot;</span>,<span class="st">&quot;Pear&quot;</span>, <span class="st">&quot;Mango&quot;</span>),</span>
<span id="cb133-2"><a href="machine-learning.html#cb133-2"></a>                 <span class="dt">round=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb133-3"><a href="machine-learning.html#cb133-3"></a>                 <span class="dt">cylindrical=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb133-4"><a href="machine-learning.html#cb133-4"></a>                 <span class="dt">yellow=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb133-5"><a href="machine-learning.html#cb133-5"></a>                 <span class="dt">red=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb133-6"><a href="machine-learning.html#cb133-6"></a>                 <span class="dt">green=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="co">#color when ripe</span></span>
<span id="cb133-7"><a href="machine-learning.html#cb133-7"></a>                 <span class="dt">tropical=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb133-8"><a href="machine-learning.html#cb133-8"></a>               <span class="dt">large_seed=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb133-9"><a href="machine-learning.html#cb133-9"></a>)</span>
<span id="cb133-10"><a href="machine-learning.html#cb133-10"></a></span>
<span id="cb133-11"><a href="machine-learning.html#cb133-11"></a>df&lt;-fr[,<span class="kw">c</span>(<span class="dv">2</span><span class="op">:</span><span class="kw">dim</span>(fr)[<span class="dv">2</span>])]</span>
<span id="cb133-12"><a href="machine-learning.html#cb133-12"></a><span class="kw">row.names</span>(df)&lt;-fr[,<span class="dv">1</span>] <span class="co">#bipartite matrix</span></span>
<span id="cb133-13"><a href="machine-learning.html#cb133-13"></a></span>
<span id="cb133-14"><a href="machine-learning.html#cb133-14"></a><span class="co">#perform Galois derivations between partially ordered subsets</span></span>
<span id="cb133-15"><a href="machine-learning.html#cb133-15"></a><span class="co">#galois(df_se&#39;,labeling = &quot;full&quot;)</span></span>
<span id="cb133-16"><a href="machine-learning.html#cb133-16"></a>gf &lt;-<span class="st"> </span><span class="kw">galois</span>(df, <span class="dt">labeling =</span> <span class="st">&quot;reduced&quot;</span>)</span>
<span id="cb133-17"><a href="machine-learning.html#cb133-17"></a></span>
<span id="cb133-18"><a href="machine-learning.html#cb133-18"></a><span class="co">#partial ordering of concept</span></span>
<span id="cb133-19"><a href="machine-learning.html#cb133-19"></a>po&lt;-<span class="kw">partial.order</span>(gf,<span class="dt">type=</span><span class="st">&quot;galois&quot;</span>)</span>
<span id="cb133-20"><a href="machine-learning.html#cb133-20"></a><span class="kw">diagram</span>(po, <span class="dt">main=</span><span class="st">&quot;Hasse diagram of partial order - Fruit&quot;</span>) </span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-9-1.png" width="672" /></p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="machine-learning.html#cb134-1"></a><span class="co">#lattice  diagram with reduced context</span></span>
<span id="cb134-2"><a href="machine-learning.html#cb134-2"></a><span class="kw">diagram.levels</span>(po)</span></code></pre></div>
<pre><code>##                 4                      4                     3        2
## 1 {round} {Apple} {cylindrical} {Banana} {tropical, yellow} {} {red} {}
##                3                    4 5 1
## 1 {green} {Pear} {large_seed} {Mango} 7 8</code></pre>
<p>Next we illustrate FCA in network of hospitals in South-Eastern Melbourne. The objects are the hospitals and the attributes are the services available in those hospitals.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="machine-learning.html#cb136-1"></a><span class="co">#library(multiplex) #Algebraic Tools for the Analysis of Multiple Social Networks</span></span>
<span id="cb136-2"><a href="machine-learning.html#cb136-2"></a><span class="co">#library(Rgraphviz) #plot hasse diagram</span></span>
<span id="cb136-3"><a href="machine-learning.html#cb136-3"></a></span>
<span id="cb136-4"><a href="machine-learning.html#cb136-4"></a><span class="co">#install BiocManager::install(&quot;Rgraphviz&quot;)</span></span>
<span id="cb136-5"><a href="machine-learning.html#cb136-5"></a></span>
<span id="cb136-6"><a href="machine-learning.html#cb136-6"></a>edge&lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./Data-Use/Hosp_Network_geocoded.csv&quot;</span>)</span>
<span id="cb136-7"><a href="machine-learning.html#cb136-7"></a>df&lt;-edge[,<span class="kw">c</span>(<span class="dv">2</span><span class="op">:</span><span class="kw">dim</span>(edge)[<span class="dv">2</span>])]</span>
<span id="cb136-8"><a href="machine-learning.html#cb136-8"></a><span class="kw">row.names</span>(df)&lt;-edge[,<span class="dv">1</span>] <span class="co">#bipartite matrix</span></span>
<span id="cb136-9"><a href="machine-learning.html#cb136-9"></a></span>
<span id="cb136-10"><a href="machine-learning.html#cb136-10"></a><span class="co">#select columns#remove distance data</span></span>
<span id="cb136-11"><a href="machine-learning.html#cb136-11"></a>df_se&lt;-edge[,<span class="kw">c</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">16</span>)]</span>
<span id="cb136-12"><a href="machine-learning.html#cb136-12"></a><span class="kw">row.names</span>(df_se)&lt;-edge[,<span class="dv">1</span>] <span class="co">#bipartite matrix</span></span>
<span id="cb136-13"><a href="machine-learning.html#cb136-13"></a></span>
<span id="cb136-14"><a href="machine-learning.html#cb136-14"></a><span class="co">#south eastern hospitals</span></span>
<span id="cb136-15"><a href="machine-learning.html#cb136-15"></a><span class="co">#select rows</span></span>
<span id="cb136-16"><a href="machine-learning.html#cb136-16"></a>df_se&lt;-df_se[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">19</span>,<span class="dv">20</span>,<span class="dv">24</span>,<span class="dv">31</span>,<span class="dv">33</span>,<span class="dv">34</span>,<span class="dv">35</span>),]</span>
<span id="cb136-17"><a href="machine-learning.html#cb136-17"></a></span>
<span id="cb136-18"><a href="machine-learning.html#cb136-18"></a><span class="co">#perform Galois derivations between partially ordered subsets</span></span>
<span id="cb136-19"><a href="machine-learning.html#cb136-19"></a><span class="co">#galois(df_se&#39;,labeling = &quot;full&quot;)</span></span>
<span id="cb136-20"><a href="machine-learning.html#cb136-20"></a>gf &lt;-<span class="st"> </span><span class="kw">galois</span>(df_se, <span class="dt">labeling =</span> <span class="st">&quot;reduced&quot;</span>)</span>
<span id="cb136-21"><a href="machine-learning.html#cb136-21"></a><span class="co">#partial ordering of concept</span></span>
<span id="cb136-22"><a href="machine-learning.html#cb136-22"></a>po&lt;-<span class="kw">partial.order</span>(gf,<span class="dt">type=</span><span class="st">&quot;galois&quot;</span>)</span>
<span id="cb136-23"><a href="machine-learning.html#cb136-23"></a><span class="kw">diagram</span>(po, <span class="dt">main=</span><span class="st">&quot;Hasse diagram of partial order with reduced context&quot;</span>) </span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-9-1-1.png" width="672" /></p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="machine-learning.html#cb137-1"></a><span class="co">#lattice  diagram with reduced context</span></span>
<span id="cb137-2"><a href="machine-learning.html#cb137-2"></a><span class="kw">diagram.levels</span>(po)</span></code></pre></div>
<pre><code>##                         9             4                 1
## 1 {designated, ECR} {mmc} {link_rmh} {} {CT, link_mmc} {}
##                                                        3               2
## 1 {X99min_rmh} {dandenongvalley, knoxprivate, seprivate} {X99min_mmc} {}
##             2        3        3           7        6        5                3
## 1 {public} {} {TPA} {} {CTA} {} {CTP} {ddh} {MRI} {} {VST} {} {stroke_unit} {}
##                     8 10            5        8               6  4  6          6
## 1 {neurosx} {cabrini} 14 {} {hampton} {} {bhh} {} {marroondah} 18 19 {} {casey}
##               8  5  3  5  4               6  4  4              7  5  4
## 1 {} {warragul} 22 23 24 25 {} {bairnsdale} 27 28 {} {frankston} 30 31
##           6            7
## 1 {} {sale} {} {latrobe}</code></pre>
</div>
<div id="evolutionary-algorithm" class="section level2">
<h2><span class="header-section-number">6.8</span> Evolutionary Algorithm</h2>
<p>Evolutionary algorithm are search method which take the source of inspiration
from nature such as evolution and survival of the fittest. These are seen as heuristic based method. The results from evolutionary algorithm shouldn’t be compared unless all conditions set are the same. In essence the findings are similar under the same conditions.</p>
<div id="simulated-annealing" class="section level3">
<h3><span class="header-section-number">6.8.1</span> Simulated Annealing</h3>
<p>This method uses idea in metallurgy whereby metal is heated and then cooled to alter its property.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="machine-learning.html#cb139-1"></a><span class="co">#SA section is set not to run as the analysis takes a long time.</span></span>
<span id="cb139-2"><a href="machine-learning.html#cb139-2"></a><span class="co"># a saved run is provided below</span></span>
<span id="cb139-3"><a href="machine-learning.html#cb139-3"></a></span>
<span id="cb139-4"><a href="machine-learning.html#cb139-4"></a><span class="kw">data</span>(<span class="st">&quot;BreastCancer&quot;</span>,<span class="dt">package =</span> <span class="st">&quot;mlbench&quot;</span>)</span>
<span id="cb139-5"><a href="machine-learning.html#cb139-5"></a><span class="kw">colnames</span>(BreastCancer)</span>
<span id="cb139-6"><a href="machine-learning.html#cb139-6"></a></span>
<span id="cb139-7"><a href="machine-learning.html#cb139-7"></a><span class="co">#check for duplicates</span></span>
<span id="cb139-8"><a href="machine-learning.html#cb139-8"></a><span class="kw">sum</span>(<span class="kw">duplicated</span>(BreastCancer))</span>
<span id="cb139-9"><a href="machine-learning.html#cb139-9"></a></span>
<span id="cb139-10"><a href="machine-learning.html#cb139-10"></a><span class="co">#remove duplicates</span></span>
<span id="cb139-11"><a href="machine-learning.html#cb139-11"></a><span class="co">#keep Id to avoid creation of new duplicates</span></span>
<span id="cb139-12"><a href="machine-learning.html#cb139-12"></a>BreastCancer1&lt;-<span class="kw">unique</span>(BreastCancer) <span class="co">#reduce 699 to 691 rows</span></span>
<span id="cb139-13"><a href="machine-learning.html#cb139-13"></a></span>
<span id="cb139-14"><a href="machine-learning.html#cb139-14"></a><span class="co">#convert multiple columns to numeric</span></span>
<span id="cb139-15"><a href="machine-learning.html#cb139-15"></a><span class="co">#lapply output a list</span></span>
<span id="cb139-16"><a href="machine-learning.html#cb139-16"></a>BreastCancer2&lt;-<span class="kw">lapply</span>(BreastCancer1[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">11</span>)], as.numeric) <span class="co">#list</span></span>
<span id="cb139-17"><a href="machine-learning.html#cb139-17"></a>BreastCancer2&lt;-<span class="kw">as.data.frame</span>(BreastCancer2)</span>
<span id="cb139-18"><a href="machine-learning.html#cb139-18"></a>BreastCancer2<span class="op">$</span>Class&lt;-BreastCancer1<span class="op">$</span>Class</span>
<span id="cb139-19"><a href="machine-learning.html#cb139-19"></a></span>
<span id="cb139-20"><a href="machine-learning.html#cb139-20"></a>x=BreastCancer2[,<span class="op">-</span><span class="dv">10</span>]</span>
<span id="cb139-21"><a href="machine-learning.html#cb139-21"></a>y=BreastCancer2<span class="op">$</span>Class</span>
<span id="cb139-22"><a href="machine-learning.html#cb139-22"></a></span>
<span id="cb139-23"><a href="machine-learning.html#cb139-23"></a></span>
<span id="cb139-24"><a href="machine-learning.html#cb139-24"></a>sa_ctrl &lt;-<span class="st"> </span><span class="kw">safsControl</span>(<span class="dt">functions =</span> rfSA,</span>
<span id="cb139-25"><a href="machine-learning.html#cb139-25"></a>                       <span class="dt">method =</span> <span class="st">&quot;repeatedcv&quot;</span>,</span>
<span id="cb139-26"><a href="machine-learning.html#cb139-26"></a>                       <span class="dt">repeats =</span> <span class="dv">3</span>, <span class="co">#default is 5</span></span>
<span id="cb139-27"><a href="machine-learning.html#cb139-27"></a>                       <span class="dt">improve =</span> <span class="dv">50</span>)</span>
<span id="cb139-28"><a href="machine-learning.html#cb139-28"></a></span>
<span id="cb139-29"><a href="machine-learning.html#cb139-29"></a><span class="kw">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb139-30"><a href="machine-learning.html#cb139-30"></a>glm_sa &lt;-<span class="st"> </span><span class="kw">safs</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y,</span>
<span id="cb139-31"><a href="machine-learning.html#cb139-31"></a>              <span class="dt">iters =</span> <span class="dv">5</span>, <span class="co">#default is 250</span></span>
<span id="cb139-32"><a href="machine-learning.html#cb139-32"></a>              <span class="dt">safsControl =</span> sa_ctrl, <span class="dt">method=</span><span class="st">&quot;glm&quot;</span>)</span>
<span id="cb139-33"><a href="machine-learning.html#cb139-33"></a></span>
<span id="cb139-34"><a href="machine-learning.html#cb139-34"></a><span class="co">#save(glm_sa,file=&quot;Logistic_SimulatedAnnealing.Rda&quot;)</span></span>
<span id="cb139-35"><a href="machine-learning.html#cb139-35"></a></span>
<span id="cb139-36"><a href="machine-learning.html#cb139-36"></a><span class="co">#############################################</span></span>
<span id="cb139-37"><a href="machine-learning.html#cb139-37"></a><span class="co">#</span></span>
<span id="cb139-38"><a href="machine-learning.html#cb139-38"></a><span class="co">#Simulated Annealing Feature Selection</span></span>
<span id="cb139-39"><a href="machine-learning.html#cb139-39"></a><span class="co">#</span></span>
<span id="cb139-40"><a href="machine-learning.html#cb139-40"></a><span class="co">#691 samples</span></span>
<span id="cb139-41"><a href="machine-learning.html#cb139-41"></a><span class="co">#9 predictors</span></span>
<span id="cb139-42"><a href="machine-learning.html#cb139-42"></a><span class="co">#2 classes: &#39;benign&#39;, &#39;malignant&#39; </span></span>
<span id="cb139-43"><a href="machine-learning.html#cb139-43"></a><span class="co">#</span></span>
<span id="cb139-44"><a href="machine-learning.html#cb139-44"></a><span class="co">#Maximum search iterations: 5 </span></span>
<span id="cb139-45"><a href="machine-learning.html#cb139-45"></a><span class="co">#Restart after 50 iterations without improvement (0 restarts on average)</span></span>
<span id="cb139-46"><a href="machine-learning.html#cb139-46"></a><span class="co">#</span></span>
<span id="cb139-47"><a href="machine-learning.html#cb139-47"></a><span class="co">#Internal performance values: Accuracy, Kappa</span></span>
<span id="cb139-48"><a href="machine-learning.html#cb139-48"></a><span class="co">#Subset selection driven to maximize internal Accuracy </span></span>
<span id="cb139-49"><a href="machine-learning.html#cb139-49"></a><span class="co">#</span></span>
<span id="cb139-50"><a href="machine-learning.html#cb139-50"></a><span class="co">#External performance values: Accuracy, Kappa</span></span>
<span id="cb139-51"><a href="machine-learning.html#cb139-51"></a><span class="co">#Best iteration chose by maximizing external Accuracy </span></span>
<span id="cb139-52"><a href="machine-learning.html#cb139-52"></a><span class="co">#External resampling method: Cross-Validated (10 fold, repeated 3 times) </span></span>
<span id="cb139-53"><a href="machine-learning.html#cb139-53"></a></span>
<span id="cb139-54"><a href="machine-learning.html#cb139-54"></a><span class="co">#During resampling:</span></span>
<span id="cb139-55"><a href="machine-learning.html#cb139-55"></a><span class="co">#  * the top 5 selected variables (out of a possible 9):</span></span>
<span id="cb139-56"><a href="machine-learning.html#cb139-56"></a><span class="co">#    Bl.cromatin (56.7%), Id (46.7%), Cl.thickness (43.3%), Epith.c.size (43.3%), #Marg.adhesion (43.3%)</span></span>
<span id="cb139-57"><a href="machine-learning.html#cb139-57"></a><span class="co">#  * on average, 3.5 variables were selected (min = 2, max = 5)</span></span>
<span id="cb139-58"><a href="machine-learning.html#cb139-58"></a><span class="co">#</span></span>
<span id="cb139-59"><a href="machine-learning.html#cb139-59"></a><span class="co">#In the final search using the entire training set:</span></span>
<span id="cb139-60"><a href="machine-learning.html#cb139-60"></a><span class="co">#   * 2 features selected at iteration 5 including:</span></span>
<span id="cb139-61"><a href="machine-learning.html#cb139-61"></a><span class="co">#     Cl.thickness, Cell.size  </span></span>
<span id="cb139-62"><a href="machine-learning.html#cb139-62"></a><span class="co">#   * external performance at this iteration is</span></span>
<span id="cb139-63"><a href="machine-learning.html#cb139-63"></a><span class="co">#</span></span>
<span id="cb139-64"><a href="machine-learning.html#cb139-64"></a><span class="co">#   Accuracy       Kappa </span></span>
<span id="cb139-65"><a href="machine-learning.html#cb139-65"></a><span class="co">#     0.9314      0.8479 </span></span></code></pre></div>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="machine-learning.html#cb140-1"></a><span class="kw">load</span>(<span class="st">&quot;./Logistic_SimulatedAnnealing.Rda&quot;</span>)</span>
<span id="cb140-2"><a href="machine-learning.html#cb140-2"></a></span>
<span id="cb140-3"><a href="machine-learning.html#cb140-3"></a><span class="co">#plot output of simulated annealing</span></span>
<span id="cb140-4"><a href="machine-learning.html#cb140-4"></a><span class="kw">plot</span>(glm_sa)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-10-1-1.png" width="672" /></p>
</div>
<div id="genetic-algorithm" class="section level3">
<h3><span class="header-section-number">6.8.2</span> Genetic Algorithm</h3>
<p>Genetic algorithm is a machine learning tool based on ideas from Darwin’s
concept of natural selection. It is based on mutation, crossover and selection. Genetic algorithm can be used in any situation. The issue is in finding the fitness function to evaluate the output. Since it does not depend on gradient descent algorithm, it is less likely to be stuck in local minima compared to
other machine learning methods. Genetic algorithm is available in R as part of <em>caret</em> and <em>GA</em> libraries. Genetic algorithm can be used to optimise feature selection for regression modelling at the expense of much longer running time.</p>
<p>One potential issue with using cross-validation in genetic algorithm for feature selection is that it would be not right to use it again when feeding this data into another machine learning method.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="machine-learning.html#cb141-1"></a><span class="co">#GA</span></span>
<span id="cb141-2"><a href="machine-learning.html#cb141-2"></a><span class="kw">library</span>(caret)</span>
<span id="cb141-3"><a href="machine-learning.html#cb141-3"></a></span>
<span id="cb141-4"><a href="machine-learning.html#cb141-4"></a><span class="kw">data</span>(<span class="st">&quot;BreastCancer&quot;</span>,<span class="dt">package =</span> <span class="st">&quot;mlbench&quot;</span>)</span>
<span id="cb141-5"><a href="machine-learning.html#cb141-5"></a><span class="kw">colnames</span>(BreastCancer)</span>
<span id="cb141-6"><a href="machine-learning.html#cb141-6"></a></span>
<span id="cb141-7"><a href="machine-learning.html#cb141-7"></a><span class="co">#check for duplicates</span></span>
<span id="cb141-8"><a href="machine-learning.html#cb141-8"></a><span class="kw">sum</span>(<span class="kw">duplicated</span>(BreastCancer))</span>
<span id="cb141-9"><a href="machine-learning.html#cb141-9"></a></span>
<span id="cb141-10"><a href="machine-learning.html#cb141-10"></a><span class="co">#remove duplicates</span></span>
<span id="cb141-11"><a href="machine-learning.html#cb141-11"></a><span class="co">#keep Id to avoid creation of new duplicates</span></span>
<span id="cb141-12"><a href="machine-learning.html#cb141-12"></a>BreastCancer1&lt;-<span class="kw">unique</span>(BreastCancer) <span class="co">#reduce 699 to 691 rows</span></span>
<span id="cb141-13"><a href="machine-learning.html#cb141-13"></a></span>
<span id="cb141-14"><a href="machine-learning.html#cb141-14"></a><span class="co">#convert multiple columns to numeric</span></span>
<span id="cb141-15"><a href="machine-learning.html#cb141-15"></a><span class="co">#lapply output a list</span></span>
<span id="cb141-16"><a href="machine-learning.html#cb141-16"></a>BreastCancer2&lt;-<span class="kw">lapply</span>(BreastCancer1[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">11</span>)], as.numeric) <span class="co">#list</span></span>
<span id="cb141-17"><a href="machine-learning.html#cb141-17"></a>BreastCancer2&lt;-<span class="kw">as.data.frame</span>(BreastCancer2)</span>
<span id="cb141-18"><a href="machine-learning.html#cb141-18"></a>BreastCancer2<span class="op">$</span>Class&lt;-BreastCancer1<span class="op">$</span>Class</span>
<span id="cb141-19"><a href="machine-learning.html#cb141-19"></a></span>
<span id="cb141-20"><a href="machine-learning.html#cb141-20"></a></span>
<span id="cb141-21"><a href="machine-learning.html#cb141-21"></a><span class="co">#check for NA</span></span>
<span id="cb141-22"><a href="machine-learning.html#cb141-22"></a><span class="kw">anyNA</span>(BreastCancer2)</span>
<span id="cb141-23"><a href="machine-learning.html#cb141-23"></a></span>
<span id="cb141-24"><a href="machine-learning.html#cb141-24"></a>split =<span class="st"> </span>caTools<span class="op">::</span><span class="kw">sample.split</span>(BreastCancer2<span class="op">$</span>Class, <span class="dt">SplitRatio =</span> <span class="fl">0.7</span>)</span>
<span id="cb141-25"><a href="machine-learning.html#cb141-25"></a>Train =<span class="st"> </span><span class="kw">subset</span>(BreastCancer2, split <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>)</span>
<span id="cb141-26"><a href="machine-learning.html#cb141-26"></a>Test =<span class="st"> </span><span class="kw">subset</span>(BreastCancer2, split <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>)</span>
<span id="cb141-27"><a href="machine-learning.html#cb141-27"></a></span>
<span id="cb141-28"><a href="machine-learning.html#cb141-28"></a>x=Train[,<span class="op">-</span><span class="dv">10</span>]</span>
<span id="cb141-29"><a href="machine-learning.html#cb141-29"></a>y=Train<span class="op">$</span>Class</span>
<span id="cb141-30"><a href="machine-learning.html#cb141-30"></a></span>
<span id="cb141-31"><a href="machine-learning.html#cb141-31"></a><span class="co">#cross validation indicates the number of cycle of the procedure from randomly generating new population of chromosome to mutate child chromosome.</span></span>
<span id="cb141-32"><a href="machine-learning.html#cb141-32"></a></span>
<span id="cb141-33"><a href="machine-learning.html#cb141-33"></a>ga_ctrl &lt;-<span class="st"> </span><span class="kw">gafsControl</span>(<span class="dt">functions =</span> rfGA,</span>
<span id="cb141-34"><a href="machine-learning.html#cb141-34"></a>                       <span class="dt">method =</span> <span class="st">&quot;cv&quot;</span>,</span>
<span id="cb141-35"><a href="machine-learning.html#cb141-35"></a>                       <span class="dt">repeats =</span> <span class="dv">3</span>, <span class="co"># default is 10</span></span>
<span id="cb141-36"><a href="machine-learning.html#cb141-36"></a>                       <span class="dt">genParallel=</span><span class="ot">TRUE</span>, <span class="co"># Use parallel programming</span></span>
<span id="cb141-37"><a href="machine-learning.html#cb141-37"></a>                       <span class="dt">allowParallel =</span> <span class="ot">TRUE</span></span>
<span id="cb141-38"><a href="machine-learning.html#cb141-38"></a>                       )</span>
<span id="cb141-39"><a href="machine-learning.html#cb141-39"></a></span>
<span id="cb141-40"><a href="machine-learning.html#cb141-40"></a><span class="co">## Use the same random number seed as the RFE process</span></span>
<span id="cb141-41"><a href="machine-learning.html#cb141-41"></a><span class="co">## so that the same CV folds are used for the external</span></span>
<span id="cb141-42"><a href="machine-learning.html#cb141-42"></a><span class="co">## resampling. </span></span>
<span id="cb141-43"><a href="machine-learning.html#cb141-43"></a></span>
<span id="cb141-44"><a href="machine-learning.html#cb141-44"></a><span class="kw">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb141-45"><a href="machine-learning.html#cb141-45"></a><span class="kw">system.time</span>(glm_ga &lt;-<span class="st"> </span><span class="kw">gafs</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y,</span>
<span id="cb141-46"><a href="machine-learning.html#cb141-46"></a>              <span class="dt">iters =</span> <span class="dv">5</span>, <span class="co">#recommended is 200</span></span>
<span id="cb141-47"><a href="machine-learning.html#cb141-47"></a>              <span class="dt">gafsControl =</span> ga_ctrl, <span class="dt">method=</span><span class="st">&quot;glm&quot;</span>))</span>
<span id="cb141-48"><a href="machine-learning.html#cb141-48"></a></span>
<span id="cb141-49"><a href="machine-learning.html#cb141-49"></a><span class="co">#save(glm_ga,file=&quot;Logistic_GeneticAlgorithm.Rda&quot;)</span></span>
<span id="cb141-50"><a href="machine-learning.html#cb141-50"></a></span>
<span id="cb141-51"><a href="machine-learning.html#cb141-51"></a><span class="co">################################################################</span></span>
<span id="cb141-52"><a href="machine-learning.html#cb141-52"></a><span class="co"># The output of glm_ga</span></span>
<span id="cb141-53"><a href="machine-learning.html#cb141-53"></a><span class="co">#Genetic Algorithm Feature Selection</span></span>
<span id="cb141-54"><a href="machine-learning.html#cb141-54"></a></span>
<span id="cb141-55"><a href="machine-learning.html#cb141-55"></a><span class="co">#484 samples</span></span>
<span id="cb141-56"><a href="machine-learning.html#cb141-56"></a><span class="co">#9 predictors</span></span>
<span id="cb141-57"><a href="machine-learning.html#cb141-57"></a><span class="co">#2 classes: &#39;benign&#39;, &#39;malignant&#39; </span></span>
<span id="cb141-58"><a href="machine-learning.html#cb141-58"></a></span>
<span id="cb141-59"><a href="machine-learning.html#cb141-59"></a><span class="co">#Maximum generations: 5 </span></span>
<span id="cb141-60"><a href="machine-learning.html#cb141-60"></a><span class="co">#Population per generation: 50 </span></span>
<span id="cb141-61"><a href="machine-learning.html#cb141-61"></a><span class="co">#Crossover probability: 0.8 </span></span>
<span id="cb141-62"><a href="machine-learning.html#cb141-62"></a><span class="co">#Mutation probability: 0.1 </span></span>
<span id="cb141-63"><a href="machine-learning.html#cb141-63"></a><span class="co">#Elitism: 0 </span></span>
<span id="cb141-64"><a href="machine-learning.html#cb141-64"></a><span class="co">#</span></span>
<span id="cb141-65"><a href="machine-learning.html#cb141-65"></a><span class="co">#Internal performance values: Accuracy, Kappa</span></span>
<span id="cb141-66"><a href="machine-learning.html#cb141-66"></a><span class="co">#Subset selection driven to maximize internal Accuracy </span></span>
<span id="cb141-67"><a href="machine-learning.html#cb141-67"></a><span class="co">#</span></span>
<span id="cb141-68"><a href="machine-learning.html#cb141-68"></a><span class="co">#External performance values: Accuracy, Kappa</span></span>
<span id="cb141-69"><a href="machine-learning.html#cb141-69"></a><span class="co">#Best iteration chose by maximizing external Accuracy </span></span>
<span id="cb141-70"><a href="machine-learning.html#cb141-70"></a><span class="co">#External resampling method: Cross-Validated (10 fold) </span></span>
<span id="cb141-71"><a href="machine-learning.html#cb141-71"></a><span class="co">#</span></span>
<span id="cb141-72"><a href="machine-learning.html#cb141-72"></a><span class="co">#During resampling:</span></span>
<span id="cb141-73"><a href="machine-learning.html#cb141-73"></a><span class="co">#  * the top 5 selected variables (out of a possible 9):</span></span>
<span id="cb141-74"><a href="machine-learning.html#cb141-74"></a><span class="co">#    Cell.shape (100%), Cl.thickness (100%), Epith.c.size (100%), </span></span>
<span id="cb141-75"><a href="machine-learning.html#cb141-75"></a>Normal.nucleoli <span class="co">#(100%), Id (90%)</span></span>
<span id="cb141-76"><a href="machine-learning.html#cb141-76"></a><span class="co">#  * on average, 6.7 variables were selected (min = 5, max = 8)</span></span>
<span id="cb141-77"><a href="machine-learning.html#cb141-77"></a><span class="co">#</span></span>
<span id="cb141-78"><a href="machine-learning.html#cb141-78"></a><span class="co">#In the final search using the entire training set:</span></span>
<span id="cb141-79"><a href="machine-learning.html#cb141-79"></a><span class="co">#   * 7 features selected at iteration 2 including:</span></span>
<span id="cb141-80"><a href="machine-learning.html#cb141-80"></a><span class="co">#     Cl.thickness, Cell.shape, Marg.adhesion, Epith.c.size, Bl.cromatin ... </span></span>
<span id="cb141-81"><a href="machine-learning.html#cb141-81"></a><span class="co">#   * external performance at this iteration is</span></span>
<span id="cb141-82"><a href="machine-learning.html#cb141-82"></a><span class="co">#</span></span>
<span id="cb141-83"><a href="machine-learning.html#cb141-83"></a><span class="co">#   Accuracy       Kappa </span></span>
<span id="cb141-84"><a href="machine-learning.html#cb141-84"></a><span class="co">#     0.9691      0.9328 </span></span>
<span id="cb141-85"><a href="machine-learning.html#cb141-85"></a><span class="co">#</span></span></code></pre></div>
<p>The output from the Genetic Algorithm is plotted as mean fitness by
generations. This plot shows the internal and external accuracy estimate from cross validation.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="machine-learning.html#cb142-1"></a><span class="kw">load</span>(<span class="st">&quot;./Logistic_GeneticAlgorithm.Rda&quot;</span>)</span>
<span id="cb142-2"><a href="machine-learning.html#cb142-2"></a><span class="co">#plot output of genetic algorithm </span></span>
<span id="cb142-3"><a href="machine-learning.html#cb142-3"></a><span class="kw">plot</span>(glm_ga)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-11-1-1.png" width="672" /></p>
</div>
</div>
<div id="manifold-learning" class="section level2">
<h2><span class="header-section-number">6.9</span> Manifold learning</h2>
<div id="t-stochastic-neighbourhood-embedding" class="section level3">
<h3><span class="header-section-number">6.9.1</span> T-Stochastic Neighbourhood Embedding</h3>
<p>T-Stochastic Neighbourhood Embedding (TSNE) is a maifold learning method which seeks to transform the complex data into low (2) dimensions while maintaining
the distance between neighbouring objects. The distance between data points are can be measured using Euclidean distance or other measures of distance. The transformed data points are conditional probabilities that represents similarities. The original description of TSNE used PCA as a first step to speed up computation and reduce noise.</p>
<p>This method is listed here as it is a form of data reduction method. This non-linear method is different from PCA in that the low dimensional output of
TSNE are not intended for machine learning. TSNE is implemented in R as <em>Rtsne</em>. The perplexity parameter allows tuning of the proximity of the data points. The PCA step can be performed within <em>Rtsne</em> by setting the <em>pca</em> argument. The default number of iterations or max_iter is 1000.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="machine-learning.html#cb143-1"></a><span class="kw">library</span>(Rtsne)</span>
<span id="cb143-2"><a href="machine-learning.html#cb143-2"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb143-3"><a href="machine-learning.html#cb143-3"></a><span class="kw">library</span>(mice) <span class="co">#impute missing data</span></span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;mice&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:BiocGenerics&#39;:
## 
##     cbind, rbind</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     filter</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     cbind, rbind</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="machine-learning.html#cb148-1"></a><span class="kw">data</span>(<span class="st">&quot;BreastCancer&quot;</span>,<span class="dt">package =</span> <span class="st">&quot;mlbench&quot;</span>)</span>
<span id="cb148-2"><a href="machine-learning.html#cb148-2"></a><span class="kw">colnames</span>(BreastCancer)</span></code></pre></div>
<pre><code>##  [1] &quot;Id&quot;              &quot;Cl.thickness&quot;    &quot;Cell.size&quot;       &quot;Cell.shape&quot;     
##  [5] &quot;Marg.adhesion&quot;   &quot;Epith.c.size&quot;    &quot;Bare.nuclei&quot;     &quot;Bl.cromatin&quot;    
##  [9] &quot;Normal.nucleoli&quot; &quot;Mitoses&quot;         &quot;Class&quot;</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="machine-learning.html#cb150-1"></a><span class="co">#check for duplicates</span></span>
<span id="cb150-2"><a href="machine-learning.html#cb150-2"></a><span class="kw">sum</span>(<span class="kw">duplicated</span>(BreastCancer))</span></code></pre></div>
<pre><code>## [1] 8</code></pre>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="machine-learning.html#cb152-1"></a><span class="co">#remove duplicates</span></span>
<span id="cb152-2"><a href="machine-learning.html#cb152-2"></a><span class="co">#keep Id to avoid creation of new duplicates</span></span>
<span id="cb152-3"><a href="machine-learning.html#cb152-3"></a>BreastCancer1&lt;-<span class="kw">unique</span>(BreastCancer) <span class="co">#reduce 699 to 691 rows</span></span>
<span id="cb152-4"><a href="machine-learning.html#cb152-4"></a></span>
<span id="cb152-5"><a href="machine-learning.html#cb152-5"></a><span class="co">#impute missing data</span></span>
<span id="cb152-6"><a href="machine-learning.html#cb152-6"></a><span class="co">#m is number of multiple imputation, default is 5</span></span>
<span id="cb152-7"><a href="machine-learning.html#cb152-7"></a><span class="co">#output is a list</span></span>
<span id="cb152-8"><a href="machine-learning.html#cb152-8"></a>imputed_Data &lt;-<span class="st"> </span><span class="kw">mice</span>(BreastCancer1, <span class="dt">m=</span><span class="dv">5</span>, <span class="dt">maxit =</span> <span class="dv">5</span>, <span class="dt">method =</span> <span class="st">&#39;pmm&#39;</span>, <span class="dt">seed =</span> <span class="dv">500</span>)</span></code></pre></div>
<pre><code>## 
##  iter imp variable
##   1   1  Bare.nuclei
##   1   2  Bare.nuclei
##   1   3  Bare.nuclei
##   1   4  Bare.nuclei
##   1   5  Bare.nuclei
##   2   1  Bare.nuclei
##   2   2  Bare.nuclei
##   2   3  Bare.nuclei
##   2   4  Bare.nuclei
##   2   5  Bare.nuclei
##   3   1  Bare.nuclei
##   3   2  Bare.nuclei
##   3   3  Bare.nuclei
##   3   4  Bare.nuclei
##   3   5  Bare.nuclei
##   4   1  Bare.nuclei
##   4   2  Bare.nuclei
##   4   3  Bare.nuclei
##   4   4  Bare.nuclei
##   4   5  Bare.nuclei
##   5   1  Bare.nuclei
##   5   2  Bare.nuclei
##   5   3  Bare.nuclei
##   5   4  Bare.nuclei
##   5   5  Bare.nuclei</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="machine-learning.html#cb154-1"></a><span class="co">#choose among the 5 imputed dataset</span></span>
<span id="cb154-2"><a href="machine-learning.html#cb154-2"></a>completeData &lt;-<span class="st"> </span><span class="kw">complete</span>(imputed_Data,<span class="dv">2</span>)</span>
<span id="cb154-3"><a href="machine-learning.html#cb154-3"></a></span>
<span id="cb154-4"><a href="machine-learning.html#cb154-4"></a><span class="co">#convert multiple columns to numeric</span></span>
<span id="cb154-5"><a href="machine-learning.html#cb154-5"></a><span class="co">#lapply output a list</span></span>
<span id="cb154-6"><a href="machine-learning.html#cb154-6"></a>BreastCancer2&lt;-<span class="kw">lapply</span>(completeData[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">11</span>)], as.numeric) <span class="co">#list</span></span>
<span id="cb154-7"><a href="machine-learning.html#cb154-7"></a>BreastCancer2&lt;-<span class="kw">as.data.frame</span>(BreastCancer2)</span>
<span id="cb154-8"><a href="machine-learning.html#cb154-8"></a>BreastCancer2<span class="op">$</span>Class&lt;-BreastCancer1<span class="op">$</span>Class</span>
<span id="cb154-9"><a href="machine-learning.html#cb154-9"></a></span>
<span id="cb154-10"><a href="machine-learning.html#cb154-10"></a>BC_unique &lt;-<span class="st"> </span><span class="kw">unique</span>(BreastCancer2) <span class="co"># Remove duplicates</span></span>
<span id="cb154-11"><a href="machine-learning.html#cb154-11"></a><span class="kw">set.seed</span>(<span class="dv">42</span>) <span class="co"># Sets seed for reproducibility</span></span>
<span id="cb154-12"><a href="machine-learning.html#cb154-12"></a>tsne_out &lt;-<span class="st"> </span><span class="kw">Rtsne</span>(<span class="kw">as.matrix</span>(BC_unique[,<span class="op">-</span><span class="dv">11</span>]), </span>
<span id="cb154-13"><a href="machine-learning.html#cb154-13"></a>        <span class="dt">normalize =</span> T, <span class="co">#normalise data</span></span>
<span id="cb154-14"><a href="machine-learning.html#cb154-14"></a>        <span class="dt">pca=</span>T, <span class="dt">dims =</span> <span class="dv">3</span>, <span class="co">#pca before analysis</span></span>
<span id="cb154-15"><a href="machine-learning.html#cb154-15"></a>        <span class="dt">perplexity=</span><span class="dv">20</span>, <span class="co">#tuning</span></span>
<span id="cb154-16"><a href="machine-learning.html#cb154-16"></a>        <span class="dt">verbose=</span><span class="ot">FALSE</span>) <span class="co"># Run TSNE</span></span>
<span id="cb154-17"><a href="machine-learning.html#cb154-17"></a><span class="co">#plot(tsne_out$Y,col=BC_unique$Class,asp=1)</span></span>
<span id="cb154-18"><a href="machine-learning.html#cb154-18"></a></span>
<span id="cb154-19"><a href="machine-learning.html#cb154-19"></a><span class="co"># Add a new column with color</span></span>
<span id="cb154-20"><a href="machine-learning.html#cb154-20"></a>mycolors &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;red&#39;</span>, <span class="st">&#39;blue&#39;</span>)</span>
<span id="cb154-21"><a href="machine-learning.html#cb154-21"></a>BC_unique<span class="op">$</span>color &lt;-<span class="st"> </span>mycolors[ <span class="kw">as.numeric</span>(BC_unique<span class="op">$</span>Class) ]</span>
<span id="cb154-22"><a href="machine-learning.html#cb154-22"></a></span>
<span id="cb154-23"><a href="machine-learning.html#cb154-23"></a>rgl<span class="op">::</span><span class="kw">plot3d</span>(<span class="dt">x=</span>tsne_out<span class="op">$</span>Y[,<span class="dv">1</span>], <span class="dt">y=</span>tsne_out<span class="op">$</span>Y[,<span class="dv">2</span>], <span class="dt">z=</span>tsne_out<span class="op">$</span>Y[,<span class="dv">3</span>], <span class="dt">type =</span> <span class="st">&#39;p&#39;</span>, <span class="dt">col=</span>BC_unique<span class="op">$</span>color, <span class="dt">size=</span><span class="dv">8</span>)</span>
<span id="cb154-24"><a href="machine-learning.html#cb154-24"></a><span class="co">#rgl::legend3d(&quot;topright&quot;, legend = names(mycolors), pch = 16, col = colors, cex=1, inset=c(0.02))</span></span></code></pre></div>
<p>The example with Breast cancer didn’t turn out as well. Let’s try TSNE with the iris dataset.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="machine-learning.html#cb155-1"></a><span class="co">#TSNE</span></span>
<span id="cb155-2"><a href="machine-learning.html#cb155-2"></a></span>
<span id="cb155-3"><a href="machine-learning.html#cb155-3"></a><span class="kw">data</span>(iris)</span>
<span id="cb155-4"><a href="machine-learning.html#cb155-4"></a><span class="co">#5 columns</span></span>
<span id="cb155-5"><a href="machine-learning.html#cb155-5"></a></span>
<span id="cb155-6"><a href="machine-learning.html#cb155-6"></a>Iris_unique &lt;-<span class="st"> </span><span class="kw">unique</span>(iris) <span class="co"># Remove duplicates</span></span>
<span id="cb155-7"><a href="machine-learning.html#cb155-7"></a><span class="kw">set.seed</span>(<span class="dv">42</span>) <span class="co"># Sets seed for reproducibility</span></span>
<span id="cb155-8"><a href="machine-learning.html#cb155-8"></a>tsne_out &lt;-<span class="st"> </span><span class="kw">Rtsne</span>(<span class="kw">as.matrix</span>(Iris_unique[,<span class="op">-</span><span class="dv">5</span>]), <span class="dt">dims =</span> <span class="dv">2</span>, <span class="dt">perplexity=</span><span class="dv">10</span>, <span class="dt">verbose=</span><span class="ot">FALSE</span>) <span class="co"># Run TSNE</span></span>
<span id="cb155-9"><a href="machine-learning.html#cb155-9"></a><span class="kw">plot</span>(tsne_out<span class="op">$</span>Y,<span class="dt">col=</span>Iris_unique<span class="op">$</span>Species,<span class="dt">asp=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-12-1-1.png" width="672" /></p>
</div>
<div id="self-organising-map" class="section level3">
<h3><span class="header-section-number">6.9.2</span> Self organising map</h3>
<p>Self organising map is an unsupervised machine learning method and is excellent for viewing complex data in low dimensional space i.e. a data reduction method. SOM is available as part of <em>kohonen</em> library. It uses competitive learning to adjust its weight in contrast to other neural network approaches. Each node is evaluated to participate in the neural network. Input vectors that are close to each other in high dimensional space are mapped to be close to each other in low dimensional space.</p>
<p>The codes below are modified from <a href="https://rpubs.com/AlgoritmaAcademy/som" class="uri">https://rpubs.com/AlgoritmaAcademy/som</a> for use in aanalysis of iris data.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="machine-learning.html#cb156-1"></a><span class="kw">library</span>(kohonen)</span></code></pre></div>
<pre><code>## Warning: package &#39;kohonen&#39; was built under R version 4.0.5</code></pre>
<pre><code>## 
## Attaching package: &#39;kohonen&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     map</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="machine-learning.html#cb160-1"></a><span class="co">#unsupervised SOM</span></span>
<span id="cb160-2"><a href="machine-learning.html#cb160-2"></a><span class="co">#use iris dataset 150 x 5</span></span>
<span id="cb160-3"><a href="machine-learning.html#cb160-3"></a></span>
<span id="cb160-4"><a href="machine-learning.html#cb160-4"></a><span class="kw">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb160-5"><a href="machine-learning.html#cb160-5"></a></span>
<span id="cb160-6"><a href="machine-learning.html#cb160-6"></a><span class="co">#convert to numeric matrix</span></span>
<span id="cb160-7"><a href="machine-learning.html#cb160-7"></a>iris.train &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">scale</span>(iris[,<span class="op">-</span><span class="dv">5</span>]))</span>
<span id="cb160-8"><a href="machine-learning.html#cb160-8"></a></span>
<span id="cb160-9"><a href="machine-learning.html#cb160-9"></a><span class="co"># grid should be smaller than dim(iris) 150 x5</span></span>
<span id="cb160-10"><a href="machine-learning.html#cb160-10"></a><span class="co">#xdim =10 and ydim=10 would be &lt; 120</span></span>
<span id="cb160-11"><a href="machine-learning.html#cb160-11"></a>iris.grid &lt;-<span class="st"> </span><span class="kw">somgrid</span>(<span class="dt">xdim =</span> <span class="dv">10</span>, <span class="dt">ydim =</span> <span class="dv">10</span>, <span class="dt">topo =</span> <span class="st">&quot;hexagonal&quot;</span>)</span>
<span id="cb160-12"><a href="machine-learning.html#cb160-12"></a></span>
<span id="cb160-13"><a href="machine-learning.html#cb160-13"></a><span class="co">#som model</span></span>
<span id="cb160-14"><a href="machine-learning.html#cb160-14"></a>iris.model &lt;-<span class="st"> </span><span class="kw">som</span>(iris.train, iris.grid, <span class="dt">rlen =</span> <span class="dv">500</span>, <span class="dt">radius =</span> <span class="fl">2.5</span>, <span class="dt">keep.data =</span> <span class="ot">TRUE</span>, <span class="dt">dist.fcts =</span> <span class="st">&quot;euclidean&quot;</span>)</span>
<span id="cb160-15"><a href="machine-learning.html#cb160-15"></a></span>
<span id="cb160-16"><a href="machine-learning.html#cb160-16"></a><span class="kw">plot</span>(iris.model, <span class="dt">type =</span> <span class="st">&quot;mapping&quot;</span>, <span class="dt">pchs =</span> <span class="dv">19</span>, <span class="dt">shape =</span> <span class="st">&quot;round&quot;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-13-1.png" width="672" /></p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="machine-learning.html#cb161-1"></a><span class="kw">plot</span>(iris.model, <span class="dt">type =</span> <span class="st">&quot;codes&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Codes Plot&quot;</span>, <span class="dt">palette.name =</span> rainbow)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-13-1-1.png" width="672" /></p>
<p>The plot of training shows that the distance between nodes reached a plateau
after 300 iterations.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="machine-learning.html#cb162-1"></a><span class="kw">plot</span>(iris.model, <span class="dt">type =</span> <span class="st">&quot;changes&quot;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-13-2-1.png" width="672" /></p>
<p>Supervised SOM is now performed with the same iris data.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="machine-learning.html#cb163-1"></a><span class="co">#SOM</span></span>
<span id="cb163-2"><a href="machine-learning.html#cb163-2"></a></span>
<span id="cb163-3"><a href="machine-learning.html#cb163-3"></a><span class="kw">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb163-4"><a href="machine-learning.html#cb163-4"></a>int &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">nrow</span>(iris), <span class="kw">nrow</span>(iris)<span class="op">*</span><span class="fl">0.8</span>)</span>
<span id="cb163-5"><a href="machine-learning.html#cb163-5"></a>train &lt;-<span class="st"> </span>iris[int,]</span>
<span id="cb163-6"><a href="machine-learning.html#cb163-6"></a>test &lt;-<span class="st"> </span>iris[<span class="op">-</span>int,]</span>
<span id="cb163-7"><a href="machine-learning.html#cb163-7"></a></span>
<span id="cb163-8"><a href="machine-learning.html#cb163-8"></a><span class="co"># scaling data</span></span>
<span id="cb163-9"><a href="machine-learning.html#cb163-9"></a>trainX &lt;-<span class="st"> </span><span class="kw">scale</span>(train[,<span class="op">-</span><span class="dv">5</span>])</span>
<span id="cb163-10"><a href="machine-learning.html#cb163-10"></a>testX &lt;-<span class="st"> </span><span class="kw">scale</span>(test[,<span class="op">-</span><span class="dv">5</span>], <span class="dt">center =</span> <span class="kw">attr</span>(trainX, <span class="st">&quot;scaled:center&quot;</span>))</span>
<span id="cb163-11"><a href="machine-learning.html#cb163-11"></a></span>
<span id="cb163-12"><a href="machine-learning.html#cb163-12"></a><span class="co"># make label</span></span>
<span id="cb163-13"><a href="machine-learning.html#cb163-13"></a><span class="co">#iris$species is already of class factor</span></span>
<span id="cb163-14"><a href="machine-learning.html#cb163-14"></a></span>
<span id="cb163-15"><a href="machine-learning.html#cb163-15"></a>train.label &lt;-<span class="st"> </span>train[,<span class="dv">5</span>]</span>
<span id="cb163-16"><a href="machine-learning.html#cb163-16"></a>test.label &lt;-<span class="st"> </span>test[,<span class="dv">5</span>]</span>
<span id="cb163-17"><a href="machine-learning.html#cb163-17"></a>test[,<span class="dv">5</span>] &lt;-<span class="st"> </span><span class="dv">916</span></span>
<span id="cb163-18"><a href="machine-learning.html#cb163-18"></a>testXY &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">independent =</span> testX, <span class="dt">dependent =</span> test.label)</span>
<span id="cb163-19"><a href="machine-learning.html#cb163-19"></a></span>
<span id="cb163-20"><a href="machine-learning.html#cb163-20"></a><span class="co"># make a train data sets that scaled</span></span>
<span id="cb163-21"><a href="machine-learning.html#cb163-21"></a><span class="co"># convert them to be a numeric matrix </span></span>
<span id="cb163-22"><a href="machine-learning.html#cb163-22"></a>iris.train &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">scale</span>(train[,<span class="op">-</span><span class="dv">5</span>]))</span>
<span id="cb163-23"><a href="machine-learning.html#cb163-23"></a></span>
<span id="cb163-24"><a href="machine-learning.html#cb163-24"></a><span class="kw">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb163-25"><a href="machine-learning.html#cb163-25"></a></span>
<span id="cb163-26"><a href="machine-learning.html#cb163-26"></a><span class="co"># grid should be smaller than dim(train) 120 x5</span></span>
<span id="cb163-27"><a href="machine-learning.html#cb163-27"></a><span class="co">#xdim =10 and ydim=10 would be &lt; 120</span></span>
<span id="cb163-28"><a href="machine-learning.html#cb163-28"></a>iris.grid &lt;-<span class="st"> </span><span class="kw">somgrid</span>(<span class="dt">xdim =</span> <span class="dv">10</span>, <span class="dt">ydim =</span> <span class="dv">10</span>, <span class="dt">topo =</span> <span class="st">&quot;hexagonal&quot;</span>)</span>
<span id="cb163-29"><a href="machine-learning.html#cb163-29"></a></span>
<span id="cb163-30"><a href="machine-learning.html#cb163-30"></a><span class="co">#som model</span></span>
<span id="cb163-31"><a href="machine-learning.html#cb163-31"></a>iris.model &lt;-<span class="st"> </span><span class="kw">som</span>(iris.train, iris.grid, <span class="dt">rlen =</span> <span class="dv">500</span>, <span class="dt">radius =</span> <span class="fl">2.5</span>, <span class="dt">keep.data =</span> <span class="ot">TRUE</span>, <span class="dt">dist.fcts =</span> <span class="st">&quot;euclidean&quot;</span>)</span>
<span id="cb163-32"><a href="machine-learning.html#cb163-32"></a></span>
<span id="cb163-33"><a href="machine-learning.html#cb163-33"></a>class &lt;-<span class="st"> </span><span class="kw">xyf</span>(trainX, <span class="kw">classvec2classmat</span>(train.label), iris.grid, <span class="dt">rlen =</span> <span class="dv">500</span>)</span>
<span id="cb163-34"><a href="machine-learning.html#cb163-34"></a></span>
<span id="cb163-35"><a href="machine-learning.html#cb163-35"></a><span class="kw">plot</span>(class, <span class="dt">type =</span> <span class="st">&quot;changes&quot;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-14-1.png" width="672" /></p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="machine-learning.html#cb164-1"></a>pred &lt;-<span class="st"> </span><span class="kw">predict</span>(class, <span class="dt">newdata =</span> testXY)</span>
<span id="cb164-2"><a href="machine-learning.html#cb164-2"></a><span class="kw">table</span>(<span class="dt">Predict =</span> pred<span class="op">$</span>predictions[[<span class="dv">2</span>]], <span class="dt">Actual =</span> test.label)</span></code></pre></div>
<pre><code>##             Actual
## Predict      setosa versicolor virginica
##   setosa          9          0         0
##   versicolor      0          8         0
##   virginica       0          0         7</code></pre>
<p>Determine number of clusters.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="machine-learning.html#cb166-1"></a><span class="kw">library</span>(factoextra)</span></code></pre></div>
<pre><code>## Warning: package &#39;factoextra&#39; was built under R version 4.0.5</code></pre>
<pre><code>## Welcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa</code></pre>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="machine-learning.html#cb169-1"></a><span class="kw">fviz_nbclust</span>(iris.model<span class="op">$</span>codes[[<span class="dv">1</span>]], kmeans, <span class="dt">method =</span> <span class="st">&quot;wss&quot;</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-14-1-1.png" width="672" /></p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="machine-learning.html#cb170-1"></a><span class="kw">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb170-2"><a href="machine-learning.html#cb170-2"></a>clust &lt;-<span class="st"> </span><span class="kw">kmeans</span>(iris.model<span class="op">$</span>codes[[<span class="dv">1</span>]], <span class="dv">6</span>)</span>
<span id="cb170-3"><a href="machine-learning.html#cb170-3"></a><span class="kw">plot</span>(iris.model, <span class="dt">type =</span> <span class="st">&quot;codes&quot;</span>, <span class="dt">bgcol =</span> <span class="kw">rainbow</span>(<span class="dv">9</span>)[clust<span class="op">$</span>cluster], </span>
<span id="cb170-4"><a href="machine-learning.html#cb170-4"></a>     <span class="dt">main =</span> <span class="st">&quot;Cluster SOM&quot;</span>)</span>
<span id="cb170-5"><a href="machine-learning.html#cb170-5"></a><span class="kw">add.cluster.boundaries</span>(iris.model, clust<span class="op">$</span>cluster)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-14-2-1.png" width="672" /></p>
</div>
</div>
<div id="deep-learning" class="section level2">
<h2><span class="header-section-number">6.10</span> Deep learning</h2>
<p>Deep learning is a neural network with many layers: inner, multiple hidden and outer layer. Deep learning methods can be supervised or unsupervised. It uses gradient descent algorithm in search for the solution. One potential issue that
it may be stuck in a local minima rather than the global minima.</p>
<p>There are several R libraries for performing deep learning. It’s worth checking out the installation requirement as some require installing the library in
python and uses the <em>reticulate</em> library to perform analysis. The examples used here are R libraries including <em>RSNNS</em>.</p>
<div id="multiplayer-perceptron" class="section level3">
<h3><span class="header-section-number">6.10.1</span> Multiplayer Perceptron</h3>
<p>Multilayer perceptron is a type of deep learning. . It passes information in one direction from inner to hidden and outer layer and hence is referred to as feed forward artificial neural network. It trains the data using a loss function
which adapt to the parameter and optimise according to the specified learning rate. Overfitting is minimised by using an L2 regularisation penalty, termed alpha.</p>
<p>For tabular data, deep learning may not necessarily be better than other machine learning method. By contrast, deep learning may be better for unstructured data.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="machine-learning.html#cb171-1"></a><span class="kw">library</span>(caret)</span>
<span id="cb171-2"><a href="machine-learning.html#cb171-2"></a><span class="kw">library</span>(RSNNS)</span></code></pre></div>
<pre><code>## Warning: package &#39;RSNNS&#39; was built under R version 4.0.5</code></pre>
<pre><code>## Loading required package: Rcpp</code></pre>
<pre><code>## Warning: package &#39;Rcpp&#39; was built under R version 4.0.5</code></pre>
<pre><code>## 
## Attaching package: &#39;RSNNS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:kohonen&#39;:
## 
##     som</code></pre>
<pre><code>## The following objects are masked from &#39;package:caret&#39;:
## 
##     confusionMatrix, train</code></pre>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="machine-learning.html#cb178-1"></a><span class="kw">data</span>(<span class="st">&quot;BreastCancer&quot;</span>,<span class="dt">package =</span> <span class="st">&quot;mlbench&quot;</span>)</span>
<span id="cb178-2"><a href="machine-learning.html#cb178-2"></a><span class="kw">colnames</span>(BreastCancer)</span></code></pre></div>
<pre><code>##  [1] &quot;Id&quot;              &quot;Cl.thickness&quot;    &quot;Cell.size&quot;       &quot;Cell.shape&quot;     
##  [5] &quot;Marg.adhesion&quot;   &quot;Epith.c.size&quot;    &quot;Bare.nuclei&quot;     &quot;Bl.cromatin&quot;    
##  [9] &quot;Normal.nucleoli&quot; &quot;Mitoses&quot;         &quot;Class&quot;</code></pre>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="machine-learning.html#cb180-1"></a><span class="co">#remove ID column</span></span>
<span id="cb180-2"><a href="machine-learning.html#cb180-2"></a><span class="co">#remove column a=with NA </span></span>
<span id="cb180-3"><a href="machine-learning.html#cb180-3"></a><span class="co">#alternative is to impute</span></span>
<span id="cb180-4"><a href="machine-learning.html#cb180-4"></a>BreastCancer&lt;-BreastCancer[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">7</span>)]<span class="co">#remaining 9 columns</span></span>
<span id="cb180-5"><a href="machine-learning.html#cb180-5"></a></span>
<span id="cb180-6"><a href="machine-learning.html#cb180-6"></a><span class="co">#convert multiple columns to numeric</span></span>
<span id="cb180-7"><a href="machine-learning.html#cb180-7"></a><span class="co">#lapply output a list</span></span>
<span id="cb180-8"><a href="machine-learning.html#cb180-8"></a>BreastCancer2&lt;-<span class="kw">lapply</span>(BreastCancer[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">9</span>)], as.numeric)</span>
<span id="cb180-9"><a href="machine-learning.html#cb180-9"></a>BreastCancer2&lt;-<span class="kw">as.data.frame</span>(BreastCancer2)</span>
<span id="cb180-10"><a href="machine-learning.html#cb180-10"></a>BreastCancer2&lt;-<span class="kw">merge</span>(BreastCancer2, BreastCancer<span class="op">$</span>Class)</span>
<span id="cb180-11"><a href="machine-learning.html#cb180-11"></a></span>
<span id="cb180-12"><a href="machine-learning.html#cb180-12"></a><span class="co">#note Class is benign or malignant of class factor</span></span>
<span id="cb180-13"><a href="machine-learning.html#cb180-13"></a><span class="co">#column Bare.nuclei removed due to NA</span></span>
<span id="cb180-14"><a href="machine-learning.html#cb180-14"></a></span>
<span id="cb180-15"><a href="machine-learning.html#cb180-15"></a><span class="co">#split data</span></span>
<span id="cb180-16"><a href="machine-learning.html#cb180-16"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb180-17"><a href="machine-learning.html#cb180-17"></a></span>
<span id="cb180-18"><a href="machine-learning.html#cb180-18"></a>BreastCancer2Values &lt;-<span class="st"> </span>BreastCancer2[,<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>)]</span>
<span id="cb180-19"><a href="machine-learning.html#cb180-19"></a>BreastCancer2Targets &lt;-<span class="st"> </span><span class="kw">decodeClassLabels</span>(BreastCancer2[,<span class="dv">9</span>])</span>
<span id="cb180-20"><a href="machine-learning.html#cb180-20"></a></span>
<span id="cb180-21"><a href="machine-learning.html#cb180-21"></a><span class="co">#this returns the orginal file as a list</span></span>
<span id="cb180-22"><a href="machine-learning.html#cb180-22"></a>BreastCancer2 &lt;-<span class="st"> </span><span class="kw">splitForTrainingAndTest</span>(BreastCancer2Values, BreastCancer2Targets, <span class="dt">ratio=</span><span class="fl">0.15</span>) <span class="co">#ratio is percentage for test data</span></span>
<span id="cb180-23"><a href="machine-learning.html#cb180-23"></a>BreastCancer2 &lt;-<span class="st"> </span><span class="kw">normTrainingAndTestSet</span>(BreastCancer2) <span class="co">#put out a list object</span></span>
<span id="cb180-24"><a href="machine-learning.html#cb180-24"></a></span>
<span id="cb180-25"><a href="machine-learning.html#cb180-25"></a>model &lt;-<span class="st"> </span><span class="kw">mlp</span>(BreastCancer2<span class="op">$</span>inputsTrain, </span>
<span id="cb180-26"><a href="machine-learning.html#cb180-26"></a>             BreastCancer2<span class="op">$</span>targetsTrain, </span>
<span id="cb180-27"><a href="machine-learning.html#cb180-27"></a>             <span class="dt">size=</span><span class="dv">5</span>, <span class="co">#number of unit in hidden layer </span></span>
<span id="cb180-28"><a href="machine-learning.html#cb180-28"></a>             <span class="dt">learnFuncParams=</span><span class="kw">c</span>(<span class="fl">0.1</span>), </span>
<span id="cb180-29"><a href="machine-learning.html#cb180-29"></a>              <span class="dt">maxit=</span><span class="dv">50</span>, <span class="co">#number of iteration to learn</span></span>
<span id="cb180-30"><a href="machine-learning.html#cb180-30"></a>             <span class="dt">inputsTest=</span>BreastCancer2<span class="op">$</span>inputsTest, <span class="dt">targetsTest=</span>BreastCancer2<span class="op">$</span>targetsTest)</span>
<span id="cb180-31"><a href="machine-learning.html#cb180-31"></a></span>
<span id="cb180-32"><a href="machine-learning.html#cb180-32"></a><span class="kw">summary</span>(model)</span></code></pre></div>
<pre><code>## SNNS network definition file V1.4-3D
## generated at Tue May 09 14:25:38 2023
## 
## network name : RSNNS_untitled
## source files :
## no. of units : 15
## no. of connections : 50
## no. of unit types : 0
## no. of site types : 0
## 
## 
## learning function : Std_Backpropagation
## update function   : Topological_Order
## 
## 
## unit default section :
## 
## act      | bias     | st | subnet | layer | act func     | out func
## ---------|----------|----|--------|-------|--------------|-------------
##  0.00000 |  0.00000 | i  |      0 |     1 | Act_Logistic | Out_Identity 
## ---------|----------|----|--------|-------|--------------|-------------
## 
## 
## unit definition section :
## 
## no. | typeName | unitName         | act      | bias     | st | position | act func     | out func | sites
## ----|----------|------------------|----------|----------|----|----------|--------------|----------|-------
##   1 |          | Input_1          | -0.14849 | -0.12745 | i  | 1,0,0    | Act_Identity |          | 
##   2 |          | Input_2          |  1.59566 |  0.17298 | i  | 2,0,0    | Act_Identity |          | 
##   3 |          | Input_3          |  1.61379 | -0.05461 | i  | 3,0,0    | Act_Identity |          | 
##   4 |          | Input_4          |  0.76866 |  0.22981 | i  | 4,0,0    | Act_Identity |          | 
##   5 |          | Input_5          |  0.35424 |  0.26428 | i  | 5,0,0    | Act_Identity |          | 
##   6 |          | Input_6          |  2.69324 | -0.27267 | i  | 6,0,0    | Act_Identity |          | 
##   7 |          | Input_7          |  0.37127 |  0.01686 | i  | 7,0,0    | Act_Identity |          | 
##   8 |          | Input_8          | -0.35178 |  0.23545 | i  | 8,0,0    | Act_Identity |          | 
##   9 |          | Hidden_2_1       |  0.01505 | -4.19604 | h  | 1,2,0    |||
##  10 |          | Hidden_2_2       |  0.01511 | -4.18367 | h  | 2,2,0    |||
##  11 |          | Hidden_2_3       |  0.01446 | -4.17642 | h  | 3,2,0    |||
##  12 |          | Hidden_2_4       |  0.01596 | -4.17519 | h  | 4,2,0    |||
##  13 |          | Hidden_2_5       |  0.01394 | -4.20952 | h  | 5,2,0    |||
##  14 |          | Output_benign    |  0.71619 |  0.92553 | o  | 1,4,0    |||
##  15 |          | Output_malignant |  0.28380 | -0.92463 | o  | 2,4,0    |||
## ----|----------|------------------|----------|----------|----|----------|--------------|----------|-------
## 
## 
## connection definition section :
## 
## target | site | source:weight
## -------|------|---------------------------------------------------------------------------------------------------------------------
##      9 |      |  8:-0.00576,  7: 0.00727,  6:-0.00682,  5:-0.01802,  4: 0.01969,  3:-0.08010,  2: 0.09268,  1:-0.00830
##     10 |      |  8:-0.00727,  7: 0.02291,  6:-0.00065,  5:-0.01455,  4: 0.01343,  3: 0.07342,  2:-0.07952,  1:-0.00231
##     11 |      |  8:-0.02047,  7: 0.00020,  6:-0.03410,  5: 0.01364,  4: 0.05110,  3:-0.04571,  2: 0.04225,  1:-0.00803
##     12 |      |  8: 0.00616,  7: 0.00433,  6: 0.01932,  5:-0.03026,  4: 0.00085,  3:-0.02034,  2: 0.02802,  1:-0.00241
##     13 |      |  8:-0.01292,  7: 0.00408,  6: 0.00104,  5: 0.00315,  4: 0.04243,  3:-0.07731,  2: 0.02324,  1: 0.03049
##     14 |      | 13: 0.02423, 12:-0.07496, 11:-0.05541, 10: 0.00556,  9: 0.11298
##     15 |      | 13: 0.00930, 12:-0.09087, 11:-0.07273, 10:-0.00928,  9: 0.09645
## -------|------|---------------------------------------------------------------------------------------------------------------------</code></pre>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="machine-learning.html#cb182-1"></a><span class="kw">weightMatrix</span>(model)</span></code></pre></div>
<pre><code>##                  Input_1 Input_2 Input_3 Input_4 Input_5 Input_6 Input_7
## Input_1                0       0       0       0       0       0       0
## Input_2                0       0       0       0       0       0       0
## Input_3                0       0       0       0       0       0       0
## Input_4                0       0       0       0       0       0       0
## Input_5                0       0       0       0       0       0       0
## Input_6                0       0       0       0       0       0       0
## Input_7                0       0       0       0       0       0       0
## Input_8                0       0       0       0       0       0       0
## Hidden_2_1             0       0       0       0       0       0       0
## Hidden_2_2             0       0       0       0       0       0       0
## Hidden_2_3             0       0       0       0       0       0       0
## Hidden_2_4             0       0       0       0       0       0       0
## Hidden_2_5             0       0       0       0       0       0       0
## Output_benign          0       0       0       0       0       0       0
## Output_malignant       0       0       0       0       0       0       0
##                  Input_8   Hidden_2_1    Hidden_2_2    Hidden_2_3    Hidden_2_4
## Input_1                0 -0.008297388 -0.0023071272 -0.0080346595 -0.0024123469
## Input_2                0  0.092682421 -0.0795219317  0.0422476456  0.0280190594
## Input_3                0 -0.080102183  0.0734154806 -0.0457138643 -0.0203440990
## Input_4                0  0.019693121  0.0134251378  0.0511028543  0.0008495782
## Input_5                0 -0.018019579 -0.0145501299  0.0136412643 -0.0302603953
## Input_6                0 -0.006820043 -0.0006510036 -0.0341013148  0.0193179399
## Input_7                0  0.007272426  0.0229080282  0.0001982169  0.0043261107
## Input_8                0 -0.005761668 -0.0072654216 -0.0204697531  0.0061640753
## Hidden_2_1             0  0.000000000  0.0000000000  0.0000000000  0.0000000000
## Hidden_2_2             0  0.000000000  0.0000000000  0.0000000000  0.0000000000
## Hidden_2_3             0  0.000000000  0.0000000000  0.0000000000  0.0000000000
## Hidden_2_4             0  0.000000000  0.0000000000  0.0000000000  0.0000000000
## Hidden_2_5             0  0.000000000  0.0000000000  0.0000000000  0.0000000000
## Output_benign          0  0.000000000  0.0000000000  0.0000000000  0.0000000000
## Output_malignant       0  0.000000000  0.0000000000  0.0000000000  0.0000000000
##                    Hidden_2_5 Output_benign Output_malignant
## Input_1           0.030488236   0.000000000      0.000000000
## Input_2           0.023243070   0.000000000      0.000000000
## Input_3          -0.077309184   0.000000000      0.000000000
## Input_4           0.042426150   0.000000000      0.000000000
## Input_5           0.003149100   0.000000000      0.000000000
## Input_6           0.001040014   0.000000000      0.000000000
## Input_7           0.004078104   0.000000000      0.000000000
## Input_8          -0.012917383   0.000000000      0.000000000
## Hidden_2_1        0.000000000   0.112977110      0.096445039
## Hidden_2_2        0.000000000   0.005557933     -0.009281992
## Hidden_2_3        0.000000000  -0.055408385     -0.072732478
## Hidden_2_4        0.000000000  -0.074956760     -0.090871274
## Hidden_2_5        0.000000000   0.024229093      0.009299588
## Output_benign     0.000000000   0.000000000      0.000000000
## Output_malignant  0.000000000   0.000000000      0.000000000</code></pre>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="machine-learning.html#cb184-1"></a><span class="kw">extractNetInfo</span>(model)</span></code></pre></div>
<pre><code>## $infoHeader
##                 name               value
## 1       no. of units                  15
## 2 no. of connections                  50
## 3  no. of unit types                   0
## 4  no. of site types                   0
## 5  learning function Std_Backpropagation
## 6    update function   Topological_Order
## 
## $unitDefinitions
##    unitNo         unitName     unitAct    unitBias        type posX posY posZ
## 1       1          Input_1 -0.14849401 -0.12745351  UNIT_INPUT    1    0    0
## 2       2          Input_2  1.59566152  0.17298311  UNIT_INPUT    2    0    0
## 3       3          Input_3  1.61378837 -0.05461386  UNIT_INPUT    3    0    0
## 4       4          Input_4  0.76865852  0.22981048  UNIT_INPUT    4    0    0
## 5       5          Input_5  0.35424057  0.26428038  UNIT_INPUT    5    0    0
## 6       6          Input_6  2.69324446 -0.27266610  UNIT_INPUT    6    0    0
## 7       7          Input_7  0.37127367  0.01686329  UNIT_INPUT    7    0    0
## 8       8          Input_8 -0.35178334  0.23545146  UNIT_INPUT    8    0    0
## 9       9       Hidden_2_1  0.01505203 -4.19604301 UNIT_HIDDEN    1    2    0
## 10     10       Hidden_2_2  0.01510857 -4.18367195 UNIT_HIDDEN    2    2    0
## 11     11       Hidden_2_3  0.01445658 -4.17642117 UNIT_HIDDEN    3    2    0
## 12     12       Hidden_2_4  0.01596041 -4.17518997 UNIT_HIDDEN    4    2    0
## 13     13       Hidden_2_5  0.01393753 -4.20952082 UNIT_HIDDEN    5    2    0
## 14     14    Output_benign  0.71619302  0.92553055 UNIT_OUTPUT    1    4    0
## 15     15 Output_malignant  0.28380045 -0.92462683 UNIT_OUTPUT    2    4    0
##         actFunc      outFunc sites
## 1  Act_Identity Out_Identity      
## 2  Act_Identity Out_Identity      
## 3  Act_Identity Out_Identity      
## 4  Act_Identity Out_Identity      
## 5  Act_Identity Out_Identity      
## 6  Act_Identity Out_Identity      
## 7  Act_Identity Out_Identity      
## 8  Act_Identity Out_Identity      
## 9  Act_Logistic Out_Identity      
## 10 Act_Logistic Out_Identity      
## 11 Act_Logistic Out_Identity      
## 12 Act_Logistic Out_Identity      
## 13 Act_Logistic Out_Identity      
## 14 Act_Logistic Out_Identity      
## 15 Act_Logistic Out_Identity      
## 
## $fullWeightMatrix
##                  Input_1 Input_2 Input_3 Input_4 Input_5 Input_6 Input_7
## Input_1                0       0       0       0       0       0       0
## Input_2                0       0       0       0       0       0       0
## Input_3                0       0       0       0       0       0       0
## Input_4                0       0       0       0       0       0       0
## Input_5                0       0       0       0       0       0       0
## Input_6                0       0       0       0       0       0       0
## Input_7                0       0       0       0       0       0       0
## Input_8                0       0       0       0       0       0       0
## Hidden_2_1             0       0       0       0       0       0       0
## Hidden_2_2             0       0       0       0       0       0       0
## Hidden_2_3             0       0       0       0       0       0       0
## Hidden_2_4             0       0       0       0       0       0       0
## Hidden_2_5             0       0       0       0       0       0       0
## Output_benign          0       0       0       0       0       0       0
## Output_malignant       0       0       0       0       0       0       0
##                  Input_8   Hidden_2_1    Hidden_2_2    Hidden_2_3    Hidden_2_4
## Input_1                0 -0.008297388 -0.0023071272 -0.0080346595 -0.0024123469
## Input_2                0  0.092682421 -0.0795219317  0.0422476456  0.0280190594
## Input_3                0 -0.080102183  0.0734154806 -0.0457138643 -0.0203440990
## Input_4                0  0.019693121  0.0134251378  0.0511028543  0.0008495782
## Input_5                0 -0.018019579 -0.0145501299  0.0136412643 -0.0302603953
## Input_6                0 -0.006820043 -0.0006510036 -0.0341013148  0.0193179399
## Input_7                0  0.007272426  0.0229080282  0.0001982169  0.0043261107
## Input_8                0 -0.005761668 -0.0072654216 -0.0204697531  0.0061640753
## Hidden_2_1             0  0.000000000  0.0000000000  0.0000000000  0.0000000000
## Hidden_2_2             0  0.000000000  0.0000000000  0.0000000000  0.0000000000
## Hidden_2_3             0  0.000000000  0.0000000000  0.0000000000  0.0000000000
## Hidden_2_4             0  0.000000000  0.0000000000  0.0000000000  0.0000000000
## Hidden_2_5             0  0.000000000  0.0000000000  0.0000000000  0.0000000000
## Output_benign          0  0.000000000  0.0000000000  0.0000000000  0.0000000000
## Output_malignant       0  0.000000000  0.0000000000  0.0000000000  0.0000000000
##                    Hidden_2_5 Output_benign Output_malignant
## Input_1           0.030488236   0.000000000      0.000000000
## Input_2           0.023243070   0.000000000      0.000000000
## Input_3          -0.077309184   0.000000000      0.000000000
## Input_4           0.042426150   0.000000000      0.000000000
## Input_5           0.003149100   0.000000000      0.000000000
## Input_6           0.001040014   0.000000000      0.000000000
## Input_7           0.004078104   0.000000000      0.000000000
## Input_8          -0.012917383   0.000000000      0.000000000
## Hidden_2_1        0.000000000   0.112977110      0.096445039
## Hidden_2_2        0.000000000   0.005557933     -0.009281992
## Hidden_2_3        0.000000000  -0.055408385     -0.072732478
## Hidden_2_4        0.000000000  -0.074956760     -0.090871274
## Hidden_2_5        0.000000000   0.024229093      0.009299588
## Output_benign     0.000000000   0.000000000      0.000000000
## Output_malignant  0.000000000   0.000000000      0.000000000</code></pre>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="machine-learning.html#cb186-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb186-2"><a href="machine-learning.html#cb186-2"></a><span class="kw">plotIterativeError</span>(model)</span>
<span id="cb186-3"><a href="machine-learning.html#cb186-3"></a></span>
<span id="cb186-4"><a href="machine-learning.html#cb186-4"></a>predictions &lt;-<span class="st"> </span><span class="kw">predict</span>(model,BreastCancer2<span class="op">$</span>inputsTest)</span>
<span id="cb186-5"><a href="machine-learning.html#cb186-5"></a></span>
<span id="cb186-6"><a href="machine-learning.html#cb186-6"></a><span class="kw">plotRegressionError</span>(predictions[,<span class="dv">2</span>], BreastCancer2<span class="op">$</span>targetsTest[,<span class="dv">2</span>])</span>
<span id="cb186-7"><a href="machine-learning.html#cb186-7"></a></span>
<span id="cb186-8"><a href="machine-learning.html#cb186-8"></a><span class="kw">confusionMatrix</span>(BreastCancer2<span class="op">$</span>targetsTrain,<span class="kw">fitted.values</span>(model))</span></code></pre></div>
<pre><code>##        predictions
## targets      1
##       1 262125
##       2 153185</code></pre>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="machine-learning.html#cb188-1"></a><span class="kw">confusionMatrix</span>(BreastCancer2<span class="op">$</span>targetsTest,predictions)</span></code></pre></div>
<pre><code>##        predictions
## targets     1
##       1 58017
##       2 15274</code></pre>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="machine-learning.html#cb190-1"></a><span class="kw">plotROC</span>(<span class="kw">fitted.values</span>(model)[,<span class="dv">2</span>], BreastCancer2<span class="op">$</span>targetsTrain[,<span class="dv">2</span>])</span>
<span id="cb190-2"><a href="machine-learning.html#cb190-2"></a><span class="kw">plotROC</span>(predictions[,<span class="dv">2</span>], BreastCancer2<span class="op">$</span>targetsTest[,<span class="dv">2</span>])</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/05-machinelearning-15-1.png" width="672" /></p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="machine-learning.html#cb191-1"></a>probs &lt;-<span class="st"> </span>predictions <span class="op">/</span><span class="st"> </span><span class="kw">rowSums</span>(predictions)</span>
<span id="cb191-2"><a href="machine-learning.html#cb191-2"></a></span>
<span id="cb191-3"><a href="machine-learning.html#cb191-3"></a><span class="co">#confusion matrix with 402040-method</span></span>
<span id="cb191-4"><a href="machine-learning.html#cb191-4"></a><span class="kw">confusionMatrix</span>(BreastCancer2<span class="op">$</span>targetsTrain, <span class="kw">encodeClassLabels</span>(<span class="kw">fitted.values</span>(model),                                                      <span class="dt">method=</span><span class="st">&quot;402040&quot;</span>, <span class="dt">l=</span><span class="fl">0.4</span>, <span class="dt">h=</span><span class="fl">0.6</span>))</span></code></pre></div>
<pre><code>##        predictions
## targets      1
##       1 262125
##       2 153185</code></pre>
</div>
<div id="cnn" class="section level3">
<h3><span class="header-section-number">6.10.2</span> CNN</h3>
<p>Convolution neural network or CNN is an artifical neural network method that is well suited to classification of image data. CNN is able to develop an internal representation of the image.</p>
</div>
<div id="rnn" class="section level3">
<h3><span class="header-section-number">6.10.3</span> RNN</h3>
<p>Recurrent neural network or RNN is an artifical neural network method that is
well suited to data with repeated patterns such as natural language processing. However, this architecture is less suited for tabular or imaging data.</p>
</div>
<div id="reinforcement-learning" class="section level3">
<h3><span class="header-section-number">6.10.4</span> Reinforcement learning</h3>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-10.21105/joss.00786">
<p>Molnar, Christoph, Bernd Bischl, and Giuseppe Casalicchio. 2018. “Iml: An R Package for Interpretable Machine Learning.” <em>JOSS</em> 3 (26): 786. <a href="https://doi.org/10.21105/joss.00786">https://doi.org/10.21105/joss.00786</a>.</p>
</div>
<div id="ref-pmid29559951">
<p>Phan, T. G., J. Chen, S. Singhal, H. Ma, B. B. Clissold, J. Ly, and R. Beare. 2018. “Exploratory Use of Decision Tree Analysis in Classification of Outcome in Hypoxic-Ischemic Brain Injury.” <em>Front Neurol</em> 9: 126.</p>
</div>
<div id="ref-pmid30761063">
<p>Phan, T. G., T. Kooblal, C. Matley, S. Singhal, B. Clissold, J. Ly, A. G. Thrift, V. Srikanth, and H. Ma. 2019. “Stroke Severity Versus Dysphagia Screen as Driver for Post-stroke Pneumonia.” <em>Front Neurol</em> 10: 16.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multivariate-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="machine-learning-part-2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/05-machinelearning.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Applications-of-R-in-Healthcare.pdf", "Applications-of-R-in-Healthcare.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
