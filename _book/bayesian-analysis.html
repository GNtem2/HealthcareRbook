<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Bayesian Analysis | Applications of R in Healthcare</title>
  <meta name="description" content="This is a book describing the use of R in Healthcare. It is aimed at beginners of R language. The majority of the examples are taken from works in Neurology. Where possible data from other disease such as heart disease, cancer and vaccine are used. The ideas and principles can be applied to other aspects of Healthcare. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Bayesian Analysis | Applications of R in Healthcare" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a book describing the use of R in Healthcare. It is aimed at beginners of R language. The majority of the examples are taken from works in Neurology. Where possible data from other disease such as heart disease, cancer and vaccine are used. The ideas and principles can be applied to other aspects of Healthcare. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="GNtem2/HealthcareRbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Bayesian Analysis | Applications of R in Healthcare" />
  
  <meta name="twitter:description" content="This is a book describing the use of R in Healthcare. It is aimed at beginners of R language. The majority of the examples are taken from works in Neurology. Where possible data from other disease such as heart disease, cancer and vaccine are used. The ideas and principles can be applied to other aspects of Healthcare. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Thanh Phan" />


<meta name="date" content="2024-02-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="machine-learning-part-2.html"/>
<link rel="next" href="operational-research.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applications-of-R-in-Healthcare</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preamble</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#plot-using-base-r"><i class="fa fa-check"></i><b>2.1</b> Plot using base R</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#ggplot2"><i class="fa fa-check"></i><b>2.2</b> ggplot2</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#histogram"><i class="fa fa-check"></i><b>2.2.1</b> Histogram</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#bar-plot"><i class="fa fa-check"></i><b>2.2.2</b> Bar plot</a></li>
<li class="chapter" data-level="2.2.3" data-path="intro.html"><a href="intro.html#pie-chart"><i class="fa fa-check"></i><b>2.2.3</b> Pie chart</a></li>
<li class="chapter" data-level="2.2.4" data-path="intro.html"><a href="intro.html#scatter-plot"><i class="fa fa-check"></i><b>2.2.4</b> Scatter plot</a></li>
<li class="chapter" data-level="2.2.5" data-path="intro.html"><a href="intro.html#arrange-plot-in-grids"><i class="fa fa-check"></i><b>2.2.5</b> arrange plot in grids</a></li>
<li class="chapter" data-level="2.2.6" data-path="intro.html"><a href="intro.html#line-plot"><i class="fa fa-check"></i><b>2.2.6</b> Line plot</a></li>
<li class="chapter" data-level="2.2.7" data-path="intro.html"><a href="intro.html#facet-wrap"><i class="fa fa-check"></i><b>2.2.7</b> Facet wrap</a></li>
<li class="chapter" data-level="2.2.8" data-path="intro.html"><a href="intro.html#polygons"><i class="fa fa-check"></i><b>2.2.8</b> Polygons</a></li>
<li class="chapter" data-level="2.2.9" data-path="intro.html"><a href="intro.html#gantt-chart"><i class="fa fa-check"></i><b>2.2.9</b> Gantt chart</a></li>
<li class="chapter" data-level="2.2.10" data-path="intro.html"><a href="intro.html#heatmap"><i class="fa fa-check"></i><b>2.2.10</b> Heatmap</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#ggplot2-extra"><i class="fa fa-check"></i><b>2.3</b> ggplot2 extra</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#alluvial-and-sankey-diagram"><i class="fa fa-check"></i><b>2.3.1</b> Alluvial and Sankey diagram</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro.html"><a href="intro.html#survival-plot"><i class="fa fa-check"></i><b>2.3.2</b> Survival plot</a></li>
<li class="chapter" data-level="2.3.3" data-path="intro.html"><a href="intro.html#ggraph-and-tidygraph"><i class="fa fa-check"></i><b>2.3.3</b> ggraph and tidygraph</a></li>
<li class="chapter" data-level="2.3.4" data-path="intro.html"><a href="intro.html#ggparty-decision-tree"><i class="fa fa-check"></i><b>2.3.4</b> ggparty-decision tree</a></li>
<li class="chapter" data-level="2.3.5" data-path="intro.html"><a href="intro.html#map"><i class="fa fa-check"></i><b>2.3.5</b> Map</a></li>
<li class="chapter" data-level="2.3.6" data-path="intro.html"><a href="intro.html#ggwordcloud"><i class="fa fa-check"></i><b>2.3.6</b> ggwordcloud</a></li>
<li class="chapter" data-level="2.3.7" data-path="intro.html"><a href="intro.html#gganimate"><i class="fa fa-check"></i><b>2.3.7</b> gganimate</a></li>
<li class="chapter" data-level="2.3.8" data-path="intro.html"><a href="intro.html#ggneuro"><i class="fa fa-check"></i><b>2.3.8</b> ggneuro</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#plotly"><i class="fa fa-check"></i><b>2.4</b> plotly</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="intro.html"><a href="intro.html#scatter-plot-with-plotly"><i class="fa fa-check"></i><b>2.4.1</b> Scatter plot with plotly</a></li>
<li class="chapter" data-level="2.4.2" data-path="intro.html"><a href="intro.html#bar-plot-with-plotly"><i class="fa fa-check"></i><b>2.4.2</b> Bar plot with plotly</a></li>
<li class="chapter" data-level="2.4.3" data-path="intro.html"><a href="intro.html#heatmap-1"><i class="fa fa-check"></i><b>2.4.3</b> Heatmap</a></li>
<li class="chapter" data-level="2.4.4" data-path="intro.html"><a href="intro.html#map-1"><i class="fa fa-check"></i><b>2.4.4</b> map</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>3</b> Data Wrangling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-wrangling.html"><a href="data-wrangling.html#data"><i class="fa fa-check"></i><b>3.1</b> Data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="data-wrangling.html"><a href="data-wrangling.html#vector-arrays-matrix"><i class="fa fa-check"></i><b>3.1.1</b> Vector, Arrays, Matrix</a></li>
<li class="chapter" data-level="3.1.2" data-path="data-wrangling.html"><a href="data-wrangling.html#operators"><i class="fa fa-check"></i><b>3.1.2</b> Operators</a></li>
<li class="chapter" data-level="3.1.3" data-path="data-wrangling.html"><a href="data-wrangling.html#simple-function"><i class="fa fa-check"></i><b>3.1.3</b> Simple function</a></li>
<li class="chapter" data-level="3.1.4" data-path="data-wrangling.html"><a href="data-wrangling.html#for-loop"><i class="fa fa-check"></i><b>3.1.4</b> for loop</a></li>
<li class="chapter" data-level="3.1.5" data-path="data-wrangling.html"><a href="data-wrangling.html#apply-lapply-sapply"><i class="fa fa-check"></i><b>3.1.5</b> apply, lapply, sapply</a></li>
<li class="chapter" data-level="3.1.6" data-path="data-wrangling.html"><a href="data-wrangling.html#functional"><i class="fa fa-check"></i><b>3.1.6</b> Functional</a></li>
<li class="chapter" data-level="3.1.7" data-path="data-wrangling.html"><a href="data-wrangling.html#iteration"><i class="fa fa-check"></i><b>3.1.7</b> Iteration</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-wrangling.html"><a href="data-wrangling.html#data-storage"><i class="fa fa-check"></i><b>3.2</b> Data storage</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-wrangling.html"><a href="data-wrangling.html#data-frame"><i class="fa fa-check"></i><b>3.2.1</b> Data frame</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-wrangling.html"><a href="data-wrangling.html#excel-data"><i class="fa fa-check"></i><b>3.2.2</b> Excel data</a></li>
<li class="chapter" data-level="3.2.3" data-path="data-wrangling.html"><a href="data-wrangling.html#foreign-data"><i class="fa fa-check"></i><b>3.2.3</b> Foreign data</a></li>
<li class="chapter" data-level="3.2.4" data-path="data-wrangling.html"><a href="data-wrangling.html#json-format"><i class="fa fa-check"></i><b>3.2.4</b> json format</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-wrangling.html"><a href="data-wrangling.html#tidy-data"><i class="fa fa-check"></i><b>3.3</b> Tidy data</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-wrangling.html"><a href="data-wrangling.html#factors"><i class="fa fa-check"></i><b>3.3.1</b> Factors</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-wrangling.html"><a href="data-wrangling.html#multiple-files"><i class="fa fa-check"></i><b>3.3.2</b> Multiple files</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-wrangling.html"><a href="data-wrangling.html#tidy-evaluation"><i class="fa fa-check"></i><b>3.3.3</b> Tidy evaluation</a></li>
<li class="chapter" data-level="3.3.4" data-path="data-wrangling.html"><a href="data-wrangling.html#pivot-wide-and-long"><i class="fa fa-check"></i><b>3.3.4</b> Pivot wide and long</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-wrangling.html"><a href="data-wrangling.html#regular-expressions"><i class="fa fa-check"></i><b>3.4</b> Regular Expressions</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="data-wrangling.html"><a href="data-wrangling.html#base-r"><i class="fa fa-check"></i><b>3.4.1</b> base R</a></li>
<li class="chapter" data-level="3.4.2" data-path="data-wrangling.html"><a href="data-wrangling.html#stringr"><i class="fa fa-check"></i><b>3.4.2</b> stringr</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="data-wrangling.html"><a href="data-wrangling.html#pdf-to-xcel"><i class="fa fa-check"></i><b>3.5</b> PDF to xcel</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="data-wrangling.html"><a href="data-wrangling.html#scanned-text-or-picture"><i class="fa fa-check"></i><b>3.5.1</b> Scanned text or picture</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="data-wrangling.html"><a href="data-wrangling.html#web-scraping"><i class="fa fa-check"></i><b>3.6</b> Web scraping</a></li>
<li class="chapter" data-level="3.7" data-path="data-wrangling.html"><a href="data-wrangling.html#medical-images"><i class="fa fa-check"></i><b>3.7</b> Medical Images</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="data-wrangling.html"><a href="data-wrangling.html#dicom-and-nifti-format"><i class="fa fa-check"></i><b>3.7.1</b> DICOM and nifti format</a></li>
<li class="chapter" data-level="3.7.2" data-path="data-wrangling.html"><a href="data-wrangling.html#manipulating-array-of-medical-images"><i class="fa fa-check"></i><b>3.7.2</b> Manipulating array of medical images</a></li>
<li class="chapter" data-level="3.7.3" data-path="data-wrangling.html"><a href="data-wrangling.html#combining-arrays"><i class="fa fa-check"></i><b>3.7.3</b> Combining arrays</a></li>
<li class="chapter" data-level="3.7.4" data-path="data-wrangling.html"><a href="data-wrangling.html#math-operation-on-multidimensional-array"><i class="fa fa-check"></i><b>3.7.4</b> Math operation on multidimensional array</a></li>
<li class="chapter" data-level="3.7.5" data-path="data-wrangling.html"><a href="data-wrangling.html#math-operation-on-list"><i class="fa fa-check"></i><b>3.7.5</b> Math operation on list</a></li>
<li class="chapter" data-level="3.7.6" data-path="data-wrangling.html"><a href="data-wrangling.html#vectorising-nifti-object"><i class="fa fa-check"></i><b>3.7.6</b> Vectorising nifti object</a></li>
<li class="chapter" data-level="3.7.7" data-path="data-wrangling.html"><a href="data-wrangling.html#tar-file"><i class="fa fa-check"></i><b>3.7.7</b> tar file</a></li>
<li class="chapter" data-level="3.7.8" data-path="data-wrangling.html"><a href="data-wrangling.html#image-registration"><i class="fa fa-check"></i><b>3.7.8</b> Image registration</a></li>
<li class="chapter" data-level="3.7.9" data-path="data-wrangling.html"><a href="data-wrangling.html#rescaling"><i class="fa fa-check"></i><b>3.7.9</b> Rescaling</a></li>
<li class="chapter" data-level="3.7.10" data-path="data-wrangling.html"><a href="data-wrangling.html#mni-template"><i class="fa fa-check"></i><b>3.7.10</b> MNI template</a></li>
<li class="chapter" data-level="3.7.11" data-path="data-wrangling.html"><a href="data-wrangling.html#atlases"><i class="fa fa-check"></i><b>3.7.11</b> Atlases</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="data-wrangling.html"><a href="data-wrangling.html#ecg-signal-processing"><i class="fa fa-check"></i><b>3.8</b> ECG Signal processing</a></li>
<li class="chapter" data-level="3.9" data-path="data-wrangling.html"><a href="data-wrangling.html#eeg-signal-processing"><i class="fa fa-check"></i><b>3.9</b> EEG signal processing</a></li>
<li class="chapter" data-level="3.10" data-path="data-wrangling.html"><a href="data-wrangling.html#python"><i class="fa fa-check"></i><b>3.10</b> Python</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="data-wrangling.html"><a href="data-wrangling.html#reticulate"><i class="fa fa-check"></i><b>3.10.1</b> Reticulate</a></li>
<li class="chapter" data-level="3.10.2" data-path="data-wrangling.html"><a href="data-wrangling.html#minconda"><i class="fa fa-check"></i><b>3.10.2</b> Minconda</a></li>
<li class="chapter" data-level="3.10.3" data-path="data-wrangling.html"><a href="data-wrangling.html#python-environment"><i class="fa fa-check"></i><b>3.10.3</b> Python environment</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="data-wrangling.html"><a href="data-wrangling.html#matlab"><i class="fa fa-check"></i><b>3.11</b> Matlab</a></li>
<li class="chapter" data-level="3.12" data-path="data-wrangling.html"><a href="data-wrangling.html#stata"><i class="fa fa-check"></i><b>3.12</b> Stata</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>4</b> Statistics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="statistics.html"><a href="statistics.html#univariable-analyses"><i class="fa fa-check"></i><b>4.1</b> Univariable analyses</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="statistics.html"><a href="statistics.html#parametric-tests"><i class="fa fa-check"></i><b>4.1.1</b> Parametric tests</a></li>
<li class="chapter" data-level="4.1.2" data-path="statistics.html"><a href="statistics.html#non-parametric-tests"><i class="fa fa-check"></i><b>4.1.2</b> Non-parametric tests</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="statistics.html"><a href="statistics.html#regression"><i class="fa fa-check"></i><b>4.2</b> Regression</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="statistics.html"><a href="statistics.html#brief-review-of-matrix"><i class="fa fa-check"></i><b>4.2.1</b> Brief review of matrix</a></li>
<li class="chapter" data-level="4.2.2" data-path="statistics.html"><a href="statistics.html#linear-least-square-regression"><i class="fa fa-check"></i><b>4.2.2</b> Linear (least square) regression</a></li>
<li class="chapter" data-level="4.2.3" data-path="statistics.html"><a href="statistics.html#logistic-regression"><i class="fa fa-check"></i><b>4.2.3</b> Logistic regression</a></li>
<li class="chapter" data-level="4.2.4" data-path="statistics.html"><a href="statistics.html#discrimination-and-calibration"><i class="fa fa-check"></i><b>4.2.4</b> Discrimination and Calibration</a></li>
<li class="chapter" data-level="4.2.5" data-path="statistics.html"><a href="statistics.html#interaction"><i class="fa fa-check"></i><b>4.2.5</b> Interaction</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="statistics.html"><a href="statistics.html#confounder"><i class="fa fa-check"></i><b>4.3</b> Confounder</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="statistics.html"><a href="statistics.html#confounder-weighted-model"><i class="fa fa-check"></i><b>4.3.1</b> Confounder weighted model</a></li>
<li class="chapter" data-level="4.3.2" data-path="statistics.html"><a href="statistics.html#propensity-matching"><i class="fa fa-check"></i><b>4.3.2</b> Propensity matching</a></li>
<li class="chapter" data-level="4.3.3" data-path="statistics.html"><a href="statistics.html#e-values"><i class="fa fa-check"></i><b>4.3.3</b> E-values</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="statistics.html"><a href="statistics.html#causal-inference"><i class="fa fa-check"></i><b>4.4</b> Causal inference</a></li>
<li class="chapter" data-level="4.5" data-path="statistics.html"><a href="statistics.html#special-types-of-regression"><i class="fa fa-check"></i><b>4.5</b> Special types of regression</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="statistics.html"><a href="statistics.html#ordinal-regression"><i class="fa fa-check"></i><b>4.5.1</b> Ordinal regression</a></li>
<li class="chapter" data-level="4.5.2" data-path="statistics.html"><a href="statistics.html#survival-analysis"><i class="fa fa-check"></i><b>4.5.2</b> Survival analysis</a></li>
<li class="chapter" data-level="4.5.3" data-path="statistics.html"><a href="statistics.html#quantile-regression"><i class="fa fa-check"></i><b>4.5.3</b> Quantile regression</a></li>
<li class="chapter" data-level="4.5.4" data-path="statistics.html"><a href="statistics.html#non-negative-regression"><i class="fa fa-check"></i><b>4.5.4</b> Non-negative regression</a></li>
<li class="chapter" data-level="4.5.5" data-path="statistics.html"><a href="statistics.html#poisson-regression"><i class="fa fa-check"></i><b>4.5.5</b> Poisson regression</a></li>
<li class="chapter" data-level="4.5.6" data-path="statistics.html"><a href="statistics.html#conditional-logistic-regression"><i class="fa fa-check"></i><b>4.5.6</b> Conditional logistic regression</a></li>
<li class="chapter" data-level="4.5.7" data-path="statistics.html"><a href="statistics.html#multinomial-modelling"><i class="fa fa-check"></i><b>4.5.7</b> Multinomial modelling</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="statistics.html"><a href="statistics.html#sample-size-estimation"><i class="fa fa-check"></i><b>4.6</b> Sample size estimation</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="statistics.html"><a href="statistics.html#proportion"><i class="fa fa-check"></i><b>4.6.1</b> Proportion</a></li>
<li class="chapter" data-level="4.6.2" data-path="statistics.html"><a href="statistics.html#logistic-regression-1"><i class="fa fa-check"></i><b>4.6.2</b> Logistic regression</a></li>
<li class="chapter" data-level="4.6.3" data-path="statistics.html"><a href="statistics.html#survival-studies"><i class="fa fa-check"></i><b>4.6.3</b> Survival studies</a></li>
<li class="chapter" data-level="4.6.4" data-path="statistics.html"><a href="statistics.html#multiple-regression"><i class="fa fa-check"></i><b>4.6.4</b> Multiple regression</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="statistics.html"><a href="statistics.html#randomised-clinical-trials"><i class="fa fa-check"></i><b>4.7</b> Randomised clinical trials</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="statistics.html"><a href="statistics.html#covariate-adjustment-in-trials"><i class="fa fa-check"></i><b>4.7.1</b> Covariate adjustment in trials</a></li>
<li class="chapter" data-level="4.7.2" data-path="statistics.html"><a href="statistics.html#subgroup-analysis"><i class="fa fa-check"></i><b>4.7.2</b> Subgroup analysis</a></li>
<li class="chapter" data-level="4.7.3" data-path="statistics.html"><a href="statistics.html#p-value-for-interaction"><i class="fa fa-check"></i><b>4.7.3</b> p value for interaction</a></li>
<li class="chapter" data-level="4.7.4" data-path="statistics.html"><a href="statistics.html#interpreting-risk-reduction-in-clinical-trials"><i class="fa fa-check"></i><b>4.7.4</b> Interpreting risk reduction in clinical trials</a></li>
<li class="chapter" data-level="4.7.5" data-path="statistics.html"><a href="statistics.html#nnt-from-arr"><i class="fa fa-check"></i><b>4.7.5</b> NNT from ARR</a></li>
<li class="chapter" data-level="4.7.6" data-path="statistics.html"><a href="statistics.html#nnt-from-odds-ratio"><i class="fa fa-check"></i><b>4.7.6</b> NNT from odds ratio</a></li>
<li class="chapter" data-level="4.7.7" data-path="statistics.html"><a href="statistics.html#nnt-from-risk-ratio"><i class="fa fa-check"></i><b>4.7.7</b> NNT from risk ratio</a></li>
<li class="chapter" data-level="4.7.8" data-path="statistics.html"><a href="statistics.html#nnt-from-hazard-ratio"><i class="fa fa-check"></i><b>4.7.8</b> NNT from hazard ratio</a></li>
<li class="chapter" data-level="4.7.9" data-path="statistics.html"><a href="statistics.html#nnt-from-metaananlysis"><i class="fa fa-check"></i><b>4.7.9</b> NNT from metaananlysis</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="statistics.html"><a href="statistics.html#diagnostic-test"><i class="fa fa-check"></i><b>4.8</b> Diagnostic test</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="statistics.html"><a href="statistics.html#sensitivity-specificity"><i class="fa fa-check"></i><b>4.8.1</b> Sensitivity, specificity</a></li>
<li class="chapter" data-level="4.8.2" data-path="statistics.html"><a href="statistics.html#auc"><i class="fa fa-check"></i><b>4.8.2</b> AUC</a></li>
<li class="chapter" data-level="4.8.3" data-path="statistics.html"><a href="statistics.html#likelihood-ratio"><i class="fa fa-check"></i><b>4.8.3</b> Likelihood ratio</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="statistics.html"><a href="statistics.html#metaanalysis"><i class="fa fa-check"></i><b>4.9</b> Metaanalysis</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="statistics.html"><a href="statistics.html#quality-of-study"><i class="fa fa-check"></i><b>4.9.1</b> Quality of study</a></li>
<li class="chapter" data-level="4.9.2" data-path="statistics.html"><a href="statistics.html#prisma"><i class="fa fa-check"></i><b>4.9.2</b> PRISMA</a></li>
<li class="chapter" data-level="4.9.3" data-path="statistics.html"><a href="statistics.html#conversion-of-median-to-mean"><i class="fa fa-check"></i><b>4.9.3</b> Conversion of median to mean</a></li>
<li class="chapter" data-level="4.9.4" data-path="statistics.html"><a href="statistics.html#inconsistency-i2"><i class="fa fa-check"></i><b>4.9.4</b> Inconsistency I2</a></li>
<li class="chapter" data-level="4.9.5" data-path="statistics.html"><a href="statistics.html#metaanalysis-of-proportion"><i class="fa fa-check"></i><b>4.9.5</b> Metaanalysis of proportion</a></li>
<li class="chapter" data-level="4.9.6" data-path="statistics.html"><a href="statistics.html#metaanalysis-of-continuous-data"><i class="fa fa-check"></i><b>4.9.6</b> Metaanalysis of continuous data</a></li>
<li class="chapter" data-level="4.9.7" data-path="statistics.html"><a href="statistics.html#bivariate-metaanalysis"><i class="fa fa-check"></i><b>4.9.7</b> Bivariate Metaanalysis</a></li>
<li class="chapter" data-level="4.9.8" data-path="statistics.html"><a href="statistics.html#metaanalysis-of-clinical-trial."><i class="fa fa-check"></i><b>4.9.8</b> Metaanalysis of clinical trial.</a></li>
<li class="chapter" data-level="4.9.9" data-path="statistics.html"><a href="statistics.html#metaregression"><i class="fa fa-check"></i><b>4.9.9</b> Metaregression</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="statistics.html"><a href="statistics.html#data-simulation"><i class="fa fa-check"></i><b>4.10</b> Data simulation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html"><i class="fa fa-check"></i><b>5</b> Multivariate Analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#multivariate-regression"><i class="fa fa-check"></i><b>5.1</b> Multivariate regression</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#penalised-regression"><i class="fa fa-check"></i><b>5.1.1</b> Penalised regression</a></li>
<li class="chapter" data-level="5.1.2" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#mars"><i class="fa fa-check"></i><b>5.1.2</b> MARS</a></li>
<li class="chapter" data-level="5.1.3" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#mixed-modelling"><i class="fa fa-check"></i><b>5.1.3</b> Mixed modelling</a></li>
<li class="chapter" data-level="5.1.4" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#trajectory-modelling"><i class="fa fa-check"></i><b>5.1.4</b> Trajectory modelling</a></li>
<li class="chapter" data-level="5.1.5" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#generalized-estimating-equation-gee"><i class="fa fa-check"></i><b>5.1.5</b> Generalized estimating equation (GEE)</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#principal-component-analysis"><i class="fa fa-check"></i><b>5.2</b> Principal component analysis</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#pca-with-mri"><i class="fa fa-check"></i><b>5.2.1</b> PCA with MRI</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#independent-component-analysis"><i class="fa fa-check"></i><b>5.3</b> Independent component analysis</a></li>
<li class="chapter" data-level="5.4" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#partial-least-squares"><i class="fa fa-check"></i><b>5.4</b> Partial least squares</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="machine-learning.html"><a href="machine-learning.html"><i class="fa fa-check"></i><b>6</b> Machine learning</a>
<ul>
<li class="chapter" data-level="6.1" data-path="machine-learning.html"><a href="machine-learning.html#decision-tree-analysis"><i class="fa fa-check"></i><b>6.1</b> Decision tree analysis</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="machine-learning.html"><a href="machine-learning.html#information-theory-driven"><i class="fa fa-check"></i><b>6.1.1</b> Information theory driven</a></li>
<li class="chapter" data-level="6.1.2" data-path="machine-learning.html"><a href="machine-learning.html#conditional-decision-tree"><i class="fa fa-check"></i><b>6.1.2</b> Conditional decision tree</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="machine-learning.html"><a href="machine-learning.html#ensemble-tree-methods"><i class="fa fa-check"></i><b>6.2</b> Ensemble tree methods</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="machine-learning.html"><a href="machine-learning.html#bagging-trees"><i class="fa fa-check"></i><b>6.2.1</b> Bagging trees</a></li>
<li class="chapter" data-level="6.2.2" data-path="machine-learning.html"><a href="machine-learning.html#boosting-trees"><i class="fa fa-check"></i><b>6.2.2</b> Boosting trees</a></li>
<li class="chapter" data-level="6.2.3" data-path="machine-learning.html"><a href="machine-learning.html#bayesian-trees-method"><i class="fa fa-check"></i><b>6.2.3</b> Bayesian trees method</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="machine-learning.html"><a href="machine-learning.html#knn"><i class="fa fa-check"></i><b>6.3</b> KNN</a></li>
<li class="chapter" data-level="6.4" data-path="machine-learning.html"><a href="machine-learning.html#support-vector-machine"><i class="fa fa-check"></i><b>6.4</b> Support vector machine</a></li>
<li class="chapter" data-level="6.5" data-path="machine-learning.html"><a href="machine-learning.html#non-negative-matrix-factorisation"><i class="fa fa-check"></i><b>6.5</b> Non-negative matrix factorisation</a></li>
<li class="chapter" data-level="6.6" data-path="machine-learning.html"><a href="machine-learning.html#formal-concept-analysis"><i class="fa fa-check"></i><b>6.6</b> Formal concept analysis</a></li>
<li class="chapter" data-level="6.7" data-path="machine-learning.html"><a href="machine-learning.html#evolutionary-algorithm"><i class="fa fa-check"></i><b>6.7</b> Evolutionary Algorithm</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="machine-learning.html"><a href="machine-learning.html#simulated-annealing"><i class="fa fa-check"></i><b>6.7.1</b> Simulated Annealing</a></li>
<li class="chapter" data-level="6.7.2" data-path="machine-learning.html"><a href="machine-learning.html#genetic-algorithm"><i class="fa fa-check"></i><b>6.7.2</b> Genetic Algorithm</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="machine-learning.html"><a href="machine-learning.html#manifold-learning"><i class="fa fa-check"></i><b>6.8</b> Manifold learning</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="machine-learning.html"><a href="machine-learning.html#t-stochastic-neighbourhood-embedding"><i class="fa fa-check"></i><b>6.8.1</b> T-Stochastic Neighbourhood Embedding</a></li>
<li class="chapter" data-level="6.8.2" data-path="machine-learning.html"><a href="machine-learning.html#self-organising-map"><i class="fa fa-check"></i><b>6.8.2</b> Self organising map</a></li>
<li class="chapter" data-level="6.8.3" data-path="machine-learning.html"><a href="machine-learning.html#multidimensional-scaling"><i class="fa fa-check"></i><b>6.8.3</b> Multidimensional scaling</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="machine-learning.html"><a href="machine-learning.html#deep-learning"><i class="fa fa-check"></i><b>6.9</b> Deep learning</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="machine-learning.html"><a href="machine-learning.html#deep-neural-network"><i class="fa fa-check"></i><b>6.9.1</b> Deep neural network</a></li>
<li class="chapter" data-level="6.9.2" data-path="machine-learning.html"><a href="machine-learning.html#tabnet"><i class="fa fa-check"></i><b>6.9.2</b> Tabnet</a></li>
<li class="chapter" data-level="6.9.3" data-path="machine-learning.html"><a href="machine-learning.html#cnn"><i class="fa fa-check"></i><b>6.9.3</b> CNN</a></li>
<li class="chapter" data-level="6.9.4" data-path="machine-learning.html"><a href="machine-learning.html#rnn"><i class="fa fa-check"></i><b>6.9.4</b> RNN</a></li>
<li class="chapter" data-level="6.9.5" data-path="machine-learning.html"><a href="machine-learning.html#reinforcement-learning"><i class="fa fa-check"></i><b>6.9.5</b> Reinforcement learning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html"><i class="fa fa-check"></i><b>7</b> Machine Learning Part 2</a>
<ul>
<li class="chapter" data-level="7.1" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#bag-of-words"><i class="fa fa-check"></i><b>7.1</b> Bag of words</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#tfidf"><i class="fa fa-check"></i><b>7.1.1</b> TFIDF</a></li>
<li class="chapter" data-level="7.1.2" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#extracting-data-from-web"><i class="fa fa-check"></i><b>7.1.2</b> Extracting data from web</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#wordcloud"><i class="fa fa-check"></i><b>7.2</b> Wordcloud</a></li>
<li class="chapter" data-level="7.3" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#bigram-analysis"><i class="fa fa-check"></i><b>7.3</b> Bigram analysis</a></li>
<li class="chapter" data-level="7.4" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#trigram"><i class="fa fa-check"></i><b>7.4</b> Trigram</a></li>
<li class="chapter" data-level="7.5" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#topic-modeling-or-thematic-analysis"><i class="fa fa-check"></i><b>7.5</b> Topic modeling or thematic analysis</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#probabilistic-topic-model"><i class="fa fa-check"></i><b>7.5.1</b> Probabilistic topic model</a></li>
<li class="chapter" data-level="7.5.2" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#nmf"><i class="fa fa-check"></i><b>7.5.2</b> NMF</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html"><i class="fa fa-check"></i><b>8</b> Bayesian Analysis</a>
<ul>
<li class="chapter" data-level="8.1" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#baysian-belief"><i class="fa fa-check"></i><b>8.1</b> Baysian belief</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#conditional-probability"><i class="fa fa-check"></i><b>8.1.1</b> Conditional probability</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#markov-model"><i class="fa fa-check"></i><b>8.2</b> Markov model</a></li>
<li class="chapter" data-level="8.3" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#inla-stan-and-bugs"><i class="fa fa-check"></i><b>8.3</b> INLA, Stan and BUGS</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#linear-regression"><i class="fa fa-check"></i><b>8.3.1</b> Linear regression</a></li>
<li class="chapter" data-level="8.3.2" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#logistic-regression-2"><i class="fa fa-check"></i><b>8.3.2</b> Logistic regression</a></li>
<li class="chapter" data-level="8.3.3" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#mixed-model"><i class="fa fa-check"></i><b>8.3.3</b> Mixed model</a></li>
<li class="chapter" data-level="8.3.4" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#bayesian-metaanalysis"><i class="fa fa-check"></i><b>8.3.4</b> Bayesian Metaanalysis</a></li>
<li class="chapter" data-level="8.3.5" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#cost"><i class="fa fa-check"></i><b>8.3.5</b> Cost</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="operational-research.html"><a href="operational-research.html"><i class="fa fa-check"></i><b>9</b> Operational Research</a>
<ul>
<li class="chapter" data-level="9.1" data-path="operational-research.html"><a href="operational-research.html#queueing-theory"><i class="fa fa-check"></i><b>9.1</b> Queueing theory</a></li>
<li class="chapter" data-level="9.2" data-path="operational-research.html"><a href="operational-research.html#discrete-event-simulations"><i class="fa fa-check"></i><b>9.2</b> Discrete Event Simulations</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="operational-research.html"><a href="operational-research.html#simulate-capacity-of-system"><i class="fa fa-check"></i><b>9.2.1</b> Simulate capacity of system</a></li>
<li class="chapter" data-level="9.2.2" data-path="operational-research.html"><a href="operational-research.html#queuing-network"><i class="fa fa-check"></i><b>9.2.2</b> Queuing network</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="operational-research.html"><a href="operational-research.html#linear-programming"><i class="fa fa-check"></i><b>9.3</b> Linear Programming</a></li>
<li class="chapter" data-level="9.4" data-path="operational-research.html"><a href="operational-research.html#forecasting"><i class="fa fa-check"></i><b>9.4</b> Forecasting</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="operational-research.html"><a href="operational-research.html#bed-requirement"><i class="fa fa-check"></i><b>9.4.1</b> Bed requirement</a></li>
<li class="chapter" data-level="9.4.2" data-path="operational-research.html"><a href="operational-research.html#length-of-stay"><i class="fa fa-check"></i><b>9.4.2</b> Length of stay</a></li>
<li class="chapter" data-level="9.4.3" data-path="operational-research.html"><a href="operational-research.html#customer-churns"><i class="fa fa-check"></i><b>9.4.3</b> Customer churns</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="operational-research.html"><a href="operational-research.html#process-mapping"><i class="fa fa-check"></i><b>9.5</b> Process mapping</a></li>
<li class="chapter" data-level="9.6" data-path="operational-research.html"><a href="operational-research.html#supply-chains"><i class="fa fa-check"></i><b>9.6</b> Supply chains</a></li>
<li class="chapter" data-level="9.7" data-path="operational-research.html"><a href="operational-research.html#health-economics"><i class="fa fa-check"></i><b>9.7</b> Health economics</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="operational-research.html"><a href="operational-research.html#cost-1"><i class="fa fa-check"></i><b>9.7.1</b> Cost</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="graph-theory.html"><a href="graph-theory.html"><i class="fa fa-check"></i><b>10</b> Graph Theory</a>
<ul>
<li class="chapter" data-level="10.1" data-path="graph-theory.html"><a href="graph-theory.html#special-graphs"><i class="fa fa-check"></i><b>10.1</b> Special graphs</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="graph-theory.html"><a href="graph-theory.html#laplacian-matrix"><i class="fa fa-check"></i><b>10.1.1</b> Laplacian matrix</a></li>
<li class="chapter" data-level="10.1.2" data-path="graph-theory.html"><a href="graph-theory.html#bimodal-bipartite-graph"><i class="fa fa-check"></i><b>10.1.2</b> Bimodal (bipartite) graph</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="graph-theory.html"><a href="graph-theory.html#centrality-measures"><i class="fa fa-check"></i><b>10.2</b> Centrality Measures</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="graph-theory.html"><a href="graph-theory.html#local-centrality-measures"><i class="fa fa-check"></i><b>10.2.1</b> Local centrality measures</a></li>
<li class="chapter" data-level="10.2.2" data-path="graph-theory.html"><a href="graph-theory.html#global-centrality-measures"><i class="fa fa-check"></i><b>10.2.2</b> Global centrality measures</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="graph-theory.html"><a href="graph-theory.html#community"><i class="fa fa-check"></i><b>10.3</b> Community</a></li>
<li class="chapter" data-level="10.4" data-path="graph-theory.html"><a href="graph-theory.html#visualising-graph"><i class="fa fa-check"></i><b>10.4</b> Visualising graph</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="graph-theory.html"><a href="graph-theory.html#visnetwork"><i class="fa fa-check"></i><b>10.4.1</b> Visnetwork</a></li>
<li class="chapter" data-level="10.4.2" data-path="graph-theory.html"><a href="graph-theory.html#large-graph"><i class="fa fa-check"></i><b>10.4.2</b> Large graph</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="graph-theory.html"><a href="graph-theory.html#social-media-and-network-analysis"><i class="fa fa-check"></i><b>10.5</b> Social Media and Network Analysis</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="graph-theory.html"><a href="graph-theory.html#twitter"><i class="fa fa-check"></i><b>10.5.1</b> Twitter</a></li>
<li class="chapter" data-level="10.5.2" data-path="graph-theory.html"><a href="graph-theory.html#youtube"><i class="fa fa-check"></i><b>10.5.2</b> Youtube</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html"><i class="fa fa-check"></i><b>11</b> Geospatial analysis</a>
<ul>
<li class="chapter" data-level="11.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#geocoding"><i class="fa fa-check"></i><b>11.1</b> Geocoding</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#openstreetmap"><i class="fa fa-check"></i><b>11.1.1</b> OpenStreetMap</a></li>
<li class="chapter" data-level="11.1.2" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#google-maps-api"><i class="fa fa-check"></i><b>11.1.2</b> Google Maps API</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#sp-and-sf-objects"><i class="fa fa-check"></i><b>11.2</b> Sp and sf objects</a></li>
<li class="chapter" data-level="11.3" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#thematic-map-1"><i class="fa fa-check"></i><b>11.3</b> Thematic map</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#calculate-distance-to-hospital-openstreetmap"><i class="fa fa-check"></i><b>11.3.1</b> Calculate distance to Hospital-OpenStreetMap</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#spatial-regression"><i class="fa fa-check"></i><b>11.4</b> Spatial regression</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#new-york-covid-19-mortality"><i class="fa fa-check"></i><b>11.4.1</b> New York COVID-19 mortality</a></li>
<li class="chapter" data-level="11.4.2" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#danish-stroke-registry"><i class="fa fa-check"></i><b>11.4.2</b> Danish Stroke Registry</a></li>
<li class="chapter" data-level="11.4.3" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#inla"><i class="fa fa-check"></i><b>11.4.3</b> INLA</a></li>
<li class="chapter" data-level="11.4.4" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#stan"><i class="fa fa-check"></i><b>11.4.4</b> Stan</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#machine-learning-in-spatial-analysis"><i class="fa fa-check"></i><b>11.5</b> Machine learning in spatial analysis</a></li>
<li class="chapter" data-level="11.6" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#spatio-temporal-regression"><i class="fa fa-check"></i><b>11.6</b> Spatio-temporal regression</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="app.html"><a href="app.html"><i class="fa fa-check"></i><b>12</b> App</a>
<ul>
<li class="chapter" data-level="12.1" data-path="app.html"><a href="app.html#brief-introduction-to-shiny-app"><i class="fa fa-check"></i><b>12.1</b> Brief introduction to Shiny app</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>13</b> Appendix</a>
<ul>
<li class="chapter" data-level="13.1" data-path="appendix.html"><a href="appendix.html#brief-introduction-to-matrix"><i class="fa fa-check"></i><b>13.1</b> Brief introduction to Matrix</a></li>
<li class="chapter" data-level="13.2" data-path="appendix.html"><a href="appendix.html#regression-1"><i class="fa fa-check"></i><b>13.2</b> Regression</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="appendix.html"><a href="appendix.html#linear-regression-1"><i class="fa fa-check"></i><b>13.2.1</b> Linear regression</a></li>
<li class="chapter" data-level="13.2.2" data-path="appendix.html"><a href="appendix.html#logistic-regression-3"><i class="fa fa-check"></i><b>13.2.2</b> Logistic regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applications of R in Healthcare</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bayesian-analysis" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> Bayesian Analysis<a href="bayesian-analysis.html#bayesian-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="baysian-belief" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Baysian belief<a href="bayesian-analysis.html#baysian-belief" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Bayes Theorem deals with the impact of information update on current belief expresses in terms of probability. P(A|B) is the posterior probability of A given knowledge of B. P(A) is the prior probability. P(B|A) is the conditional probability of B given A.
P(A|B)=P(B|A) x P(A)/P(B)</p>
<p>Bayes theorem can be expressed in terms of odds and post-test probabilities. This concept had been used in the analysis of the post-test probabilities of stroke related to the use of ABCD2. In this case the likelihood ratio and pretest probability of stroke in patients with TIA is used to calculate the post-test probability.</p>
<p>Table 13. 2 x 2 table
Disease + Disease -
Test + eg ABCD24 TP FP
Test  eg ABCD2&lt;4 FN TN</p>
<p>The true positive rate (TPR) can be expressed as conditional probability P(T+|D+). TP is the joint distribution of T+ and D+ while TN is the joint distribution of T- and D-.</p>
<p>The true negative rate (TNR) can be expressed as conditional probability P(T-|D-).</p>
<p>In the setting of ABCD2, the pre-test odds is derived from cases of TIA and stroke outcome at 90 days.</p>
<p>The positive likelihood ratio (PLR) in this case is derived from the sensitivity of ABCD2 for stroke and the one minus specificity of ABCD for stroke. One can interpret the likelihood ratio in terms of Bayes theorem.</p>
<p>To derive the post-test odds, the PLR is multiplied by the pre-test odds at the voxel level. The post-test odds is given by the product of the pre-test odds and the likelihood ratio.</p>
<p>In turn, the post-test probabilities is calculated from the post-test odds by:</p>
<div id="conditional-probability" class="section level3 hasAnchor" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> Conditional probability<a href="bayesian-analysis.html#conditional-probability" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Two events are independent if</p>
<p>Or</p>
<p>It follows that the events A and B occur simultaneously P(AB) is given by the probability of event A and probability of event B given that A has occurred.</p>
<p>If events A and B are independent then P(AB) is given by the probability of event A and probability of event B.</p>
<div id="bayes-rule" class="section level4 hasAnchor" number="8.1.1.1">
<h4><span class="header-section-number">8.1.1.1</span> Bayes Rule<a href="bayesian-analysis.html#bayes-rule" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For a sample space (A) containing n different subspaces (A1, A2..An) and A is a subset of the larger sample space B+ and B-, the probability that A is a member of B+an be given by P(A|B+). This can be divised as a tree structure with one branch given by the product of P(B+) and P(A|B+) and the other P(B-) and P(A|B-). The probability of B is given by the sum of P(B+)P(A|B+) and P(B-)P(A|B).</p>
<p>To make a decision on which of An events to choose, one evaluate the conditional probability of each subset e.g.P(A1B)/P(B), P(A2B)/P(B)P(AnB)/P(B).
The probability of P(B) is given by the sum of P(A1B), P(A2B)P(AnB). Here P(AnB) is the same as P(An)P(B|An). The subspace with the highest conditional probability may yield the optimal result.</p>
</div>
<div id="conditional-independence" class="section level4 hasAnchor" number="8.1.1.2">
<h4><span class="header-section-number">8.1.1.2</span> Conditional independence<a href="bayesian-analysis.html#conditional-independence" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The conditional distribution is given by</p>
<p>Conditional independence states that two events (A, B) are independent on a third set (C) if those two sets are independent in their conditional probability distribution given C782. This is stated as</p>
</div>
</div>
</div>
<div id="markov-model" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Markov model<a href="bayesian-analysis.html#markov-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Markov chain describes a chain of memoryless states which transit from one state to another without dependency on previous states. The Markov property The transition matrix describes the probabilities of changing from one state to another. A property of this Markov matrix is that the column data sum to one. An example is provided here <span class="math inline">\(\left[\begin{array}{cc}.8 &amp; .7\\.2 &amp;.3\end{array}\right]\)</span>. The column probabilities sum to 1. The PageRank method that we discuss in chapter on Graph Theory is a special form of Markov chain.</p>
</div>
<div id="inla-stan-and-bugs" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> INLA, Stan and BUGS<a href="bayesian-analysis.html#inla-stan-and-bugs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the example here, the GBD 2016 life time risk of stroke is re-used. The model is shown next to the simple linear regression. INLA is used to infer the probability of a set of data given the defined parameters. In the regression example below the linear regression return coefficient of 0.788 and the INLA version returns a mean value of 0.789 as well. Note that Bayesian methods do not provide p-values.</p>
<div id="linear-regression" class="section level3 hasAnchor" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> Linear regression<a href="bayesian-analysis.html#linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="bayesian-analysis.html#cb1-1" tabindex="-1"></a><span class="fu">library</span>(INLA)</span></code></pre></div>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## Loading required package: sp</code></pre>
<pre><code>## The legacy packages maptools, rgdal, and rgeos, underpinning the sp package,
## which was just loaded, will retire in October 2023.
## Please refer to R-spatial evolution reports for details, especially
## https://r-spatial.org/r/2023/05/15/evolution4.html.
## It may be desirable to make the sf package available;
## package maintainers should consider adding sf to Suggests:.
## The sp package is now running under evolution status 2
##      (status 2 uses the sf package in place of rgdal)</code></pre>
<pre><code>## This is INLA_23.09.09 built 2023-10-16 17:29:11 UTC.
##  - See www.r-inla.org/contact-us for how to get help.</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="bayesian-analysis.html#cb6-1" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;./Data-Use/world_stroke.Rda&quot;</span>)</span>
<span id="cb6-2"><a href="bayesian-analysis.html#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="bayesian-analysis.html#cb6-3" tabindex="-1"></a><span class="co">#perform ordinary linear regression for comparison</span></span>
<span id="cb6-4"><a href="bayesian-analysis.html#cb6-4" tabindex="-1"></a>fit<span class="ot">&lt;-</span><span class="fu">lm</span>(LifeExpectancy<span class="sc">~</span>MeanLifetimeRisk, <span class="at">data =</span>world_sfdf)</span>
<span id="cb6-5"><a href="bayesian-analysis.html#cb6-5" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = LifeExpectancy ~ MeanLifetimeRisk, data = world_sfdf)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -15.5141  -4.8413   0.1315   5.3673  10.5146 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      56.27490    1.59843   35.21   &lt;2e-16 ***
## MeanLifetimeRisk  0.78852    0.07655   10.30   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.223 on 173 degrees of freedom
##   (71 observations deleted due to missingness)
## Multiple R-squared:  0.3802, Adjusted R-squared:  0.3766 
## F-statistic: 106.1 on 1 and 173 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Here the output of Bayesian analysis contrasts with the frequentist output above.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="bayesian-analysis.html#cb8-1" tabindex="-1"></a><span class="co">#need to subset data as world_sfdf is of class &quot;sf&quot;         &quot;tbl_df&quot;     &quot;tbl&quot; &quot;data.frame&quot;</span></span>
<span id="cb8-2"><a href="bayesian-analysis.html#cb8-2" tabindex="-1"></a>fitINLA<span class="ot">&lt;-</span><span class="fu">inla</span>(LifeExpectancy<span class="sc">~</span>MeanLifetimeRisk, <span class="at">family =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="at">data =</span>world_sfdf[,<span class="fu">c</span>(<span class="dv">23</span>,<span class="dv">12</span>)])</span>
<span id="cb8-3"><a href="bayesian-analysis.html#cb8-3" tabindex="-1"></a></span>
<span id="cb8-4"><a href="bayesian-analysis.html#cb8-4" tabindex="-1"></a><span class="fu">summary</span>(fitINLA)</span></code></pre></div>
<pre><code>## 
## Call:
##    c(&quot;inla.core(formula = formula, family = family, contrasts = contrasts, 
##    &quot;, &quot; data = data, quantiles = quantiles, E = E, offset = offset, &quot;, &quot; 
##    scale = scale, weights = weights, Ntrials = Ntrials, strata = strata, 
##    &quot;, &quot; lp.scale = lp.scale, link.covariates = link.covariates, verbose = 
##    verbose, &quot;, &quot; lincomb = lincomb, selection = selection, control.compute 
##    = control.compute, &quot;, &quot; control.predictor = control.predictor, 
##    control.family = control.family, &quot;, &quot; control.inla = control.inla, 
##    control.fixed = control.fixed, &quot;, &quot; control.mode = control.mode, 
##    control.expert = control.expert, &quot;, &quot; control.hazard = control.hazard, 
##    control.lincomb = control.lincomb, &quot;, &quot; control.update = 
##    control.update, control.lp.scale = control.lp.scale, &quot;, &quot; 
##    control.pardiso = control.pardiso, only.hyperparam = only.hyperparam, 
##    &quot;, &quot; inla.call = inla.call, inla.arg = inla.arg, num.threads = 
##    num.threads, &quot;, &quot; keep = keep, working.directory = working.directory, 
##    silent = silent, &quot;, &quot; inla.mode = inla.mode, safe = FALSE, debug = 
##    debug, .parent.frame = .parent.frame)&quot; ) 
## Time used:
##     Pre = 0.452, Running = 2.34, Post = 0.0615, Total = 2.85 
## Fixed effects:
##                    mean    sd 0.025quant 0.5quant 0.975quant   mode kld
## (Intercept)      56.275 1.598     53.139   56.275     59.411 56.275   0
## MeanLifetimeRisk  0.789 0.077      0.638    0.789      0.939  0.789   0
## 
## Model hyperparameters:
##                                          mean    sd 0.025quant 0.5quant
## Precision for the Gaussian observations 0.026 0.003      0.021    0.026
##                                         0.975quant  mode
## Precision for the Gaussian observations      0.032 0.026
## 
## Marginal log-Likelihood:  -587.99 
##  is computed 
## Posterior summaries for the linear predictor and the fitted values are computed
## (Posterior marginals needs also &#39;control.compute=list(return.marginals.predictor=TRUE)&#39;)</code></pre>
<p>Performing Bayesian analysis with <em>rstan</em> can be tricky as the text file for the stan code require an empty line at the end. The <em>brms</em> library contains the same precompiled <em>stan</em> code and is easier to run.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="bayesian-analysis.html#cb10-1" tabindex="-1"></a><span class="co">#This may not run if there is incompatibility between Rtools and version of R</span></span>
<span id="cb10-2"><a href="bayesian-analysis.html#cb10-2" tabindex="-1"></a><span class="co">#check  system(&quot;g++ -v&quot;)</span></span>
<span id="cb10-3"><a href="bayesian-analysis.html#cb10-3" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb10-4"><a href="bayesian-analysis.html#cb10-4" tabindex="-1"></a></span>
<span id="cb10-5"><a href="bayesian-analysis.html#cb10-5" tabindex="-1"></a>fitBRM<span class="ot">&lt;-</span><span class="fu">brm</span>(LifeExpectancy<span class="sc">~</span>MeanLifetimeRisk,  <span class="at">data =</span>world_sfdf[,<span class="fu">c</span>(<span class="dv">23</span>,<span class="dv">12</span>)])</span>
<span id="cb10-6"><a href="bayesian-analysis.html#cb10-6" tabindex="-1"></a></span>
<span id="cb10-7"><a href="bayesian-analysis.html#cb10-7" tabindex="-1"></a><span class="fu">summary</span>(fitBRM)</span></code></pre></div>
<p>Extract the posterior samples for plotting.</p>
</div>
<div id="logistic-regression-2" class="section level3 hasAnchor" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> Logistic regression<a href="bayesian-analysis.html#logistic-regression-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This example illustrates the use of INLA for logistic regression.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="bayesian-analysis.html#cb11-1" tabindex="-1"></a><span class="co">#library(INLA)</span></span>
<span id="cb11-2"><a href="bayesian-analysis.html#cb11-2" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;BreastCancer&quot;</span>,<span class="at">package =</span> <span class="st">&quot;mlbench&quot;</span>)</span>
<span id="cb11-3"><a href="bayesian-analysis.html#cb11-3" tabindex="-1"></a><span class="fu">colnames</span>(BreastCancer)</span></code></pre></div>
<pre><code>##  [1] &quot;Id&quot;              &quot;Cl.thickness&quot;    &quot;Cell.size&quot;       &quot;Cell.shape&quot;     
##  [5] &quot;Marg.adhesion&quot;   &quot;Epith.c.size&quot;    &quot;Bare.nuclei&quot;     &quot;Bl.cromatin&quot;    
##  [9] &quot;Normal.nucleoli&quot; &quot;Mitoses&quot;         &quot;Class&quot;</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="bayesian-analysis.html#cb13-1" tabindex="-1"></a><span class="co">#note Class is benign or malignant of class factor</span></span>
<span id="cb13-2"><a href="bayesian-analysis.html#cb13-2" tabindex="-1"></a><span class="co">#need to convert this to numeric values</span></span>
<span id="cb13-3"><a href="bayesian-analysis.html#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="bayesian-analysis.html#cb13-4" tabindex="-1"></a></span>
<span id="cb13-5"><a href="bayesian-analysis.html#cb13-5" tabindex="-1"></a><span class="co">#first convert to character</span></span>
<span id="cb13-6"><a href="bayesian-analysis.html#cb13-6" tabindex="-1"></a>BreastCancer<span class="sc">$</span>Class<span class="ot">&lt;-</span><span class="fu">as.character</span>(BreastCancer<span class="sc">$</span>Class)</span>
<span id="cb13-7"><a href="bayesian-analysis.html#cb13-7" tabindex="-1"></a></span>
<span id="cb13-8"><a href="bayesian-analysis.html#cb13-8" tabindex="-1"></a>BreastCancer<span class="sc">$</span>Class[BreastCancer<span class="sc">$</span>Class<span class="sc">==</span><span class="st">&quot;benign&quot;</span>]<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb13-9"><a href="bayesian-analysis.html#cb13-9" tabindex="-1"></a>BreastCancer<span class="sc">$</span>Class[BreastCancer<span class="sc">$</span>Class<span class="sc">==</span><span class="st">&quot;malignant&quot;</span>]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb13-10"><a href="bayesian-analysis.html#cb13-10" tabindex="-1"></a></span>
<span id="cb13-11"><a href="bayesian-analysis.html#cb13-11" tabindex="-1"></a></span>
<span id="cb13-12"><a href="bayesian-analysis.html#cb13-12" tabindex="-1"></a></span>
<span id="cb13-13"><a href="bayesian-analysis.html#cb13-13" tabindex="-1"></a><span class="co">#convert factors to numeric</span></span>
<span id="cb13-14"><a href="bayesian-analysis.html#cb13-14" tabindex="-1"></a>BreastCancer2<span class="ot">&lt;-</span><span class="fu">lapply</span>(BreastCancer[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>)], as.numeric)</span>
<span id="cb13-15"><a href="bayesian-analysis.html#cb13-15" tabindex="-1"></a>BreastCancer2<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(BreastCancer2)</span>
<span id="cb13-16"><a href="bayesian-analysis.html#cb13-16" tabindex="-1"></a></span>
<span id="cb13-17"><a href="bayesian-analysis.html#cb13-17" tabindex="-1"></a><span class="co">#return Class to data</span></span>
<span id="cb13-18"><a href="bayesian-analysis.html#cb13-18" tabindex="-1"></a><span class="co">#convert character back to numeric</span></span>
<span id="cb13-19"><a href="bayesian-analysis.html#cb13-19" tabindex="-1"></a>BreastCancer2<span class="sc">$</span>Class<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(BreastCancer<span class="sc">$</span>Class)</span>
<span id="cb13-20"><a href="bayesian-analysis.html#cb13-20" tabindex="-1"></a></span>
<span id="cb13-21"><a href="bayesian-analysis.html#cb13-21" tabindex="-1"></a>Dx<span class="ot">&lt;-</span><span class="fu">inla</span>(Class <span class="sc">~</span>Epith.c.size<span class="sc">+</span>Cl.thickness<span class="sc">+</span>Cell.shape, <span class="at">family=</span><span class="st">&quot;binomial&quot;</span>, </span>
<span id="cb13-22"><a href="bayesian-analysis.html#cb13-22" tabindex="-1"></a>         <span class="at">data =</span> BreastCancer2)</span>
<span id="cb13-23"><a href="bayesian-analysis.html#cb13-23" tabindex="-1"></a></span>
<span id="cb13-24"><a href="bayesian-analysis.html#cb13-24" tabindex="-1"></a><span class="fu">summary</span>(Dx)</span></code></pre></div>
<pre><code>## 
## Call:
##    c(&quot;inla.core(formula = formula, family = family, contrasts = contrasts, 
##    &quot;, &quot; data = data, quantiles = quantiles, E = E, offset = offset, &quot;, &quot; 
##    scale = scale, weights = weights, Ntrials = Ntrials, strata = strata, 
##    &quot;, &quot; lp.scale = lp.scale, link.covariates = link.covariates, verbose = 
##    verbose, &quot;, &quot; lincomb = lincomb, selection = selection, control.compute 
##    = control.compute, &quot;, &quot; control.predictor = control.predictor, 
##    control.family = control.family, &quot;, &quot; control.inla = control.inla, 
##    control.fixed = control.fixed, &quot;, &quot; control.mode = control.mode, 
##    control.expert = control.expert, &quot;, &quot; control.hazard = control.hazard, 
##    control.lincomb = control.lincomb, &quot;, &quot; control.update = 
##    control.update, control.lp.scale = control.lp.scale, &quot;, &quot; 
##    control.pardiso = control.pardiso, only.hyperparam = only.hyperparam, 
##    &quot;, &quot; inla.call = inla.call, inla.arg = inla.arg, num.threads = 
##    num.threads, &quot;, &quot; keep = keep, working.directory = working.directory, 
##    silent = silent, &quot;, &quot; inla.mode = inla.mode, safe = FALSE, debug = 
##    debug, .parent.frame = .parent.frame)&quot; ) 
## Time used:
##     Pre = 0.182, Running = 0.198, Post = 0.0646, Total = 0.445 
## Fixed effects:
##                mean    sd 0.025quant 0.5quant 0.975quant   mode kld
## (Intercept)  -8.496 0.709     -9.886   -8.496     -7.106 -8.496   0
## Epith.c.size  0.483 0.123      0.242    0.483      0.724  0.483   0
## Cl.thickness  0.644 0.094      0.459    0.644      0.829  0.644   0
## Cell.shape    0.941 0.121      0.703    0.941      1.178  0.941   0
## 
## Marginal log-Likelihood:  -114.89 
##  is computed 
## Posterior summaries for the linear predictor and the fitted values are computed
## (Posterior marginals needs also &#39;control.compute=list(return.marginals.predictor=TRUE)&#39;)</code></pre>
<p>The same data is used for logistic regression with stan.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="bayesian-analysis.html#cb15-1" tabindex="-1"></a>DxBRM<span class="ot">&lt;-</span><span class="fu">brm</span>(Class <span class="sc">~</span>Epith.c.size<span class="sc">+</span>Cl.thickness<span class="sc">+</span>Cell.shape, </span>
<span id="cb15-2"><a href="bayesian-analysis.html#cb15-2" tabindex="-1"></a>           <span class="at">family=</span><span class="fu">bernoulli</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>), <span class="at">data =</span> BreastCancer2)</span>
<span id="cb15-3"><a href="bayesian-analysis.html#cb15-3" tabindex="-1"></a></span>
<span id="cb15-4"><a href="bayesian-analysis.html#cb15-4" tabindex="-1"></a><span class="fu">summary</span>(DxBRM)</span></code></pre></div>
<p>Extract the posterior sample from logistic regression.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="bayesian-analysis.html#cb16-1" tabindex="-1"></a>post_samples_DxBRM <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">posterior_samples</span>(DxBRM)</span>
<span id="cb16-2"><a href="bayesian-analysis.html#cb16-2" tabindex="-1"></a></span>
<span id="cb16-3"><a href="bayesian-analysis.html#cb16-3" tabindex="-1"></a>post_samples_DxBRM <span class="sc">%&gt;%</span> </span>
<span id="cb16-4"><a href="bayesian-analysis.html#cb16-4" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>lp__) <span class="sc">%&gt;%</span> </span>
<span id="cb16-5"><a href="bayesian-analysis.html#cb16-5" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb16-6"><a href="bayesian-analysis.html#cb16-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb16-7"><a href="bayesian-analysis.html#cb16-7" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb16-8"><a href="bayesian-analysis.html#cb16-8" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>name, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
</div>
<div id="mixed-model" class="section level3 hasAnchor" number="8.3.3">
<h3><span class="header-section-number">8.3.3</span> Mixed model<a href="bayesian-analysis.html#mixed-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Plotting world_sfdf to identify characteristics of the data</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="bayesian-analysis.html#cb17-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb17-2"><a href="bayesian-analysis.html#cb17-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>world_sfdf, <span class="fu">aes</span>(<span class="at">x=</span>LifeExpectancy, <span class="at">y=</span>MeanLifetimeRisk,</span>
<span id="cb17-3"><a href="bayesian-analysis.html#cb17-3" tabindex="-1"></a>              <span class="at">color=</span>Income, <span class="at">shape=</span>Continent))<span class="sc">+</span>                                               </span>
<span id="cb17-4"><a href="bayesian-analysis.html#cb17-4" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb17-5"><a href="bayesian-analysis.html#cb17-5" tabindex="-1"></a>  <span class="fu">geom_jitter</span>()</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/07-Bayesian-analysis-3-1.png" width="672" /></p>
<p>Intercept model with INLA</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="bayesian-analysis.html#cb18-1" tabindex="-1"></a><span class="co"># Set prior on precision</span></span>
<span id="cb18-2"><a href="bayesian-analysis.html#cb18-2" tabindex="-1"></a>prec.prior <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">prec =</span> <span class="fu">list</span>(<span class="at">param =</span> <span class="fu">c</span>(<span class="fl">0.001</span>, <span class="fl">0.001</span>)))</span>
<span id="cb18-3"><a href="bayesian-analysis.html#cb18-3" tabindex="-1"></a></span>
<span id="cb18-4"><a href="bayesian-analysis.html#cb18-4" tabindex="-1"></a>Inla_Income<span class="ot">&lt;-</span><span class="fu">inla</span>(MeanLifetimeRisk<span class="sc">~</span><span class="dv">1</span><span class="sc">+</span>LifeExpectancy<span class="sc">+</span><span class="fu">f</span>(Income,  </span>
<span id="cb18-5"><a href="bayesian-analysis.html#cb18-5" tabindex="-1"></a>    <span class="at">model =</span> <span class="st">&quot;iid&quot;</span>,</span>
<span id="cb18-6"><a href="bayesian-analysis.html#cb18-6" tabindex="-1"></a>    <span class="at">hyper =</span> prec.prior), </span>
<span id="cb18-7"><a href="bayesian-analysis.html#cb18-7" tabindex="-1"></a>    <span class="at">data =</span>world_sfdf[,<span class="fu">c</span>(<span class="dv">23</span>,<span class="dv">12</span>, <span class="dv">15</span>, <span class="dv">20</span>)], </span>
<span id="cb18-8"><a href="bayesian-analysis.html#cb18-8" tabindex="-1"></a>    <span class="at">control.predictor =</span> <span class="fu">list</span>(<span class="at">compute =</span> <span class="cn">TRUE</span>))</span>
<span id="cb18-9"><a href="bayesian-analysis.html#cb18-9" tabindex="-1"></a></span>
<span id="cb18-10"><a href="bayesian-analysis.html#cb18-10" tabindex="-1"></a><span class="fu">summary</span>(Inla_Income)</span></code></pre></div>
<pre><code>## 
## Call:
##    c(&quot;inla.core(formula = formula, family = family, contrasts = contrasts, 
##    &quot;, &quot; data = data, quantiles = quantiles, E = E, offset = offset, &quot;, &quot; 
##    scale = scale, weights = weights, Ntrials = Ntrials, strata = strata, 
##    &quot;, &quot; lp.scale = lp.scale, link.covariates = link.covariates, verbose = 
##    verbose, &quot;, &quot; lincomb = lincomb, selection = selection, control.compute 
##    = control.compute, &quot;, &quot; control.predictor = control.predictor, 
##    control.family = control.family, &quot;, &quot; control.inla = control.inla, 
##    control.fixed = control.fixed, &quot;, &quot; control.mode = control.mode, 
##    control.expert = control.expert, &quot;, &quot; control.hazard = control.hazard, 
##    control.lincomb = control.lincomb, &quot;, &quot; control.update = 
##    control.update, control.lp.scale = control.lp.scale, &quot;, &quot; 
##    control.pardiso = control.pardiso, only.hyperparam = only.hyperparam, 
##    &quot;, &quot; inla.call = inla.call, inla.arg = inla.arg, num.threads = 
##    num.threads, &quot;, &quot; keep = keep, working.directory = working.directory, 
##    silent = silent, &quot;, &quot; inla.mode = inla.mode, safe = FALSE, debug = 
##    debug, .parent.frame = .parent.frame)&quot; ) 
## Time used:
##     Pre = 0.195, Running = 0.259, Post = 0.0771, Total = 0.531 
## Fixed effects:
##                  mean    sd 0.025quant 0.5quant 0.975quant   mode   kld
## (Intercept)    17.950 2.176     13.573   17.969     22.218 17.967 0.001
## LifeExpectancy  0.027 0.019     -0.010    0.027      0.064  0.027 0.000
## 
## Random effects:
##   Name     Model
##     Income IID model
## 
## Model hyperparameters:
##                                          mean    sd 0.025quant 0.5quant
## Precision for the Gaussian observations 0.047 0.004      0.039    0.047
## Precision for Income                    0.098 0.092      0.011    0.071
##                                         0.975quant  mode
## Precision for the Gaussian observations      0.056 0.046
## Precision for Income                         0.343 0.030
## 
## Marginal log-Likelihood:  -760.64 
##  is computed 
## Posterior summaries for the linear predictor and the fitted values are computed
## (Posterior marginals needs also &#39;control.compute=list(return.marginals.predictor=TRUE)&#39;)</code></pre>
<p>Intercept model with BRMS</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="bayesian-analysis.html#cb20-1" tabindex="-1"></a>BRMS_Income <span class="ot">&lt;-</span> <span class="fu">brm</span>(MeanLifetimeRisk <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> LifeExpectancy<span class="sc">+</span>(<span class="dv">1</span> <span class="sc">|</span> Income), </span>
<span id="cb20-2"><a href="bayesian-analysis.html#cb20-2" tabindex="-1"></a>                              <span class="at">data   =</span> world_sfdf, </span>
<span id="cb20-3"><a href="bayesian-analysis.html#cb20-3" tabindex="-1"></a>                              <span class="at">warmup =</span> <span class="dv">100</span>, </span>
<span id="cb20-4"><a href="bayesian-analysis.html#cb20-4" tabindex="-1"></a>                              <span class="at">iter   =</span> <span class="dv">200</span>, </span>
<span id="cb20-5"><a href="bayesian-analysis.html#cb20-5" tabindex="-1"></a>                              <span class="at">chains =</span> <span class="dv">2</span>, </span>
<span id="cb20-6"><a href="bayesian-analysis.html#cb20-6" tabindex="-1"></a>                              <span class="at">inits  =</span> <span class="st">&quot;random&quot;</span>,</span>
<span id="cb20-7"><a href="bayesian-analysis.html#cb20-7" tabindex="-1"></a>                              <span class="at">cores  =</span> <span class="dv">2</span>)  <span class="co">#use 2 CPU cores simultaneously instead of just 1.</span></span>
<span id="cb20-8"><a href="bayesian-analysis.html#cb20-8" tabindex="-1"></a></span>
<span id="cb20-9"><a href="bayesian-analysis.html#cb20-9" tabindex="-1"></a><span class="fu">summary</span>(BRMS_Income)</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="bayesian-analysis.html#cb21-1" tabindex="-1"></a>post_samples_BRMS_Income <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">posterior_samples</span>(BRMS_Income)</span>
<span id="cb21-2"><a href="bayesian-analysis.html#cb21-2" tabindex="-1"></a></span>
<span id="cb21-3"><a href="bayesian-analysis.html#cb21-3" tabindex="-1"></a>post_samples_BRMS_Income <span class="sc">%&gt;%</span> </span>
<span id="cb21-4"><a href="bayesian-analysis.html#cb21-4" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>lp__) <span class="sc">%&gt;%</span> </span>
<span id="cb21-5"><a href="bayesian-analysis.html#cb21-5" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb21-6"><a href="bayesian-analysis.html#cb21-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb21-7"><a href="bayesian-analysis.html#cb21-7" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb21-8"><a href="bayesian-analysis.html#cb21-8" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>name, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
</div>
<div id="bayesian-metaanalysis" class="section level3 hasAnchor" number="8.3.4">
<h3><span class="header-section-number">8.3.4</span> Bayesian Metaanalysis<a href="bayesian-analysis.html#bayesian-metaanalysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A Bayesian approach towards metaanalysis is provided below using the package <em>meta4diag</em> <span class="citation">(<a href="#ref-2015arXiv151206220G">Guo and Riebler 2015</a>)</span>. This approach uses the Integrated Nested Laplacian Approximations (INLA). This package takes a has an advantage over the <em>mada</em> package which does not provide a bivariate method for performing summary sensitivity and specificity.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="bayesian-analysis.html#cb22-1" tabindex="-1"></a><span class="co">#install.packages(&quot;INLA&quot;,repos=c(getOption(&quot;repos&quot;),INLA=&quot;https://inla.r-inla-download.org/R/stable&quot;), dep=TRUE)</span></span>
<span id="cb22-2"><a href="bayesian-analysis.html#cb22-2" tabindex="-1"></a><span class="fu">library</span>(meta4diag)</span></code></pre></div>
<pre><code>## Loading required package: grid</code></pre>
<pre><code>## Loading required package: shiny</code></pre>
<pre><code>## Loading required package: shinyBS</code></pre>
<pre><code>## Loading required package: caTools</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="bayesian-analysis.html#cb27-1" tabindex="-1"></a><span class="fu">library</span>(INLA)</span>
<span id="cb27-2"><a href="bayesian-analysis.html#cb27-2" tabindex="-1"></a></span>
<span id="cb27-3"><a href="bayesian-analysis.html#cb27-3" tabindex="-1"></a><span class="co">#data from spot sign metaanalysis</span></span>
<span id="cb27-4"><a href="bayesian-analysis.html#cb27-4" tabindex="-1"></a>Dat<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">&quot;./Data-Use/ss150718.csv&quot;</span>)</span>
<span id="cb27-5"><a href="bayesian-analysis.html#cb27-5" tabindex="-1"></a></span>
<span id="cb27-6"><a href="bayesian-analysis.html#cb27-6" tabindex="-1"></a><span class="co">#remove duplicates</span></span>
<span id="cb27-7"><a href="bayesian-analysis.html#cb27-7" tabindex="-1"></a>dat<span class="ot">&lt;-</span><span class="fu">subset</span>(Dat, Dat<span class="sc">$</span>retain<span class="sc">==</span><span class="st">&quot;yes&quot;</span>) </span>
<span id="cb27-8"><a href="bayesian-analysis.html#cb27-8" tabindex="-1"></a></span>
<span id="cb27-9"><a href="bayesian-analysis.html#cb27-9" tabindex="-1"></a><span class="co">#the data can be viewed under res$data</span></span>
<span id="cb27-10"><a href="bayesian-analysis.html#cb27-10" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">meta4diag</span>(<span class="at">data =</span> dat) </span>
<span id="cb27-11"><a href="bayesian-analysis.html#cb27-11" tabindex="-1"></a></span>
<span id="cb27-12"><a href="bayesian-analysis.html#cb27-12" tabindex="-1"></a><span class="co">#perform SROC</span></span>
<span id="cb27-13"><a href="bayesian-analysis.html#cb27-13" tabindex="-1"></a><span class="fu">SROC</span>(res, <span class="at">crShow =</span> T)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/07-Bayesian-analysis-4-1.png" width="672" /></p>
<p>Forest plot of sensitivity using the <em>meta4diag</em> package.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="bayesian-analysis.html#cb28-1" tabindex="-1"></a><span class="co">#sensitivity is specified under accuracy.type</span></span>
<span id="cb28-2"><a href="bayesian-analysis.html#cb28-2" tabindex="-1"></a><span class="co">#note that there are several different forest plot: mada, metafor, meta4diag</span></span>
<span id="cb28-3"><a href="bayesian-analysis.html#cb28-3" tabindex="-1"></a>meta4diag<span class="sc">::</span><span class="fu">forest</span>(res, <span class="at">accuracy.type=</span><span class="st">&quot;sens&quot;</span>, <span class="at">est.type=</span><span class="st">&quot;mean&quot;</span>, <span class="at">p.cex=</span><span class="st">&quot;scaled&quot;</span>, <span class="at">p.pch=</span><span class="dv">15</span>, <span class="at">p.col=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb28-4"><a href="bayesian-analysis.html#cb28-4" tabindex="-1"></a>    <span class="at">nameShow=</span><span class="st">&quot;right&quot;</span>, <span class="at">dataShow=</span><span class="st">&quot;center&quot;</span>, <span class="at">estShow=</span><span class="st">&quot;left&quot;</span>, <span class="at">text.cex=</span><span class="dv">1</span>,</span>
<span id="cb28-5"><a href="bayesian-analysis.html#cb28-5" tabindex="-1"></a>    <span class="at">shade.col=</span><span class="st">&quot;gray&quot;</span>, <span class="at">arrow.col=</span><span class="st">&quot;black&quot;</span>, <span class="at">arrow.lty=</span><span class="dv">1</span>, <span class="at">arrow.lwd=</span><span class="dv">1</span>,</span>
<span id="cb28-6"><a href="bayesian-analysis.html#cb28-6" tabindex="-1"></a>    <span class="at">cut=</span><span class="cn">TRUE</span>, <span class="at">intervals=</span><span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>),</span>
<span id="cb28-7"><a href="bayesian-analysis.html#cb28-7" tabindex="-1"></a>    <span class="at">main=</span><span class="st">&quot;Forest plot of Sensitivity&quot;</span>, <span class="at">main.cex=</span><span class="fl">1.5</span>, <span class="at">axis.cex=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/07-Bayesian-analysis-4-1-1.png" width="672" /></p>
<p>Forest plot of specificity using the <em>meta4diag</em> package.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="bayesian-analysis.html#cb29-1" tabindex="-1"></a><span class="co">#specificity is specified under accuracy.type</span></span>
<span id="cb29-2"><a href="bayesian-analysis.html#cb29-2" tabindex="-1"></a><span class="co">#note that there are several different forest plot: mada, metafor, meta4diag</span></span>
<span id="cb29-3"><a href="bayesian-analysis.html#cb29-3" tabindex="-1"></a>meta4diag<span class="sc">::</span><span class="fu">forest</span>(res, <span class="at">accuracy.type=</span><span class="st">&quot;spec&quot;</span>, <span class="at">est.type=</span><span class="st">&quot;mean&quot;</span>, <span class="at">p.cex=</span><span class="st">&quot;scaled&quot;</span>, <span class="at">p.pch=</span><span class="dv">15</span>, <span class="at">p.col=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb29-4"><a href="bayesian-analysis.html#cb29-4" tabindex="-1"></a>    <span class="at">nameShow=</span><span class="st">&quot;right&quot;</span>, <span class="at">dataShow=</span><span class="st">&quot;center&quot;</span>, <span class="at">estShow=</span><span class="st">&quot;left&quot;</span>, <span class="at">text.cex=</span><span class="dv">1</span>,</span>
<span id="cb29-5"><a href="bayesian-analysis.html#cb29-5" tabindex="-1"></a>    <span class="at">shade.col=</span><span class="st">&quot;gray&quot;</span>, <span class="at">arrow.col=</span><span class="st">&quot;black&quot;</span>, <span class="at">arrow.lty=</span><span class="dv">1</span>, <span class="at">arrow.lwd=</span><span class="dv">1</span>,</span>
<span id="cb29-6"><a href="bayesian-analysis.html#cb29-6" tabindex="-1"></a>    <span class="at">cut=</span><span class="cn">TRUE</span>, <span class="at">intervals=</span><span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>),</span>
<span id="cb29-7"><a href="bayesian-analysis.html#cb29-7" tabindex="-1"></a>    <span class="at">main=</span><span class="st">&quot;Forest plot of Specificity&quot;</span>, <span class="at">main.cex=</span><span class="fl">1.5</span>, <span class="at">axis.cex=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/07-Bayesian-analysis-4-2-1.png" width="672" /></p>
</div>
<div id="cost" class="section level3 hasAnchor" number="8.3.5">
<h3><span class="header-section-number">8.3.5</span> Cost<a href="bayesian-analysis.html#cost" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The example below is provided by <em>hesim</em>.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="bayesian-analysis.html#cb30-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;hesim&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;hesim&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:Matrix&#39;:
## 
##     expand</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="bayesian-analysis.html#cb33-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;data.table&quot;</span>)</span>
<span id="cb33-2"><a href="bayesian-analysis.html#cb33-2" tabindex="-1"></a>strategies <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">strategy_id =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb33-3"><a href="bayesian-analysis.html#cb33-3" tabindex="-1"></a>n_patients <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb33-4"><a href="bayesian-analysis.html#cb33-4" tabindex="-1"></a>patients <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">patient_id =</span> <span class="dv">1</span><span class="sc">:</span>n_patients,</span>
<span id="cb33-5"><a href="bayesian-analysis.html#cb33-5" tabindex="-1"></a>          <span class="at">age =</span> <span class="fu">rnorm</span>(n_patients, <span class="at">mean =</span> <span class="dv">70</span>, <span class="at">sd =</span> <span class="dv">10</span>),</span>
<span id="cb33-6"><a href="bayesian-analysis.html#cb33-6" tabindex="-1"></a>          <span class="at">female =</span> <span class="fu">rbinom</span>(n_patients, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> .<span class="dv">4</span>))</span>
<span id="cb33-7"><a href="bayesian-analysis.html#cb33-7" tabindex="-1"></a>states <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">state_id =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb33-8"><a href="bayesian-analysis.html#cb33-8" tabindex="-1"></a>                     <span class="at">state_name =</span> <span class="fu">c</span>(<span class="st">&quot;Healthy&quot;</span>, <span class="st">&quot;Sick&quot;</span>)) </span>
<span id="cb33-9"><a href="bayesian-analysis.html#cb33-9" tabindex="-1"></a><span class="co"># Non-death health states</span></span>
<span id="cb33-10"><a href="bayesian-analysis.html#cb33-10" tabindex="-1"></a>tmat <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb33-11"><a href="bayesian-analysis.html#cb33-11" tabindex="-1"></a>              <span class="fu">c</span>(<span class="dv">3</span>, <span class="cn">NA</span>, <span class="dv">4</span>),</span>
<span id="cb33-12"><a href="bayesian-analysis.html#cb33-12" tabindex="-1"></a>              <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>))</span>
<span id="cb33-13"><a href="bayesian-analysis.html#cb33-13" tabindex="-1"></a><span class="fu">colnames</span>(tmat) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(tmat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Healthy&quot;</span>, <span class="st">&quot;Sick&quot;</span>, <span class="st">&quot;Dead&quot;</span>)</span>
<span id="cb33-14"><a href="bayesian-analysis.html#cb33-14" tabindex="-1"></a>transitions <span class="ot">&lt;-</span> <span class="fu">create_trans_dt</span>(tmat)</span>
<span id="cb33-15"><a href="bayesian-analysis.html#cb33-15" tabindex="-1"></a>transitions[, trans <span class="sc">:=</span> <span class="fu">factor</span>(transition_id)]</span>
<span id="cb33-16"><a href="bayesian-analysis.html#cb33-16" tabindex="-1"></a>hesim_dat <span class="ot">&lt;-</span> <span class="fu">hesim_data</span>(<span class="at">strategies =</span> strategies,</span>
<span id="cb33-17"><a href="bayesian-analysis.html#cb33-17" tabindex="-1"></a>                        <span class="at">patients =</span> patients, </span>
<span id="cb33-18"><a href="bayesian-analysis.html#cb33-18" tabindex="-1"></a>                        <span class="at">states =</span> states,</span>
<span id="cb33-19"><a href="bayesian-analysis.html#cb33-19" tabindex="-1"></a>                        <span class="at">transitions =</span> transitions)</span>
<span id="cb33-20"><a href="bayesian-analysis.html#cb33-20" tabindex="-1"></a><span class="fu">print</span>(hesim_dat)</span></code></pre></div>
<pre><code>## $strategies
##    strategy_id
## 1:           1
## 2:           2
## 
## $patients
##       patient_id      age female
##    1:          1 45.73757      1
##    2:          2 43.57000      0
##    3:          3 61.78056      0
##    4:          4 68.32311      1
##    5:          5 73.44639      0
##   ---                           
##  996:        996 76.86785      0
##  997:        997 68.91076      0
##  998:        998 86.80927      1
##  999:        999 67.50553      1
## 1000:       1000 69.65274      1
## 
## $states
##    state_id state_name
## 1:        1    Healthy
## 2:        2       Sick
## 
## $transitions
##    transition_id from to from_name to_name trans
## 1:             1    1  2   Healthy    Sick     1
## 2:             2    1  3   Healthy    Dead     2
## 3:             3    2  1      Sick Healthy     3
## 4:             4    2  3      Sick    Dead     4
## 
## attr(,&quot;class&quot;)
## [1] &quot;hesim_data&quot;</code></pre>

</div>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-2015arXiv151206220G" class="csl-entry">
Guo, Jingyi, and Andrea Riebler. 2015. <span><span class="nocase">meta4diag: Bayesian Bivariate Meta-analysis of Diagnostic Test Studies for Routine Practice</span>.</span> <em>arXiv e-Prints</em>, December, arXiv:1512.06220. <a href="https://arxiv.org/abs/1512.06220">https://arxiv.org/abs/1512.06220</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="machine-learning-part-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="operational-research.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/07-Bayesian-analysis.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Applications-of-R-in-Healthcare.pdf", "Applications-of-R-in-Healthcare.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
