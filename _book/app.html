<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 12 App | Applications of R in Healthcare</title>
  <meta name="description" content="This is a book describing the use of R in Healthcare. It is aimed at beginners of R language. The majority of the examples are taken from works in Neurology. The ideas and principles can be applied to other aspects of Healthcare. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 12 App | Applications of R in Healthcare" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a book describing the use of R in Healthcare. It is aimed at beginners of R language. The majority of the examples are taken from works in Neurology. The ideas and principles can be applied to other aspects of Healthcare. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="GNtem2/HealthcareRbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 App | Applications of R in Healthcare" />
  
  <meta name="twitter:description" content="This is a book describing the use of R in Healthcare. It is aimed at beginners of R language. The majority of the examples are taken from works in Neurology. The ideas and principles can be applied to other aspects of Healthcare. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Thanh Phan" />


<meta name="date" content="2020-04-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="bayesian-analysis.html"/>
<link rel="next" href="appendix.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applications-of-R-in-Healthcare</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preamble</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction to plotting in R</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#ggplot2"><i class="fa fa-check"></i><b>2.1</b> ggplot2</a><ul>
<li class="chapter" data-level="2.1.1" data-path="intro.html"><a href="intro.html#histogram"><i class="fa fa-check"></i><b>2.1.1</b> Histogram</a></li>
<li class="chapter" data-level="2.1.2" data-path="intro.html"><a href="intro.html#bar-plot"><i class="fa fa-check"></i><b>2.1.2</b> Bar plot</a></li>
<li class="chapter" data-level="2.1.3" data-path="intro.html"><a href="intro.html#pie-chart"><i class="fa fa-check"></i><b>2.1.3</b> Pie chart</a></li>
<li class="chapter" data-level="2.1.4" data-path="intro.html"><a href="intro.html#scatter-plot"><i class="fa fa-check"></i><b>2.1.4</b> Scatter plot</a></li>
<li class="chapter" data-level="2.1.5" data-path="intro.html"><a href="intro.html#arrange-plot-in-grids"><i class="fa fa-check"></i><b>2.1.5</b> arrange plot in grids</a></li>
<li class="chapter" data-level="2.1.6" data-path="intro.html"><a href="intro.html#line-plot"><i class="fa fa-check"></i><b>2.1.6</b> Line plot</a></li>
<li class="chapter" data-level="2.1.7" data-path="intro.html"><a href="intro.html#facet-wrap"><i class="fa fa-check"></i><b>2.1.7</b> Facet wrap</a></li>
<li class="chapter" data-level="2.1.8" data-path="intro.html"><a href="intro.html#polygons"><i class="fa fa-check"></i><b>2.1.8</b> Polygons</a></li>
<li class="chapter" data-level="2.1.9" data-path="intro.html"><a href="intro.html#gantt-chart"><i class="fa fa-check"></i><b>2.1.9</b> Gantt chart</a></li>
<li class="chapter" data-level="2.1.10" data-path="intro.html"><a href="intro.html#heatmap"><i class="fa fa-check"></i><b>2.1.10</b> Heatmap</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#ggplot2-extra"><i class="fa fa-check"></i><b>2.2</b> ggplot2 extra</a><ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#alluvial-and-sankey-diagram"><i class="fa fa-check"></i><b>2.2.1</b> Alluvial and Sankey diagram</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#survival-plot"><i class="fa fa-check"></i><b>2.2.2</b> Survival plot</a></li>
<li class="chapter" data-level="2.2.3" data-path="intro.html"><a href="intro.html#ggraph-and-tidygraph"><i class="fa fa-check"></i><b>2.2.3</b> ggraph and tidygraph</a></li>
<li class="chapter" data-level="2.2.4" data-path="intro.html"><a href="intro.html#ggparty-decision-tree"><i class="fa fa-check"></i><b>2.2.4</b> ggparty-decision tree</a></li>
<li class="chapter" data-level="2.2.5" data-path="intro.html"><a href="intro.html#ggroc--roc-curve"><i class="fa fa-check"></i><b>2.2.5</b> ggROC- ROC curve</a></li>
<li class="chapter" data-level="2.2.6" data-path="intro.html"><a href="intro.html#ggtree-and-phyloseq"><i class="fa fa-check"></i><b>2.2.6</b> ggtree and phyloseq</a></li>
<li class="chapter" data-level="2.2.7" data-path="intro.html"><a href="intro.html#map"><i class="fa fa-check"></i><b>2.2.7</b> Map</a></li>
<li class="chapter" data-level="2.2.8" data-path="intro.html"><a href="intro.html#ggwordcloud"><i class="fa fa-check"></i><b>2.2.8</b> ggwordcloud</a></li>
<li class="chapter" data-level="2.2.9" data-path="intro.html"><a href="intro.html#gganimate"><i class="fa fa-check"></i><b>2.2.9</b> gganimate</a></li>
<li class="chapter" data-level="2.2.10" data-path="intro.html"><a href="intro.html#ggneuro"><i class="fa fa-check"></i><b>2.2.10</b> ggneuro</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#plotly"><i class="fa fa-check"></i><b>2.3</b> plotly</a><ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#scatter-plot-1"><i class="fa fa-check"></i><b>2.3.1</b> scatter plot</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro.html"><a href="intro.html#bar-plot-1"><i class="fa fa-check"></i><b>2.3.2</b> bar plot</a></li>
<li class="chapter" data-level="2.3.3" data-path="intro.html"><a href="intro.html#heatmap-1"><i class="fa fa-check"></i><b>2.3.3</b> heatmap</a></li>
<li class="chapter" data-level="2.3.4" data-path="intro.html"><a href="intro.html#map-1"><i class="fa fa-check"></i><b>2.3.4</b> map</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>3</b> Data Wrangling</a><ul>
<li class="chapter" data-level="3.1" data-path="data-wrangling.html"><a href="data-wrangling.html#data"><i class="fa fa-check"></i><b>3.1</b> Data</a><ul>
<li class="chapter" data-level="3.1.1" data-path="data-wrangling.html"><a href="data-wrangling.html#vector-arrays-matrix"><i class="fa fa-check"></i><b>3.1.1</b> Vector, Arrays, Matrix</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-wrangling.html"><a href="data-wrangling.html#data-storage"><i class="fa fa-check"></i><b>3.2</b> Data storage</a><ul>
<li class="chapter" data-level="3.2.1" data-path="data-wrangling.html"><a href="data-wrangling.html#excel-data"><i class="fa fa-check"></i><b>3.2.1</b> Excel data</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-wrangling.html"><a href="data-wrangling.html#foreign-data"><i class="fa fa-check"></i><b>3.2.2</b> Foreign data</a></li>
<li class="chapter" data-level="3.2.3" data-path="data-wrangling.html"><a href="data-wrangling.html#json-format"><i class="fa fa-check"></i><b>3.2.3</b> json format</a></li>
<li class="chapter" data-level="3.2.4" data-path="data-wrangling.html"><a href="data-wrangling.html#dicom-and-nifti-format"><i class="fa fa-check"></i><b>3.2.4</b> DICOM and nifti format</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-wrangling.html"><a href="data-wrangling.html#tidy-data"><i class="fa fa-check"></i><b>3.3</b> Tidy data</a><ul>
<li class="chapter" data-level="3.3.1" data-path="data-wrangling.html"><a href="data-wrangling.html#factors"><i class="fa fa-check"></i><b>3.3.1</b> Factors</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-wrangling.html"><a href="data-wrangling.html#multiple-files"><i class="fa fa-check"></i><b>3.3.2</b> Multiple files</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-wrangling.html"><a href="data-wrangling.html#pivot"><i class="fa fa-check"></i><b>3.3.3</b> Pivot</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-wrangling.html"><a href="data-wrangling.html#regular-expressions"><i class="fa fa-check"></i><b>3.4</b> Regular Expressions</a><ul>
<li class="chapter" data-level="3.4.1" data-path="data-wrangling.html"><a href="data-wrangling.html#base-r"><i class="fa fa-check"></i><b>3.4.1</b> base R</a></li>
<li class="chapter" data-level="3.4.2" data-path="data-wrangling.html"><a href="data-wrangling.html#stringr"><i class="fa fa-check"></i><b>3.4.2</b> stringr</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="data-wrangling.html"><a href="data-wrangling.html#pdf-to-xcel"><i class="fa fa-check"></i><b>3.5</b> PDF to xcel</a><ul>
<li class="chapter" data-level="3.5.1" data-path="data-wrangling.html"><a href="data-wrangling.html#scanned-text-or-picture"><i class="fa fa-check"></i><b>3.5.1</b> Scanned text or picture</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="data-wrangling.html"><a href="data-wrangling.html#web-scraping"><i class="fa fa-check"></i><b>3.6</b> Web scraping</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>4</b> Statistics</a><ul>
<li class="chapter" data-level="4.1" data-path="statistics.html"><a href="statistics.html#univariable-analyses"><i class="fa fa-check"></i><b>4.1</b> Univariable analyses</a><ul>
<li class="chapter" data-level="4.1.1" data-path="statistics.html"><a href="statistics.html#parametric-tests"><i class="fa fa-check"></i><b>4.1.1</b> Parametric tests</a></li>
<li class="chapter" data-level="4.1.2" data-path="statistics.html"><a href="statistics.html#non-parametric-tests"><i class="fa fa-check"></i><b>4.1.2</b> Non-parametric tests</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="statistics.html"><a href="statistics.html#regression"><i class="fa fa-check"></i><b>4.2</b> Regression</a><ul>
<li class="chapter" data-level="4.2.1" data-path="statistics.html"><a href="statistics.html#linear-least-square-regression"><i class="fa fa-check"></i><b>4.2.1</b> Linear (least square) regression</a></li>
<li class="chapter" data-level="4.2.2" data-path="statistics.html"><a href="statistics.html#logistic-regression"><i class="fa fa-check"></i><b>4.2.2</b> Logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="statistics.html"><a href="statistics.html#special-types-of-regression"><i class="fa fa-check"></i><b>4.3</b> Special types of regression</a><ul>
<li class="chapter" data-level="4.3.1" data-path="statistics.html"><a href="statistics.html#ordinal-regression"><i class="fa fa-check"></i><b>4.3.1</b> Ordinal regression</a></li>
<li class="chapter" data-level="4.3.2" data-path="statistics.html"><a href="statistics.html#survival-analysis"><i class="fa fa-check"></i><b>4.3.2</b> Survival analysis</a></li>
<li class="chapter" data-level="4.3.3" data-path="statistics.html"><a href="statistics.html#quantile-regression"><i class="fa fa-check"></i><b>4.3.3</b> Quantile regression</a></li>
<li class="chapter" data-level="4.3.4" data-path="statistics.html"><a href="statistics.html#penalised-regression"><i class="fa fa-check"></i><b>4.3.4</b> Penalised regression</a></li>
<li class="chapter" data-level="4.3.5" data-path="statistics.html"><a href="statistics.html#poisson-regression"><i class="fa fa-check"></i><b>4.3.5</b> Poisson regression</a></li>
<li class="chapter" data-level="4.3.6" data-path="statistics.html"><a href="statistics.html#mars"><i class="fa fa-check"></i><b>4.3.6</b> MARS</a></li>
<li class="chapter" data-level="4.3.7" data-path="statistics.html"><a href="statistics.html#conditional-logistic-regression"><i class="fa fa-check"></i><b>4.3.7</b> Conditional logistic regression</a></li>
<li class="chapter" data-level="4.3.8" data-path="statistics.html"><a href="statistics.html#mixed-modelling"><i class="fa fa-check"></i><b>4.3.8</b> Mixed modelling</a></li>
<li class="chapter" data-level="4.3.9" data-path="statistics.html"><a href="statistics.html#trajectory-modelling"><i class="fa fa-check"></i><b>4.3.9</b> Trajectory modelling</a></li>
<li class="chapter" data-level="4.3.10" data-path="statistics.html"><a href="statistics.html#multinomial-modelling"><i class="fa fa-check"></i><b>4.3.10</b> Multinomial modelling</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="statistics.html"><a href="statistics.html#sample-size-estimation"><i class="fa fa-check"></i><b>4.4</b> Sample size estimation</a><ul>
<li class="chapter" data-level="4.4.1" data-path="statistics.html"><a href="statistics.html#proportion"><i class="fa fa-check"></i><b>4.4.1</b> Proportion</a></li>
<li class="chapter" data-level="4.4.2" data-path="statistics.html"><a href="statistics.html#logistic-regression-1"><i class="fa fa-check"></i><b>4.4.2</b> Logistic regression</a></li>
<li class="chapter" data-level="4.4.3" data-path="statistics.html"><a href="statistics.html#survival-studies"><i class="fa fa-check"></i><b>4.4.3</b> Survival studies</a></li>
<li class="chapter" data-level="4.4.4" data-path="statistics.html"><a href="statistics.html#multiple-regression"><i class="fa fa-check"></i><b>4.4.4</b> Multiple regression</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="statistics.html"><a href="statistics.html#metaanalysis"><i class="fa fa-check"></i><b>4.5</b> Metaanalysis</a><ul>
<li class="chapter" data-level="4.5.1" data-path="statistics.html"><a href="statistics.html#prisma"><i class="fa fa-check"></i><b>4.5.1</b> PRISMA</a></li>
<li class="chapter" data-level="4.5.2" data-path="statistics.html"><a href="statistics.html#metaanalysis-of-proportion"><i class="fa fa-check"></i><b>4.5.2</b> Metaanalysis of proportion</a></li>
<li class="chapter" data-level="4.5.3" data-path="statistics.html"><a href="statistics.html#bivariate-metaanalysis"><i class="fa fa-check"></i><b>4.5.3</b> Bivariate Metaanalysis</a></li>
<li class="chapter" data-level="4.5.4" data-path="statistics.html"><a href="statistics.html#metaregression"><i class="fa fa-check"></i><b>4.5.4</b> Metaregression</a></li>
<li class="chapter" data-level="4.5.5" data-path="statistics.html"><a href="statistics.html#bayesian-metaanalysis"><i class="fa fa-check"></i><b>4.5.5</b> Bayesian Metaanalysis</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="statistics.html"><a href="statistics.html#data-simulation"><i class="fa fa-check"></i><b>4.6</b> Data simulation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html"><i class="fa fa-check"></i><b>5</b> Multivariate Analysis</a><ul>
<li class="chapter" data-level="5.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#principal-component-analysis"><i class="fa fa-check"></i><b>5.1</b> Principal component analysis</a></li>
<li class="chapter" data-level="5.2" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#independent-component-analysis"><i class="fa fa-check"></i><b>5.2</b> Independent component analysis</a></li>
<li class="chapter" data-level="5.3" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#partial-least-squares"><i class="fa fa-check"></i><b>5.3</b> Partial least squares</a></li>
<li class="chapter" data-level="5.4" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#t-stochastic-neighbourhood-embedding"><i class="fa fa-check"></i><b>5.4</b> T-Stochastic Neighbourhood Embedding</a></li>
<li class="chapter" data-level="5.5" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#non-negative-matrix-factorisation"><i class="fa fa-check"></i><b>5.5</b> Non-negative matrix factorisation</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="machine-learning.html"><a href="machine-learning.html"><i class="fa fa-check"></i><b>6</b> Machine learning</a><ul>
<li class="chapter" data-level="6.1" data-path="machine-learning.html"><a href="machine-learning.html#decision-tree-analysis"><i class="fa fa-check"></i><b>6.1</b> Decision tree analysis</a><ul>
<li class="chapter" data-level="6.1.1" data-path="machine-learning.html"><a href="machine-learning.html#information-theory-driven"><i class="fa fa-check"></i><b>6.1.1</b> Information theory driven</a></li>
<li class="chapter" data-level="6.1.2" data-path="machine-learning.html"><a href="machine-learning.html#conditional-decision-tree"><i class="fa fa-check"></i><b>6.1.2</b> Conditional decision tree</a></li>
<li class="chapter" data-level="6.1.3" data-path="machine-learning.html"><a href="machine-learning.html#criticisms-of-decision-tree"><i class="fa fa-check"></i><b>6.1.3</b> criticisms of decision tree</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="machine-learning.html"><a href="machine-learning.html#random-forest"><i class="fa fa-check"></i><b>6.2</b> Random Forest</a></li>
<li class="chapter" data-level="6.3" data-path="machine-learning.html"><a href="machine-learning.html#gradient-boost-machine"><i class="fa fa-check"></i><b>6.3</b> Gradient Boost Machine</a></li>
<li class="chapter" data-level="6.4" data-path="machine-learning.html"><a href="machine-learning.html#support-vector-machine"><i class="fa fa-check"></i><b>6.4</b> Support vector machine</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html"><i class="fa fa-check"></i><b>7</b> Machine Learning Part 2</a><ul>
<li class="chapter" data-level="7.1" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#non-negative-matrix-factorisation-1"><i class="fa fa-check"></i><b>7.1</b> Non-negative matrix factorisation</a></li>
<li class="chapter" data-level="7.2" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#formal-concept-analysis"><i class="fa fa-check"></i><b>7.2</b> Formal concept analysis</a></li>
<li class="chapter" data-level="7.3" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#evolutionary-algorithm"><i class="fa fa-check"></i><b>7.3</b> Evolutionary Algorithm</a><ul>
<li class="chapter" data-level="7.3.1" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#simulated-annealing"><i class="fa fa-check"></i><b>7.3.1</b> Simulated Annealing</a></li>
<li class="chapter" data-level="7.3.2" data-path="machine-learning-part-2.html"><a href="machine-learning-part-2.html#genetic-algorithm"><i class="fa fa-check"></i><b>7.3.2</b> Genetic Algorithm</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="operational-research.html"><a href="operational-research.html"><i class="fa fa-check"></i><b>8</b> Operational Research</a><ul>
<li class="chapter" data-level="8.1" data-path="operational-research.html"><a href="operational-research.html#discrete-event-simulations"><i class="fa fa-check"></i><b>8.1</b> Discrete Event Simulations</a></li>
<li class="chapter" data-level="8.2" data-path="operational-research.html"><a href="operational-research.html#linear-programming"><i class="fa fa-check"></i><b>8.2</b> Linear Programming</a></li>
<li class="chapter" data-level="8.3" data-path="operational-research.html"><a href="operational-research.html#forecasting"><i class="fa fa-check"></i><b>8.3</b> Forecasting</a></li>
<li class="chapter" data-level="8.4" data-path="operational-research.html"><a href="operational-research.html#health-economics"><i class="fa fa-check"></i><b>8.4</b> Health economics</a><ul>
<li class="chapter" data-level="8.4.1" data-path="operational-research.html"><a href="operational-research.html#markov-model"><i class="fa fa-check"></i><b>8.4.1</b> Markov model</a></li>
<li class="chapter" data-level="8.4.2" data-path="operational-research.html"><a href="operational-research.html#cost"><i class="fa fa-check"></i><b>8.4.2</b> Cost</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html"><i class="fa fa-check"></i><b>9</b> Geospatial analysis</a><ul>
<li class="chapter" data-level="9.1" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#geocoding"><i class="fa fa-check"></i><b>9.1</b> Geocoding</a></li>
<li class="chapter" data-level="9.2" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#thematic-map-1"><i class="fa fa-check"></i><b>9.2</b> Thematic map</a></li>
<li class="chapter" data-level="9.3" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#spatial-regression"><i class="fa fa-check"></i><b>9.3</b> Spatial regression</a></li>
<li class="chapter" data-level="9.4" data-path="geospatial-analysis.html"><a href="geospatial-analysis.html#spatio-temporal-regression"><i class="fa fa-check"></i><b>9.4</b> Spatio-temporal regression</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="graph-theory.html"><a href="graph-theory.html"><i class="fa fa-check"></i><b>10</b> Graph Theory</a><ul>
<li class="chapter" data-level="10.1" data-path="graph-theory.html"><a href="graph-theory.html#special-graphs"><i class="fa fa-check"></i><b>10.1</b> Special graphs</a><ul>
<li class="chapter" data-level="10.1.1" data-path="graph-theory.html"><a href="graph-theory.html#laplacian-matrix"><i class="fa fa-check"></i><b>10.1.1</b> Laplacian matrix</a></li>
<li class="chapter" data-level="10.1.2" data-path="graph-theory.html"><a href="graph-theory.html#bimodal-bipartite-graph"><i class="fa fa-check"></i><b>10.1.2</b> Bimodal (bipartite) graph</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="graph-theory.html"><a href="graph-theory.html#centrality-measures"><i class="fa fa-check"></i><b>10.2</b> Centrality Measures</a><ul>
<li class="chapter" data-level="10.2.1" data-path="graph-theory.html"><a href="graph-theory.html#local-centrality-measures"><i class="fa fa-check"></i><b>10.2.1</b> Local centrality measures</a></li>
<li class="chapter" data-level="10.2.2" data-path="graph-theory.html"><a href="graph-theory.html#global-centrality-measures"><i class="fa fa-check"></i><b>10.2.2</b> Global centrality measures</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="graph-theory.html"><a href="graph-theory.html#community"><i class="fa fa-check"></i><b>10.3</b> Community</a></li>
<li class="chapter" data-level="10.4" data-path="graph-theory.html"><a href="graph-theory.html#visualising-graph"><i class="fa fa-check"></i><b>10.4</b> Visualising graph</a><ul>
<li class="chapter" data-level="10.4.1" data-path="graph-theory.html"><a href="graph-theory.html#visnetwork"><i class="fa fa-check"></i><b>10.4.1</b> Visnetwork</a></li>
<li class="chapter" data-level="10.4.2" data-path="graph-theory.html"><a href="graph-theory.html#large-graph"><i class="fa fa-check"></i><b>10.4.2</b> Large graph</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="graph-theory.html"><a href="graph-theory.html#social-media-and-network-analysis"><i class="fa fa-check"></i><b>10.5</b> Social Media and Network Analysis</a><ul>
<li class="chapter" data-level="10.5.1" data-path="graph-theory.html"><a href="graph-theory.html#twitter"><i class="fa fa-check"></i><b>10.5.1</b> Twitter</a></li>
<li class="chapter" data-level="10.5.2" data-path="graph-theory.html"><a href="graph-theory.html#youtube"><i class="fa fa-check"></i><b>10.5.2</b> Youtube</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html"><i class="fa fa-check"></i><b>11</b> Bayesian Analysis</a><ul>
<li class="chapter" data-level="11.1" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#baysian-belief"><i class="fa fa-check"></i><b>11.1</b> Baysian belief</a><ul>
<li class="chapter" data-level="11.1.1" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#conditional-probability"><i class="fa fa-check"></i><b>11.1.1</b> Conditional probability</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#markov-model-1"><i class="fa fa-check"></i><b>11.2</b> Markov model</a></li>
<li class="chapter" data-level="11.3" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#inla"><i class="fa fa-check"></i><b>11.3</b> INLA</a></li>
<li class="chapter" data-level="11.4" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#stan"><i class="fa fa-check"></i><b>11.4</b> Stan</a></li>
<li class="chapter" data-level="11.5" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#bugs"><i class="fa fa-check"></i><b>11.5</b> BUGS</a><ul>
<li class="chapter" data-level="11.5.1" data-path="bayesian-analysis.html"><a href="bayesian-analysis.html#cost-1"><i class="fa fa-check"></i><b>11.5.1</b> Cost</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="app.html"><a href="app.html"><i class="fa fa-check"></i><b>12</b> App</a><ul>
<li class="chapter" data-level="12.1" data-path="app.html"><a href="app.html#brief-introduction-to-shiny-app"><i class="fa fa-check"></i><b>12.1</b> Brief introduction to Shiny app</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>13</b> Appendix</a><ul>
<li class="chapter" data-level="13.1" data-path="appendix.html"><a href="appendix.html#brief-introduction-to-matrix"><i class="fa fa-check"></i><b>13.1</b> Brief introduction to Matrix</a></li>
<li class="chapter" data-level="13.2" data-path="appendix.html"><a href="appendix.html#regression-1"><i class="fa fa-check"></i><b>13.2</b> Regression</a><ul>
<li class="chapter" data-level="13.2.1" data-path="appendix.html"><a href="appendix.html#linear-regression"><i class="fa fa-check"></i><b>13.2.1</b> Linear regression</a></li>
<li class="chapter" data-level="13.2.2" data-path="appendix.html"><a href="appendix.html#logistic-regression-2"><i class="fa fa-check"></i><b>13.2.2</b> Logistic regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applications of R in Healthcare</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="app" class="section level1">
<h1><span class="header-section-number">Chapter 12</span> App</h1>
<p>There are several platforms for writing and deploying apps. Rstudio has created a library <em>Shiny</em> to write app. This app can be deployed by creating an account at <a href="https://shiny.rstudio.com/" class="uri">https://shiny.rstudio.com/</a>.</p>
<div id="brief-introduction-to-shiny-app" class="section level2">
<h2><span class="header-section-number">12.1</span> Brief introduction to Shiny app</h2>
<p>Shiny divides the app to 2 component: <em>ui</em> or user interface web page and <em>server</em> or the engine for running the app. This app is used to assist if a stroke code should be activated. It uses the <em>reactive</em> call within <em>server</em> to switch between activating and deactivating code stroke.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(shiny)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co"># Define UI for application </span></a>
<a class="sourceLine" id="cb1-3" title="3">ui &lt;-<span class="st"> </span><span class="kw">bootstrapPage</span>(</a>
<a class="sourceLine" id="cb1-4" title="4">    <span class="kw">titlePanel</span>(<span class="st">&quot;ST6-code stroke prototype app&quot;</span>),</a>
<a class="sourceLine" id="cb1-5" title="5">    <span class="kw">wellPanel</span>(</a>
<a class="sourceLine" id="cb1-6" title="6">        <span class="kw">helpText</span>(<span class="st">&quot;This app helps you decide if you should call a code stroke. it is designed for use at a teaching hospital and may not apply for your specific need. Please check with your local hospital.&quot;</span>),</a>
<a class="sourceLine" id="cb1-7" title="7">        <span class="co">#stroke      </span></a>
<a class="sourceLine" id="cb1-8" title="8">        <span class="kw">textInput</span>(<span class="st">&#39;stroke&#39;</span>,<span class="st">&quot;Is it a stroke-Please enter Yes or No&quot;</span>,<span class="st">&quot;No&quot;</span>),</a>
<a class="sourceLine" id="cb1-9" title="9">        <span class="co">#walk</span></a>
<a class="sourceLine" id="cb1-10" title="10">        <span class="kw">textInput</span>(<span class="st">&#39;walk&#39;</span>,<span class="st">&quot;Prior to stroke, can the patient walk from one room to another without the help from another person? Walking aids such as four wheelframe and walking stick are allowed? -Please enter Yes or No&quot;</span>,<span class="st">&quot;Yes&quot;</span>),</a>
<a class="sourceLine" id="cb1-11" title="11">        <span class="co">#home</span></a>
<a class="sourceLine" id="cb1-12" title="12">        <span class="kw">textInput</span>(<span class="st">&#39;nursing&#39;</span>,<span class="st">&quot;Is the patient from nursing home-Please enter Yes or No&quot;</span>,<span class="st">&quot;Yes&quot;</span>)</a>
<a class="sourceLine" id="cb1-13" title="13">    ),</a>
<a class="sourceLine" id="cb1-14" title="14">    <span class="co">#partition screen to 3 columns- sum to 12</span></a>
<a class="sourceLine" id="cb1-15" title="15">    <span class="kw">column</span>(<span class="dv">9</span>,</a>
<a class="sourceLine" id="cb1-16" title="16">           <span class="kw">tabPanel</span>(</a>
<a class="sourceLine" id="cb1-17" title="17">               <span class="kw">textOutput</span>(<span class="st">&quot;Hospital&quot;</span>),</a>
<a class="sourceLine" id="cb1-18" title="18">               <span class="kw">textOutput</span>(<span class="st">&quot;Walk&quot;</span>))</a>
<a class="sourceLine" id="cb1-19" title="19">    )</a>
<a class="sourceLine" id="cb1-20" title="20">  )</a>
<a class="sourceLine" id="cb1-21" title="21"><span class="co"># Define server logic </span></a>
<a class="sourceLine" id="cb1-22" title="22">server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session) {</a>
<a class="sourceLine" id="cb1-23" title="23">    <span class="co">#stroke</span></a>
<a class="sourceLine" id="cb1-24" title="24">    answer&lt;-<span class="kw">reactive</span>({</a>
<a class="sourceLine" id="cb1-25" title="25">       <span class="cf">if</span>(input<span class="op">$</span>stroke<span class="op">==</span><span class="st">&quot;No&quot;</span>) </a>
<a class="sourceLine" id="cb1-26" title="26">          {<span class="kw">return</span> (<span class="st">&quot;Your answer is NO to the patient having signs of stroke, please do NOT call code stroke&quot;</span>)</a>
<a class="sourceLine" id="cb1-27" title="27">     } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb1-28" title="28">        <span class="kw">return</span>(<span class="st">&quot;Please call code stroke&quot;</span>)</a>
<a class="sourceLine" id="cb1-29" title="29">    }</a>
<a class="sourceLine" id="cb1-30" title="30">    })</a>
<a class="sourceLine" id="cb1-31" title="31">    output<span class="op">$</span>Hospital&lt;-<span class="kw">renderText</span>({<span class="kw">return</span>(<span class="kw">answer</span>())})</a>
<a class="sourceLine" id="cb1-32" title="32">    <span class="co">#walk</span></a>
<a class="sourceLine" id="cb1-33" title="33">    answer1&lt;-<span class="kw">reactive</span>({</a>
<a class="sourceLine" id="cb1-34" title="34">       <span class="cf">if</span>(input<span class="op">$</span>stroke<span class="op">==</span><span class="st">&quot;No&quot;</span>) </a>
<a class="sourceLine" id="cb1-35" title="35">      {<span class="kw">return</span> (<span class="st">&quot;Your answer is NO to the patient having signs of stroke, please do NOT call code stroke&quot;</span>)</a>
<a class="sourceLine" id="cb1-36" title="36">       } <span class="cf">else</span> { <span class="cf">if</span>(input<span class="op">$</span>walk<span class="op">==</span><span class="st">&quot;No&quot;</span>) {</a>
<a class="sourceLine" id="cb1-37" title="37">           <span class="kw">return</span>(<span class="st">&quot;Your answer is No, indicating that premorbidly the patient is unable to walk unaided, please do NOT call code stroke&quot;</span>)</a>
<a class="sourceLine" id="cb1-38" title="38">       } <span class="cf">else</span> { <span class="cf">if</span>(input<span class="op">$</span>nursing<span class="op">==</span><span class="st">&quot;Yes&quot;</span>) {</a>
<a class="sourceLine" id="cb1-39" title="39">         <span class="kw">return</span>(<span class="st">&quot;Your answer is Yes to the patient living in nursing home, please do NOT call code stroke&quot;</span>)</a>
<a class="sourceLine" id="cb1-40" title="40">       }</a>
<a class="sourceLine" id="cb1-41" title="41">         }</a>
<a class="sourceLine" id="cb1-42" title="42">        <span class="kw">return</span>(<span class="st">&quot;Please call code stroke&quot;</span>)</a>
<a class="sourceLine" id="cb1-43" title="43">        }</a>
<a class="sourceLine" id="cb1-44" title="44">    })</a>
<a class="sourceLine" id="cb1-45" title="45">    output<span class="op">$</span>Walk&lt;-<span class="kw">renderText</span>({<span class="kw">return</span>(<span class="kw">answer1</span>())})</a>
<a class="sourceLine" id="cb1-46" title="46">   }</a>
<a class="sourceLine" id="cb1-47" title="47"><span class="co"># Run the application </span></a>
<a class="sourceLine" id="cb1-48" title="48"><span class="kw">shinyApp</span>(<span class="dt">ui =</span> ui, <span class="dt">server =</span> server)</a></code></pre></div>
<pre><code>## 
## Listening on http://127.0.0.1:3862</code></pre>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>This app is available at <a href="https://gntem3.shinyapps.io/ambmc" class="uri">https://gntem3.shinyapps.io/ambmc</a>. It was designed to explore deployment of mobile stroke unit (ambulance equipped with CT scanner for stroke treatment) in Melbourne <span class="citation">(Phan et al. <a href="#ref-pmid31019489">2019</a>)</span>. The app illustrates the use of slide ruler to enable user interaction. A picture can be inserted into the app by placing the picture inside sub-folder <em>www</em>. A web page can be inserted using html coding. Plotly object can be rendered wihtin shiny using the call <em>renderPlotly</em>. Leaflet map object can be rendered using the call <em>renderLeaflet</em>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">library</span>(shiny)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw">library</span>(DT)</a></code></pre></div>
<pre><code>## 
## Attaching package: &#39;DT&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:shiny&#39;:
## 
##     dataTableOutput, renderDataTable</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">library</span>(leaflet)</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="kw">library</span>(plotly)</a></code></pre></div>
<pre><code>## Loading required package: ggplot2</code></pre>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 3.6.1</code></pre>
<pre><code>## 
## Attaching package: &#39;plotly&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     last_plot</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     filter</code></pre>
<pre><code>## The following object is masked from &#39;package:graphics&#39;:
## 
##     layout</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">library</span>(magick)</a></code></pre></div>
<pre><code>## Linking to ImageMagick 6.9.9.14
## Enabled features: cairo, freetype, fftw, ghostscript, lcms, pango, rsvg, webp
## Disabled features: fontconfig, x11</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">library</span>(dplyr)</a></code></pre></div>
<pre><code>## Warning: package &#39;dplyr&#39; was built under R version 3.6.1</code></pre>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">X1=<span class="kw">read.csv</span>(<span class="st">&quot;./Data-Use/Amb_geocoded_time.csv&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>,<span class="dt">sep=</span><span class="st">&quot;,&quot;</span>)</a>
<a class="sourceLine" id="cb20-2" title="2"></a>
<a class="sourceLine" id="cb20-3" title="3">X2=<span class="kw">read.csv</span>(<span class="st">&quot;./Data-Use/Amb_toTPA_geocoded2.csv&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>,<span class="dt">sep=</span><span class="st">&quot;,&quot;</span>) </a>
<a class="sourceLine" id="cb20-4" title="4"><span class="co">#remove row without values</span></a>
<a class="sourceLine" id="cb20-5" title="5">X1=<span class="kw">inner_join</span>(X2, X1, <span class="dt">by=</span><span class="st">&quot;Suburb&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: Column `Suburb` joining factors with different levels, coercing to
## character vector</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="co">#create dataframe</span></a>
<a class="sourceLine" id="cb22-2" title="2">time&lt;-<span class="kw">data_frame</span>(X1<span class="op">$</span>minutestoRMH,X1<span class="op">$</span>minutestoMMC,X1<span class="op">$</span>minutestoAus,X1<span class="op">$</span>minutestoAlfred,X1<span class="op">$</span>minutestoBHH,X1<span class="op">$</span>minutestoFrankston,X1<span class="op">$</span>minutestogeelong,X1<span class="op">$</span>minutestonorthern,X1<span class="op">$</span>minutestoSH,X1<span class="op">$</span>minutestoSVH)</a></code></pre></div>
<pre><code>## Warning: `data_frame()` is deprecated, use `tibble()`.
## This warning is displayed once per session.</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="co">#find min of each row</span></a>
<a class="sourceLine" id="cb24-2" title="2">X1<span class="op">$</span>TH=<span class="kw">apply</span>(time,<span class="dv">1</span>,min)</a>
<a class="sourceLine" id="cb24-3" title="3">ui &lt;-<span class="st"> </span><span class="kw">fluidPage</span>(</a>
<a class="sourceLine" id="cb24-4" title="4">  <span class="kw">titlePanel</span>(<span class="st">&quot;Googling CT Ambulance for Stroke Codes-Prototype&quot;</span>),</a>
<a class="sourceLine" id="cb24-5" title="5">  <span class="kw">wellPanel</span>(</a>
<a class="sourceLine" id="cb24-6" title="6">    <span class="kw">helpText</span>(<span class="st">&quot;There are 2 hospitals (Royal Melbourne Hospital and Monash Medical Centre) designated to provide clot retrieval service for the State of Victoria. This app helps to explore optimal condition for the use of CT ambulance (Mobile Stroke Unit) versus usual ambulance in Stroke Codes. Move the widgets under the panels Model CT Ambulance and Model Usual Ambulance to see the effect on the territory of the CT ambulance. The interactive plot of CT ambulance travel time (y-axis) versus usual ambulance time (x-axis) indicates the suburb whereby the ambulance are likely to arrive at the same time. Click on the circle to get the name of the suburb.For the purpose of these simulations, the CT ambulance is assumed to be based at Royal Melbourne Hospital. A second base at MMC is proposed&quot;</span>),</a>
<a class="sourceLine" id="cb24-7" title="7">    tags<span class="op">$</span><span class="kw">h5</span>(<span class="st">&quot;The spatial point process simulations for clot retrieval in Melbourne and related publication can be accessed by clicking the link here&quot;</span>),</a>
<a class="sourceLine" id="cb24-8" title="8">    tags<span class="op">$</span><span class="kw">a</span>(<span class="dt">href =</span><span class="st">&quot;https://gntem2.github.io/Google-Map-to-Victorian-ECR-Hospitals/&quot;</span>,<span class="st">&quot;Simulated Melbourne model&quot;</span>),</a>
<a class="sourceLine" id="cb24-9" title="9">    tags<span class="op">$</span><span class="kw">a</span>(<span class="dt">href =</span><span class="st">&quot;http://stroke.ahajournals.org/content/48/5/1353.long&quot;</span>,<span class="st">&quot;Link to reference paper&quot;</span>)</a>
<a class="sourceLine" id="cb24-10" title="10">        ),</a>
<a class="sourceLine" id="cb24-11" title="11">  <span class="kw">br</span>(),</a>
<a class="sourceLine" id="cb24-12" title="12">  <span class="co">#create first column, width=3</span></a>
<a class="sourceLine" id="cb24-13" title="13">  <span class="kw">column</span>(<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb24-14" title="14">         <span class="kw">tabsetPanel</span>(</a>
<a class="sourceLine" id="cb24-15" title="15">           <span class="kw">tabPanel</span>(<span class="st">&quot;Model CT Ambulance&quot;</span>,</a>
<a class="sourceLine" id="cb24-16" title="16">                    <span class="kw">sliderInput</span>(<span class="st">&quot;bins&quot;</span>,</a>
<a class="sourceLine" id="cb24-17" title="17"><span class="st">&quot;Time (minutes) to process patient at scene by CT Ambulance- TPA:&quot;</span>,                        <span class="dt">min =</span> <span class="dv">20</span>,</a>
<a class="sourceLine" id="cb24-18" title="18">                       <span class="dt">max =</span> <span class="dv">60</span>,</a>
<a class="sourceLine" id="cb24-19" title="19">                       <span class="dt">value =</span> <span class="dv">30</span>) ,<span class="co">#30</span></a>
<a class="sourceLine" id="cb24-20" title="20">                    <span class="kw">sliderInput</span>(<span class="st">&quot;bins1&quot;</span>,</a>
<a class="sourceLine" id="cb24-21" title="21"><span class="st">&quot;Time (minutes) to process patient at scene by CT Ambulance-CT angiography:&quot;</span>,                                                         <span class="dt">min =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb24-22" title="22">                                <span class="dt">max =</span> <span class="dv">60</span>,</a>
<a class="sourceLine" id="cb24-23" title="23">                                <span class="dt">value =</span> <span class="dv">10</span>),</a>
<a class="sourceLine" id="cb24-24" title="24">                    <span class="kw">sliderInput</span>(<span class="st">&quot;bins10&quot;</span>,</a>
<a class="sourceLine" id="cb24-25" title="25">                                <span class="st">&quot;Time (minutes) to process patient at scene by CT Ambulance-CT Perfusion:&quot;</span>,                                                        <span class="dt">min =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb24-26" title="26">                                <span class="dt">max =</span> <span class="dv">60</span>,</a>
<a class="sourceLine" id="cb24-27" title="27">                                <span class="dt">value =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb24-28" title="28">                    <span class="kw">sliderInput</span>(<span class="st">&quot;bins11&quot;</span>,</a>
<a class="sourceLine" id="cb24-29" title="29"><span class="st">&quot;Time (minutes) for telemedicine consult:&quot;</span>,                                                        <span class="dt">min =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb24-30" title="30">                                <span class="dt">max =</span> <span class="dv">60</span>,</a>
<a class="sourceLine" id="cb24-31" title="31">                                <span class="dt">value =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb24-32" title="32">                    <span class="kw">sliderInput</span>(<span class="st">&quot;bins5&quot;</span>,</a>
<a class="sourceLine" id="cb24-33" title="33">                                <span class="st">&quot;Time (minutes) to process patient at hospital for ECR after arrival from CT Ambulance:&quot;</span>,                                            <span class="dt">min =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb24-34" title="34">                                <span class="dt">max =</span> <span class="dv">60</span>,</a>
<a class="sourceLine" id="cb24-35" title="35">                                <span class="dt">value =</span> <span class="dv">30</span>) <span class="co">#30</span></a>
<a class="sourceLine" id="cb24-36" title="36">                               ),</a>
<a class="sourceLine" id="cb24-37" title="37">           <span class="kw">tabPanel</span>(<span class="st">&quot;Model Usual Ambulance&quot;</span>,</a>
<a class="sourceLine" id="cb24-38" title="38">                     <span class="co">#audit= 16 min</span></a>
<a class="sourceLine" id="cb24-39" title="39">                    <span class="kw">sliderInput</span>(<span class="st">&quot;bins3&quot;</span>,</a>
<a class="sourceLine" id="cb24-40" title="40">      <span class="st">&quot;Time (minutes) from scene - usual Ambulance:&quot;</span>,                                             <span class="dt">min =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb24-41" title="41">                                <span class="dt">max =</span> <span class="dv">60</span>,</a>
<a class="sourceLine" id="cb24-42" title="42">                                <span class="dt">value =</span> <span class="dv">15</span>),</a>
<a class="sourceLine" id="cb24-43" title="43">                    <span class="kw">sliderInput</span>(<span class="st">&quot;bins2&quot;</span>,</a>
<a class="sourceLine" id="cb24-44" title="44"><span class="st">&quot;Time (minutes) to process patient at scene- usual Ambulance:&quot;</span>,                                   <span class="dt">min =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb24-45" title="45">                                <span class="dt">max =</span> <span class="dv">60</span>,</a>
<a class="sourceLine" id="cb24-46" title="46">                                <span class="dt">value =</span> <span class="dv">20</span>),</a>
<a class="sourceLine" id="cb24-47" title="47">                    <span class="kw">sliderInput</span>(<span class="st">&quot;bins4&quot;</span>,</a>
<a class="sourceLine" id="cb24-48" title="48">                                <span class="st">&quot;Time (minutes) to process patient at hospital for TPA after arrival- usual Ambulance:&quot;</span>,                                              <span class="dt">min =</span> <span class="dv">20</span>,</a>
<a class="sourceLine" id="cb24-49" title="49">                                <span class="dt">max =</span> <span class="dv">80</span>,</a>
<a class="sourceLine" id="cb24-50" title="50">                                <span class="dt">value =</span> <span class="dv">60</span>), <span class="co">#45</span></a>
<a class="sourceLine" id="cb24-51" title="51">                    <span class="kw">sliderInput</span>(<span class="st">&quot;bins6&quot;</span>,</a>
<a class="sourceLine" id="cb24-52" title="52"><span class="st">&quot;Time (minutes) to process patient at hospital for ECR after arrival- usual Ambulance:&quot;</span>,                                             <span class="dt">min =</span> <span class="dv">30</span>,</a>
<a class="sourceLine" id="cb24-53" title="53">                                <span class="dt">max =</span> <span class="dv">90</span>,</a>
<a class="sourceLine" id="cb24-54" title="54">                                <span class="dt">value =</span> <span class="dv">30</span>)</a>
<a class="sourceLine" id="cb24-55" title="55">           )</a>
<a class="sourceLine" id="cb24-56" title="56">         )</a>
<a class="sourceLine" id="cb24-57" title="57">       ),</a>
<a class="sourceLine" id="cb24-58" title="58"><span class="co">#create second column, width=6</span></a>
<a class="sourceLine" id="cb24-59" title="59">  <span class="kw">column</span>(<span class="dv">6</span>,</a>
<a class="sourceLine" id="cb24-60" title="60">    <span class="kw">tabsetPanel</span>(</a>
<a class="sourceLine" id="cb24-61" title="61">      <span class="kw">tabPanel</span>(<span class="st">&quot;CT vs Usual ambulance comparison&quot;</span>, <span class="kw">leafletOutput</span>(<span class="st">&quot;map&quot;</span>,<span class="dt">height =</span> <span class="st">&quot;600px&quot;</span>),DT<span class="op">::</span><span class="kw">dataTableOutput</span>(<span class="st">&quot;table4&quot;</span>),<span class="kw">p</span>()),</a>
<a class="sourceLine" id="cb24-62" title="62">      <span class="kw">tabPanel</span>(<span class="st">&quot;2 hospital model&quot;</span>, <span class="kw">leafletOutput</span>(<span class="st">&quot;map2&quot;</span>),<span class="kw">p</span>())</a>
<a class="sourceLine" id="cb24-63" title="63">    )</a>
<a class="sourceLine" id="cb24-64" title="64">      ),</a>
<a class="sourceLine" id="cb24-65" title="65">  <span class="co">#create third column, width =3</span></a>
<a class="sourceLine" id="cb24-66" title="66">  <span class="kw">column</span>(<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb24-67" title="67">         <span class="co">#insert pic from www folder</span></a>
<a class="sourceLine" id="cb24-68" title="68">         tags<span class="op">$</span><span class="kw">img</span>(<span class="dt">height=</span><span class="dv">100</span>,<span class="dt">width=</span><span class="dv">150</span>,<span class="dt">src=</span><span class="st">&quot;./Data-Use/ctambulance.jpg&quot;</span>),</a>
<a class="sourceLine" id="cb24-69" title="69">         <span class="kw">br</span>(),</a>
<a class="sourceLine" id="cb24-70" title="70">         <span class="kw">br</span>(),</a>
<a class="sourceLine" id="cb24-71" title="71">         <span class="kw">helpText</span>(<span class="st">&quot;the percentage of suburbs where CT Ambulance is superior for delivering TPA&quot;</span>),</a>
<a class="sourceLine" id="cb24-72" title="72">         <span class="kw">textOutput</span>(<span class="st">&quot;sumctasupper&quot;</span>),</a>
<a class="sourceLine" id="cb24-73" title="73">         <span class="kw">br</span>(),</a>
<a class="sourceLine" id="cb24-74" title="74">         <span class="kw">helpText</span>(<span class="st">&quot;the percentage of suburbs where CT Ambulance is superior for delivering ECR-RMH only&quot;</span>), </a>
<a class="sourceLine" id="cb24-75" title="75">         <span class="kw">textOutput</span>(<span class="st">&quot;sumctaecrsupper&quot;</span>),</a>
<a class="sourceLine" id="cb24-76" title="76">         <span class="kw">br</span>(),</a>
<a class="sourceLine" id="cb24-77" title="77">         <span class="kw">helpText</span>(<span class="st">&quot;the percentage of suburbs where CT Ambulance is superior for delivering ECR to RMH and MMC&quot;</span>), </a>
<a class="sourceLine" id="cb24-78" title="78">         <span class="kw">textOutput</span>(<span class="st">&quot;sumecrRMHMMC&quot;</span>),</a>
<a class="sourceLine" id="cb24-79" title="79">         <span class="kw">br</span>(),</a>
<a class="sourceLine" id="cb24-80" title="80">         <span class="kw">plotlyOutput</span>(<span class="st">&quot;plot&quot;</span>, <span class="dt">height=</span><span class="st">&quot;250px&quot;</span>)</a>
<a class="sourceLine" id="cb24-81" title="81">         ),</a>
<a class="sourceLine" id="cb24-82" title="82">  <span class="kw">br</span>()</a>
<a class="sourceLine" id="cb24-83" title="83">)</a>
<a class="sourceLine" id="cb24-84" title="84"><span class="co">#server</span></a>
<a class="sourceLine" id="cb24-85" title="85">server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output,session) {</a>
<a class="sourceLine" id="cb24-86" title="86">  <span class="co"># Leaflet map with 2 markers</span></a>
<a class="sourceLine" id="cb24-87" title="87">  output<span class="op">$</span>map &lt;-<span class="st"> </span><span class="kw">renderLeaflet</span>({</a>
<a class="sourceLine" id="cb24-88" title="88">    <span class="co">#TPA</span></a>
<a class="sourceLine" id="cb24-89" title="89">    X1<span class="op">$</span>cta    &lt;-<span class="st"> </span>X1<span class="op">$</span>minutesfromRMH<span class="op">+</span>input<span class="op">$</span>bins<span class="op">+</span>input<span class="op">$</span>bins1<span class="op">+</span>input<span class="op">$</span>bins10<span class="op">+</span>input<span class="op">$</span>bins11 </a>
<a class="sourceLine" id="cb24-90" title="90">    <span class="co">#return to local hospital</span></a>
<a class="sourceLine" id="cb24-91" title="91">    X1<span class="op">$</span>ua     &lt;-input<span class="op">$</span>bins3<span class="op">+</span>input<span class="op">$</span>bins2 <span class="op">+</span>input<span class="op">$</span>bins4<span class="op">+</span>X1<span class="op">$</span>TH</a>
<a class="sourceLine" id="cb24-92" title="92">    <span class="co">#ecr at RMH (from RMH and return trip RMH)</span></a>
<a class="sourceLine" id="cb24-93" title="93">    X1<span class="op">$</span>ctaecr &lt;-X1<span class="op">$</span>minutesfromRMH<span class="op">+</span>input<span class="op">$</span>bins<span class="op">+</span>input<span class="op">$</span>bins5<span class="op">+</span>input<span class="op">$</span>bins1<span class="op">+</span>input<span class="op">$</span>bins10<span class="op">+</span>input<span class="op">$</span>bins11<span class="op">+</span></a>
<a class="sourceLine" id="cb24-94" title="94"><span class="st">    </span>X1<span class="op">$</span>minutestoRMH</a>
<a class="sourceLine" id="cb24-95" title="95">    <span class="co">#ecr at MMC (from RMH and return trip MMC)</span></a>
<a class="sourceLine" id="cb24-96" title="96">    X1<span class="op">$</span>ctaecrM&lt;-X1<span class="op">$</span>minutesfromRMH<span class="op">+</span>input<span class="op">$</span>bins<span class="op">+</span>input<span class="op">$</span>bins5<span class="op">+</span>input<span class="op">$</span>bins1<span class="op">+</span>input<span class="op">$</span>bins10<span class="op">+</span>input<span class="op">$</span>bins11<span class="op">+</span></a>
<a class="sourceLine" id="cb24-97" title="97"><span class="st">      </span>X1<span class="op">$</span>minutestoMMC</a>
<a class="sourceLine" id="cb24-98" title="98">    <span class="co">#ua ecr </span></a>
<a class="sourceLine" id="cb24-99" title="99">    X1<span class="op">$</span>uaecr  &lt;-input<span class="op">$</span>bins3<span class="op">+</span>input<span class="op">$</span>bins2 <span class="op">+</span>input<span class="op">$</span>bins4<span class="op">+</span>input<span class="op">$</span>bins6<span class="op">+</span>X1<span class="op">$</span>minutestoRMH</a>
<a class="sourceLine" id="cb24-100" title="100">    <span class="co">#TPA</span></a>
<a class="sourceLine" id="cb24-101" title="101">    X1<span class="op">$</span>ctasup &lt;-<span class="st"> </span>X1<span class="op">$</span>cta <span class="op">&lt;</span>X1<span class="op">$</span>ua</a>
<a class="sourceLine" id="cb24-102" title="102">    X1<span class="op">$</span>ctasup[X1<span class="op">$</span>ctasup<span class="op">==</span><span class="st">&quot;TRUE&quot;</span>]&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb24-103" title="103">    X1<span class="op">$</span>ctasup[X1<span class="op">$</span>ctasup<span class="op">==</span><span class="st">&quot;FALSE&quot;</span>]&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb24-104" title="104">    <span class="co">#ECR RMH</span></a>
<a class="sourceLine" id="cb24-105" title="105">    X1<span class="op">$</span>ctaecrsup&lt;-X1<span class="op">$</span>ctaecr<span class="op">&lt;</span>X1<span class="op">$</span>uaecr</a>
<a class="sourceLine" id="cb24-106" title="106">    X1<span class="op">$</span>ctaecrsup[X1<span class="op">$</span>ctaecrsup<span class="op">==</span><span class="st">&quot;TRUE&quot;</span>]&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb24-107" title="107">    X1<span class="op">$</span>ctaecrsup[X1<span class="op">$</span>ctaecrsup<span class="op">==</span><span class="st">&quot;FALSE&quot;</span>]&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb24-108" title="108">    <span class="co">#ECR MMC</span></a>
<a class="sourceLine" id="cb24-109" title="109">    X1<span class="op">$</span>ctaecrMsup&lt;-X1<span class="op">$</span>ctaecrM<span class="op">&lt;</span>X1<span class="op">$</span>uaecr</a>
<a class="sourceLine" id="cb24-110" title="110">    X1<span class="op">$</span>ctaecrMsup[X1<span class="op">$</span>ctaecrMsup<span class="op">==</span><span class="st">&quot;TRUE&quot;</span>]&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb24-111" title="111">    X1<span class="op">$</span>ctaecrMsup[X1<span class="op">$</span>ctaecrMsup<span class="op">==</span><span class="st">&quot;FALSE&quot;</span>]&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb24-112" title="112">    <span class="co">#to scene</span></a>
<a class="sourceLine" id="cb24-113" title="113">    X1<span class="op">$</span>ctahist&lt;-X1<span class="op">$</span>cta<span class="op">-</span>X1<span class="op">$</span>ua</a>
<a class="sourceLine" id="cb24-114" title="114">    X1<span class="op">$</span>ctaecrhist&lt;-X1<span class="op">$</span>ctaecr<span class="op">-</span>X1<span class="op">$</span>uaecr</a>
<a class="sourceLine" id="cb24-115" title="115">    <span class="co">#choose RMH</span></a>
<a class="sourceLine" id="cb24-116" title="116">    X1<span class="op">$</span>chRMHMMC&lt;-X1<span class="op">$</span>minutestoRMH<span class="op">&lt;</span>X1<span class="op">$</span>minutestoMMC</a>
<a class="sourceLine" id="cb24-117" title="117">    X1<span class="op">$</span>chRMHMMC[X1<span class="op">$</span>chRMHMMC<span class="op">==</span><span class="st">&quot;TRUE&quot;</span>]&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb24-118" title="118">    X1<span class="op">$</span>chRMHMMC[X1<span class="op">$</span>chRMHMMC<span class="op">==</span><span class="st">&quot;FALSE&quot;</span>]&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb24-119" title="119">    <span class="co">#choose MMC</span></a>
<a class="sourceLine" id="cb24-120" title="120">    X1<span class="op">$</span>chMMC&lt;-X1<span class="op">$</span>minutestoMMC<span class="op">&lt;</span>X1<span class="op">$</span>minutestoRMH</a>
<a class="sourceLine" id="cb24-121" title="121">    X1<span class="op">$</span>chMMC[X1<span class="op">$</span>chMMC<span class="op">==</span><span class="st">&quot;TRUE&quot;</span>]&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb24-122" title="122">    X1<span class="op">$</span>chMMC[X1<span class="op">$</span>chMMC<span class="op">==</span><span class="st">&quot;FALSE&quot;</span>]&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb24-123" title="123">    <span class="co">#ECR RMH MMC</span></a>
<a class="sourceLine" id="cb24-124" title="124">    X1<span class="op">$</span>ecrRMHMMC&lt;-X1<span class="op">$</span>ctaecrsup<span class="op">*</span>X1<span class="op">$</span>chRMHMMC<span class="op">+</span>X1<span class="op">$</span>ctaecrMsup<span class="op">*</span>X1<span class="op">$</span>chMMC</a>
<a class="sourceLine" id="cb24-125" title="125">    X1<span class="op">$</span>put&lt;-input<span class="op">$</span>bins</a>
<a class="sourceLine" id="cb24-126" title="126">    X1<span class="op">$</span>put1&lt;-input<span class="op">$</span>bins1</a>
<a class="sourceLine" id="cb24-127" title="127">    X1<span class="op">$</span>put10&lt;-input<span class="op">$</span>bins10</a>
<a class="sourceLine" id="cb24-128" title="128">    X1<span class="op">$</span>put2&lt;-input<span class="op">$</span>bins2</a>
<a class="sourceLine" id="cb24-129" title="129">    X1<span class="op">$</span>put3&lt;-input<span class="op">$</span>bins3</a>
<a class="sourceLine" id="cb24-130" title="130">    X1<span class="op">$</span>put4&lt;-input<span class="op">$</span>bins4</a>
<a class="sourceLine" id="cb24-131" title="131">    X1<span class="op">$</span>put5&lt;-input<span class="op">$</span>bins5</a>
<a class="sourceLine" id="cb24-132" title="132">    X1<span class="op">$</span>put6&lt;-input<span class="op">$</span>bins6</a>
<a class="sourceLine" id="cb24-133" title="133">    PerCTA&lt;-<span class="kw">round</span>(<span class="kw">sum</span>(X1<span class="op">$</span>ctasup)<span class="op">/</span><span class="kw">length</span>(X1<span class="op">$</span>ctasup)<span class="op">*</span><span class="dv">100</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb24-134" title="134">    output<span class="op">$</span>sumctasupper&lt;-<span class="kw">renderText</span>({<span class="kw">return</span>(PerCTA)})</a>
<a class="sourceLine" id="cb24-135" title="135">    PerCTAECR&lt;-<span class="kw">round</span>(<span class="kw">sum</span>(X1<span class="op">$</span>ctaecrsup)<span class="op">/</span><span class="kw">length</span>(X1<span class="op">$</span>ctaecrsup)<span class="op">*</span><span class="dv">100</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb24-136" title="136">    output<span class="op">$</span>sumctaecrsupper&lt;-<span class="kw">renderText</span>({<span class="kw">return</span>(PerCTAECR)})</a>
<a class="sourceLine" id="cb24-137" title="137">    PerCTAECR2&lt;-<span class="kw">round</span>(<span class="kw">sum</span>(X1<span class="op">$</span>ecrRMHMMC)<span class="op">/</span><span class="kw">length</span>(X1<span class="op">$</span>ecrRMHMMC)<span class="op">*</span><span class="dv">100</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb24-138" title="138">    output<span class="op">$</span>sumecrRMHMMC&lt;-<span class="kw">renderText</span>({<span class="kw">return</span>(PerCTAECR2)})</a>
<a class="sourceLine" id="cb24-139" title="139">    <span class="co">#render plotly object</span></a>
<a class="sourceLine" id="cb24-140" title="140">    output<span class="op">$</span>plot&lt;-<span class="kw">renderPlotly</span>({</a>
<a class="sourceLine" id="cb24-141" title="141">      p&lt;-<span class="kw">ggplot</span>(X1,<span class="kw">aes</span>(<span class="dt">x=</span>X1<span class="op">$</span>minutesfromRMH,</a>
<a class="sourceLine" id="cb24-142" title="142">        <span class="dt">y=</span><span class="dv">95</span><span class="op">-</span>X1<span class="op">$</span>minutesfromRMH)) <span class="op">+</span></a>
<a class="sourceLine" id="cb24-143" title="143"><span class="st">        </span><span class="kw">geom_point</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb24-144" title="144"><span class="st">        </span><span class="kw">stat_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>,<span class="kw">aes</span>(X1<span class="op">$</span>minutesfromRMH))<span class="op">+</span></a>
<a class="sourceLine" id="cb24-145" title="145"><span class="st">        </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb24-146" title="146"><span class="st">        </span><span class="kw">xlab</span>(<span class="st">&quot;Time advantage-Usual Ambulance&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb24-147" title="147"><span class="st">        </span><span class="kw">ylab</span>(<span class="st">&quot;Time advantage CT Ambulance&quot;</span>)</a>
<a class="sourceLine" id="cb24-148" title="148">        <span class="kw">ggplotly</span>(p)</a>
<a class="sourceLine" id="cb24-149" title="149">    })</a>
<a class="sourceLine" id="cb24-150" title="150">    output<span class="op">$</span>plot2&lt;-<span class="kw">renderPlotly</span>({</a>
<a class="sourceLine" id="cb24-151" title="151">      <span class="kw">plot_ly</span>(<span class="dt">x=</span><span class="op">~</span>(X1<span class="op">$</span>uaecr), <span class="dt">y=</span><span class="op">~</span>X1<span class="op">$</span>ctaecr, <span class="dt">mode=</span><span class="st">&quot;markers&quot;</span>, </a>
<a class="sourceLine" id="cb24-152" title="152">              <span class="dt">text=</span><span class="op">~</span><span class="kw">paste</span>(<span class="st">&quot;Address:&quot;</span>,X1<span class="op">$</span>formatted_address,<span class="st">&#39;&lt;br&gt;Time:&#39;</span>, X1<span class="op">$</span>minutesfromRMH),</a>
<a class="sourceLine" id="cb24-153" title="153">              <span class="co">#color=~(X1$minutesRMH-input$bins3),</span></a>
<a class="sourceLine" id="cb24-154" title="154">              <span class="dt">marker =</span> <span class="kw">list</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">color =</span> <span class="st">&#39;rgba(255, 182, 193, .9)&#39;</span>,</a>
<a class="sourceLine" id="cb24-155" title="155"><span class="dt">line =</span> <span class="kw">list</span>(<span class="dt">color =</span> <span class="st">&#39;rgba(152, 0, 0, .8)&#39;</span>,</a>
<a class="sourceLine" id="cb24-156" title="156">                                        <span class="dt">width =</span> <span class="dv">5</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-157" title="157"><span class="st">        </span><span class="kw">layout</span>(<span class="dt">title =</span> <span class="st">&#39;Time to Patient Location&#39;</span>,</a>
<a class="sourceLine" id="cb24-158" title="158">       <span class="dt">yaxis=</span><span class="kw">list</span>(<span class="dt">title=</span><span class="st">&quot;Time to ECR by CT ambulance (minutes)&quot;</span>,</a>
<a class="sourceLine" id="cb24-159" title="159">                          <span class="dt">zeroline =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb24-160" title="160">     <span class="dt">xaxis =</span> <span class="kw">list</span>(<span class="dt">title=</span><span class="st">&quot;Time to ECR by usual Ambulance (minutes)&quot;</span></a>
<a class="sourceLine" id="cb24-161" title="161">                            ,<span class="dt">zeroline =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">animation_opts</span>(<span class="dt">transition =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb24-162" title="162">        )</a>
<a class="sourceLine" id="cb24-163" title="163">    })</a>
<a class="sourceLine" id="cb24-164" title="164"><span class="co">#color pallette    </span></a>
<a class="sourceLine" id="cb24-165" title="165">pal &lt;-<span class="st"> </span><span class="kw">colorFactor</span>(<span class="dt">palette =</span> <span class="kw">c</span>(<span class="st">&quot;yellow&quot;</span>,<span class="st">&quot;green&quot;</span>),<span class="dt">domain =</span> <span class="kw">as.factor</span>(X1<span class="op">$</span>ctasup))</a>
<a class="sourceLine" id="cb24-166" title="166">    pal2 &lt;-<span class="st"> </span><span class="kw">colorFactor</span>(<span class="dt">palette =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>),<span class="dt">domain =</span> <span class="kw">as.factor</span>(X1<span class="op">$</span>ctaecrsup))</a>
<a class="sourceLine" id="cb24-167" title="167">    pal3 &lt;-<span class="st"> </span><span class="kw">colorFactor</span>(<span class="dt">palette =</span> <span class="kw">c</span>(<span class="st">&quot;yellow&quot;</span>,<span class="st">&quot;blue&quot;</span>),<span class="dt">domain =</span> <span class="kw">as.factor</span>(X1<span class="op">$</span>chRMHMMC))</a>
<a class="sourceLine" id="cb24-168" title="168">    <span class="kw">leaflet</span>(<span class="dt">data=</span>X1) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb24-169" title="169"><span class="st">      </span><span class="kw">setView</span>(<span class="fl">145.1234</span>,<span class="op">-</span><span class="fl">37.92067</span>,<span class="dv">10</span>)  <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-170" title="170"><span class="st">      </span><span class="kw">addTiles</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-171" title="171"><span class="st">      </span><span class="co">#use javascript to link web page</span></a>
<a class="sourceLine" id="cb24-172" title="172"><span class="st">      </span><span class="kw">addMarkers</span>(<span class="dt">lng=</span><span class="fl">144.9559</span>, <span class="dt">lat=</span><span class="op">-</span><span class="fl">37.79865</span>,</a>
<a class="sourceLine" id="cb24-173" title="173">      <span class="dt">popup=</span><span class="st">&quot;&lt;b&gt;RMH&lt;/b&gt;&lt;br&gt;&lt;a href= &#39;http://eso-conference.com/2018/scientific-information/abstract-submission&#39;&gt;-CT Ambulance base&lt;/a&gt;&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-174" title="174"><span class="st">      </span><span class="kw">addMarkers</span>(<span class="dt">lng=</span><span class="fl">145.1233</span>, <span class="dt">lat=</span><span class="op">-</span><span class="fl">37.92073</span>,</a>
<a class="sourceLine" id="cb24-175" title="175">                 <span class="dt">popup=</span><span class="st">&quot;&lt;b&gt;MMC&lt;/b&gt;&lt;br&gt;&lt;a href= &#39;http://eso-conference.com/2018/scientific-information/abstract-submission&#39;&gt;-Proposed second CT Ambulance base&lt;/a&gt;&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-176" title="176"><span class="st">      </span><span class="kw">addCircleMarkers</span>(<span class="dt">lng=</span><span class="op">~</span>long,<span class="dt">lat=</span><span class="op">~</span>lat,<span class="dt">radius=</span><span class="dv">4</span>,<span class="dt">fillOpacity =</span> <span class="dv">1</span>, <span class="dt">stroke=</span>F, <span class="dt">color=</span><span class="op">~</span><span class="kw">pal</span>(X1<span class="op">$</span>ctasup),<span class="dt">group=</span><span class="st">&quot;TPA-CTA&quot;</span>,<span class="dt">label=</span>X1<span class="op">$</span>formatted_address) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-177" title="177"><span class="st">      </span><span class="kw">addLegend</span>(<span class="dt">pal=</span>pal, <span class="dt">values=</span> X1<span class="op">$</span>ctasup, <span class="dt">opacity =</span> <span class="dv">1</span>,<span class="dt">title =</span> <span class="st">&quot;TPA-CTA&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-178" title="178"><span class="st">    </span><span class="kw">addCircleMarkers</span>(<span class="dt">lng=</span><span class="op">~</span>long,<span class="dt">lat=</span><span class="op">~</span>lat,<span class="dt">radius=</span><span class="dv">4</span>,<span class="dt">fillOpacity =</span> <span class="dv">1</span>, <span class="dt">stroke=</span>F, <span class="dt">color=</span><span class="op">~</span><span class="kw">pal2</span>(X1<span class="op">$</span>ctaecrsup),<span class="dt">group=</span><span class="st">&quot;ECR-CTA&quot;</span>,<span class="dt">label=</span>X1<span class="op">$</span>formatted_address) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-179" title="179"><span class="st">      </span><span class="kw">addLegend</span>(<span class="dt">pal=</span>pal2, <span class="dt">values=</span> X1<span class="op">$</span>ctaecrsup, <span class="dt">opacity =</span> <span class="dv">1</span>,<span class="dt">title =</span> <span class="st">&quot;ECR-CTA&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-180" title="180"><span class="st">        </span><span class="kw">addLayersControl</span>(<span class="dt">overlayGroups =</span> <span class="kw">c</span>(<span class="st">&quot;TPA-CTA&quot;</span>, <span class="st">&quot;ECR-CTA&quot;</span>),         <span class="dt">options =</span> <span class="kw">layersControlOptions</span>(<span class="dt">collapsed =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-181" title="181"><span class="st">     </span><span class="kw">addMeasure</span>(<span class="dt">primaryLengthUnit =</span> <span class="st">&quot;meters&quot;</span>,</a>
<a class="sourceLine" id="cb24-182" title="182">                <span class="dt">primaryAreaUnit =</span> <span class="st">&quot;sqmeters&quot;</span>,</a>
<a class="sourceLine" id="cb24-183" title="183">                <span class="dt">activeColor =</span> <span class="st">&quot;red&quot;</span>,</a>
<a class="sourceLine" id="cb24-184" title="184">                <span class="dt">completedColor =</span> <span class="st">&quot;red&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-185" title="185"><span class="st">     </span><span class="kw">addMiniMap</span>(<span class="dt">toggleDisplay =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb24-186" title="186">    })</a>
<a class="sourceLine" id="cb24-187" title="187">  output<span class="op">$</span>map2 &lt;-<span class="st"> </span><span class="kw">renderLeaflet</span>({</a>
<a class="sourceLine" id="cb24-188" title="188">    X1<span class="op">$</span>chRMHMMC&lt;-X1<span class="op">$</span>minutestoRMH<span class="op">&lt;</span>X1<span class="op">$</span>minutestoMMC</a>
<a class="sourceLine" id="cb24-189" title="189">    X1<span class="op">$</span>chRMHMMC[X1<span class="op">$</span>chRMHMMC<span class="op">==</span><span class="st">&quot;TRUE&quot;</span>]&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb24-190" title="190">    X1<span class="op">$</span>chRMHMMC[X1<span class="op">$</span>chRMHMMC<span class="op">==</span><span class="st">&quot;FALSE&quot;</span>]&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb24-191" title="191">    pal &lt;-<span class="st"> </span><span class="kw">colorFactor</span>(<span class="dt">palette =</span> <span class="kw">c</span>(<span class="st">&quot;yellow&quot;</span>,<span class="st">&quot;blue&quot;</span>),<span class="dt">domain =</span> <span class="kw">as.factor</span>(X1<span class="op">$</span>chRMHMMC))</a>
<a class="sourceLine" id="cb24-192" title="192">    <span class="kw">leaflet</span>(<span class="dt">data=</span>X1) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb24-193" title="193"><span class="st">      </span><span class="kw">setView</span>(<span class="fl">145.1234</span>,<span class="op">-</span><span class="fl">37.92067</span>,<span class="dv">10</span>)  <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-194" title="194"><span class="st">      </span><span class="kw">addTiles</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-195" title="195"><span class="st">      </span><span class="co">#use javascript to link web page</span></a>
<a class="sourceLine" id="cb24-196" title="196"><span class="st">      </span><span class="kw">addMarkers</span>(<span class="dt">lng=</span><span class="fl">144.9559</span>, <span class="dt">lat=</span><span class="op">-</span><span class="fl">37.79865</span>,</a>
<a class="sourceLine" id="cb24-197" title="197">                 <span class="dt">popup=</span><span class="st">&quot;&lt;b&gt;RMH&lt;/b&gt;&lt;br&gt;&lt;a href= &#39;http://eso-conference.com/2018/scientific-information/abstract-submission&#39;&gt;-CT Ambulance base&lt;/a&gt;&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-198" title="198"><span class="st">      </span><span class="kw">addMarkers</span>(<span class="dt">lng=</span><span class="fl">145.1233</span>, <span class="dt">lat=</span><span class="op">-</span><span class="fl">37.92073</span>,</a>
<a class="sourceLine" id="cb24-199" title="199">                 <span class="dt">popup=</span><span class="st">&quot;&lt;b&gt;MMC&lt;/b&gt;&lt;br&gt;&lt;a href= &#39;http://eso-conference.com/2018/scientific-information/abstract-submission&#39;&gt;-Proposed second CT Ambulance base&lt;/a&gt;&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-200" title="200"><span class="st">      </span><span class="kw">addCircleMarkers</span>(<span class="dt">lng=</span><span class="op">~</span>long,<span class="dt">lat=</span><span class="op">~</span>lat,<span class="dt">radius=</span><span class="dv">4</span>,<span class="dt">fillOpacity =</span> <span class="dv">1</span>, <span class="dt">stroke=</span>F,</a>
<a class="sourceLine" id="cb24-201" title="201">                       <span class="dt">color=</span><span class="op">~</span><span class="kw">pal</span>(X1<span class="op">$</span>chRMHMMC),<span class="dt">group=</span><span class="st">&quot;RMH-MMC-ECR&quot;</span>,<span class="dt">label=</span>X1<span class="op">$</span>formatted_address) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-202" title="202"><span class="st">      </span><span class="kw">addLegend</span>(<span class="dt">pal=</span>pal, <span class="dt">values=</span> X1<span class="op">$</span>chRMHMMC, <span class="dt">opacity =</span> <span class="dv">1</span>,<span class="dt">title =</span> <span class="st">&quot;RMH-MMC-ECR&quot;</span>,<span class="dt">position=</span><span class="st">&quot;bottomleft&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-203" title="203"><span class="st">    </span></a>
<a class="sourceLine" id="cb24-204" title="204"><span class="st">    </span><span class="kw">addMeasure</span>(<span class="dt">primaryLengthUnit =</span> <span class="st">&quot;meters&quot;</span>,</a>
<a class="sourceLine" id="cb24-205" title="205">               <span class="dt">primaryAreaUnit =</span> <span class="st">&quot;sqmeters&quot;</span>,</a>
<a class="sourceLine" id="cb24-206" title="206">               <span class="dt">activeColor =</span> <span class="st">&quot;red&quot;</span>,</a>
<a class="sourceLine" id="cb24-207" title="207">               <span class="dt">completedColor =</span> <span class="st">&quot;red&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-208" title="208"><span class="st">      </span><span class="kw">addMiniMap</span>(<span class="dt">toggleDisplay =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb24-209" title="209">  })</a>
<a class="sourceLine" id="cb24-210" title="210">}</a>
<a class="sourceLine" id="cb24-211" title="211"><span class="kw">shinyApp</span>(<span class="dt">ui =</span> ui, <span class="dt">server =</span> server)</a></code></pre></div>
<pre><code>## 
## Listening on http://127.0.0.1:7374</code></pre>
<p><img src="Applications-of-R-in-Healthcare_files/figure-html/app%20with%20slider-1.png" width="672" /></p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-pmid31019489">
<p>Phan, T. G., R. Beare, M. Parsons, H. Zhao, S. Davis, G. A. Donnan, V. Srikanth, and H. Ma. 2019. Googling Boundaries for Operating Mobile Stroke Unit for Stroke Codes. <em>Front Neurol</em> 10: 331.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="bayesian-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="appendix.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/11-App.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Applications-of-R-in-Healthcare.pdf", "Applications-of-R-in-Healthcare.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
